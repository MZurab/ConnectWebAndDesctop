/*! jQuery v3.1.1 | (c) jQuery Foundation | jquery.org/license */ ! function(a, b) {
    "use strict";
    "object" == typeof module && "object" == typeof module.exports ? module.exports = a.document ? b(a, !0) : function(a) {
        if (!a.document) throw new Error("jQuery requires a window with a document");
        return b(a)
    } : b(a)
}("undefined" != typeof window ? window : this, function(a, b) {
    "use strict";
    var c = [],
        d = a.document,
        e = Object.getPrototypeOf,
        f = c.slice,
        g = c.concat,
        h = c.push,
        i = c.indexOf,
        j = {},
        k = j.toString,
        l = j.hasOwnProperty,
        m = l.toString,
        n = m.call(Object),
        o = {};

    function p(a, b) {
        b = b || d;
        var c = b.createElement("script");
        c.text = a, b.head.appendChild(c).parentNode.removeChild(c)
    }
    var q = "3.1.1",
        r = function(a, b) {
            return new r.fn.init(a, b)
        },
        s = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
        t = /^-ms-/,
        u = /-([a-z])/g,
        v = function(a, b) {
            return b.toUpperCase()
        };
    r.fn = r.prototype = {
        jquery: q,
        constructor: r,
        length: 0,
        toArray: function() {
            return f.call(this)
        },
        get: function(a) {
            return null == a ? f.call(this) : a < 0 ? this[a + this.length] : this[a]
        },
        pushStack: function(a) {
            var b = r.merge(this.constructor(), a);
            return b.prevObject = this, b
        },
        each: function(a) {
            return r.each(this, a)
        },
        map: function(a) {
            return this.pushStack(r.map(this, function(b, c) {
                return a.call(b, c, b)
            }))
        },
        slice: function() {
            return this.pushStack(f.apply(this, arguments))
        },
        first: function() {
            return this.eq(0)
        },
        last: function() {
            return this.eq(-1)
        },
        eq: function(a) {
            var b = this.length,
                c = +a + (a < 0 ? b : 0);
            return this.pushStack(c >= 0 && c < b ? [this[c]] : [])
        },
        end: function() {
            return this.prevObject || this.constructor()
        },
        push: h,
        sort: c.sort,
        splice: c.splice
    }, r.extend = r.fn.extend = function() {
        var a, b, c, d, e, f, g = arguments[0] || {},
            h = 1,
            i = arguments.length,
            j = !1;
        for ("boolean" == typeof g && (j = g, g = arguments[h] || {}, h++), "object" == typeof g || r.isFunction(g) || (g = {}), h === i && (g = this, h--); h < i; h++)
            if (null != (a = arguments[h]))
                for (b in a) c = g[b], d = a[b], g !== d && (j && d && (r.isPlainObject(d) || (e = r.isArray(d))) ? (e ? (e = !1, f = c && r.isArray(c) ? c : []) : f = c && r.isPlainObject(c) ? c : {}, g[b] = r.extend(j, f, d)) : void 0 !== d && (g[b] = d));
        return g
    }, r.extend({
        expando: "jQuery" + (q + Math.random()).replace(/\D/g, ""),
        isReady: !0,
        error: function(a) {
            throw new Error(a)
        },
        noop: function() {},
        isFunction: function(a) {
            return "function" === r.type(a)
        },
        isArray: Array.isArray,
        isWindow: function(a) {
            return null != a && a === a.window
        },
        isNumeric: function(a) {
            var b = r.type(a);
            return ("number" === b || "string" === b) && !isNaN(a - parseFloat(a))
        },
        isPlainObject: function(a) {
            var b, c;
            return !(!a || "[object Object]" !== k.call(a)) && (!(b = e(a)) || (c = l.call(b, "constructor") && b.constructor, "function" == typeof c && m.call(c) === n))
        },
        isEmptyObject: function(a) {
            var b;
            for (b in a) return !1;
            return !0
        },
        type: function(a) {
            return null == a ? a + "" : "object" == typeof a || "function" == typeof a ? j[k.call(a)] || "object" : typeof a
        },
        globalEval: function(a) {
            p(a)
        },
        camelCase: function(a) {
            return a.replace(t, "ms-").replace(u, v)
        },
        nodeName: function(a, b) {
            return a.nodeName && a.nodeName.toLowerCase() === b.toLowerCase()
        },
        each: function(a, b) {
            var c, d = 0;
            if (w(a)) {
                for (c = a.length; d < c; d++)
                    if (b.call(a[d], d, a[d]) === !1) break
            } else
                for (d in a)
                    if (b.call(a[d], d, a[d]) === !1) break;
            return a
        },
        trim: function(a) {
            return null == a ? "" : (a + "").replace(s, "")
        },
        makeArray: function(a, b) {
            var c = b || [];
            return null != a && (w(Object(a)) ? r.merge(c, "string" == typeof a ? [a] : a) : h.call(c, a)), c
        },
        inArray: function(a, b, c) {
            return null == b ? -1 : i.call(b, a, c)
        },
        merge: function(a, b) {
            for (var c = +b.length, d = 0, e = a.length; d < c; d++) a[e++] = b[d];
            return a.length = e, a
        },
        grep: function(a, b, c) {
            for (var d, e = [], f = 0, g = a.length, h = !c; f < g; f++) d = !b(a[f], f), d !== h && e.push(a[f]);
            return e
        },
        map: function(a, b, c) {
            var d, e, f = 0,
                h = [];
            if (w(a))
                for (d = a.length; f < d; f++) e = b(a[f], f, c), null != e && h.push(e);
            else
                for (f in a) e = b(a[f], f, c), null != e && h.push(e);
            return g.apply([], h)
        },
        guid: 1,
        proxy: function(a, b) {
            var c, d, e;
            if ("string" == typeof b && (c = a[b], b = a, a = c), r.isFunction(a)) return d = f.call(arguments, 2), e = function() {
                return a.apply(b || this, d.concat(f.call(arguments)))
            }, e.guid = a.guid = a.guid || r.guid++, e
        },
        now: Date.now,
        support: o
    }), "function" == typeof Symbol && (r.fn[Symbol.iterator] = c[Symbol.iterator]), r.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "), function(a, b) {
        j["[object " + b + "]"] = b.toLowerCase()
    });

    function w(a) {
        var b = !!a && "length" in a && a.length,
            c = r.type(a);
        return "function" !== c && !r.isWindow(a) && ("array" === c || 0 === b || "number" == typeof b && b > 0 && b - 1 in a)
    }
    var x = function(a) {
        var b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u = "sizzle" + 1 * new Date,
            v = a.document,
            w = 0,
            x = 0,
            y = ha(),
            z = ha(),
            A = ha(),
            B = function(a, b) {
                return a === b && (l = !0), 0
            },
            C = {}.hasOwnProperty,
            D = [],
            E = D.pop,
            F = D.push,
            G = D.push,
            H = D.slice,
            I = function(a, b) {
                for (var c = 0, d = a.length; c < d; c++)
                    if (a[c] === b) return c;
                return -1
            },
            J = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",
            K = "[\\x20\\t\\r\\n\\f]",
            L = "(?:\\\\.|[\\w-]|[^\0-\\xa0])+",
            M = "\\[" + K + "*(" + L + ")(?:" + K + "*([*^$|!~]?=)" + K + "*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + L + "))|)" + K + "*\\]",
            N = ":(" + L + ")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|" + M + ")*)|.*)\\)|)",
            O = new RegExp(K + "+", "g"),
            P = new RegExp("^" + K + "+|((?:^|[^\\\\])(?:\\\\.)*)" + K + "+$", "g"),
            Q = new RegExp("^" + K + "*," + K + "*"),
            R = new RegExp("^" + K + "*([>+~]|" + K + ")" + K + "*"),
            S = new RegExp("=" + K + "*([^\\]'\"]*?)" + K + "*\\]", "g"),
            T = new RegExp(N),
            U = new RegExp("^" + L + "$"),
            V = {
                ID: new RegExp("^#(" + L + ")"),
                CLASS: new RegExp("^\\.(" + L + ")"),
                TAG: new RegExp("^(" + L + "|[*])"),
                ATTR: new RegExp("^" + M),
                PSEUDO: new RegExp("^" + N),
                CHILD: new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + K + "*(even|odd|(([+-]|)(\\d*)n|)" + K + "*(?:([+-]|)" + K + "*(\\d+)|))" + K + "*\\)|)", "i"),
                bool: new RegExp("^(?:" + J + ")$", "i"),
                needsContext: new RegExp("^" + K + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + K + "*((?:-\\d)?\\d*)" + K + "*\\)|)(?=[^-]|$)", "i")
            },
            W = /^(?:input|select|textarea|button)$/i,
            X = /^h\d$/i,
            Y = /^[^{]+\{\s*\[native \w/,
            Z = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,
            $ = /[+~]/,
            _ = new RegExp("\\\\([\\da-f]{1,6}" + K + "?|(" + K + ")|.)", "ig"),
            aa = function(a, b, c) {
                var d = "0x" + b - 65536;
                return d !== d || c ? b : d < 0 ? String.fromCharCode(d + 65536) : String.fromCharCode(d >> 10 | 55296, 1023 & d | 56320)
            },
            ba = /([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,
            ca = function(a, b) {
                return b ? "\0" === a ? "\ufffd" : a.slice(0, -1) + "\\" + a.charCodeAt(a.length - 1).toString(16) + " " : "\\" + a
            },
            da = function() {
                m()
            },
            ea = ta(function(a) {
                return a.disabled === !0 && ("form" in a || "label" in a)
            }, {
                dir: "parentNode",
                next: "legend"
            });
        try {
            G.apply(D = H.call(v.childNodes), v.childNodes), D[v.childNodes.length].nodeType
        } catch (fa) {
            G = {
                apply: D.length ? function(a, b) {
                    F.apply(a, H.call(b))
                } : function(a, b) {
                    var c = a.length,
                        d = 0;
                    while (a[c++] = b[d++]);
                    a.length = c - 1
                }
            }
        }

        function ga(a, b, d, e) {
            var f, h, j, k, l, o, r, s = b && b.ownerDocument,
                w = b ? b.nodeType : 9;
            if (d = d || [], "string" != typeof a || !a || 1 !== w && 9 !== w && 11 !== w) return d;
            if (!e && ((b ? b.ownerDocument || b : v) !== n && m(b), b = b || n, p)) {
                if (11 !== w && (l = Z.exec(a)))
                    if (f = l[1]) {
                        if (9 === w) {
                            if (!(j = b.getElementById(f))) return d;
                            if (j.id === f) return d.push(j), d
                        } else if (s && (j = s.getElementById(f)) && t(b, j) && j.id === f) return d.push(j), d
                    } else {
                        if (l[2]) return G.apply(d, b.getElementsByTagName(a)), d;
                        if ((f = l[3]) && c.getElementsByClassName && b.getElementsByClassName) return G.apply(d, b.getElementsByClassName(f)), d
                    }
                if (c.qsa && !A[a + " "] && (!q || !q.test(a))) {
                    if (1 !== w) s = b, r = a;
                    else if ("object" !== b.nodeName.toLowerCase()) {
                        (k = b.getAttribute("id")) ? k = k.replace(ba, ca): b.setAttribute("id", k = u), o = g(a), h = o.length;
                        while (h--) o[h] = "#" + k + " " + sa(o[h]);
                        r = o.join(","), s = $.test(a) && qa(b.parentNode) || b
                    }
                    if (r) try {
                        return G.apply(d, s.querySelectorAll(r)), d
                    } catch (x) {} finally {
                        k === u && b.removeAttribute("id")
                    }
                }
            }
            return i(a.replace(P, "$1"), b, d, e)
        }

        function ha() {
            var a = [];

            function b(c, e) {
                return a.push(c + " ") > d.cacheLength && delete b[a.shift()], b[c + " "] = e
            }
            return b
        }

        function ia(a) {
            return a[u] = !0, a
        }

        function ja(a) {
            var b = n.createElement("fieldset");
            try {
                return !!a(b)
            } catch (c) {
                return !1
            } finally {
                b.parentNode && b.parentNode.removeChild(b), b = null
            }
        }

        function ka(a, b) {
            var c = a.split("|"),
                e = c.length;
            while (e--) d.attrHandle[c[e]] = b
        }

        function la(a, b) {
            var c = b && a,
                d = c && 1 === a.nodeType && 1 === b.nodeType && a.sourceIndex - b.sourceIndex;
            if (d) return d;
            if (c)
                while (c = c.nextSibling)
                    if (c === b) return -1;
            return a ? 1 : -1
        }

        function ma(a) {
            return function(b) {
                var c = b.nodeName.toLowerCase();
                return "input" === c && b.type === a
            }
        }

        function na(a) {
            return function(b) {
                var c = b.nodeName.toLowerCase();
                return ("input" === c || "button" === c) && b.type === a
            }
        }

        function oa(a) {
            return function(b) {
                return "form" in b ? b.parentNode && b.disabled === !1 ? "label" in b ? "label" in b.parentNode ? b.parentNode.disabled === a : b.disabled === a : b.isDisabled === a || b.isDisabled !== !a && ea(b) === a : b.disabled === a : "label" in b && b.disabled === a
            }
        }

        function pa(a) {
            return ia(function(b) {
                return b = +b, ia(function(c, d) {
                    var e, f = a([], c.length, b),
                        g = f.length;
                    while (g--) c[e = f[g]] && (c[e] = !(d[e] = c[e]))
                })
            })
        }

        function qa(a) {
            return a && "undefined" != typeof a.getElementsByTagName && a
        }
        c = ga.support = {}, f = ga.isXML = function(a) {
            var b = a && (a.ownerDocument || a).documentElement;
            return !!b && "HTML" !== b.nodeName
        }, m = ga.setDocument = function(a) {
            var b, e, g = a ? a.ownerDocument || a : v;
            return g !== n && 9 === g.nodeType && g.documentElement ? (n = g, o = n.documentElement, p = !f(n), v !== n && (e = n.defaultView) && e.top !== e && (e.addEventListener ? e.addEventListener("unload", da, !1) : e.attachEvent && e.attachEvent("onunload", da)), c.attributes = ja(function(a) {
                return a.className = "i", !a.getAttribute("className")
            }), c.getElementsByTagName = ja(function(a) {
                return a.appendChild(n.createComment("")), !a.getElementsByTagName("*").length
            }), c.getElementsByClassName = Y.test(n.getElementsByClassName), c.getById = ja(function(a) {
                return o.appendChild(a).id = u, !n.getElementsByName || !n.getElementsByName(u).length
            }), c.getById ? (d.filter.ID = function(a) {
                var b = a.replace(_, aa);
                return function(a) {
                    return a.getAttribute("id") === b
                }
            }, d.find.ID = function(a, b) {
                if ("undefined" != typeof b.getElementById && p) {
                    var c = b.getElementById(a);
                    return c ? [c] : []
                }
            }) : (d.filter.ID = function(a) {
                var b = a.replace(_, aa);
                return function(a) {
                    var c = "undefined" != typeof a.getAttributeNode && a.getAttributeNode("id");
                    return c && c.value === b
                }
            }, d.find.ID = function(a, b) {
                if ("undefined" != typeof b.getElementById && p) {
                    var c, d, e, f = b.getElementById(a);
                    if (f) {
                        if (c = f.getAttributeNode("id"), c && c.value === a) return [f];
                        e = b.getElementsByName(a), d = 0;
                        while (f = e[d++])
                            if (c = f.getAttributeNode("id"), c && c.value === a) return [f]
                    }
                    return []
                }
            }), d.find.TAG = c.getElementsByTagName ? function(a, b) {
                return "undefined" != typeof b.getElementsByTagName ? b.getElementsByTagName(a) : c.qsa ? b.querySelectorAll(a) : void 0
            } : function(a, b) {
                var c, d = [],
                    e = 0,
                    f = b.getElementsByTagName(a);
                if ("*" === a) {
                    while (c = f[e++]) 1 === c.nodeType && d.push(c);
                    return d
                }
                return f
            }, d.find.CLASS = c.getElementsByClassName && function(a, b) {
                if ("undefined" != typeof b.getElementsByClassName && p) return b.getElementsByClassName(a)
            }, r = [], q = [], (c.qsa = Y.test(n.querySelectorAll)) && (ja(function(a) {
                o.appendChild(a).innerHTML = "<a id='" + u + "'></a><select id='" + u + "-\r\\' msallowcapture=''><option selected=''></option></select>", a.querySelectorAll("[msallowcapture^='']").length && q.push("[*^$]=" + K + "*(?:''|\"\")"), a.querySelectorAll("[selected]").length || q.push("\\[" + K + "*(?:value|" + J + ")"), a.querySelectorAll("[id~=" + u + "-]").length || q.push("~="), a.querySelectorAll(":checked").length || q.push(":checked"), a.querySelectorAll("a#" + u + "+*").length || q.push(".#.+[+~]")
            }), ja(function(a) {
                a.innerHTML = "<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";
                var b = n.createElement("input");
                b.setAttribute("type", "hidden"), a.appendChild(b).setAttribute("name", "D"), a.querySelectorAll("[name=d]").length && q.push("name" + K + "*[*^$|!~]?="), 2 !== a.querySelectorAll(":enabled").length && q.push(":enabled", ":disabled"), o.appendChild(a).disabled = !0, 2 !== a.querySelectorAll(":disabled").length && q.push(":enabled", ":disabled"), a.querySelectorAll("*,:x"), q.push(",.*:")
            })), (c.matchesSelector = Y.test(s = o.matches || o.webkitMatchesSelector || o.mozMatchesSelector || o.oMatchesSelector || o.msMatchesSelector)) && ja(function(a) {
                c.disconnectedMatch = s.call(a, "*"), s.call(a, "[s!='']:x"), r.push("!=", N)
            }), q = q.length && new RegExp(q.join("|")), r = r.length && new RegExp(r.join("|")), b = Y.test(o.compareDocumentPosition), t = b || Y.test(o.contains) ? function(a, b) {
                var c = 9 === a.nodeType ? a.documentElement : a,
                    d = b && b.parentNode;
                return a === d || !(!d || 1 !== d.nodeType || !(c.contains ? c.contains(d) : a.compareDocumentPosition && 16 & a.compareDocumentPosition(d)))
            } : function(a, b) {
                if (b)
                    while (b = b.parentNode)
                        if (b === a) return !0;
                return !1
            }, B = b ? function(a, b) {
                if (a === b) return l = !0, 0;
                var d = !a.compareDocumentPosition - !b.compareDocumentPosition;
                return d ? d : (d = (a.ownerDocument || a) === (b.ownerDocument || b) ? a.compareDocumentPosition(b) : 1, 1 & d || !c.sortDetached && b.compareDocumentPosition(a) === d ? a === n || a.ownerDocument === v && t(v, a) ? -1 : b === n || b.ownerDocument === v && t(v, b) ? 1 : k ? I(k, a) - I(k, b) : 0 : 4 & d ? -1 : 1)
            } : function(a, b) {
                if (a === b) return l = !0, 0;
                var c, d = 0,
                    e = a.parentNode,
                    f = b.parentNode,
                    g = [a],
                    h = [b];
                if (!e || !f) return a === n ? -1 : b === n ? 1 : e ? -1 : f ? 1 : k ? I(k, a) - I(k, b) : 0;
                if (e === f) return la(a, b);
                c = a;
                while (c = c.parentNode) g.unshift(c);
                c = b;
                while (c = c.parentNode) h.unshift(c);
                while (g[d] === h[d]) d++;
                return d ? la(g[d], h[d]) : g[d] === v ? -1 : h[d] === v ? 1 : 0
            }, n) : n
        }, ga.matches = function(a, b) {
            return ga(a, null, null, b)
        }, ga.matchesSelector = function(a, b) {
            if ((a.ownerDocument || a) !== n && m(a), b = b.replace(S, "='$1']"), c.matchesSelector && p && !A[b + " "] && (!r || !r.test(b)) && (!q || !q.test(b))) try {
                var d = s.call(a, b);
                if (d || c.disconnectedMatch || a.document && 11 !== a.document.nodeType) return d
            } catch (e) {}
            return ga(b, n, null, [a]).length > 0
        }, ga.contains = function(a, b) {
            return (a.ownerDocument || a) !== n && m(a), t(a, b)
        }, ga.attr = function(a, b) {
            (a.ownerDocument || a) !== n && m(a);
            var e = d.attrHandle[b.toLowerCase()],
                f = e && C.call(d.attrHandle, b.toLowerCase()) ? e(a, b, !p) : void 0;
            return void 0 !== f ? f : c.attributes || !p ? a.getAttribute(b) : (f = a.getAttributeNode(b)) && f.specified ? f.value : null
        }, ga.escape = function(a) {
            return (a + "").replace(ba, ca)
        }, ga.error = function(a) {
            throw new Error("Syntax error, unrecognized expression: " + a)
        }, ga.uniqueSort = function(a) {
            var b, d = [],
                e = 0,
                f = 0;
            if (l = !c.detectDuplicates, k = !c.sortStable && a.slice(0), a.sort(B), l) {
                while (b = a[f++]) b === a[f] && (e = d.push(f));
                while (e--) a.splice(d[e], 1)
            }
            return k = null, a
        }, e = ga.getText = function(a) {
            var b, c = "",
                d = 0,
                f = a.nodeType;
            if (f) {
                if (1 === f || 9 === f || 11 === f) {
                    if ("string" == typeof a.textContent) return a.textContent;
                    for (a = a.firstChild; a; a = a.nextSibling) c += e(a)
                } else if (3 === f || 4 === f) return a.nodeValue
            } else
                while (b = a[d++]) c += e(b);
            return c
        }, d = ga.selectors = {
            cacheLength: 50,
            createPseudo: ia,
            match: V,
            attrHandle: {},
            find: {},
            relative: {
                ">": {
                    dir: "parentNode",
                    first: !0
                },
                " ": {
                    dir: "parentNode"
                },
                "+": {
                    dir: "previousSibling",
                    first: !0
                },
                "~": {
                    dir: "previousSibling"
                }
            },
            preFilter: {
                ATTR: function(a) {
                    return a[1] = a[1].replace(_, aa), a[3] = (a[3] || a[4] || a[5] || "").replace(_, aa), "~=" === a[2] && (a[3] = " " + a[3] + " "), a.slice(0, 4)
                },
                CHILD: function(a) {
                    return a[1] = a[1].toLowerCase(), "nth" === a[1].slice(0, 3) ? (a[3] || ga.error(a[0]), a[4] = +(a[4] ? a[5] + (a[6] || 1) : 2 * ("even" === a[3] || "odd" === a[3])), a[5] = +(a[7] + a[8] || "odd" === a[3])) : a[3] && ga.error(a[0]), a
                },
                PSEUDO: function(a) {
                    var b, c = !a[6] && a[2];
                    return V.CHILD.test(a[0]) ? null : (a[3] ? a[2] = a[4] || a[5] || "" : c && T.test(c) && (b = g(c, !0)) && (b = c.indexOf(")", c.length - b) - c.length) && (a[0] = a[0].slice(0, b), a[2] = c.slice(0, b)), a.slice(0, 3))
                }
            },
            filter: {
                TAG: function(a) {
                    var b = a.replace(_, aa).toLowerCase();
                    return "*" === a ? function() {
                        return !0
                    } : function(a) {
                        return a.nodeName && a.nodeName.toLowerCase() === b
                    }
                },
                CLASS: function(a) {
                    var b = y[a + " "];
                    return b || (b = new RegExp("(^|" + K + ")" + a + "(" + K + "|$)")) && y(a, function(a) {
                        return b.test("string" == typeof a.className && a.className || "undefined" != typeof a.getAttribute && a.getAttribute("class") || "")
                    })
                },
                ATTR: function(a, b, c) {
                    return function(d) {
                        var e = ga.attr(d, a);
                        return null == e ? "!=" === b : !b || (e += "", "=" === b ? e === c : "!=" === b ? e !== c : "^=" === b ? c && 0 === e.indexOf(c) : "*=" === b ? c && e.indexOf(c) > -1 : "$=" === b ? c && e.slice(-c.length) === c : "~=" === b ? (" " + e.replace(O, " ") + " ").indexOf(c) > -1 : "|=" === b && (e === c || e.slice(0, c.length + 1) === c + "-"))
                    }
                },
                CHILD: function(a, b, c, d, e) {
                    var f = "nth" !== a.slice(0, 3),
                        g = "last" !== a.slice(-4),
                        h = "of-type" === b;
                    return 1 === d && 0 === e ? function(a) {
                        return !!a.parentNode
                    } : function(b, c, i) {
                        var j, k, l, m, n, o, p = f !== g ? "nextSibling" : "previousSibling",
                            q = b.parentNode,
                            r = h && b.nodeName.toLowerCase(),
                            s = !i && !h,
                            t = !1;
                        if (q) {
                            if (f) {
                                while (p) {
                                    m = b;
                                    while (m = m[p])
                                        if (h ? m.nodeName.toLowerCase() === r : 1 === m.nodeType) return !1;
                                    o = p = "only" === a && !o && "nextSibling"
                                }
                                return !0
                            }
                            if (o = [g ? q.firstChild : q.lastChild], g && s) {
                                m = q, l = m[u] || (m[u] = {}), k = l[m.uniqueID] || (l[m.uniqueID] = {}), j = k[a] || [], n = j[0] === w && j[1], t = n && j[2], m = n && q.childNodes[n];
                                while (m = ++n && m && m[p] || (t = n = 0) || o.pop())
                                    if (1 === m.nodeType && ++t && m === b) {
                                        k[a] = [w, n, t];
                                        break
                                    }
                            } else if (s && (m = b, l = m[u] || (m[u] = {}), k = l[m.uniqueID] || (l[m.uniqueID] = {}), j = k[a] || [], n = j[0] === w && j[1], t = n), t === !1)
                                while (m = ++n && m && m[p] || (t = n = 0) || o.pop())
                                    if ((h ? m.nodeName.toLowerCase() === r : 1 === m.nodeType) && ++t && (s && (l = m[u] || (m[u] = {}), k = l[m.uniqueID] || (l[m.uniqueID] = {}), k[a] = [w, t]), m === b)) break;
                            return t -= e, t === d || t % d === 0 && t / d >= 0
                        }
                    }
                },
                PSEUDO: function(a, b) {
                    var c, e = d.pseudos[a] || d.setFilters[a.toLowerCase()] || ga.error("unsupported pseudo: " + a);
                    return e[u] ? e(b) : e.length > 1 ? (c = [a, a, "", b], d.setFilters.hasOwnProperty(a.toLowerCase()) ? ia(function(a, c) {
                        var d, f = e(a, b),
                            g = f.length;
                        while (g--) d = I(a, f[g]), a[d] = !(c[d] = f[g])
                    }) : function(a) {
                        return e(a, 0, c)
                    }) : e
                }
            },
            pseudos: {
                not: ia(function(a) {
                    var b = [],
                        c = [],
                        d = h(a.replace(P, "$1"));
                    return d[u] ? ia(function(a, b, c, e) {
                        var f, g = d(a, null, e, []),
                            h = a.length;
                        while (h--)(f = g[h]) && (a[h] = !(b[h] = f))
                    }) : function(a, e, f) {
                        return b[0] = a, d(b, null, f, c), b[0] = null, !c.pop()
                    }
                }),
                has: ia(function(a) {
                    return function(b) {
                        return ga(a, b).length > 0
                    }
                }),
                contains: ia(function(a) {
                    return a = a.replace(_, aa),
                        function(b) {
                            return (b.textContent || b.innerText || e(b)).indexOf(a) > -1
                        }
                }),
                lang: ia(function(a) {
                    return U.test(a || "") || ga.error("unsupported lang: " + a), a = a.replace(_, aa).toLowerCase(),
                        function(b) {
                            var c;
                            do
                                if (c = p ? b.lang : b.getAttribute("xml:lang") || b.getAttribute("lang")) return c = c.toLowerCase(), c === a || 0 === c.indexOf(a + "-"); while ((b = b.parentNode) && 1 === b.nodeType);
                            return !1
                        }
                }),
                target: function(b) {
                    var c = a.location && a.location.hash;
                    return c && c.slice(1) === b.id
                },
                root: function(a) {
                    return a === o
                },
                focus: function(a) {
                    return a === n.activeElement && (!n.hasFocus || n.hasFocus()) && !!(a.type || a.href || ~a.tabIndex)
                },
                enabled: oa(!1),
                disabled: oa(!0),
                checked: function(a) {
                    var b = a.nodeName.toLowerCase();
                    return "input" === b && !!a.checked || "option" === b && !!a.selected
                },
                selected: function(a) {
                    return a.parentNode && a.parentNode.selectedIndex, a.selected === !0
                },
                empty: function(a) {
                    for (a = a.firstChild; a; a = a.nextSibling)
                        if (a.nodeType < 6) return !1;
                    return !0
                },
                parent: function(a) {
                    return !d.pseudos.empty(a)
                },
                header: function(a) {
                    return X.test(a.nodeName)
                },
                input: function(a) {
                    return W.test(a.nodeName)
                },
                button: function(a) {
                    var b = a.nodeName.toLowerCase();
                    return "input" === b && "button" === a.type || "button" === b
                },
                text: function(a) {
                    var b;
                    return "input" === a.nodeName.toLowerCase() && "text" === a.type && (null == (b = a.getAttribute("type")) || "text" === b.toLowerCase())
                },
                first: pa(function() {
                    return [0]
                }),
                last: pa(function(a, b) {
                    return [b - 1]
                }),
                eq: pa(function(a, b, c) {
                    return [c < 0 ? c + b : c]
                }),
                even: pa(function(a, b) {
                    for (var c = 0; c < b; c += 2) a.push(c);
                    return a
                }),
                odd: pa(function(a, b) {
                    for (var c = 1; c < b; c += 2) a.push(c);
                    return a
                }),
                lt: pa(function(a, b, c) {
                    for (var d = c < 0 ? c + b : c; --d >= 0;) a.push(d);
                    return a
                }),
                gt: pa(function(a, b, c) {
                    for (var d = c < 0 ? c + b : c; ++d < b;) a.push(d);
                    return a
                })
            }
        }, d.pseudos.nth = d.pseudos.eq;
        for (b in {
                radio: !0,
                checkbox: !0,
                file: !0,
                password: !0,
                image: !0
            }) d.pseudos[b] = ma(b);
        for (b in {
                submit: !0,
                reset: !0
            }) d.pseudos[b] = na(b);

        function ra() {}
        ra.prototype = d.filters = d.pseudos, d.setFilters = new ra, g = ga.tokenize = function(a, b) {
            var c, e, f, g, h, i, j, k = z[a + " "];
            if (k) return b ? 0 : k.slice(0);
            h = a, i = [], j = d.preFilter;
            while (h) {
                c && !(e = Q.exec(h)) || (e && (h = h.slice(e[0].length) || h), i.push(f = [])), c = !1, (e = R.exec(h)) && (c = e.shift(), f.push({
                    value: c,
                    type: e[0].replace(P, " ")
                }), h = h.slice(c.length));
                for (g in d.filter) !(e = V[g].exec(h)) || j[g] && !(e = j[g](e)) || (c = e.shift(), f.push({
                    value: c,
                    type: g,
                    matches: e
                }), h = h.slice(c.length));
                if (!c) break
            }
            return b ? h.length : h ? ga.error(a) : z(a, i).slice(0)
        };

        function sa(a) {
            for (var b = 0, c = a.length, d = ""; b < c; b++) d += a[b].value;
            return d
        }

        function ta(a, b, c) {
            var d = b.dir,
                e = b.next,
                f = e || d,
                g = c && "parentNode" === f,
                h = x++;
            return b.first ? function(b, c, e) {
                while (b = b[d])
                    if (1 === b.nodeType || g) return a(b, c, e);
                return !1
            } : function(b, c, i) {
                var j, k, l, m = [w, h];
                if (i) {
                    while (b = b[d])
                        if ((1 === b.nodeType || g) && a(b, c, i)) return !0
                } else
                    while (b = b[d])
                        if (1 === b.nodeType || g)
                            if (l = b[u] || (b[u] = {}), k = l[b.uniqueID] || (l[b.uniqueID] = {}), e && e === b.nodeName.toLowerCase()) b = b[d] || b;
                            else {
                                if ((j = k[f]) && j[0] === w && j[1] === h) return m[2] = j[2];
                                if (k[f] = m, m[2] = a(b, c, i)) return !0
                            } return !1
            }
        }

        function ua(a) {
            return a.length > 1 ? function(b, c, d) {
                var e = a.length;
                while (e--)
                    if (!a[e](b, c, d)) return !1;
                return !0
            } : a[0]
        }

        function va(a, b, c) {
            for (var d = 0, e = b.length; d < e; d++) ga(a, b[d], c);
            return c
        }

        function wa(a, b, c, d, e) {
            for (var f, g = [], h = 0, i = a.length, j = null != b; h < i; h++)(f = a[h]) && (c && !c(f, d, e) || (g.push(f), j && b.push(h)));
            return g
        }

        function xa(a, b, c, d, e, f) {
            return d && !d[u] && (d = xa(d)), e && !e[u] && (e = xa(e, f)), ia(function(f, g, h, i) {
                var j, k, l, m = [],
                    n = [],
                    o = g.length,
                    p = f || va(b || "*", h.nodeType ? [h] : h, []),
                    q = !a || !f && b ? p : wa(p, m, a, h, i),
                    r = c ? e || (f ? a : o || d) ? [] : g : q;
                if (c && c(q, r, h, i), d) {
                    j = wa(r, n), d(j, [], h, i), k = j.length;
                    while (k--)(l = j[k]) && (r[n[k]] = !(q[n[k]] = l))
                }
                if (f) {
                    if (e || a) {
                        if (e) {
                            j = [], k = r.length;
                            while (k--)(l = r[k]) && j.push(q[k] = l);
                            e(null, r = [], j, i)
                        }
                        k = r.length;
                        while (k--)(l = r[k]) && (j = e ? I(f, l) : m[k]) > -1 && (f[j] = !(g[j] = l))
                    }
                } else r = wa(r === g ? r.splice(o, r.length) : r), e ? e(null, g, r, i) : G.apply(g, r)
            })
        }

        function ya(a) {
            for (var b, c, e, f = a.length, g = d.relative[a[0].type], h = g || d.relative[" "], i = g ? 1 : 0, k = ta(function(a) {
                    return a === b
                }, h, !0), l = ta(function(a) {
                    return I(b, a) > -1
                }, h, !0), m = [function(a, c, d) {
                    var e = !g && (d || c !== j) || ((b = c).nodeType ? k(a, c, d) : l(a, c, d));
                    return b = null, e
                }]; i < f; i++)
                if (c = d.relative[a[i].type]) m = [ta(ua(m), c)];
                else {
                    if (c = d.filter[a[i].type].apply(null, a[i].matches), c[u]) {
                        for (e = ++i; e < f; e++)
                            if (d.relative[a[e].type]) break;
                        return xa(i > 1 && ua(m), i > 1 && sa(a.slice(0, i - 1).concat({
                            value: " " === a[i - 2].type ? "*" : ""
                        })).replace(P, "$1"), c, i < e && ya(a.slice(i, e)), e < f && ya(a = a.slice(e)), e < f && sa(a))
                    }
                    m.push(c)
                }
            return ua(m)
        }

        function za(a, b) {
            var c = b.length > 0,
                e = a.length > 0,
                f = function(f, g, h, i, k) {
                    var l, o, q, r = 0,
                        s = "0",
                        t = f && [],
                        u = [],
                        v = j,
                        x = f || e && d.find.TAG("*", k),
                        y = w += null == v ? 1 : Math.random() || .1,
                        z = x.length;
                    for (k && (j = g === n || g || k); s !== z && null != (l = x[s]); s++) {
                        if (e && l) {
                            o = 0, g || l.ownerDocument === n || (m(l), h = !p);
                            while (q = a[o++])
                                if (q(l, g || n, h)) {
                                    i.push(l);
                                    break
                                }
                            k && (w = y)
                        }
                        c && ((l = !q && l) && r--, f && t.push(l))
                    }
                    if (r += s, c && s !== r) {
                        o = 0;
                        while (q = b[o++]) q(t, u, g, h);
                        if (f) {
                            if (r > 0)
                                while (s--) t[s] || u[s] || (u[s] = E.call(i));
                            u = wa(u)
                        }
                        G.apply(i, u), k && !f && u.length > 0 && r + b.length > 1 && ga.uniqueSort(i)
                    }
                    return k && (w = y, j = v), t
                };
            return c ? ia(f) : f
        }
        return h = ga.compile = function(a, b) {
            var c, d = [],
                e = [],
                f = A[a + " "];
            if (!f) {
                b || (b = g(a)), c = b.length;
                while (c--) f = ya(b[c]), f[u] ? d.push(f) : e.push(f);
                f = A(a, za(e, d)), f.selector = a
            }
            return f
        }, i = ga.select = function(a, b, c, e) {
            var f, i, j, k, l, m = "function" == typeof a && a,
                n = !e && g(a = m.selector || a);
            if (c = c || [], 1 === n.length) {
                if (i = n[0] = n[0].slice(0), i.length > 2 && "ID" === (j = i[0]).type && 9 === b.nodeType && p && d.relative[i[1].type]) {
                    if (b = (d.find.ID(j.matches[0].replace(_, aa), b) || [])[0], !b) return c;
                    m && (b = b.parentNode), a = a.slice(i.shift().value.length)
                }
                f = V.needsContext.test(a) ? 0 : i.length;
                while (f--) {
                    if (j = i[f], d.relative[k = j.type]) break;
                    if ((l = d.find[k]) && (e = l(j.matches[0].replace(_, aa), $.test(i[0].type) && qa(b.parentNode) || b))) {
                        if (i.splice(f, 1), a = e.length && sa(i), !a) return G.apply(c, e), c;
                        break
                    }
                }
            }
            return (m || h(a, n))(e, b, !p, c, !b || $.test(a) && qa(b.parentNode) || b), c
        }, c.sortStable = u.split("").sort(B).join("") === u, c.detectDuplicates = !!l, m(), c.sortDetached = ja(function(a) {
            return 1 & a.compareDocumentPosition(n.createElement("fieldset"))
        }), ja(function(a) {
            return a.innerHTML = "<a href='#'></a>", "#" === a.firstChild.getAttribute("href")
        }) || ka("type|href|height|width", function(a, b, c) {
            if (!c) return a.getAttribute(b, "type" === b.toLowerCase() ? 1 : 2)
        }), c.attributes && ja(function(a) {
            return a.innerHTML = "<input/>", a.firstChild.setAttribute("value", ""), "" === a.firstChild.getAttribute("value")
        }) || ka("value", function(a, b, c) {
            if (!c && "input" === a.nodeName.toLowerCase()) return a.defaultValue
        }), ja(function(a) {
            return null == a.getAttribute("disabled")
        }) || ka(J, function(a, b, c) {
            var d;
            if (!c) return a[b] === !0 ? b.toLowerCase() : (d = a.getAttributeNode(b)) && d.specified ? d.value : null
        }), ga
    }(a);
    r.find = x, r.expr = x.selectors, r.expr[":"] = r.expr.pseudos, r.uniqueSort = r.unique = x.uniqueSort, r.text = x.getText, r.isXMLDoc = x.isXML, r.contains = x.contains, r.escapeSelector = x.escape;
    var y = function(a, b, c) {
            var d = [],
                e = void 0 !== c;
            while ((a = a[b]) && 9 !== a.nodeType)
                if (1 === a.nodeType) {
                    if (e && r(a).is(c)) break;
                    d.push(a)
                }
            return d
        },
        z = function(a, b) {
            for (var c = []; a; a = a.nextSibling) 1 === a.nodeType && a !== b && c.push(a);
            return c
        },
        A = r.expr.match.needsContext,
        B = /^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,
        C = /^.[^:#\[\.,]*$/;

    function D(a, b, c) {
        return r.isFunction(b) ? r.grep(a, function(a, d) {
            return !!b.call(a, d, a) !== c
        }) : b.nodeType ? r.grep(a, function(a) {
            return a === b !== c
        }) : "string" != typeof b ? r.grep(a, function(a) {
            return i.call(b, a) > -1 !== c
        }) : C.test(b) ? r.filter(b, a, c) : (b = r.filter(b, a), r.grep(a, function(a) {
            return i.call(b, a) > -1 !== c && 1 === a.nodeType
        }))
    }
    r.filter = function(a, b, c) {
        var d = b[0];
        return c && (a = ":not(" + a + ")"), 1 === b.length && 1 === d.nodeType ? r.find.matchesSelector(d, a) ? [d] : [] : r.find.matches(a, r.grep(b, function(a) {
            return 1 === a.nodeType
        }))
    }, r.fn.extend({
        find: function(a) {
            var b, c, d = this.length,
                e = this;
            if ("string" != typeof a) return this.pushStack(r(a).filter(function() {
                for (b = 0; b < d; b++)
                    if (r.contains(e[b], this)) return !0
            }));
            for (c = this.pushStack([]), b = 0; b < d; b++) r.find(a, e[b], c);
            return d > 1 ? r.uniqueSort(c) : c
        },
        filter: function(a) {
            return this.pushStack(D(this, a || [], !1))
        },
        not: function(a) {
            return this.pushStack(D(this, a || [], !0))
        },
        is: function(a) {
            return !!D(this, "string" == typeof a && A.test(a) ? r(a) : a || [], !1).length
        }
    });
    var E, F = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,
        G = r.fn.init = function(a, b, c) {
            var e, f;
            if (!a) return this;
            if (c = c || E, "string" == typeof a) {
                if (e = "<" === a[0] && ">" === a[a.length - 1] && a.length >= 3 ? [null, a, null] : F.exec(a), !e || !e[1] && b) return !b || b.jquery ? (b || c).find(a) : this.constructor(b).find(a);
                if (e[1]) {
                    if (b = b instanceof r ? b[0] : b, r.merge(this, r.parseHTML(e[1], b && b.nodeType ? b.ownerDocument || b : d, !0)), B.test(e[1]) && r.isPlainObject(b))
                        for (e in b) r.isFunction(this[e]) ? this[e](b[e]) : this.attr(e, b[e]);
                    return this
                }
                return f = d.getElementById(e[2]), f && (this[0] = f, this.length = 1), this
            }
            return a.nodeType ? (this[0] = a, this.length = 1, this) : r.isFunction(a) ? void 0 !== c.ready ? c.ready(a) : a(r) : r.makeArray(a, this)
        };
    G.prototype = r.fn, E = r(d);
    var H = /^(?:parents|prev(?:Until|All))/,
        I = {
            children: !0,
            contents: !0,
            next: !0,
            prev: !0
        };
    r.fn.extend({
        has: function(a) {
            var b = r(a, this),
                c = b.length;
            return this.filter(function() {
                for (var a = 0; a < c; a++)
                    if (r.contains(this, b[a])) return !0
            })
        },
        closest: function(a, b) {
            var c, d = 0,
                e = this.length,
                f = [],
                g = "string" != typeof a && r(a);
            if (!A.test(a))
                for (; d < e; d++)
                    for (c = this[d]; c && c !== b; c = c.parentNode)
                        if (c.nodeType < 11 && (g ? g.index(c) > -1 : 1 === c.nodeType && r.find.matchesSelector(c, a))) {
                            f.push(c);
                            break
                        }
            return this.pushStack(f.length > 1 ? r.uniqueSort(f) : f)
        },
        index: function(a) {
            return a ? "string" == typeof a ? i.call(r(a), this[0]) : i.call(this, a.jquery ? a[0] : a) : this[0] && this[0].parentNode ? this.first().prevAll().length : -1
        },
        add: function(a, b) {
            return this.pushStack(r.uniqueSort(r.merge(this.get(), r(a, b))))
        },
        addBack: function(a) {
            return this.add(null == a ? this.prevObject : this.prevObject.filter(a))
        }
    });

    function J(a, b) {
        while ((a = a[b]) && 1 !== a.nodeType);
        return a
    }
    r.each({
        parent: function(a) {
            var b = a.parentNode;
            return b && 11 !== b.nodeType ? b : null
        },
        parents: function(a) {
            return y(a, "parentNode")
        },
        parentsUntil: function(a, b, c) {
            return y(a, "parentNode", c)
        },
        next: function(a) {
            return J(a, "nextSibling")
        },
        prev: function(a) {
            return J(a, "previousSibling")
        },
        nextAll: function(a) {
            return y(a, "nextSibling")
        },
        prevAll: function(a) {
            return y(a, "previousSibling")
        },
        nextUntil: function(a, b, c) {
            return y(a, "nextSibling", c)
        },
        prevUntil: function(a, b, c) {
            return y(a, "previousSibling", c)
        },
        siblings: function(a) {
            return z((a.parentNode || {}).firstChild, a)
        },
        children: function(a) {
            return z(a.firstChild)
        },
        contents: function(a) {
            return a.contentDocument || r.merge([], a.childNodes)
        }
    }, function(a, b) {
        r.fn[a] = function(c, d) {
            var e = r.map(this, b, c);
            return "Until" !== a.slice(-5) && (d = c), d && "string" == typeof d && (e = r.filter(d, e)), this.length > 1 && (I[a] || r.uniqueSort(e), H.test(a) && e.reverse()), this.pushStack(e)
        }
    });
    var K = /[^\x20\t\r\n\f]+/g;

    function L(a) {
        var b = {};
        return r.each(a.match(K) || [], function(a, c) {
            b[c] = !0
        }), b
    }
    r.Callbacks = function(a) {
        a = "string" == typeof a ? L(a) : r.extend({}, a);
        var b, c, d, e, f = [],
            g = [],
            h = -1,
            i = function() {
                for (e = a.once, d = b = !0; g.length; h = -1) {
                    c = g.shift();
                    while (++h < f.length) f[h].apply(c[0], c[1]) === !1 && a.stopOnFalse && (h = f.length, c = !1)
                }
                a.memory || (c = !1), b = !1, e && (f = c ? [] : "")
            },
            j = {
                add: function() {
                    return f && (c && !b && (h = f.length - 1, g.push(c)), function d(b) {
                        r.each(b, function(b, c) {
                            r.isFunction(c) ? a.unique && j.has(c) || f.push(c) : c && c.length && "string" !== r.type(c) && d(c)
                        })
                    }(arguments), c && !b && i()), this
                },
                remove: function() {
                    return r.each(arguments, function(a, b) {
                        var c;
                        while ((c = r.inArray(b, f, c)) > -1) f.splice(c, 1), c <= h && h--
                    }), this
                },
                has: function(a) {
                    return a ? r.inArray(a, f) > -1 : f.length > 0
                },
                empty: function() {
                    return f && (f = []), this
                },
                disable: function() {
                    return e = g = [], f = c = "", this
                },
                disabled: function() {
                    return !f
                },
                lock: function() {
                    return e = g = [], c || b || (f = c = ""), this
                },
                locked: function() {
                    return !!e
                },
                fireWith: function(a, c) {
                    return e || (c = c || [], c = [a, c.slice ? c.slice() : c], g.push(c), b || i()), this
                },
                fire: function() {
                    return j.fireWith(this, arguments), this
                },
                fired: function() {
                    return !!d
                }
            };
        return j
    };

    function M(a) {
        return a
    }

    function N(a) {
        throw a
    }

    function O(a, b, c) {
        var d;
        try {
            a && r.isFunction(d = a.promise) ? d.call(a).done(b).fail(c) : a && r.isFunction(d = a.then) ? d.call(a, b, c) : b.call(void 0, a)
        } catch (a) {
            c.call(void 0, a)
        }
    }
    r.extend({
        Deferred: function(b) {
            var c = [
                    ["notify", "progress", r.Callbacks("memory"), r.Callbacks("memory"), 2],
                    ["resolve", "done", r.Callbacks("once memory"), r.Callbacks("once memory"), 0, "resolved"],
                    ["reject", "fail", r.Callbacks("once memory"), r.Callbacks("once memory"), 1, "rejected"]
                ],
                d = "pending",
                e = {
                    state: function() {
                        return d
                    },
                    always: function() {
                        return f.done(arguments).fail(arguments), this
                    },
                    "catch": function(a) {
                        return e.then(null, a)
                    },
                    pipe: function() {
                        var a = arguments;
                        return r.Deferred(function(b) {
                            r.each(c, function(c, d) {
                                var e = r.isFunction(a[d[4]]) && a[d[4]];
                                f[d[1]](function() {
                                    var a = e && e.apply(this, arguments);
                                    a && r.isFunction(a.promise) ? a.promise().progress(b.notify).done(b.resolve).fail(b.reject) : b[d[0] + "With"](this, e ? [a] : arguments)
                                })
                            }), a = null
                        }).promise()
                    },
                    then: function(b, d, e) {
                        var f = 0;

                        function g(b, c, d, e) {
                            return function() {
                                var h = this,
                                    i = arguments,
                                    j = function() {
                                        var a, j;
                                        if (!(b < f)) {
                                            if (a = d.apply(h, i), a === c.promise()) throw new TypeError("Thenable self-resolution");
                                            j = a && ("object" == typeof a || "function" == typeof a) && a.then, r.isFunction(j) ? e ? j.call(a, g(f, c, M, e), g(f, c, N, e)) : (f++, j.call(a, g(f, c, M, e), g(f, c, N, e), g(f, c, M, c.notifyWith))) : (d !== M && (h = void 0, i = [a]), (e || c.resolveWith)(h, i))
                                        }
                                    },
                                    k = e ? j : function() {
                                        try {
                                            j()
                                        } catch (a) {
                                            r.Deferred.exceptionHook && r.Deferred.exceptionHook(a, k.stackTrace), b + 1 >= f && (d !== N && (h = void 0, i = [a]), c.rejectWith(h, i))
                                        }
                                    };
                                b ? k() : (r.Deferred.getStackHook && (k.stackTrace = r.Deferred.getStackHook()), a.setTimeout(k))
                            }
                        }
                        return r.Deferred(function(a) {
                            c[0][3].add(g(0, a, r.isFunction(e) ? e : M, a.notifyWith)), c[1][3].add(g(0, a, r.isFunction(b) ? b : M)), c[2][3].add(g(0, a, r.isFunction(d) ? d : N))
                        }).promise()
                    },
                    promise: function(a) {
                        return null != a ? r.extend(a, e) : e
                    }
                },
                f = {};
            return r.each(c, function(a, b) {
                var g = b[2],
                    h = b[5];
                e[b[1]] = g.add, h && g.add(function() {
                    d = h
                }, c[3 - a][2].disable, c[0][2].lock), g.add(b[3].fire), f[b[0]] = function() {
                    return f[b[0] + "With"](this === f ? void 0 : this, arguments), this
                }, f[b[0] + "With"] = g.fireWith
            }), e.promise(f), b && b.call(f, f), f
        },
        when: function(a) {
            var b = arguments.length,
                c = b,
                d = Array(c),
                e = f.call(arguments),
                g = r.Deferred(),
                h = function(a) {
                    return function(c) {
                        d[a] = this, e[a] = arguments.length > 1 ? f.call(arguments) : c, --b || g.resolveWith(d, e)
                    }
                };
            if (b <= 1 && (O(a, g.done(h(c)).resolve, g.reject), "pending" === g.state() || r.isFunction(e[c] && e[c].then))) return g.then();
            while (c--) O(e[c], h(c), g.reject);
            return g.promise()
        }
    });
    var P = /^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;
    r.Deferred.exceptionHook = function(b, c) {
        a.console && a.console.warn && b && P.test(b.name) && a.console.warn("jQuery.Deferred exception: " + b.message, b.stack, c)
    }, r.readyException = function(b) {
        a.setTimeout(function() {
            throw b
        })
    };
    var Q = r.Deferred();
    r.fn.ready = function(a) {
        return Q.then(a)["catch"](function(a) {
            r.readyException(a)
        }), this
    }, r.extend({
        isReady: !1,
        readyWait: 1,
        holdReady: function(a) {
            a ? r.readyWait++ : r.ready(!0)
        },
        ready: function(a) {
            (a === !0 ? --r.readyWait : r.isReady) || (r.isReady = !0, a !== !0 && --r.readyWait > 0 || Q.resolveWith(d, [r]))
        }
    }), r.ready.then = Q.then;

    function R() {
        d.removeEventListener("DOMContentLoaded", R),
            a.removeEventListener("load", R), r.ready()
    }
    "complete" === d.readyState || "loading" !== d.readyState && !d.documentElement.doScroll ? a.setTimeout(r.ready) : (d.addEventListener("DOMContentLoaded", R), a.addEventListener("load", R));
    var S = function(a, b, c, d, e, f, g) {
            var h = 0,
                i = a.length,
                j = null == c;
            if ("object" === r.type(c)) {
                e = !0;
                for (h in c) S(a, b, h, c[h], !0, f, g)
            } else if (void 0 !== d && (e = !0, r.isFunction(d) || (g = !0), j && (g ? (b.call(a, d), b = null) : (j = b, b = function(a, b, c) {
                    return j.call(r(a), c)
                })), b))
                for (; h < i; h++) b(a[h], c, g ? d : d.call(a[h], h, b(a[h], c)));
            return e ? a : j ? b.call(a) : i ? b(a[0], c) : f
        },
        T = function(a) {
            return 1 === a.nodeType || 9 === a.nodeType || !+a.nodeType
        };

    function U() {
        this.expando = r.expando + U.uid++
    }
    U.uid = 1, U.prototype = {
        cache: function(a) {
            var b = a[this.expando];
            return b || (b = {}, T(a) && (a.nodeType ? a[this.expando] = b : Object.defineProperty(a, this.expando, {
                value: b,
                configurable: !0
            }))), b
        },
        set: function(a, b, c) {
            var d, e = this.cache(a);
            if ("string" == typeof b) e[r.camelCase(b)] = c;
            else
                for (d in b) e[r.camelCase(d)] = b[d];
            return e
        },
        get: function(a, b) {
            return void 0 === b ? this.cache(a) : a[this.expando] && a[this.expando][r.camelCase(b)]
        },
        access: function(a, b, c) {
            return void 0 === b || b && "string" == typeof b && void 0 === c ? this.get(a, b) : (this.set(a, b, c), void 0 !== c ? c : b)
        },
        remove: function(a, b) {
            var c, d = a[this.expando];
            if (void 0 !== d) {
                if (void 0 !== b) {
                    r.isArray(b) ? b = b.map(r.camelCase) : (b = r.camelCase(b), b = b in d ? [b] : b.match(K) || []), c = b.length;
                    while (c--) delete d[b[c]]
                }(void 0 === b || r.isEmptyObject(d)) && (a.nodeType ? a[this.expando] = void 0 : delete a[this.expando])
            }
        },
        hasData: function(a) {
            var b = a[this.expando];
            return void 0 !== b && !r.isEmptyObject(b)
        }
    };
    var V = new U,
        W = new U,
        X = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,
        Y = /[A-Z]/g;

    function Z(a) {
        return "true" === a || "false" !== a && ("null" === a ? null : a === +a + "" ? +a : X.test(a) ? JSON.parse(a) : a)
    }

    function $(a, b, c) {
        var d;
        if (void 0 === c && 1 === a.nodeType)
            if (d = "data-" + b.replace(Y, "-$&").toLowerCase(), c = a.getAttribute(d), "string" == typeof c) {
                try {
                    c = Z(c)
                } catch (e) {}
                W.set(a, b, c)
            } else c = void 0;
        return c
    }
    r.extend({
        hasData: function(a) {
            return W.hasData(a) || V.hasData(a)
        },
        data: function(a, b, c) {
            return W.access(a, b, c)
        },
        removeData: function(a, b) {
            W.remove(a, b)
        },
        _data: function(a, b, c) {
            return V.access(a, b, c)
        },
        _removeData: function(a, b) {
            V.remove(a, b)
        }
    }), r.fn.extend({
        data: function(a, b) {
            var c, d, e, f = this[0],
                g = f && f.attributes;
            if (void 0 === a) {
                if (this.length && (e = W.get(f), 1 === f.nodeType && !V.get(f, "hasDataAttrs"))) {
                    c = g.length;
                    while (c--) g[c] && (d = g[c].name, 0 === d.indexOf("data-") && (d = r.camelCase(d.slice(5)), $(f, d, e[d])));
                    V.set(f, "hasDataAttrs", !0)
                }
                return e
            }
            return "object" == typeof a ? this.each(function() {
                W.set(this, a)
            }) : S(this, function(b) {
                var c;
                if (f && void 0 === b) {
                    if (c = W.get(f, a), void 0 !== c) return c;
                    if (c = $(f, a), void 0 !== c) return c
                } else this.each(function() {
                    W.set(this, a, b)
                })
            }, null, b, arguments.length > 1, null, !0)
        },
        removeData: function(a) {
            return this.each(function() {
                W.remove(this, a)
            })
        }
    }), r.extend({
        queue: function(a, b, c) {
            var d;
            if (a) return b = (b || "fx") + "queue", d = V.get(a, b), c && (!d || r.isArray(c) ? d = V.access(a, b, r.makeArray(c)) : d.push(c)), d || []
        },
        dequeue: function(a, b) {
            b = b || "fx";
            var c = r.queue(a, b),
                d = c.length,
                e = c.shift(),
                f = r._queueHooks(a, b),
                g = function() {
                    r.dequeue(a, b)
                };
            "inprogress" === e && (e = c.shift(), d--), e && ("fx" === b && c.unshift("inprogress"), delete f.stop, e.call(a, g, f)), !d && f && f.empty.fire()
        },
        _queueHooks: function(a, b) {
            var c = b + "queueHooks";
            return V.get(a, c) || V.access(a, c, {
                empty: r.Callbacks("once memory").add(function() {
                    V.remove(a, [b + "queue", c])
                })
            })
        }
    }), r.fn.extend({
        queue: function(a, b) {
            var c = 2;
            return "string" != typeof a && (b = a, a = "fx", c--), arguments.length < c ? r.queue(this[0], a) : void 0 === b ? this : this.each(function() {
                var c = r.queue(this, a, b);
                r._queueHooks(this, a), "fx" === a && "inprogress" !== c[0] && r.dequeue(this, a)
            })
        },
        dequeue: function(a) {
            return this.each(function() {
                r.dequeue(this, a)
            })
        },
        clearQueue: function(a) {
            return this.queue(a || "fx", [])
        },
        promise: function(a, b) {
            var c, d = 1,
                e = r.Deferred(),
                f = this,
                g = this.length,
                h = function() {
                    --d || e.resolveWith(f, [f])
                };
            "string" != typeof a && (b = a, a = void 0), a = a || "fx";
            while (g--) c = V.get(f[g], a + "queueHooks"), c && c.empty && (d++, c.empty.add(h));
            return h(), e.promise(b)
        }
    });
    var _ = /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,
        aa = new RegExp("^(?:([+-])=|)(" + _ + ")([a-z%]*)$", "i"),
        ba = ["Top", "Right", "Bottom", "Left"],
        ca = function(a, b) {
            return a = b || a, "none" === a.style.display || "" === a.style.display && r.contains(a.ownerDocument, a) && "none" === r.css(a, "display")
        },
        da = function(a, b, c, d) {
            var e, f, g = {};
            for (f in b) g[f] = a.style[f], a.style[f] = b[f];
            e = c.apply(a, d || []);
            for (f in b) a.style[f] = g[f];
            return e
        };

    function ea(a, b, c, d) {
        var e, f = 1,
            g = 20,
            h = d ? function() {
                return d.cur()
            } : function() {
                return r.css(a, b, "")
            },
            i = h(),
            j = c && c[3] || (r.cssNumber[b] ? "" : "px"),
            k = (r.cssNumber[b] || "px" !== j && +i) && aa.exec(r.css(a, b));
        if (k && k[3] !== j) {
            j = j || k[3], c = c || [], k = +i || 1;
            do f = f || ".5", k /= f, r.style(a, b, k + j); while (f !== (f = h() / i) && 1 !== f && --g)
        }
        return c && (k = +k || +i || 0, e = c[1] ? k + (c[1] + 1) * c[2] : +c[2], d && (d.unit = j, d.start = k, d.end = e)), e
    }
    var fa = {};

    function ga(a) {
        var b, c = a.ownerDocument,
            d = a.nodeName,
            e = fa[d];
        return e ? e : (b = c.body.appendChild(c.createElement(d)), e = r.css(b, "display"), b.parentNode.removeChild(b), "none" === e && (e = "block"), fa[d] = e, e)
    }

    function ha(a, b) {
        for (var c, d, e = [], f = 0, g = a.length; f < g; f++) d = a[f], d.style && (c = d.style.display, b ? ("none" === c && (e[f] = V.get(d, "display") || null, e[f] || (d.style.display = "")), "" === d.style.display && ca(d) && (e[f] = ga(d))) : "none" !== c && (e[f] = "none", V.set(d, "display", c)));
        for (f = 0; f < g; f++) null != e[f] && (a[f].style.display = e[f]);
        return a
    }
    r.fn.extend({
        show: function() {
            return ha(this, !0)
        },
        hide: function() {
            return ha(this)
        },
        toggle: function(a) {
            return "boolean" == typeof a ? a ? this.show() : this.hide() : this.each(function() {
                ca(this) ? r(this).show() : r(this).hide()
            })
        }
    });
    var ia = /^(?:checkbox|radio)$/i,
        ja = /<([a-z][^\/\0>\x20\t\r\n\f]+)/i,
        ka = /^$|\/(?:java|ecma)script/i,
        la = {
            option: [1, "<select multiple='multiple'>", "</select>"],
            thead: [1, "<table>", "</table>"],
            col: [2, "<table><colgroup>", "</colgroup></table>"],
            tr: [2, "<table><tbody>", "</tbody></table>"],
            td: [3, "<table><tbody><tr>", "</tr></tbody></table>"],
            _default: [0, "", ""]
        };
    la.optgroup = la.option, la.tbody = la.tfoot = la.colgroup = la.caption = la.thead, la.th = la.td;

    function ma(a, b) {
        var c;
        return c = "undefined" != typeof a.getElementsByTagName ? a.getElementsByTagName(b || "*") : "undefined" != typeof a.querySelectorAll ? a.querySelectorAll(b || "*") : [], void 0 === b || b && r.nodeName(a, b) ? r.merge([a], c) : c
    }

    function na(a, b) {
        for (var c = 0, d = a.length; c < d; c++) V.set(a[c], "globalEval", !b || V.get(b[c], "globalEval"))
    }
    var oa = /<|&#?\w+;/;

    function pa(a, b, c, d, e) {
        for (var f, g, h, i, j, k, l = b.createDocumentFragment(), m = [], n = 0, o = a.length; n < o; n++)
            if (f = a[n], f || 0 === f)
                if ("object" === r.type(f)) r.merge(m, f.nodeType ? [f] : f);
                else if (oa.test(f)) {
            g = g || l.appendChild(b.createElement("div")), h = (ja.exec(f) || ["", ""])[1].toLowerCase(), i = la[h] || la._default, g.innerHTML = i[1] + r.htmlPrefilter(f) + i[2], k = i[0];
            while (k--) g = g.lastChild;
            r.merge(m, g.childNodes), g = l.firstChild, g.textContent = ""
        } else m.push(b.createTextNode(f));
        l.textContent = "", n = 0;
        while (f = m[n++])
            if (d && r.inArray(f, d) > -1) e && e.push(f);
            else if (j = r.contains(f.ownerDocument, f), g = ma(l.appendChild(f), "script"), j && na(g), c) {
            k = 0;
            while (f = g[k++]) ka.test(f.type || "") && c.push(f)
        }
        return l
    }! function() {
        var a = d.createDocumentFragment(),
            b = a.appendChild(d.createElement("div")),
            c = d.createElement("input");
        c.setAttribute("type", "radio"), c.setAttribute("checked", "checked"), c.setAttribute("name", "t"), b.appendChild(c), o.checkClone = b.cloneNode(!0).cloneNode(!0).lastChild.checked, b.innerHTML = "<textarea>x</textarea>", o.noCloneChecked = !!b.cloneNode(!0).lastChild.defaultValue
    }();
    var qa = d.documentElement,
        ra = /^key/,
        sa = /^(?:mouse|pointer|contextmenu|drag|drop)|click/,
        ta = /^([^.]*)(?:\.(.+)|)/;

    function ua() {
        return !0
    }

    function va() {
        return !1
    }

    function wa() {
        try {
            return d.activeElement
        } catch (a) {}
    }

    function xa(a, b, c, d, e, f) {
        var g, h;
        if ("object" == typeof b) {
            "string" != typeof c && (d = d || c, c = void 0);
            for (h in b) xa(a, h, c, d, b[h], f);
            return a
        }
        if (null == d && null == e ? (e = c, d = c = void 0) : null == e && ("string" == typeof c ? (e = d, d = void 0) : (e = d, d = c, c = void 0)), e === !1) e = va;
        else if (!e) return a;
        return 1 === f && (g = e, e = function(a) {
            return r().off(a), g.apply(this, arguments)
        }, e.guid = g.guid || (g.guid = r.guid++)), a.each(function() {
            r.event.add(this, b, e, d, c)
        })
    }
    r.event = {
        global: {},
        add: function(a, b, c, d, e) {
            var f, g, h, i, j, k, l, m, n, o, p, q = V.get(a);
            if (q) {
                c.handler && (f = c, c = f.handler, e = f.selector), e && r.find.matchesSelector(qa, e), c.guid || (c.guid = r.guid++), (i = q.events) || (i = q.events = {}), (g = q.handle) || (g = q.handle = function(b) {
                    return "undefined" != typeof r && r.event.triggered !== b.type ? r.event.dispatch.apply(a, arguments) : void 0
                }), b = (b || "").match(K) || [""], j = b.length;
                while (j--) h = ta.exec(b[j]) || [], n = p = h[1], o = (h[2] || "").split(".").sort(), n && (l = r.event.special[n] || {}, n = (e ? l.delegateType : l.bindType) || n, l = r.event.special[n] || {}, k = r.extend({
                    type: n,
                    origType: p,
                    data: d,
                    handler: c,
                    guid: c.guid,
                    selector: e,
                    needsContext: e && r.expr.match.needsContext.test(e),
                    namespace: o.join(".")
                }, f), (m = i[n]) || (m = i[n] = [], m.delegateCount = 0, l.setup && l.setup.call(a, d, o, g) !== !1 || a.addEventListener && a.addEventListener(n, g)), l.add && (l.add.call(a, k), k.handler.guid || (k.handler.guid = c.guid)), e ? m.splice(m.delegateCount++, 0, k) : m.push(k), r.event.global[n] = !0)
            }
        },
        remove: function(a, b, c, d, e) {
            var f, g, h, i, j, k, l, m, n, o, p, q = V.hasData(a) && V.get(a);
            if (q && (i = q.events)) {
                b = (b || "").match(K) || [""], j = b.length;
                while (j--)
                    if (h = ta.exec(b[j]) || [], n = p = h[1], o = (h[2] || "").split(".").sort(), n) {
                        l = r.event.special[n] || {}, n = (d ? l.delegateType : l.bindType) || n, m = i[n] || [], h = h[2] && new RegExp("(^|\\.)" + o.join("\\.(?:.*\\.|)") + "(\\.|$)"), g = f = m.length;
                        while (f--) k = m[f], !e && p !== k.origType || c && c.guid !== k.guid || h && !h.test(k.namespace) || d && d !== k.selector && ("**" !== d || !k.selector) || (m.splice(f, 1), k.selector && m.delegateCount--, l.remove && l.remove.call(a, k));
                        g && !m.length && (l.teardown && l.teardown.call(a, o, q.handle) !== !1 || r.removeEvent(a, n, q.handle), delete i[n])
                    } else
                        for (n in i) r.event.remove(a, n + b[j], c, d, !0);
                r.isEmptyObject(i) && V.remove(a, "handle events")
            }
        },
        dispatch: function(a) {
            var b = r.event.fix(a),
                c, d, e, f, g, h, i = new Array(arguments.length),
                j = (V.get(this, "events") || {})[b.type] || [],
                k = r.event.special[b.type] || {};
            for (i[0] = b, c = 1; c < arguments.length; c++) i[c] = arguments[c];
            if (b.delegateTarget = this, !k.preDispatch || k.preDispatch.call(this, b) !== !1) {
                h = r.event.handlers.call(this, b, j), c = 0;
                while ((f = h[c++]) && !b.isPropagationStopped()) {
                    b.currentTarget = f.elem, d = 0;
                    while ((g = f.handlers[d++]) && !b.isImmediatePropagationStopped()) b.rnamespace && !b.rnamespace.test(g.namespace) || (b.handleObj = g, b.data = g.data, e = ((r.event.special[g.origType] || {}).handle || g.handler).apply(f.elem, i), void 0 !== e && (b.result = e) === !1 && (b.preventDefault(), b.stopPropagation()))
                }
                return k.postDispatch && k.postDispatch.call(this, b), b.result
            }
        },
        handlers: function(a, b) {
            var c, d, e, f, g, h = [],
                i = b.delegateCount,
                j = a.target;
            if (i && j.nodeType && !("click" === a.type && a.button >= 1))
                for (; j !== this; j = j.parentNode || this)
                    if (1 === j.nodeType && ("click" !== a.type || j.disabled !== !0)) {
                        for (f = [], g = {}, c = 0; c < i; c++) d = b[c], e = d.selector + " ", void 0 === g[e] && (g[e] = d.needsContext ? r(e, this).index(j) > -1 : r.find(e, this, null, [j]).length), g[e] && f.push(d);
                        f.length && h.push({
                            elem: j,
                            handlers: f
                        })
                    }
            return j = this, i < b.length && h.push({
                elem: j,
                handlers: b.slice(i)
            }), h
        },
        addProp: function(a, b) {
            Object.defineProperty(r.Event.prototype, a, {
                enumerable: !0,
                configurable: !0,
                get: r.isFunction(b) ? function() {
                    if (this.originalEvent) return b(this.originalEvent)
                } : function() {
                    if (this.originalEvent) return this.originalEvent[a]
                },
                set: function(b) {
                    Object.defineProperty(this, a, {
                        enumerable: !0,
                        configurable: !0,
                        writable: !0,
                        value: b
                    })
                }
            })
        },
        fix: function(a) {
            return a[r.expando] ? a : new r.Event(a)
        },
        special: {
            load: {
                noBubble: !0
            },
            focus: {
                trigger: function() {
                    if (this !== wa() && this.focus) return this.focus(), !1
                },
                delegateType: "focusin"
            },
            blur: {
                trigger: function() {
                    if (this === wa() && this.blur) return this.blur(), !1
                },
                delegateType: "focusout"
            },
            click: {
                trigger: function() {
                    if ("checkbox" === this.type && this.click && r.nodeName(this, "input")) return this.click(), !1
                },
                _default: function(a) {
                    return r.nodeName(a.target, "a")
                }
            },
            beforeunload: {
                postDispatch: function(a) {
                    void 0 !== a.result && a.originalEvent && (a.originalEvent.returnValue = a.result)
                }
            }
        }
    }, r.removeEvent = function(a, b, c) {
        a.removeEventListener && a.removeEventListener(b, c)
    }, r.Event = function(a, b) {
        return this instanceof r.Event ? (a && a.type ? (this.originalEvent = a, this.type = a.type, this.isDefaultPrevented = a.defaultPrevented || void 0 === a.defaultPrevented && a.returnValue === !1 ? ua : va, this.target = a.target && 3 === a.target.nodeType ? a.target.parentNode : a.target, this.currentTarget = a.currentTarget, this.relatedTarget = a.relatedTarget) : this.type = a, b && r.extend(this, b), this.timeStamp = a && a.timeStamp || r.now(), void(this[r.expando] = !0)) : new r.Event(a, b)
    }, r.Event.prototype = {
        constructor: r.Event,
        isDefaultPrevented: va,
        isPropagationStopped: va,
        isImmediatePropagationStopped: va,
        isSimulated: !1,
        preventDefault: function() {
            var a = this.originalEvent;
            this.isDefaultPrevented = ua, a && !this.isSimulated && a.preventDefault()
        },
        stopPropagation: function() {
            var a = this.originalEvent;
            this.isPropagationStopped = ua, a && !this.isSimulated && a.stopPropagation()
        },
        stopImmediatePropagation: function() {
            var a = this.originalEvent;
            this.isImmediatePropagationStopped = ua, a && !this.isSimulated && a.stopImmediatePropagation(), this.stopPropagation()
        }
    }, r.each({
        altKey: !0,
        bubbles: !0,
        cancelable: !0,
        changedTouches: !0,
        ctrlKey: !0,
        detail: !0,
        eventPhase: !0,
        metaKey: !0,
        pageX: !0,
        pageY: !0,
        shiftKey: !0,
        view: !0,
        "char": !0,
        charCode: !0,
        key: !0,
        keyCode: !0,
        button: !0,
        buttons: !0,
        clientX: !0,
        clientY: !0,
        offsetX: !0,
        offsetY: !0,
        pointerId: !0,
        pointerType: !0,
        screenX: !0,
        screenY: !0,
        targetTouches: !0,
        toElement: !0,
        touches: !0,
        which: function(a) {
            var b = a.button;
            return null == a.which && ra.test(a.type) ? null != a.charCode ? a.charCode : a.keyCode : !a.which && void 0 !== b && sa.test(a.type) ? 1 & b ? 1 : 2 & b ? 3 : 4 & b ? 2 : 0 : a.which
        }
    }, r.event.addProp), r.each({
        mouseenter: "mouseover",
        mouseleave: "mouseout",
        pointerenter: "pointerover",
        pointerleave: "pointerout"
    }, function(a, b) {
        r.event.special[a] = {
            delegateType: b,
            bindType: b,
            handle: function(a) {
                var c, d = this,
                    e = a.relatedTarget,
                    f = a.handleObj;
                return e && (e === d || r.contains(d, e)) || (a.type = f.origType, c = f.handler.apply(this, arguments), a.type = b), c
            }
        }
    }), r.fn.extend({
        on: function(a, b, c, d) {
            return xa(this, a, b, c, d)
        },
        one: function(a, b, c, d) {
            return xa(this, a, b, c, d, 1)
        },
        off: function(a, b, c) {
            var d, e;
            if (a && a.preventDefault && a.handleObj) return d = a.handleObj, r(a.delegateTarget).off(d.namespace ? d.origType + "." + d.namespace : d.origType, d.selector, d.handler), this;
            if ("object" == typeof a) {
                for (e in a) this.off(e, b, a[e]);
                return this
            }
            return b !== !1 && "function" != typeof b || (c = b, b = void 0), c === !1 && (c = va), this.each(function() {
                r.event.remove(this, a, c, b)
            })
        }
    });
    var ya = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,
        za = /<script|<style|<link/i,
        Aa = /checked\s*(?:[^=]|=\s*.checked.)/i,
        Ba = /^true\/(.*)/,
        Ca = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;

    function Da(a, b) {
        return r.nodeName(a, "table") && r.nodeName(11 !== b.nodeType ? b : b.firstChild, "tr") ? a.getElementsByTagName("tbody")[0] || a : a
    }

    function Ea(a) {
        return a.type = (null !== a.getAttribute("type")) + "/" + a.type, a
    }

    function Fa(a) {
        var b = Ba.exec(a.type);
        return b ? a.type = b[1] : a.removeAttribute("type"), a
    }

    function Ga(a, b) {
        var c, d, e, f, g, h, i, j;
        if (1 === b.nodeType) {
            if (V.hasData(a) && (f = V.access(a), g = V.set(b, f), j = f.events)) {
                delete g.handle, g.events = {};
                for (e in j)
                    for (c = 0, d = j[e].length; c < d; c++) r.event.add(b, e, j[e][c])
            }
            W.hasData(a) && (h = W.access(a), i = r.extend({}, h), W.set(b, i))
        }
    }

    function Ha(a, b) {
        var c = b.nodeName.toLowerCase();
        "input" === c && ia.test(a.type) ? b.checked = a.checked : "input" !== c && "textarea" !== c || (b.defaultValue = a.defaultValue)
    }

    function Ia(a, b, c, d) {
        b = g.apply([], b);
        var e, f, h, i, j, k, l = 0,
            m = a.length,
            n = m - 1,
            q = b[0],
            s = r.isFunction(q);
        if (s || m > 1 && "string" == typeof q && !o.checkClone && Aa.test(q)) return a.each(function(e) {
            var f = a.eq(e);
            s && (b[0] = q.call(this, e, f.html())), Ia(f, b, c, d)
        });
        if (m && (e = pa(b, a[0].ownerDocument, !1, a, d), f = e.firstChild, 1 === e.childNodes.length && (e = f), f || d)) {
            for (h = r.map(ma(e, "script"), Ea), i = h.length; l < m; l++) j = e, l !== n && (j = r.clone(j, !0, !0), i && r.merge(h, ma(j, "script"))), c.call(a[l], j, l);
            if (i)
                for (k = h[h.length - 1].ownerDocument, r.map(h, Fa), l = 0; l < i; l++) j = h[l], ka.test(j.type || "") && !V.access(j, "globalEval") && r.contains(k, j) && (j.src ? r._evalUrl && r._evalUrl(j.src) : p(j.textContent.replace(Ca, ""), k))
        }
        return a
    }

    function Ja(a, b, c) {
        for (var d, e = b ? r.filter(b, a) : a, f = 0; null != (d = e[f]); f++) c || 1 !== d.nodeType || r.cleanData(ma(d)), d.parentNode && (c && r.contains(d.ownerDocument, d) && na(ma(d, "script")), d.parentNode.removeChild(d));
        return a
    }
    r.extend({
        htmlPrefilter: function(a) {
            return a.replace(ya, "<$1></$2>")
        },
        clone: function(a, b, c) {
            var d, e, f, g, h = a.cloneNode(!0),
                i = r.contains(a.ownerDocument, a);
            if (!(o.noCloneChecked || 1 !== a.nodeType && 11 !== a.nodeType || r.isXMLDoc(a)))
                for (g = ma(h), f = ma(a), d = 0, e = f.length; d < e; d++) Ha(f[d], g[d]);
            if (b)
                if (c)
                    for (f = f || ma(a), g = g || ma(h), d = 0, e = f.length; d < e; d++) Ga(f[d], g[d]);
                else Ga(a, h);
            return g = ma(h, "script"), g.length > 0 && na(g, !i && ma(a, "script")), h
        },
        cleanData: function(a) {
            for (var b, c, d, e = r.event.special, f = 0; void 0 !== (c = a[f]); f++)
                if (T(c)) {
                    if (b = c[V.expando]) {
                        if (b.events)
                            for (d in b.events) e[d] ? r.event.remove(c, d) : r.removeEvent(c, d, b.handle);
                        c[V.expando] = void 0
                    }
                    c[W.expando] && (c[W.expando] = void 0)
                }
        }
    }), r.fn.extend({
        detach: function(a) {
            return Ja(this, a, !0)
        },
        remove: function(a) {
            return Ja(this, a)
        },
        text: function(a) {
            return S(this, function(a) {
                return void 0 === a ? r.text(this) : this.empty().each(function() {
                    1 !== this.nodeType && 11 !== this.nodeType && 9 !== this.nodeType || (this.textContent = a)
                })
            }, null, a, arguments.length)
        },
        append: function() {
            return Ia(this, arguments, function(a) {
                if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
                    var b = Da(this, a);
                    b.appendChild(a)
                }
            })
        },
        prepend: function() {
            return Ia(this, arguments, function(a) {
                if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
                    var b = Da(this, a);
                    b.insertBefore(a, b.firstChild)
                }
            })
        },
        before: function() {
            return Ia(this, arguments, function(a) {
                this.parentNode && this.parentNode.insertBefore(a, this)
            })
        },
        after: function() {
            return Ia(this, arguments, function(a) {
                this.parentNode && this.parentNode.insertBefore(a, this.nextSibling)
            })
        },
        empty: function() {
            for (var a, b = 0; null != (a = this[b]); b++) 1 === a.nodeType && (r.cleanData(ma(a, !1)), a.textContent = "");
            return this
        },
        clone: function(a, b) {
            return a = null != a && a, b = null == b ? a : b, this.map(function() {
                return r.clone(this, a, b)
            })
        },
        html: function(a) {
            return S(this, function(a) {
                var b = this[0] || {},
                    c = 0,
                    d = this.length;
                if (void 0 === a && 1 === b.nodeType) return b.innerHTML;
                if ("string" == typeof a && !za.test(a) && !la[(ja.exec(a) || ["", ""])[1].toLowerCase()]) {
                    a = r.htmlPrefilter(a);
                    try {
                        for (; c < d; c++) b = this[c] || {}, 1 === b.nodeType && (r.cleanData(ma(b, !1)), b.innerHTML = a);
                        b = 0
                    } catch (e) {}
                }
                b && this.empty().append(a)
            }, null, a, arguments.length)
        },
        replaceWith: function() {
            var a = [];
            return Ia(this, arguments, function(b) {
                var c = this.parentNode;
                r.inArray(this, a) < 0 && (r.cleanData(ma(this)), c && c.replaceChild(b, this))
            }, a)
        }
    }), r.each({
        appendTo: "append",
        prependTo: "prepend",
        insertBefore: "before",
        insertAfter: "after",
        replaceAll: "replaceWith"
    }, function(a, b) {
        r.fn[a] = function(a) {
            for (var c, d = [], e = r(a), f = e.length - 1, g = 0; g <= f; g++) c = g === f ? this : this.clone(!0), r(e[g])[b](c), h.apply(d, c.get());
            return this.pushStack(d)
        }
    });
    var Ka = /^margin/,
        La = new RegExp("^(" + _ + ")(?!px)[a-z%]+$", "i"),
        Ma = function(b) {
            var c = b.ownerDocument.defaultView;
            return c && c.opener || (c = a), c.getComputedStyle(b)
        };
    ! function() {
        function b() {
            if (i) {
                i.style.cssText = "box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%", i.innerHTML = "", qa.appendChild(h);
                var b = a.getComputedStyle(i);
                c = "1%" !== b.top, g = "2px" === b.marginLeft, e = "4px" === b.width, i.style.marginRight = "50%", f = "4px" === b.marginRight, qa.removeChild(h), i = null
            }
        }
        var c, e, f, g, h = d.createElement("div"),
            i = d.createElement("div");
        i.style && (i.style.backgroundClip = "content-box", i.cloneNode(!0).style.backgroundClip = "", o.clearCloneStyle = "content-box" === i.style.backgroundClip, h.style.cssText = "border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute", h.appendChild(i), r.extend(o, {
            pixelPosition: function() {
                return b(), c
            },
            boxSizingReliable: function() {
                return b(), e
            },
            pixelMarginRight: function() {
                return b(), f
            },
            reliableMarginLeft: function() {
                return b(), g
            }
        }))
    }();

    function Na(a, b, c) {
        var d, e, f, g, h = a.style;
        return c = c || Ma(a), c && (g = c.getPropertyValue(b) || c[b], "" !== g || r.contains(a.ownerDocument, a) || (g = r.style(a, b)), !o.pixelMarginRight() && La.test(g) && Ka.test(b) && (d = h.width, e = h.minWidth, f = h.maxWidth, h.minWidth = h.maxWidth = h.width = g, g = c.width, h.width = d, h.minWidth = e, h.maxWidth = f)), void 0 !== g ? g + "" : g
    }

    function Oa(a, b) {
        return {
            get: function() {
                return a() ? void delete this.get : (this.get = b).apply(this, arguments)
            }
        }
    }
    var Pa = /^(none|table(?!-c[ea]).+)/,
        Qa = {
            position: "absolute",
            visibility: "hidden",
            display: "block"
        },
        Ra = {
            letterSpacing: "0",
            fontWeight: "400"
        },
        Sa = ["Webkit", "Moz", "ms"],
        Ta = d.createElement("div").style;

    function Ua(a) {
        if (a in Ta) return a;
        var b = a[0].toUpperCase() + a.slice(1),
            c = Sa.length;
        while (c--)
            if (a = Sa[c] + b, a in Ta) return a
    }

    function Va(a, b, c) {
        var d = aa.exec(b);
        return d ? Math.max(0, d[2] - (c || 0)) + (d[3] || "px") : b
    }

    function Wa(a, b, c, d, e) {
        var f, g = 0;
        for (f = c === (d ? "border" : "content") ? 4 : "width" === b ? 1 : 0; f < 4; f += 2) "margin" === c && (g += r.css(a, c + ba[f], !0, e)), d ? ("content" === c && (g -= r.css(a, "padding" + ba[f], !0, e)), "margin" !== c && (g -= r.css(a, "border" + ba[f] + "Width", !0, e))) : (g += r.css(a, "padding" + ba[f], !0, e), "padding" !== c && (g += r.css(a, "border" + ba[f] + "Width", !0, e)));
        return g
    }

    function Xa(a, b, c) {
        var d, e = !0,
            f = Ma(a),
            g = "border-box" === r.css(a, "boxSizing", !1, f);
        if (a.getClientRects().length && (d = a.getBoundingClientRect()[b]), d <= 0 || null == d) {
            if (d = Na(a, b, f), (d < 0 || null == d) && (d = a.style[b]), La.test(d)) return d;
            e = g && (o.boxSizingReliable() || d === a.style[b]), d = parseFloat(d) || 0
        }
        return d + Wa(a, b, c || (g ? "border" : "content"), e, f) + "px"
    }
    r.extend({
        cssHooks: {
            opacity: {
                get: function(a, b) {
                    if (b) {
                        var c = Na(a, "opacity");
                        return "" === c ? "1" : c
                    }
                }
            }
        },
        cssNumber: {
            animationIterationCount: !0,
            columnCount: !0,
            fillOpacity: !0,
            flexGrow: !0,
            flexShrink: !0,
            fontWeight: !0,
            lineHeight: !0,
            opacity: !0,
            order: !0,
            orphans: !0,
            widows: !0,
            zIndex: !0,
            zoom: !0
        },
        cssProps: {
            "float": "cssFloat"
        },
        style: function(a, b, c, d) {
            if (a && 3 !== a.nodeType && 8 !== a.nodeType && a.style) {
                var e, f, g, h = r.camelCase(b),
                    i = a.style;
                return b = r.cssProps[h] || (r.cssProps[h] = Ua(h) || h), g = r.cssHooks[b] || r.cssHooks[h], void 0 === c ? g && "get" in g && void 0 !== (e = g.get(a, !1, d)) ? e : i[b] : (f = typeof c, "string" === f && (e = aa.exec(c)) && e[1] && (c = ea(a, b, e), f = "number"), null != c && c === c && ("number" === f && (c += e && e[3] || (r.cssNumber[h] ? "" : "px")), o.clearCloneStyle || "" !== c || 0 !== b.indexOf("background") || (i[b] = "inherit"), g && "set" in g && void 0 === (c = g.set(a, c, d)) || (i[b] = c)), void 0)
            }
        },
        css: function(a, b, c, d) {
            var e, f, g, h = r.camelCase(b);
            return b = r.cssProps[h] || (r.cssProps[h] = Ua(h) || h), g = r.cssHooks[b] || r.cssHooks[h], g && "get" in g && (e = g.get(a, !0, c)), void 0 === e && (e = Na(a, b, d)), "normal" === e && b in Ra && (e = Ra[b]), "" === c || c ? (f = parseFloat(e), c === !0 || isFinite(f) ? f || 0 : e) : e
        }
    }), r.each(["height", "width"], function(a, b) {
        r.cssHooks[b] = {
            get: function(a, c, d) {
                if (c) return !Pa.test(r.css(a, "display")) || a.getClientRects().length && a.getBoundingClientRect().width ? Xa(a, b, d) : da(a, Qa, function() {
                    return Xa(a, b, d)
                })
            },
            set: function(a, c, d) {
                var e, f = d && Ma(a),
                    g = d && Wa(a, b, d, "border-box" === r.css(a, "boxSizing", !1, f), f);
                return g && (e = aa.exec(c)) && "px" !== (e[3] || "px") && (a.style[b] = c, c = r.css(a, b)), Va(a, c, g)
            }
        }
    }), r.cssHooks.marginLeft = Oa(o.reliableMarginLeft, function(a, b) {
        if (b) return (parseFloat(Na(a, "marginLeft")) || a.getBoundingClientRect().left - da(a, {
            marginLeft: 0
        }, function() {
            return a.getBoundingClientRect().left
        })) + "px"
    }), r.each({
        margin: "",
        padding: "",
        border: "Width"
    }, function(a, b) {
        r.cssHooks[a + b] = {
            expand: function(c) {
                for (var d = 0, e = {}, f = "string" == typeof c ? c.split(" ") : [c]; d < 4; d++) e[a + ba[d] + b] = f[d] || f[d - 2] || f[0];
                return e
            }
        }, Ka.test(a) || (r.cssHooks[a + b].set = Va)
    }), r.fn.extend({
        css: function(a, b) {
            return S(this, function(a, b, c) {
                var d, e, f = {},
                    g = 0;
                if (r.isArray(b)) {
                    for (d = Ma(a), e = b.length; g < e; g++) f[b[g]] = r.css(a, b[g], !1, d);
                    return f
                }
                return void 0 !== c ? r.style(a, b, c) : r.css(a, b)
            }, a, b, arguments.length > 1)
        }
    });

    function Ya(a, b, c, d, e) {
        return new Ya.prototype.init(a, b, c, d, e)
    }
    r.Tween = Ya, Ya.prototype = {
        constructor: Ya,
        init: function(a, b, c, d, e, f) {
            this.elem = a, this.prop = c, this.easing = e || r.easing._default, this.options = b, this.start = this.now = this.cur(), this.end = d, this.unit = f || (r.cssNumber[c] ? "" : "px")
        },
        cur: function() {
            var a = Ya.propHooks[this.prop];
            return a && a.get ? a.get(this) : Ya.propHooks._default.get(this)
        },
        run: function(a) {
            var b, c = Ya.propHooks[this.prop];
            return this.options.duration ? this.pos = b = r.easing[this.easing](a, this.options.duration * a, 0, 1, this.options.duration) : this.pos = b = a, this.now = (this.end - this.start) * b + this.start, this.options.step && this.options.step.call(this.elem, this.now, this), c && c.set ? c.set(this) : Ya.propHooks._default.set(this), this
        }
    }, Ya.prototype.init.prototype = Ya.prototype, Ya.propHooks = {
        _default: {
            get: function(a) {
                var b;
                return 1 !== a.elem.nodeType || null != a.elem[a.prop] && null == a.elem.style[a.prop] ? a.elem[a.prop] : (b = r.css(a.elem, a.prop, ""), b && "auto" !== b ? b : 0)
            },
            set: function(a) {
                r.fx.step[a.prop] ? r.fx.step[a.prop](a) : 1 !== a.elem.nodeType || null == a.elem.style[r.cssProps[a.prop]] && !r.cssHooks[a.prop] ? a.elem[a.prop] = a.now : r.style(a.elem, a.prop, a.now + a.unit)
            }
        }
    }, Ya.propHooks.scrollTop = Ya.propHooks.scrollLeft = {
        set: function(a) {
            a.elem.nodeType && a.elem.parentNode && (a.elem[a.prop] = a.now)
        }
    }, r.easing = {
        linear: function(a) {
            return a
        },
        swing: function(a) {
            return .5 - Math.cos(a * Math.PI) / 2
        },
        _default: "swing"
    }, r.fx = Ya.prototype.init, r.fx.step = {};
    var Za, $a, _a = /^(?:toggle|show|hide)$/,
        ab = /queueHooks$/;

    function bb() {
        $a && (a.requestAnimationFrame(bb), r.fx.tick())
    }

    function cb() {
        return a.setTimeout(function() {
            Za = void 0
        }), Za = r.now()
    }

    function db(a, b) {
        var c, d = 0,
            e = {
                height: a
            };
        for (b = b ? 1 : 0; d < 4; d += 2 - b) c = ba[d], e["margin" + c] = e["padding" + c] = a;
        return b && (e.opacity = e.width = a), e
    }

    function eb(a, b, c) {
        for (var d, e = (hb.tweeners[b] || []).concat(hb.tweeners["*"]), f = 0, g = e.length; f < g; f++)
            if (d = e[f].call(c, b, a)) return d
    }

    function fb(a, b, c) {
        var d, e, f, g, h, i, j, k, l = "width" in b || "height" in b,
            m = this,
            n = {},
            o = a.style,
            p = a.nodeType && ca(a),
            q = V.get(a, "fxshow");
        c.queue || (g = r._queueHooks(a, "fx"), null == g.unqueued && (g.unqueued = 0, h = g.empty.fire, g.empty.fire = function() {
            g.unqueued || h()
        }), g.unqueued++, m.always(function() {
            m.always(function() {
                g.unqueued--, r.queue(a, "fx").length || g.empty.fire()
            })
        }));
        for (d in b)
            if (e = b[d], _a.test(e)) {
                if (delete b[d], f = f || "toggle" === e, e === (p ? "hide" : "show")) {
                    if ("show" !== e || !q || void 0 === q[d]) continue;
                    p = !0
                }
                n[d] = q && q[d] || r.style(a, d)
            }
        if (i = !r.isEmptyObject(b), i || !r.isEmptyObject(n)) {
            l && 1 === a.nodeType && (c.overflow = [o.overflow, o.overflowX, o.overflowY], j = q && q.display, null == j && (j = V.get(a, "display")), k = r.css(a, "display"), "none" === k && (j ? k = j : (ha([a], !0), j = a.style.display || j, k = r.css(a, "display"), ha([a]))), ("inline" === k || "inline-block" === k && null != j) && "none" === r.css(a, "float") && (i || (m.done(function() {
                o.display = j
            }), null == j && (k = o.display, j = "none" === k ? "" : k)), o.display = "inline-block")), c.overflow && (o.overflow = "hidden", m.always(function() {
                o.overflow = c.overflow[0], o.overflowX = c.overflow[1], o.overflowY = c.overflow[2]
            })), i = !1;
            for (d in n) i || (q ? "hidden" in q && (p = q.hidden) : q = V.access(a, "fxshow", {
                display: j
            }), f && (q.hidden = !p), p && ha([a], !0), m.done(function() {
                p || ha([a]), V.remove(a, "fxshow");
                for (d in n) r.style(a, d, n[d])
            })), i = eb(p ? q[d] : 0, d, m), d in q || (q[d] = i.start, p && (i.end = i.start, i.start = 0))
        }
    }

    function gb(a, b) {
        var c, d, e, f, g;
        for (c in a)
            if (d = r.camelCase(c), e = b[d], f = a[c], r.isArray(f) && (e = f[1], f = a[c] = f[0]), c !== d && (a[d] = f, delete a[c]), g = r.cssHooks[d], g && "expand" in g) {
                f = g.expand(f), delete a[d];
                for (c in f) c in a || (a[c] = f[c], b[c] = e)
            } else b[d] = e
    }

    function hb(a, b, c) {
        var d, e, f = 0,
            g = hb.prefilters.length,
            h = r.Deferred().always(function() {
                delete i.elem
            }),
            i = function() {
                if (e) return !1;
                for (var b = Za || cb(), c = Math.max(0, j.startTime + j.duration - b), d = c / j.duration || 0, f = 1 - d, g = 0, i = j.tweens.length; g < i; g++) j.tweens[g].run(f);
                return h.notifyWith(a, [j, f, c]), f < 1 && i ? c : (h.resolveWith(a, [j]), !1)
            },
            j = h.promise({
                elem: a,
                props: r.extend({}, b),
                opts: r.extend(!0, {
                    specialEasing: {},
                    easing: r.easing._default
                }, c),
                originalProperties: b,
                originalOptions: c,
                startTime: Za || cb(),
                duration: c.duration,
                tweens: [],
                createTween: function(b, c) {
                    var d = r.Tween(a, j.opts, b, c, j.opts.specialEasing[b] || j.opts.easing);
                    return j.tweens.push(d), d
                },
                stop: function(b) {
                    var c = 0,
                        d = b ? j.tweens.length : 0;
                    if (e) return this;
                    for (e = !0; c < d; c++) j.tweens[c].run(1);
                    return b ? (h.notifyWith(a, [j, 1, 0]), h.resolveWith(a, [j, b])) : h.rejectWith(a, [j, b]), this
                }
            }),
            k = j.props;
        for (gb(k, j.opts.specialEasing); f < g; f++)
            if (d = hb.prefilters[f].call(j, a, k, j.opts)) return r.isFunction(d.stop) && (r._queueHooks(j.elem, j.opts.queue).stop = r.proxy(d.stop, d)), d;
        return r.map(k, eb, j), r.isFunction(j.opts.start) && j.opts.start.call(a, j), r.fx.timer(r.extend(i, {
            elem: a,
            anim: j,
            queue: j.opts.queue
        })), j.progress(j.opts.progress).done(j.opts.done, j.opts.complete).fail(j.opts.fail).always(j.opts.always)
    }
    r.Animation = r.extend(hb, {
            tweeners: {
                "*": [function(a, b) {
                    var c = this.createTween(a, b);
                    return ea(c.elem, a, aa.exec(b), c), c
                }]
            },
            tweener: function(a, b) {
                r.isFunction(a) ? (b = a, a = ["*"]) : a = a.match(K);
                for (var c, d = 0, e = a.length; d < e; d++) c = a[d], hb.tweeners[c] = hb.tweeners[c] || [], hb.tweeners[c].unshift(b)
            },
            prefilters: [fb],
            prefilter: function(a, b) {
                b ? hb.prefilters.unshift(a) : hb.prefilters.push(a)
            }
        }), r.speed = function(a, b, c) {
            var e = a && "object" == typeof a ? r.extend({}, a) : {
                complete: c || !c && b || r.isFunction(a) && a,
                duration: a,
                easing: c && b || b && !r.isFunction(b) && b
            };
            return r.fx.off || d.hidden ? e.duration = 0 : "number" != typeof e.duration && (e.duration in r.fx.speeds ? e.duration = r.fx.speeds[e.duration] : e.duration = r.fx.speeds._default), null != e.queue && e.queue !== !0 || (e.queue = "fx"), e.old = e.complete, e.complete = function() {
                r.isFunction(e.old) && e.old.call(this), e.queue && r.dequeue(this, e.queue)
            }, e
        }, r.fn.extend({
            fadeTo: function(a, b, c, d) {
                return this.filter(ca).css("opacity", 0).show().end().animate({
                    opacity: b
                }, a, c, d)
            },
            animate: function(a, b, c, d) {
                var e = r.isEmptyObject(a),
                    f = r.speed(b, c, d),
                    g = function() {
                        var b = hb(this, r.extend({}, a), f);
                        (e || V.get(this, "finish")) && b.stop(!0)
                    };
                return g.finish = g, e || f.queue === !1 ? this.each(g) : this.queue(f.queue, g)
            },
            stop: function(a, b, c) {
                var d = function(a) {
                    var b = a.stop;
                    delete a.stop, b(c)
                };
                return "string" != typeof a && (c = b, b = a, a = void 0), b && a !== !1 && this.queue(a || "fx", []), this.each(function() {
                    var b = !0,
                        e = null != a && a + "queueHooks",
                        f = r.timers,
                        g = V.get(this);
                    if (e) g[e] && g[e].stop && d(g[e]);
                    else
                        for (e in g) g[e] && g[e].stop && ab.test(e) && d(g[e]);
                    for (e = f.length; e--;) f[e].elem !== this || null != a && f[e].queue !== a || (f[e].anim.stop(c), b = !1, f.splice(e, 1));
                    !b && c || r.dequeue(this, a)
                })
            },
            finish: function(a) {
                return a !== !1 && (a = a || "fx"), this.each(function() {
                    var b, c = V.get(this),
                        d = c[a + "queue"],
                        e = c[a + "queueHooks"],
                        f = r.timers,
                        g = d ? d.length : 0;
                    for (c.finish = !0, r.queue(this, a, []), e && e.stop && e.stop.call(this, !0), b = f.length; b--;) f[b].elem === this && f[b].queue === a && (f[b].anim.stop(!0), f.splice(b, 1));
                    for (b = 0; b < g; b++) d[b] && d[b].finish && d[b].finish.call(this);
                    delete c.finish
                })
            }
        }), r.each(["toggle", "show", "hide"], function(a, b) {
            var c = r.fn[b];
            r.fn[b] = function(a, d, e) {
                return null == a || "boolean" == typeof a ? c.apply(this, arguments) : this.animate(db(b, !0), a, d, e)
            }
        }), r.each({
            slideDown: db("show"),
            slideUp: db("hide"),
            slideToggle: db("toggle"),
            fadeIn: {
                opacity: "show"
            },
            fadeOut: {
                opacity: "hide"
            },
            fadeToggle: {
                opacity: "toggle"
            }
        }, function(a, b) {
            r.fn[a] = function(a, c, d) {
                return this.animate(b, a, c, d)
            }
        }), r.timers = [], r.fx.tick = function() {
            var a, b = 0,
                c = r.timers;
            for (Za = r.now(); b < c.length; b++) a = c[b], a() || c[b] !== a || c.splice(b--, 1);
            c.length || r.fx.stop(), Za = void 0
        }, r.fx.timer = function(a) {
            r.timers.push(a), a() ? r.fx.start() : r.timers.pop()
        }, r.fx.interval = 13, r.fx.start = function() {
            $a || ($a = a.requestAnimationFrame ? a.requestAnimationFrame(bb) : a.setInterval(r.fx.tick, r.fx.interval))
        }, r.fx.stop = function() {
            a.cancelAnimationFrame ? a.cancelAnimationFrame($a) : a.clearInterval($a), $a = null
        }, r.fx.speeds = {
            slow: 600,
            fast: 200,
            _default: 400
        }, r.fn.delay = function(b, c) {
            return b = r.fx ? r.fx.speeds[b] || b : b, c = c || "fx", this.queue(c, function(c, d) {
                var e = a.setTimeout(c, b);
                d.stop = function() {
                    a.clearTimeout(e)
                }
            })
        },
        function() {
            var a = d.createElement("input"),
                b = d.createElement("select"),
                c = b.appendChild(d.createElement("option"));
            a.type = "checkbox", o.checkOn = "" !== a.value, o.optSelected = c.selected, a = d.createElement("input"), a.value = "t", a.type = "radio", o.radioValue = "t" === a.value
        }();
    var ib, jb = r.expr.attrHandle;
    r.fn.extend({
        attr: function(a, b) {
            return S(this, r.attr, a, b, arguments.length > 1)
        },
        removeAttr: function(a) {
            return this.each(function() {
                r.removeAttr(this, a)
            })
        }
    }), r.extend({
        attr: function(a, b, c) {
            var d, e, f = a.nodeType;
            if (3 !== f && 8 !== f && 2 !== f) return "undefined" == typeof a.getAttribute ? r.prop(a, b, c) : (1 === f && r.isXMLDoc(a) || (e = r.attrHooks[b.toLowerCase()] || (r.expr.match.bool.test(b) ? ib : void 0)),
                void 0 !== c ? null === c ? void r.removeAttr(a, b) : e && "set" in e && void 0 !== (d = e.set(a, c, b)) ? d : (a.setAttribute(b, c + ""), c) : e && "get" in e && null !== (d = e.get(a, b)) ? d : (d = r.find.attr(a, b), null == d ? void 0 : d))
        },
        attrHooks: {
            type: {
                set: function(a, b) {
                    if (!o.radioValue && "radio" === b && r.nodeName(a, "input")) {
                        var c = a.value;
                        return a.setAttribute("type", b), c && (a.value = c), b
                    }
                }
            }
        },
        removeAttr: function(a, b) {
            var c, d = 0,
                e = b && b.match(K);
            if (e && 1 === a.nodeType)
                while (c = e[d++]) a.removeAttribute(c)
        }
    }), ib = {
        set: function(a, b, c) {
            return b === !1 ? r.removeAttr(a, c) : a.setAttribute(c, c), c
        }
    }, r.each(r.expr.match.bool.source.match(/\w+/g), function(a, b) {
        var c = jb[b] || r.find.attr;
        jb[b] = function(a, b, d) {
            var e, f, g = b.toLowerCase();
            return d || (f = jb[g], jb[g] = e, e = null != c(a, b, d) ? g : null, jb[g] = f), e
        }
    });
    var kb = /^(?:input|select|textarea|button)$/i,
        lb = /^(?:a|area)$/i;
    r.fn.extend({
        prop: function(a, b) {
            return S(this, r.prop, a, b, arguments.length > 1)
        },
        removeProp: function(a) {
            return this.each(function() {
                delete this[r.propFix[a] || a]
            })
        }
    }), r.extend({
        prop: function(a, b, c) {
            var d, e, f = a.nodeType;
            if (3 !== f && 8 !== f && 2 !== f) return 1 === f && r.isXMLDoc(a) || (b = r.propFix[b] || b, e = r.propHooks[b]), void 0 !== c ? e && "set" in e && void 0 !== (d = e.set(a, c, b)) ? d : a[b] = c : e && "get" in e && null !== (d = e.get(a, b)) ? d : a[b]
        },
        propHooks: {
            tabIndex: {
                get: function(a) {
                    var b = r.find.attr(a, "tabindex");
                    return b ? parseInt(b, 10) : kb.test(a.nodeName) || lb.test(a.nodeName) && a.href ? 0 : -1
                }
            }
        },
        propFix: {
            "for": "htmlFor",
            "class": "className"
        }
    }), o.optSelected || (r.propHooks.selected = {
        get: function(a) {
            var b = a.parentNode;
            return b && b.parentNode && b.parentNode.selectedIndex, null
        },
        set: function(a) {
            var b = a.parentNode;
            b && (b.selectedIndex, b.parentNode && b.parentNode.selectedIndex)
        }
    }), r.each(["tabIndex", "readOnly", "maxLength", "cellSpacing", "cellPadding", "rowSpan", "colSpan", "useMap", "frameBorder", "contentEditable"], function() {
        r.propFix[this.toLowerCase()] = this
    });

    function mb(a) {
        var b = a.match(K) || [];
        return b.join(" ")
    }

    function nb(a) {
        return a.getAttribute && a.getAttribute("class") || ""
    }
    r.fn.extend({
        addClass: function(a) {
            var b, c, d, e, f, g, h, i = 0;
            if (r.isFunction(a)) return this.each(function(b) {
                r(this).addClass(a.call(this, b, nb(this)))
            });
            if ("string" == typeof a && a) {
                b = a.match(K) || [];
                while (c = this[i++])
                    if (e = nb(c), d = 1 === c.nodeType && " " + mb(e) + " ") {
                        g = 0;
                        while (f = b[g++]) d.indexOf(" " + f + " ") < 0 && (d += f + " ");
                        h = mb(d), e !== h && c.setAttribute("class", h)
                    }
            }
            return this
        },
        removeClass: function(a) {
            var b, c, d, e, f, g, h, i = 0;
            if (r.isFunction(a)) return this.each(function(b) {
                r(this).removeClass(a.call(this, b, nb(this)))
            });
            if (!arguments.length) return this.attr("class", "");
            if ("string" == typeof a && a) {
                b = a.match(K) || [];
                while (c = this[i++])
                    if (e = nb(c), d = 1 === c.nodeType && " " + mb(e) + " ") {
                        g = 0;
                        while (f = b[g++])
                            while (d.indexOf(" " + f + " ") > -1) d = d.replace(" " + f + " ", " ");
                        h = mb(d), e !== h && c.setAttribute("class", h)
                    }
            }
            return this
        },
        toggleClass: function(a, b) {
            var c = typeof a;
            return "boolean" == typeof b && "string" === c ? b ? this.addClass(a) : this.removeClass(a) : r.isFunction(a) ? this.each(function(c) {
                r(this).toggleClass(a.call(this, c, nb(this), b), b)
            }) : this.each(function() {
                var b, d, e, f;
                if ("string" === c) {
                    d = 0, e = r(this), f = a.match(K) || [];
                    while (b = f[d++]) e.hasClass(b) ? e.removeClass(b) : e.addClass(b)
                } else void 0 !== a && "boolean" !== c || (b = nb(this), b && V.set(this, "__className__", b), this.setAttribute && this.setAttribute("class", b || a === !1 ? "" : V.get(this, "__className__") || ""))
            })
        },
        hasClass: function(a) {
            var b, c, d = 0;
            b = " " + a + " ";
            while (c = this[d++])
                if (1 === c.nodeType && (" " + mb(nb(c)) + " ").indexOf(b) > -1) return !0;
            return !1
        }
    });
    var ob = /\r/g;
    r.fn.extend({
        val: function(a) {
            var b, c, d, e = this[0]; {
                if (arguments.length) return d = r.isFunction(a), this.each(function(c) {
                    var e;
                    1 === this.nodeType && (e = d ? a.call(this, c, r(this).val()) : a, null == e ? e = "" : "number" == typeof e ? e += "" : r.isArray(e) && (e = r.map(e, function(a) {
                        return null == a ? "" : a + ""
                    })), b = r.valHooks[this.type] || r.valHooks[this.nodeName.toLowerCase()], b && "set" in b && void 0 !== b.set(this, e, "value") || (this.value = e))
                });
                if (e) return b = r.valHooks[e.type] || r.valHooks[e.nodeName.toLowerCase()], b && "get" in b && void 0 !== (c = b.get(e, "value")) ? c : (c = e.value, "string" == typeof c ? c.replace(ob, "") : null == c ? "" : c)
            }
        }
    }), r.extend({
        valHooks: {
            option: {
                get: function(a) {
                    var b = r.find.attr(a, "value");
                    return null != b ? b : mb(r.text(a))
                }
            },
            select: {
                get: function(a) {
                    var b, c, d, e = a.options,
                        f = a.selectedIndex,
                        g = "select-one" === a.type,
                        h = g ? null : [],
                        i = g ? f + 1 : e.length;
                    for (d = f < 0 ? i : g ? f : 0; d < i; d++)
                        if (c = e[d], (c.selected || d === f) && !c.disabled && (!c.parentNode.disabled || !r.nodeName(c.parentNode, "optgroup"))) {
                            if (b = r(c).val(), g) return b;
                            h.push(b)
                        }
                    return h
                },
                set: function(a, b) {
                    var c, d, e = a.options,
                        f = r.makeArray(b),
                        g = e.length;
                    while (g--) d = e[g], (d.selected = r.inArray(r.valHooks.option.get(d), f) > -1) && (c = !0);
                    return c || (a.selectedIndex = -1), f
                }
            }
        }
    }), r.each(["radio", "checkbox"], function() {
        r.valHooks[this] = {
            set: function(a, b) {
                if (r.isArray(b)) return a.checked = r.inArray(r(a).val(), b) > -1
            }
        }, o.checkOn || (r.valHooks[this].get = function(a) {
            return null === a.getAttribute("value") ? "on" : a.value
        })
    });
    var pb = /^(?:focusinfocus|focusoutblur)$/;
    r.extend(r.event, {
        trigger: function(b, c, e, f) {
            var g, h, i, j, k, m, n, o = [e || d],
                p = l.call(b, "type") ? b.type : b,
                q = l.call(b, "namespace") ? b.namespace.split(".") : [];
            if (h = i = e = e || d, 3 !== e.nodeType && 8 !== e.nodeType && !pb.test(p + r.event.triggered) && (p.indexOf(".") > -1 && (q = p.split("."), p = q.shift(), q.sort()), k = p.indexOf(":") < 0 && "on" + p, b = b[r.expando] ? b : new r.Event(p, "object" == typeof b && b), b.isTrigger = f ? 2 : 3, b.namespace = q.join("."), b.rnamespace = b.namespace ? new RegExp("(^|\\.)" + q.join("\\.(?:.*\\.|)") + "(\\.|$)") : null, b.result = void 0, b.target || (b.target = e), c = null == c ? [b] : r.makeArray(c, [b]), n = r.event.special[p] || {}, f || !n.trigger || n.trigger.apply(e, c) !== !1)) {
                if (!f && !n.noBubble && !r.isWindow(e)) {
                    for (j = n.delegateType || p, pb.test(j + p) || (h = h.parentNode); h; h = h.parentNode) o.push(h), i = h;
                    i === (e.ownerDocument || d) && o.push(i.defaultView || i.parentWindow || a)
                }
                g = 0;
                while ((h = o[g++]) && !b.isPropagationStopped()) b.type = g > 1 ? j : n.bindType || p, m = (V.get(h, "events") || {})[b.type] && V.get(h, "handle"), m && m.apply(h, c), m = k && h[k], m && m.apply && T(h) && (b.result = m.apply(h, c), b.result === !1 && b.preventDefault());
                return b.type = p, f || b.isDefaultPrevented() || n._default && n._default.apply(o.pop(), c) !== !1 || !T(e) || k && r.isFunction(e[p]) && !r.isWindow(e) && (i = e[k], i && (e[k] = null), r.event.triggered = p, e[p](), r.event.triggered = void 0, i && (e[k] = i)), b.result
            }
        },
        simulate: function(a, b, c) {
            var d = r.extend(new r.Event, c, {
                type: a,
                isSimulated: !0
            });
            r.event.trigger(d, null, b)
        }
    }), r.fn.extend({
        trigger: function(a, b) {
            return this.each(function() {
                r.event.trigger(a, b, this)
            })
        },
        triggerHandler: function(a, b) {
            var c = this[0];
            if (c) return r.event.trigger(a, b, c, !0)
        }
    }), r.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "), function(a, b) {
        r.fn[b] = function(a, c) {
            return arguments.length > 0 ? this.on(b, null, a, c) : this.trigger(b)
        }
    }), r.fn.extend({
        hover: function(a, b) {
            return this.mouseenter(a).mouseleave(b || a)
        }
        
    }), o.focusin = "onfocusin" in a, o.focusin || r.each({
        focus: "focusin",
        blur: "focusout"
    }, function(a, b) {
        var c = function(a) {
            r.event.simulate(b, a.target, r.event.fix(a))
        };
        r.event.special[b] = {
            setup: function() {
                var d = this.ownerDocument || this,
                    e = V.access(d, b);
                e || d.addEventListener(a, c, !0), V.access(d, b, (e || 0) + 1)
            },
            teardown: function() {
                var d = this.ownerDocument || this,
                    e = V.access(d, b) - 1;
                e ? V.access(d, b, e) : (d.removeEventListener(a, c, !0), V.remove(d, b))
            }
        }
    });
    var qb = a.location,
        rb = r.now(),
        sb = /\?/;
    r.parseXML = function(b) {
        var c;
        if (!b || "string" != typeof b) return null;
        try {
            c = (new a.DOMParser).parseFromString(b, "text/xml")
        } catch (d) {
            c = void 0
        }
        return c && !c.getElementsByTagName("parsererror").length || r.error("Invalid XML: " + b), c
    };
    var tb = /\[\]$/,
        ub = /\r?\n/g,
        vb = /^(?:submit|button|image|reset|file)$/i,
        wb = /^(?:input|select|textarea|keygen)/i;

    function xb(a, b, c, d) {
        var e;
        if (r.isArray(b)) r.each(b, function(b, e) {
            c || tb.test(a) ? d(a, e) : xb(a + "[" + ("object" == typeof e && null != e ? b : "") + "]", e, c, d)
        });
        else if (c || "object" !== r.type(b)) d(a, b);
        else
            for (e in b) xb(a + "[" + e + "]", b[e], c, d)
    }
    r.param = function(a, b) {
        var c, d = [],
            e = function(a, b) {
                var c = r.isFunction(b) ? b() : b;
                d[d.length] = encodeURIComponent(a) + "=" + encodeURIComponent(null == c ? "" : c)
            };
        if (r.isArray(a) || a.jquery && !r.isPlainObject(a)) r.each(a, function() {
            e(this.name, this.value)
        });
        else
            for (c in a) xb(c, a[c], b, e);
        return d.join("&")
    }, r.fn.extend({
        serialize: function() {
            return r.param(this.serializeArray())
        },
        serializeArray: function() {
            return this.map(function() {
                var a = r.prop(this, "elements");
                return a ? r.makeArray(a) : this
            }).filter(function() {
                var a = this.type;
                return this.name && !r(this).is(":disabled") && wb.test(this.nodeName) && !vb.test(a) && (this.checked || !ia.test(a))
            }).map(function(a, b) {
                var c = r(this).val();
                return null == c ? null : r.isArray(c) ? r.map(c, function(a) {
                    return {
                        name: b.name,
                        value: a.replace(ub, "\r\n")
                    }
                }) : {
                    name: b.name,
                    value: c.replace(ub, "\r\n")
                }
            }).get()
        }
    });
    var yb = /%20/g,
        zb = /#.*$/,
        Ab = /([?&])_=[^&]*/,
        Bb = /^(.*?):[ \t]*([^\r\n]*)$/gm,
        Cb = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,
        Db = /^(?:GET|HEAD)$/,
        Eb = /^\/\//,
        Fb = {},
        Gb = {},
        Hb = "*/".concat("*"),
        Ib = d.createElement("a");
    Ib.href = qb.href;

    function Jb(a) {
        return function(b, c) {
            "string" != typeof b && (c = b, b = "*");
            var d, e = 0,
                f = b.toLowerCase().match(K) || [];
            if (r.isFunction(c))
                while (d = f[e++]) "+" === d[0] ? (d = d.slice(1) || "*", (a[d] = a[d] || []).unshift(c)) : (a[d] = a[d] || []).push(c)
        }
    }

    function Kb(a, b, c, d) {
        var e = {},
            f = a === Gb;

        function g(h) {
            var i;
            return e[h] = !0, r.each(a[h] || [], function(a, h) {
                var j = h(b, c, d);
                return "string" != typeof j || f || e[j] ? f ? !(i = j) : void 0 : (b.dataTypes.unshift(j), g(j), !1)
            }), i
        }
        return g(b.dataTypes[0]) || !e["*"] && g("*")
    }

    function Lb(a, b) {
        var c, d, e = r.ajaxSettings.flatOptions || {};
        for (c in b) void 0 !== b[c] && ((e[c] ? a : d || (d = {}))[c] = b[c]);
        return d && r.extend(!0, a, d), a
    }

    function Mb(a, b, c) {
        var d, e, f, g, h = a.contents,
            i = a.dataTypes;
        while ("*" === i[0]) i.shift(), void 0 === d && (d = a.mimeType || b.getResponseHeader("Content-Type"));
        if (d)
            for (e in h)
                if (h[e] && h[e].test(d)) {
                    i.unshift(e);
                    break
                }
        if (i[0] in c) f = i[0];
        else {
            for (e in c) {
                if (!i[0] || a.converters[e + " " + i[0]]) {
                    f = e;
                    break
                }
                g || (g = e)
            }
            f = f || g
        }
        if (f) return f !== i[0] && i.unshift(f), c[f]
    }

    function Nb(a, b, c, d) {
        var e, f, g, h, i, j = {},
            k = a.dataTypes.slice();
        if (k[1])
            for (g in a.converters) j[g.toLowerCase()] = a.converters[g];
        f = k.shift();
        while (f)
            if (a.responseFields[f] && (c[a.responseFields[f]] = b), !i && d && a.dataFilter && (b = a.dataFilter(b, a.dataType)), i = f, f = k.shift())
                if ("*" === f) f = i;
                else if ("*" !== i && i !== f) {
            if (g = j[i + " " + f] || j["* " + f], !g)
                for (e in j)
                    if (h = e.split(" "), h[1] === f && (g = j[i + " " + h[0]] || j["* " + h[0]])) {
                        g === !0 ? g = j[e] : j[e] !== !0 && (f = h[0], k.unshift(h[1]));
                        break
                    }
            if (g !== !0)
                if (g && a["throws"]) b = g(b);
                else try {
                    b = g(b)
                } catch (l) {
                    return {
                        state: "parsererror",
                        error: g ? l : "No conversion from " + i + " to " + f
                    }
                }
        }
        return {
            state: "success",
            data: b
        }
    }
    r.extend({
        active: 0,
        lastModified: {},
        etag: {},
        ajaxSettings: {
            url: qb.href,
            type: "GET",
            isLocal: Cb.test(qb.protocol),
            global: !0,
            processData: !0,
            async: !0,
            contentType: "application/x-www-form-urlencoded; charset=UTF-8",
            accepts: {
                "*": Hb,
                text: "text/plain",
                html: "text/html",
                xml: "application/xml, text/xml",
                json: "application/json, text/javascript"
            },
            contents: {
                xml: /\bxml\b/,
                html: /\bhtml/,
                json: /\bjson\b/
            },
            responseFields: {
                xml: "responseXML",
                text: "responseText",
                json: "responseJSON"
            },
            converters: {
                "* text": String,
                "text html": !0,
                "text json": JSON.parse,
                "text xml": r.parseXML
            },
            flatOptions: {
                url: !0,
                context: !0
            }
        },
        ajaxSetup: function(a, b) {
            return b ? Lb(Lb(a, r.ajaxSettings), b) : Lb(r.ajaxSettings, a)
        },
        ajaxPrefilter: Jb(Fb),
        ajaxTransport: Jb(Gb),
        ajax: function(b, c) {
            "object" == typeof b && (c = b, b = void 0), c = c || {};
            var e, f, g, h, i, j, k, l, m, n, o = r.ajaxSetup({}, c),
                p = o.context || o,
                q = o.context && (p.nodeType || p.jquery) ? r(p) : r.event,
                s = r.Deferred(),
                t = r.Callbacks("once memory"),
                u = o.statusCode || {},
                v = {},
                w = {},
                x = "canceled",
                y = {
                    readyState: 0,
                    getResponseHeader: function(a) {
                        var b;
                        if (k) {
                            if (!h) {
                                h = {};
                                while (b = Bb.exec(g)) h[b[1].toLowerCase()] = b[2]
                            }
                            b = h[a.toLowerCase()]
                        }
                        return null == b ? null : b
                    },
                    getAllResponseHeaders: function() {
                        return k ? g : null
                    },
                    setRequestHeader: function(a, b) {
                        return null == k && (a = w[a.toLowerCase()] = w[a.toLowerCase()] || a, v[a] = b), this
                    },
                    overrideMimeType: function(a) {
                        return null == k && (o.mimeType = a), this
                    },
                    statusCode: function(a) {
                        var b;
                        if (a)
                            if (k) y.always(a[y.status]);
                            else
                                for (b in a) u[b] = [u[b], a[b]];
                        return this
                    },
                    abort: function(a) {
                        var b = a || x;
                        return e && e.abort(b), A(0, b), this
                    }
                };
            if (s.promise(y), o.url = ((b || o.url || qb.href) + "").replace(Eb, qb.protocol + "//"), o.type = c.method || c.type || o.method || o.type, o.dataTypes = (o.dataType || "*").toLowerCase().match(K) || [""], null == o.crossDomain) {
                j = d.createElement("a");
                try {
                    j.href = o.url, j.href = j.href, o.crossDomain = Ib.protocol + "//" + Ib.host != j.protocol + "//" + j.host
                } catch (z) {
                    o.crossDomain = !0
                }
            }
            if (o.data && o.processData && "string" != typeof o.data && (o.data = r.param(o.data, o.traditional)), Kb(Fb, o, c, y), k) return y;
            l = r.event && o.global, l && 0 === r.active++ && r.event.trigger("ajaxStart"), o.type = o.type.toUpperCase(), o.hasContent = !Db.test(o.type), f = o.url.replace(zb, ""), o.hasContent ? o.data && o.processData && 0 === (o.contentType || "").indexOf("application/x-www-form-urlencoded") && (o.data = o.data.replace(yb, "+")) : (n = o.url.slice(f.length), o.data && (f += (sb.test(f) ? "&" : "?") + o.data, delete o.data), o.cache === !1 && (f = f.replace(Ab, "$1"), n = (sb.test(f) ? "&" : "?") + "_=" + rb++ + n), o.url = f + n), o.ifModified && (r.lastModified[f] && y.setRequestHeader("If-Modified-Since", r.lastModified[f]), r.etag[f] && y.setRequestHeader("If-None-Match", r.etag[f])), (o.data && o.hasContent && o.contentType !== !1 || c.contentType) && y.setRequestHeader("Content-Type", o.contentType), y.setRequestHeader("Accept", o.dataTypes[0] && o.accepts[o.dataTypes[0]] ? o.accepts[o.dataTypes[0]] + ("*" !== o.dataTypes[0] ? ", " + Hb + "; q=0.01" : "") : o.accepts["*"]);
            for (m in o.headers) y.setRequestHeader(m, o.headers[m]);
            if (o.beforeSend && (o.beforeSend.call(p, y, o) === !1 || k)) return y.abort();
            if (x = "abort", t.add(o.complete), y.done(o.success), y.fail(o.error), e = Kb(Gb, o, c, y)) {
                if (y.readyState = 1, l && q.trigger("ajaxSend", [y, o]), k) return y;
                o.async && o.timeout > 0 && (i = a.setTimeout(function() {
                    y.abort("timeout")
                }, o.timeout));
                try {
                    k = !1, e.send(v, A)
                } catch (z) {
                    if (k) throw z;
                    A(-1, z)
                }
            } else A(-1, "No Transport");

            function A(b, c, d, h) {
                var j, m, n, v, w, x = c;
                k || (k = !0, i && a.clearTimeout(i), e = void 0, g = h || "", y.readyState = b > 0 ? 4 : 0, j = b >= 200 && b < 300 || 304 === b, d && (v = Mb(o, y, d)), v = Nb(o, v, y, j), j ? (o.ifModified && (w = y.getResponseHeader("Last-Modified"), w && (r.lastModified[f] = w), w = y.getResponseHeader("etag"), w && (r.etag[f] = w)), 204 === b || "HEAD" === o.type ? x = "nocontent" : 304 === b ? x = "notmodified" : (x = v.state, m = v.data, n = v.error, j = !n)) : (n = x, !b && x || (x = "error", b < 0 && (b = 0))), y.status = b, y.statusText = (c || x) + "", j ? s.resolveWith(p, [m, x, y]) : s.rejectWith(p, [y, x, n]), y.statusCode(u), u = void 0, l && q.trigger(j ? "ajaxSuccess" : "ajaxError", [y, o, j ? m : n]), t.fireWith(p, [y, x]), l && (q.trigger("ajaxComplete", [y, o]), --r.active || r.event.trigger("ajaxStop")))
            }
            return y
        },
        getJSON: function(a, b, c) {
            return r.get(a, b, c, "json")
        },
        getScript: function(a, b) {
            return r.get(a, void 0, b, "script")
        }
    }), r.each(["get", "post"], function(a, b) {
        r[b] = function(a, c, d, e) {
            return r.isFunction(c) && (e = e || d, d = c, c = void 0), r.ajax(r.extend({
                url: a,
                type: b,
                dataType: e,
                data: c,
                success: d
            }, r.isPlainObject(a) && a))
        }
    }), r._evalUrl = function(a) {
        return r.ajax({
            url: a,
            type: "GET",
            dataType: "script",
            cache: !0,
            async: !1,
            global: !1,
            "throws": !0
        })
    }, r.fn.extend({
        wrapAll: function(a) {
            var b;
            return this[0] && (r.isFunction(a) && (a = a.call(this[0])), b = r(a, this[0].ownerDocument).eq(0).clone(!0), this[0].parentNode && b.insertBefore(this[0]), b.map(function() {
                var a = this;
                while (a.firstElementChild) a = a.firstElementChild;
                return a
            }).append(this)), this
        },
        wrapInner: function(a) {
            return r.isFunction(a) ? this.each(function(b) {
                r(this).wrapInner(a.call(this, b))
            }) : this.each(function() {
                var b = r(this),
                    c = b.contents();
                c.length ? c.wrapAll(a) : b.append(a)
            })
        },
        wrap: function(a) {
            var b = r.isFunction(a);
            return this.each(function(c) {
                r(this).wrapAll(b ? a.call(this, c) : a)
            })
        },
        unwrap: function(a) {
            return this.parent(a).not("body").each(function() {
                r(this).replaceWith(this.childNodes)
            }), this
        }
    }), r.expr.pseudos.hidden = function(a) {
        return !r.expr.pseudos.visible(a)
    }, r.expr.pseudos.visible = function(a) {
        return !!(a.offsetWidth || a.offsetHeight || a.getClientRects().length)
    }, r.ajaxSettings.xhr = function() {
        try {
            return new a.XMLHttpRequest
        } catch (b) {}
    };
    var Ob = {
            0: 200,
            1223: 204
        },
        Pb = r.ajaxSettings.xhr();
    o.cors = !!Pb && "withCredentials" in Pb, o.ajax = Pb = !!Pb, r.ajaxTransport(function(b) {
        var c, d;
        if (o.cors || Pb && !b.crossDomain) return {
            send: function(e, f) {
                var g, h = b.xhr();
                if (h.open(b.type, b.url, b.async, b.username, b.password), b.xhrFields)
                    for (g in b.xhrFields) h[g] = b.xhrFields[g];
                b.mimeType && h.overrideMimeType && h.overrideMimeType(b.mimeType), b.crossDomain || e["X-Requested-With"] || (e["X-Requested-With"] = "XMLHttpRequest");
                for (g in e) h.setRequestHeader(g, e[g]);
                c = function(a) {
                    return function() {
                        c && (c = d = h.onload = h.onerror = h.onabort = h.onreadystatechange = null, "abort" === a ? h.abort() : "error" === a ? "number" != typeof h.status ? f(0, "error") : f(h.status, h.statusText) : f(Ob[h.status] || h.status, h.statusText, "text" !== (h.responseType || "text") || "string" != typeof h.responseText ? {
                            binary: h.response
                        } : {
                            text: h.responseText
                        }, h.getAllResponseHeaders()))
                    }
                }, h.onload = c(), d = h.onerror = c("error"), void 0 !== h.onabort ? h.onabort = d : h.onreadystatechange = function() {
                    4 === h.readyState && a.setTimeout(function() {
                        c && d()
                    })
                }, c = c("abort");
                try {
                    h.send(b.hasContent && b.data || null)
                } catch (i) {
                    if (c) throw i
                }
            },
            abort: function() {
                c && c()
            }
        }
    }), r.ajaxPrefilter(function(a) {
        a.crossDomain && (a.contents.script = !1)
    }), r.ajaxSetup({
        accepts: {
            script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"
        },
        contents: {
            script: /\b(?:java|ecma)script\b/
        },
        converters: {
            "text script": function(a) {
                return r.globalEval(a), a
            }
        }
    }), r.ajaxPrefilter("script", function(a) {
        void 0 === a.cache && (a.cache = !1), a.crossDomain && (a.type = "GET")
    }), r.ajaxTransport("script", function(a) {
        if (a.crossDomain) {
            var b, c;
            return {
                send: function(e, f) {
                    b = r("<script>").prop({
                        charset: a.scriptCharset,
                        src: a.url
                    }).on("load error", c = function(a) {
                        b.remove(), c = null, a && f("error" === a.type ? 404 : 200, a.type)
                    }), d.head.appendChild(b[0])
                },
                abort: function() {
                    c && c()
                }
            }
        }
    });
    var Qb = [],
        Rb = /(=)\?(?=&|$)|\?\?/;
    r.ajaxSetup({
        jsonp: "callback",
        jsonpCallback: function() {
            var a = Qb.pop() || r.expando + "_" + rb++;
            return this[a] = !0, a
        }
    }), r.ajaxPrefilter("json jsonp", function(b, c, d) {
        var e, f, g, h = b.jsonp !== !1 && (Rb.test(b.url) ? "url" : "string" == typeof b.data && 0 === (b.contentType || "").indexOf("application/x-www-form-urlencoded") && Rb.test(b.data) && "data");
        if (h || "jsonp" === b.dataTypes[0]) return e = b.jsonpCallback = r.isFunction(b.jsonpCallback) ? b.jsonpCallback() : b.jsonpCallback, h ? b[h] = b[h].replace(Rb, "$1" + e) : b.jsonp !== !1 && (b.url += (sb.test(b.url) ? "&" : "?") + b.jsonp + "=" + e), b.converters["script json"] = function() {
            return g || r.error(e + " was not called"), g[0]
        }, b.dataTypes[0] = "json", f = a[e], a[e] = function() {
            g = arguments
        }, d.always(function() {
            void 0 === f ? r(a).removeProp(e) : a[e] = f, b[e] && (b.jsonpCallback = c.jsonpCallback, Qb.push(e)), g && r.isFunction(f) && f(g[0]), g = f = void 0
        }), "script"
    }), o.createHTMLDocument = function() {
        var a = d.implementation.createHTMLDocument("").body;
        return a.innerHTML = "<form></form><form></form>", 2 === a.childNodes.length
    }(), r.parseHTML = function(a, b, c) {
        if ("string" != typeof a) return [];
        "boolean" == typeof b && (c = b, b = !1);
        var e, f, g;
        return b || (o.createHTMLDocument ? (b = d.implementation.createHTMLDocument(""), e = b.createElement("base"), e.href = d.location.href, b.head.appendChild(e)) : b = d), f = B.exec(a), g = !c && [], f ? [b.createElement(f[1])] : (f = pa([a], b, g), g && g.length && r(g).remove(), r.merge([], f.childNodes))
    }, r.fn.load = function(a, b, c) {
        var d, e, f, g = this,
            h = a.indexOf(" ");
        return h > -1 && (d = mb(a.slice(h)), a = a.slice(0, h)), r.isFunction(b) ? (c = b, b = void 0) : b && "object" == typeof b && (e = "POST"), g.length > 0 && r.ajax({
            url: a,
            type: e || "GET",
            dataType: "html",
            data: b
        }).done(function(a) {
            f = arguments, g.html(d ? r("<div>").append(r.parseHTML(a)).find(d) : a)
        }).always(c && function(a, b) {
            g.each(function() {
                c.apply(this, f || [a.responseText, b, a])
            })
        }), this
    }, r.each(["ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend"], function(a, b) {
        r.fn[b] = function(a) {
            return this.on(b, a)
        }
    }), r.expr.pseudos.animated = function(a) {
        return r.grep(r.timers, function(b) {
            return a === b.elem
        }).length
    };

    function Sb(a) {
        return r.isWindow(a) ? a : 9 === a.nodeType && a.defaultView
    }
    r.offset = {
        setOffset: function(a, b, c) {
            var d, e, f, g, h, i, j, k = r.css(a, "position"),
                l = r(a),
                m = {};
            "static" === k && (a.style.position = "relative"), h = l.offset(), f = r.css(a, "top"), i = r.css(a, "left"), j = ("absolute" === k || "fixed" === k) && (f + i).indexOf("auto") > -1, j ? (d = l.position(), g = d.top, e = d.left) : (g = parseFloat(f) || 0, e = parseFloat(i) || 0), r.isFunction(b) && (b = b.call(a, c, r.extend({}, h))), null != b.top && (m.top = b.top - h.top + g), null != b.left && (m.left = b.left - h.left + e), "using" in b ? b.using.call(a, m) : l.css(m)
        }
    }, r.fn.extend({
        offset: function(a) {
            if (arguments.length) return void 0 === a ? this : this.each(function(b) {
                r.offset.setOffset(this, a, b)
            });
            var b, c, d, e, f = this[0];
            if (f) return f.getClientRects().length ? (d = f.getBoundingClientRect(), d.width || d.height ? (e = f.ownerDocument, c = Sb(e), b = e.documentElement, {
                top: d.top + c.pageYOffset - b.clientTop,
                left: d.left + c.pageXOffset - b.clientLeft
            }) : d) : {
                top: 0,
                left: 0
            }
        },
        position: function() {
            if (this[0]) {
                var a, b, c = this[0],
                    d = {
                        top: 0,
                        left: 0
                    };
                return "fixed" === r.css(c, "position") ? b = c.getBoundingClientRect() : (a = this.offsetParent(), b = this.offset(), r.nodeName(a[0], "html") || (d = a.offset()), d = {
                    top: d.top + r.css(a[0], "borderTopWidth", !0),
                    left: d.left + r.css(a[0], "borderLeftWidth", !0)
                }), {
                    top: b.top - d.top - r.css(c, "marginTop", !0),
                    left: b.left - d.left - r.css(c, "marginLeft", !0)
                }
            }
        },
        offsetParent: function() {
            return this.map(function() {
                var a = this.offsetParent;
                while (a && "static" === r.css(a, "position")) a = a.offsetParent;
                return a || qa
            })
        }
    }), r.each({
        scrollLeft: "pageXOffset",
        scrollTop: "pageYOffset"
    }, function(a, b) {
        var c = "pageYOffset" === b;
        r.fn[a] = function(d) {
            return S(this, function(a, d, e) {
                var f = Sb(a);
                return void 0 === e ? f ? f[b] : a[d] : void(f ? f.scrollTo(c ? f.pageXOffset : e, c ? e : f.pageYOffset) : a[d] = e)
            }, a, d, arguments.length)
        }
    }), r.each(["top", "left"], function(a, b) {
        r.cssHooks[b] = Oa(o.pixelPosition, function(a, c) {
            if (c) return c = Na(a, b), La.test(c) ? r(a).position()[b] + "px" : c
        })
    }), r.each({
        Height: "height",
        Width: "width"
    }, function(a, b) {
        r.each({
            padding: "inner" + a,
            content: b,
            "": "outer" + a
        }, function(c, d) {
            r.fn[d] = function(e, f) {
                var g = arguments.length && (c || "boolean" != typeof e),
                    h = c || (e === !0 || f === !0 ? "margin" : "border");
                return S(this, function(b, c, e) {
                    var f;
                    return r.isWindow(b) ? 0 === d.indexOf("outer") ? b["inner" + a] : b.document.documentElement["client" + a] : 9 === b.nodeType ? (f = b.documentElement, Math.max(b.body["scroll" + a], f["scroll" + a], b.body["offset" + a], f["offset" + a], f["client" + a])) : void 0 === e ? r.css(b, c, h) : r.style(b, c, e, h)
                }, b, g ? e : void 0, g)
            }
        })
    }), r.fn.extend({
        bind: function(a, b, c) {
            return this.on(a, null, b, c)
        },
        unbind: function(a, b) {
            return this.off(a, null, b)
        },
        delegate: function(a, b, c, d) {
            return this.on(b, a, c, d)
        },
        undelegate: function(a, b, c) {
            return 1 === arguments.length ? this.off(a, "**") : this.off(b, a || "**", c)
        }
    }), r.parseJSON = JSON.parse, "function" == typeof define && define.amd && define("jquery", [], function() {
        return r
    });
    var Tb = a.jQuery,
        Ub = a.$;
    return r.noConflict = function(b) {
        return a.$ === r && (a.$ = Ub), b && a.jQuery === r && (a.jQuery = Tb), r
    }, b || (a.jQuery = a.$ = r), r
});
define('dictionary',['jquery'],function($) {
		//@@@<<< DICTIONARY 

			function getFromDictionary (iNval) {
				/*
					@discr
						get value (stirng) from dictionary object by key
					@inputs
						@required
							iNval -> string
								@expamle (iNval = country-mexico+code)
					@return
						string : emptry string or string with value from dictianary
				*/
			var DICTIONARY = window.CONNECT_DICTIONARY;
			  if(typeof(DICTIONARY) != 'object') return '';
			  var val = iNval,languageCode,result,body,field=null,header,key,fieldKey,keyBlock,blockName,lang;
			  t = val.split('-');
			  blockName = t[0];
			  keyBlock 	= t[1].split('+');
			  key 			= keyBlock[0];
			  
			  header 	= DICTIONARY[blockName]['header'];
			  body 		= DICTIONARY[blockName]['body'];
			  if ( keyBlock.length > 1 ) 
			    fieldKey = keyBlock[1];
			  else 
			    fieldKey = 'val';
			  
			  field = header[fieldKey];
			  if( typeof body == 'object' && typeof body[key] != 'undefined')
			  	result = body[key][field];
			  if(!result) result = '';

			  return result;
			}


			function _startDictionary (iNparentElement) {
				/*
					@discr
						change [[keys]] to world from Dictionary [by dom path]
					@input
						@required
						@optional
							iNparentElement -> string
					@deps
						function : withString
					@return void
				*/
				  if(typeof(iNparentElement)=='undefined')iNparentElement = 'html';
				  var parentEl = iNparentElement;
				  var val;
				  $(iNparentElement + " .CML").each(function (item) {
				  	// get mask from attr || or text (if first invoke)
				  	if( $(this).attr('CMLK') ) {
				    	val = $(this).attr('CMLK');
				    } else {
				     	val = $(this).html();
				    	$(this).attr('CMLK',val);
				    }
				    $(this).html( withString(val) );
				  });
			}

			function withLanguageObject (iNobject) {
				/*
					@inputs
						@required
							iNobject -> object <- object
								{
									'ru' 	: '',
									'*' 	: 'all',
									'en' 	: 'english some text'
								}
				*/
				// if we are not object we add 
				if( typeof iNobject != 'object' )  
					if( typeof iNobject != 'undefined' ) 
						iNobject = { '*': iNobject };
					else
						iNobject = { '*': '' };

				let ourLocale = getLocale();
				var content; 
				if ( iNobject[ourLocale] ) {
					// if isset client language
					content = iNobject[ourLocale];
				} else if (iNobject['*'] ) {
					// if NOT isset client language -> we get all language
					content = iNobject['*'];
				} else {
					return '';
				}
				return withString(content);
			}

			function withString (iNstring) {
				/*
					@discr
						convert input string var (iNstring) to value from dictionary array by function
						get array with masks from text
					@input
						iNstring -> string
					@return
						string: data with replacement

				*/
				 	var val = iNstring;
				    var arrayWithKeys = val.match(/\[[a-zA-Z0-9\-\+]*\]/g);
				    for(var iKey in arrayWithKeys) {
				    	var thisValue = arrayWithKeys[iKey].replace(/[\[\]]+/g,'');
				      var newValue = getFromDictionary(thisValue);
				      val = val.replace(arrayWithKeys[iKey],newValue);
				    }
				    return val;
			}

			function addScript (iNhref,iNfuntion) {
				/*
					@discr
						load js script by url to dom
					@input
						@required
							iNhref -> string (url)
						@optional
							iNfuntion -> function what invoking in finishing
					@return void
				*/
				$.getScript(iNhref, iNfuntion );//( data, textStatus, jqxhr )
			}

			function changeLang (iNlang,iNpath,iNfuntion) {
				/*
					@discr
						change language 
					@input
						@required
							saveUserLang -> string (url)
						@optional
							iNpath  -> string (path to dom element) passed to function (_startDictionary)
							iNfuntion -> function what invoking in finishing
					@deps
						function : addScript
						function : _startDictionary
						function : saveUserLang
					@return void
				*/
				var path =iNpath;
				var langHref = 'https://ramman.net/res/web/js/getdictionary.js?'+'lang='+iNlang;
				$('.CMLSourse').remove();
				addScript(langHref,function(){
					$('script[src="' + langHref +'"]').addClass('CMLSourse');
					_startDictionary(path);
					saveUserLang(iNlang);
					if(typeof(iNfuntion)=='function')iNfuntion();
				});
			}


			function _dictionaryAutoChange (iNfuntion) {
				/*
					@discr
						starting proces to get dictionary and replace 
					@input
						@required
						@optional
							iNfuntion -> function what invoking in finishing
					@deps
						function : changeLang
						function : getLocale
					@return void
				*/
				changeLang ( getLocale(), 'html', iNfuntion );
			}




			function getLocale () {
				/*
					@discr
						know user language
					@input
						@required
						@optional
					@deps
					@return void
				*/
				var userLang = navigator.language || navigator.userLanguage; 

				// for firefox and safari
				if(userLang == 'ru-RU') userLang = 'ru';
				if(userLang == 'en-US') userLang = 'en';

				switch ( userLang ) {
					case "en":
						// if language English
						userLang = 'en';
					break;

					default:
						// default language Russian
						userLang = 'ru';
				} 

				// return language
				return userLang;
			}


			function getUserCountry () {
				return localStorage.getItem('ConnectUserCountry');
			}
			function saveUserCountry (iNcountry) {
				return localStorage.setItem('ConnectUserCountry',iNcountry);
			}
			function getUserLang () {
				return localStorage.getItem('ConnectUserLang');
			}
			function saveUserLang (iNlang) {
				return localStorage.setItem('ConnectUserLang',iNlang);
			}
		//@@@>>> DICTIONARY 

		return {
			getLocale 			: getLocale,
			autoChange			: _dictionaryAutoChange,
			changeLang 			: changeLang,
			start 				: _startDictionary,
			get 				: getFromDictionary,
			withString      	: withString,
			withLanguageObject  : withLanguageObject
		}
	//@>>> URL FUNCTIONS
});
/*
	@schema
		url
*/;
/*!
 * @license Firebase v4.6.0
 * Build: rev-f5e674c
 * Terms: https://firebase.google.com/terms/
 */
var firebase=function(){var e=void 0===e?self:e;return function(t){function r(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}var n=e.webpackJsonpFirebase;e.webpackJsonpFirebase=function(e,o,a){for(var c,s,u,f=0,l=[];f<e.length;f++)s=e[f],i[s]&&l.push(i[s][0]),i[s]=0;for(c in o)Object.prototype.hasOwnProperty.call(o,c)&&(t[c]=o[c]);for(n&&n(e,o,a);l.length;)l.shift()();if(a)for(f=0;f<a.length;f++)u=r(r.s=a[f]);return u};var o={},i={5:0};return r.e=function(e){function t(){c.onerror=c.onload=null,clearTimeout(s);var t=i[e];0!==t&&(t&&t[1](Error("Loading chunk "+e+" failed.")),i[e]=void 0)}var n=i[e];if(0===n)return new Promise(function(e){e()});if(n)return n[2];var o=new Promise(function(t,r){n=i[e]=[t,r]});n[2]=o;var a=document.getElementsByTagName("head")[0],c=document.createElement("script");c.type="text/javascript",c.charset="utf-8",c.async=!0,c.timeout=12e4,r.nc&&c.setAttribute("nonce",r.nc),c.src=r.p+""+e+".js";var s=setTimeout(t,12e4);return c.onerror=c.onload=t,a.appendChild(c),o},r.m=t,r.c=o,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r.oe=function(e){throw console.error(e),e},r(r.s=56)}([function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(27)),n(r(28)),n(r(20)),n(r(64)),n(r(65)),n(r(66)),n(r(67)),n(r(29)),n(r(68)),n(r(30)),n(r(69)),n(r(70)),n(r(72)),n(r(73)),n(r(74))},,,,,,function(e,t,r){"use strict";function n(){function e(e){h(d[e],"delete"),delete d[e]}function t(e){return e=e||c,a(d,e)||o("no-app",{name:e}),d[e]}function r(e,t){void 0===t?t=c:"string"==typeof t&&""!==t||o("bad-app-name",{name:t+""}),a(d,t)&&o("duplicate-app",{name:t});var r=new u(e,t,b);return d[t]=r,h(r,"create"),r}function s(){return Object.keys(d).map(function(e){return d[e]})}function f(e,r,n,a,c){v[e]&&o("duplicate-service",{name:e}),v[e]=r,a&&(y[e]=a,s().forEach(function(e){a("create",e)}));var f=function(r){return void 0===r&&(r=t()),"function"!=typeof r[e]&&o("invalid-app-argument",{name:e}),r[e]()};return void 0!==n&&Object(i.deepExtend)(f,n),b[e]=f,u.prototype[e]=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return this.t.bind(this,e).apply(this,c?t:[])},f}function l(e){Object(i.deepExtend)(b,e)}function h(e,t){Object.keys(v).forEach(function(r){var n=p(e,r);null!==n&&y[n]&&y[n](t,e)})}function p(e,t){if("serverAuth"===t)return null;var r=t;return e.options,r}var d={},v={},y={},b={__esModule:!0,initializeApp:r,app:t,apps:null,Promise:Promise,SDK_VERSION:"4.6.0",INTERNAL:{registerService:f,createFirebaseNamespace:n,extendNamespace:l,createSubscribe:i.createSubscribe,ErrorFactory:i.ErrorFactory,removeApp:e,factories:v,useAsService:p,Promise:Promise,deepExtend:i.deepExtend}};return Object(i.patchProperty)(b,"default",b),Object.defineProperty(b,"apps",{get:s}),Object(i.patchProperty)(t,"App",u),b}function o(e,t){throw l.create(e,t)}Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),a=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c="[DEFAULT]",s=[],u=function(){function e(e,t,r){this.r=r,this.a=!1,this.u={},this.f=t,this.h=Object(i.deepCopy)(e),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(e){s.push(e),setTimeout(function(){return e(null)},0)},removeAuthTokenListener:function(e){s=s.filter(function(t){return t!==e})}}}return Object.defineProperty(e.prototype,"name",{get:function(){return this.v(),this.f},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.v(),this.h},enumerable:!0,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise(function(t){e.v(),t()}).then(function(){e.r.INTERNAL.removeApp(e.f);var t=[];return Object.keys(e.u).forEach(function(r){Object.keys(e.u[r]).forEach(function(n){t.push(e.u[r][n])})}),Promise.all(t.map(function(e){return e.INTERNAL.delete()}))}).then(function(){e.a=!0,e.u={}})},e.prototype.t=function(e,t){if(void 0===t&&(t=c),this.v(),this.u[e]||(this.u[e]={}),!this.u[e][t]){var r=t!==c?t:void 0,n=this.r.INTERNAL.factories[e](this,this.extendApp.bind(this),r);this.u[e][t]=n}return this.u[e][t]},e.prototype.extendApp=function(e){var t=this;Object(i.deepExtend)(this,e),e.INTERNAL&&e.INTERNAL.addAuthTokenListener&&(s.forEach(function(e){t.INTERNAL.addAuthTokenListener(e)}),s=[])},e.prototype.v=function(){this.a&&o("app-deleted",{name:this.f})},e}();u.prototype.name&&u.prototype.options||u.prototype.delete||console.log("dc");var f={"no-app":"No Firebase App '{$name}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$name}","duplicate-app":"Firebase App named '{$name}' already exists","app-deleted":"Firebase App named '{$name}' already deleted","duplicate-service":"Firebase service named '{$name}' already registered","sa-not-supported":"Initializing the Firebase SDK with a service account is only allowed in a Node.js environment. On client devices, you should instead initialize the SDK with an api key and auth domain","invalid-app-argument":"firebase.{$name}() takes either no argument or a Firebase App instance."},l=new i.ErrorFactory("app","Firebase",f);r.d(t,"firebase",function(){return h});var h=n();t.default=h},,,,,,,,,,,,,function(t,r){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof e&&(n=e)}t.exports=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CONSTANTS={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"}},,,,,,function(e,t){function r(){throw Error("setTimeout has not been defined")}function n(){throw Error("clearTimeout has not been defined")}function o(e){if(f===setTimeout)return setTimeout(e,0);if((f===r||!f)&&setTimeout)return f=setTimeout,setTimeout(e,0);try{return f(e,0)}catch(t){try{return f.call(null,e,0)}catch(t){return f.call(this,e,0)}}}function i(e){if(l===clearTimeout)return clearTimeout(e);if((l===n||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{return l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}function a(){v&&p&&(v=!1,p.length?d=p.concat(d):y=-1,d.length&&c())}function c(){if(!v){var e=o(a);v=!0;for(var t=d.length;t;){for(p=d,d=[];++y<t;)p&&p[y].run();y=-1,t=d.length}p=null,v=!1,i(e)}}function s(e,t){this.fun=e,this.array=t}function u(){}var f,l,h=e.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:r}catch(e){f=r}try{l="function"==typeof clearTimeout?clearTimeout:n}catch(e){l=n}}();var p,d=[],v=!1,y=-1;h.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];d.push(new s(e,t)),1!==d.length||v||o(c)},s.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=u,h.addListener=u,h.once=u,h.off=u,h.removeListener=u,h.removeAllListeners=u,h.emit=u,h.prependListener=u,h.prependOnceListener=u,h.listeners=function(e){return[]},h.binding=function(e){throw Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw Error("process.chdir is not supported")},h.umask=function(){return 0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(20);t.assert=function(e,r){if(!e)throw t.assertionError(r)},t.assertionError=function(e){return Error("Firebase Database ("+n.CONSTANTS.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){for(var t=[],r=0,n=0;n<e.length;n++){for(var o=e.charCodeAt(n);o>255;)t[r++]=255&o,o>>=8;t[r++]=o}return t},o=function(e){if(e.length<8192)return String.fromCharCode.apply(null,e);for(var t="",r=0;r<e.length;r+=8192){var n=e.slice(r,r+8192);t+=String.fromCharCode.apply(null,n)}return t};t.base64={y:null,b:null,_:null,g:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.O();for(var r=t?this._:this.y,n=[],o=0;o<e.length;o+=3){var i=e[o],a=o+1<e.length,c=a?e[o+1]:0,s=o+2<e.length,u=s?e[o+2]:0,f=i>>2,l=(3&i)<<4|c>>4,h=(15&c)<<2|u>>6,p=63&u;s||(p=64,a||(h=64)),n.push(r[f],r[l],r[h],r[p])}return n.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(n(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):o(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.O();for(var r=t?this.g:this.b,n=[],o=0;o<e.length;){var i=r[e.charAt(o++)],a=o<e.length,c=a?r[e.charAt(o)]:0;++o;var s=o<e.length,u=s?r[e.charAt(o)]:64;++o;var f=o<e.length,l=f?r[e.charAt(o)]:64;if(++o,null==i||null==c||null==u||null==l)throw Error();var h=i<<2|c>>4;if(n.push(h),64!=u){var p=c<<4&240|u>>2;if(n.push(p),64!=l){var d=u<<6&192|l;n.push(d)}}}return n},O:function(){if(!this.y){this.y={},this.b={},this._={},this.g={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.y[e]=this.ENCODED_VALS.charAt(e),this.b[this.y[e]]=e,this._[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.g[this._[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.b[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.g[this.ENCODED_VALS.charAt(e)]=e)}}},t.base64Encode=function(e){var r=n(e);return t.base64.encodeByteArray(r,!0)},t.base64Decode=function(e){try{return t.base64.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null}},function(e,t,r){"use strict";function n(e){return JSON.parse(e)}function o(e){return JSON.stringify(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.jsonEval=n,t.stringify=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.contains=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.safeGet=function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]},t.forEach=function(e,t){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])},t.extend=function(e,r){return t.forEach(r,function(t,r){e[t]=r}),e},t.clone=function(e){return t.extend({},e)},t.isNonNullObject=function(e){return"object"==typeof e&&null!==e},t.isEmpty=function(e){for(var t in e)return!1;return!0},t.getCount=function(e){var t=0;for(var r in e)t++;return t},t.map=function(e,t,r){var n={};for(var o in e)n[o]=t.call(r,e[o],o,e);return n},t.findKey=function(e,t,r){for(var n in e)if(t.call(r,e[n],n,e))return n},t.findValue=function(e,r,n){var o=t.findKey(e,r,n);return o&&e[o]},t.getAnyKey=function(e){for(var t in e)return t},t.getValues=function(e){var t=[],r=0;for(var n in e)t[r++]=e[n];return t},t.every=function(e,t){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&!t(r,e[r]))return!1;return!0}},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){r(57),e.exports=r(6).default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(58),o=(r.n(n),r(62)),i=(r.n(o),r(63));r.n(i)},function(t,r,n){(function(t){var r=function(){if(void 0!==t)return t;if(void 0!==e)return e;if("undefined"!=typeof self)return self;throw Error("unable to locate global object")}();"undefined"==typeof Promise&&(r.Promise=Promise=n(59))}).call(r,n(19))},function(e,t,r){(function(t){!function(r){function n(){}function o(e,t){return function(){e.apply(t,arguments)}}function i(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this.T=[],l(e,this)}function a(e,t){for(;3===e._state;)e=e._value;if(0===e._state)return void e.T.push(t);e._handled=!0,i.A(function(){var r=1===e._state?t.onFulfilled:t.onRejected;if(null===r)return void(1===e._state?c:s)(t.promise,e._value);var n;try{n=r(e._value)}catch(e){return void s(t.promise,e)}c(t.promise,n)})}function c(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var r=t.then;if(t instanceof i)return e._state=3,e._value=t,void u(e);if("function"==typeof r)return void l(o(r,t),e)}e._state=1,e._value=t,u(e)}catch(t){s(e,t)}}function s(e,t){e._state=2,e._value=t,u(e)}function u(e){2===e._state&&0===e.T.length&&i.A(function(){e._handled||i.j(e._value)});for(var t=0,r=e.T.length;t<r;t++)a(e,e.T[t]);e.T=null}function f(e,t,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=r}function l(e,t){var r=!1;try{e(function(e){r||(r=!0,c(t,e))},function(e){r||(r=!0,s(t,e))})}catch(e){if(r)return;r=!0,s(t,e)}}var h=setTimeout;i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var r=new this.constructor(n);return a(this,new f(e,t,r)),r},i.all=function(e){var t=Array.prototype.slice.call(e);return new i(function(e,r){function n(i,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void c.call(a,function(e){n(i,e)},r)}t[i]=a,0==--o&&e(t)}catch(e){r(e)}}if(0===t.length)return e([]);for(var o=t.length,i=0;i<t.length;i++)n(i,t[i])})},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i(function(t){t(e)})},i.reject=function(e){return new i(function(t,r){r(e)})},i.race=function(e){return new i(function(t,r){for(var n=0,o=e.length;n<o;n++)e[n].then(t,r)})},i.A="function"==typeof t&&function(e){t(e)}||function(e){h(e,0)},i.j=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},i.w=function(e){i.A=e},i.S=function(e){i.j=e},void 0!==e&&e.exports?e.exports=i:r.Promise||(r.Promise=i)}(this)}).call(t,r(60).setImmediate)},function(t,r,n){function o(e,t){this.P=e,this._clearFn=t}var i=Function.prototype.apply;r.setTimeout=function(){return new o(i.call(setTimeout,e,arguments),clearTimeout)},r.setInterval=function(){return new o(i.call(setInterval,e,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(e,this.P)},r.enroll=function(e,t){clearTimeout(e.N),e.C=t},r.unenroll=function(e){clearTimeout(e.N),e.C=-1},r.k=r.active=function(e){clearTimeout(e.N);var t=e.C;t>=0&&(e.N=setTimeout(function(){e.M&&e.M()},t))},n(61),r.setImmediate=setImmediate,r.clearImmediate=clearImmediate},function(e,t,r){(function(e,t){!function(e,r){"use strict";function n(e){"function"!=typeof e&&(e=Function(""+e));for(var t=Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var n={callback:e,args:t};return u[s]=n,c(s),s++}function o(e){delete u[e]}function i(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(r,n)}}function a(e){if(f)setTimeout(a,0,e);else{var t=u[e];if(t){f=!0;try{i(t)}finally{o(e),f=!1}}}}if(!e.setImmediate){var c,s=1,u={},f=!1,l=e.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(e);h=h&&h.setTimeout?h:e,"[object process]"==={}.toString.call(e.process)?function(){c=function(e){t.nextTick(function(){a(e)})}}():function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?function(){var t="setImmediate$"+Math.random()+"$",r=function(r){r.source===e&&"string"==typeof r.data&&0===r.data.indexOf(t)&&a(+r.data.slice(t.length))};e.addEventListener?e.addEventListener("message",r,!1):e.attachEvent("onmessage",r),c=function(r){e.postMessage(t+r,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){a(e.data)},c=function(t){e.port2.postMessage(t)}}():l&&"onreadystatechange"in l.createElement("script")?function(){var e=l.documentElement;c=function(t){var r=l.createElement("script");r.onreadystatechange=function(){a(t),r.onreadystatechange=null,e.removeChild(r),r=null},e.appendChild(r)}}():function(){c=function(e){setTimeout(a,0,e)}}(),h.setImmediate=n,h.clearImmediate=o}}("undefined"==typeof self?void 0===e?this:e:self)}).call(t,r(19),r(26))},function(e,t){Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),r=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var n=arguments[1],o=0;o<r;){var i=t[o];if(e.call(n,i,o,t))return i;o++}}})},function(e,t){Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),r=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var n=arguments[1],o=0;o<r;){var i=t[o];if(e.call(n,i,o,t))return o;o++}return-1}})},function(e,t,r){"use strict";function n(e){return o(void 0,e)}function o(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:var r=t;return new Date(r.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&(e[n]=o(e[n],t[n]));return e}function i(e,t,r){e[t]=r}Object.defineProperty(t,"__esModule",{value:!0}),t.deepCopy=n,t.deepExtend=o,t.patchProperty=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){var e=this;this.promise=new Promise(function(t,r){e.resolve=t,e.reject=r})}return e.prototype.wrapCallback=function(e){var t=this;return function(r,n){r?t.reject(r):t.resolve(n),"function"==typeof e&&(t.promise.catch(function(){}),1===e.length?e(r):e(r,n))}},e}();t.Deferred=n},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=n(20);r.getUA=function(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""},r.isMobileCordova=function(){return void 0!==e&&!!(e.cordova||e.phonegap||e.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(r.getUA())},r.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},r.isNodeSdk=function(){return!0===o.CONSTANTS.NODE_CLIENT||!0===o.CONSTANTS.NODE_ADMIN}},function(e,t,r){"use strict";function n(e){var t=i;return i=e,t}Object.defineProperty(t,"__esModule",{value:!0});var o="FirebaseError",i=Error.captureStackTrace;t.patchCapture=n;var a=function(){function e(e,t){if(this.code=e,this.message=t,i)i(this,c.prototype.create);else{var r=Error.apply(this,arguments);this.name=o,Object.defineProperty(this,"stack",{get:function(){return r.stack}})}}return e}();t.FirebaseError=a,a.prototype=Object.create(Error.prototype),a.prototype.constructor=a,a.prototype.name=o;var c=function(){function e(e,t,r){this.service=e,this.serviceName=t,this.errors=r,this.pattern=/\{\$([^}]+)}/g}return e.prototype.create=function(e,t){void 0===t&&(t={});var r,n=this.errors[e],o=this.service+"/"+e;r=void 0===n?"Error":n.replace(this.pattern,function(e,r){var n=t[r];return void 0!==n?""+n:"<"+r+"?>"}),r=this.serviceName+": "+r+" ("+o+").";var i=new a(o,r);for(var c in t)t.hasOwnProperty(c)&&"_"!==c.slice(-1)&&(i[c]=t[c]);return i},e}();t.ErrorFactory=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(28),o=r(29);t.decode=function(e){var t={},r={},i={},a="";try{var c=e.split(".");t=o.jsonEval(n.base64Decode(c[0])||""),r=o.jsonEval(n.base64Decode(c[1])||""),a=c[2],i=r.d||{},delete r.d}catch(e){}return{header:t,claims:r,data:i,signature:a}},t.isValidTimestamp=function(e){var r,n,o=t.decode(e).claims,i=Math.floor((new Date).getTime()/1e3);return"object"==typeof o&&(o.hasOwnProperty("nbf")?r=o.nbf:o.hasOwnProperty("iat")&&(r=o.iat),n=o.hasOwnProperty("exp")?o.exp:r+86400),i&&r&&n&&i>=r&&i<=n},t.issuedAtTime=function(e){var r=t.decode(e).claims;return"object"==typeof r&&r.hasOwnProperty("iat")?r.iat:null},t.isValidFormat=function(e){var r=t.decode(e),n=r.claims;return!!r.signature&&!!n&&"object"==typeof n&&n.hasOwnProperty("iat")},t.isAdmin=function(e){var r=t.decode(e).claims;return"object"==typeof r&&!0===r.admin}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(30);t.querystring=function(e){var t=[];return n.forEach(e,function(e,r){Array.isArray(r)?r.forEach(function(r){t.push(encodeURIComponent(e)+"="+encodeURIComponent(r))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(r))}),t.length?"&"+t.join("&"):""},t.querystringDecode=function(e){var t={};return e.replace(/^\?/,"").split("&").forEach(function(e){if(e){var r=e.split("=");t[r[0]]=r[1]}}),t}},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(71),i=function(e){function t(){var t=e.call(this)||this;t.D=[],t.I=[],t.x=[],t.F=[],t.L=0,t.R=0,t.blockSize=64,t.F[0]=128;for(var r=1;r<t.blockSize;++r)t.F[r]=0;return t.reset(),t}return n(t,e),t.prototype.reset=function(){this.D[0]=1732584193,this.D[1]=4023233417,this.D[2]=2562383102,this.D[3]=271733878,this.D[4]=3285377520,this.L=0,this.R=0},t.prototype.B=function(e,t){t||(t=0);var r=this.x;if("string"==typeof e)for(var n=0;n<16;n++)r[n]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(var n=0;n<16;n++)r[n]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(var n=16;n<80;n++){var o=r[n-3]^r[n-8]^r[n-14]^r[n-16];r[n]=4294967295&(o<<1|o>>>31)}for(var i,a,c=this.D[0],s=this.D[1],u=this.D[2],f=this.D[3],l=this.D[4],n=0;n<80;n++){n<40?n<20?(i=f^s&(u^f),a=1518500249):(i=s^u^f,a=1859775393):n<60?(i=s&u|f&(s|u),a=2400959708):(i=s^u^f,a=3395469782);var o=(c<<5|c>>>27)+i+l+a+r[n]&4294967295;l=f,f=u,u=4294967295&(s<<30|s>>>2),s=c,c=o}this.D[0]=this.D[0]+c&4294967295,this.D[1]=this.D[1]+s&4294967295,this.D[2]=this.D[2]+u&4294967295,this.D[3]=this.D[3]+f&4294967295,this.D[4]=this.D[4]+l&4294967295},t.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var r=t-this.blockSize,n=0,o=this.I,i=this.L;n<t;){if(0==i)for(;n<=r;)this.B(e,n),n+=this.blockSize;if("string"==typeof e){for(;n<t;)if(o[i]=e.charCodeAt(n),++i,++n,i==this.blockSize){this.B(o),i=0;break}}else for(;n<t;)if(o[i]=e[n],++i,++n,i==this.blockSize){this.B(o),i=0;break}}this.L=i,this.R+=t}},t.prototype.digest=function(){var e=[],t=8*this.R;this.L<56?this.update(this.F,56-this.L):this.update(this.F,this.blockSize-(this.L-56));for(var r=this.blockSize-1;r>=56;r--)this.I[r]=255&t,t/=256;this.B(this.I);for(var n=0,r=0;r<5;r++)for(var o=24;o>=0;o-=8)e[n]=this.D[r]>>o&255,++n;return e},t}(o.Hash);t.Sha1=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.blockSize=-1}return e}();t.Hash=n},function(e,t,r){"use strict";function n(e,t){var r=new c(e,t);return r.subscribe.bind(r)}function o(e,t){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];Promise.resolve(!0).then(function(){e.apply(void 0,r)}).catch(function(e){t&&t(e)})}}function i(e,t){if("object"!=typeof e||null===e)return!1;for(var r=0,n=t;r<n.length;r++){var o=n[r];if(o in e&&"function"==typeof e[o])return!0}return!1}function a(){}Object.defineProperty(t,"__esModule",{value:!0}),t.createSubscribe=n;var c=function(){function e(e,t){var r=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(function(){e(r)}).catch(function(e){r.error(e)})}return e.prototype.next=function(e){this.forEachObserver(function(t){t.next(e)})},e.prototype.error=function(e){this.forEachObserver(function(t){t.error(e)}),this.close(e)},e.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},e.prototype.subscribe=function(e,t,r){var n,o=this;if(void 0===e&&void 0===t&&void 0===r)throw Error("Missing Observer.");n=i(e,["next","error","complete"])?e:{next:e,error:t,complete:r},void 0===n.next&&(n.next=a),void 0===n.error&&(n.error=a),void 0===n.complete&&(n.complete=a);var c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{o.finalError?n.error(o.finalError):n.complete()}catch(e){}}),this.observers.push(n),c},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var r=this;this.task.then(function(){if(void 0!==r.observers&&void 0!==r.observers[e])try{t(r.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))},e}();t.async=o},function(e,t,r){"use strict";function n(e,t,r){var n="";switch(t){case 1:n=r?"first":"First";break;case 2:n=r?"second":"Second";break;case 3:n=r?"third":"Third";break;case 4:n=r?"fourth":"Fourth";break;default:throw Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var o=e+" failed: ";return o+=n+" argument "}function o(e,t,r,o){if((!o||r)&&"string"!=typeof r)throw Error(n(e,t,o)+"must be a valid firebase namespace.")}function i(e,t,r,o){if((!o||r)&&"function"!=typeof r)throw Error(n(e,t,o)+"must be a valid function.")}function a(e,t,r,o){if((!o||r)&&("object"!=typeof r||null===r))throw Error(n(e,t,o)+"must be a valid context object.")}Object.defineProperty(t,"__esModule",{value:!0}),t.validateArgCount=function(e,t,r,n){var o;if(n<t?o="at least "+t:n>r&&(o=0===r?"none":"no more than "+r),o){var i=e+" failed: Was called with "+n+(1===n?" argument.":" arguments.")+" Expects "+o+".";throw Error(i)}},t.errorPrefix=n,t.validateNamespace=o,t.validateCallback=i,t.validateContextObject=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(27);t.stringToByteArray=function(e){for(var t=[],r=0,o=0;o<e.length;o++){var i=e.charCodeAt(o);if(i>=55296&&i<=56319){var a=i-55296;o++,n.assert(o<e.length,"Surrogate pair missing trail surrogate."),i=65536+(a<<10)+(e.charCodeAt(o)-56320)}i<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=63&i|128):i<65536?(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=63&i|128):(t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=63&i|128)}return t},t.stringLength=function(e){for(var t=0,r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t++:n<2048?t+=2:n>=55296&&n<=56319?(t+=4,r++):t+=3}return t}}])}().default;

/*!
 * @license Firebase v4.6.0
 * Build: rev-f5e674c
 * Terms: https://firebase.google.com/terms/
 */
try{webpackJsonpFirebase([4],{75:function(t,e,n){n(76)},76:function(t,e,n){(function(t){var e=n(6).default;(function(){(function(){var t,n=n||{},i=this,r=function(t){return void 0!==t},o=function(t){return"string"==typeof t},a=function(t){return"boolean"==typeof t},s=function(){},u=function(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e},c=function(t){return null===t},h=function(t){return"array"==u(t)},l=function(t){var e=u(t);return"array"==e||"object"==e&&"number"==typeof t.length},f=function(t){return"function"==u(t)},d=function(t){var e=typeof t;return"object"==e&&null!=t||"function"==e},p=function(t,e,n){return t.call.apply(t.bind,arguments)},v=function(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}},m=function(t,e,n){return m=Function.prototype.bind&&-1!=(""+Function.prototype.bind).indexOf("native code")?p:v,m.apply(null,arguments)},g=function(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}},b=Date.now||function(){return+new Date},y=function(t,e){function n(){}n.prototype=e.prototype,t.Uc=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Og=function(t,n,i){for(var r=Array(arguments.length-2),o=2;o<arguments.length;o++)r[o-2]=arguments[o];return e.prototype[n].apply(t,r)}},w=function(t){if(Error.captureStackTrace)Error.captureStackTrace(this,w);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=t+"")};y(w,Error),w.prototype.name="CustomError";var I=function(t,e){for(var n=t.split("%s"),i="",r=Array.prototype.slice.call(arguments,1);r.length&&1<n.length;)i+=n.shift()+r.shift();return i+n.join("%s")},T=String.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},k=function(t){return R.test(t)?(-1!=t.indexOf("&")&&(t=t.replace(E,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(A,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(N,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(P,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(S,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(C,"&#0;")),t):t},E=/&/g,A=/</g,N=/>/g,P=/"/g,S=/'/g,C=/\x00/g,R=/[\x00&<>"']/,O=function(t,e){return-1!=t.indexOf(e)},D=function(t,e){return t<e?-1:t>e?1:0},_=function(t,e){e.unshift(t),w.call(this,I.apply(null,e)),e.shift()};y(_,w),_.prototype.name="AssertionError";var L=function(t,e,n,i){var r="Assertion failed";if(n){r+=": "+n;var o=i}else t&&(r+=": "+t,o=e);throw new _(""+r,o||[])},x=function(t,e,n){return t||L("",null,e,Array.prototype.slice.call(arguments,2)),t},U=function(t,e){throw new _("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))},V=function(t,e,n){return"number"==typeof t||L("Expected number but got %s: %s.",[u(t),t],e,Array.prototype.slice.call(arguments,2)),t},M=function(t,e,n){o(t)||L("Expected string but got %s: %s.",[u(t),t],e,Array.prototype.slice.call(arguments,2))},j=function(t,e,n){f(t)||L("Expected function but got %s: %s.",[u(t),t],e,Array.prototype.slice.call(arguments,2))},F=function(){this.Tc="",this.kf=K};F.prototype.qb=!0,F.prototype.ob=function(){return this.Tc},F.prototype.toString=function(){return"Const{"+this.Tc+"}"};var W=function(t){return t instanceof F&&t.constructor===F&&t.kf===K?t.Tc:(U("expected object of type Const, got '"+t+"'"),"type_error:Const")},K={},X=function(t){var e=new F;return e.Tc=t,e};X("");var q=function(){this.Lc="",this.lf=J};q.prototype.qb=!0,q.prototype.ob=function(){return this.Lc},q.prototype.toString=function(){return"TrustedResourceUrl{"+this.Lc+"}"};var H,B=function(t){return t instanceof q&&t.constructor===q&&t.lf===J?t.Lc:(U("expected object of type TrustedResourceUrl, got '"+t+"' of type "+u(t)),"type_error:TrustedResourceUrl")},G=function(t,e){var n=W(t);if(!z.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return t=n.replace(Y,function(t,i){if(!Object.prototype.hasOwnProperty.call(e,i))throw Error('Found marker, "'+i+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return t=e[i],t instanceof F?W(t):encodeURIComponent(t+"")}),$(t)},Y=/%{(\w+)}/g,z=/^(?:https:)?\/\/[0-9a-z.:[\]-]+\/|^\/[^\/\\]|^about:blank(#|$)/i,J={},$=function(t){var e=new q;return e.Lc=t,e},Z=Array.prototype.indexOf?function(t,e,n){return x(null!=t.length),Array.prototype.indexOf.call(t,e,n)}:function(t,e,n){if(n=null==n?0:0>n?Math.max(0,t.length+n):n,o(t))return o(e)&&1==e.length?t.indexOf(e,n):-1;for(;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Q=Array.prototype.forEach?function(t,e,n){x(null!=t.length),Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r=o(t)?t.split(""):t,a=0;a<i;a++)a in r&&e.call(n,r[a],a,t)},tt=function(t,e){for(var n=o(t)?t.split(""):t,i=t.length-1;0<=i;--i)i in n&&e.call(void 0,n[i],i,t)},et=Array.prototype.map?function(t,e,n){return x(null!=t.length),Array.prototype.map.call(t,e,n)}:function(t,e,n){for(var i=t.length,r=Array(i),a=o(t)?t.split(""):t,s=0;s<i;s++)s in a&&(r[s]=e.call(n,a[s],s,t));return r},nt=Array.prototype.some?function(t,e,n){return x(null!=t.length),Array.prototype.some.call(t,e,n)}:function(t,e,n){for(var i=t.length,r=o(t)?t.split(""):t,a=0;a<i;a++)if(a in r&&e.call(n,r[a],a,t))return!0;return!1},it=function(t){t:{for(var e=Ji,n=t.length,i=o(t)?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return 0>e?null:o(t)?t.charAt(e):t[e]},rt=function(t,e){return 0<=Z(t,e)},ot=function(t,e){e=Z(t,e);var n;return(n=0<=e)&&at(t,e),n},at=function(t,e){return x(null!=t.length),1==Array.prototype.splice.call(t,e,1).length},st=function(t,e){var n=0;tt(t,function(i,r){e.call(void 0,i,r,t)&&at(t,r)&&n++})},ut=function(t){return Array.prototype.concat.apply([],arguments)},ct=function(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]},ht=function(t){return et(t,function(t){return t=t.toString(16),1<t.length?t:"0"+t}).join("")};t:{var lt=i.navigator;if(lt){var ft=lt.userAgent;if(ft){H=ft;break t}}H=""}var dt=function(t){return O(H,t)},pt=function(t,e){for(var n in t)e.call(void 0,t[n],n,t)},vt=function(t,e){for(var n in t)if(e.call(void 0,t[n],n,t))return!0;return!1},mt=function(t){var e,n=[],i=0;for(e in t)n[i++]=t[e];return n},gt=function(t){var e,n=[],i=0;for(e in t)n[i++]=e;return n},bt=function(t){for(var e in t)return!1;return!0},yt=function(t,e){for(var n in t)if(!(n in e)||t[n]!==e[n])return!1;for(n in e)if(!(n in t))return!1;return!0},wt=function(t){var e,n={};for(e in t)n[e]=t[e];return n},It="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),Tt=function(t,e){for(var n,i,r=1;r<arguments.length;r++){i=arguments[r];for(n in i)t[n]=i[n];for(var o=0;o<It.length;o++)n=It[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}},kt=function(t){return kt[" "](t),t};kt[" "]=s;var Et,At=function(t,e){var n=Mt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)},Nt=dt("Opera"),Pt=dt("Trident")||dt("MSIE"),St=dt("Edge"),Ct=St||Pt,Rt=dt("Gecko")&&!(O(H.toLowerCase(),"webkit")&&!dt("Edge"))&&!(dt("Trident")||dt("MSIE"))&&!dt("Edge"),Ot=O(H.toLowerCase(),"webkit")&&!dt("Edge"),Dt=function(){var t=i.document;return t?t.documentMode:void 0};t:{var _t="",Lt=function(){var t=H;return Rt?/rv:([^\);]+)(\)|;)/.exec(t):St?/Edge\/([\d\.]+)/.exec(t):Pt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):Ot?/WebKit\/(\S+)/.exec(t):Nt?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(Lt&&(_t=Lt?Lt[1]:""),Pt){var xt=Dt();if(null!=xt&&xt>parseFloat(_t)){Et=xt+"";break t}}Et=_t}var Ut,Vt=Et,Mt={},jt=function(t){return At(t,function(){for(var e=0,n=T(Vt+"").split("."),i=T(t+"").split("."),r=Math.max(n.length,i.length),o=0;0==e&&o<r;o++){var a=n[o]||"",s=i[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=D(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||D(0==a[2].length,0==s[2].length)||D(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e})},Ft=i.document;Ut=Ft&&Pt?Dt()||("CSS1Compat"==Ft.compatMode?parseInt(Vt,10):5):void 0;var Wt,Kt=null,Xt=null,qt=function(t){var e="";return Ht(t,function(t){e+=String.fromCharCode(t)}),e},Ht=function(t,e){function n(e){for(;i<t.length;){var n=t.charAt(i++),r=Xt[n];if(null!=r)return r;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}Bt();for(var i=0;;){var r=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===r)break;e(r<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}},Bt=function(){if(!Kt){Kt={},Xt={};for(var t=0;65>t;t++)Kt[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t),Xt[Kt[t]]=t,62<=t&&(Xt["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(t)]=t)}},Gt=function(){this.Da=-1},Yt=function(t,e){this.Da=-1,this.Da=64,this.qc=i.Uint8Array?new Uint8Array(this.Da):Array(this.Da),this.Xc=this.rb=0,this.l=[],this.bg=t,this.Fe=e,this.Cg=i.Int32Array?new Int32Array(64):Array(64),r(Wt)||(Wt=i.Int32Array?new Int32Array(Qt):Qt),this.reset()};y(Yt,Gt);for(var zt=[],Jt=0;63>Jt;Jt++)zt[Jt]=0;var $t=ut(128,zt);Yt.prototype.reset=function(){this.Xc=this.rb=0,this.l=i.Int32Array?new Int32Array(this.Fe):ct(this.Fe)};var Zt=function(t){var e=t.qc;x(e.length==t.Da);for(var n=t.Cg,i=0,r=0;r<e.length;)n[i++]=e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3],r=4*i;for(e=16;64>e;e++){r=0|n[e-15],i=0|n[e-2];var o=(0|n[e-16])+((r>>>7|r<<25)^(r>>>18|r<<14)^r>>>3)|0,a=(0|n[e-7])+((i>>>17|i<<15)^(i>>>19|i<<13)^i>>>10)|0;n[e]=o+a|0}i=0|t.l[0],r=0|t.l[1];var s=0|t.l[2],u=0|t.l[3],c=0|t.l[4],h=0|t.l[5],l=0|t.l[6];for(o=0|t.l[7],e=0;64>e;e++){var f=((i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10))+(i&r^i&s^r&s)|0;a=c&h^~c&l,o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0,a=a+(0|Wt[e])|0,a=o+(a+(0|n[e])|0)|0,o=l,l=h,h=c,c=u+a|0,u=s,s=r,r=i,i=a+f|0}t.l[0]=t.l[0]+i|0,t.l[1]=t.l[1]+r|0,t.l[2]=t.l[2]+s|0,t.l[3]=t.l[3]+u|0,t.l[4]=t.l[4]+c|0,t.l[5]=t.l[5]+h|0,t.l[6]=t.l[6]+l|0,t.l[7]=t.l[7]+o|0};Yt.prototype.update=function(t,e){r(e)||(e=t.length);var n=0,i=this.rb;if(o(t))for(;n<e;)this.qc[i++]=t.charCodeAt(n++),i==this.Da&&(Zt(this),i=0);else{if(!l(t))throw Error("message must be string or array");for(;n<e;){var a=t[n++];if(!("number"==typeof a&&0<=a&&255>=a&&a==(0|a)))throw Error("message must be a byte array");this.qc[i++]=a,i==this.Da&&(Zt(this),i=0)}}this.rb=i,this.Xc+=e},Yt.prototype.digest=function(){var t=[],e=8*this.Xc;56>this.rb?this.update($t,56-this.rb):this.update($t,this.Da-(this.rb-56));for(var n=63;56<=n;n--)this.qc[n]=255&e,e/=256;for(Zt(this),n=e=0;n<this.bg;n++)for(var i=24;0<=i;i-=8)t[e++]=this.l[n]>>i&255;return t};var Qt=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],te=function(){Yt.call(this,8,ee)};y(te,Yt);var ee=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],ne=Object.freeze||function(t){return t},ie=function(){this.Ma=this.Ma,this.Ic=this.Ic};ie.prototype.Ma=!1,ie.prototype.isDisposed=function(){return this.Ma},ie.prototype.lb=function(){if(this.Ic)for(;this.Ic.length;)this.Ic.shift()()};var re=!Pt||9<=+Ut,oe=Pt&&!jt("9");!Ot||jt("528"),Rt&&jt("1.9b")||Pt&&jt("8")||Nt&&jt("9.5")||Ot&&jt("528"),Rt&&!jt("8")||Pt&&jt("9");var ae=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});return i.addEventListener("test",s,e),i.removeEventListener("test",s,e),t}(),se=function(t,e){this.type=t,this.currentTarget=this.target=e,this.defaultPrevented=this.Wa=!1,this.Ue=!0};se.prototype.stopPropagation=function(){this.Wa=!0},se.prototype.preventDefault=function(){this.defaultPrevented=!0,this.Ue=!1};var ue=function(t,e){se.call(this,t?t.type:""),this.relatedTarget=this.currentTarget=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0,this.key="",this.charCode=this.keyCode=0,this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.R=null,t&&this.init(t,e)};y(ue,se);var ce=ne({2:"touch",3:"pen",4:"mouse"});ue.prototype.init=function(t,e){var n=this.type=t.type,i=t.changedTouches?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.currentTarget=e,e=t.relatedTarget){if(Rt){t:{try{kt(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,null===i?(this.offsetX=Ot||void 0!==t.offsetX?t.offsetX:t.layerX,this.offsetY=Ot||void 0!==t.offsetY?t.offsetY:t.layerY,this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0):(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0),this.button=t.button,this.keyCode=t.keyCode||0,this.key=t.key||"",this.charCode=t.charCode||("keypress"==n?t.keyCode:0),this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=o(t.pointerType)?t.pointerType:ce[t.pointerType]||"",this.state=t.state,this.R=t,t.defaultPrevented&&this.preventDefault()},ue.prototype.stopPropagation=function(){ue.Uc.stopPropagation.call(this),this.R.stopPropagation?this.R.stopPropagation():this.R.cancelBubble=!0},ue.prototype.preventDefault=function(){ue.Uc.preventDefault.call(this);var t=this.R;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,oe)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}},ue.prototype.Hf=function(){return this.R};var he="closure_listenable_"+(1e6*Math.random()|0),le=0,fe=function(t,e,n,i,r){this.listener=t,this.Mc=null,this.src=e,this.type=n,this.capture=!!i,this.vc=r,this.key=++le,this.Bb=this.pc=!1},de=function(t){t.Bb=!0,t.listener=null,t.Mc=null,t.src=null,t.vc=null},pe=function(t){this.src=t,this.I={},this.jc=0};pe.prototype.add=function(t,e,n,i,r){var o=""+t;(t=this.I[o])||(t=this.I[o]=[],this.jc++);var a=me(t,e,i,r);return-1<a?(e=t[a],n||(e.pc=!1)):(e=new fe(e,this.src,o,!!i,r),e.pc=n,t.push(e)),e},pe.prototype.remove=function(t,e,n,i){if(!((t=""+t)in this.I))return!1;var r=this.I[t];return-1<(e=me(r,e,n,i))&&(de(r[e]),at(r,e),0==r.length&&(delete this.I[t],this.jc--),!0)};var ve=function(t,e){var n=e.type;n in t.I&&ot(t.I[n],e)&&(de(e),0==t.I[n].length&&(delete t.I[n],t.jc--))};pe.prototype.td=function(t,e,n,i){t=this.I[""+t];var r=-1;return t&&(r=me(t,e,n,i)),-1<r?t[r]:null},pe.prototype.hasListener=function(t,e){var n=r(t),i=n?""+t:"",o=r(e);return vt(this.I,function(t){for(var r=0;r<t.length;++r)if(!(n&&t[r].type!=i||o&&t[r].capture!=e))return!0;return!1})};var me=function(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.Bb&&o.listener==e&&o.capture==!!n&&o.vc==i)return r}return-1},ge="closure_lm_"+(1e6*Math.random()|0),be={},ye=0,we=function(t,e,n,i,r){if(i&&i.once)ke(t,e,n,i,r);else if(h(e))for(var o=0;o<e.length;o++)we(t,e[o],n,i,r);else n=De(n),t&&t[he]?t.listen(e,n,d(i)?!!i.capture:!!i,r):Ie(t,e,n,!1,i,r)},Ie=function(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var a=d(r)?!!r.capture:!!r,s=Re(t);if(s||(t[ge]=s=new pe(t)),n=s.add(e,n,i,a,o),!n.Mc){if(i=Te(),n.Mc=i,i.src=t,i.listener=n,t.addEventListener)ae||(r=a),void 0===r&&(r=!1),t.addEventListener(""+e,i,r);else{if(!t.attachEvent)throw Error("addEventListener and attachEvent are unavailable.");t.attachEvent(Ne(""+e),i)}ye++}},Te=function(){var t=Ce,e=re?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e},ke=function(t,e,n,i,r){if(h(e))for(var o=0;o<e.length;o++)ke(t,e[o],n,i,r);else n=De(n),t&&t[he]?Si(t,e,n,d(i)?!!i.capture:!!i,r):Ie(t,e,n,!0,i,r)},Ee=function(t,e,n,i,r){if(h(e))for(var o=0;o<e.length;o++)Ee(t,e[o],n,i,r);else i=d(i)?!!i.capture:!!i,n=De(n),t&&t[he]?t.ga.remove(e+"",n,i,r):t&&(t=Re(t))&&(e=t.td(e,n,i,r))&&Ae(e)},Ae=function(t){if("number"!=typeof t&&t&&!t.Bb){var e=t.src;if(e&&e[he])ve(e.ga,t);else{var n=t.type,i=t.Mc;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent&&e.detachEvent(Ne(n),i),ye--,(n=Re(e))?(ve(n,t),0==n.jc&&(n.src=null,e[ge]=null)):de(t)}}},Ne=function(t){return t in be?be[t]:be[t]="on"+t},Pe=function(t,e,n,i){var r=!0;if((t=Re(t))&&(e=t.I[""+e]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.Bb&&(o=Se(o,i),r=r&&!1!==o)}return r},Se=function(t,e){var n=t.listener,i=t.vc||t.src;return t.pc&&Ae(t),n.call(i,e)},Ce=function(t,e){if(t.Bb)return!0;if(!re){if(!e)t:{e=["window","event"];for(var n=i,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(r=e,e=new ue(r,this),n=!0,!(0>r.keyCode||void 0!=r.returnValue)){t:{var o=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){o=!0}(o||void 0==r.returnValue)&&(r.returnValue=!0)}for(r=[],o=e.currentTarget;o;o=o.parentNode)r.push(o);for(t=t.type,o=r.length-1;!e.Wa&&0<=o;o--){e.currentTarget=r[o];var a=Pe(r[o],t,!0,e);n=n&&a}for(o=0;!e.Wa&&o<r.length;o++)e.currentTarget=r[o],a=Pe(r[o],t,!1,e),n=n&&a}return n}return Se(t,new ue(e,this))},Re=function(t){return t=t[ge],t instanceof pe?t:null},Oe="__closure_events_fn_"+(1e9*Math.random()>>>0),De=function(t){return x(t,"Listener can not be null."),f(t)?t:(x(t.handleEvent,"An object listener must have handleEvent method."),t[Oe]||(t[Oe]=function(e){return t.handleEvent(e)}),t[Oe])},_e=/^[+a-zA-Z0-9_.!#$%&'*\/=?^`{|}~-]+@([a-zA-Z0-9-]+\.)+[a-zA-Z0-9]{2,63}$/,Le=function(){this.xa="",this.jf=Me};Le.prototype.qb=!0,Le.prototype.ob=function(){return this.xa},Le.prototype.toString=function(){return"SafeUrl{"+this.xa+"}"};var xe=function(t){return t instanceof Le&&t.constructor===Le&&t.jf===Me?t.xa:(U("expected object of type SafeUrl, got '"+t+"' of type "+u(t)),"type_error:SafeUrl")},Ue=/^(?:(?:https?|mailto|ftp):|[^:\/?#]*(?:[\/?#]|$))/i,Ve=function(t){return t instanceof Le?t:(t=t.qb?t.ob():t+"",Ue.test(t)||(t="about:invalid#zClosurez"),je(t))},Me={},je=function(t){var e=new Le;return e.xa=t,e};je("about:blank");var Fe=function(t){var e=[];return Ke(new We,t,e),e.join("")},We=function(){this.Nc=void 0},Ke=function(t,e,n){if(null==e)n.push("null");else{if("object"==typeof e){if(h(e)){var i=e;e=i.length,n.push("[");for(var r="",o=0;o<e;o++)n.push(r),r=i[o],Ke(t,t.Nc?t.Nc.call(i,o+"",r):r,n),r=",";return void n.push("]")}if(!(e instanceof String||e instanceof Number||e instanceof Boolean)){n.push("{"),o="";for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&"function"!=typeof(r=e[i])&&(n.push(o),He(i,n),n.push(":"),Ke(t,t.Nc?t.Nc.call(e,i,r):r,n),o=",");return void n.push("}")}e=e.valueOf()}switch(typeof e){case"string":He(e,n);break;case"number":n.push(isFinite(e)&&!isNaN(e)?e+"":"null");break;case"boolean":n.push(e+"");break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof e)}}},Xe={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},qe=/\uffff/.test("")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g,He=function(t,e){e.push('"',t.replace(qe,function(t){var e=Xe[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),Xe[t]=e),e}),'"')},Be=function(){};Be.prototype.je=null;var Ge,Ye=function(t){return t.je||(t.je=t.Cd())},ze=function(){};y(ze,Be),ze.prototype.rc=function(){var t=Je(this);return t?new ActiveXObject(t):new XMLHttpRequest},ze.prototype.Cd=function(){var t={};return Je(this)&&(t[0]=!0,t[1]=!0),t};var Je=function(t){if(!t.Ee&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<4;n++){var i=e[n];try{return new ActiveXObject(i),t.Ee=i}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.Ee};Ge=new ze;var $e=function(){};y($e,Be),$e.prototype.rc=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new Ze;throw Error("Unsupported browser")},$e.prototype.Cd=function(){return{}};var Ze=function(){this.oa=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseText="",this.status=-1,this.statusText=this.responseXML=null,this.oa.onload=m(this.Lf,this),this.oa.onerror=m(this.ze,this),this.oa.onprogress=m(this.Mf,this),this.oa.ontimeout=m(this.Nf,this)};t=Ze.prototype,t.open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.oa.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.oa.send(t)}else this.oa.send()},t.abort=function(){this.oa.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.oa.contentType:""},t.Lf=function(){this.status=200,this.responseText=this.oa.responseText,Qe(this,4)},t.ze=function(){this.status=500,this.responseText="",Qe(this,4)},t.Nf=function(){this.ze()},t.Mf=function(){this.status=200,Qe(this,1)};var Qe=function(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()};Ze.prototype.getAllResponseHeaders=function(){return"content-type: "+this.oa.contentType};var tn=function(t,e,n){this.Yf=n,this.wf=t,this.lg=e,this.Hc=0,this.wc=null};tn.prototype.get=function(){if(0<this.Hc){this.Hc--;var t=this.wc;this.wc=t.next,t.next=null}else t=this.wf();return t},tn.prototype.put=function(t){this.lg(t),this.Hc<this.Yf&&(this.Hc++,t.next=this.wc,this.wc=t)};var en,nn=function(t){i.setTimeout(function(){throw t},0)},rn=function(){var t=i.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!dt("Presto")&&(t=function(){var t=document.createElement("IFRAME");t.style.display="none",t.src="",document.documentElement.appendChild(t);var e=t.contentWindow;t=e.document,t.open(),t.write(""),t.close();var n="callImmediate"+Math.random(),i="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=m(function(t){"*"!=i&&t.origin!=i||t.data!=n||this.port1.onmessage()},this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,i)}}}),void 0!==t&&!dt("Trident")&&!dt("MSIE")){var e=new t,n={},o=n;return e.port1.onmessage=function(){if(r(n.next)){n=n.next;var t=n.me;n.me=null,t()}},function(t){o.next={me:t},o=o.next,e.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){i.setTimeout(t,0)}},on=function(){this.bd=this.hb=null},an=new tn(function(){return new sn},function(t){t.reset()},100);on.prototype.add=function(t,e){var n=an.get();n.set(t,e),this.bd?this.bd.next=n:(x(!this.hb),this.hb=n),this.bd=n},on.prototype.remove=function(){var t=null;return this.hb&&(t=this.hb,this.hb=this.hb.next,this.hb||(this.bd=null),t.next=null),t};var sn=function(){this.next=this.scope=this.rd=null};sn.prototype.set=function(t,e){this.rd=t,this.scope=e,this.next=null},sn.prototype.reset=function(){this.next=this.scope=this.rd=null};var un,cn=function(t,e){un||hn(),ln||(un(),ln=!0),fn.add(t,e)},hn=function(){if(-1!=(i.Promise+"").indexOf("[native code]")){var t=i.Promise.resolve(void 0);un=function(){t.then(dn)}}else un=function(){var t=dn;!f(i.setImmediate)||i.Window&&i.Window.prototype&&!dt("Edge")&&i.Window.prototype.setImmediate==i.setImmediate?(en||(en=rn()),en(t)):i.setImmediate(t)}},ln=!1,fn=new on,dn=function(){for(var t;t=fn.remove();){try{t.rd.call(t.scope)}catch(t){nn(t)}an.put(t)}ln=!1},pn=function(t,e){var n=(n=t&&t.ownerDocument)&&(n.defaultView||n.parentWindow)||i;void 0!==n[e]&&void 0!==n.Location&&void 0!==n.Element&&(n=t&&(t instanceof n[e]||!(t instanceof n.Location||t instanceof n.Element)),t=d(t)?t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t):void 0===t?"undefined":null===t?"null":typeof t,x(n,"Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,t))},vn=!Pt||9<=+Ut;!Rt&&!Pt||Pt&&9<=+Ut||Rt&&jt("1.9.1"),Pt&&jt("9");var mn=function(){this.xa="",this.hf=bn};mn.prototype.qb=!0,mn.prototype.ob=function(){return this.xa},mn.prototype.toString=function(){return"SafeHtml{"+this.xa+"}"};var gn=function(t){return t instanceof mn&&t.constructor===mn&&t.hf===bn?t.xa:(U("expected object of type SafeHtml, got '"+t+"' of type "+u(t)),"type_error:SafeHtml")},bn={};mn.prototype.Tf=function(t){return this.xa=t,this};var yn=function(t,e){pn(t,"HTMLScriptElement"),t.src=B(e)},wn=function(t){var e=document;return o(t)?e.getElementById(t):t},In=function(t,e){pt(e,function(e,n){e&&e.qb&&(e=e.ob()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:Tn.hasOwnProperty(n)?t.setAttribute(Tn[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e})},Tn={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"},kn=function(t,e,n){var i=arguments,r=document,a=i[0]+"",s=i[1];if(!vn&&s&&(s.name||s.type)){if(a=["<",a],s.name&&a.push(' name="',k(s.name),'"'),s.type){a.push(' type="',k(s.type),'"');var u={};Tt(u,s),delete u.type,s=u}a.push(">"),a=a.join("")}return a=r.createElement(a),s&&(o(s)?a.className=s:h(s)?a.className=s.join(" "):In(a,s)),2<i.length&&En(r,a,i),a},En=function(t,e,n){function i(n){n&&e.appendChild(o(n)?t.createTextNode(n):n)}for(var r=2;r<n.length;r++){var a=n[r];!l(a)||d(a)&&0<a.nodeType?i(a):Q(An(a)?ct(a):a,i)}},An=function(t){if(t&&"number"==typeof t.length){if(d(t))return"function"==typeof t.item||"string"==typeof t.item;if(f(t))return"function"==typeof t.item}return!1},Nn=function(t){t.prototype.then=t.prototype.then,t.prototype.$goog_Thenable=!0},Pn=function(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(t){return!1}},Sn=function(t,e){if(this.aa=0,this.za=void 0,this.kb=this.ua=this.w=null,this.uc=this.pd=!1,t!=s)try{var n=this;t.call(e,function(t){Wn(n,2,t)},function(t){if(!(t instanceof Jn))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}Wn(n,3,t)})}catch(t){Wn(this,3,t)}},Cn=function(){this.next=this.context=this.tb=this.Ua=this.child=null,this.Hb=!1};Cn.prototype.reset=function(){this.context=this.tb=this.Ua=this.child=null,this.Hb=!1};var Rn=new tn(function(){return new Cn},function(t){t.reset()},100),On=function(t,e,n){var i=Rn.get();return i.Ua=t,i.tb=e,i.context=n,i},Dn=function(t){if(t instanceof Sn)return t;var e=new Sn(s);return Wn(e,2,t),e},_n=function(t){return new Sn(function(e,n){n(t)})},Ln=function(t,e,n){Kn(t,e,n,null)||cn(g(e,t))},xn=function(t){return new Sn(function(e,n){var i=t.length,r=[];if(i)for(var o,a=function(t,n){i--,r[t]=n,0==i&&e(r)},s=function(t){n(t)},u=0;u<t.length;u++)o=t[u],Ln(o,g(a,u),s);else e(r)})},Un=function(t){return new Sn(function(e){var n=t.length,i=[];if(n)for(var r,o=function(t,r,o){n--,i[t]=r?{Gf:!0,value:o}:{Gf:!1,reason:o},0==n&&e(i)},a=0;a<t.length;a++)r=t[a],Ln(r,g(o,a,!0),g(o,a,!1));else e(i)})};Sn.prototype.then=function(t,e,n){return null!=t&&j(t,"opt_onFulfilled should be a function."),null!=e&&j(e,"opt_onRejected should be a function. Did you pass opt_context as the second argument instead of the third?"),Fn(this,f(t)?t:null,f(e)?e:null,n)},Nn(Sn);var Vn=function(t,e){return e=On(e,e,void 0),e.Hb=!0,jn(t,e),t};Sn.prototype.g=function(t,e){return Fn(this,null,t,e)},Sn.prototype.cancel=function(t){0==this.aa&&cn(function(){var e=new Jn(t);Mn(this,e)},this)};var Mn=function(t,e){if(0==t.aa)if(t.w){var n=t.w;if(n.ua){for(var i=0,r=null,o=null,a=n.ua;a&&(a.Hb||(i++,a.child==t&&(r=a),!(r&&1<i)));a=a.next)r||(o=a);r&&(0==n.aa&&1==i?Mn(n,e):(o?(i=o,x(n.ua),x(null!=i),i.next==n.kb&&(n.kb=i),i.next=i.next.next):Hn(n),Bn(n,r,3,e)))}t.w=null}else Wn(t,3,e)},jn=function(t,e){t.ua||2!=t.aa&&3!=t.aa||qn(t),x(null!=e.Ua),t.kb?t.kb.next=e:t.ua=e,t.kb=e},Fn=function(t,e,n,i){var o=On(null,null,null);return o.child=new Sn(function(t,a){o.Ua=e?function(n){try{var r=e.call(i,n);t(r)}catch(t){a(t)}}:t,o.tb=n?function(e){try{var o=n.call(i,e);!r(o)&&e instanceof Jn?a(e):t(o)}catch(t){a(t)}}:a}),o.child.w=t,jn(t,o),o.child};Sn.prototype.zg=function(t){x(1==this.aa),this.aa=0,Wn(this,2,t)},Sn.prototype.Ag=function(t){x(1==this.aa),this.aa=0,Wn(this,3,t)};var Wn=function(t,e,n){0==t.aa&&(t===n&&(e=3,n=new TypeError("Promise cannot resolve to itself")),t.aa=1,Kn(n,t.zg,t.Ag,t)||(t.za=n,t.aa=e,t.w=null,qn(t),3!=e||n instanceof Jn||Yn(t,n)))},Kn=function(t,e,n,i){if(t instanceof Sn)return null!=e&&j(e,"opt_onFulfilled should be a function."),null!=n&&j(n,"opt_onRejected should be a function. Did you pass opt_context as the second argument instead of the third?"),jn(t,On(e||s,n||null,i)),!0;if(Pn(t))return t.then(e,n,i),!0;if(d(t))try{var r=t.then;if(f(r))return Xn(t,r,e,n,i),!0}catch(t){return n.call(i,t),!0}return!1},Xn=function(t,e,n,i,r){var o=!1,a=function(t){o||(o=!0,n.call(r,t))},s=function(t){o||(o=!0,i.call(r,t))};try{e.call(t,a,s)}catch(t){s(t)}},qn=function(t){t.pd||(t.pd=!0,cn(t.Bf,t))},Hn=function(t){var e=null;return t.ua&&(e=t.ua,t.ua=e.next,e.next=null),t.ua||(t.kb=null),null!=e&&x(null!=e.Ua),e};Sn.prototype.Bf=function(){for(var t;t=Hn(this);)Bn(this,t,this.aa,this.za);this.pd=!1};var Bn=function(t,e,n,i){if(3==n&&e.tb&&!e.Hb)for(;t&&t.uc;t=t.w)t.uc=!1;if(e.child)e.child.w=null,Gn(e,n,i);else try{e.Hb?e.Ua.call(e.context):Gn(e,n,i)}catch(t){zn.call(null,t)}Rn.put(e)},Gn=function(t,e,n){2==e?t.Ua.call(t.context,n):t.tb&&t.tb.call(t.context,n)},Yn=function(t,e){t.uc=!0,cn(function(){t.uc&&zn.call(null,e)})},zn=nn,Jn=function(t){w.call(this,t)};y(Jn,w),Jn.prototype.name="cancel";var $n=function(t,e){this.Qc=[],this.Ne=t,this.re=e||null,this.Pb=this.nb=!1,this.za=void 0,this.be=this.he=this.fd=!1,this.Yc=0,this.w=null,this.gd=0};$n.prototype.cancel=function(t){if(this.nb)this.za instanceof $n&&this.za.cancel();else{if(this.w){var e=this.w;delete this.w,t?e.cancel(t):0>=--e.gd&&e.cancel()}this.Ne?this.Ne.call(this.re,this):this.be=!0,this.nb||ti(this,new si)}},$n.prototype.oe=function(t,e){this.fd=!1,Zn(this,t,e)};var Zn=function(t,e,n){t.nb=!0,t.za=n,t.Pb=!e,oi(t)},Qn=function(t){if(t.nb){if(!t.be)throw new ai;t.be=!1}};$n.prototype.callback=function(t){Qn(this),ei(t),Zn(this,!0,t)};var ti=function(t,e){Qn(t),ei(e),Zn(t,!1,e)},ei=function(t){x(!(t instanceof $n),"An execution sequence may not be initiated with a blocking Deferred.")},ni=function(t,e){ii(t,null,e,void 0)},ii=function(t,e,n,i){x(!t.he,"Blocking Deferreds can not be re-used"),t.Qc.push([e,n,i]),t.nb&&oi(t)};$n.prototype.then=function(t,e,n){var i,r,o=new Sn(function(t,e){i=t,r=e});return ii(this,i,function(t){t instanceof si?o.cancel():r(t)}),o.then(t,e,n)},Nn($n);var ri=function(t){return nt(t.Qc,function(t){return f(t[1])})},oi=function(t){if(t.Yc&&t.nb&&ri(t)){var e=t.Yc,n=ci[e];n&&(i.clearTimeout(n.Qb),delete ci[e]),t.Yc=0}t.w&&(t.w.gd--,delete t.w),e=t.za;for(var o=n=!1;t.Qc.length&&!t.fd;){var a=t.Qc.shift(),s=a[0],u=a[1];if(a=a[2],s=t.Pb?u:s)try{var c=s.call(a||t.re,e);r(c)&&(t.Pb=t.Pb&&(c==e||c instanceof Error),t.za=e=c),(Pn(e)||"function"==typeof i.Promise&&e instanceof i.Promise)&&(o=!0,t.fd=!0)}catch(i){e=i,t.Pb=!0,ri(t)||(n=!0)}}t.za=e,o&&(c=m(t.oe,t,!0),o=m(t.oe,t,!1),e instanceof $n?(ii(e,c,o),e.he=!0):e.then(c,o)),n&&(e=new ui(e),ci[e.Qb]=e,t.Yc=e.Qb)},ai=function(){w.call(this)};y(ai,w),ai.prototype.message="Deferred has already fired",ai.prototype.name="AlreadyCalledError";var si=function(){w.call(this)};y(si,w),si.prototype.message="Deferred was canceled",si.prototype.name="CanceledError";var ui=function(t){this.Qb=i.setTimeout(m(this.yg,this),0),this.ba=t};ui.prototype.yg=function(){throw x(ci[this.Qb],"Cannot throw an error that is not scheduled."),delete ci[this.Qb],this.ba};var ci={},hi=function(t){var e={},n=e.document||document,i=B(t),r=document.createElement("SCRIPT"),o={We:r,ic:void 0},a=new $n(fi,o),s=null,u=null!=e.timeout?e.timeout:5e3;return 0<u&&(s=window.setTimeout(function(){di(r,!0),ti(a,new pi(1,"Timeout reached for loading script "+i))},u),o.ic=s),r.onload=r.onreadystatechange=function(){r.readyState&&"loaded"!=r.readyState&&"complete"!=r.readyState||(di(r,e.Pg||!1,s),a.callback(null))},r.onerror=function(){di(r,!0,s),ti(a,new pi(0,"Error while loading script "+i))},o=e.attributes||{},Tt(o,{type:"text/javascript",charset:"UTF-8"}),In(r,o),yn(r,t),li(n).appendChild(r),a},li=function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement},fi=function(){if(this&&this.We){var t=this.We;t&&"SCRIPT"==t.tagName&&di(t,!0,this.ic)}},di=function(t,e,n){null!=n&&i.clearTimeout(n),t.onload=s,t.onerror=s,t.onreadystatechange=s,e&&window.setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},0)},pi=function(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),w.call(this,n),this.code=t};y(pi,w);var vi=function(t,e,n,i,r){this.reset(t,e,n,i,r)};vi.prototype.te=null;var mi=0;vi.prototype.reset=function(t,e,n,i,r){"number"==typeof r||mi++,i||b(),this.Vb=t,delete this.te},vi.prototype.Xe=function(t){this.Vb=t};var gi=function(t){this.Le=t,this.Ae=this.kd=this.Vb=this.w=null},bi=function(t,e){this.name=t,this.value=e};bi.prototype.toString=function(){return this.name};var yi=new bi("SEVERE",1e3),wi=new bi("INFO",800),Ii=new bi("CONFIG",700),Ti=new bi("FINE",500);gi.prototype.getName=function(){return this.Le},gi.prototype.getParent=function(){return this.w},gi.prototype.Xe=function(t){this.Vb=t};var ki=function(t){return t.Vb?t.Vb:t.w?ki(t.w):(U("Root logger has no level set."),null)};gi.prototype.log=function(t,e,n){if(t.value>=ki(this).value)for(f(e)&&(e=e()),t=new vi(t,e+"",this.Le),n&&(t.te=n),n=this;n;){var i=n,r=t;if(i.Ae)for(var o=0;e=i.Ae[o];o++)e(r);n=n.getParent()}},gi.prototype.info=function(t,e){this.log(wi,t,e)},gi.prototype.config=function(t,e){this.log(Ii,t,e)};var Ei={},Ai=null,Ni=function(t){Ai||(Ai=new gi(""),Ei[""]=Ai,Ai.Xe(Ii));var e;if(!(e=Ei[t])){e=new gi(t);var n=t.lastIndexOf("."),i=t.substr(n+1);n=Ni(t.substr(0,n)),n.kd||(n.kd={}),n.kd[i]=e,e.w=n,Ei[t]=e}return e},Pi=function(){ie.call(this),this.ga=new pe(this),this.nf=this,this.Kd=null};y(Pi,ie),Pi.prototype[he]=!0,t=Pi.prototype,t.addEventListener=function(t,e,n,i){we(this,t,e,n,i)},t.removeEventListener=function(t,e,n,i){Ee(this,t,e,n,i)},t.dispatchEvent=function(t){Ri(this);var e=this.Kd;if(e)for(var n=[],i=1;e;e=e.Kd)n.push(e),x(1e3>++i,"infinite loop");if(e=this.nf,i=t.type||t,o(t))t=new se(t,e);else if(t instanceof se)t.target=t.target||e;else{var r=t;t=new se(i,e),Tt(t,r)}if(r=!0,n)for(var a=n.length-1;!t.Wa&&0<=a;a--){var s=t.currentTarget=n[a];r=Ci(s,i,!0,t)&&r}if(t.Wa||(s=t.currentTarget=e,r=Ci(s,i,!0,t)&&r,t.Wa||(r=Ci(s,i,!1,t)&&r)),n)for(a=0;!t.Wa&&a<n.length;a++)s=t.currentTarget=n[a],r=Ci(s,i,!1,t)&&r;return r},t.lb=function(){if(Pi.Uc.lb.call(this),this.ga){var t,e=this.ga,n=0;for(t in e.I){for(var i=e.I[t],r=0;r<i.length;r++)++n,de(i[r]);delete e.I[t],e.jc--}}this.Kd=null},t.listen=function(t,e,n,i){return Ri(this),this.ga.add(t+"",e,!1,n,i)};var Si=function(t,e,n,i,r){t.ga.add(e+"",n,!0,i,r)},Ci=function(t,e,n,i){if(!(e=t.ga.I[e+""]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.Bb&&a.capture==n){var s=a.listener,u=a.vc||a.src;a.pc&&ve(t.ga,a),r=!1!==s.call(u,i)&&r}}return r&&0!=i.Ue};Pi.prototype.td=function(t,e,n,i){return this.ga.td(t+"",e,n,i)},Pi.prototype.hasListener=function(t,e){return this.ga.hasListener(r(t)?t+"":void 0,e)};var Ri=function(t){x(t.ga,"Event target is not initialized. Did you call the superclass (goog.events.EventTarget) constructor?")},Oi="StopIteration"in i?i.StopIteration:{message:"StopIteration",stack:""},Di=function(){};Di.prototype.next=function(){throw Oi},Di.prototype.mf=function(){return this};var _i=function(t,e){t&&t.log(Ti,e,void 0)},Li=function(t,e){this.ja={},this.C=[],this.gb=this.u=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else t&&this.addAll(t)};t=Li.prototype,t.ha=function(){xi(this);for(var t=[],e=0;e<this.C.length;e++)t.push(this.ja[this.C[e]]);return t},t.va=function(){return xi(this),this.C.concat()},t.Jb=function(t){return Ui(this.ja,t)},t.clear=function(){this.ja={},this.gb=this.u=this.C.length=0},t.remove=function(t){return!!Ui(this.ja,t)&&(delete this.ja[t],this.u--,this.gb++,this.C.length>2*this.u&&xi(this),!0)};var xi=function(t){if(t.u!=t.C.length){for(var e=0,n=0;e<t.C.length;){var i=t.C[e];Ui(t.ja,i)&&(t.C[n++]=i),e++}t.C.length=n}if(t.u!=t.C.length){var r={};for(n=e=0;e<t.C.length;)i=t.C[e],Ui(r,i)||(t.C[n++]=i,r[i]=1),e++;t.C.length=n}};t=Li.prototype,t.get=function(t,e){return Ui(this.ja,t)?this.ja[t]:e},t.set=function(t,e){Ui(this.ja,t)||(this.u++,this.C.push(t),this.gb++),this.ja[t]=e},t.addAll=function(t){if(t instanceof Li){var e=t.va();t=t.ha()}else e=gt(t),t=mt(t);for(var n=0;n<e.length;n++)this.set(e[n],t[n])},t.forEach=function(t,e){for(var n=this.va(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}},t.clone=function(){return new Li(this)},t.mf=function(t){xi(this);var e=0,n=this.gb,i=this,r=new Di;return r.next=function(){if(n!=i.gb)throw Error("The map has changed since the iterator was created");if(e>=i.C.length)throw Oi;var r=i.C[e++];return t?r:i.ja[r]},r};var Ui=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},Vi=function(t){if(t.ha&&"function"==typeof t.ha)return t.ha();if(o(t))return t.split("");if(l(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}return mt(t)},Mi=function(t){if(t.va&&"function"==typeof t.va)return t.va();if(!t.ha||"function"!=typeof t.ha){if(l(t)||o(t)){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}return gt(t)}},ji=function(t,e,n){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,n);else if(l(t)||o(t))Q(t,e,n);else for(var i=Mi(t),r=Vi(t),a=r.length,s=0;s<a;s++)e.call(n,r[s],i&&i[s],t)},Fi=function(t,e,n){if(f(t))n&&(t=m(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=m(t.handleEvent,t)}return 2147483647<+e?-1:i.setTimeout(t,e||0)},Wi=function(t){var e=null;return new Sn(function(n,i){-1==(e=Fi(function(){n(void 0)},t))&&i(Error("Failed to schedule timer."))}).g(function(t){throw i.clearTimeout(e),t})},Ki=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/,Xi=function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var o=t[n].substring(0,i);r=t[n].substring(i+1)}else o=t[n];e(o,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}},qi=function(t){Pi.call(this),this.headers=new Li,this.dd=t||null,this.Ca=!1,this.cd=this.b=null,this.Ub=this.Ke=this.Ec="",this.Qa=this.zd=this.zc=this.od=!1,this.Db=0,this.Vc=null,this.Oc="",this.Zc=this.hg=this.gf=!1};y(qi,Pi);var Hi=qi.prototype,Bi=Ni("goog.net.XhrIo");Hi.T=Bi;var Gi=/^https?$/i,Yi=["POST","PUT"];qi.prototype.send=function(t,e,n,r){if(this.b)throw Error("[goog.net.XhrIo] Object is active with another request="+this.Ec+"; newUri="+t);e=e?e.toUpperCase():"GET",this.Ec=t,this.Ub="",this.Ke=e,this.od=!1,this.Ca=!0,this.b=this.dd?this.dd.rc():Ge.rc(),this.cd=Ye(this.dd?this.dd:Ge),this.b.onreadystatechange=m(this.Re,this),this.hg&&"onprogress"in this.b&&(this.b.onprogress=m(function(t){this.Qe(t,!0)},this),this.b.upload&&(this.b.upload.onprogress=m(this.Qe,this)));try{_i(this.T,or(this,"Opening Xhr")),this.zd=!0,this.b.open(e,t+"",!0),this.zd=!1}catch(t){return _i(this.T,or(this,"Error opening Xhr: "+t.message)),void this.ba(5,t)}t=n||"";var o=this.headers.clone();r&&ji(r,function(t,e){o.set(e,t)}),r=it(o.va()),n=i.FormData&&t instanceof i.FormData,!rt(Yi,e)||r||n||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.b.setRequestHeader(e,t)},this),this.Oc&&(this.b.responseType=this.Oc),"withCredentials"in this.b&&this.b.withCredentials!==this.gf&&(this.b.withCredentials=this.gf);try{er(this),0<this.Db&&(this.Zc=zi(this.b),_i(this.T,or(this,"Will abort after "+this.Db+"ms if incomplete, xhr2 "+this.Zc)),this.Zc?(this.b.timeout=this.Db,this.b.ontimeout=m(this.ic,this)):this.Vc=Fi(this.ic,this.Db,this)),_i(this.T,or(this,"Sending request")),this.zc=!0,this.b.send(t),this.zc=!1}catch(t){_i(this.T,or(this,"Send error: "+t.message)),this.ba(5,t)}};var zi=function(t){return Pt&&jt(9)&&"number"==typeof t.timeout&&r(t.ontimeout)},Ji=function(t){return"content-type"==t.toLowerCase()};qi.prototype.ic=function(){void 0!==n&&this.b&&(this.Ub="Timed out after "+this.Db+"ms, aborting",_i(this.T,or(this,this.Ub)),this.dispatchEvent("timeout"),this.abort(8))},qi.prototype.ba=function(t,e){this.Ca=!1,this.b&&(this.Qa=!0,this.b.abort(),this.Qa=!1),this.Ub=e,$i(this),tr(this)};var $i=function(t){t.od||(t.od=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))};qi.prototype.abort=function(){this.b&&this.Ca&&(_i(this.T,or(this,"Aborting")),this.Ca=!1,this.Qa=!0,this.b.abort(),this.Qa=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),tr(this))},qi.prototype.lb=function(){this.b&&(this.Ca&&(this.Ca=!1,this.Qa=!0,this.b.abort(),this.Qa=!1),tr(this,!0)),qi.Uc.lb.call(this)},qi.prototype.Re=function(){this.isDisposed()||(this.zd||this.zc||this.Qa?Zi(this):this.dg())},qi.prototype.dg=function(){Zi(this)};var Zi=function(t){if(t.Ca&&void 0!==n)if(t.cd[1]&&4==nr(t)&&2==ir(t))_i(t.T,or(t,"Local request error detected and ignored"));else if(t.zc&&4==nr(t))Fi(t.Re,0,t);else if(t.dispatchEvent("readystatechange"),4==nr(t)){_i(t.T,or(t,"Request complete")),t.Ca=!1;try{var e=ir(t);t:switch(e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}var o;if(!(o=r)){var a;if(a=0===e){var s=(t.Ec+"").match(Ki)[1]||null;if(!s&&i.self&&i.self.location){var u=i.self.location.protocol;s=u.substr(0,u.length-1)}a=!Gi.test(s?s.toLowerCase():"")}o=a}if(o)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<nr(t)?t.b.statusText:""}catch(e){_i(t.T,"Can not get status: "+e.message),c=""}t.Ub=c+" ["+ir(t)+"]",$i(t)}}finally{tr(t)}}};qi.prototype.Qe=function(t,e){x("progress"===t.type,"goog.net.EventType.PROGRESS is of the same type as raw XHR progress."),this.dispatchEvent(Qi(t,"progress")),this.dispatchEvent(Qi(t,e?"downloadprogress":"uploadprogress"))};var Qi=function(t,e){return{type:e,lengthComputable:t.lengthComputable,loaded:t.loaded,total:t.total}},tr=function(t,e){if(t.b){er(t);var n=t.b,i=t.cd[0]?s:null;t.b=null,t.cd=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(e){(t=t.T)&&t.log(yi,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}},er=function(t){t.b&&t.Zc&&(t.b.ontimeout=null),t.Vc&&(i.clearTimeout(t.Vc),t.Vc=null)},nr=function(t){return t.b?t.b.readyState:0},ir=function(t){try{return 2<nr(t)?t.b.status:-1}catch(t){return-1}},rr=function(t){try{return t.b?t.b.responseText:""}catch(e){return _i(t.T,"Can not get responseText: "+e.message),""}};qi.prototype.getResponse=function(){try{if(!this.b)return null;if("response"in this.b)return this.b.response;switch(this.Oc){case"":case"text":return this.b.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.b)return this.b.mozResponseArrayBuffer}var t=this.T;return t&&t.log(yi,"Response type "+this.Oc+" is not supported on this browser",void 0),null}catch(t){return _i(this.T,"Can not get response: "+t.message),null}},qi.prototype.getResponseHeader=function(t){if(this.b&&4==nr(this))return t=this.b.getResponseHeader(t),null===t?void 0:t},qi.prototype.getAllResponseHeaders=function(){return this.b&&4==nr(this)?this.b.getAllResponseHeaders():""};var or=function(t,e){return e+" ["+t.Ke+" "+t.Ec+" "+ir(t)+"]"},ar=function(t,e){if(this.pa=this.eb=this.qa="",this.vb=null,this.Pa=this.Ga="",this.da=this.Xf=!1,t instanceof ar){this.da=r(e)?e:t.da,sr(this,t.qa);var n=t.eb;pr(this),this.eb=n,ur(this,t.pa),cr(this,t.vb),hr(this,t.Ga),lr(this,t.ea.clone()),t=t.Pa,pr(this),this.Pa=t}else t&&(n=(t+"").match(Ki))?(this.da=!!e,sr(this,n[1]||"",!0),t=n[2]||"",pr(this),this.eb=gr(t),ur(this,n[3]||"",!0),cr(this,n[4]),hr(this,n[5]||"",!0),lr(this,n[6]||"",!0),t=n[7]||"",pr(this),this.Pa=gr(t)):(this.da=!!e,this.ea=new Ar(null,0,this.da))};ar.prototype.toString=function(){var t=[],e=this.qa;e&&t.push(br(e,wr,!0),":");var n=this.pa;return(n||"file"==e)&&(t.push("//"),(e=this.eb)&&t.push(br(e,wr,!0),"@"),t.push(encodeURIComponent(n+"").replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.vb)&&t.push(":",n+"")),(n=this.Ga)&&(this.pa&&"/"!=n.charAt(0)&&t.push("/"),t.push(br(n,"/"==n.charAt(0)?Tr:Ir,!0))),(n=""+this.ea)&&t.push("?",n),(n=this.Pa)&&t.push("#",br(n,Er)),t.join("")},ar.prototype.resolve=function(t){var e=this.clone(),n=!!t.qa;if(n?sr(e,t.qa):n=!!t.eb,n){var i=t.eb;pr(e),e.eb=i}else n=!!t.pa;if(n?ur(e,t.pa):n=null!=t.vb,i=t.Ga,n)cr(e,t.vb);else if(n=!!t.Ga){if("/"!=i.charAt(0))if(this.pa&&!this.Ga)i="/"+i;else{var r=e.Ga.lastIndexOf("/");-1!=r&&(i=e.Ga.substr(0,r+1)+i)}if(".."==(r=i)||"."==r)i="";else if(O(r,"./")||O(r,"/.")){i=0==r.lastIndexOf("/",0),r=r.split("/");for(var o=[],a=0;a<r.length;){var s=r[a++];"."==s?i&&a==r.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),i&&a==r.length&&o.push("")):(o.push(s),i=!0)}i=o.join("/")}else i=r}return n?hr(e,i):n=""!=""+t.ea,n?lr(e,t.ea.clone()):n=!!t.Pa,n&&(t=t.Pa,pr(e),e.Pa=t),e},ar.prototype.clone=function(){return new ar(this)};var sr=function(t,e,n){pr(t),t.qa=n?gr(e,!0):e,t.qa&&(t.qa=t.qa.replace(/:$/,""))},ur=function(t,e,n){pr(t),t.pa=n?gr(e,!0):e},cr=function(t,e){if(pr(t),e){if(e=+e,isNaN(e)||0>e)throw Error("Bad port number "+e);t.vb=e}else t.vb=null},hr=function(t,e,n){pr(t),t.Ga=n?gr(e,!0):e},lr=function(t,e,n){pr(t),e instanceof Ar?(t.ea=e,t.ea.$d(t.da)):(n||(e=br(e,kr)),t.ea=new Ar(e,0,t.da))},fr=function(t,e,n){pr(t),t.ea.set(e,n)},dr=function(t,e){return t.ea.get(e)};ar.prototype.removeParameter=function(t){return pr(this),this.ea.remove(t),this};var pr=function(t){if(t.Xf)throw Error("Tried to modify a read-only Uri")};ar.prototype.$d=function(t){return this.da=t,this.ea&&this.ea.$d(t),this};var vr=function(t){return t instanceof ar?t.clone():new ar(t,void 0)},mr=function(t,e){var n=new ar(null,void 0);return sr(n,"https"),t&&ur(n,t),e&&hr(n,e),n},gr=function(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""},br=function(t,e,n){return o(t)?(t=encodeURI(t).replace(e,yr),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null},yr=function(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(15&t).toString(16)},wr=/[#\/\?@]/g,Ir=/[#\?:]/g,Tr=/[#\?]/g,kr=/[#\?@]/g,Er=/#/g,Ar=function(t,e,n){this.u=this.s=null,this.X=t||null,this.da=!!n},Nr=function(t){t.s||(t.s=new Li,t.u=0,t.X&&Xi(t.X,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))},Pr=function(t){var e=Mi(t);if(void 0===e)throw Error("Keys are undefined");var n=new Ar(null,0,void 0);t=Vi(t);for(var i=0;i<e.length;i++){var r=e[i],o=t[i];h(o)?Sr(n,r,o):n.add(r,o)}return n};t=Ar.prototype,t.add=function(t,e){Nr(this),this.X=null,t=this.ca(t);var n=this.s.get(t);return n||this.s.set(t,n=[]),n.push(e),this.u=V(this.u)+1,this},t.remove=function(t){return Nr(this),t=this.ca(t),!!this.s.Jb(t)&&(this.X=null,this.u=V(this.u)-this.s.get(t).length,this.s.remove(t))},t.clear=function(){this.s=this.X=null,this.u=0},t.Jb=function(t){return Nr(this),t=this.ca(t),this.s.Jb(t)},t.forEach=function(t,e){Nr(this),this.s.forEach(function(n,i){Q(n,function(n){t.call(e,n,i,this)},this)},this)},t.va=function(){Nr(this);for(var t=this.s.ha(),e=this.s.va(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},t.ha=function(t){Nr(this);var e=[];if(o(t))this.Jb(t)&&(e=ut(e,this.s.get(this.ca(t))));else{t=this.s.ha();for(var n=0;n<t.length;n++)e=ut(e,t[n])}return e},t.set=function(t,e){return Nr(this),this.X=null,t=this.ca(t),this.Jb(t)&&(this.u=V(this.u)-this.s.get(t).length),this.s.set(t,[e]),this.u=V(this.u)+1,this},t.get=function(t,e){return t=t?this.ha(t):[],0<t.length?t[0]+"":e};var Sr=function(t,e,n){t.remove(e),0<n.length&&(t.X=null,t.s.set(t.ca(e),ct(n)),t.u=V(t.u)+n.length)};t=Ar.prototype,t.toString=function(){if(this.X)return this.X;if(!this.s)return"";for(var t=[],e=this.s.va(),n=0;n<e.length;n++){var i=e[n],r=encodeURIComponent(i+"");i=this.ha(i);for(var o=0;o<i.length;o++){var a=r;""!==i[o]&&(a+="="+encodeURIComponent(i[o]+"")),t.push(a)}}return this.X=t.join("&")},t.clone=function(){var t=new Ar;return t.X=this.X,this.s&&(t.s=this.s.clone(),t.u=this.u),t},t.ca=function(t){return t+="",this.da&&(t=t.toLowerCase()),t},t.$d=function(t){t&&!this.da&&(Nr(this),this.X=null,this.s.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(this.remove(e),Sr(this,n,t))},this)),this.da=t},t.extend=function(t){for(var e=0;e<arguments.length;e++)ji(arguments[e],function(t,e){this.add(e,t)},this)};var Cr,Rr={Kg:{qd:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",Wd:"https://securetoken.googleapis.com/v1/token",id:"p"},Lg:{qd:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Wd:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},Mg:{qd:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",Wd:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}},Or=function(t){for(var e in Rr)if(Rr[e].id===t)return t=Rr[e],{firebaseEndpoint:t.qd,secureTokenEndpoint:t.Wd};return null};Cr=Or("__EID__")?"__EID__":void 0;var Dr=function(){var t=$r();return Pt&&!!Ut&&11==Ut||/Edge\/\d+/.test(t)},_r=function(){return i.window&&i.window.location.href||""},Lr=function(t,e){e=e||i.window;var n="about:blank";t&&(n=xe(Ve(t))),e.location.href=n},xr=function(t,e){var n,i=[];for(n in t)n in e?typeof t[n]!=typeof e[n]?i.push(n):h(t[n])?yt(t[n],e[n])||i.push(n):"object"==typeof t[n]&&null!=t[n]&&null!=e[n]?0<xr(t[n],e[n]).length&&i.push(n):t[n]!==e[n]&&i.push(n):i.push(n);for(n in e)n in t||i.push(n);return i},Ur=function(){var t=$r();return!((t="Chrome"!=Yr(t)?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t||Pt&&Ut&&!(9<Ut))},Vr=function(t){return t=(t||$r()).toLowerCase(),!!(t.match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))},Mr=function(t){t=t||i.window;try{t.close()}catch(t){}},jr=function(t,e,n){var i=""+Math.floor(1e9*Math.random());e=e||500,n=n||600;var r=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;e={width:e,height:n,top:0<r?r:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=$r().toLowerCase(),i&&(e.target=i,O(n,"crios/")&&(e.target="_blank")),"Firefox"==Yr($r())&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),i=window,e=n instanceof Le?n:Ve(void 0!==n.href?n.href:n+""),n=t.target||n.target,r=[];for(a in t)switch(a){case"width":case"height":case"top":case"left":r.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:r.push(a+"="+(t[a]?1:0))}var a=r.join(",");if((dt("iPhone")&&!dt("iPod")&&!dt("iPad")||dt("iPad")||dt("iPod"))&&i.navigator&&i.navigator.standalone&&n&&"_self"!=n?(a=i.document.createElement("A"),pn(a,"HTMLAnchorElement"),e instanceof Le||e instanceof Le||(e=e.qb?e.ob():e+"",x(Ue.test(e))||(e="about:invalid#zClosurez"),e=je(e)),a.href=xe(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),t=document.createEvent("MouseEvent"),t.initMouseEvent("click",!0,!0,i,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=i.open("",n,a),i=xe(e),a&&(Ct&&O(i,";")&&(i="'"+i.replace(/'/g,"%27")+"'"),a.opener=null,t=X("b/12014412, meta tag with sanitized URL"),i='<META HTTP-EQUIV="refresh" content="0; url='+k(i)+'">',M(W(t),"must provide justification"),x(!/^[\s\xa0]*$/.test(W(t)),"must provide non-empty justification"),a.document.write(gn((new mn).Tf(i))),a.document.close())):(a=i.open(xe(e),n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(t){}return a},Fr=function(t){return new Sn(function(e){var n=function(){Wi(2e3).then(function(){if(t&&!t.closed)return n();e()})};return n()})},Wr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Kr=function(){var t=null;return new Sn(function(e){"complete"==i.document.readyState?e():(t=function(){e()},ke(window,"load",t))}).g(function(e){throw Ee(window,"load",t),e})},Xr=function(){return qr(void 0)?Kr().then(function(){return new Sn(function(t,e){var n=i.document,r=setTimeout(function(){e(Error("Cordova framework is not ready."))},1e3);n.addEventListener("deviceready",function(){clearTimeout(r),t()},!1)})}):_n(Error("Cordova must run in an Android or iOS file scheme."))},qr=function(t){return t=t||$r(),!("file:"!==no()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))},Hr=function(){var t=i.window;try{return!(!t||t==t.top)}catch(t){return!1}},Br=function(){return e.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":e.INTERNAL.hasOwnProperty("node")?"Node":"Browser"},Gr=function(){var t=Br();return"ReactNative"===t||"Node"===t},Yr=function(t){var e=t.toLowerCase();return O(e,"opera/")||O(e,"opr/")||O(e,"opios/")?"Opera":O(e,"iemobile")?"IEMobile":O(e,"msie")||O(e,"trident/")?"IE":O(e,"edge/")?"Edge":O(e,"firefox/")?"Firefox":O(e,"silk/")?"Silk":O(e,"blackberry")?"Blackberry":O(e,"webos")?"Webos":!O(e,"safari/")||O(e,"chrome/")||O(e,"crios/")||O(e,"android")?!O(e,"chrome/")&&!O(e,"crios/")||O(e,"edge/")?O(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":"Chrome":"Safari"},zr={Fg:"FirebaseCore-web",Hg:"FirebaseUI-web"},Jr=function(t,e){e=e||[];var n,i=[],r={};for(n in zr)r[zr[n]]=!0;for(n=0;n<e.length;n++)void 0!==r[e[n]]&&(delete r[e[n]],i.push(e[n]));return i.sort(),e=i,e.length||(e=["FirebaseCore-web"]),i=Br(),("Browser"===i?Yr($r()):i)+"/JsCore/"+t+"/"+e.join(",")},$r=function(){return i.navigator&&i.navigator.userAgent||""},Zr=function(t,e){t=t.split("."),e=e||i;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e},Qr=function(){try{var t=i.localStorage,e=so();if(t)return t.setItem(e,"1"),t.removeItem(e),!Dr()||!!i.indexedDB}catch(t){}return!1},to=function(){return(eo()||"chrome-extension:"===no()||qr())&&!Gr()&&Qr()},eo=function(){return"http:"===no()||"https:"===no()},no=function(){return i.location&&i.location.protocol||null},io=function(t){return t=t||$r(),!Vr(t)&&"Firefox"!=Yr(t)},ro=function(t){return void 0===t?null:Fe(t)},oo=function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n},ao=function(t){if(null!==t)return JSON.parse(t)},so=function(t){return t||""+Math.floor(1e9*Math.random())},uo=function(t){return t=t||$r(),"Safari"!=Yr(t)&&!t.toLowerCase().match(/iphone|ipad|ipod/)},co=function(){var t=i.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null},ho=function(){var t=i.navigator;return!t||"boolean"!=typeof t.onLine||!eo()&&"chrome-extension:"!==no()&&void 0===t.connection||t.onLine},lo=function(t,e,n,i){if(t>e)throw Error("Short delay should be less than long delay!");this.ug=t,this.ag=e,t=n||$r(),i=i||Br(),this.Wf=Vr(t)||"ReactNative"===i};lo.prototype.get=function(){return this.Wf?this.ag:this.ug};var fo,po=function(){var t=i.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState},vo=function(){var t=i.document,e=null;return po()||!t?Dn():new Sn(function(n){e=function(){po()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)}).g(function(n){throw t.removeEventListener("visibilitychange",e,!1),n})},mo=function(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(t){}return null},go={};try{var bo={};Object.defineProperty(bo,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(bo,"abcd",{configurable:!0,enumerable:!0,value:2}),fo=2==bo.abcd}catch(t){fo=!1}var yo=function(t,e,n){fo?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n},wo=function(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&yo(t,n,e[n])},Io=function(t){var e={};return wo(e,t),e},To=function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n},ko=function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var i=t[e[n]];if(void 0===i||null===i||""===i)return!1}return!0},Eo=function(t){var e=t;if("object"==typeof t&&null!=t){e="length"in t?[]:{};for(var n in t)yo(e,n,Eo(t[n]))}return e},Ao="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),No=["client_id","response_type","scope","redirect_uri","state"],Po={Gg:{Dc:"locale",Zb:500,Yb:600,providerId:"facebook.com",Ud:No},Ig:{Dc:null,Zb:500,Yb:620,providerId:"github.com",Ud:No},Jg:{Dc:"hl",Zb:515,Yb:680,providerId:"google.com",Ud:No},Ng:{Dc:"lang",Zb:485,Yb:705,providerId:"twitter.com",Ud:Ao}},So=function(t){for(var e in Po)if(Po[e].providerId==t)return Po[e];return null},Co=function(t,e){this.code="auth/"+t,this.message=e||Oo[t]||""};y(Co,Error),Co.prototype.A=function(){return{code:this.code,message:this.message}},Co.prototype.toJSON=function(){return this.A()};var Ro=function(t){var e=t&&t.code;return e?new Co(e.substring(5),t.message):null},Oo={"argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"The user's credential is no longer valid. The user must sign in again.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","user-cancelled":"User did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},Do=function(t,e,n,i,r){if(this.ma=t,this.Y=e||null,this.Eb=n||null,this.Yd=i||null,this.ba=r||null,!this.Eb&&!this.ba)throw new Co("invalid-auth-event");if(this.Eb&&this.ba)throw new Co("invalid-auth-event");if(this.Eb&&!this.Yd)throw new Co("invalid-auth-event")};Do.prototype.tc=function(){return this.Yd},Do.prototype.getError=function(){return this.ba},Do.prototype.A=function(){return{type:this.ma,eventId:this.Y,urlResponse:this.Eb,sessionId:this.Yd,error:this.ba&&this.ba.A()}};var _o=function(t){return t=t||{},t.type?new Do(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&Ro(t.error)):null},Lo=function(t){var e="unauthorized-domain",n=void 0,i=vr(t);t=i.pa,i=i.qa,"chrome-extension"==i?n=I("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==i||"https"==i?n=I("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",Co.call(this,e,n)};y(Lo,Co);var xo=function(t){this.Zf=t.sub,b(),this.Mb=t.email||null,this.Rd=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null,this.qf=!!t.is_anonymous||"anonymous"==this.Rd};xo.prototype.getEmail=function(){return this.Mb},xo.prototype.isAnonymous=function(){return this.qf};var Uo=function(t){if(t=t.split("."),3!=t.length)return null;t=t[1];for(var e=(4-t.length%4)%4,n=0;n<e;n++)t+=".";try{var i=JSON.parse(qt(t));if(i.sub&&i.iss&&i.aud&&i.exp)return new xo(i)}catch(t){}return null},Vo=function(t,e){return t.then(function(t){if(t.idToken){var n=Uo(t.idToken);if(!n||e!=n.Zf)throw new Co("user-mismatch");return t}throw new Co("user-mismatch")}).g(function(t){throw t&&t.code&&"auth/user-not-found"==t.code?new Co("user-mismatch"):t})},Mo=function(t,e){if(e.idToken||e.accessToken)e.idToken&&yo(this,"idToken",e.idToken),e.accessToken&&yo(this,"accessToken",e.accessToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new Co("internal-error","failed to construct a credential");yo(this,"accessToken",e.oauthToken),yo(this,"secret",e.oauthTokenSecret)}yo(this,"providerId",t)};Mo.prototype.Ob=function(t){return Oa(t,jo(this))},Mo.prototype.Fc=function(t,e){var n=jo(this);return n.idToken=e,Da(t,n)},Mo.prototype.Gd=function(t,e){var n=jo(this);return Vo(_a(t,n),e)};var jo=function(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,{postBody:""+Pr(e),requestUri:"http://localhost"}};Mo.prototype.A=function(){var t={providerId:this.providerId};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),t};var Fo=function(t,e){this.kg=e||[],wo(this,{providerId:t,isOAuthProvider:!0}),this.qe={},this.Ed=(So(t)||{}).Dc||null,this.nd=null};Fo.prototype.setCustomParameters=function(t){return this.qe=wt(t),this};var Wo=function(t){Fo.call(this,t,No),this.Vd=[]};y(Wo,Fo),Wo.prototype.addScope=function(t){return rt(this.Vd,t)||this.Vd.push(t),this},Wo.prototype.ye=function(){return ct(this.Vd)},Wo.prototype.credential=function(t,e){if(!t&&!e)throw new Co("argument-error","credential failed: must provide the ID token and/or the access token.");return new Mo(this.providerId,{idToken:t||null,accessToken:e||null})};var Ko=function(){Wo.call(this,"facebook.com")};y(Ko,Wo),yo(Ko,"PROVIDER_ID","facebook.com");var Xo=function(t){if(!t)throw new Co("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return d(t)&&(e=t.accessToken),(new Ko).credential(null,e)},qo=function(){Wo.call(this,"github.com")};y(qo,Wo),yo(qo,"PROVIDER_ID","github.com");var Ho=function(t){if(!t)throw new Co("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return d(t)&&(e=t.accessToken),(new qo).credential(null,e)},Bo=function(){Wo.call(this,"google.com"),this.addScope("profile")};y(Bo,Wo),yo(Bo,"PROVIDER_ID","google.com");var Go=function(t,e){var n=t;return d(t)&&(n=t.idToken,e=t.accessToken),(new Bo).credential(n,e)},Yo=function(){Fo.call(this,"twitter.com",Ao)};y(Yo,Fo),yo(Yo,"PROVIDER_ID","twitter.com");var zo=function(t,e){var n=t;if(d(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new Co("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new Mo("twitter.com",n)},Jo=function(t,e){this.Mb=t,this.Ld=e,yo(this,"providerId","password")};Jo.prototype.Ob=function(t){return os(t,es,{email:this.Mb,password:this.Ld})},Jo.prototype.Fc=function(t,e){return os(t,za,{idToken:e,email:this.Mb,password:this.Ld})},Jo.prototype.Gd=function(t,e){return Vo(this.Ob(t),e)},Jo.prototype.A=function(){return{email:this.Mb,password:this.Ld}};var $o=function(){wo(this,{providerId:"password",isOAuthProvider:!1})};wo($o,{PROVIDER_ID:"password"});var Zo=function(t){if(!(t.verificationId&&t.$c||t.hc&&t.phoneNumber))throw new Co("internal-error");this.U=t,yo(this,"providerId","phone")};Zo.prototype.Ob=function(t){return t.verifyPhoneNumber(Qo(this))},Zo.prototype.Fc=function(t,e){var n=Qo(this);return n.idToken=e,os(t,is,n)},Zo.prototype.Gd=function(t,e){var n=Qo(this);return n.operation="REAUTH",t=os(t,rs,n),Vo(t,e)},Zo.prototype.A=function(){var t={providerId:"phone"};return this.U.verificationId&&(t.verificationId=this.U.verificationId),this.U.$c&&(t.verificationCode=this.U.$c),this.U.hc&&(t.temporaryProof=this.U.hc),this.U.phoneNumber&&(t.phoneNumber=this.U.phoneNumber),t};var Qo=function(t){return t.U.hc&&t.U.phoneNumber?{temporaryProof:t.U.hc,phoneNumber:t.U.phoneNumber}:{sessionInfo:t.U.verificationId,code:t.U.$c}},ta=function(t){try{this.tf=t||e.auth()}catch(t){throw new Co("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}wo(this,{providerId:"phone",isOAuthProvider:!1})};ta.prototype.verifyPhoneNumber=function(t,e){var n=this.tf.f;return Dn(e.verify()).then(function(i){if(!o(i))throw new Co("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":return os(n,Ga,{phoneNumber:t,recaptchaToken:i});default:throw new Co("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}})};var ea=function(t,e){if(!t)throw new Co("missing-verification-id");if(!e)throw new Co("missing-verification-code");return new Zo({verificationId:t,$c:e})};wo(ta,{PROVIDER_ID:"phone"});var na=function(t){if(t.temporaryProof&&t.phoneNumber)return new Zo({hc:t.temporaryProof,phoneNumber:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,i=t&&t.oauthTokenSecret;t=t&&t.oauthIdToken;try{switch(e){case"google.com":return Go(t,n);case"facebook.com":return Xo(n);case"github.com":return Ho(n);case"twitter.com":return zo(n,i);default:return new Wo(e).credential(t,n)}}catch(t){return null}},ia=function(t){if(!t.isOAuthProvider)throw new Co("invalid-oauth-provider")},ra=function(t,e,n){Co.call(this,t,n),t=e||{},t.email&&yo(this,"email",t.email),t.phoneNumber&&yo(this,"phoneNumber",t.phoneNumber),t.credential&&yo(this,"credential",t.credential)};y(ra,Co),ra.prototype.A=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber);var e=this.credential&&this.credential.A();return e&&Tt(t,e),t},ra.prototype.toJSON=function(){return this.A()};var oa=function(t){if(t.code){var e=t.code||"";0==e.indexOf("auth/")&&(e=e.substring(5));var n={credential:na(t)};if(t.email)n.email=t.email;else{if(!t.phoneNumber)return new Co(e,t.message||void 0);n.phoneNumber=t.phoneNumber}return new ra(e,n,t.message)}return null},aa=function(t){this.Eg=t};y(aa,Be),aa.prototype.rc=function(){return new this.Eg},aa.prototype.Cd=function(){return{}};var sa,ua=function(t,n,r){var o="Node"==Br();if(!(o=i.XMLHttpRequest||o&&e.INTERNAL.node&&e.INTERNAL.node.XMLHttpRequest))throw new Co("internal-error","The XMLHttpRequest compatibility library was not found.");this.m=t,t=n||{},this.qg=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.rg=t.secureTokenTimeout||ca,this.Pc=wt(t.secureTokenHeaders||ha),this.Df=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.Ef=t.firebaseTimeout||la,this.mb=wt(t.firebaseHeaders||fa),r&&(this.mb["X-Client-Version"]=r,this.Pc["X-Client-Version"]=r),this.vf=new $e,this.Dg=new aa(o)},ca=new lo(3e4,6e4),ha={"Content-Type":"application/x-www-form-urlencoded"},la=new lo(3e4,6e4),fa={"Content-Type":"application/json"},da=function(t,e){e?t.mb["X-Firebase-Locale"]=e:delete t.mb["X-Firebase-Locale"]},pa=function(t,e){e?(t.mb["X-Client-Version"]=e,t.Pc["X-Client-Version"]=e):(delete t.mb["X-Client-Version"],delete t.Pc["X-Client-Version"])},va=function(t,e,n,i,r,o,a){ho()?(Ur()?t=m(t.tg,t):(sa||(sa=new Sn(function(t,e){ba(t,e)})),t=m(t.sg,t)),t(e,n,i,r,o,a)):n&&n(null)};ua.prototype.tg=function(t,e,n,i,r,o){var a="Node"==Br(),s=Gr()?a?new qi(this.Dg):new qi:new qi(this.vf);if(o){s.Db=Math.max(0,o);var u=setTimeout(function(){s.dispatchEvent("timeout")},o)}s.listen("complete",function(){u&&clearTimeout(u);var t=null;try{t=JSON.parse(rr(this))||null}catch(e){t=null}e&&e(t)}),Si(s,"ready",function(){u&&clearTimeout(u),this.Ma||(this.Ma=!0,this.lb())}),Si(s,"timeout",function(){u&&clearTimeout(u),this.Ma||(this.Ma=!0,this.lb()),e&&e(null)}),s.send(t,n,i,r)};var ma=X("https://apis.google.com/js/client.js?onload=%{onload}"),ga="__fcb"+Math.floor(1e6*Math.random()),ba=function(t,e){if(((window.gapi||{}).client||{}).request)t();else{i[ga]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))};var n=G(ma,{onload:ga});ni(hi(n),function(){e(Error("CORS_UNSUPPORTED"))})}};ua.prototype.sg=function(t,e,n,i,r){var o=this;sa.then(function(){window.gapi.client.setApiKey(o.m);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:i,headers:r,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})}).g(function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})})};var ya=function(t,e){return new Sn(function(n,i){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?va(t,t.qg+"?key="+encodeURIComponent(t.m),function(t){t?t.error?i(as(t)):t.access_token&&t.refresh_token?n(t):i(new Co("internal-error")):i(new Co("network-request-failed"))},"POST",""+Pr(e),t.Pc,t.rg.get()):i(new Co("internal-error"))})},wa=function(t,e,n,i,r,o){var a=vr(t.Df+e);fr(a,"key",t.m),o&&fr(a,"cb",""+b());var s="GET"==n;if(s)for(var u in i)i.hasOwnProperty(u)&&fr(a,u,i[u]);return new Sn(function(e,o){va(t,""+a,function(t){t?t.error?o(as(t,r||{})):e(t):o(new Co("network-request-failed"))},n,s?void 0:Fe(oo(i)),t.mb,t.Ef.get())})},Ia=function(t){if(!_e.test(t.email))throw new Co("invalid-email")},Ta=function(t){"email"in t&&Ia(t)},ka=function(t,e){return os(t,Ma,{identifier:e,continueUri:eo()?_r():"http://localhost"}).then(function(t){return t.allProviders||[]})},Ea=function(t){return os(t,qa,{}).then(function(t){return t.authorizedDomains||[]})},Aa=function(t){if(!t.idToken)throw new Co("internal-error")},Na=function(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new Co("internal-error")}else{if(!t.sessionInfo)throw new Co("missing-verification-id");if(!t.code)throw new Co("missing-verification-code")}};ua.prototype.signInAnonymously=function(){return os(this,Ja,{})},ua.prototype.updateEmail=function(t,e){return os(this,Ya,{idToken:t,email:e})},ua.prototype.updatePassword=function(t,e){return os(this,za,{idToken:t,password:e})};var Pa={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};ua.prototype.updateProfile=function(t,e){var n={idToken:t},i=[];return pt(Pa,function(t,r){var o=e[r];null===o?i.push(t):r in e&&(n[r]=o)}),i.length&&(n.deleteAttribute=i),os(this,Ya,n)},ua.prototype.sendPasswordResetEmail=function(t,e){return t={requestType:"PASSWORD_RESET",email:t},Tt(t,e),os(this,Xa,t)},ua.prototype.sendEmailVerification=function(t,e){return t={requestType:"VERIFY_EMAIL",idToken:t},Tt(t,e),os(this,Ka,t)},ua.prototype.verifyPhoneNumber=function(t){return os(this,ns,t)};var Sa=function(t,e,n){return os(t,Fa,{idToken:e,deleteProvider:n})},Ca=function(t){if(!t.requestUri||!t.sessionId&&!t.postBody)throw new Co("internal-error")},Ra=function(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=oa(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=oa(t)):"EMAIL_EXISTS"==t.errorMessage&&(t.code="email-already-in-use",e=oa(t)),e)throw e;if(!t.idToken)throw new Co("internal-error")},Oa=function(t,e){return e.returnIdpCredential=!0,os(t,$a,e)},Da=function(t,e){return e.returnIdpCredential=!0,os(t,Qa,e)},_a=function(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,os(t,Za,e)},La=function(t){if(!t.oobCode)throw new Co("invalid-action-code")};ua.prototype.confirmPasswordReset=function(t,e){return os(this,Ba,{oobCode:t,newPassword:e})},ua.prototype.checkActionCode=function(t){return os(this,Ua,{oobCode:t})},ua.prototype.applyActionCode=function(t){return os(this,xa,{oobCode:t})};var xa={endpoint:"setAccountInfo",F:La,cb:"email"},Ua={endpoint:"resetPassword",F:La,$:function(t){if(!t.email||!t.requestType)throw new Co("internal-error")}},Va={endpoint:"signupNewUser",F:function(t){if(Ia(t),!t.password)throw new Co("weak-password")},$:Aa,Aa:!0},Ma={endpoint:"createAuthUri"},ja={endpoint:"deleteAccount",ab:["idToken"]},Fa={endpoint:"setAccountInfo",ab:["idToken","deleteProvider"],F:function(t){if(!h(t.deleteProvider))throw new Co("internal-error")}},Wa={endpoint:"getAccountInfo"},Ka={endpoint:"getOobConfirmationCode",ab:["idToken","requestType"],F:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new Co("internal-error")},cb:"email"},Xa={endpoint:"getOobConfirmationCode",ab:["requestType"],F:function(t){if("PASSWORD_RESET"!=t.requestType)throw new Co("internal-error");Ia(t)},cb:"email"},qa={ie:!0,endpoint:"getProjectConfig",De:"GET"},Ha={ie:!0,endpoint:"getRecaptchaParam",De:"GET",$:function(t){if(!t.recaptchaSiteKey)throw new Co("internal-error")}},Ba={endpoint:"resetPassword",F:La,cb:"email"},Ga={endpoint:"sendVerificationCode",ab:["phoneNumber","recaptchaToken"],cb:"sessionInfo"},Ya={endpoint:"setAccountInfo",ab:["idToken"],F:Ta,Aa:!0},za={endpoint:"setAccountInfo",ab:["idToken"],F:function(t){if(Ta(t),!t.password)throw new Co("weak-password")},$:Aa,Aa:!0},Ja={endpoint:"signupNewUser",$:Aa,Aa:!0},$a={endpoint:"verifyAssertion",F:Ca,$:Ra,Aa:!0},Za={endpoint:"verifyAssertion",F:Ca,$:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new Co("user-not-found");if(!t.idToken)throw new Co("internal-error")},Aa:!0},Qa={endpoint:"verifyAssertion",F:function(t){if(Ca(t),!t.idToken)throw new Co("internal-error")},$:Ra,Aa:!0},ts={endpoint:"verifyCustomToken",F:function(t){if(!t.token)throw new Co("invalid-custom-token")},$:Aa,Aa:!0},es={endpoint:"verifyPassword",F:function(t){if(Ia(t),!t.password)throw new Co("wrong-password")},$:Aa,Aa:!0},ns={endpoint:"verifyPhoneNumber",F:Na,$:Aa},is={endpoint:"verifyPhoneNumber",F:function(t){if(!t.idToken)throw new Co("internal-error");Na(t)},$:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",oa(t);Aa(t)}},rs={yf:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",F:Na,$:Aa},os=function(t,e,n){if(!ko(n,e.ab))return _n(new Co("internal-error"));var i,r=e.De||"POST";return Dn(n).then(e.F).then(function(){return e.Aa&&(n.returnSecureToken=!0),wa(t,e.endpoint,r,n,e.yf,e.ie||!1)}).then(function(t){return i=t}).then(e.$).then(function(){if(!e.cb)return i;if(!(e.cb in i))throw new Co("internal-error");return i[e.cb]})},as=function(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",i={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=i[n]?new Co(i[n]):null)return n;n=t.error&&t.error.message||"",i={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id"},Tt(i,e||{}),e=(e=n.match(/^[^\s]+\s*:\s*(.*)$/))&&1<e.length?e[1]:void 0;for(var r in i)if(0===n.indexOf(r))return new Co(i[r],e);return!e&&t&&(e=ro(t)),new Co("internal-error",e)},ss=function(t){this.Bg=t,this.yc=null,this.Id=us(this)},us=function(t){return ps().then(function(){return new Sn(function(e,n){Zr("gapi.iframes.getContext")().open({where:document.body,url:t.Bg,messageHandlersFilter:Zr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(i){t.yc=i,t.yc.restyle({setHideOnLeave:!1});var r=setTimeout(function(){n(Error("Network Error"))},fs.get()),o=function(){clearTimeout(r),e()};i.ping(o).then(o,function(){n(Error("Network Error"))})})})})};ss.prototype.sendMessage=function(t){var e=this;return this.Id.then(function(){return new Sn(function(n){e.yc.send(t.type,t,n,Zr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})};var cs=function(t,e){t.Id.then(function(){t.yc.register("authEvent",e,Zr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})},hs=X("https://apis.google.com/js/api.js?onload=%{onload}"),ls=new lo(3e4,6e4),fs=new lo(5e3,15e3),ds=null,ps=function(){return ds||(ds=new Sn(function(t,e){if(ho()){var n=function(){co(),Zr("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){co(),e(Error("Network Error"))},timeout:ls.get()})};if(Zr("gapi.iframes.Iframe"))t();else if(Zr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random());i[r]=function(){Zr("gapi.load")?n():e(Error("Network Error"))},r=G(hs,{onload:r}),Dn(hi(r)).g(function(){e(Error("Network Error"))})}}else e(Error("Network Error"))}).g(function(t){throw ds=null,t}))},vs=function(t,e,n){this.B=t,this.m=e,this.o=n,this.fb=null,this.Ba=mr(this.B,"/__/auth/iframe"),fr(this.Ba,"apiKey",this.m),fr(this.Ba,"appName",this.o),this.P=null,this.M=[]};vs.prototype.ae=function(t){return this.fb=t,this},vs.prototype.Zd=function(t){return this.P=t,this},vs.prototype.toString=function(){return this.fb?fr(this.Ba,"v",this.fb):this.Ba.removeParameter("v"),this.P?fr(this.Ba,"eid",this.P):this.Ba.removeParameter("eid"),this.M.length?fr(this.Ba,"fw",this.M.join(",")):this.Ba.removeParameter("fw"),""+this.Ba};var ms=function(t,e,n,i,r){this.B=t,this.m=e,this.o=n,this.sf=i,this.fb=this.Y=this.Td=null,this.xb=r,this.P=null};ms.prototype.ae=function(t){return this.fb=t,this},ms.prototype.Zd=function(t){return this.P=t,this},ms.prototype.toString=function(){var t=mr(this.B,"/__/auth/handler");if(fr(t,"apiKey",this.m),fr(t,"appName",this.o),fr(t,"authType",this.sf),this.xb.isOAuthProvider){var n=this.xb;try{var i=e.app(this.o).auth().ia}catch(t){i=null}n.nd=i,fr(t,"providerId",this.xb.providerId),n=this.xb,i=oo(n.qe);for(var r in i)i[r]=""+i[r];r=n.kg,i=wt(i);for(var o=0;o<r.length;o++){var a=r[o];a in i&&delete i[a]}n.Ed&&n.nd&&!i[n.Ed]&&(i[n.Ed]=n.nd),bt(i)||fr(t,"customParameters",ro(i))}if("function"==typeof this.xb.ye&&(n=this.xb.ye(),n.length&&fr(t,"scopes",n.join(","))),this.Td?fr(t,"redirectUrl",this.Td):t.removeParameter("redirectUrl"),this.Y?fr(t,"eventId",this.Y):t.removeParameter("eventId"),this.fb?fr(t,"v",this.fb):t.removeParameter("v"),this.mc)for(var s in this.mc)this.mc.hasOwnProperty(s)&&!dr(t,s)&&fr(t,s,this.mc[s]);return this.P?fr(t,"eid",this.P):t.removeParameter("eid"),s=gs(this.o),s.length&&fr(t,"fw",s.join(",")),""+t};var gs=function(t){try{return ct(e.app(t).auth().M)}catch(t){return[]}},bs=function(t,e,n,i,r){this.B=t,this.m=e,this.o=n,this.La=i||null,this.P=r||null,this.f=this.yd=this.we=null,this.ta=[],this.Ac=this.wa=null},ys=function(t){var e=_r();return Ea(t).then(function(t){t:{var n=vr(e),i=n.qa;n=n.pa;for(var r=0;r<t.length;r++){var o=t[r],a=n,s=i;if(0==o.indexOf("chrome-extension://")?a=vr(o).pa==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:Wr.test(o)?a=a==o:(o=o.split(".").join("\\."),a=RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new Lo(_r())})};t=bs.prototype,t.Sb=function(){if(this.Ac)return this.Ac;var t=this;return this.Ac=Kr().then(function(){if(!t.yd){var e=t.La,n=t.P,i=gs(t.o);e=new vs(t.B,t.m,t.o).ae(e).Zd(n),e.M=ct(i||[]),t.yd=""+e}t.xc=new ss(t.yd),Ts(t)})},t.ec=function(t,e,n){var i=new Co("popup-closed-by-user"),r=new Co("web-storage-unsupported"),o=this,a=!1;return this.Ra().then(function(){ks(o).then(function(n){n||(t&&Mr(t),e(r),a=!0)})}).g(function(){}).then(function(){if(!a)return Fr(t)}).then(function(){if(!a)return Wi(n).then(function(){e(i)})})},t.Ye=function(){var t=$r();return!io(t)&&!uo(t)},t.Be=function(){return!1},t.$b=function(t,e,n,i,r,o,a){if(!t)return _n(new Co("popup-blocked"));if(a&&!io())return this.Ra().g(function(e){Mr(t),r(e)}),i(),Dn();this.wa||(this.wa=ys(ws(this)));var s=this;return this.wa.then(function(){var e=s.Ra().g(function(e){throw Mr(t),r(e),e});return i(),e}).then(function(){if(ia(n),!a){var i=Is(s.B,s.m,s.o,e,n,null,o,s.La,void 0,s.P);Lr(i,t)}}).g(function(t){throw"auth/network-request-failed"==t.code&&(s.wa=null),t})};var ws=function(t){return t.f||(t.we=t.La?Jr(t.La,gs(t.o)):null,t.f=new ua(t.m,Or(t.P),t.we)),t.f};bs.prototype.ac=function(t,e,n){this.wa||(this.wa=ys(ws(this)));var i=this;return this.wa.then(function(){ia(e);var r=Is(i.B,i.m,i.o,t,e,_r(),n,i.La,void 0,i.P);Lr(r)}).g(function(t){throw"auth/network-request-failed"==t.code&&(i.wa=null),t})},bs.prototype.Ra=function(){var t=this;return this.Sb().then(function(){return t.xc.Id}).g(function(){throw t.wa=null,new Co("network-request-failed")})},bs.prototype.bf=function(){return!0};var Is=function(t,e,n,i,r,o,a,s,u,c){return t=new ms(t,e,n,i,r),t.Td=o,t.Y=a,o=t.ae(s),o.mc=wt(u||null),""+o.Zd(c)},Ts=function(t){if(!t.xc)throw Error("IfcHandler must be initialized!");cs(t.xc,function(e){var n={};if(e&&e.authEvent){var i=!1;for(e=_o(e.authEvent),n=0;n<t.ta.length;n++)i=t.ta[n](e)||i;return n={},n.status=i?"ACK":"ERROR",Dn(n)}return n.status="ERROR",Dn(n)})},ks=function(t){var e={type:"webStorageSupport"};return t.Sb().then(function(){return t.xc.sendMessage(e)}).then(function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()})};bs.prototype.ib=function(t){this.ta.push(t)},bs.prototype.dc=function(t){st(this.ta,function(e){return e==t})};var Es=function(t,e,n,r,o,a){if(yo(this,"type","recaptcha"),this.ad=this.Ib=null,this.Kb=!1,this.ne=e,this.Fa=n||{theme:"light",type:"image"},this.J=[],this.Fa.sitekey)throw new Co("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.Bc="invisible"===this.Fa.size,!wn(e)||!this.Bc&&wn(e).hasChildNodes())throw new Co("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.f=new ua(t,a||null,o||null),this.Jf=r||function(){return null};var s=this;this.Wc=[];var u=this.Fa.callback;this.Fa.callback=function(t){if(s.Lb(t),"function"==typeof u)u(t);else if("string"==typeof u){var e=Zr(u,i);"function"==typeof e&&e(t)}};var c=this.Fa["expired-callback"];this.Fa["expired-callback"]=function(){if(s.Lb(null),"function"==typeof c)c();else if("string"==typeof c){var t=Zr(c,i);"function"==typeof t&&t()}}};Es.prototype.Lb=function(t){for(var e=0;e<this.Wc.length;e++)try{this.Wc[e](t)}catch(t){}};var As=function(t,e){st(t.Wc,function(t){return t==e})};Es.prototype.c=function(t){var e=this;return this.J.push(t),Vn(t,function(){ot(e.J,t)}),t},Es.prototype.Tb=function(){var t=this;return this.Ib?this.Ib:this.Ib=this.c(Dn().then(function(){if(eo())return Kr();throw new Co("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return Cs(Os(),t.Jf())}).then(function(){return os(t.f,Ha,{})}).then(function(e){t.Fa.sitekey=e.recaptchaSiteKey}).g(function(e){throw t.Ib=null,e}))},Es.prototype.render=function(){Ns(this);var t=this;return this.c(this.Tb().then(function(){if(null===t.ad){var e=t.ne;if(!t.Bc){var n=wn(e);e=kn("DIV"),n.appendChild(e)}t.ad=grecaptcha.render(e,t.Fa)}return t.ad}))},Es.prototype.verify=function(){Ns(this);var t=this;return this.c(this.render().then(function(e){return new Sn(function(n){var i=grecaptcha.getResponse(e);if(i)n(i);else{var r=function(e){e&&(As(t,r),n(e))};t.Wc.push(r),t.Bc&&grecaptcha.execute(t.ad)}})}))};var Ns=function(t){if(t.Kb)throw new Co("internal-error","RecaptchaVerifier instance has been destroyed.")};Es.prototype.clear=function(){Ns(this),this.Kb=!0,Os().ld--;for(var t=0;t<this.J.length;t++)this.J[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.Bc){t=wn(this.ne);for(var e;e=t.firstChild;)t.removeChild(e)}};var Ps=X("https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Ss=function(){this.ld=i.grecaptcha?1/0:0,this.Ce=null,this.jd="__rcb"+Math.floor(1e6*Math.random())},Cs=function(t,e){return new Sn(function(n,r){if(ho())if(!i.grecaptcha||e!==t.Ce&&!t.ld){i[t.jd]=function(){if(i.grecaptcha){t.Ce=e;var o=i.grecaptcha.render;i.grecaptcha.render=function(e,n){return e=o(e,n),t.ld++,e},n()}else r(new Co("internal-error"));delete i[t.jd]};var o=G(Ps,{onload:t.jd,hl:e||""});Dn(hi(o)).g(function(){r(new Co("internal-error","Unable to load external reCAPTCHA dependencies!"))})}else n();else r(new Co("network-request-failed"))})},Rs=null,Os=function(){return Rs||(Rs=new Ss),Rs},Ds=function(t,n,i){try{this.i=i||e.app()}catch(t){throw new Co("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.i.options||!this.i.options.apiKey)throw new Co("invalid-api-key");i=this.i.options.apiKey;var r=this,o=null;try{o=ct(this.i.auth().M)}catch(t){}o=e.SDK_VERSION?Jr(e.SDK_VERSION,o):null,Es.call(this,i,t,n,function(){try{var t=r.i.auth().ia}catch(e){t=null}return t},o,Or(Cr))};y(Ds,Es);var _s=function(t){if(this.G=t||e.INTERNAL.reactNative&&e.INTERNAL.reactNative.AsyncStorage,!this.G)throw new Co("internal-error","The React Native compatibility library was not found.")};t=_s.prototype,t.get=function(t){return Dn(this.G.getItem(t)).then(function(t){return t&&ao(t)})},t.set=function(t,e){return Dn(this.G.setItem(t,ro(e)))},t.remove=function(t){return Dn(this.G.removeItem(t))},t.jb=function(){},t.$a=function(){};var Ls=function(){this.G={}};t=Ls.prototype,t.get=function(t){return Dn(this.G[t])},t.set=function(t,e){return this.G[t]=e,Dn()},t.remove=function(t){return delete this.G[t],Dn()},t.jb=function(){},t.$a=function(){};var xs=function(){if(!Us()){if("Node"==Br())throw new Co("internal-error","The LocalStorage compatibility library was not found.");throw new Co("web-storage-unsupported")}this.G=i.localStorage||e.INTERNAL.node.localStorage},Us=function(){var t="Node"==Br();if(!(t=i.localStorage||t&&e.INTERNAL.node&&e.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}};t=xs.prototype,t.get=function(t){var e=this;return Dn().then(function(){var n=e.G.getItem(t);return ao(n)})},t.set=function(t,e){var n=this;return Dn().then(function(){var i=ro(e);null===i?n.remove(t):n.G.setItem(t,i)})},t.remove=function(t){var e=this;return Dn().then(function(){e.G.removeItem(t)})},t.jb=function(t){i.window&&we(i.window,"storage",t)},t.$a=function(t){i.window&&Ee(i.window,"storage",t)};var Vs=function(){this.G={}};t=Vs.prototype,t.get=function(){return Dn(null)},t.set=function(){return Dn()},t.remove=function(){return Dn()},t.jb=function(){},t.$a=function(){};var Ms=function(){if(!js()){if("Node"==Br())throw new Co("internal-error","The SessionStorage compatibility library was not found.");throw new Co("web-storage-unsupported")}this.G=i.sessionStorage||e.INTERNAL.node.sessionStorage},js=function(){var t="Node"==Br();if(!(t=i.sessionStorage||t&&e.INTERNAL.node&&e.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}};t=Ms.prototype,t.get=function(t){var e=this;return Dn().then(function(){var n=e.G.getItem(t);return ao(n)})},t.set=function(t,e){var n=this;return Dn().then(function(){var i=ro(e);null===i?n.remove(t):n.G.setItem(t,i)})},t.remove=function(t){var e=this;return Dn().then(function(){e.G.removeItem(t)})},t.jb=function(){},t.$a=function(){};var Fs,Ws=function(t,e,n,r,o,a){if(!window.indexedDB)throw new Co("web-storage-unsupported");this.zf=t,this.Hd=e,this.md=n,this.ff=r,this.gb=o,this.N={},this.fc=[],this.Wb=0,this.Rf=a||i.indexedDB},Ks=function(t){return new Sn(function(e,n){var i=t.Rf.open(t.zf,t.gb);i.onerror=function(t){n(Error(t.target.errorCode))},i.onupgradeneeded=function(e){e=e.target.result;try{e.createObjectStore(t.Hd,{keyPath:t.md})}catch(t){n(t)}},i.onsuccess=function(t){e(t.target.result)}})},Xs=function(t){return t.Ge||(t.Ge=Ks(t)),t.Ge},qs=function(t,e){return e.objectStore(t.Hd)},Hs=function(t,e,n){return e.transaction([t.Hd],n?"readwrite":"readonly")},Bs=function(t){return new Sn(function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(Error(t.target.errorCode))}})};t=Ws.prototype,t.set=function(t,e){var n,i=!1,r=this;return Vn(Xs(this).then(function(e){return n=e,e=qs(r,Hs(r,n,!0)),Bs(e.get(t))}).then(function(o){var a=qs(r,Hs(r,n,!0));return o?(o.value=e,Bs(a.put(o))):(r.Wb++,i=!0,o={},o[r.md]=t,o[r.ff]=e,Bs(a.add(o)))}).then(function(){r.N[t]=e}),function(){i&&r.Wb--})},t.get=function(t){var e=this;return Xs(this).then(function(n){return Bs(qs(e,Hs(e,n,!1)).get(t))}).then(function(t){return t&&t.value})},t.remove=function(t){var e=!1,n=this;return Vn(Xs(this).then(function(i){return e=!0,n.Wb++,Bs(qs(n,Hs(n,i,!0)).delete(t))}).then(function(){delete n.N[t]}),function(){e&&n.Wb--})},t.xg=function(){var t=this;return Xs(this).then(function(e){var n=qs(t,Hs(t,e,!1));return n.getAll?Bs(n.getAll()):new Sn(function(t,e){var i=[],r=n.openCursor();r.onsuccess=function(e){(e=e.target.result)?(i.push(e.value),e.continue()):t(i)},r.onerror=function(t){e(Error(t.target.errorCode))}})}).then(function(e){var n={},i=[];if(0==t.Wb){for(i=0;i<e.length;i++)n[e[i][t.md]]=e[i][t.ff];i=xr(t.N,n),t.N=n}return i})},t.jb=function(t){0==this.fc.length&&this.ce(),this.fc.push(t)},t.$a=function(t){st(this.fc,function(e){return e==t}),0==this.fc.length&&this.Sc()},t.ce=function(){var t=this;this.Sc();var e=function(){return t.Nd=Wi(800).then(m(t.xg,t)).then(function(e){0<e.length&&Q(t.fc,function(t){t(e)})}).then(e).g(function(t){"STOP_EVENT"!=t.message&&e()}),t.Nd};e()},t.Sc=function(){this.Nd&&this.Nd.cancel("STOP_EVENT")};var Gs,Ys=function(){this.se={Browser:zs,Node:Js,ReactNative:$s}[Br()]},zs={D:xs,ee:Ms},Js={D:xs,ee:Ms},$s={D:_s,ee:Vs},Zs=function(t){this.Bd(t)};Zs.prototype.Bd=function(t){var e=t.url;if(void 0===e)throw new Co("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new Co("invalid-continue-uri");this.uf=e,this.ge=this.nc=null,this.He=!1;var n=t.android;if(n&&"object"==typeof n){e=n.packageName;var i=n.installApp;if(n=n.minimumVersion,"string"==typeof e&&e.length){if(this.nc=e,void 0!==i&&"boolean"!=typeof i)throw new Co("argument-error","installApp property must be a boolean when specified.");if(this.He=!!i,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new Co("argument-error","minimumVersion property must be a non empty string when specified.");this.ge=n||null}else{if(void 0!==e)throw new Co("argument-error","packageName property must be a non empty string when specified.");if(void 0!==i||void 0!==n)throw new Co("missing-android-pkg-name")}}else if(void 0!==n)throw new Co("argument-error","android property must be a non null object when specified.");if(this.xd=null,(e=t.iOS)&&"object"==typeof e){if("string"==typeof(e=e.bundleId)&&e.length)this.xd=e;else if(void 0!==e)throw new Co("argument-error","bundleId property must be a non empty string when specified.")}else if(void 0!==e)throw new Co("argument-error","iOS property must be a non null object when specified.");if(void 0!==(t=t.handleCodeInApp)&&"boolean"!=typeof t)throw new Co("argument-error","handleCodeInApp property must be a boolean when specified.");if((this.le=!!t)&&!this.xd&&!this.nc)throw new Co("argument-error","handleCodeInApp property can't be true when no mobile application is provided.")};var Qs=function(t){var e={};e.continueUrl=t.uf,e.canHandleCodeInApp=t.le,(e.androidPackageName=t.nc)&&(e.androidMinimumVersion=t.ge,e.androidInstallApp=t.He),e.iOSBundleId=t.xd;for(var n in e)null===e[n]&&delete e[n];return e},tu=function(t,e){this.xf=e,yo(this,"verificationId",t)};tu.prototype.confirm=function(t){return t=ea(this.verificationId,t),this.xf(t)};var eu=function(t,e,n,i){return new ta(t).verifyPhoneNumber(e,n).then(function(t){return new tu(t,i)})},nu=function(t){var e={},n=t.email,i=t.newEmail;if(t=t.requestType,!n||!t)throw Error("Invalid provider user info!");e.fromEmail=i||null,e.email=n,yo(this,"operation",t),yo(this,"data",Eo(e))},iu=function(t,e,n,i,r,o){if(this.fg=t,this.mg=e,this.Kf=n,this.Gc=i,this.fe=r,this.ng=!!o,this.ub=null,this.Sa=this.Gc,this.fe<this.Gc)throw Error("Proactive refresh lower bound greater than upper bound!")};iu.prototype.start=function(){this.Sa=this.Gc,ou(this,!0)};var ru=function(t,e){return e?(t.Sa=t.Gc,t.Kf()):(e=t.Sa,t.Sa*=2,t.Sa>t.fe&&(t.Sa=t.fe),e)},ou=function(t,e){t.stop(),t.ub=Wi(ru(t,e)).then(function(){return t.ng?Dn():vo()}).then(function(){return t.fg()}).then(function(){ou(t,!0)}).g(function(e){t.mg(e)&&ou(t,!1)})};iu.prototype.stop=function(){this.ub&&(this.ub.cancel(),this.ub=null)};var au=function(t){var e={};e["facebook.com"]=cu,e["google.com"]=lu,e["github.com"]=hu,e["twitter.com"]=fu;var n=t&&t.providerId;try{if(n)return e[n]?new e[n](t):new uu(t);if(void 0!==t.idToken)return new su(t)}catch(t){}return null},su=function(t){var e=t.providerId;if(!e&&t.idToken){var n=Uo(t.idToken);n&&n.Rd&&(e=n.Rd)}if(!e)throw Error("Invalid additional user info!");t=!!t.isNewUser,yo(this,"providerId",e),yo(this,"isNewUser",t)},uu=function(t){su.call(this,t),t=ao(t.rawUserInfo||"{}"),yo(this,"profile",Eo(t||{}))};y(uu,su);var cu=function(t){if(uu.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider id!")};y(cu,uu);var hu=function(t){if(uu.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider id!");yo(this,"username",this.profile&&this.profile.login||null)};y(hu,uu);var lu=function(t){if(uu.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider id!")};y(lu,uu);var fu=function(t){if(uu.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider id!");yo(this,"username",t.screenName||null)};y(fu,uu);var du,pu={LOCAL:"local",NONE:"none",SESSION:"session"},vu=function(t){var e=new Co("invalid-persistence-type"),n=new Co("unsupported-persistence-type");t:{for(i in pu)if(pu[i]==t){var i=!0;break t}i=!1}if(!i||"string"!=typeof t)throw e;switch(Br()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;default:if(!Qr()&&"none"!==t)throw n}},mu=function(t,e,n,i){this.Me=t,this.Xd=e,this.og=n,this.Ve=i,this.S={},Gs||(Gs=new Ys),t=Gs;try{if(Dr()){Fs||(Fs=new Ws("firebaseLocalStorageDb","firebaseLocalStorage","fbase_key","value",1));var r=Fs}else r=new t.se.D;this.Se=r}catch(t){this.Se=new Ls,this.Ve=!0}try{this.af=new t.se.ee}catch(t){this.af=new Ls}this.Qf=new Ls,this.de=m(this.Ze,this),this.N={}},gu=function(){return du||(du=new mu("firebase",":",!(uo($r())||!Hr()),io())),du},bu=function(t,e){switch(e){case"session":return t.af;case"none":return t.Qf;default:return t.Se}};t=mu.prototype,t.ca=function(t,e){return this.Me+this.Xd+t.name+(e?this.Xd+e:"")},t.get=function(t,e){return bu(this,t.D).get(this.ca(t,e))},t.remove=function(t,e){return e=this.ca(t,e),"local"==t.D&&(this.N[e]=null),bu(this,t.D).remove(e)},t.set=function(t,e,n){var i=this.ca(t,n),r=this,o=bu(this,t.D);return o.set(i,e).then(function(){return o.get(i)}).then(function(e){"local"==t.D&&(r.N[i]=e)})},t.addListener=function(t,e,n){t=this.ca(t,e),void 0!==i.localStorage&&"function"==typeof i.localStorage.getItem&&(this.N[t]=i.localStorage.getItem(t)),bt(this.S)&&this.ce(),this.S[t]||(this.S[t]=[]),this.S[t].push(n)},t.removeListener=function(t,e,n){t=this.ca(t,e),this.S[t]&&(st(this.S[t],function(t){return t==n}),0==this.S[t].length&&delete this.S[t]),bt(this.S)&&this.Sc()},t.ce=function(){bu(this,"local").jb(this.de),this.Ve||Dr()||yu(this)};var yu=function(t){wu(t),t.Fd=setInterval(function(){for(var e in t.S){var n=i.localStorage.getItem(e),r=t.N[e];n!=r&&(t.N[e]=n,n=new ue({type:"storage",key:e,target:window,oldValue:r,newValue:n,Md:!0}),t.Ze(n))}},1e3)},wu=function(t){t.Fd&&(clearInterval(t.Fd),t.Fd=null)};mu.prototype.Sc=function(){bu(this,"local").$a(this.de),wu(this)},mu.prototype.Ze=function(t){if(t&&t.Hf){var e=t.R.key;if(null==e)for(var n in this.S){var r=this.N[n];void 0===r&&(r=null);var o=i.localStorage.getItem(n);o!==r&&(this.N[n]=o,this.hd(n))}else if(0==e.indexOf(this.Me+this.Xd)&&this.S[e]){if(void 0!==t.R.Md?bu(this,"local").$a(this.de):wu(this),this.og)if(n=i.localStorage.getItem(e),(r=t.R.newValue)!==n)null!==r?i.localStorage.setItem(e,r):i.localStorage.removeItem(e);else if(this.N[e]===r&&void 0===t.R.Md)return;var a=this;n=function(){void 0===t.R.Md&&a.N[e]===i.localStorage.getItem(e)||(a.N[e]=i.localStorage.getItem(e),a.hd(e))},Pt&&Ut&&10==Ut&&i.localStorage.getItem(e)!==t.R.newValue&&t.R.newValue!==t.R.oldValue?setTimeout(n,10):n()}}else Q(t,m(this.hd,this))},mu.prototype.hd=function(t){this.S[t]&&Q(this.S[t],function(t){t()})};var Iu=function(t,e){this.j=t,this.h=e||gu()},Tu={name:"authEvent",D:"local"},ku=function(t){return t.h.get(Tu,t.j).then(function(t){return _o(t)})};Iu.prototype.ib=function(t){this.h.addListener(Tu,this.j,t)},Iu.prototype.dc=function(t){this.h.removeListener(Tu,this.j,t)};var Eu=function(t){this.h=t||gu()},Au={name:"sessionId",D:"session"};Eu.prototype.tc=function(t){return this.h.get(Au,t)};var Nu=function(t,e,n,i,r,o,a){this.B=t,this.m=e,this.o=n,this.La=i||null,this.P=a||null,this.$e=e+":"+n,this.pg=new Eu,this.xe=new Iu(this.$e),this.Ad=null,this.ta=[],this.Vf=r||500,this.ig=o||2e3,this.Rb=this.Jc=null},Pu=function(t){return new Co("invalid-cordova-configuration",t)};Nu.prototype.Ra=function(){return this.Tb?this.Tb:this.Tb=Xr().then(function(){if("function"!=typeof Zr("universalLinks.subscribe",i))throw Pu("cordova-universal-links-plugin is not installed");if(void 0===Zr("BuildInfo.packageName",i))throw Pu("cordova-plugin-buildinfo is not installed");if("function"!=typeof Zr("cordova.plugins.browsertab.openUrl",i))throw Pu("cordova-plugin-browsertab is not installed");if("function"!=typeof Zr("cordova.InAppBrowser.open",i))throw Pu("cordova-plugin-inappbrowser is not installed")},function(){throw new Co("cordova-not-ready")})};var Su=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")},Cu=function(t){var e=new te;return e.update(t),ht(e.digest())};t=Nu.prototype,t.ec=function(t,e){return e(new Co("operation-not-supported-in-this-environment")),Dn()},t.$b=function(){return _n(new Co("operation-not-supported-in-this-environment"))},t.bf=function(){return!1},t.Ye=function(){return!0},t.Be=function(){return!0},t.ac=function(t,e,n){if(this.Jc)return _n(new Co("redirect-operation-pending"));var r=this,o=i.document,a=null,s=null,u=null,c=null;return this.Jc=Vn(Dn().then(function(){return ia(e),Ou(r)}).then(function(){return Ru(r,t,e,n)}).then(function(){return new Sn(function(t,e){s=function(){var e=Zr("cordova.plugins.browsertab.close",i);return t(),"function"==typeof e&&e(),r.Rb&&"function"==typeof r.Rb.close&&(r.Rb.close(),r.Rb=null),!1},r.ib(s),u=function(){a||(a=Wi(r.ig).then(function(){e(new Co("redirect-cancelled-by-user"))}))},c=function(){po()&&u()},o.addEventListener("resume",u,!1),$r().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",c,!1)}).g(function(t){return Du(r).then(function(){throw t})})}),function(){u&&o.removeEventListener("resume",u,!1),c&&o.removeEventListener("visibilitychange",c,!1),a&&a.cancel(),s&&r.dc(s),r.Jc=null})};var Ru=function(t,e,n,r){var o=Su(),a=new Do(e,r,null,o,new Co("no-auth-event")),s=Zr("BuildInfo.packageName",i);if("string"!=typeof s)throw new Co("invalid-cordova-configuration");var u=Zr("BuildInfo.displayName",i),c={};if($r().toLowerCase().match(/iphone|ipad|ipod/))c.ibi=s;else{if(!$r().toLowerCase().match(/android/))return _n(new Co("operation-not-supported-in-this-environment"));c.apn=s}u&&(c.appDisplayName=u),o=Cu(o),c.sessionId=o;var h=Is(t.B,t.m,t.o,e,n,null,r,t.La,c,t.P);return t.Ra().then(function(){var e=t.$e;return t.pg.h.set(Tu,a.A(),e)}).then(function(){var e=Zr("cordova.plugins.browsertab.isAvailable",i);if("function"!=typeof e)throw new Co("invalid-cordova-configuration");var n=null;e(function(e){if(e){if("function"!=typeof(n=Zr("cordova.plugins.browsertab.openUrl",i)))throw new Co("invalid-cordova-configuration");n(h)}else{if("function"!=typeof(n=Zr("cordova.InAppBrowser.open",i)))throw new Co("invalid-cordova-configuration");e=n;var r=$r();r=!(!r.match(/(iPad|iPhone|iPod).*OS 7_\d/i)&&!r.match(/(iPad|iPhone|iPod).*OS 8_\d/i)),t.Rb=e(h,r?"_blank":"_system","location=yes")}})})};Nu.prototype.Lb=function(t){for(var e=0;e<this.ta.length;e++)try{this.ta[e](t)}catch(t){}};var Ou=function(t){return t.Ad||(t.Ad=t.Ra().then(function(){return new Sn(function(e){var n=function(i){return e(i),t.dc(n),!1};t.ib(n),_u(t)})})),t.Ad},Du=function(t){var e=null;return ku(t.xe).then(function(n){return e=n,n=t.xe,n.h.remove(Tu,n.j)}).then(function(){return e})},_u=function(t){var e=Zr("universalLinks.subscribe",i);if("function"!=typeof e)throw new Co("invalid-cordova-configuration");var n=new Do("unknown",null,null,null,new Co("no-auth-event")),r=!1,o=Wi(t.Vf).then(function(){return Du(t).then(function(){r||t.Lb(n)})}),a=function(e){r=!0,o&&o.cancel(),Du(t).then(function(i){var r=n;if(i&&e&&e.url){r=null;var o=e.url,a=vr(o),s=dr(a,"link"),u=dr(vr(s),"link");a=dr(a,"deep_link_id"),o=dr(vr(a),"link")||a||u||s||o,-1!=o.indexOf("/__/auth/callback")&&(r=vr(o),r=ao(dr(r,"firebaseError")||null),r=(r="object"==typeof r?Ro(r):null)?new Do(i.ma,i.Y,null,null,r):new Do(i.ma,i.Y,o,i.tc())),r=r||n}t.Lb(r)})},s=i.handleOpenURL;i.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(Zr("BuildInfo.packageName",i).toLowerCase()+"://")&&a({url:t}),"function"==typeof s)try{s(t)}catch(t){console.error(t)}},e(null,a)};Nu.prototype.ib=function(t){this.ta.push(t),Ou(this).g(function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Do("unknown",null,null,null,new Co("no-auth-event")),t(e))})},Nu.prototype.dc=function(t){st(this.ta,function(e){return e==t})};var Lu=function(t){this.j=t,this.h=gu()},xu={name:"pendingRedirect",D:"session"},Uu=function(t){return t.h.set(xu,"pending",t.j)},Vu=function(t){return t.h.remove(xu,t.j)},Mu=function(t){return t.h.get(xu,t.j).then(function(t){return"pending"==t})},ju=function(t,e,n){this.B=t,this.m=e,this.o=n,this.gc=[],this.sb=!1,this.ed=m(this.vd,this),this.Xa=new Gu(this),this.Od=new Qu(this),this.Xb=new Lu(this.m+":"+this.o),this.Ia={},this.Ia.unknown=this.Xa,this.Ia.signInViaRedirect=this.Xa,this.Ia.linkViaRedirect=this.Xa,this.Ia.reauthViaRedirect=this.Xa,this.Ia.signInViaPopup=this.Od,this.Ia.linkViaPopup=this.Od,this.Ia.reauthViaPopup=this.Od,this.Z=Fu(this.B,this.m,this.o,Cr)},Fu=function(t,n,i,r){var o=e.SDK_VERSION||null;return qr()?new Nu(t,n,i,o,void 0,void 0,r):new bs(t,n,i,o,r)};ju.prototype.reset=function(){this.sb=!1,this.Z.dc(this.ed),this.Z=Fu(this.B,this.m,this.o)},ju.prototype.Sb=function(){var t=this;this.sb||(this.sb=!0,this.Z.ib(this.ed));var e=this.Z;return this.Z.Ra().g(function(n){throw t.Z==e&&t.reset(),n})};var Wu=function(t){t.Z.Ye()&&t.Sb().g(function(e){var n=new Do("unknown",null,null,null,new Co("operation-not-supported-in-this-environment"));qu(e)&&t.vd(n)}),t.Z.Be()||Yu(t.Xa)};ju.prototype.subscribe=function(t){if(rt(this.gc,t)||this.gc.push(t),!this.sb){var e=this;Mu(this.Xb).then(function(t){t?Vu(e.Xb).then(function(){e.Sb().g(function(t){var n=new Do("unknown",null,null,null,new Co("operation-not-supported-in-this-environment"));qu(t)&&e.vd(n)})}):Wu(e)}).g(function(){Wu(e)})}},ju.prototype.unsubscribe=function(t){st(this.gc,function(e){return e==t})},ju.prototype.vd=function(t){if(!t)throw new Co("invalid-auth-event");for(var e=!1,n=0;n<this.gc.length;n++){var i=this.gc[n];if(i.ke(t.ma,t.Y)){(e=this.Ia[t.ma])&&e.Te(t,i),e=!0;break}}return Yu(this.Xa),e};var Ku=new lo(2e3,1e4),Xu=new lo(3e4,6e4);ju.prototype.getRedirectResult=function(){return this.Xa.getRedirectResult()},ju.prototype.$b=function(t,e,n,i,r){var o=this;return this.Z.$b(t,e,n,function(){o.sb||(o.sb=!0,o.Z.ib(o.ed))},function(){o.reset()},i,r)};var qu=function(t){return!(!t||"auth/cordova-not-ready"!=t.code)};ju.prototype.ac=function(t,e,n){var i,r=this;return Uu(this.Xb).then(function(){return r.Z.ac(t,e,n).g(function(t){if(qu(t))throw new Co("operation-not-supported-in-this-environment");return i=t,Vu(r.Xb).then(function(){throw i})}).then(function(){return r.Z.bf()?new Sn(function(){}):Vu(r.Xb).then(function(){return r.getRedirectResult()}).then(function(){}).g(function(){})})})},ju.prototype.ec=function(t,e,n,i){return this.Z.ec(n,function(n){t.bb(e,null,n,i)},Ku.get())};var Hu={},Bu=function(t,e,n){var i=e+":"+n;return Hu[i]||(Hu[i]=new ju(t,e,n)),Hu[i]},Gu=function(t){this.h=t,this.Ab=null,this.cc=[],this.bc=[],this.yb=null,this.Sd=!1};Gu.prototype.reset=function(){this.Ab=null,this.yb&&(this.yb.cancel(),this.yb=null)},Gu.prototype.Te=function(t,e){if(!t)return _n(new Co("invalid-auth-event"));this.reset(),this.Sd=!0;var n=t.ma,i=t.Y,r=t.getError()&&"auth/web-storage-unsupported"==t.getError().code,o=t.getError()&&"auth/operation-not-supported-in-this-environment"==t.getError().code;return"unknown"!=n||r||o?t=t.ba?this.Pd(t,e):e.Nb(n,i)?this.Qd(t,e):_n(new Co("invalid-auth-event")):($u(this,!1,null,null),t=Dn()),t};var Yu=function(t){t.Sd||(t.Sd=!0,$u(t,!1,null,null))};Gu.prototype.Pd=function(t){return $u(this,!0,null,t.getError()),Dn()},Gu.prototype.Qd=function(t,e){var n=this;e=e.Nb(t.ma,t.Y);var i=t.Eb,r=t.tc(),o=!!t.ma.match(/Redirect$/);return e(i,r).then(function(t){$u(n,o,t,null)}).g(function(t){$u(n,o,null,t)})};var zu=function(t,e){if(t.Ab=function(){return _n(e)},t.bc.length)for(var n=0;n<t.bc.length;n++)t.bc[n](e)},Ju=function(t,e){if(t.Ab=function(){return Dn(e)},t.cc.length)for(var n=0;n<t.cc.length;n++)t.cc[n](e)},$u=function(t,e,n,i){e?i?zu(t,i):Ju(t,n):Ju(t,{user:null}),t.cc=[],t.bc=[]};Gu.prototype.getRedirectResult=function(){var t=this;return new Sn(function(e,n){t.Ab?t.Ab().then(e,n):(t.cc.push(e),t.bc.push(n),Zu(t))})};var Zu=function(t){var e=new Co("timeout");t.yb&&t.yb.cancel(),t.yb=Wi(Xu.get()).then(function(){t.Ab||$u(t,!0,null,e)})},Qu=function(t){this.h=t};Qu.prototype.Te=function(t,e){if(!t)return _n(new Co("invalid-auth-event"));var n=t.ma,i=t.Y;return t.ba?this.Pd(t,e):e.Nb(n,i)?this.Qd(t,e):_n(new Co("invalid-auth-event"))},Qu.prototype.Pd=function(t,e){return e.bb(t.ma,null,t.getError(),t.Y),Dn()},Qu.prototype.Qd=function(t,e){var n=t.Y,i=t.ma,r=e.Nb(i,n),o=t.Eb;return t=t.tc(),r(o,t).then(function(t){e.bb(i,t,null,n)}).g(function(t){e.bb(i,null,t,n)})};var tc=function(t){this.f=t,this.Ja=this.fa=null,this.Na=0};tc.prototype.A=function(){return{apiKey:this.f.m,refreshToken:this.fa,accessToken:this.Ja,expirationTime:this.Na}};var ec=function(t,e){var n=e.idToken,i=e.refreshToken;e=nc(e.expiresIn),t.Ja=n,t.Na=e,t.fa=i},nc=function(t){return b()+1e3*parseInt(t,10)},ic=function(t,e){return ya(t.f,e).then(function(e){return t.Ja=e.access_token,t.Na=nc(e.expires_in),t.fa=e.refresh_token,{accessToken:t.Ja,expirationTime:t.Na,refreshToken:t.fa}}).g(function(e){throw"auth/user-token-expired"==e.code&&(t.fa=null),e})};tc.prototype.getToken=function(t){return t=!!t,this.Ja&&!this.fa?_n(new Co("user-token-expired")):t||!this.Ja||b()>this.Na-3e4?this.fa?ic(this,{grant_type:"refresh_token",refresh_token:this.fa}):Dn(null):Dn({accessToken:this.Ja,expirationTime:this.Na,refreshToken:this.fa})};var rc=function(t,e){this.pe=t||null,this.Je=e||null,wo(this,{lastSignInTime:mo(e||null),creationTime:mo(t||null)})};rc.prototype.clone=function(){return new rc(this.pe,this.Je)},rc.prototype.A=function(){return{lastLoginAt:this.Je,createdAt:this.pe}};var oc=function(t,e,n,i,r,o){wo(this,{uid:t,displayName:i||null,photoURL:r||null,email:n||null,phoneNumber:o||null,providerId:e})},ac=function(t,e){se.call(this,t);for(var n in e)this[n]=e[n]};y(ac,se);var sc=function(t,n,i){this.J=[],this.m=t.apiKey,this.o=t.appName,this.B=t.authDomain||null,t=e.SDK_VERSION?Jr(e.SDK_VERSION):null,this.f=new ua(this.m,Or(Cr),t),this.ra=new tc(this.f),vc(this,n.idToken),ec(this.ra,n),yo(this,"refreshToken",this.ra.fa),yc(this,i||{}),Pi.call(this),this.Kc=!1,this.B&&to()&&(this.v=Bu(this.B,this.m,this.o)),this.Rc=[],this.sa=null,this.wb=fc(this),this.Gb=m(this.wd,this);var r=this;this.ia=null,this.Pe=function(t){r.Cb(t.languageCode)},this.Dd=null,this.M=[],this.Oe=function(t){cc(r,t.Ff)},this.sd=null};y(sc,Pi),sc.prototype.Cb=function(t){this.ia=t,da(this.f,t)};var uc=function(t,e){t.Dd&&Ee(t.Dd,"languageCodeChanged",t.Pe),(t.Dd=e)&&we(e,"languageCodeChanged",t.Pe)},cc=function(t,n){t.M=n,pa(t.f,e.SDK_VERSION?Jr(e.SDK_VERSION,t.M):null)},hc=function(t,e){t.sd&&Ee(t.sd,"frameworkChanged",t.Oe),(t.sd=e)&&we(e,"frameworkChanged",t.Oe)};sc.prototype.wd=function(){this.wb.ub&&(this.wb.stop(),this.wb.start())};var lc=function(t){try{return e.app(t.o).auth()}catch(e){throw new Co("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.o+"'!")}},fc=function(t){return new iu(function(){return t.getIdToken(!0)},function(t){return!(!t||"auth/network-request-failed"!=t.code)},function(){var e=t.ra.Na-b()-3e5;return 0<e?e:0},3e4,96e4,!1)},dc=function(t){t.Kb||t.wb.ub||(t.wb.start(),Ee(t,"tokenChanged",t.Gb),we(t,"tokenChanged",t.Gb))},pc=function(t){Ee(t,"tokenChanged",t.Gb),t.wb.stop()},vc=function(t,e){t.Ie=e,yo(t,"_lat",e)},mc=function(t,e){st(t.Rc,function(t){return t==e})},gc=function(t){for(var e=[],n=0;n<t.Rc.length;n++)e.push(t.Rc[n](t));return Un(e).then(function(){return t})},bc=function(t){t.v&&!t.Kc&&(t.Kc=!0,t.v.subscribe(t))},yc=function(t,e){wo(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,metadata:new rc(e.createdAt,e.lastLoginAt),providerData:[]})};yo(sc.prototype,"providerId","firebase");var wc=function(){},Ic=function(t){return Dn().then(function(){if(t.Kb)throw new Co("app-deleted")})},Tc=function(t){return et(t.providerData,function(t){return t.providerId})},kc=function(t,e){e&&(Ec(t,e.providerId),t.providerData.push(e))},Ec=function(t,e){st(t.providerData,function(t){return t.providerId==e})},Ac=function(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&yo(t,e,n)};sc.prototype.copy=function(t){var e=this;e!=t&&(wo(this,{uid:t.uid,displayName:t.displayName,photoURL:t.photoURL,email:t.email,emailVerified:t.emailVerified,phoneNumber:t.phoneNumber,isAnonymous:t.isAnonymous,providerData:[]}),t.metadata?yo(this,"metadata",t.metadata.clone()):yo(this,"metadata",new rc),Q(t.providerData,function(t){kc(e,t)}),this.ra=t.ra,yo(this,"refreshToken",this.ra.fa))},sc.prototype.reload=function(){var t=this;return this.c(Ic(this).then(function(){return Nc(t).then(function(){return gc(t)}).then(wc)}))};var Nc=function(t){return t.getIdToken().then(function(e){var n=t.isAnonymous;return Sc(t,e).then(function(){return n||Ac(t,"isAnonymous",!1),e})})};sc.prototype.getIdToken=function(t){var e=this;return this.c(Ic(this).then(function(){return e.ra.getToken(t)}).then(function(t){if(!t)throw new Co("internal-error");return t.accessToken!=e.Ie&&(vc(e,t.accessToken),e.Ta()),Ac(e,"refreshToken",t.refreshToken),t.accessToken}))},sc.prototype.getToken=function(t){return go["firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead."]||(go["firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead."]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn("firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead.")),this.getIdToken(t)};var Pc=function(t,e){e.idToken&&t.Ie!=e.idToken&&(ec(t.ra,e),t.Ta(),vc(t,e.idToken),Ac(t,"refreshToken",t.ra.fa))};sc.prototype.Ta=function(){this.dispatchEvent(new ac("tokenChanged"))};var Sc=function(t,e){return os(t.f,Wa,{idToken:e}).then(m(t.gg,t))};sc.prototype.gg=function(t){if(!(t=t.users)||!t.length)throw new Co("internal-error");t=t[0],yc(this,{uid:t.localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt});for(var e=Cc(t),n=0;n<e.length;n++)kc(this,e[n]);Ac(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length))};var Cc=function(t){return(t=t.providerUserInfo)&&t.length?et(t,function(t){return new oc(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)}):[]};sc.prototype.reauthenticateAndRetrieveDataWithCredential=function(t){var e=this,n=null;return this.c(t.Gd(this.f,this.uid).then(function(t){return Pc(e,t),n=Oc(e,t,"reauthenticate"),e.sa=null,e.reload()}).then(function(){return n}),!0)},sc.prototype.reauthenticateWithCredential=function(t){return this.reauthenticateAndRetrieveDataWithCredential(t).then(function(){})};var Rc=function(t,e){return Nc(t).then(function(){if(rt(Tc(t),e))return gc(t).then(function(){throw new Co("provider-already-linked")})})};sc.prototype.linkAndRetrieveDataWithCredential=function(t){var e=this,n=null;return this.c(Rc(this,t.providerId).then(function(){return e.getIdToken()}).then(function(n){return t.Fc(e.f,n)}).then(function(t){return n=Oc(e,t,"link"),Dc(e,t)}).then(function(){return n}))},sc.prototype.linkWithCredential=function(t){return this.linkAndRetrieveDataWithCredential(t).then(function(t){return t.user})},sc.prototype.linkWithPhoneNumber=function(t,e){var n=this;return this.c(Rc(this,"phone").then(function(){return eu(lc(n),t,e,m(n.linkAndRetrieveDataWithCredential,n))}))},sc.prototype.reauthenticateWithPhoneNumber=function(t,e){var n=this;return this.c(Dn().then(function(){return eu(lc(n),t,e,m(n.reauthenticateAndRetrieveDataWithCredential,n))}),!0)};var Oc=function(t,e,n){var i=na(e);return e=au(e),Io({user:t,credential:i,additionalUserInfo:e,operationType:n})},Dc=function(t,e){return Pc(t,e),t.reload().then(function(){return t})};t=sc.prototype,t.updateEmail=function(t){var e=this;return this.c(this.getIdToken().then(function(n){return e.f.updateEmail(n,t)}).then(function(t){return Pc(e,t),e.reload()}))},t.updatePhoneNumber=function(t){var e=this;return this.c(this.getIdToken().then(function(n){return t.Fc(e.f,n)}).then(function(t){return Pc(e,t),e.reload()}))},t.updatePassword=function(t){var e=this;return this.c(this.getIdToken().then(function(n){return e.f.updatePassword(n,t)}).then(function(t){return Pc(e,t),e.reload()}))},t.updateProfile=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return Ic(this);var e=this;return this.c(this.getIdToken().then(function(n){return e.f.updateProfile(n,{displayName:t.displayName,photoUrl:t.photoURL})}).then(function(t){return Pc(e,t),Ac(e,"displayName",t.displayName||null),Ac(e,"photoURL",t.photoUrl||null),Q(e.providerData,function(t){"password"===t.providerId&&(yo(t,"displayName",e.displayName),yo(t,"photoURL",e.photoURL))}),gc(e)}).then(wc))},t.unlink=function(t){var e=this;return this.c(Nc(this).then(function(n){return rt(Tc(e),t)?Sa(e.f,n,[t]).then(function(t){var n={};return Q(t.providerUserInfo||[],function(t){n[t.providerId]=!0}),Q(Tc(e),function(t){n[t]||Ec(e,t)}),n[ta.PROVIDER_ID]||yo(e,"phoneNumber",null),gc(e)}):gc(e).then(function(){throw new Co("no-such-provider")})}))},t.delete=function(){var t=this;return this.c(this.getIdToken().then(function(e){return os(t.f,ja,{idToken:e})}).then(function(){t.dispatchEvent(new ac("userDeleted"))})).then(function(){for(var e=0;e<t.J.length;e++)t.J[e].cancel("app-deleted");uc(t,null),hc(t,null),t.J=[],t.Kb=!0,pc(t),yo(t,"refreshToken",null),t.v&&t.v.unsubscribe(t)})},t.ke=function(t,e){return!!("linkViaPopup"==t&&(this.la||null)==e&&this.ka||"reauthViaPopup"==t&&(this.la||null)==e&&this.ka||"linkViaRedirect"==t&&(this.Ha||null)==e||"reauthViaRedirect"==t&&(this.Ha||null)==e)},t.bb=function(t,e,n,i){"linkViaPopup"!=t&&"reauthViaPopup"!=t||i!=(this.la||null)||(n&&this.Va?this.Va(n):e&&!n&&this.ka&&this.ka(e),this.K&&(this.K.cancel(),this.K=null),delete this.ka,delete this.Va)},t.Nb=function(t,e){return"linkViaPopup"==t&&e==(this.la||null)?m(this.ue,this):"reauthViaPopup"==t&&e==(this.la||null)?m(this.ve,this):"linkViaRedirect"==t&&(this.Ha||null)==e?m(this.ue,this):"reauthViaRedirect"==t&&(this.Ha||null)==e?m(this.ve,this):null},t.sc=function(){return so(this.uid+":::")},t.linkWithPopup=function(t){var e=this;return _c(this,"linkViaPopup",t,function(){return Rc(e,t.providerId).then(function(){return gc(e)})},!1)},t.reauthenticateWithPopup=function(t){return _c(this,"reauthViaPopup",t,function(){return Dn()},!0)};var _c=function(t,n,i,r,o){if(!to())return _n(new Co("operation-not-supported-in-this-environment"));if(t.sa&&!o)return _n(t.sa);var a=So(i.providerId),s=t.sc(),u=null;(!io()||Hr())&&t.B&&i.isOAuthProvider&&(u=Is(t.B,t.m,t.o,n,i,null,s,e.SDK_VERSION||null));var c=jr(u,a&&a.Zb,a&&a.Yb);return r=r().then(function(){if(xc(t),!o)return t.getIdToken().then(function(){})}).then(function(){return t.v.$b(c,n,i,s,!!u)}).then(function(){return new Sn(function(e,i){t.bb(n,null,new Co("cancelled-popup-request"),t.la||null),t.ka=e,t.Va=i,t.la=s,t.K=t.v.ec(t,n,c,s)})}).then(function(t){return c&&Mr(c),t?Io(t):null}).g(function(t){throw c&&Mr(c),t}),t.c(r,o)};sc.prototype.linkWithRedirect=function(t){var e=this;return Lc(this,"linkViaRedirect",t,function(){return Rc(e,t.providerId)},!1)},sc.prototype.reauthenticateWithRedirect=function(t){return Lc(this,"reauthViaRedirect",t,function(){return Dn()},!0)};var Lc=function(t,e,n,i,r){if(!to())return _n(new Co("operation-not-supported-in-this-environment"));if(t.sa&&!r)return _n(t.sa);var o=null,a=t.sc();return i=i().then(function(){if(xc(t),!r)return t.getIdToken().then(function(){})}).then(function(){return t.Ha=a,gc(t)}).then(function(e){return t.Ya&&(e=t.Ya,e=e.h.set(Fc,t.A(),e.j)),e}).then(function(){return t.v.ac(e,n,a)}).g(function(e){if(o=e,t.Ya)return Wc(t.Ya);throw o}).then(function(){if(o)throw o}),t.c(i,r)},xc=function(t){if(!t.v||!t.Kc){if(t.v&&!t.Kc)throw new Co("internal-error");throw new Co("auth-domain-config-required")}};sc.prototype.ue=function(t,e){var n=this;this.K&&(this.K.cancel(),this.K=null);var i=null,r=this.getIdToken().then(function(i){return Da(n.f,{requestUri:t,sessionId:e,idToken:i})}).then(function(t){return i=Oc(n,t,"link"),Dc(n,t)}).then(function(){return i});return this.c(r)},sc.prototype.ve=function(t,e){var n=this;this.K&&(this.K.cancel(),this.K=null);var i=null,r=Dn().then(function(){return Vo(_a(n.f,{requestUri:t,sessionId:e}),n.uid)}).then(function(t){return i=Oc(n,t,"reauthenticate"),Pc(n,t),n.sa=null,n.reload()}).then(function(){return i});return this.c(r,!0)},sc.prototype.sendEmailVerification=function(t){var e=this,n=null;return this.c(this.getIdToken().then(function(e){return n=e,void 0===t||bt(t)?{}:Qs(new Zs(t))}).then(function(t){return e.f.sendEmailVerification(n,t)}).then(function(t){if(e.email!=t)return e.reload()}).then(function(){}))},sc.prototype.c=function(t,e){var n=this,i=Uc(this,t,e);return this.J.push(i),Vn(i,function(){ot(n.J,i)}),i};var Uc=function(t,e,n){return t.sa&&!n?(e.cancel(),_n(t.sa)):e.g(function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.sa||t.dispatchEvent(new ac("userInvalidated")),t.sa=e),e})};sc.prototype.toJSON=function(){return this.A()},sc.prototype.A=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,providerData:[],apiKey:this.m,appName:this.o,authDomain:this.B,stsTokenManager:this.ra.A(),redirectEventId:this.Ha||null};return this.metadata&&Tt(t,this.metadata.A()),Q(this.providerData,function(e){t.providerData.push(To(e))}),t};var Vc=function(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName},n={};if(!(t.stsTokenManager&&t.stsTokenManager.accessToken&&t.stsTokenManager.expirationTime))return null;n.idToken=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null,n.expiresIn=(t.stsTokenManager.expirationTime-b())/1e3;var i=new sc(e,n,t);return t.providerData&&Q(t.providerData,function(t){t&&kc(i,Io(t))}),t.redirectEventId&&(i.Ha=t.redirectEventId),i},Mc=function(t,e,n,i){var r=new sc(t,e);return n&&(r.Ya=n),i&&cc(r,i),r.reload().then(function(){return r})},jc=function(t){this.j=t,this.h=gu()},Fc={name:"redirectUser",D:"session"},Wc=function(t){return t.h.remove(Fc,t.j)},Kc=function(t,e){return t.h.get(Fc,t.j).then(function(t){return t&&e&&(t.authDomain=e),Vc(t||{})})},Xc=function(t,e){this.j=t,this.h=e||gu(),this.O=null,this.Jd=this.Bd(),this.h.addListener(Bc("local"),this.j,m(this.vg,this))};Xc.prototype.vg=function(){var t=this,e=Bc("local");$c(this,function(){return Dn().then(function(){return t.O&&"local"!=t.O.D?t.h.get(e,t.j):null}).then(function(n){if(n)return qc(t,"local").then(function(){t.O=e})})})};var qc=function(t,e){var n,i=[];for(n in pu)pu[n]!==e&&i.push(t.h.remove(Bc(pu[n]),t.j));return i.push(t.h.remove(Hc,t.j)),xn(i)};Xc.prototype.Bd=function(){var t=this,e=Bc("local"),n=Bc("session"),i=Bc("none");return this.h.get(n,this.j).then(function(r){return r?n:t.h.get(i,t.j).then(function(n){return n?i:t.h.get(e,t.j).then(function(n){return n?e:t.h.get(Hc,t.j).then(function(t){return t?Bc(t):e})})})}).then(function(e){return t.O=e,qc(t,e.D)}).g(function(){t.O||(t.O=e)})};var Hc={name:"persistence",D:"session"},Bc=function(t){return{name:"authUser",D:t}};Xc.prototype.setPersistence=function(t){var e=null,n=this;return vu(t),$c(this,function(){return t!=n.O.D?n.h.get(n.O,n.j).then(function(i){return e=i,qc(n,t)}).then(function(){if(n.O=Bc(t),e)return n.h.set(n.O,e,n.j)}):Dn()})};var Gc=function(t){return $c(t,function(){return t.h.set(Hc,t.O.D,t.j)})},Yc=function(t,e){return $c(t,function(){return t.h.set(t.O,e.A(),t.j)})},zc=function(t){return $c(t,function(){return t.h.remove(t.O,t.j)})},Jc=function(t,e){return $c(t,function(){return t.h.get(t.O,t.j).then(function(t){return t&&e&&(t.authDomain=e),Vc(t||{})})})},$c=function(t,e){return t.Jd=t.Jd.then(e,e),t.Jd},Zc=function(t){if(this.Ea=!1,yo(this,"app",t),!this.i().options||!this.i().options.apiKey)throw new Co("invalid-api-key");t=e.SDK_VERSION?Jr(e.SDK_VERSION):null,this.f=new ua(this.i().options&&this.i().options.apiKey,Or(Cr),t),this.J=[],this.Ka=[],this.Fb=[],this.cg=e.INTERNAL.createSubscribe(m(this.Sf,this)),this.kc=void 0,this.eg=e.INTERNAL.createSubscribe(m(this.Uf,this)),oh(this,null),t=this.i().options.apiKey;var n=this.i().name;this.na=new Xc(t+":"+n),t=this.i().options.apiKey,n=this.i().name,this.zb=new jc(t+":"+n),this.oc=this.c(sh(this)),this.ya=this.c(uh(this)),this.Cc=!1,this.ud=m(this.wg,this),this.ef=m(this.pb,this),this.Gb=m(this.wd,this),this.cf=m(this.Of,this),this.df=m(this.Pf,this),ih(this),this.INTERNAL={},this.INTERNAL.delete=m(this.delete,this),this.INTERNAL.logFramework=m(this.$f,this),this.Oa=0,Pi.call(this),eh(this),this.M=[]};y(Zc,Pi);var Qc=function(t){se.call(this,"languageCodeChanged"),this.languageCode=t};y(Qc,se);var th=function(t){se.call(this,"frameworkChanged"),this.Ff=t};y(th,se),Zc.prototype.setPersistence=function(t){return t=this.na.setPersistence(t),this.c(t)},Zc.prototype.Cb=function(t){this.ia===t||this.Ea||(this.ia=t,da(this.f,this.ia),this.dispatchEvent(new Qc(this.ia)))},Zc.prototype.useDeviceLanguage=function(){var t=i.navigator;this.Cb(t?t.languages&&t.languages[0]||t.language||t.userLanguage||null:null)},Zc.prototype.$f=function(t){this.M.push(t),pa(this.f,e.SDK_VERSION?Jr(e.SDK_VERSION,this.M):null),this.dispatchEvent(new th(this.M))};var eh=function(t){Object.defineProperty(t,"lc",{get:function(){return this.ia},set:function(t){this.Cb(t)},enumerable:!1}),t.ia=null};Zc.prototype.toJSON=function(){return{apiKey:this.i().options.apiKey,authDomain:this.i().options.authDomain,appName:this.i().name,currentUser:hh(this)&&hh(this).A()}};var nh=function(t){return t.Af||_n(new Co("auth-domain-config-required"))},ih=function(t){var e=t.i().options.authDomain,n=t.i().options.apiKey;e&&to()&&(t.Af=t.oc.then(function(){if(!t.Ea){if(t.v=Bu(e,n,t.i().name),t.v.subscribe(t),hh(t)&&bc(hh(t)),t.Za){bc(t.Za);var i=t.Za;i.Cb(t.ia),uc(i,t),i=t.Za,cc(i,t.M),hc(i,t),t.Za=null}return t.v}}))};t=Zc.prototype,t.ke=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.la==e&&!!this.ka;default:return!1}},t.bb=function(t,e,n,i){"signInViaPopup"==t&&this.la==i&&(n&&this.Va?this.Va(n):e&&!n&&this.ka&&this.ka(e),this.K&&(this.K.cancel(),this.K=null),delete this.ka,delete this.Va)},t.Nb=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.la==e&&this.ka?m(this.Cf,this):null},t.Cf=function(t,e){var n=this;t={requestUri:t,sessionId:e},this.K&&(this.K.cancel(),this.K=null);var i=null,r=null,o=Oa(n.f,t).then(function(t){return i=na(t),r=au(t),t});return t=n.oc.then(function(){return o}).then(function(t){return rh(n,t)}).then(function(){return Io({user:hh(n),credential:i,additionalUserInfo:r,operationType:"signIn"})}),this.c(t)},t.sc=function(){return so()},t.signInWithPopup=function(t){if(!to())return _n(new Co("operation-not-supported-in-this-environment"));var n=this,i=So(t.providerId),r=this.sc(),o=null;(!io()||Hr())&&this.i().options.authDomain&&t.isOAuthProvider&&(o=Is(this.i().options.authDomain,this.i().options.apiKey,this.i().name,"signInViaPopup",t,null,r,e.SDK_VERSION||null));var a=jr(o,i&&i.Zb,i&&i.Yb);return i=nh(this).then(function(e){return e.$b(a,"signInViaPopup",t,r,!!o)}).then(function(){return new Sn(function(t,e){n.bb("signInViaPopup",null,new Co("cancelled-popup-request"),n.la),n.ka=t,n.Va=e,n.la=r,n.K=n.v.ec(n,"signInViaPopup",a,r)})}).then(function(t){return a&&Mr(a),t?Io(t):null}).g(function(t){throw a&&Mr(a),t}),this.c(i)},t.signInWithRedirect=function(t){if(!to())return _n(new Co("operation-not-supported-in-this-environment"));var e=this,n=nh(this).then(function(){return Gc(e.na)}).then(function(){return e.v.ac("signInViaRedirect",t)});return this.c(n)},t.getRedirectResult=function(){if(!to())return _n(new Co("operation-not-supported-in-this-environment"));var t=this,e=nh(this).then(function(){return t.v.getRedirectResult()}).then(function(t){return t?Io(t):null});return this.c(e)};var rh=function(t,e){var n={};return n.apiKey=t.i().options.apiKey,n.authDomain=t.i().options.authDomain,n.appName=t.i().name,t.oc.then(function(){return Mc(n,e,t.zb,ct(t.M))}).then(function(e){return hh(t)&&e.uid==hh(t).uid?(hh(t).copy(e),t.pb(e)):(oh(t,e),bc(e),t.pb(e))}).then(function(){t.Ta()})},oh=function(t,e){hh(t)&&(mc(hh(t),t.ef),Ee(hh(t),"tokenChanged",t.Gb),Ee(hh(t),"userDeleted",t.cf),Ee(hh(t),"userInvalidated",t.df),pc(hh(t))),e&&(e.Rc.push(t.ef),we(e,"tokenChanged",t.Gb),we(e,"userDeleted",t.cf),we(e,"userInvalidated",t.df),0<t.Oa&&dc(e)),yo(t,"currentUser",e),e&&(e.Cb(t.ia),uc(e,t),cc(e,t.M),hc(e,t))};Zc.prototype.signOut=function(){var t=this,e=this.ya.then(function(){return hh(t)?(oh(t,null),zc(t.na).then(function(){t.Ta()})):Dn()});return this.c(e)};var ah=function(t){var e=t.i().options.authDomain;return e=Kc(t.zb,e).then(function(e){return(t.Za=e)&&(e.Ya=t.zb),Wc(t.zb)}),t.c(e)},sh=function(t){var e=t.i().options.authDomain,n=ah(t).then(function(){return Jc(t.na,e)}).then(function(e){return e?(e.Ya=t.zb,t.Za&&(t.Za.Ha||null)==(e.Ha||null)?e:e.reload().then(function(){return Yc(t.na,e).then(function(){return e})}).g(function(n){return"auth/network-request-failed"==n.code?e:zc(t.na)})):null}).then(function(e){oh(t,e||null)});return t.c(n)},uh=function(t){return t.oc.then(function(){return t.getRedirectResult()}).g(function(){}).then(function(){if(!t.Ea)return t.ud()}).g(function(){}).then(function(){if(!t.Ea){t.Cc=!0;var e=t.na;e.h.addListener(Bc("local"),e.j,t.ud)}})};t=Zc.prototype,t.wg=function(){var t=this,e=this.i().options.authDomain;return Jc(this.na,e).then(function(e){if(!t.Ea){var n;if(n=hh(t)&&e){n=hh(t).uid;var i=e.uid;n=void 0!==n&&null!==n&&""!==n&&void 0!==i&&null!==i&&""!==i&&n==i}if(n)return hh(t).copy(e),hh(t).getIdToken();(hh(t)||e)&&(oh(t,e),e&&(bc(e),e.Ya=t.zb),t.v&&t.v.subscribe(t),t.Ta())}})},t.pb=function(t){return Yc(this.na,t)},t.wd=function(){this.Ta(),this.pb(hh(this))},t.Of=function(){this.signOut()},t.Pf=function(){this.signOut()};var ch=function(t,e){var n=null,i=null;return t.c(e.then(function(e){return n=na(e),i=au(e),rh(t,e)}).then(function(){return Io({user:hh(t),credential:n,additionalUserInfo:i,operationType:"signIn"})}))};t=Zc.prototype,t.Sf=function(t){var e=this;this.addAuthTokenListener(function(){t.next(hh(e))})},t.Uf=function(t){var e=this;fh(this,function(){t.next(hh(e))})},t.onIdTokenChanged=function(t,n,i){var r=this;return this.Cc&&e.Promise.resolve().then(function(){f(t)?t(hh(r)):f(t.next)&&t.next(hh(r))}),this.cg(t,n,i)},t.onAuthStateChanged=function(t,n,i){var r=this;return this.Cc&&e.Promise.resolve().then(function(){r.kc=r.getUid(),f(t)?t(hh(r)):f(t.next)&&t.next(hh(r))}),this.eg(t,n,i)},t.If=function(t){var e=this,n=this.ya.then(function(){return hh(e)?hh(e).getIdToken(t).then(function(t){return{accessToken:t}}):null});return this.c(n)},t.signInWithCustomToken=function(t){var e=this;return this.ya.then(function(){return ch(e,os(e.f,ts,{token:t}))}).then(function(t){return t=t.user,Ac(t,"isAnonymous",!1),e.pb(t)}).then(function(){return hh(e)})},t.signInWithEmailAndPassword=function(t,e){var n=this;return this.ya.then(function(){return ch(n,os(n.f,es,{email:t,password:e}))}).then(function(t){return t.user})},t.createUserWithEmailAndPassword=function(t,e){var n=this;return this.ya.then(function(){return ch(n,os(n.f,Va,{email:t,password:e}))}).then(function(t){return t.user})},t.signInWithCredential=function(t){return this.signInAndRetrieveDataWithCredential(t).then(function(t){return t.user})},t.signInAndRetrieveDataWithCredential=function(t){var e=this;return this.ya.then(function(){return ch(e,t.Ob(e.f))})},t.signInAnonymously=function(){var t=this;return this.ya.then(function(){var e=hh(t);return e&&e.isAnonymous?e:ch(t,t.f.signInAnonymously()).then(function(e){return e=e.user,Ac(e,"isAnonymous",!0),t.pb(e)}).then(function(){return hh(t)})})},t.i=function(){return this.app};var hh=function(t){return t.currentUser};Zc.prototype.getUid=function(){return hh(this)&&hh(this).uid||null};var lh=function(t){return hh(t)&&hh(t)._lat||null};t=Zc.prototype,t.Ta=function(){if(this.Cc){for(var t=0;t<this.Ka.length;t++)this.Ka[t]&&this.Ka[t](lh(this));if(this.kc!==this.getUid()&&this.Fb.length)for(this.kc=this.getUid(),t=0;t<this.Fb.length;t++)this.Fb[t]&&this.Fb[t](lh(this))}},t.pf=function(t){this.addAuthTokenListener(t),0<++this.Oa&&hh(this)&&dc(hh(this))},t.jg=function(t){var e=this;Q(this.Ka,function(n){n==t&&e.Oa--}),0>this.Oa&&(this.Oa=0),0==this.Oa&&hh(this)&&pc(hh(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.Ka.push(t),this.c(this.ya.then(function(){e.Ea||rt(e.Ka,t)&&t(lh(e))}))},t.removeAuthTokenListener=function(t){st(this.Ka,function(e){return e==t})};var fh=function(t,e){t.Fb.push(e),t.c(t.ya.then(function(){!t.Ea&&rt(t.Fb,e)&&t.kc!==t.getUid()&&(t.kc=t.getUid(),e(lh(t)))}))};t=Zc.prototype,t.delete=function(){this.Ea=!0;for(var t=0;t<this.J.length;t++)this.J[t].cancel("app-deleted");return this.J=[],this.na&&(t=this.na,t.h.removeListener(Bc("local"),t.j,this.ud)),this.v&&this.v.unsubscribe(this),e.Promise.resolve()},t.c=function(t){var e=this;return this.J.push(t),Vn(t,function(){ot(e.J,t)}),t},t.fetchProvidersForEmail=function(t){return this.c(ka(this.f,t))},t.verifyPasswordResetCode=function(t){return this.checkActionCode(t).then(function(t){return t.data.email})},t.confirmPasswordReset=function(t,e){return this.c(this.f.confirmPasswordReset(t,e).then(function(){}))},t.checkActionCode=function(t){return this.c(this.f.checkActionCode(t).then(function(t){return new nu(t)}))},t.applyActionCode=function(t){return this.c(this.f.applyActionCode(t).then(function(){}))},t.sendPasswordResetEmail=function(t,e){var n=this;return this.c(Dn().then(function(){return void 0===e||bt(e)?{}:Qs(new Zs(e))}).then(function(e){return n.f.sendPasswordResetEmail(t,e)}).then(function(){}))},t.signInWithPhoneNumber=function(t,e){return this.c(eu(this,t,e,m(this.signInAndRetrieveDataWithCredential,this)))};var dh=function(t,e,n,i){t:{n=Array.prototype.slice.call(n);for(var r=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new Co("internal-error","Argument validator encountered a required argument after an optional argument.");r++}if(o=e.length,n.length<r||o<n.length)i="Expected "+(r==o?1==r?"1 argument":r+" arguments":r+"-"+o+" arguments")+" but got "+n.length+".";else{for(r=0;r<n.length;r++)if(o=e[r].optional&&void 0===n[r],!e[r].W(n[r])&&!o){if(e=e[r],0>r||r>=ph.length)throw new Co("internal-error","Argument validator received an unsupported number of arguments.");n=ph[r],i=(i?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.V+".";break t}i=null}}if(i)throw new Co("argument-error",t+" failed: "+i)},ph="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" "),vh=function(t,e){return{name:t||"",V:"a valid string",optional:!!e,W:o}},mh=function(){return{name:"opt_forceRefresh",V:"a boolean",optional:!0,W:a}},gh=function(t,e){return{name:t||"",V:"a valid object",optional:!!e,W:d}},bh=function(t,e){return{name:t||"",V:"a function",optional:!!e,W:f}},yh=function(t,e){return{name:t||"",V:"null",optional:!!e,W:c}},wh=function(){return{name:"",V:"an HTML element",optional:!1,W:function(t){return!!(t&&t instanceof Element)}}},Ih=function(){return{name:"auth",V:"an instance of Firebase Auth",optional:!0,W:function(t){return!!(t&&t instanceof Zc)}}},Th=function(){return{name:"app",V:"an instance of Firebase App",optional:!0,W:function(t){return!!(t&&t instanceof e.app.App)}}},kh=function(t){return{name:t?t+"Credential":"credential",V:t?"a valid "+t+" credential":"a valid credential",optional:!1,W:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.Ob||!n)}}},Eh=function(){return{name:"authProvider",V:"a valid Auth provider",optional:!1,W:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}},Ah=function(){return{name:"applicationVerifier",V:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,W:function(t){return!!(t&&o(t.type)&&f(t.verify))}}},Nh=function(t,e,n,i){return{name:n||"",V:t.V+" or "+e.V,optional:!!i,W:function(n){return t.W(n)||e.W(n)}}},Ph=function(t,e){for(var n in e){var i=e[n].name;t[i]=Ch(i,t[n],e[n].a)}},Sh=function(t,e,n,i){t[e]=Ch(e,n,i)},Ch=function(t,e,n){if(!n)return e;var i=Rh(t);t=function(){var t=Array.prototype.slice.call(arguments);return dh(i,n,t),e.apply(this,t)};for(var r in e)t[r]=e[r];for(r in e.prototype)t.prototype[r]=e.prototype[r];return t},Rh=function(t){return t=t.split("."),t[t.length-1]};Ph(Zc.prototype,{applyActionCode:{name:"applyActionCode",a:[vh("code")]},checkActionCode:{name:"checkActionCode",a:[vh("code")]},confirmPasswordReset:{name:"confirmPasswordReset",a:[vh("code"),vh("newPassword")]},createUserWithEmailAndPassword:{name:"createUserWithEmailAndPassword",a:[vh("email"),vh("password")]},fetchProvidersForEmail:{name:"fetchProvidersForEmail",a:[vh("email")]},getRedirectResult:{name:"getRedirectResult",a:[]},onAuthStateChanged:{name:"onAuthStateChanged",a:[Nh(gh(),bh(),"nextOrObserver"),bh("opt_error",!0),bh("opt_completed",!0)]},onIdTokenChanged:{name:"onIdTokenChanged",a:[Nh(gh(),bh(),"nextOrObserver"),bh("opt_error",!0),bh("opt_completed",!0)]},sendPasswordResetEmail:{name:"sendPasswordResetEmail",a:[vh("email"),Nh(gh("opt_actionCodeSettings",!0),yh(null,!0),"opt_actionCodeSettings",!0)]},setPersistence:{name:"setPersistence",a:[vh("persistence")]},signInAndRetrieveDataWithCredential:{name:"signInAndRetrieveDataWithCredential",a:[kh()]},signInAnonymously:{name:"signInAnonymously",a:[]},signInWithCredential:{name:"signInWithCredential",a:[kh()]},signInWithCustomToken:{name:"signInWithCustomToken",a:[vh("token")]},signInWithEmailAndPassword:{name:"signInWithEmailAndPassword",a:[vh("email"),vh("password")]},signInWithPhoneNumber:{name:"signInWithPhoneNumber",a:[vh("phoneNumber"),Ah()]},signInWithPopup:{name:"signInWithPopup",a:[Eh()]},signInWithRedirect:{name:"signInWithRedirect",a:[Eh()]},signOut:{name:"signOut",a:[]},toJSON:{name:"toJSON",a:[vh(null,!0)]},useDeviceLanguage:{name:"useDeviceLanguage",a:[]},verifyPasswordResetCode:{name:"verifyPasswordResetCode",a:[vh("code")]}}),function(t,e){for(var n in e){var i=e[n].name;if(i!==n){var r=e[n].rf;Object.defineProperty(t,i,{get:function(){return this[n]},set:function(t){dh(i,[r],[t],!0),this[n]=t},enumerable:!0})}}}(Zc.prototype,{lc:{name:"languageCode",rf:Nh(vh(),yh(),"languageCode")}}),Zc.Persistence=pu,Zc.Persistence.LOCAL="local",Zc.Persistence.SESSION="session",Zc.Persistence.NONE="none",Ph(sc.prototype,{delete:{name:"delete",a:[]},getIdToken:{name:"getIdToken",a:[mh()]},getToken:{name:"getToken",a:[mh()]},linkAndRetrieveDataWithCredential:{name:"linkAndRetrieveDataWithCredential",a:[kh()]},linkWithCredential:{name:"linkWithCredential",a:[kh()]},linkWithPhoneNumber:{name:"linkWithPhoneNumber",a:[vh("phoneNumber"),Ah()]},linkWithPopup:{name:"linkWithPopup",a:[Eh()]},linkWithRedirect:{name:"linkWithRedirect",a:[Eh()]},reauthenticateAndRetrieveDataWithCredential:{name:"reauthenticateAndRetrieveDataWithCredential",a:[kh()]},reauthenticateWithCredential:{name:"reauthenticateWithCredential",a:[kh()]},reauthenticateWithPhoneNumber:{name:"reauthenticateWithPhoneNumber",a:[vh("phoneNumber"),Ah()]},reauthenticateWithPopup:{name:"reauthenticateWithPopup",a:[Eh()]},reauthenticateWithRedirect:{name:"reauthenticateWithRedirect",a:[Eh()]},reload:{name:"reload",a:[]},sendEmailVerification:{name:"sendEmailVerification",a:[Nh(gh("opt_actionCodeSettings",!0),yh(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",a:[vh(null,!0)]},unlink:{name:"unlink",a:[vh("provider")]},updateEmail:{name:"updateEmail",a:[vh("email")]},updatePassword:{name:"updatePassword",a:[vh("password")]},updatePhoneNumber:{name:"updatePhoneNumber",a:[kh("phone")]},updateProfile:{name:"updateProfile",a:[gh("profile")]}}),Ph(Sn.prototype,{g:{name:"catch"},then:{name:"then"}}),Ph(tu.prototype,{confirm:{name:"confirm",a:[vh("verificationCode")]}}),Sh($o,"credential",function(t,e){return new Jo(t,e)},[vh("email"),vh("password")]),Ph(Ko.prototype,{addScope:{name:"addScope",a:[vh("scope")]},setCustomParameters:{name:"setCustomParameters",a:[gh("customOAuthParameters")]}}),Sh(Ko,"credential",Xo,[Nh(vh(),gh(),"token")]),Ph(qo.prototype,{addScope:{name:"addScope",a:[vh("scope")]},setCustomParameters:{name:"setCustomParameters",a:[gh("customOAuthParameters")]}}),Sh(qo,"credential",Ho,[Nh(vh(),gh(),"token")]),Ph(Bo.prototype,{addScope:{name:"addScope",a:[vh("scope")]},setCustomParameters:{name:"setCustomParameters",a:[gh("customOAuthParameters")]}}),Sh(Bo,"credential",Go,[Nh(vh(),Nh(gh(),yh()),"idToken"),Nh(vh(),yh(),"accessToken",!0)]),Ph(Yo.prototype,{setCustomParameters:{name:"setCustomParameters",a:[gh("customOAuthParameters")]}}),Sh(Yo,"credential",zo,[Nh(vh(),gh(),"token"),vh("secret",!0)]),Ph(Wo.prototype,{addScope:{name:"addScope",a:[vh("scope")]},credential:{name:"credential",a:[Nh(vh(),yh(),"idToken",!0),Nh(vh(),yh(),"accessToken",!0)]},setCustomParameters:{name:"setCustomParameters",a:[gh("customOAuthParameters")]}}),Sh(ta,"credential",ea,[vh("verificationId"),vh("verificationCode")]),Ph(ta.prototype,{verifyPhoneNumber:{name:"verifyPhoneNumber",a:[vh("phoneNumber"),Ah()]}}),Ph(Co.prototype,{toJSON:{name:"toJSON",a:[vh(null,!0)]}}),Ph(ra.prototype,{toJSON:{name:"toJSON",a:[vh(null,!0)]}}),Ph(Lo.prototype,{toJSON:{name:"toJSON",a:[vh(null,!0)]}}),Ph(Ds.prototype,{clear:{name:"clear",a:[]},render:{name:"render",a:[]},verify:{name:"verify",a:[]}}),function(){if(void 0===e||!e.INTERNAL||!e.INTERNAL.registerService)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={Auth:Zc,Error:Co};Sh(t,"EmailAuthProvider",$o,[]),Sh(t,"FacebookAuthProvider",Ko,[]),Sh(t,"GithubAuthProvider",qo,[]),Sh(t,"GoogleAuthProvider",Bo,[]),Sh(t,"TwitterAuthProvider",Yo,[]),Sh(t,"OAuthProvider",Wo,[vh("providerId")]),Sh(t,"PhoneAuthProvider",ta,[Ih()]),Sh(t,"RecaptchaVerifier",Ds,[Nh(vh(),wh(),"recaptchaContainer"),gh("recaptchaParameters",!0),Th()]),e.INTERNAL.registerService("auth",function(t,e){return t=new Zc(t),e({INTERNAL:{getUid:m(t.getUid,t),getToken:m(t.If,t),addAuthTokenListener:m(t.pf,t),removeAuthTokenListener:m(t.jg,t)}}),t},t,function(t,e){if("create"===t)try{e.auth()}catch(t){}}),e.INTERNAL.extendNamespace({User:sc})}()}).call(this)}).call(void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}).call(e,n(19))}},[75])}catch(t){throw Error("Cannot instantiate firebase-auth.js - be sure to load firebase-app.js first.")}

/*!
 * @license Firebase v4.6.0
 * Build: rev-f5e674c
 * Terms: https://firebase.google.com/terms/
 */
try{webpackJsonpFirebase([0],[,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(0),o=n(0),a=n(0),s=n(0),u=n(0),l=n(12),h=n(0);t.LUIDGenerator=function(){var e=1;return function(){return e++}}(),t.sha1=function(e){var t=s.stringToByteArray(e),n=new a.Sha1;n.update(t);var r=n.digest();return o.base64.encodeByteArray(r)};var c=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n="",r=0;r<e.length;r++)Array.isArray(e[r])||e[r]&&"object"==typeof e[r]&&"number"==typeof e[r].length?n+=c.apply(null,e[r]):"object"==typeof e[r]?n+=u.stringify(e[r]):n+=e[r],n+=" ";return n};t.logger=null;var p=!0;t.enableLogging=function(e,n){r.assert(!n||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?("undefined"!=typeof console&&("function"==typeof console.log?t.logger=console.log.bind(console):"object"==typeof console.log&&(t.logger=function(e){console.log(e)})),n&&l.SessionStorage.set("logging_enabled",!0)):"function"==typeof e?t.logger=e:(t.logger=null,l.SessionStorage.remove("logging_enabled"))},t.log=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(!0===p&&(p=!1,null===t.logger&&!0===l.SessionStorage.get("logging_enabled")&&t.enableLogging(!0)),t.logger){var r=c.apply(null,e);t.logger(r)}},t.logWrapper=function(e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];t.log.apply(void 0,[e].concat(n))}},t.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if("undefined"!=typeof console){var n="FIREBASE INTERNAL ERROR: "+c.apply(void 0,e);void 0!==console.error?console.error(n):console.log(n)}},t.fatal=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=c.apply(void 0,e);throw Error("FIREBASE FATAL ERROR: "+n)},t.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if("undefined"!=typeof console){var n="FIREBASE WARNING: "+c.apply(void 0,e);void 0!==console.warn?console.warn(n):console.log(n)}},t.warnIfPageIsSecure=function(){"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&t.warn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},t.warnAboutUnsupportedMethod=function(e){t.warn(e+" is unsupported and will likely change soon.  Please do not use.")},t.isInvalidJSONNumber=function(e){return"number"==typeof e&&(e!=e||e==Number.POSITIVE_INFINITY||e==Number.NEGATIVE_INFINITY)},t.executeWhenDOMReady=function(e){if(h.isNodeSdk()||"complete"===document.readyState)e();else{var t=!1,n=function(){if(!document.body)return void setTimeout(n,Math.floor(10));t||(t=!0,e())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}},t.MIN_NAME="[MIN_NAME]",t.MAX_NAME="[MAX_NAME]",t.nameCompare=function(e,n){if(e===n)return 0;if(e===t.MIN_NAME||n===t.MAX_NAME)return-1;if(n===t.MIN_NAME||e===t.MAX_NAME)return 1;var r=t.tryParseInt(e),i=t.tryParseInt(n);return null!==r?null!==i?r-i==0?e.length-n.length:r-i:-1:null!==i?1:e<n?-1:1},t.stringCompare=function(e,t){return e===t?0:e<t?-1:1},t.requireKey=function(e,t){if(t&&e in t)return t[e];throw Error("Missing required key ("+e+") in object: "+u.stringify(t))},t.ObjectToUniqueKey=function(e){if("object"!=typeof e||null===e)return u.stringify(e);var n=[];for(var r in e)n.push(r);n.sort();for(var i="{",o=0;o<n.length;o++)0!==o&&(i+=","),i+=u.stringify(n[o]),i+=":",i+=t.ObjectToUniqueKey(e[n[o]]);return i+="}"},t.splitStringBySize=function(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r},t.each=function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;++n)t(n,e[n]);else i.forEach(e,function(e,n){return t(n,e)})},t.bindCallback=function(e,t){return t?e.bind(t):e},t.doubleToIEEE754String=function(e){r.assert(!t.isInvalidJSONNumber(e),"Invalid JSON number");var n,i,o,a,s,u,l;for(0===e?(i=0,o=0,n=1/e==-1/0?1:0):(n=e<0,e=Math.abs(e),e>=Math.pow(2,-1022)?(a=Math.min(Math.floor(Math.log(e)/Math.LN2),1023),i=a+1023,o=Math.round(e*Math.pow(2,52-a)-Math.pow(2,52))):(i=0,o=Math.round(e/Math.pow(2,-1074)))),u=[],s=52;s;s-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(s=11;s;s-=1)u.push(i%2?1:0),i=Math.floor(i/2);u.push(n?1:0),u.reverse(),l=u.join("");var h="";for(s=0;s<64;s+=8){var c=parseInt(l.substr(s,8),2).toString(16);1===c.length&&(c="0"+c),h+=c}return h.toLowerCase()},t.isChromeExtensionContentScript=function(){return!("object"!=typeof window||!window.chrome||!window.chrome.extension||/^chrome/.test(window.location.href))},t.isWindowsStoreApp=function(){return"object"==typeof Windows&&"object"==typeof Windows.UI},t.errorForServerCode=function(e,t){var n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==e?n="Client doesn't have permission to access the desired data.":"unavailable"==e&&(n="The service is unavailable");var r=Error(e+" at "+t.path+": "+n);return r.code=e.toUpperCase(),r},t.e=RegExp("^-?\\d{1,10}$"),t.tryParseInt=function(e){if(t.e.test(e)){var n=+e;if(n>=-2147483648&&n<=2147483647)return n}return null},t.exceptionGuard=function(e){try{e()}catch(e){setTimeout(function(){var n=e.stack||"";throw t.warn("Exception was thrown by user callback.",n),e},Math.floor(0))}},t.callUserCallback=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];"function"==typeof e&&t.exceptionGuard(function(){e.apply(void 0,n)})},t.beingCrawled=function(){return("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},t.exportPropGetter=function(e,t,n){Object.defineProperty(e,t,{get:n})},t.setTimeoutNonBlocking=function(e,t){var n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(0),o=function(){function e(e,t){if(void 0===t){this.n=e.split("/");for(var n=0,r=0;r<this.n.length;r++)this.n[r].length>0&&(this.n[n]=this.n[r],n++);this.n.length=n,this.i=0}else this.n=e,this.i=t}return Object.defineProperty(e,"Empty",{get:function(){return new e("")},enumerable:!0,configurable:!0}),e.prototype.getFront=function(){return this.i>=this.n.length?null:this.n[this.i]},e.prototype.getLength=function(){return this.n.length-this.i},e.prototype.popFront=function(){var t=this.i;return t<this.n.length&&t++,new e(this.n,t)},e.prototype.getBack=function(){return this.i<this.n.length?this.n[this.n.length-1]:null},e.prototype.toString=function(){for(var e="",t=this.i;t<this.n.length;t++)""!==this.n[t]&&(e+="/"+this.n[t]);return e||"/"},e.prototype.toUrlEncodedString=function(){for(var e="",t=this.i;t<this.n.length;t++)""!==this.n[t]&&(e+="/"+encodeURIComponent(this.n[t]+""));return e||"/"},e.prototype.slice=function(e){return void 0===e&&(e=0),this.n.slice(this.i+e)},e.prototype.parent=function(){if(this.i>=this.n.length)return null;for(var t=[],n=this.i;n<this.n.length-1;n++)t.push(this.n[n]);return new e(t,0)},e.prototype.child=function(t){for(var n=[],r=this.i;r<this.n.length;r++)n.push(this.n[r]);if(t instanceof e)for(var r=t.i;r<t.n.length;r++)n.push(t.n[r]);else for(var i=t.split("/"),r=0;r<i.length;r++)i[r].length>0&&n.push(i[r]);return new e(n,0)},e.prototype.isEmpty=function(){return this.i>=this.n.length},e.relativePath=function(t,n){var r=t.getFront(),i=n.getFront();if(null===r)return n;if(r===i)return e.relativePath(t.popFront(),n.popFront());throw Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+t+")")},e.comparePaths=function(e,t){for(var n=e.slice(),i=t.slice(),o=0;o<n.length&&o<i.length;o++){var a=r.nameCompare(n[o],i[o]);if(0!==a)return a}return n.length===i.length?0:n.length<i.length?-1:1},e.prototype.equals=function(e){if(this.getLength()!==e.getLength())return!1;for(var t=this.i,n=e.i;t<=this.n.length;t++,n++)if(this.n[t]!==e.n[n])return!1;return!0},e.prototype.contains=function(e){var t=this.i,n=e.i;if(this.getLength()>e.getLength())return!1;for(;t<this.n.length;){if(this.n[t]!==e.n[n])return!1;++t,++n}return!0},e}();t.Path=o;var a=function(){function e(e,t){this.o=t,this.u=e.slice(),this.l=Math.max(1,this.u.length);for(var n=0;n<this.u.length;n++)this.l+=i.stringLength(this.u[n]);this.f()}return Object.defineProperty(e,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!0,configurable:!0}),e.prototype.push=function(e){this.u.length>0&&(this.l+=1),this.u.push(e),this.l+=i.stringLength(e),this.f()},e.prototype.pop=function(){var e=this.u.pop();this.l-=i.stringLength(e),this.u.length>0&&(this.l-=1)},e.prototype.f=function(){if(this.l>e.MAX_PATH_LENGTH_BYTES)throw Error(this.o+"has a key path longer than "+e.MAX_PATH_LENGTH_BYTES+" bytes ("+this.l+").");if(this.u.length>e.MAX_PATH_DEPTH)throw Error(this.o+"path specified exceeds the maximum depth that can be written ("+e.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},e.prototype.toErrorString=function(){return 0==this.u.length?"":"in property '"+this.u.join(".")+"'"},e}();t.ValidationPath=a},function(e,t,n){"use strict";function r(e){a=e}function i(e){s=e}var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var a,s,u=n(14),l=n(1),h=n(5),c=n(15);t.setNodeFromJSON=r,t.setMaxNode=i;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.compare=function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?l.nameCompare(e.name,t.name):i},t.prototype.isDefinedOn=function(e){return!e.getPriority().isEmpty()},t.prototype.indexedValueChanged=function(e,t){return!e.getPriority().equals(t.getPriority())},t.prototype.minPost=function(){return h.NamedNode.MIN},t.prototype.maxPost=function(){return new h.NamedNode(l.MAX_NAME,new c.LeafNode("[PRIORITY-POST]",s))},t.prototype.makePost=function(e,t){var n=a(e);return new h.NamedNode(t,new c.LeafNode("[PRIORITY-POST]",n))},t.prototype.toString=function(){return".priority"},t}(u.Index);t.PriorityIndex=p,t.PRIORITY_INDEX=new p},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(0),a=n(1),s=n(16),u=n(5),l=n(35),h=n(3),c=n(10),p=n(37),d=n(15),f=n(39),_=function(){function e(e,t,n){this._=e,this.y=t,this.g=n,this.m=null,this.y&&l.validatePriorityNode(this.y),this._.isEmpty()&&o.assert(!this.y||this.y.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(e,"EMPTY_NODE",{get:function(){return i||(i=new e(new s.SortedMap(f.NAME_COMPARATOR),null,p.IndexMap.Default))},enumerable:!0,configurable:!0}),e.prototype.isLeafNode=function(){return!1},e.prototype.getPriority=function(){return this.y||i},e.prototype.updatePriority=function(t){return this._.isEmpty()?this:new e(this._,t,this.g)},e.prototype.getImmediateChild=function(e){if(".priority"===e)return this.getPriority();var t=this._.get(e);return null===t?i:t},e.prototype.getChild=function(e){var t=e.getFront();return null===t?this:this.getImmediateChild(t).getChild(e.popFront())},e.prototype.hasChild=function(e){return null!==this._.get(e)},e.prototype.updateImmediateChild=function(t,n){if(o.assert(n,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(n);var r=new u.NamedNode(t,n),a=void 0,s=void 0,l=void 0;return n.isEmpty()?(a=this._.remove(t),s=this.g.removeFromIndexes(r,this._)):(a=this._.insert(t,n),s=this.g.addToIndexes(r,this._)),l=a.isEmpty()?i:this.y,new e(a,l,s)},e.prototype.updateChild=function(e,t){var n=e.getFront();if(null===n)return t;o.assert(".priority"!==e.getFront()||1===e.getLength(),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(e.popFront(),t);return this.updateImmediateChild(n,r)},e.prototype.isEmpty=function(){return this._.isEmpty()},e.prototype.numChildren=function(){return this._.count()},e.prototype.val=function(t){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(h.PRIORITY_INDEX,function(a,s){n[a]=s.val(t),r++,o&&e.e.test(a)?i=Math.max(i,+a):o=!1}),!t&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},e.prototype.hash=function(){if(null===this.m){var e="";this.getPriority().isEmpty()||(e+="priority:"+l.priorityHashText(this.getPriority().val())+":"),this.forEachChild(h.PRIORITY_INDEX,function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)}),this.m=""===e?"":a.sha1(e)}return this.m},e.prototype.getPredecessorChildName=function(e,t,n){var r=this.C(n);if(r){var i=r.getPredecessorKey(new u.NamedNode(e,t));return i?i.name:null}return this._.getPredecessorKey(e)},e.prototype.getFirstChildName=function(e){var t=this.C(e);if(t){var n=t.minKey();return n&&n.name}return this._.minKey()},e.prototype.getFirstChild=function(e){var t=this.getFirstChildName(e);return t?new u.NamedNode(t,this._.get(t)):null},e.prototype.getLastChildName=function(e){var t=this.C(e);if(t){var n=t.maxKey();return n&&n.name}return this._.maxKey()},e.prototype.getLastChild=function(e){var t=this.getLastChildName(e);return t?new u.NamedNode(t,this._.get(t)):null},e.prototype.forEachChild=function(e,t){var n=this.C(e);return n?n.inorderTraversal(function(e){return t(e.name,e.node)}):this._.inorderTraversal(t)},e.prototype.getIterator=function(e){return this.getIteratorFrom(e.minPost(),e)},e.prototype.getIteratorFrom=function(e,t){var n=this.C(t);if(n)return n.getIteratorFrom(e,function(e){return e});for(var r=this._.getIteratorFrom(e.name,u.NamedNode.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r},e.prototype.getReverseIterator=function(e){return this.getReverseIteratorFrom(e.maxPost(),e)},e.prototype.getReverseIteratorFrom=function(e,t){var n=this.C(t);if(n)return n.getReverseIteratorFrom(e,function(e){return e});for(var r=this._.getReverseIteratorFrom(e.name,u.NamedNode.Wrap),i=r.peek();null!=i&&t.compare(i,e)>0;)r.getNext(),i=r.peek();return r},e.prototype.compareTo=function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===t.MAX_NODE?-1:0},e.prototype.withIndex=function(t){if(t===c.KEY_INDEX||this.g.hasIndex(t))return this;var n=this.g.addIndex(t,this._);return new e(this._,this.y,n)},e.prototype.isIndexed=function(e){return e===c.KEY_INDEX||this.g.hasIndex(e)},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this._.count()===t._.count()){for(var n=this.getIterator(h.PRIORITY_INDEX),r=t.getIterator(h.PRIORITY_INDEX),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},e.prototype.C=function(e){return e===c.KEY_INDEX?null:this.g.get(""+e)},e.e=/^(0|[1-9]\d*)$/,e}();t.ChildrenNode=_;var y=function(e){function t(){return e.call(this,new s.SortedMap(f.NAME_COMPARATOR),_.EMPTY_NODE,p.IndexMap.Default)||this}return r(t,e),t.prototype.compareTo=function(e){return e===this?0:1},t.prototype.equals=function(e){return e===this},t.prototype.getPriority=function(){return this},t.prototype.getImmediateChild=function(e){return _.EMPTY_NODE},t.prototype.isEmpty=function(){return!1},t}(_);t.MaxNode=y,t.MAX_NODE=new y,Object.defineProperties(u.NamedNode,{MIN:{value:new u.NamedNode(a.MIN_NAME,_.EMPTY_NODE)},MAX:{value:new u.NamedNode(a.MAX_NAME,t.MAX_NODE)}}),c.KeyIndex.__EMPTY_NODE=_.EMPTY_NODE,d.LeafNode.__childrenNodeConstructor=_,l.setMaxNode(t.MAX_NODE),h.setMaxNode(t.MAX_NODE)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.name=e,this.node=t}return e.Wrap=function(t,n){return new e(t,n)},e}();t.NamedNode=r},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(0),o=n(1),a=n(0),s=n(0);t.N=/[\[\].#$\/\u0000-\u001F\u007F]/,t.P=/[\[\].#$\u0000-\u001F\u007F]/,t.S=10485760,t.isValidKey=function(e){return"string"==typeof e&&0!==e.length&&!t.N.test(e)},t.isValidPathString=function(e){return"string"==typeof e&&0!==e.length&&!t.P.test(e)},t.isValidRootPathString=function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),t.isValidPathString(e)},t.isValidPriority=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!o.isInvalidJSONNumber(e)||e&&"object"==typeof e&&i.contains(e,".sv")},t.validateFirebaseDataArg=function(e,n,r,i,o){o&&void 0===r||t.validateFirebaseData(a.errorPrefix(e,n,o),r,i)},t.validateFirebaseData=function(e,n,a){var u=a instanceof r.Path?new r.ValidationPath(a,e):a;if(void 0===n)throw Error(e+"contains undefined "+u.toErrorString());if("function"==typeof n)throw Error(e+"contains a function "+u.toErrorString()+" with contents = "+n);if(o.isInvalidJSONNumber(n))throw Error(e+"contains "+n+" "+u.toErrorString());if("string"==typeof n&&n.length>t.S/3&&s.stringLength(n)>t.S)throw Error(e+"contains a string greater than "+t.S+" utf8 bytes "+u.toErrorString()+" ('"+n.substring(0,50)+"...')");if(n&&"object"==typeof n){var l=!1,h=!1;if(i.forEach(n,function(n,r){if(".value"===n)l=!0;else if(".priority"!==n&&".sv"!==n&&(h=!0,!t.isValidKey(n)))throw Error(e+" contains an invalid key ("+n+") "+u.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');u.push(n),t.validateFirebaseData(e,r,u),u.pop()}),l&&h)throw Error(e+' contains ".value" child '+u.toErrorString()+" in addition to actual children.")}},t.validateFirebaseMergePaths=function(e,n){var i,o;for(i=0;i<n.length;i++){o=n[i];for(var a=o.slice(),s=0;s<a.length;s++)if(".priority"===a[s]&&s===a.length-1);else if(!t.isValidKey(a[s]))throw Error(e+"contains an invalid key ("+a[s]+") in path "+o+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}n.sort(r.Path.comparePaths);var u=null;for(i=0;i<n.length;i++){if(o=n[i],null!==u&&u.contains(o))throw Error(e+"contains a path "+u+" that is ancestor of another path "+o);u=o}},t.validateFirebaseMergeDataArg=function(e,n,o,s,u){if(!u||void 0!==o){var l=a.errorPrefix(e,n,u);if(!o||"object"!=typeof o||Array.isArray(o))throw Error(l+" must be an object containing the children to replace.");var h=[];i.forEach(o,function(e,n){var i=new r.Path(e);if(t.validateFirebaseData(l,n,s.child(i)),".priority"===i.getBack()&&!t.isValidPriority(n))throw Error(l+"contains an invalid value for '"+i+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");h.push(i)}),t.validateFirebaseMergePaths(l,h)}},t.validatePriority=function(e,n,r,i){if(!i||void 0!==r){if(o.isInvalidJSONNumber(r))throw Error(a.errorPrefix(e,n,i)+"is "+r+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!t.isValidPriority(r))throw Error(a.errorPrefix(e,n,i)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},t.validateEventType=function(e,t,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw Error(a.errorPrefix(e,t,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},t.validateKey=function(e,n,r,i){if(!(i&&void 0===r||t.isValidKey(r)))throw Error(a.errorPrefix(e,n,i)+'was an invalid key = "'+r+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},t.validatePathString=function(e,n,r,i){if(!(i&&void 0===r||t.isValidPathString(r)))throw Error(a.errorPrefix(e,n,i)+'was an invalid path = "'+r+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},t.validateRootPathString=function(e,n,r,i){r&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),t.validatePathString(e,n,r,i)},t.validateWritablePath=function(e,t){if(".info"===t.getFront())throw Error(e+" failed = Can't modify data under /.info/")},t.validateUrl=function(e,n,r){var i=""+r.path;if("string"!=typeof r.repoInfo.host||0===r.repoInfo.host.length||!t.isValidKey(r.repoInfo.namespace)||0!==i.length&&!t.isValidRootPathString(i))throw Error(a.errorPrefix(e,n,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},t.validateCredential=function(e,t,n,r){if((!r||void 0!==n)&&"string"!=typeof n)throw Error(a.errorPrefix(e,t,r)+"must be a valid credential (a string).")},t.validateBoolean=function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw Error(a.errorPrefix(e,t,r)+"must be a boolean.")},t.validateString=function(e,t,n,r){if((!r||void 0!==n)&&"string"!=typeof n)throw Error(a.errorPrefix(e,t,r)+"must be a valid string.")},t.validateObject=function(e,t,n,r){if(!(r&&void 0===n||n&&"object"==typeof n&&null!==n))throw Error(a.errorPrefix(e,t,r)+"must be a valid object.")},t.validateObjectContainsKey=function(e,t,n,r,o,s){if(!n||"object"!=typeof n||!i.contains(n,r)){if(o)return;throw Error(a.errorPrefix(e,t,o)+'must contain the key "'+r+'"')}if(s){var u=i.safeGet(n,r);if("number"===s&&"number"!=typeof u||"string"===s&&"string"!=typeof u||"boolean"===s&&"boolean"!=typeof u||"function"===s&&"function"!=typeof u||"object"===s&&"object"!=typeof u&&u)throw o?Error(a.errorPrefix(e,t,o)+'contains invalid value for key "'+r+'" (must be of type "'+s+'")'):Error(a.errorPrefix(e,t,o)+'must contain the key "'+r+'" with type "'+s+'"')}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(t.OperationType||(t.OperationType={}));var i=function(){function e(e,t,n,i){this.fromUser=e,this.fromServer=t,this.queryId=n,this.tagged=i,r.assert(!i||t,"Tagged queries must be from server.")}return e.User=new e(!0,!1,null,!1),e.Server=new e(!1,!0,null,!1),e.forServerTaggedQuery=function(t){return new e(!1,!0,t,!0)},e}();t.OperationSource=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,n,r,i){this.type=e,this.snapshotNode=t,this.childName=n,this.oldSnap=r,this.prevName=i}return e.valueChange=function(t){return new e(e.VALUE,t)},e.childAddedChange=function(t,n){return new e(e.CHILD_ADDED,n,t)},e.childRemovedChange=function(t,n){return new e(e.CHILD_REMOVED,n,t)},e.childChangedChange=function(t,n,r){return new e(e.CHILD_CHANGED,n,t,r)},e.childMovedChange=function(t,n){return new e(e.CHILD_MOVED,n,t)},e.CHILD_ADDED="child_added",e.CHILD_REMOVED="child_removed",e.CHILD_CHANGED="child_changed",e.CHILD_MOVED="child_moved",e.VALUE="value",e}();t.Change=r},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(14),a=n(5),s=n(1),u=n(0),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t,"__EMPTY_NODE",{get:function(){return i},set:function(e){i=e},enumerable:!0,configurable:!0}),t.prototype.compare=function(e,t){return s.nameCompare(e.name,t.name)},t.prototype.isDefinedOn=function(e){throw u.assertionError("KeyIndex.isDefinedOn not expected to be called.")},t.prototype.indexedValueChanged=function(e,t){return!1},t.prototype.minPost=function(){return a.NamedNode.MIN},t.prototype.maxPost=function(){return new a.NamedNode(s.MAX_NAME,i)},t.prototype.makePost=function(e,t){return u.assert("string"==typeof e,"KeyIndex indexValue must always be a string."),new a.NamedNode(e,i)},t.prototype.toString=function(){return".key"},t}(o.Index);t.KeyIndex=l,t.KEY_INDEX=new l},function(e,t,n){"use strict";function r(e,t){if(void 0===t&&(t=null),null===e)return i.ChildrenNode.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),u.assert(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e){var n=e;return new o.LeafNode(n,r(t))}if(e instanceof Array||!d){var f=i.ChildrenNode.EMPTY_NODE,_=e;return s.forEach(_,function(e,t){if(s.contains(_,e)&&"."!==e.substring(0,1)){var n=r(t);!n.isLeafNode()&&n.isEmpty()||(f=f.updateImmediateChild(e,n))}}),f.updatePriority(r(t))}var y=[],v=!1,g=e;if(s.forEach(g,function(e,t){if("string"!=typeof e||"."!==e.substring(0,1)){var n=r(g[e]);n.isEmpty()||(v=v||!n.getPriority().isEmpty(),y.push(new a.NamedNode(e,n)))}}),0==y.length)return i.ChildrenNode.EMPTY_NODE;var m=l.buildChildSet(y,h.NAME_ONLY_COMPARATOR,function(e){return e.name},h.NAME_COMPARATOR);if(v){var C=l.buildChildSet(y,p.PRIORITY_INDEX.getCompare());return new i.ChildrenNode(m,r(t),new c.IndexMap({".priority":C},{".priority":p.PRIORITY_INDEX}))}return new i.ChildrenNode(m,r(t),c.IndexMap.Default)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),o=n(15),a=n(5),s=n(0),u=n(0),l=n(38),h=n(39),c=n(37),p=n(3),d=!0;t.nodeFromJSON=r,p.setNodeFromJSON(r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(79),i=n(80),o=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new r.DOMStorageWrapper(t)}}catch(e){}return new i.MemoryStorage};t.PersistentStorage=o("localStorage"),t.SessionStorage=o("sessionStorage")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PROTOCOL_VERSION="5",t.VERSION_PARAM="v",t.TRANSPORT_SESSION_PARAM="s",t.REFERER_PARAM="r",t.FORGE_REF="f",t.FORGE_DOMAIN="firebaseio.com",t.LAST_SESSION_PARAM="ls",t.WEBSOCKET="websocket",t.LONG_POLLING="long_polling"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),i=n(1),o=function(){function e(){}return e.prototype.getCompare=function(){return this.compare.bind(this)},e.prototype.indexedValueChanged=function(e,t){var n=new r.NamedNode(i.MIN_NAME,e),o=new r.NamedNode(i.MIN_NAME,t);return 0!==this.compare(n,o)},e.prototype.minPost=function(){return r.NamedNode.MIN},e}();t.Index=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(0),o=n(1),a=n(35),s=function(){function e(t,n){void 0===n&&(n=e.__childrenNodeConstructor.EMPTY_NODE),this.T=t,this.y=n,this.m=null,i.assert(void 0!==this.T&&null!==this.T,"LeafNode shouldn't be created with null/undefined value."),a.validatePriorityNode(this.y)}return Object.defineProperty(e,"__childrenNodeConstructor",{get:function(){return r},set:function(e){r=e},enumerable:!0,configurable:!0}),e.prototype.isLeafNode=function(){return!0},e.prototype.getPriority=function(){return this.y},e.prototype.updatePriority=function(t){return new e(this.T,t)},e.prototype.getImmediateChild=function(t){return".priority"===t?this.y:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.getChild=function(t){return t.isEmpty()?this:".priority"===t.getFront()?this.y:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.hasChild=function(){return!1},e.prototype.getPredecessorChildName=function(e,t){return null},e.prototype.updateImmediateChild=function(t,n){return".priority"===t?this.updatePriority(n):n.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.y)},e.prototype.updateChild=function(t,n){var r=t.getFront();return null===r?n:n.isEmpty()&&".priority"!==r?this:(i.assert(".priority"!==r||1===t.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(r,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(t.popFront(),n)))},e.prototype.isEmpty=function(){return!1},e.prototype.numChildren=function(){return 0},e.prototype.forEachChild=function(e,t){return!1},e.prototype.val=function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},e.prototype.hash=function(){if(null===this.m){var e="";this.y.isEmpty()||(e+="priority:"+a.priorityHashText(this.y.val())+":");var t=typeof this.T;e+=t+":",e+="number"===t?o.doubleToIEEE754String(this.T):this.T,this.m=o.sha1(e)}return this.m},e.prototype.getValue=function(){return this.T},e.prototype.compareTo=function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(i.assert(t.isLeafNode(),"Unknown node type"),this.w(t))},e.prototype.w=function(t){var n=typeof t.T,r=typeof this.T,o=e.VALUE_TYPE_ORDER.indexOf(n),a=e.VALUE_TYPE_ORDER.indexOf(r);return i.assert(o>=0,"Unknown leaf type: "+n),i.assert(a>=0,"Unknown leaf type: "+r),o===a?"object"===r?0:this.T<t.T?-1:this.T===t.T?0:1:a-o},e.prototype.withIndex=function(){return this},e.prototype.isIndexed=function(){return!0},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.T===t.T&&this.y.equals(t.y)}return!1},e.VALUE_TYPE_ORDER=["object","boolean","number","string"],e}();t.LeafNode=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,n,r,i){void 0===i&&(i=null),this.I=r,this.R=i,this.O=[];for(var o=1;!e.isEmpty();)if(e=e,o=t?n(e.key,t):1,r&&(o*=-1),o<0)e=this.I?e.left:e.right;else{if(0===o){this.O.push(e);break}this.O.push(e),e=this.I?e.right:e.left}}return e.prototype.getNext=function(){if(0===this.O.length)return null;var e,t=this.O.pop();if(e=this.R?this.R(t.key,t.value):{key:t.key,value:t.value},this.I)for(t=t.left;!t.isEmpty();)this.O.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.O.push(t),t=t.left;return e},e.prototype.hasNext=function(){return this.O.length>0},e.prototype.peek=function(){if(0===this.O.length)return null;var e=this.O[this.O.length-1];return this.R?this.R(e.key,e.value):{key:e.key,value:e.value}},e}();t.SortedMapIterator=r;var i=function(){function e(t,n,r,i,o){this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:a.EMPTY_NODE,this.right=null!=o?o:a.EMPTY_NODE}return e.prototype.copy=function(t,n,r,i,o){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},e.prototype.count=function(){return this.left.count()+1+this.right.count()},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},e.prototype.A=function(){return this.left.isEmpty()?this:this.left.A()},e.prototype.minKey=function(){return this.A().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(e,t,n){var r,i;return i=this,r=n(e,i.key),i=r<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.D()},e.prototype.M=function(){if(this.left.isEmpty())return a.EMPTY_NODE;var e=this;return e.left.L()||e.left.left.L()||(e=e.F()),e=e.copy(null,null,null,e.left.M(),null),e.D()},e.prototype.remove=function(e,t){var n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.L()||n.left.left.L()||(n=n.F()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.L()&&(n=n.x()),n.right.isEmpty()||n.right.L()||n.right.left.L()||(n=n.k()),0===t(e,n.key)){if(n.right.isEmpty())return a.EMPTY_NODE;r=n.right.A(),n=n.copy(r.key,r.value,null,null,n.right.M())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.D()},e.prototype.L=function(){return this.color},e.prototype.D=function(){var e=this;return e.right.L()&&!e.left.L()&&(e=e.W()),e.left.L()&&e.left.left.L()&&(e=e.x()),e.left.L()&&e.right.L()&&(e=e.j()),e},e.prototype.F=function(){var e=this.j();return e.right.left.L()&&(e=e.copy(null,null,null,null,e.right.x()),e=e.W(),e=e.j()),e},e.prototype.k=function(){var e=this.j();return e.left.left.L()&&(e=e.x(),e=e.j()),e},e.prototype.W=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.x=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.j=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.V=function(){var e=this.Q();return Math.pow(2,e)<=this.count()+1},e.prototype.Q=function(){var e;if(this.L()&&this.left.L())throw Error("Red node has red child("+this.key+","+this.value+")");if(this.right.L())throw Error("Right child of ("+this.key+","+this.value+") is red");if((e=this.left.Q())!==this.right.Q())throw Error("Black depths differ");return e+(this.L()?0:1)},e.RED=!0,e.BLACK=!1,e}();t.LLRBNode=i;var o=function(){function e(){}return e.prototype.copy=function(e,t,n,r,i){return this},e.prototype.insert=function(e,t,n){return new i(e,t,null)},e.prototype.remove=function(e,t){return this},e.prototype.count=function(){return 0},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.Q=function(){return 0},e.prototype.L=function(){return!1},e}();t.LLRBEmptyNode=o;var a=function(){function e(t,n){void 0===n&&(n=e.EMPTY_NODE),this.U=t,this.B=n}return e.prototype.insert=function(t,n){return new e(this.U,this.B.insert(t,n,this.U).copy(null,null,i.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.U,this.B.remove(t,this.U).copy(null,null,i.BLACK,null,null))},e.prototype.get=function(e){for(var t,n=this.B;!n.isEmpty();){if(0===(t=this.U(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null},e.prototype.getPredecessorKey=function(e){for(var t,n=this.B,r=null;!n.isEmpty();){if(0===(t=this.U(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},e.prototype.isEmpty=function(){return this.B.isEmpty()},e.prototype.count=function(){return this.B.count()},e.prototype.minKey=function(){return this.B.minKey()},e.prototype.maxKey=function(){return this.B.maxKey()},e.prototype.inorderTraversal=function(e){return this.B.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.B.reverseTraversal(e)},e.prototype.getIterator=function(e){return new r(this.B,null,this.U,!1,e)},e.prototype.getIteratorFrom=function(e,t){return new r(this.B,e,this.U,!1,t)},e.prototype.getReverseIteratorFrom=function(e,t){return new r(this.B,e,this.U,!0,t)},e.prototype.getReverseIterator=function(e){return new r(this.B,null,this.U,!0,e)},e.EMPTY_NODE=new o,e}();t.SortedMap=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(42),i=n(11),o=n(2),a=n(43),s=n(86),u=n(97),l=n(0),h=n(1),c=n(0),p=n(98),d=n(24),f=n(100),_=n(48),y=n(101),v=n(49),g=n(106),m=n(31),C=function(){function e(e,t,n){var r=this;this.H=e,this.app=n,this.dataUpdateCount=0,this.G=null,this.K=new y.EventQueue,this.Y=1,this.X=null,this.z=new a.SparseSnapshotTree,this.J=null;var i=new p.AuthTokenProvider(n);if(this.$=d.StatsManager.getCollection(e),t||h.beingCrawled())this.Z=new g.ReadonlyRestClient(this.H,this.ee.bind(this),i),setTimeout(this.te.bind(this,!0),0);else{var o=n.options.databaseAuthVariableOverride;if(void 0!==o&&null!==o){if("object"!=typeof o)throw Error("Only objects are supported for option databaseAuthVariableOverride");try{l.stringify(o)}catch(e){throw Error("Invalid authOverride provided: "+e)}}this.J=new v.PersistentConnection(this.H,this.ee.bind(this),this.te.bind(this),this.ne.bind(this),i,o),this.Z=this.J}i.addTokenChangeListener(function(e){r.Z.refreshAuthToken(e)}),this.re=d.StatsManager.getOrCreateReporter(e,function(){return new f.StatsReporter(r.$,r.Z)}),this.ie(),this.oe=new u.SnapshotHolder,this.ae=new s.SyncTree({startListening:function(e,t,n,i){var o=[],a=r.oe.getNode(e.path);return a.isEmpty()||(o=r.ae.applyServerOverwrite(e.path,a),setTimeout(function(){i("ok")},0)),o},stopListening:function(){}}),this.se("connected",!1),this.ue=new s.SyncTree({startListening:function(e,t,n,i){return r.Z.listen(e,n,t,function(t,n){var o=i(t,n);r.K.raiseEventsForChangedPath(e.path,o)}),[]},stopListening:function(e,t){r.Z.unlisten(e,t)}})}return e.prototype.toString=function(){return(this.H.secure?"https://":"http://")+this.H.host},e.prototype.name=function(){return this.H.namespace},e.prototype.serverTime=function(){var e=this.oe.getNode(new o.Path(".info/serverTimeOffset")),t=e.val()||0;return(new Date).getTime()+t},e.prototype.generateServerValues=function(){return r.generateWithValues({timestamp:this.serverTime()})},e.prototype.ee=function(e,t,n,r){this.dataUpdateCount++;var a=new o.Path(e);t=this.X?this.X(e,t):t;var s=[];if(r)if(n){var u=c.map(t,function(e){return i.nodeFromJSON(e)});s=this.ue.applyTaggedQueryMerge(a,u,r)}else{var l=i.nodeFromJSON(t);s=this.ue.applyTaggedQueryOverwrite(a,l,r)}else if(n){var h=c.map(t,function(e){return i.nodeFromJSON(e)});s=this.ue.applyServerMerge(a,h)}else{var p=i.nodeFromJSON(t);s=this.ue.applyServerOverwrite(a,p)}var d=a;s.length>0&&(d=this.le(a)),this.K.raiseEventsForChangedPath(d,s)},e.prototype.he=function(e){this.X=e},e.prototype.te=function(e){this.se("connected",e),!1===e&&this.ce()},e.prototype.ne=function(e){var t=this;h.each(e,function(e,n){t.se(n,e)})},e.prototype.se=function(e,t){var n=new o.Path("/.info/"+e),r=i.nodeFromJSON(t);this.oe.updateSnapshot(n,r);var a=this.ae.applyServerOverwrite(n,r);this.K.raiseEventsForChangedPath(n,a)},e.prototype.pe=function(){return this.Y++},e.prototype.setWithPriority=function(e,t,n,o){var a=this;this.de("set",{path:""+e,value:t,priority:n});var s=this.generateServerValues(),u=i.nodeFromJSON(t,n),l=r.resolveDeferredValueSnapshot(u,s),c=this.pe(),p=this.ue.applyUserOverwrite(e,l,c,!0);this.K.queueEvents(p),this.Z.put(""+e,u.val(!0),function(t,n){var r="ok"===t;r||h.warn("set at "+e+" failed: "+t);var i=a.ue.ackUserWrite(c,!r);a.K.raiseEventsForChangedPath(e,i),a.callOnCompleteCallback(o,t,n)});var d=this.fe(e);this.le(d),this.K.raiseEventsForChangedPath(d,[])},e.prototype.update=function(e,t,n){var o=this;this.de("update",{path:""+e,value:t});var a=!0,s=this.generateServerValues(),u={};if(c.forEach(t,function(e,t){a=!1;var n=i.nodeFromJSON(t);u[e]=r.resolveDeferredValueSnapshot(n,s)}),a)h.log("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(n,"ok");else{var l=this.pe(),p=this.ue.applyUserMerge(e,u,l);this.K.queueEvents(p),this.Z.merge(""+e,t,function(t,r){var i="ok"===t;i||h.warn("update at "+e+" failed: "+t);var a=o.ue.ackUserWrite(l,!i),s=a.length>0?o.le(e):e;o.K.raiseEventsForChangedPath(s,a),o.callOnCompleteCallback(n,t,r)}),c.forEach(t,function(t){var n=o.fe(e.child(t));o.le(n)}),this.K.raiseEventsForChangedPath(e,[])}},e.prototype.ce=function(){var e=this;this.de("onDisconnectEvents");var t=this.generateServerValues(),n=r.resolveDeferredValueTree(this.z,t),i=[];n.forEachTree(o.Path.Empty,function(t,n){i=i.concat(e.ue.applyServerOverwrite(t,n));var r=e.fe(t);e.le(r)}),this.z=new a.SparseSnapshotTree,this.K.raiseEventsForChangedPath(o.Path.Empty,i)},e.prototype.onDisconnectCancel=function(e,t){var n=this;this.Z.onDisconnectCancel(""+e,function(r,i){"ok"===r&&n.z.forget(e),n.callOnCompleteCallback(t,r,i)})},e.prototype.onDisconnectSet=function(e,t,n){var r=this,o=i.nodeFromJSON(t);this.Z.onDisconnectPut(""+e,o.val(!0),function(t,i){"ok"===t&&r.z.remember(e,o),r.callOnCompleteCallback(n,t,i)})},e.prototype.onDisconnectSetWithPriority=function(e,t,n,r){var o=this,a=i.nodeFromJSON(t,n);this.Z.onDisconnectPut(""+e,a.val(!0),function(t,n){"ok"===t&&o.z.remember(e,a),o.callOnCompleteCallback(r,t,n)})},e.prototype.onDisconnectUpdate=function(e,t,n){var r=this;if(c.isEmpty(t))return h.log("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(n,"ok");this.Z.onDisconnectMerge(""+e,t,function(o,a){"ok"===o&&c.forEach(t,function(t,n){var o=i.nodeFromJSON(n);r.z.remember(e.child(t),o)}),r.callOnCompleteCallback(n,o,a)})},e.prototype.addEventCallbackForQuery=function(e,t){var n;n=".info"===e.path.getFront()?this.ae.addEventRegistration(e,t):this.ue.addEventRegistration(e,t),this.K.raiseEventsAtPath(e.path,n)},e.prototype.removeEventCallbackForQuery=function(e,t){var n;n=".info"===e.path.getFront()?this.ae.removeEventRegistration(e,t):this.ue.removeEventRegistration(e,t),this.K.raiseEventsAtPath(e.path,n)},e.prototype.interrupt=function(){this.J&&this.J.interrupt("repo_interrupt")},e.prototype.resume=function(){this.J&&this.J.resume("repo_interrupt")},e.prototype.stats=function(e){if(void 0===e&&(e=!1),"undefined"!=typeof console){var t;e?(this.G||(this.G=new _.StatsListener(this.$)),t=this.G.get()):t=this.$.get();var n=Object.keys(t).reduce(function(e,t){return Math.max(t.length,e)},0);c.forEach(t,function(e,t){for(var r=e.length;r<n+2;r++)e+=" ";console.log(e+t)})}},e.prototype.statsIncrementCounter=function(e){this.$.incrementCounter(e),this.re.includeStat(e)},e.prototype.de=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="";this.J&&(n=this.J.id+":"),h.log.apply(void 0,[n].concat(e))},e.prototype.callOnCompleteCallback=function(e,t,n){e&&h.exceptionGuard(function(){if("ok"==t)e(null);else{var r=(t||"error").toUpperCase(),i=r;n&&(i+=": "+n);var o=Error(i);o.code=r,e(o)}})},Object.defineProperty(e.prototype,"database",{get:function(){return this.__database||(this.__database=new m.Database(this))},enumerable:!0,configurable:!0}),e}();t.Repo=C},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,n){this._e=e,this.ye=t,this.ve=n}return e.prototype.isFullyInitialized=function(){return this.ye},e.prototype.isFiltered=function(){return this.ve},e.prototype.isCompleteForPath=function(e){if(e.isEmpty())return this.isFullyInitialized()&&!this.ve;var t=e.getFront();return this.isCompleteForChild(t)},e.prototype.isCompleteForChild=function(e){return this.isFullyInitialized()&&!this.ve||this._e.hasChild(e)},e.prototype.getNode=function(){return this._e},e}();t.CacheNode=r},,,function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(81),o=n(82),a=n(1),s=n(83),u=n(34),l=n(17),h=n(2),c=n(107),p=n(7),d=n(0),f=n(0),_=n(46),y=function(e){function t(t,n){if(!(t instanceof l.Repo))throw Error("new Reference() no longer supported - use app.database().");return e.call(this,t,n,c.QueryParams.DEFAULT,!1)||this}return r(t,e),t.prototype.getKey=function(){return d.validateArgCount("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},t.prototype.child=function(e){return d.validateArgCount("Reference.child",1,1,arguments.length),"number"==typeof e?e+="":e instanceof h.Path||(null===this.path.getFront()?p.validateRootPathString("Reference.child",1,e,!1):p.validatePathString("Reference.child",1,e,!1)),new t(this.repo,this.path.child(e))},t.prototype.getParent=function(){d.validateArgCount("Reference.parent",0,0,arguments.length);var e=this.path.parent();return null===e?null:new t(this.repo,e)},t.prototype.getRoot=function(){d.validateArgCount("Reference.root",0,0,arguments.length);for(var e=this;null!==e.getParent();)e=e.getParent();return e},t.prototype.databaseProp=function(){return this.repo.database},t.prototype.set=function(e,t){d.validateArgCount("Reference.set",1,2,arguments.length),p.validateWritablePath("Reference.set",this.path),p.validateFirebaseDataArg("Reference.set",1,e,this.path,!1),d.validateCallback("Reference.set",2,t,!0);var n=new f.Deferred;return this.repo.setWithPriority(this.path,e,null,n.wrapCallback(t)),n.promise},t.prototype.update=function(e,t){if(d.validateArgCount("Reference.update",1,2,arguments.length),p.validateWritablePath("Reference.update",this.path),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,a.warn("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}p.validateFirebaseMergeDataArg("Reference.update",1,e,this.path,!1),d.validateCallback("Reference.update",2,t,!0);var i=new f.Deferred;return this.repo.update(this.path,e,i.wrapCallback(t)),i.promise},t.prototype.setWithPriority=function(e,t,n){if(d.validateArgCount("Reference.setWithPriority",2,3,arguments.length),p.validateWritablePath("Reference.setWithPriority",this.path),p.validateFirebaseDataArg("Reference.setWithPriority",1,e,this.path,!1),p.validatePriority("Reference.setWithPriority",2,t,!1),d.validateCallback("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new f.Deferred;return this.repo.setWithPriority(this.path,e,t,r.wrapCallback(n)),r.promise},t.prototype.remove=function(e){return d.validateArgCount("Reference.remove",0,1,arguments.length),p.validateWritablePath("Reference.remove",this.path),d.validateCallback("Reference.remove",1,e,!0),this.set(null,e)},t.prototype.transaction=function(e,t,n){if(d.validateArgCount("Reference.transaction",1,3,arguments.length),p.validateWritablePath("Reference.transaction",this.path),d.validateCallback("Reference.transaction",1,e,!1),d.validateCallback("Reference.transaction",2,t,!0),p.validateBoolean("Reference.transaction",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===n&&(n=!0);var r=new f.Deferred;"function"==typeof t&&r.promise.catch(function(){});var i=function(e,n,i){e?r.reject(e):r.resolve(new o.TransactionResult(n,i)),"function"==typeof t&&t(e,n,i)};return this.repo.startTransaction(this.path,e,i,n),r.promise},t.prototype.setPriority=function(e,t){d.validateArgCount("Reference.setPriority",1,2,arguments.length),p.validateWritablePath("Reference.setPriority",this.path),p.validatePriority("Reference.setPriority",1,e,!1),d.validateCallback("Reference.setPriority",2,t,!0);var n=new f.Deferred;return this.repo.setWithPriority(this.path.child(".priority"),e,null,n.wrapCallback(t)),n.promise},t.prototype.push=function(e,t){d.validateArgCount("Reference.push",0,2,arguments.length),p.validateWritablePath("Reference.push",this.path),p.validateFirebaseDataArg("Reference.push",1,e,this.path,!0),d.validateCallback("Reference.push",2,t,!0);var n,r=this.repo.serverTime(),i=s.nextPushId(r),o=this.child(i),a=this.child(i);return n=null!=e?o.set(e,t).then(function(){return a}):Promise.resolve(a),o.then=n.then.bind(n),o.catch=n.then.bind(n,void 0),"function"==typeof t&&n.catch(function(){}),o},t.prototype.onDisconnect=function(){return p.validateWritablePath("Reference.onDisconnect",this.path),new i.OnDisconnect(this.repo,this.path)},Object.defineProperty(t.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.getKey()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this.getParent()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this.getRoot()},enumerable:!0,configurable:!0}),t}(u.Query);t.Reference=y,u.Query.__referenceConstructor=y,_.SyncPoint.__referenceConstructor=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(16),o=n(2),a=n(1),s=n(0),u=function(){return r||(r=new i.SortedMap(a.stringCompare)),r},l=function(){function e(e,t){void 0===t&&(t=u()),this.value=e,this.children=t}return e.fromObject=function(t){var n=e.Empty;return s.forEach(t,function(e,t){n=n.set(new o.Path(e),t)}),n},e.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},e.prototype.findRootMostMatchingPathAndValue=function(e,t){if(null!=this.value&&t(this.value))return{path:o.Path.Empty,value:this.value};if(e.isEmpty())return null;var n=e.getFront(),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(e.popFront(),t);return null!=i?{path:new o.Path(n).child(i.path),value:i.value}:null}return null},e.prototype.findRootMostValueAndPath=function(e){return this.findRootMostMatchingPathAndValue(e,function(){return!0})},e.prototype.subtree=function(t){if(t.isEmpty())return this;var n=t.getFront(),r=this.children.get(n);return null!==r?r.subtree(t.popFront()):e.Empty},e.prototype.set=function(t,n){if(t.isEmpty())return new e(n,this.children);var r=t.getFront(),i=this.children.get(r)||e.Empty,o=i.set(t.popFront(),n),a=this.children.insert(r,o);return new e(this.value,a)},e.prototype.remove=function(t){if(t.isEmpty())return this.children.isEmpty()?e.Empty:new e(null,this.children);var n=t.getFront(),r=this.children.get(n);if(r){var i=r.remove(t.popFront()),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?e.Empty:new e(this.value,o)}return this},e.prototype.get=function(e){if(e.isEmpty())return this.value;var t=e.getFront(),n=this.children.get(t);return n?n.get(e.popFront()):null},e.prototype.setTree=function(t,n){if(t.isEmpty())return n;var r=t.getFront(),i=this.children.get(r)||e.Empty,o=i.setTree(t.popFront(),n),a=void 0;return a=o.isEmpty()?this.children.remove(r):this.children.insert(r,o),new e(this.value,a)},e.prototype.fold=function(e){return this.ge(o.Path.Empty,e)},e.prototype.ge=function(e,t){var n={};return this.children.inorderTraversal(function(r,i){n[r]=i.ge(e.child(r),t)}),t(e,this.value,n)},e.prototype.findOnPath=function(e,t){return this.me(e,o.Path.Empty,t)},e.prototype.me=function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(e.isEmpty())return null;var i=e.getFront(),o=this.children.get(i);return o?o.me(e.popFront(),t.child(i),n):null},e.prototype.foreachOnPath=function(e,t){return this.Ce(e,o.Path.Empty,t)},e.prototype.Ce=function(t,n,r){if(t.isEmpty())return this;this.value&&r(n,this.value);var i=t.getFront(),o=this.children.get(i);return o?o.Ce(t.popFront(),n.child(i),r):e.Empty},e.prototype.foreach=function(e){this.Ee(o.Path.Empty,e)},e.prototype.Ee=function(e,t){this.children.inorderTraversal(function(n,r){r.Ee(e.child(n),t)}),this.value&&t(e,this.value)},e.prototype.foreachChild=function(e){this.children.inorderTraversal(function(t,n){n.value&&e(t,n.value)})},e.Empty=new e(null),e}();t.ImmutableTree=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(9),o=n(4),a=n(3),s=function(){function e(e){this.Ne=e}return e.prototype.updateChild=function(e,t,n,o,a,s){r.assert(e.isIndexed(this.Ne),"A node must be indexed if only a child is updated");var u=e.getImmediateChild(t);return u.getChild(o).equals(n.getChild(o))&&u.isEmpty()==n.isEmpty()?e:(null!=s&&(n.isEmpty()?e.hasChild(t)?s.trackChildChange(i.Change.childRemovedChange(t,u)):r.assert(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):u.isEmpty()?s.trackChildChange(i.Change.childAddedChange(t,n)):s.trackChildChange(i.Change.childChangedChange(t,n,u))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.Ne))},e.prototype.updateFullNode=function(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(a.PRIORITY_INDEX,function(e,r){t.hasChild(e)||n.trackChildChange(i.Change.childRemovedChange(e,r))}),t.isLeafNode()||t.forEachChild(a.PRIORITY_INDEX,function(t,r){if(e.hasChild(t)){var o=e.getImmediateChild(t);o.equals(r)||n.trackChildChange(i.Change.childChangedChange(t,r,o))}else n.trackChildChange(i.Change.childAddedChange(t,r))})),t.withIndex(this.Ne)},e.prototype.updatePriority=function(e,t){return e.isEmpty()?o.ChildrenNode.EMPTY_NODE:e.updatePriority(t)},e.prototype.filtersNodes=function(){return!1},e.prototype.getIndexedFilter=function(){return this},e.prototype.getIndex=function(){return this.Ne},e}();t.IndexedFilter=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(99),i=function(){function e(){}return e.getCollection=function(e){var t=""+e;return this.Pe[t]||(this.Pe[t]=new r.StatsCollection),this.Pe[t]},e.getOrCreateReporter=function(e,t){var n=""+e;return this.be[n]||(this.be[n]=t()),this.be[n]},e.Pe={},e.be={},e}();t.StatsManager=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(17),o=n(1),a=n(32),s=n(7);n(109);var u,l=function(){function e(){this.Se={},this.Te=!1}return e.getInstance=function(){return u||(u=new e),u},e.prototype.interrupt=function(){for(var e in this.Se)for(var t in this.Se[e])this.Se[e][t].interrupt()},e.prototype.resume=function(){for(var e in this.Se)for(var t in this.Se[e])this.Se[e][t].resume()},e.prototype.databaseFromApp=function(e,t){var n=t||e.options.databaseURL;void 0===n&&o.fatal("Can't determine Firebase Database URL.  Be sure to include databaseURL option when calling firebase.intializeApp().");var r=a.parseRepoInfo(n),i=r.repoInfo;return s.validateUrl("Invalid Firebase Database URL",1,r),r.path.isEmpty()||o.fatal("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(i,e).database},e.prototype.deleteRepo=function(e){var t=r.safeGet(this.Se,e.app.name);t&&r.safeGet(t,e.H.toURLString())===e||o.fatal("Database "+e.app.name+"("+e.H+") has already been deleted."),e.interrupt(),delete t[e.H.toURLString()]},e.prototype.createRepo=function(e,t){var n=r.safeGet(this.Se,t.name);n||(n={},this.Se[t.name]=n);var a=r.safeGet(n,e.toURLString());return a&&o.fatal("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),a=new i.Repo(e,this.Te,t),n[e.toURLString()]=a,a},e.prototype.forceRestClient=function(e){this.Te=e},e}();t.RepoManager=l},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(32),o=n(2),a=n(21),s=n(17),u=n(25),l=n(0),h=n(7),c=function(){function e(e){this.we=e,e instanceof s.Repo||r.fatal("Don't call new Database() directly - please use firebase.database()."),this.B=new a.Reference(e,o.Path.Empty),this.INTERNAL=new p(this)}return Object.defineProperty(e.prototype,"app",{get:function(){return this.we.app},enumerable:!0,configurable:!0}),e.prototype.ref=function(e){return this.Ie("ref"),l.validateArgCount("database.ref",0,1,arguments.length),void 0!==e?this.B.child(e):this.B},e.prototype.refFromURL=function(e){var t="database.refFromURL";this.Ie(t),l.validateArgCount(t,1,1,arguments.length);var n=i.parseRepoInfo(e);h.validateUrl(t,1,n);var o=n.repoInfo;return o.host!==this.we.H.host&&r.fatal(t+": Host name does not match the current database: (found "+o.host+" but expected "+this.we.H.host+")"),this.ref(""+n.path)},e.prototype.Ie=function(e){null===this.we&&r.fatal("Cannot call "+e+" on a deleted database.")},e.prototype.goOffline=function(){l.validateArgCount("database.goOffline",0,0,arguments.length),this.Ie("goOffline"),this.we.interrupt()},e.prototype.goOnline=function(){l.validateArgCount("database.goOnline",0,0,arguments.length),this.Ie("goOnline"),this.we.resume()},e.ServerValue={TIMESTAMP:{".sv":"timestamp"}},e}();t.Database=c;var p=function(){function e(e){this.database=e}return e.prototype.delete=function(){return this.database.Ie("delete"),u.RepoManager.getInstance().deleteRepo(this.database.we),this.database.we=null,this.database.B=null,this.database.INTERNAL=null,this.database=null,Promise.resolve()},e}();t.DatabaseInternals=p},function(e,t,n){"use strict";function r(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(e){}t+="/"+i}return t}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=n(33),a=n(1);t.parseRepoInfo=function(e){var n=t.parseURL(e),r=n.subdomain;"firebase"===n.domain&&a.fatal(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!=r||a.fatal("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||a.warnIfPageIsSecure();var s="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new o.RepoInfo(n.host,n.secure,r,s),path:new i.Path(n.pathString)}},t.parseURL=function(e){var t="",n="",i="",o="",a=!0,s="https",u=443;if("string"==typeof e){var l=e.indexOf("//");l>=0&&(s=e.substring(0,l-1),e=e.substring(l+2));var h=e.indexOf("/");-1===h&&(h=e.length),t=e.substring(0,h),o=r(e.substring(h));var c=t.split(".");3===c.length?(n=c[1],i=c[0].toLowerCase()):2===c.length&&(n=c[0]),(l=t.indexOf(":"))>=0&&(a="https"===s||"wss"===s,u=parseInt(t.substring(l+1),10))}return{host:t,port:u,domain:n,subdomain:i,secure:a,scheme:s,pathString:o}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(0),o=n(12),a=n(13),s=function(){function e(e,t,n,r,i){void 0===i&&(i=""),this.secure=t,this.namespace=n,this.webSocketOnly=r,this.persistenceKey=i,this.host=e.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=o.PersistentStorage.get("host:"+e)||this.host}return e.prototype.needsQueryParam=function(){return this.host!==this.internalHost},e.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},e.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},e.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},e.prototype.updateHost=function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&o.PersistentStorage.set("host:"+this.host,this.internalHost))},e.prototype.connectionURL=function(e,t){r.assert("string"==typeof e,"typeof type must == string"),r.assert("object"==typeof t,"typeof params must == object");var n;if(e===a.WEBSOCKET)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(e!==a.LONG_POLLING)throw Error("Unknown connection type: "+e);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(t.ns=this.namespace);var o=[];return i.forEach(t,function(e,t){o.push(e+"="+t)}),n+o.join("&")},e.prototype.toString=function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e},e.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},e}();t.RepoInfo=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(0),o=n(10),a=n(3),s=n(36),u=n(40),l=n(1),h=n(2),c=n(7),p=n(0),d=n(84),f=n(0),_=function(){function e(e,t,n,r){this.repo=e,this.path=t,this.Re=n,this.Oe=r}return Object.defineProperty(e,"__referenceConstructor",{get:function(){return i.assert(r,"Reference.ts has not been loaded"),r},set:function(e){r=e},enumerable:!0,configurable:!0}),e.Ae=function(e){var t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===o.KEY_INDEX){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",h="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!=l.MIN_NAME)throw Error(r);if("string"!=typeof t)throw Error(h)}if(e.hasEnd()){if(e.getIndexEndName()!=l.MAX_NAME)throw Error(r);if("string"!=typeof n)throw Error(h)}}else if(e.getIndex()===a.PRIORITY_INDEX){if(null!=t&&!c.isValidPriority(t)||null!=n&&!c.isValidPriority(n))throw Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(i.assert(e.getIndex()instanceof u.PathIndex||e.getIndex()===s.VALUE_INDEX,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},e.De=function(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},e.prototype.Me=function(e){if(!0===this.Oe)throw Error(e+": You can't combine multiple orderBy calls.")},e.prototype.getQueryParams=function(){return this.Re},e.prototype.getRef=function(){return p.validateArgCount("Query.ref",0,0,arguments.length),new e.__referenceConstructor(this.repo,this.path)},e.prototype.on=function(t,n,r,i){p.validateArgCount("Query.on",2,4,arguments.length),c.validateEventType("Query.on",1,t,!1),p.validateCallback("Query.on",2,n,!1);var o=e.Le("Query.on",r,i);if("value"===t)this.onValueEvent(n,o.cancel,o.context);else{var a={};a[t]=n,this.onChildEvent(a,o.cancel,o.context)}return n},e.prototype.onValueEvent=function(e,t,n){var r=new d.ValueEventRegistration(e,t||null,n||null);this.repo.addEventCallbackForQuery(this,r)},e.prototype.onChildEvent=function(e,t,n){var r=new d.ChildEventRegistration(e,t,n);this.repo.addEventCallbackForQuery(this,r)},e.prototype.off=function(e,t,n){p.validateArgCount("Query.off",0,3,arguments.length),c.validateEventType("Query.off",1,e,!0),p.validateCallback("Query.off",2,t,!0),p.validateContextObject("Query.off",3,n,!0);var r=null,i=null;if("value"===e){var o=t||null;r=new d.ValueEventRegistration(o,null,n||null)}else e&&(t&&(i={},i[e]=t),r=new d.ChildEventRegistration(i,null,n||null));this.repo.removeEventCallbackForQuery(this,r)},e.prototype.once=function(t,n,r,i){var o=this;p.validateArgCount("Query.once",1,4,arguments.length),c.validateEventType("Query.once",1,t,!1),p.validateCallback("Query.once",2,n,!0);var a=e.Le("Query.once",r,i),s=!0,u=new f.Deferred;u.promise.catch(function(){});var l=function(e){s&&(s=!1,o.off(t,l),n&&n.bind(a.context)(e),u.resolve(e))};return this.on(t,l,function(e){o.off(t,l),a.cancel&&a.cancel.bind(a.context)(e),u.reject(e)}),u.promise},e.prototype.limitToFirst=function(t){if(p.validateArgCount("Query.limitToFirst",1,1,arguments.length),"number"!=typeof t||Math.floor(t)!==t||t<=0)throw Error("Query.limitToFirst: First argument must be a positive integer.");if(this.Re.hasLimit())throw Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new e(this.repo,this.path,this.Re.limitToFirst(t),this.Oe)},e.prototype.limitToLast=function(t){if(p.validateArgCount("Query.limitToLast",1,1,arguments.length),"number"!=typeof t||Math.floor(t)!==t||t<=0)throw Error("Query.limitToLast: First argument must be a positive integer.");if(this.Re.hasLimit())throw Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new e(this.repo,this.path,this.Re.limitToLast(t),this.Oe)},e.prototype.orderByChild=function(t){if(p.validateArgCount("Query.orderByChild",1,1,arguments.length),"$key"===t)throw Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===t)throw Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===t)throw Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');c.validatePathString("Query.orderByChild",1,t,!1),this.Me("Query.orderByChild");var n=new h.Path(t);if(n.isEmpty())throw Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var r=new u.PathIndex(n),i=this.Re.orderBy(r);return e.Ae(i),new e(this.repo,this.path,i,!0)},e.prototype.orderByKey=function(){p.validateArgCount("Query.orderByKey",0,0,arguments.length),this.Me("Query.orderByKey");var t=this.Re.orderBy(o.KEY_INDEX);return e.Ae(t),new e(this.repo,this.path,t,!0)},e.prototype.orderByPriority=function(){p.validateArgCount("Query.orderByPriority",0,0,arguments.length),this.Me("Query.orderByPriority");var t=this.Re.orderBy(a.PRIORITY_INDEX);return e.Ae(t),new e(this.repo,this.path,t,!0)},e.prototype.orderByValue=function(){p.validateArgCount("Query.orderByValue",0,0,arguments.length),this.Me("Query.orderByValue");var t=this.Re.orderBy(s.VALUE_INDEX);return e.Ae(t),new e(this.repo,this.path,t,!0)},e.prototype.startAt=function(t,n){void 0===t&&(t=null),p.validateArgCount("Query.startAt",0,2,arguments.length),c.validateFirebaseDataArg("Query.startAt",1,t,this.path,!0),c.validateKey("Query.startAt",2,n,!0);var r=this.Re.startAt(t,n);if(e.De(r),e.Ae(r),this.Re.hasStart())throw Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===t&&(t=null,n=null),new e(this.repo,this.path,r,this.Oe)},e.prototype.endAt=function(t,n){void 0===t&&(t=null),p.validateArgCount("Query.endAt",0,2,arguments.length),c.validateFirebaseDataArg("Query.endAt",1,t,this.path,!0),c.validateKey("Query.endAt",2,n,!0);var r=this.Re.endAt(t,n);if(e.De(r),e.Ae(r),this.Re.hasEnd())throw Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new e(this.repo,this.path,r,this.Oe)},e.prototype.equalTo=function(e,t){if(p.validateArgCount("Query.equalTo",1,2,arguments.length),c.validateFirebaseDataArg("Query.equalTo",1,e,this.path,!1),c.validateKey("Query.equalTo",2,t,!0),this.Re.hasStart())throw Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.Re.hasEnd())throw Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(e,t).endAt(e,t)},e.prototype.toString=function(){return p.validateArgCount("Query.toString",0,0,arguments.length),""+this.repo+this.path.toUrlEncodedString()},e.prototype.toJSON=function(){return p.validateArgCount("Query.toJSON",0,1,arguments.length),""+this},e.prototype.queryObject=function(){return this.Re.getQueryObject()},e.prototype.queryIdentifier=function(){var e=this.queryObject(),t=l.ObjectToUniqueKey(e);return"{}"===t?"default":t},e.prototype.isEqual=function(t){if(p.validateArgCount("Query.isEqual",1,1,arguments.length),!(t instanceof e))throw Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");var n=this.repo===t.repo,r=this.path.equals(t.path),i=this.queryIdentifier()===t.queryIdentifier();return n&&r&&i},e.Le=function(e,t,n){var r={cancel:null,context:null};if(t&&n)r.cancel=t,p.validateCallback(e,3,r.cancel,!0),r.context=n,p.validateContextObject(e,4,r.context,!0);else if(t)if("object"==typeof t&&null!==t)r.context=t;else{if("function"!=typeof t)throw Error(p.errorPrefix(e,3,!0)+" must either be a cancel callback or a context object.");r.cancel=t}return r},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),e}();t.Query=_},function(e,t,n){"use strict";function r(e){i=e}Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(0),a=n(1),s=n(0);t.setMaxNode=r,t.priorityHashText=function(e){return"number"==typeof e?"number:"+a.doubleToIEEE754String(e):"string:"+e},t.validatePriorityNode=function(e){if(e.isLeafNode()){var t=e.val();o.assert("string"==typeof t||"number"==typeof t||"object"==typeof t&&s.contains(t,".sv"),"Priority must be a string or number.")}else o.assert(e===i||e.isEmpty(),"priority of unexpected type.");o.assert(e===i||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")}},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(14),o=n(5),a=n(1),s=n(11),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.compare=function(e,t){var n=e.node.compareTo(t.node);return 0===n?a.nameCompare(e.name,t.name):n},t.prototype.isDefinedOn=function(e){return!0},t.prototype.indexedValueChanged=function(e,t){return!e.equals(t)},t.prototype.minPost=function(){return o.NamedNode.MIN},t.prototype.maxPost=function(){return o.NamedNode.MAX},t.prototype.makePost=function(e,t){var n=s.nodeFromJSON(e);return new o.NamedNode(t,n)},t.prototype.toString=function(){return".value"},t}(i.Index);t.ValueIndex=u,t.VALUE_INDEX=new u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(0),o=n(38),a=n(0),s=n(5),u=n(3),l=n(10),h={},c=function(){function e(e,t){this.Fe=e,this.xe=t}return Object.defineProperty(e,"Default",{get:function(){return i.assert(h&&u.PRIORITY_INDEX,"ChildrenNode.ts has not been loaded"),r=r||new e({".priority":h},{".priority":u.PRIORITY_INDEX})},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var t=a.safeGet(this.Fe,e);if(!t)throw Error("No index defined for "+e);return t===h?null:t},e.prototype.hasIndex=function(e){return a.contains(this.xe,""+e)},e.prototype.addIndex=function(t,n){i.assert(t!==l.KEY_INDEX,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r=[],u=!1,c=n.getIterator(s.NamedNode.Wrap),p=c.getNext();p;)u=u||t.isDefinedOn(p.node),r.push(p),p=c.getNext();var d;d=u?o.buildChildSet(r,t.getCompare()):h;var f=""+t,_=a.clone(this.xe);_[f]=t;var y=a.clone(this.Fe);return y[f]=d,new e(y,_)},e.prototype.addToIndexes=function(t,n){var r=this;return new e(a.map(this.Fe,function(e,u){var l=a.safeGet(r.xe,u);if(i.assert(l,"Missing index implementation for "+u),e===h){if(l.isDefinedOn(t.node)){for(var c=[],p=n.getIterator(s.NamedNode.Wrap),d=p.getNext();d;)d.name!=t.name&&c.push(d),d=p.getNext();return c.push(t),o.buildChildSet(c,l.getCompare())}return h}var f=n.get(t.name),_=e;return f&&(_=_.remove(new s.NamedNode(t.name,f))),_.insert(t,t.node)}),this.xe)},e.prototype.removeFromIndexes=function(t,n){return new e(a.map(this.Fe,function(e){if(e===h)return e;var r=n.get(t.name);return r?e.remove(new s.NamedNode(t.name,r)):e}),this.xe)},e}();t.IndexMap=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),i=n(16),o=Math.log(2),a=function(){function e(e){this.count=function(e){return parseInt(Math.log(e)/o,10)}(e+1),this.ke=this.count-1;var t=function(e){return parseInt(Array(e+1).join("1"),2)}(this.count);this.We=e+1&t}return e.prototype.nextBitIsOne=function(){var e=!(this.We&1<<this.ke);return this.ke--,e},e}();t.buildChildSet=function(e,t,n,o){e.sort(t);var s=function(t,i){var o,a,u=i-t;if(0==u)return null;if(1==u)return o=e[t],a=n?n(o):o,new r.LLRBNode(a,o.node,r.LLRBNode.BLACK,null,null);var l=parseInt(u/2,10)+t,h=s(t,l),c=s(l+1,i);return o=e[l],a=n?n(o):o,new r.LLRBNode(a,o.node,r.LLRBNode.BLACK,h,c)},u=new a(e.length),l=function(t){for(var i=null,o=null,a=e.length,u=function(t,i){var o=a-t,u=a;a-=t;var h=s(o+1,u),c=e[o],p=n?n(c):c;l(new r.LLRBNode(p,c.node,i,null,h))},l=function(e){i?(i.left=e,i=e):(o=e,i=e)},h=0;h<t.count;++h){var c=t.nextBitIsOne(),p=Math.pow(2,t.count-(h+1));c?u(p,r.LLRBNode.BLACK):(u(p,r.LLRBNode.BLACK),u(p,r.LLRBNode.RED))}return o}(u);return new i.SortedMap(o||t,l)}},function(e,t,n){"use strict";function r(e,t){return o.nameCompare(e.name,t.name)}function i(e,t){return o.nameCompare(e,t)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1);t.NAME_ONLY_COMPARATOR=r,t.NAME_COMPARATOR=i},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(1),a=n(14),s=n(4),u=n(5),l=n(11),h=function(e){function t(t){var n=e.call(this)||this;return n.je=t,i.assert(!t.isEmpty()&&".priority"!==t.getFront(),"Can't create PathIndex with empty path or .priority key"),n}return r(t,e),t.prototype.extractChild=function(e){return e.getChild(this.je)},t.prototype.isDefinedOn=function(e){return!e.getChild(this.je).isEmpty()},t.prototype.compare=function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?o.nameCompare(e.name,t.name):i},t.prototype.makePost=function(e,t){var n=l.nodeFromJSON(e),r=s.ChildrenNode.EMPTY_NODE.updateChild(this.je,n);return new u.NamedNode(t,r)},t.prototype.maxPost=function(){var e=s.ChildrenNode.EMPTY_NODE.updateChild(this.je,s.MAX_NODE);return new u.NamedNode(o.MAX_NAME,e)},t.prototype.toString=function(){return this.je.slice().join("/")},t}(a.Index);t.PathIndex=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(7),o=n(2),a=n(3),s=function(){function e(e,t,n){this._e=e,this.Ve=t,this.Ne=n}return e.prototype.val=function(){return r.validateArgCount("DataSnapshot.val",0,0,arguments.length),this._e.val()},e.prototype.exportVal=function(){return r.validateArgCount("DataSnapshot.exportVal",0,0,arguments.length),this._e.val(!0)},e.prototype.toJSON=function(){return r.validateArgCount("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},e.prototype.exists=function(){return r.validateArgCount("DataSnapshot.exists",0,0,arguments.length),!this._e.isEmpty()},e.prototype.child=function(t){r.validateArgCount("DataSnapshot.child",0,1,arguments.length),t+="",i.validatePathString("DataSnapshot.child",1,t,!1);var n=new o.Path(t),s=this.Ve.child(n);return new e(this._e.getChild(n),s,a.PRIORITY_INDEX)},e.prototype.hasChild=function(e){r.validateArgCount("DataSnapshot.hasChild",1,1,arguments.length),i.validatePathString("DataSnapshot.hasChild",1,e,!1);var t=new o.Path(e);return!this._e.getChild(t).isEmpty()},e.prototype.getPriority=function(){return r.validateArgCount("DataSnapshot.getPriority",0,0,arguments.length),this._e.getPriority().val()},e.prototype.forEach=function(t){var n=this;return r.validateArgCount("DataSnapshot.forEach",1,1,arguments.length),r.validateCallback("DataSnapshot.forEach",1,t,!1),!this._e.isLeafNode()&&!!this._e.forEachChild(this.Ne,function(r,i){return t(new e(i,n.Ve.child(r),a.PRIORITY_INDEX))})},e.prototype.hasChildren=function(){return r.validateArgCount("DataSnapshot.hasChildren",0,0,arguments.length),!this._e.isLeafNode()&&!this._e.isEmpty()},Object.defineProperty(e.prototype,"key",{get:function(){return this.Ve.getKey()},enumerable:!0,configurable:!0}),e.prototype.numChildren=function(){return r.validateArgCount("DataSnapshot.numChildren",0,0,arguments.length),this._e.numChildren()},e.prototype.getRef=function(){return r.validateArgCount("DataSnapshot.ref",0,0,arguments.length),this.Ve},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),e}();t.DataSnapshot=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(2),o=n(43),a=n(15),s=n(11),u=n(3);t.generateWithValues=function(e){return e=e||{},e.timestamp=e.timestamp||(new Date).getTime(),e},t.resolveDeferredValue=function(e,t){return e&&"object"==typeof e?(r.assert(".sv"in e,"Unexpected leaf node or priority contents"),t[e[".sv"]]):e},t.resolveDeferredValueTree=function(e,n){var r=new o.SparseSnapshotTree;return e.forEachTree(new i.Path(""),function(e,i){r.remember(e,t.resolveDeferredValueSnapshot(i,n))}),r},t.resolveDeferredValueSnapshot=function(e,n){var r,i=e.getPriority().val(),o=t.resolveDeferredValue(i,n);if(e.isLeafNode()){var l=e,h=t.resolveDeferredValue(l.getValue(),n);return h!==l.getValue()||o!==l.getPriority().val()?new a.LeafNode(h,s.nodeFromJSON(o)):e}var c=e;return r=c,o!==c.getPriority().val()&&(r=r.updatePriority(new a.LeafNode(o))),c.forEachChild(u.PRIORITY_INDEX,function(e,i){var o=t.resolveDeferredValueSnapshot(i,n);o!==i&&(r=r.updateImmediateChild(e,o))}),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(44),a=function(){function e(){this.T=null,this._=null}return e.prototype.find=function(e){if(null!=this.T)return this.T.getChild(e);if(e.isEmpty()||null==this._)return null;var t=e.getFront();return e=e.popFront(),this._.contains(t)?this._.get(t).find(e):null},e.prototype.remember=function(t,n){if(t.isEmpty())this.T=n,this._=null;else if(null!==this.T)this.T=this.T.updateChild(t,n);else{null==this._&&(this._=new o.CountedSet);var r=t.getFront();this._.contains(r)||this._.add(r,new e);var i=this._.get(r);t=t.popFront(),i.remember(t,n)}},e.prototype.forget=function(e){if(e.isEmpty())return this.T=null,this._=null,!0;if(null!==this.T){if(this.T.isLeafNode())return!1;var t=this.T;this.T=null;var n=this;return t.forEachChild(i.PRIORITY_INDEX,function(e,t){n.remember(new r.Path(e),t)}),this.forget(e)}if(null!==this._){var o=e.getFront();return e=e.popFront(),this._.contains(o)&&this._.get(o).forget(e)&&this._.remove(o),!!this._.isEmpty()&&(this._=null,!0)}return!0},e.prototype.forEachTree=function(e,t){null!==this.T?t(e,this.T):this.forEachChild(function(n,i){var o=new r.Path(e+"/"+n);i.forEachTree(o,t)})},e.prototype.forEachChild=function(e){null!==this._&&this._.each(function(t,n){e(t,n)})},e}();t.SparseSnapshotTree=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(){this.set={}}return e.prototype.add=function(e,t){this.set[e]=null===t||t},e.prototype.contains=function(e){return r.contains(this.set,e)},e.prototype.get=function(e){return this.contains(e)?this.set[e]:void 0},e.prototype.remove=function(e){delete this.set[e]},e.prototype.clear=function(){this.set={}},e.prototype.isEmpty=function(){return r.isEmpty(this.set)},e.prototype.count=function(){return r.getCount(this.set)},e.prototype.each=function(e){r.forEach(this.set,function(t,n){return e(t,n)})},e.prototype.keys=function(){var e=[];return r.forEach(this.set,function(t){e.push(t)}),e},e}();t.CountedSet=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),i=n(2),o=function(){function e(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=r.OperationType.OVERWRITE}return e.prototype.operationForChild=function(t){return this.path.isEmpty()?new e(this.source,i.Path.Empty,this.snap.getImmediateChild(t)):new e(this.source,this.path.popFront(),this.snap)},e}();t.Overwrite=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(18),o=n(4),a=n(0),s=n(0),u=n(47),l=n(90),h=function(){function e(){this.Qe={}}return Object.defineProperty(e,"__referenceConstructor",{get:function(){return a.assert(r,"Reference.ts has not been loaded"),r},set:function(e){a.assert(!r,"__referenceConstructor has already been defined"),r=e},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return s.isEmpty(this.Qe)},e.prototype.applyOperation=function(e,t,n){var r=e.source.queryId;if(null!==r){var i=s.safeGet(this.Qe,r);return a.assert(null!=i,"SyncTree gave us an op for an invalid query."),i.applyOperation(e,t,n)}var o=[];return s.forEach(this.Qe,function(r,i){o=o.concat(i.applyOperation(e,t,n))}),o},e.prototype.addEventRegistration=function(e,t,n,r,a){var h=e.queryIdentifier(),c=s.safeGet(this.Qe,h);if(!c){var p=n.calcCompleteEventCache(a?r:null),d=!1;p?d=!0:r instanceof o.ChildrenNode?(p=n.calcCompleteEventChildren(r),d=!1):(p=o.ChildrenNode.EMPTY_NODE,d=!1);var f=new u.ViewCache(new i.CacheNode(p,d,!1),new i.CacheNode(r,a,!1));c=new l.View(e,f),this.Qe[h]=c}return c.addEventRegistration(t),c.getInitialEvents(t)},e.prototype.removeEventRegistration=function(t,n,r){var i=t.queryIdentifier(),o=[],a=[],u=this.hasCompleteView();if("default"===i){var l=this;s.forEach(this.Qe,function(e,t){a=a.concat(t.removeEventRegistration(n,r)),t.isEmpty()&&(delete l.Qe[e],t.getQuery().getQueryParams().loadsAllData()||o.push(t.getQuery()))})}else{var h=s.safeGet(this.Qe,i);h&&(a=a.concat(h.removeEventRegistration(n,r)),h.isEmpty()&&(delete this.Qe[i],h.getQuery().getQueryParams().loadsAllData()||o.push(h.getQuery())))}return u&&!this.hasCompleteView()&&o.push(new e.__referenceConstructor(t.repo,t.path)),{removed:o,events:a}},e.prototype.getQueryViews=function(){var e=this;return Object.keys(this.Qe).map(function(t){return e.Qe[t]}).filter(function(e){return!e.getQuery().getQueryParams().loadsAllData()})},e.prototype.getCompleteServerCache=function(e){var t=null;return s.forEach(this.Qe,function(n,r){t=t||r.getCompleteServerCache(e)}),t},e.prototype.viewForQuery=function(e){if(e.getQueryParams().loadsAllData())return this.getCompleteView();var t=e.queryIdentifier();return s.safeGet(this.Qe,t)},e.prototype.viewExistsForQuery=function(e){return null!=this.viewForQuery(e)},e.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},e.prototype.getCompleteView=function(){return s.findValue(this.Qe,function(e){return e.getQuery().getQueryParams().loadsAllData()})||null},e}();t.SyncPoint=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=n(18),o=function(){function e(e,t){this.qe=e,this.Ue=t}return e.prototype.updateEventSnap=function(t,n,r){return new e(new i.CacheNode(t,n,r),this.Ue)},e.prototype.updateServerSnap=function(t,n,r){return new e(this.qe,new i.CacheNode(t,n,r))},e.prototype.getEventCache=function(){return this.qe},e.prototype.getCompleteEventSnap=function(){return this.qe.isFullyInitialized()?this.qe.getNode():null},e.prototype.getServerCache=function(){return this.Ue},e.prototype.getCompleteServerSnap=function(){return this.Ue.isFullyInitialized()?this.Ue.getNode():null},e.Empty=new e(new i.CacheNode(r.ChildrenNode.EMPTY_NODE,!1,!1),new i.CacheNode(r.ChildrenNode.EMPTY_NODE,!1,!1)),e}();t.ViewCache=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(e){this.Be=e,this.He=null}return e.prototype.get=function(){var e=this.Be.get(),t=r.clone(e);return this.He&&r.forEach(this.He,function(e,n){t[e]=t[e]-n}),this.He=e,t},e}();t.StatsListener=i},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),o=n(0),a=n(0),s=n(0),u=n(1),l=n(2),h=n(102),c=n(103),p=n(0),d=n(51),f=n(0),_=n(0),y=n(54),v=1e3,g=3e5,m=function(e){function t(n,r,i,o,a,s){var l=e.call(this)||this;if(l.H=n,l.ee=r,l.te=i,l.ne=o,l.Ge=a,l.Ke=s,l.id=t.Ye++,l.de=u.logWrapper("p:"+l.id+":"),l.Xe={},l.ze={},l.Je=[],l.$e=0,l.Ze=[],l.et=!1,l.tt=v,l.nt=g,l.rt=null,l.lastSessionId=null,l.it=null,l.ot=!1,l.at={},l.st=0,l.ut=null,l.lt=null,l.ht=!1,l.ct=0,l.pt=!0,l.dt=null,l.ft=null,s&&!_.isNodeSdk())throw Error("Auth override specified in options, but not supported on non Node.js platforms");return l._t(0),h.VisibilityMonitor.getInstance().on("visible",l.yt,l),-1===n.host.indexOf("fblocal")&&c.OnlineMonitor.getInstance().on("online",l.vt,l),l}return r(t,e),t.prototype.sendRequest=function(e,t,n){var r=++this.st,i={r:r,a:e,b:t};this.de(a.stringify(i)),s.assert(this.et,"sendRequest call when we're not connected not allowed."),this.ut.sendRequest(i),n&&(this.at[r]=n)},t.prototype.listen=function(e,t,n,r){var i=e.queryIdentifier(),o=""+e.path;this.de("Listen called for "+o+" "+i),this.ze[o]=this.ze[o]||{},s.assert(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),s.assert(!this.ze[o][i],"listen() called twice for same path/queryId.");var a={onComplete:r,hashFn:t,query:e,tag:n};this.ze[o][i]=a,this.et&&this.gt(a)},t.prototype.gt=function(e){var n=this,r=e.query,i=""+r.path,o=r.queryIdentifier();this.de("Listen on "+i+" for "+o);var a={p:i};e.tag&&(a.q=r.queryObject(),a.t=e.tag),a.h=e.hashFn(),this.sendRequest("q",a,function(a){var s=a.d,u=a.s;t.mt(s,r),(n.ze[i]&&n.ze[i][o])===e&&(n.de("listen response",a),"ok"!==u&&n.Ct(i,o),e.onComplete&&e.onComplete(u,s))})},t.mt=function(e,t){if(e&&"object"==typeof e&&o.contains(e,"w")){var n=o.safeGet(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+t.getQueryParams().getIndex()+'"',i=""+t.path;u.warn("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},t.prototype.refreshAuthToken=function(e){this.lt=e,this.de("Auth token refreshed"),this.lt?this.tryAuth():this.et&&this.sendRequest("unauth",{},function(){}),this.Et(e)},t.prototype.Et=function(e){(e&&40===e.length||p.isAdmin(e))&&(this.de("Admin auth credential detected.  Reducing max reconnect time."),this.nt=3e4)},t.prototype.tryAuth=function(){var e=this;if(this.et&&this.lt){var t=this.lt,n=p.isValidFormat(t)?"auth":"gauth",r={cred:t};null===this.Ke?r.noauth=!0:"object"==typeof this.Ke&&(r.authvar=this.Ke),this.sendRequest(n,r,function(n){var r=n.s,i=n.d||"error";e.lt===t&&("ok"===r?e.ct=0:e.Nt(r,i))})}},t.prototype.unlisten=function(e,t){var n=""+e.path,r=e.queryIdentifier();this.de("Unlisten called for "+n+" "+r),s.assert(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.Ct(n,r)&&this.et&&this.Pt(n,r,e.queryObject(),t)},t.prototype.Pt=function(e,t,n,r){this.de("Unlisten on "+e+" for "+t);var i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},t.prototype.onDisconnectPut=function(e,t,n){this.et?this.bt("o",e,t,n):this.Ze.push({pathString:e,action:"o",data:t,onComplete:n})},t.prototype.onDisconnectMerge=function(e,t,n){this.et?this.bt("om",e,t,n):this.Ze.push({pathString:e,action:"om",data:t,onComplete:n})},t.prototype.onDisconnectCancel=function(e,t){this.et?this.bt("oc",e,null,t):this.Ze.push({pathString:e,action:"oc",data:null,onComplete:t})},t.prototype.bt=function(e,t,n,r){var i={p:t,d:n};this.de("onDisconnect "+e,i),this.sendRequest(e,i,function(e){r&&setTimeout(function(){r(e.s,e.d)},Math.floor(0))})},t.prototype.put=function(e,t,n,r){this.putInternal("p",e,t,n,r)},t.prototype.merge=function(e,t,n,r){this.putInternal("m",e,t,n,r)},t.prototype.putInternal=function(e,t,n,r,i){var o={p:t,d:n};void 0!==i&&(o.h=i),this.Je.push({action:e,request:o,onComplete:r}),this.$e++;var a=this.Je.length-1;this.et?this.St(a):this.de("Buffering put: "+t)},t.prototype.St=function(e){var t=this,n=this.Je[e].action,r=this.Je[e].request,i=this.Je[e].onComplete;this.Je[e].queued=this.et,this.sendRequest(n,r,function(r){t.de(n+" response",r),delete t.Je[e],t.$e--,0===t.$e&&(t.Je=[]),i&&i(r.s,r.d)})},t.prototype.reportStats=function(e){var t=this;if(this.et){var n={c:e};this.de("reportStats",n),this.sendRequest("s",n,function(e){if("ok"!==e.s){var n=e.d;t.de("reportStats","Error sending stats: "+n)}})}},t.prototype.Tt=function(e){if("r"in e){this.de("from server: "+a.stringify(e));var t=e.r,n=this.at[t];n&&(delete this.at[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.wt(e.a,e.b)}},t.prototype.wt=function(e,t){this.de("handleServerMessage",e,t),"d"===e?this.ee(t.p,t.d,!1,t.t):"m"===e?this.ee(t.p,t.d,!0,t.t):"c"===e?this.It(t.p,t.q):"ac"===e?this.Nt(t.s,t.d):"sd"===e?this.Rt(t):u.error("Unrecognized action received from server: "+a.stringify(e)+"\nAre you using the latest client?")},t.prototype.Ot=function(e,t){this.de("connection ready"),this.et=!0,this.ft=(new Date).getTime(),this.At(e),this.lastSessionId=t,this.pt&&this.Dt(),this.Mt(),this.pt=!1,this.te(!0)},t.prototype._t=function(e){var t=this;s.assert(!this.ut,"Scheduling a connect when we're already connected/ing?"),this.it&&clearTimeout(this.it),this.it=setTimeout(function(){t.it=null,t.Lt()},Math.floor(e))},t.prototype.yt=function(e){e&&!this.ot&&this.tt===this.nt&&(this.de("Window became visible.  Reducing delay."),this.tt=v,this.ut||this._t(0)),this.ot=e},t.prototype.vt=function(e){e?(this.de("Browser went online."),this.tt=v,this.ut||this._t(0)):(this.de("Browser went offline.  Killing connection."),this.ut&&this.ut.close())},t.prototype.Ft=function(){if(this.de("data client disconnected"),this.et=!1,this.ut=null,this.xt(),this.at={},this.kt()){if(this.ot){if(this.ft){var e=(new Date).getTime()-this.ft;e>3e4&&(this.tt=v),this.ft=null}}else this.de("Window isn't visible.  Delaying reconnect."),this.tt=this.nt,this.dt=(new Date).getTime();var t=(new Date).getTime()-this.dt,n=Math.max(0,this.tt-t);n=Math.random()*n,this.de("Trying to reconnect in "+n+"ms"),this._t(n),this.tt=Math.min(this.nt,1.3*this.tt)}this.te(!1)},t.prototype.Lt=function(){if(this.kt()){this.de("Making a connection attempt"),this.dt=(new Date).getTime(),this.ft=null;var e=this.Tt.bind(this),n=this.Ot.bind(this),r=this.Ft.bind(this),i=this.id+":"+t.Wt++,o=this,a=this.lastSessionId,l=!1,h=null,c=function(){h?h.close():(l=!0,r())},p=function(e){s.assert(h,"sendRequest call when we're not connected not allowed."),h.sendRequest(e)};this.ut={close:c,sendRequest:p};var _=this.ht;this.ht=!1,this.Ge.getToken(_).then(function(t){l?u.log("getToken() completed but was canceled"):(u.log("getToken() completed. Creating connection."),o.lt=t&&t.accessToken,h=new d.Connection(i,o.H,e,n,r,function(e){u.warn(e+" ("+o.H+")"),o.interrupt("server_kill")},a))}).then(null,function(e){o.de("Failed to get token: "+e),l||(f.CONSTANTS.NODE_ADMIN&&u.warn(e),c())})}},t.prototype.interrupt=function(e){u.log("Interrupting connection for reason: "+e),this.Xe[e]=!0,this.ut?this.ut.close():(this.it&&(clearTimeout(this.it),this.it=null),this.et&&this.Ft())},t.prototype.resume=function(e){u.log("Resuming connection for reason: "+e),delete this.Xe[e],o.isEmpty(this.Xe)&&(this.tt=v,this.ut||this._t(0))},t.prototype.At=function(e){var t=e-(new Date).getTime();this.ne({serverTimeOffset:t})},t.prototype.xt=function(){for(var e=0;e<this.Je.length;e++){var t=this.Je[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.Je[e],this.$e--)}0===this.$e&&(this.Je=[])},t.prototype.It=function(e,t){var n;n=t?t.map(function(e){return u.ObjectToUniqueKey(e)}).join("$"):"default";var r=this.Ct(e,n);r&&r.onComplete&&r.onComplete("permission_denied")},t.prototype.Ct=function(e,t){var n,r=""+new l.Path(e);return void 0!==this.ze[r]?(n=this.ze[r][t],delete this.ze[r][t],0===o.getCount(this.ze[r])&&delete this.ze[r]):n=void 0,n},t.prototype.Nt=function(e,t){u.log("Auth token revoked: "+e+"/"+t),this.lt=null,this.ht=!0,this.ut.close(),"invalid_token"!==e&&"permission_denied"!==e||++this.ct>=3&&(this.tt=3e4,this.Ge.notifyForInvalidToken())},t.prototype.Rt=function(e){this.rt?this.rt(e):"msg"in e&&"undefined"!=typeof console&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))},t.prototype.Mt=function(){var e=this;this.tryAuth(),o.forEach(this.ze,function(t,n){o.forEach(n,function(t,n){e.gt(n)})});for(var t=0;t<this.Je.length;t++)this.Je[t]&&this.St(t);for(;this.Ze.length;){var n=this.Ze.shift();this.bt(n.action,n.pathString,n.data,n.onComplete)}},t.prototype.Dt=function(){var e={},t="js";f.CONSTANTS.NODE_ADMIN?t="admin_node":f.CONSTANTS.NODE_CLIENT&&(t="node"),e["sdk."+t+"."+i.default.SDK_VERSION.replace(/\./g,"-")]=1,_.isMobileCordova()?e["framework.cordova"]=1:_.isReactNative()&&(e["framework.reactnative"]=1),this.reportStats(e)},t.prototype.kt=function(){var e=c.OnlineMonitor.getInstance().currentlyOnline();return o.isEmpty(this.Xe)&&e},t.Ye=0,t.Wt=0,t}(y.ServerActions);t.PersistentConnection=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(e){this.jt=e,this.Vt={},r.assert(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}return e.prototype.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Array.isArray(this.Vt[e]))for(var r=this.Vt[e].slice(),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)},e.prototype.on=function(e,t,n){this.Qt(e),this.Vt[e]=this.Vt[e]||[],this.Vt[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)},e.prototype.off=function(e,t,n){this.Qt(e);for(var r=this.Vt[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)},e.prototype.Qt=function(e){r.assert(this.jt.find(function(t){return t===e}),"Unknown event: "+e)},e}();t.EventEmitter=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(12),o=n(13),a=n(104),s=function(){function e(e,t,n,i,o,s,u){this.id=e,this.H=t,this.qt=n,this.Ot=i,this.z=o,this.Ut=s,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.Bt=0,this.de=r.logWrapper("c:"+this.id+":"),this.Ht=new a.TransportManager(t),this.de("Connection created"),this.Gt()}return e.prototype.Gt=function(){var e=this,t=this.Ht.initialTransport();this.Kt=new t(this.Yt(),this.H,void 0,this.lastSessionId),this.Xt=t.responsesRequiredToBeHealthy||0;var n=this.zt(this.Kt),i=this.Jt(this.Kt);this.$t=this.Kt,this.Zt=this.Kt,this.en=null,this.tn=!1,setTimeout(function(){e.Kt&&e.Kt.open(n,i)},Math.floor(0));var o=t.healthyTimeout||0;o>0&&(this.nn=r.setTimeoutNonBlocking(function(){e.nn=null,e.tn||(e.Kt&&e.Kt.bytesReceived>102400?(e.de("Connection exceeded healthy timeout but has received "+e.Kt.bytesReceived+" bytes.  Marking connection healthy."),e.tn=!0,e.Kt.markConnectionHealthy()):e.Kt&&e.Kt.bytesSent>10240?e.de("Connection exceeded healthy timeout but has sent "+e.Kt.bytesSent+" bytes.  Leaving connection alive."):(e.de("Closing unhealthy connection after timeout."),e.close()))},Math.floor(o)))},e.prototype.Yt=function(){return"c:"+this.id+":"+this.connectionCount++},e.prototype.Jt=function(e){var t=this;return function(n){e===t.Kt?t.rn(n):e===t.en?(t.de("Secondary connection lost."),t.in()):t.de("closing an old connection")}},e.prototype.zt=function(e){var t=this;return function(n){2!=t.Bt&&(e===t.Zt?t.an(n):e===t.en?t.sn(n):t.de("message on old connection"))}},e.prototype.sendRequest=function(e){var t={t:"d",d:e};this.un(t)},e.prototype.tryCleanupConnection=function(){this.$t===this.en&&this.Zt===this.en&&(this.de("cleaning up and promoting a connection: "+this.en.connId),this.Kt=this.en,this.en=null)},e.prototype.ln=function(e){if("t"in e){var t=e.t;"a"===t?this.hn():"r"===t?(this.de("Got a reset on secondary, closing it"),this.en.close(),this.$t!==this.en&&this.Zt!==this.en||this.close()):"o"===t&&(this.de("got pong on secondary."),this.cn--,this.hn())}},e.prototype.sn=function(e){var t=r.requireKey("t",e),n=r.requireKey("d",e);if("c"==t)this.ln(n);else{if("d"!=t)throw Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}},e.prototype.hn=function(){this.cn<=0?(this.de("Secondary connection is healthy."),this.tn=!0,this.en.markConnectionHealthy(),this.pn()):(this.de("sending ping on secondary."),this.en.send({t:"c",d:{t:"p",d:{}}}))},e.prototype.pn=function(){this.en.start(),this.de("sending client ack on secondary"),this.en.send({t:"c",d:{t:"a",d:{}}}),this.de("Ending transmission on primary"),this.Kt.send({t:"c",d:{t:"n",d:{}}}),this.$t=this.en,this.tryCleanupConnection()},e.prototype.an=function(e){var t=r.requireKey("t",e),n=r.requireKey("d",e);"c"==t?this.dn(n):"d"==t&&this.Tt(n)},e.prototype.Tt=function(e){this.fn(),this.qt(e)},e.prototype.fn=function(){this.tn||--this.Xt<=0&&(this.de("Primary connection is healthy."),this.tn=!0,this.Kt.markConnectionHealthy())},e.prototype.dn=function(e){var t=r.requireKey("t",e);if("d"in e){var n=e.d;if("h"===t)this._n(n);else if("n"===t){this.de("recvd end transmission on primary"),this.Zt=this.en;for(var i=0;i<this.pendingDataMessages.length;++i)this.Tt(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.yn(n):"r"===t?this.vn(n):"e"===t?r.error("Server Error: "+n):"o"===t?(this.de("got pong on primary."),this.fn(),this.gn()):r.error("Unknown control packet command: "+t)}},e.prototype._n=function(e){var t=e.ts,n=e.v,i=e.h;this.sessionId=e.s,this.H.updateHost(i),0==this.Bt&&(this.Kt.start(),this.mn(this.Kt,t),o.PROTOCOL_VERSION!==n&&r.warn("Protocol version mismatch detected"),this.Cn())},e.prototype.Cn=function(){var e=this.Ht.upgradeTransport();e&&this.En(e)},e.prototype.En=function(e){var t=this;this.en=new e(this.Yt(),this.H,this.sessionId),this.cn=e.responsesRequiredToBeHealthy||0;var n=this.zt(this.en),i=this.Jt(this.en);this.en.open(n,i),r.setTimeoutNonBlocking(function(){t.en&&(t.de("Timed out trying to upgrade."),t.en.close())},Math.floor(6e4))},e.prototype.vn=function(e){this.de("Reset packet received.  New host: "+e),this.H.updateHost(e),1===this.Bt?this.close():(this.Nn(),this.Gt())},e.prototype.mn=function(e,t){var n=this;this.de("Realtime connection established."),this.Kt=e,this.Bt=1,this.Ot&&(this.Ot(t,this.sessionId),this.Ot=null),0===this.Xt?(this.de("Primary connection is healthy."),this.tn=!0):r.setTimeoutNonBlocking(function(){n.gn()},Math.floor(5e3))},e.prototype.gn=function(){this.tn||1!==this.Bt||(this.de("sending ping on primary."),this.un({t:"c",d:{t:"p",d:{}}}))},e.prototype.in=function(){var e=this.en;this.en=null,this.$t!==e&&this.Zt!==e||this.close()},e.prototype.rn=function(e){this.Kt=null,e||0!==this.Bt?1===this.Bt&&this.de("Realtime connection lost."):(this.de("Realtime connection failed."),this.H.isCacheableHost()&&(i.PersistentStorage.remove("host:"+this.H.host),this.H.internalHost=this.H.host)),this.close()},e.prototype.yn=function(e){this.de("Connection shutdown command received. Shutting down..."),this.Ut&&(this.Ut(e),this.Ut=null),this.z=null,this.close()},e.prototype.un=function(e){if(1!==this.Bt)throw"Connection is not connected";this.$t.send(e)},e.prototype.close=function(){2!==this.Bt&&(this.de("Closing realtime connection."),this.Bt=2,this.Nn(),this.z&&(this.z(),this.z=null))},e.prototype.Nn=function(){this.de("Shutting down all connections"),this.Kt&&(this.Kt.close(),this.Kt=null),this.en&&(this.en.close(),this.en=null),this.nn&&(clearTimeout(this.nn),this.nn=null)},e}();t.Connection=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(44),o=n(24),a=n(105),s=n(13),u=n(0),l=n(0);t.FIREBASE_LONGPOLL_START_PARAM="start",t.FIREBASE_LONGPOLL_CLOSE_COMMAND="close",t.FIREBASE_LONGPOLL_COMMAND_CB_NAME="pLPCommand",t.FIREBASE_LONGPOLL_DATA_CB_NAME="pRTLPCB",t.FIREBASE_LONGPOLL_ID_PARAM="id",t.FIREBASE_LONGPOLL_PW_PARAM="pw",t.FIREBASE_LONGPOLL_SERIAL_PARAM="ser",t.FIREBASE_LONGPOLL_CALLBACK_ID_PARAM="cb",t.FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM="seg",t.FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET="ts",t.FIREBASE_LONGPOLL_DATA_PARAM="d",t.FIREBASE_LONGPOLL_DISCONN_FRAME_PARAM="disconn",t.FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM="dframe";var h=function(){function e(e,t,n,i){this.connId=e,this.repoInfo=t,this.transportSessionId=n,this.lastSessionId=i,this.bytesSent=0,this.bytesReceived=0,this.Pn=!1,this.de=r.logWrapper(e),this.$=o.StatsManager.getCollection(t),this.urlFn=function(e){return t.connectionURL(s.LONG_POLLING,e)}}return e.prototype.open=function(e,n){var i=this;this.curSegmentNum=0,this.z=n,this.myPacketOrderer=new a.PacketReceiver(e),this.bn=!1,this.Sn=setTimeout(function(){i.de("Timed out trying to connect."),i.Tn(),i.Sn=null},Math.floor(3e4)),r.executeWhenDOMReady(function(){if(!i.bn){i.scriptTagHolder=new c(function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=e[0],o=e[1],a=e[2];if(e[3],e[4],i.wn(e),i.scriptTagHolder)if(i.Sn&&(clearTimeout(i.Sn),i.Sn=null),i.Pn=!0,r==t.FIREBASE_LONGPOLL_START_PARAM)i.id=o,i.password=a;else{if(r!==t.FIREBASE_LONGPOLL_CLOSE_COMMAND)throw Error("Unrecognized command received: "+r);o?(i.scriptTagHolder.sendNewPolls=!1,i.myPacketOrderer.closeAfter(o,function(){i.Tn()})):i.Tn()}},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[0],r=e[1];i.wn(e),i.myPacketOrderer.handleResponse(n,r)},function(){i.Tn()},i.urlFn);var e={};e[t.FIREBASE_LONGPOLL_START_PARAM]="t",e[t.FIREBASE_LONGPOLL_SERIAL_PARAM]=Math.floor(1e8*Math.random()),i.scriptTagHolder.uniqueCallbackIdentifier&&(e[t.FIREBASE_LONGPOLL_CALLBACK_ID_PARAM]=i.scriptTagHolder.uniqueCallbackIdentifier),e[s.VERSION_PARAM]=s.PROTOCOL_VERSION,i.transportSessionId&&(e[s.TRANSPORT_SESSION_PARAM]=i.transportSessionId),i.lastSessionId&&(e[s.LAST_SESSION_PARAM]=i.lastSessionId),!l.isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(s.FORGE_DOMAIN)&&(e[s.REFERER_PARAM]=s.FORGE_REF);var n=i.urlFn(e);i.de("Connecting via long-poll to "+n),i.scriptTagHolder.addTag(n,function(){})}})},e.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},e.forceAllow=function(){e.In=!0},e.forceDisallow=function(){e.Rn=!0},e.isAvailable=function(){return e.In||!e.Rn&&"undefined"!=typeof document&&null!=document.createElement&&!r.isChromeExtensionContentScript()&&!r.isWindowsStoreApp()&&!l.isNodeSdk()},e.prototype.markConnectionHealthy=function(){},e.prototype.On=function(){this.bn=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.Sn&&(clearTimeout(this.Sn),this.Sn=null)},e.prototype.Tn=function(){this.bn||(this.de("Longpoll is closing itself"),this.On(),this.z&&(this.z(this.Pn),this.z=null))},e.prototype.close=function(){this.bn||(this.de("Longpoll is being closed."),this.On())},e.prototype.send=function(e){var t=u.stringify(e);this.bytesSent+=t.length,this.$.incrementCounter("bytes_sent",t.length);for(var n=u.base64Encode(t),i=r.splitStringBySize(n,1840),o=0;o<i.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[o]),this.curSegmentNum++},e.prototype.addDisconnectPingFrame=function(e,n){if(!l.isNodeSdk()){this.myDisconnFrame=document.createElement("iframe");var r={};r[t.FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM]="t",r[t.FIREBASE_LONGPOLL_ID_PARAM]=e,r[t.FIREBASE_LONGPOLL_PW_PARAM]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},e.prototype.wn=function(e){var t=u.stringify(e).length;this.bytesReceived+=t,this.$.incrementCounter("bytes_received",t)},e}();t.BrowserPollConnection=h;var c=function(){function e(n,o,a,s){if(this.onDisconnect=a,this.urlFn=s,this.outstandingRequests=new i.CountedSet,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,l.isNodeSdk())this.commandCB=n,this.onMessageCB=o;else{this.uniqueCallbackIdentifier=r.LUIDGenerator(),window[t.FIREBASE_LONGPOLL_COMMAND_CB_NAME+this.uniqueCallbackIdentifier]=n,window[t.FIREBASE_LONGPOLL_DATA_CB_NAME+this.uniqueCallbackIdentifier]=o,this.myIFrame=e.An();var u="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(u='<script>document.domain="'+document.domain+'";<\/script>');var h="<html><body>"+u+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(h),this.myIFrame.doc.close()}catch(e){r.log("frame writing exception"),e.stack&&r.log(e.stack),r.log(e)}}}return e.An=function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||r.log("No IE domain setting required")}catch(n){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e},e.prototype.close=function(){var n=this;if(this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==n.myIFrame&&(document.body.removeChild(n.myIFrame),n.myIFrame=null)},Math.floor(0))),l.isNodeSdk()&&this.myID){var r={};r[t.FIREBASE_LONGPOLL_DISCONN_FRAME_PARAM]="t",r[t.FIREBASE_LONGPOLL_ID_PARAM]=this.myID,r[t.FIREBASE_LONGPOLL_PW_PARAM]=this.myPW;var i=this.urlFn(r);e.nodeRestRequest(i)}var o=this.onDisconnect;o&&(this.onDisconnect=null,o())},e.prototype.startLongPoll=function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.Dn(););},e.prototype.Dn=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.count()<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e[t.FIREBASE_LONGPOLL_ID_PARAM]=this.myID,e[t.FIREBASE_LONGPOLL_PW_PARAM]=this.myPW,e[t.FIREBASE_LONGPOLL_SERIAL_PARAM]=this.currentSerial;for(var n=this.urlFn(e),r="",i=0;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){var o=this.pendingSegs.shift();r=r+"&"+t.FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM+i+"="+o.seg+"&"+t.FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET+i+"="+o.ts+"&"+t.FIREBASE_LONGPOLL_DATA_PARAM+i+"="+o.d,i++}return n+=r,this.Mn(n,this.currentSerial),!0}return!1},e.prototype.enqueueSegment=function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.Dn()},e.prototype.Mn=function(e,t){var n=this;this.outstandingRequests.add(t,1);var r=function(){n.outstandingRequests.remove(t),n.Dn()},i=setTimeout(r,Math.floor(25e3)),o=function(){clearTimeout(i),r()};this.addTag(e,o)},e.prototype.addTag=function(e,t){var n=this;l.isNodeSdk()?this.doNodeLongPoll(e,t):setTimeout(function(){try{if(!n.sendNewPolls)return;var i=n.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){var e=i.readyState;e&&"loaded"!==e&&"complete"!==e||(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=function(){r.log("Long-poll script failed to load: "+e),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(i)}catch(e){}},Math.floor(1))},e}();t.FirebaseIFrameScriptHolder=c},function(e,t,n){"use strict";(function(e){function r(e){d=e}Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),o=n(0),a=n(1),s=n(24),u=n(13),l=n(0),h=n(12),c=n(0),p=n(0),d=null;"undefined"!=typeof MozWebSocket?d=MozWebSocket:"undefined"!=typeof WebSocket&&(d=WebSocket),t.setWebSocketImpl=r;var f=function(){function t(e,n,r,i){this.connId=e,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.de=a.logWrapper(this.connId),this.$=s.StatsManager.getCollection(n),this.connURL=t.Ln(n,r,i)}return t.Ln=function(e,t,n){var r={};return r[u.VERSION_PARAM]=u.PROTOCOL_VERSION,!p.isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(u.FORGE_DOMAIN)&&(r[u.REFERER_PARAM]=u.FORGE_REF),t&&(r[u.TRANSPORT_SESSION_PARAM]=t),n&&(r[u.LAST_SESSION_PARAM]=n),e.connectionURL(u.WEBSOCKET,r)},t.prototype.open=function(t,n){var r=this;this.onDisconnect=n,this.onMessage=t,this.de("Websocket connecting to "+this.connURL),this.Pn=!1,h.PersistentStorage.set("previous_websocket_failure",!0);try{if(p.isNodeSdk()){var o=l.CONSTANTS.NODE_ADMIN?"AdminNode":"Node",a={headers:{"User-Agent":"Firebase/"+u.PROTOCOL_VERSION+"/"+i.default.SDK_VERSION+"/"+e.platform+"/"+o}},s=e.env,c=0==this.connURL.indexOf("wss://")?s.HTTPS_PROXY||s.https_proxy:s.HTTP_PROXY||s.http_proxy;c&&(a.proxy={origin:c}),this.mySock=new d(this.connURL,[],a)}else this.mySock=new d(this.connURL)}catch(e){this.de("Error instantiating WebSocket.");var f=e.message||e.data;return f&&this.de(f),void this.Tn()}this.mySock.onopen=function(){r.de("Websocket connected."),r.Pn=!0},this.mySock.onclose=function(){r.de("Websocket connection was disconnected."),r.mySock=null,r.Tn()},this.mySock.onmessage=function(e){r.handleIncomingFrame(e)},this.mySock.onerror=function(e){r.de("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&r.de(t),r.Tn()}},t.prototype.start=function(){},t.forceDisallow=function(){t.Rn=!0},t.isAvailable=function(){var e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&null!==d&&!t.Rn},t.previouslyFailed=function(){return h.PersistentStorage.isInMemoryStorage||!0===h.PersistentStorage.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){h.PersistentStorage.remove("previous_websocket_failure")},t.prototype.Fn=function(e){if(this.frames.push(e),this.frames.length==this.totalFrames){var t=this.frames.join("");this.frames=null;var n=c.jsonEval(t);this.onMessage(n)}},t.prototype.xn=function(e){this.totalFrames=e,this.frames=[]},t.prototype.kn=function(e){if(o.assert(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=+e;if(!isNaN(t))return this.xn(t),null}return this.xn(1),e},t.prototype.handleIncomingFrame=function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.$.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.Fn(t);else{var n=this.kn(t);null!==n&&this.Fn(n)}}},t.prototype.send=function(e){this.resetKeepAlive();var t=c.stringify(e);this.bytesSent+=t.length,this.$.incrementCounter("bytes_sent",t.length);var n=a.splitStringBySize(t,16384);n.length>1&&this.Wn(n.length+"");for(var r=0;r<n.length;r++)this.Wn(n[r])},t.prototype.On=function(){this.bn=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.Tn=function(){this.bn||(this.de("WebSocket is closing itself"),this.On(),this.onDisconnect&&(this.onDisconnect(this.Pn),this.onDisconnect=null))},t.prototype.close=function(){this.bn||(this.de("WebSocket is being closed"),this.On())},t.prototype.resetKeepAlive=function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){e.mySock&&e.Wn("0"),e.resetKeepAlive()},Math.floor(45e3))},t.prototype.Wn=function(e){try{this.mySock.send(e)}catch(e){this.de("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.Tn.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}();t.WebSocketConnection=f}).call(t,n(26))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.put=function(e,t,n,r){},e.prototype.merge=function(e,t,n,r){},e.prototype.refreshAuthToken=function(e){},e.prototype.onDisconnectPut=function(e,t,n){},e.prototype.onDisconnectMerge=function(e,t,n){},e.prototype.onDisconnectCancel=function(e,t){},e.prototype.reportStats=function(e){},e}();t.ServerActions=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(23),i=n(3),o=n(5),a=n(4),s=function(){function e(t){this.jn=new r.IndexedFilter(t.getIndex()),this.Ne=t.getIndex(),this.Vn=e.Qn(t),this.qn=e.Un(t)}return e.prototype.getStartPost=function(){return this.Vn},e.prototype.getEndPost=function(){return this.qn},e.prototype.matches=function(e){return this.Ne.compare(this.getStartPost(),e)<=0&&this.Ne.compare(e,this.getEndPost())<=0},e.prototype.updateChild=function(e,t,n,r,i,s){return this.matches(new o.NamedNode(t,n))||(n=a.ChildrenNode.EMPTY_NODE),this.jn.updateChild(e,t,n,r,i,s)},e.prototype.updateFullNode=function(e,t,n){t.isLeafNode()&&(t=a.ChildrenNode.EMPTY_NODE);var r=t.withIndex(this.Ne);r=r.updatePriority(a.ChildrenNode.EMPTY_NODE);var s=this;return t.forEachChild(i.PRIORITY_INDEX,function(e,t){s.matches(new o.NamedNode(e,t))||(r=r.updateImmediateChild(e,a.ChildrenNode.EMPTY_NODE))}),this.jn.updateFullNode(e,r,n)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.jn},e.prototype.getIndex=function(){return this.Ne},e.Qn=function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()},e.Un=function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()},e}();t.RangedFilter=s},,,,,,,,,,,,,,,,,,,,,,function(e,t,n){e.exports=n(78)},function(e,t,n){"use strict";function r(t){var n=t.INTERNAL.registerService("database",function(e,t,n){return l.RepoManager.getInstance().databaseFromApp(e,n)},{Reference:s.Reference,Query:a.Query,Database:o.Database,enableLogging:u.enableLogging,INTERNAL:h,ServerValue:o.Database.ServerValue,TEST_ACCESS:c},null,!0);p.isNodeSdk()&&(e.exports=n)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),o=n(31),a=n(34),s=n(21),u=n(1),l=n(25),h=n(111),c=n(112),p=n(0);t.registerDatabase=r,r(i.default)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(e){this.Bn=e,this.Hn="firebase:"}return e.prototype.set=function(e,t){null==t?this.Bn.removeItem(this.Gn(e)):this.Bn.setItem(this.Gn(e),r.stringify(t))},e.prototype.get=function(e){var t=this.Bn.getItem(this.Gn(e));return null==t?null:r.jsonEval(t)},e.prototype.remove=function(e){this.Bn.removeItem(this.Gn(e))},e.prototype.Gn=function(e){return this.Hn+e},e.prototype.toString=function(){return""+this.Bn},e}();t.DOMStorageWrapper=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(){this.Kn={},this.isInMemoryStorage=!0}return e.prototype.set=function(e,t){null==t?delete this.Kn[e]:this.Kn[e]=t},e.prototype.get=function(e){return r.contains(this.Kn,e)?this.Kn[e]:null},e.prototype.remove=function(e){delete this.Kn[e]},e}();t.MemoryStorage=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(7),o=n(1),a=n(0),s=function(){function e(e,t){this.we=e,this.Yn=t}return e.prototype.cancel=function(e){r.validateArgCount("OnDisconnect.cancel",0,1,arguments.length),r.validateCallback("OnDisconnect.cancel",1,e,!0);var t=new a.Deferred;return this.we.onDisconnectCancel(this.Yn,t.wrapCallback(e)),t.promise},e.prototype.remove=function(e){r.validateArgCount("OnDisconnect.remove",0,1,arguments.length),i.validateWritablePath("OnDisconnect.remove",this.Yn),r.validateCallback("OnDisconnect.remove",1,e,!0);var t=new a.Deferred;return this.we.onDisconnectSet(this.Yn,null,t.wrapCallback(e)),t.promise},e.prototype.set=function(e,t){r.validateArgCount("OnDisconnect.set",1,2,arguments.length),i.validateWritablePath("OnDisconnect.set",this.Yn),i.validateFirebaseDataArg("OnDisconnect.set",1,e,this.Yn,!1),r.validateCallback("OnDisconnect.set",2,t,!0);var n=new a.Deferred;return this.we.onDisconnectSet(this.Yn,e,n.wrapCallback(t)),n.promise},e.prototype.setWithPriority=function(e,t,n){r.validateArgCount("OnDisconnect.setWithPriority",2,3,arguments.length),i.validateWritablePath("OnDisconnect.setWithPriority",this.Yn),i.validateFirebaseDataArg("OnDisconnect.setWithPriority",1,e,this.Yn,!1),i.validatePriority("OnDisconnect.setWithPriority",2,t,!1),r.validateCallback("OnDisconnect.setWithPriority",3,n,!0);var o=new a.Deferred;return this.we.onDisconnectSetWithPriority(this.Yn,e,t,o.wrapCallback(n)),o.promise},e.prototype.update=function(e,t){if(r.validateArgCount("OnDisconnect.update",1,2,arguments.length),i.validateWritablePath("OnDisconnect.update",this.Yn),Array.isArray(e)){for(var n={},s=0;s<e.length;++s)n[""+s]=e[s];e=n,o.warn("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}i.validateFirebaseMergeDataArg("OnDisconnect.update",1,e,this.Yn,!1),r.validateCallback("OnDisconnect.update",2,t,!0);var u=new a.Deferred;return this.we.onDisconnectUpdate(this.Yn,e,u.wrapCallback(t)),u.promise},e}();t.OnDisconnect=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(e,t){this.committed=e,this.snapshot=t}return e.prototype.toJSON=function(){return r.validateArgCount("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},e}();t.TransactionResult=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.nextPushId=function(){var e="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",t=0,n=[];return function(i){var o=i===t;t=i;var a,s=Array(8);for(a=7;a>=0;a--)s[a]=e.charAt(i%64),i=Math.floor(i/64);r.assert(0===i,"Cannot push at time == 0");var u=s.join("");if(o){for(a=11;a>=0&&63===n[a];a--)n[a]=0;n[a]++}else for(a=0;a<12;a++)n[a]=Math.floor(64*Math.random());for(a=0;a<12;a++)u+=e.charAt(n[a]);return r.assert(20===u.length,"nextPushId: Length should be 20."),u}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(41),i=n(85),o=n(0),a=n(0),s=function(){function e(e,t,n){this.Xn=e,this.zn=t,this.Jn=n}return e.prototype.respondsTo=function(e){return"value"===e},e.prototype.createEvent=function(e,t){var n=t.getQueryParams().getIndex();return new i.DataEvent("value",this,new r.DataSnapshot(e.snapshotNode,t.getRef(),n))},e.prototype.getEventRunner=function(e){var t=this.Jn;if("cancel"===e.getEventType()){a.assert(this.zn,"Raising a cancel event on a listener with no cancel callback");var n=this.zn;return function(){n.call(t,e.error)}}var r=this.Xn;return function(){r.call(t,e.snapshot)}},e.prototype.createCancelEvent=function(e,t){return this.zn?new i.CancelEvent(this,e,t):null},e.prototype.matches=function(t){return t instanceof e&&(!t.Xn||!this.Xn||t.Xn===this.Xn&&t.Jn===this.Jn)},e.prototype.hasAnyCallback=function(){return null!==this.Xn},e}();t.ValueEventRegistration=s;var u=function(){function e(e,t,n){this.$n=e,this.zn=t,this.Jn=n}return e.prototype.respondsTo=function(e){var t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,o.contains(this.$n,t)},e.prototype.createCancelEvent=function(e,t){return this.zn?new i.CancelEvent(this,e,t):null},e.prototype.createEvent=function(e,t){a.assert(null!=e.childName,"Child events should have a childName.");var n=t.getRef().child(e.childName),o=t.getQueryParams().getIndex();return new i.DataEvent(e.type,this,new r.DataSnapshot(e.snapshotNode,n,o),e.prevName)},e.prototype.getEventRunner=function(e){var t=this.Jn;if("cancel"===e.getEventType()){a.assert(this.zn,"Raising a cancel event on a listener with no cancel callback");var n=this.zn;return function(){n.call(t,e.error)}}var r=this.$n[e.eventType];return function(){r.call(t,e.snapshot,e.prevName)}},e.prototype.matches=function(t){if(t instanceof e){if(!this.$n||!t.$n)return!0;if(this.Jn===t.Jn){var n=o.getCount(t.$n);if(n===o.getCount(this.$n)){if(1===n){var r=o.getAnyKey(t.$n),i=o.getAnyKey(this.$n);return!(i!==r||t.$n[r]&&this.$n[i]&&t.$n[r]!==this.$n[i])}return o.every(this.$n,function(e,n){return t.$n[e]===n})}}}return!1},e.prototype.hasAnyCallback=function(){return null!==this.$n},e}();t.ChildEventRegistration=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}return e.prototype.getPath=function(){var e=this.snapshot.getRef();return"value"===this.eventType?e.path:e.getParent().path},e.prototype.getEventType=function(){return this.eventType},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.getPath()+":"+this.eventType+":"+r.stringify(this.snapshot.exportVal())},e}();t.DataEvent=i;var o=function(){function e(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}return e.prototype.getPath=function(){return this.path},e.prototype.getEventType=function(){return"cancel"},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.path+":cancel"},e}();t.CancelEvent=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(1),o=n(87),a=n(4),s=n(0),u=n(22),l=n(88),h=n(89),c=n(8),p=n(45),d=n(2),f=n(46),_=n(95),y=function(){function e(e){this.Zn=e,this.er=u.ImmutableTree.Empty,this.tr=new _.WriteTree,this.nr={},this.rr={}}return e.prototype.applyUserOverwrite=function(e,t,n,r){return this.tr.addOverwrite(e,t,n,r),r?this.ir(new p.Overwrite(c.OperationSource.User,e,t)):[]},e.prototype.applyUserMerge=function(e,t,n){this.tr.addMerge(e,t,n);var r=u.ImmutableTree.fromObject(t);return this.ir(new h.Merge(c.OperationSource.User,e,r))},e.prototype.ackUserWrite=function(e,t){void 0===t&&(t=!1);var n=this.tr.getWrite(e);if(this.tr.removeWrite(e)){var r=u.ImmutableTree.Empty;return null!=n.snap?r=r.set(d.Path.Empty,!0):s.forEach(n.children,function(e,t){r=r.set(new d.Path(e),t)}),this.ir(new o.AckUserWrite(n.path,r,t))}return[]},e.prototype.applyServerOverwrite=function(e,t){return this.ir(new p.Overwrite(c.OperationSource.Server,e,t))},e.prototype.applyServerMerge=function(e,t){var n=u.ImmutableTree.fromObject(t);return this.ir(new h.Merge(c.OperationSource.Server,e,n))},e.prototype.applyListenComplete=function(e){return this.ir(new l.ListenComplete(c.OperationSource.Server,e))},e.prototype.applyTaggedQueryOverwrite=function(t,n,r){var i=this.or(r);if(null!=i){var o=e.ar(i),a=o.path,s=o.queryId,u=d.Path.relativePath(a,t),l=new p.Overwrite(c.OperationSource.forServerTaggedQuery(s),u,n);return this.sr(a,l)}return[]},e.prototype.applyTaggedQueryMerge=function(t,n,r){var i=this.or(r);if(i){var o=e.ar(i),a=o.path,s=o.queryId,l=d.Path.relativePath(a,t),p=u.ImmutableTree.fromObject(n),f=new h.Merge(c.OperationSource.forServerTaggedQuery(s),l,p);return this.sr(a,f)}return[]},e.prototype.applyTaggedListenComplete=function(t,n){var r=this.or(n);if(r){var i=e.ar(r),o=i.path,a=i.queryId,s=d.Path.relativePath(o,t),u=new l.ListenComplete(c.OperationSource.forServerTaggedQuery(a),s);return this.sr(o,u)}return[]},e.prototype.addEventRegistration=function(t,n){var i=t.path,o=null,s=!1;this.er.foreachOnPath(i,function(e,t){var n=d.Path.relativePath(e,i);o=o||t.getCompleteServerCache(n),s=s||t.hasCompleteView()});var u=this.er.get(i);u?(s=s||u.hasCompleteView(),o=o||u.getCompleteServerCache(d.Path.Empty)):(u=new f.SyncPoint,this.er=this.er.set(i,u));var l;null!=o?l=!0:(l=!1,o=a.ChildrenNode.EMPTY_NODE,this.er.subtree(i).foreachChild(function(e,t){var n=t.getCompleteServerCache(d.Path.Empty);n&&(o=o.updateImmediateChild(e,n))}));var h=u.viewExistsForQuery(t);if(!h&&!t.getQueryParams().loadsAllData()){var c=e.ur(t);r.assert(!(c in this.rr),"View does not exist, but we have a tag");var p=e.lr();this.rr[c]=p,this.nr["_"+p]=c}var _=this.tr.childWrites(i),y=u.addEventRegistration(t,n,_,o,l);if(!h&&!s){var v=u.viewForQuery(t);y=y.concat(this.hr(t,v))}return y},e.prototype.removeEventRegistration=function(t,n,r){var i=this,o=t.path,a=this.er.get(o),s=[];if(a&&("default"===t.queryIdentifier()||a.viewExistsForQuery(t))){var u=a.removeEventRegistration(t,n,r);a.isEmpty()&&(this.er=this.er.remove(o));var l=u.removed;s=u.events;var h=-1!==l.findIndex(function(e){return e.getQueryParams().loadsAllData()}),c=this.er.findOnPath(o,function(e,t){return t.hasCompleteView()});if(h&&!c){var p=this.er.subtree(o);if(!p.isEmpty())for(var d=this.cr(p),f=0;f<d.length;++f){var _=d[f],y=_.getQuery(),v=this.pr(_);this.Zn.startListening(e.dr(y),this.fr(y),v.hashFn,v.onComplete)}}!c&&l.length>0&&!r&&(h?this.Zn.stopListening(e.dr(t),null):l.forEach(function(t){var n=i.rr[e.ur(t)];i.Zn.stopListening(e.dr(t),n)})),this._r(l)}return s},e.prototype.calcCompleteEventCache=function(e,t){var n=this.tr,r=this.er.findOnPath(e,function(t,n){var r=d.Path.relativePath(t,e),i=n.getCompleteServerCache(r);if(i)return i});return n.calcCompleteEventCache(e,r,t,!0)},e.prototype.cr=function(e){return e.fold(function(e,t,n){if(t&&t.hasCompleteView())return[t.getCompleteView()];var r=[];return t&&(r=t.getQueryViews()),s.forEach(n,function(e,t){r=r.concat(t)}),r})},e.prototype._r=function(t){for(var n=0;n<t.length;++n){var r=t[n];if(!r.getQueryParams().loadsAllData()){var i=e.ur(r),o=this.rr[i];delete this.rr[i],delete this.nr["_"+o]}}},e.dr=function(e){return e.getQueryParams().loadsAllData()&&!e.getQueryParams().isDefault()?e.getRef():e},e.prototype.hr=function(t,n){var i=t.path,o=this.fr(t),a=this.pr(n),u=this.Zn.startListening(e.dr(t),o,a.hashFn,a.onComplete),l=this.er.subtree(i);if(o)r.assert(!l.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var h=l.fold(function(e,t,n){if(!e.isEmpty()&&t&&t.hasCompleteView())return[t.getCompleteView().getQuery()];var r=[];return t&&(r=r.concat(t.getQueryViews().map(function(e){return e.getQuery()}))),s.forEach(n,function(e,t){r=r.concat(t)}),r}),c=0;c<h.length;++c){var p=h[c];this.Zn.stopListening(e.dr(p),this.fr(p))}return u},e.prototype.pr=function(e){var t=this,n=e.getQuery(),r=this.fr(n);return{hashFn:function(){return(e.getServerCache()||a.ChildrenNode.EMPTY_NODE).hash()},onComplete:function(e){if("ok"===e)return r?t.applyTaggedListenComplete(n.path,r):t.applyListenComplete(n.path);var o=i.errorForServerCode(e,n);return t.removeEventRegistration(n,null,o)}}},e.ur=function(e){return e.path+"$"+e.queryIdentifier()},e.ar=function(e){var t=e.indexOf("$");return r.assert(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new d.Path(e.substr(0,t))}},e.prototype.or=function(e){return this.nr["_"+e]},e.prototype.fr=function(t){var n=e.ur(t);return s.safeGet(this.rr,n)},e.lr=function(){return e.yr++},e.prototype.sr=function(e,t){var n=this.er.get(e);r.assert(n,"Missing sync point for query tag that we're tracking");var i=this.tr.childWrites(e);return n.applyOperation(t,i,null)},e.prototype.ir=function(e){return this.vr(e,this.er,null,this.tr.childWrites(d.Path.Empty))},e.prototype.vr=function(e,t,n,r){if(e.path.isEmpty())return this.gr(e,t,n,r);var i=t.get(d.Path.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache(d.Path.Empty));var o=[],a=e.path.getFront(),s=e.operationForChild(a),u=t.children.get(a);if(u&&s){var l=n?n.getImmediateChild(a):null,h=r.child(a);o=o.concat(this.vr(s,u,l,h))}return i&&(o=o.concat(i.applyOperation(e,r,n))),o},e.prototype.gr=function(e,t,n,r){var i=this,o=t.get(d.Path.Empty);null==n&&null!=o&&(n=o.getCompleteServerCache(d.Path.Empty));var a=[];return t.children.inorderTraversal(function(t,o){var s=n?n.getImmediateChild(t):null,u=r.child(t),l=e.operationForChild(t);l&&(a=a.concat(i.gr(l,o,s,u)))}),o&&(a=a.concat(o.applyOperation(e,r,n))),a},e.yr=1,e}();t.SyncTree=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(2),o=n(8),a=function(){function e(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=o.OperationType.ACK_USER_WRITE,this.source=o.OperationSource.User}return e.prototype.operationForChild=function(t){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return r.assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new i.Path(t));return new e(i.Path.Empty,n,this.revert)}return r.assert(this.path.getFront()===t,"operationForChild called for unrelated child."),new e(this.path.popFront(),this.affectedTree,this.revert)},e}();t.AckUserWrite=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(8),o=function(){function e(e,t){this.source=e,this.path=t,this.type=i.OperationType.LISTEN_COMPLETE}return e.prototype.operationForChild=function(t){return this.path.isEmpty()?new e(this.source,r.Path.Empty):new e(this.source,this.path.popFront())},e}();t.ListenComplete=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),i=n(45),o=n(2),a=n(0),s=function(){function e(e,t,n){this.source=e,this.path=t,this.children=n,this.type=r.OperationType.MERGE}return e.prototype.operationForChild=function(t){if(this.path.isEmpty()){var n=this.children.subtree(new o.Path(t));return n.isEmpty()?null:n.value?new i.Overwrite(this.source,o.Path.Empty,n.value):new e(this.source,o.Path.Empty,n)}return a.assert(this.path.getFront()===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,this.path.popFront(),this.children)},e.prototype.toString=function(){return"Operation("+this.path+": "+this.source+" merge: "+this.children+")"},e}();t.Merge=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(23),i=n(91),o=n(4),a=n(18),s=n(47),u=n(94),l=n(0),h=n(8),c=n(9),p=n(3),d=function(){function e(e,t){this.mr=e,this.Cr=[];var n=this.mr.getQueryParams(),l=new r.IndexedFilter(n.getIndex()),h=n.getNodeFilter();this.Er=new i.ViewProcessor(h);var c=t.getServerCache(),p=t.getEventCache(),d=l.updateFullNode(o.ChildrenNode.EMPTY_NODE,c.getNode(),null),f=h.updateFullNode(o.ChildrenNode.EMPTY_NODE,p.getNode(),null),_=new a.CacheNode(d,c.isFullyInitialized(),l.filtersNodes()),y=new a.CacheNode(f,p.isFullyInitialized(),h.filtersNodes());this.Nr=new s.ViewCache(y,_),this.Pr=new u.EventGenerator(this.mr)}return e.prototype.getQuery=function(){return this.mr},e.prototype.getServerCache=function(){return this.Nr.getServerCache().getNode()},e.prototype.getCompleteServerCache=function(e){var t=this.Nr.getCompleteServerSnap();return t&&(this.mr.getQueryParams().loadsAllData()||!e.isEmpty()&&!t.getImmediateChild(e.getFront()).isEmpty())?t.getChild(e):null},e.prototype.isEmpty=function(){return 0===this.Cr.length},e.prototype.addEventRegistration=function(e){this.Cr.push(e)},e.prototype.removeEventRegistration=function(e,t){var n=[];if(t){l.assert(null==e,"A cancel should cancel all event registrations.");var r=this.mr.path;this.Cr.forEach(function(e){t=t;var i=e.createCancelEvent(t,r);i&&n.push(i)})}if(e){for(var i=[],o=0;o<this.Cr.length;++o){var a=this.Cr[o];if(a.matches(e)){if(e.hasAnyCallback()){i=i.concat(this.Cr.slice(o+1));break}}else i.push(a)}this.Cr=i}else this.Cr=[];return n},e.prototype.applyOperation=function(e,t,n){e.type===h.OperationType.MERGE&&null!==e.source.queryId&&(l.assert(this.Nr.getCompleteServerSnap(),"We should always have a full cache before handling merges"),l.assert(this.Nr.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var r=this.Nr,i=this.Er.applyOperation(r,e,t,n);return this.Er.assertIndexed(i.viewCache),l.assert(i.viewCache.getServerCache().isFullyInitialized()||!r.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.Nr=i.viewCache,this.br(i.changes,i.viewCache.getEventCache().getNode(),null)},e.prototype.getInitialEvents=function(e){var t=this.Nr.getEventCache(),n=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(p.PRIORITY_INDEX,function(e,t){n.push(c.Change.childAddedChange(e,t))}),t.isFullyInitialized()&&n.push(c.Change.valueChange(t.getNode())),this.br(n,t.getNode(),e)},e.prototype.br=function(e,t,n){var r=n?[n]:this.Cr;return this.Pr.generateEventsForChanges(e,t,r)},e}();t.View=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),i=n(0),o=n(92),a=n(9),s=n(4),u=n(10),l=n(22),h=n(2),c=n(93),p=function(){function e(e,t){this.viewCache=e,this.changes=t}return e}();t.ProcessorResult=p;var d=function(){function e(e){this.Sr=e}return e.prototype.assertIndexed=function(e){i.assert(e.getEventCache().getNode().isIndexed(this.Sr.getIndex()),"Event snap not indexed"),i.assert(e.getServerCache().getNode().isIndexed(this.Sr.getIndex()),"Server snap not indexed")},e.prototype.applyOperation=function(t,n,a,s){var u,l,h=new o.ChildChangeAccumulator;if(n.type===r.OperationType.OVERWRITE){var c=n;c.source.fromUser?u=this.Tr(t,c.path,c.snap,a,s,h):(i.assert(c.source.fromServer,"Unknown source."),l=c.source.tagged||t.getServerCache().isFiltered()&&!c.path.isEmpty(),u=this.wr(t,c.path,c.snap,a,s,l,h))}else if(n.type===r.OperationType.MERGE){var d=n;d.source.fromUser?u=this.Ir(t,d.path,d.children,a,s,h):(i.assert(d.source.fromServer,"Unknown source."),l=d.source.tagged||t.getServerCache().isFiltered(),u=this.Rr(t,d.path,d.children,a,s,l,h))}else if(n.type===r.OperationType.ACK_USER_WRITE){var f=n;u=f.revert?this.Or(t,f.path,a,s,h):this.Ar(t,f.path,f.affectedTree,a,s,h)}else{if(n.type!==r.OperationType.LISTEN_COMPLETE)throw i.assertionError("Unknown operation type: "+n.type);u=this.Dr(t,n.path,a,h)}var _=h.getChanges();return e.Mr(t,u,_),new p(u,_)},e.Mr=function(e,t,n){var r=t.getEventCache();if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=e.getCompleteEventSnap();(n.length>0||!e.getEventCache().isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(a.Change.valueChange(t.getCompleteEventSnap()))}},e.prototype.Lr=function(e,t,n,r,o){var a=e.getEventCache();if(null!=n.shadowingWrite(t))return e;var u=void 0,l=void 0;if(t.isEmpty())if(i.assert(e.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),e.getServerCache().isFiltered()){var h=e.getCompleteServerSnap(),c=h instanceof s.ChildrenNode?h:s.ChildrenNode.EMPTY_NODE,p=n.calcCompleteEventChildren(c);u=this.Sr.updateFullNode(e.getEventCache().getNode(),p,o)}else{var d=n.calcCompleteEventCache(e.getCompleteServerSnap());u=this.Sr.updateFullNode(e.getEventCache().getNode(),d,o)}else{var f=t.getFront();if(".priority"==f){i.assert(1==t.getLength(),"Can't have a priority with additional path components");var _=a.getNode();l=e.getServerCache().getNode();var y=n.calcEventCacheAfterServerOverwrite(t,_,l);u=null!=y?this.Sr.updatePriority(_,y):a.getNode()}else{var v=t.popFront(),g=void 0;if(a.isCompleteForChild(f)){l=e.getServerCache().getNode();var m=n.calcEventCacheAfterServerOverwrite(t,a.getNode(),l);g=null!=m?a.getNode().getImmediateChild(f).updateChild(v,m):a.getNode().getImmediateChild(f)}else g=n.calcCompleteChild(f,e.getServerCache());u=null!=g?this.Sr.updateChild(a.getNode(),f,g,v,r,o):a.getNode()}}return e.updateEventSnap(u,a.isFullyInitialized()||t.isEmpty(),this.Sr.filtersNodes())},e.prototype.wr=function(e,t,n,r,i,o,a){var s,u=e.getServerCache(),l=o?this.Sr:this.Sr.getIndexedFilter();if(t.isEmpty())s=l.updateFullNode(u.getNode(),n,null);else if(l.filtersNodes()&&!u.isFiltered()){var h=u.getNode().updateChild(t,n);s=l.updateFullNode(u.getNode(),h,null)}else{var p=t.getFront();if(!u.isCompleteForPath(t)&&t.getLength()>1)return e;var d=t.popFront(),f=u.getNode().getImmediateChild(p),_=f.updateChild(d,n);s=".priority"==p?l.updatePriority(u.getNode(),_):l.updateChild(u.getNode(),p,_,d,c.NO_COMPLETE_CHILD_SOURCE,null)}var y=e.updateServerSnap(s,u.isFullyInitialized()||t.isEmpty(),l.filtersNodes()),v=new c.WriteTreeCompleteChildSource(r,y,i);return this.Lr(y,t,r,v,a)},e.prototype.Tr=function(e,t,n,r,i,o){var a,u,l=e.getEventCache(),h=new c.WriteTreeCompleteChildSource(r,e,i);if(t.isEmpty())u=this.Sr.updateFullNode(e.getEventCache().getNode(),n,o),a=e.updateEventSnap(u,!0,this.Sr.filtersNodes());else{var p=t.getFront();if(".priority"===p)u=this.Sr.updatePriority(e.getEventCache().getNode(),n),a=e.updateEventSnap(u,l.isFullyInitialized(),l.isFiltered());else{var d=t.popFront(),f=l.getNode().getImmediateChild(p),_=void 0;if(d.isEmpty())_=n;else{var y=h.getCompleteChild(p);_=null!=y?".priority"===d.getBack()&&y.getChild(d.parent()).isEmpty()?y:y.updateChild(d,n):s.ChildrenNode.EMPTY_NODE}if(f.equals(_))a=e;else{var v=this.Sr.updateChild(l.getNode(),p,_,d,h,o);a=e.updateEventSnap(v,l.isFullyInitialized(),this.Sr.filtersNodes())}}}return a},e.Fr=function(e,t){return e.getEventCache().isCompleteForChild(t)},e.prototype.Ir=function(t,n,r,i,o,a){var s=this,u=t;return r.foreach(function(r,l){var h=n.child(r);e.Fr(t,h.getFront())&&(u=s.Tr(u,h,l,i,o,a))}),r.foreach(function(r,l){var h=n.child(r);e.Fr(t,h.getFront())||(u=s.Tr(u,h,l,i,o,a))}),u},e.prototype.xr=function(e,t){return t.foreach(function(t,n){e=e.updateChild(t,n)}),e},e.prototype.Rr=function(e,t,n,r,i,o,a){var s=this;if(e.getServerCache().getNode().isEmpty()&&!e.getServerCache().isFullyInitialized())return e;var u,c=e;u=t.isEmpty()?n:l.ImmutableTree.Empty.setTree(t,n);var p=e.getServerCache().getNode();return u.children.inorderTraversal(function(t,n){if(p.hasChild(t)){var u=e.getServerCache().getNode().getImmediateChild(t),l=s.xr(u,n);c=s.wr(c,new h.Path(t),l,r,i,o,a)}}),u.children.inorderTraversal(function(t,n){var u=!e.getServerCache().isCompleteForChild(t)&&null==n.value;if(!p.hasChild(t)&&!u){var l=e.getServerCache().getNode().getImmediateChild(t),d=s.xr(l,n);c=s.wr(c,new h.Path(t),d,r,i,o,a)}}),c},e.prototype.Ar=function(e,t,n,r,i,o){if(null!=r.shadowingWrite(t))return e;var a=e.getServerCache().isFiltered(),s=e.getServerCache();if(null!=n.value){if(t.isEmpty()&&s.isFullyInitialized()||s.isCompleteForPath(t))return this.wr(e,t,s.getNode().getChild(t),r,i,a,o);if(t.isEmpty()){var c=l.ImmutableTree.Empty;return s.getNode().forEachChild(u.KEY_INDEX,function(e,t){c=c.set(new h.Path(e),t)}),this.Rr(e,t,c,r,i,a,o)}return e}var p=l.ImmutableTree.Empty;return n.foreach(function(e,n){var r=t.child(e);s.isCompleteForPath(r)&&(p=p.set(e,s.getNode().getChild(r)))}),this.Rr(e,t,p,r,i,a,o)},e.prototype.Dr=function(e,t,n,r){var i=e.getServerCache(),o=e.updateServerSnap(i.getNode(),i.isFullyInitialized()||t.isEmpty(),i.isFiltered());return this.Lr(o,t,n,c.NO_COMPLETE_CHILD_SOURCE,r)},e.prototype.Or=function(e,t,n,r,o){var a;if(null!=n.shadowingWrite(t))return e;var u=new c.WriteTreeCompleteChildSource(n,e,r),l=e.getEventCache().getNode(),p=void 0;if(t.isEmpty()||".priority"===t.getFront()){var d=void 0;if(e.getServerCache().isFullyInitialized())d=n.calcCompleteEventCache(e.getCompleteServerSnap());else{var f=e.getServerCache().getNode();i.assert(f instanceof s.ChildrenNode,"serverChildren would be complete if leaf node"),d=n.calcCompleteEventChildren(f)}d=d,p=this.Sr.updateFullNode(l,d,o)}else{var _=t.getFront(),y=n.calcCompleteChild(_,e.getServerCache());null==y&&e.getServerCache().isCompleteForChild(_)&&(y=l.getImmediateChild(_)),p=null!=y?this.Sr.updateChild(l,_,y,t.popFront(),u,o):e.getEventCache().getNode().hasChild(_)?this.Sr.updateChild(l,_,s.ChildrenNode.EMPTY_NODE,t.popFront(),u,o):l,p.isEmpty()&&e.getServerCache().isFullyInitialized()&&(a=n.calcCompleteEventCache(e.getCompleteServerSnap()),a.isLeafNode()&&(p=this.Sr.updateFullNode(p,a,o)))}return a=e.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(h.Path.Empty),e.updateEventSnap(p,a,this.Sr.filtersNodes())},e}();t.ViewProcessor=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(9),o=n(0),a=function(){function e(){this.kr={}}return e.prototype.trackChildChange=function(e){var t=e.type,n=e.childName;o.assert(t==i.Change.CHILD_ADDED||t==i.Change.CHILD_CHANGED||t==i.Change.CHILD_REMOVED,"Only child changes supported for tracking"),o.assert(".priority"!==n,"Only non-priority child changes can be tracked.");var a=r.safeGet(this.kr,n);if(a){var s=a.type;if(t==i.Change.CHILD_ADDED&&s==i.Change.CHILD_REMOVED)this.kr[n]=i.Change.childChangedChange(n,e.snapshotNode,a.snapshotNode);else if(t==i.Change.CHILD_REMOVED&&s==i.Change.CHILD_ADDED)delete this.kr[n];else if(t==i.Change.CHILD_REMOVED&&s==i.Change.CHILD_CHANGED)this.kr[n]=i.Change.childRemovedChange(n,a.oldSnap);else if(t==i.Change.CHILD_CHANGED&&s==i.Change.CHILD_ADDED)this.kr[n]=i.Change.childAddedChange(n,e.snapshotNode);else{if(t!=i.Change.CHILD_CHANGED||s!=i.Change.CHILD_CHANGED)throw o.assertionError("Illegal combination of changes: "+e+" occurred after "+a);this.kr[n]=i.Change.childChangedChange(n,e.snapshotNode,a.oldSnap)}}else this.kr[n]=e},e.prototype.getChanges=function(){return r.getValues(this.kr)},e}();t.ChildChangeAccumulator=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(18),i=function(){function e(){}return e.prototype.getCompleteChild=function(e){return null},e.prototype.getChildAfterChild=function(e,t,n){return null},e}();t.Wr=i,t.NO_COMPLETE_CHILD_SOURCE=new i;var o=function(){function e(e,t,n){void 0===n&&(n=null),this.jr=e,this.Nr=t,this.Vr=n}return e.prototype.getCompleteChild=function(e){var t=this.Nr.getEventCache();if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.Vr?new r.CacheNode(this.Vr,!0,!1):this.Nr.getServerCache();return this.jr.calcCompleteChild(e,n)},e.prototype.getChildAfterChild=function(e,t,n){var r=null!=this.Vr?this.Vr:this.Nr.getCompleteServerSnap(),i=this.jr.calcIndexedSlice(r,t,1,n,e);return 0===i.length?null:i[0]},e}();t.WriteTreeCompleteChildSource=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),i=n(9),o=n(0),a=function(){function e(e){this.mr=e,this.Ne=this.mr.getQueryParams().getIndex()}return e.prototype.generateEventsForChanges=function(e,t,n){var r=this,o=[],a=[];return e.forEach(function(e){e.type===i.Change.CHILD_CHANGED&&r.Ne.indexedValueChanged(e.oldSnap,e.snapshotNode)&&a.push(i.Change.childMovedChange(e.childName,e.snapshotNode))}),this.Qr(o,i.Change.CHILD_REMOVED,e,n,t),this.Qr(o,i.Change.CHILD_ADDED,e,n,t),this.Qr(o,i.Change.CHILD_MOVED,a,n,t),this.Qr(o,i.Change.CHILD_CHANGED,e,n,t),this.Qr(o,i.Change.VALUE,e,n,t),o},e.prototype.Qr=function(e,t,n,r,i){var o=this,a=n.filter(function(e){return e.type===t});a.sort(this.qr.bind(this)),a.forEach(function(t){var n=o.Ur(t,i);r.forEach(function(r){r.respondsTo(t.type)&&e.push(r.createEvent(n,o.mr))})})},e.prototype.Ur=function(e,t){return"value"===e.type||"child_removed"===e.type?e:(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,this.Ne),e)},e.prototype.qr=function(e,t){if(null==e.childName||null==t.childName)throw o.assertionError("Should only compare child_ events.");var n=new r.NamedNode(e.childName,e.snapshotNode),i=new r.NamedNode(t.childName,t.snapshotNode);return this.Ne.compare(n,i)},e}();t.EventGenerator=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(0),o=n(2),a=n(96),s=n(3),u=n(4),l=function(){function e(){this.Br=a.CompoundWrite.Empty,this.Hr=[],this.Gr=-1}return e.prototype.childWrites=function(e){return new h(e,this)},e.prototype.addOverwrite=function(e,t,n,r){i.assert(n>this.Gr,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),this.Hr.push({path:e,snap:t,writeId:n,visible:r}),r&&(this.Br=this.Br.addWrite(e,t)),this.Gr=n},e.prototype.addMerge=function(e,t,n){i.assert(n>this.Gr,"Stacking an older merge on top of newer ones"),this.Hr.push({path:e,children:t,writeId:n,visible:!0}),this.Br=this.Br.addWrites(e,t),this.Gr=n},e.prototype.getWrite=function(e){for(var t=0;t<this.Hr.length;t++){var n=this.Hr[t];if(n.writeId===e)return n}return null},e.prototype.removeWrite=function(e){var t=this,n=this.Hr.findIndex(function(t){return t.writeId===e});i.assert(n>=0,"removeWrite called with nonexistent writeId.");var o=this.Hr[n];this.Hr.splice(n,1);for(var a=o.visible,s=!1,u=this.Hr.length-1;a&&u>=0;){var l=this.Hr[u];l.visible&&(u>=n&&this.Kr(l,o.path)?a=!1:o.path.contains(l.path)&&(s=!0)),u--}if(a){if(s)return this.Yr(),!0;if(o.snap)this.Br=this.Br.removeWrite(o.path);else{var h=o.children;r.forEach(h,function(e){t.Br=t.Br.removeWrite(o.path.child(e))})}return!0}return!1},e.prototype.getCompleteWriteData=function(e){return this.Br.getCompleteNode(e)},e.prototype.calcCompleteEventCache=function(t,n,r,i){if(r||i){var a=this.Br.childCompoundWrite(t);if(!i&&a.isEmpty())return n;if(i||null!=n||a.hasCompleteWrite(o.Path.Empty)){var s=function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(e.path.contains(t)||t.contains(e.path))},l=e.Xr(this.Hr,s,t),h=n||u.ChildrenNode.EMPTY_NODE;return l.apply(h)}return null}var c=this.Br.getCompleteNode(t);if(null!=c)return c;var p=this.Br.childCompoundWrite(t);if(p.isEmpty())return n;if(null!=n||p.hasCompleteWrite(o.Path.Empty)){var h=n||u.ChildrenNode.EMPTY_NODE;return p.apply(h)}return null},e.prototype.calcCompleteEventChildren=function(e,t){var n=u.ChildrenNode.EMPTY_NODE,r=this.Br.getCompleteNode(e);if(r)return r.isLeafNode()||r.forEachChild(s.PRIORITY_INDEX,function(e,t){n=n.updateImmediateChild(e,t)}),n;if(t){var i=this.Br.childCompoundWrite(e);return t.forEachChild(s.PRIORITY_INDEX,function(e,t){var r=i.childCompoundWrite(new o.Path(e)).apply(t);n=n.updateImmediateChild(e,r)}),i.getCompleteChildren().forEach(function(e){n=n.updateImmediateChild(e.name,e.node)}),n}return this.Br.childCompoundWrite(e).getCompleteChildren().forEach(function(e){n=n.updateImmediateChild(e.name,e.node)}),n},e.prototype.calcEventCacheAfterServerOverwrite=function(e,t,n,r){i.assert(n||r,"Either existingEventSnap or existingServerSnap must exist");var o=e.child(t);if(this.Br.hasCompleteWrite(o))return null;var a=this.Br.childCompoundWrite(o);return a.isEmpty()?r.getChild(t):a.apply(r.getChild(t))},e.prototype.calcCompleteChild=function(e,t,n){var r=e.child(t),i=this.Br.getCompleteNode(r);return null!=i?i:n.isCompleteForChild(t)?this.Br.childCompoundWrite(r).apply(n.getNode().getImmediateChild(t)):null},e.prototype.shadowingWrite=function(e){return this.Br.getCompleteNode(e)},e.prototype.calcIndexedSlice=function(e,t,n,r,i,a){var s,u=this.Br.childCompoundWrite(e),l=u.getCompleteNode(o.Path.Empty);if(null!=l)s=l;else{if(null==t)return[];s=u.apply(t)}if(s=s.withIndex(a),s.isEmpty()||s.isLeafNode())return[];for(var h=[],c=a.getCompare(),p=i?s.getReverseIteratorFrom(n,a):s.getIteratorFrom(n,a),d=p.getNext();d&&h.length<r;)0!==c(d,n)&&h.push(d),d=p.getNext();return h},e.prototype.Kr=function(e,t){return e.snap?e.path.contains(t):!!r.findKey(e.children,function(n,r){return e.path.child(r).contains(t)})},e.prototype.Yr=function(){this.Br=e.Xr(this.Hr,e.zr,o.Path.Empty),this.Hr.length>0?this.Gr=this.Hr[this.Hr.length-1].writeId:this.Gr=-1},e.zr=function(e){return e.visible},e.Xr=function(e,t,n){for(var s=a.CompoundWrite.Empty,u=0;u<e.length;++u){var l=e[u];if(t(l)){var h=l.path,c=void 0;if(l.snap)n.contains(h)?(c=o.Path.relativePath(n,h),s=s.addWrite(c,l.snap)):h.contains(n)&&(c=o.Path.relativePath(h,n),s=s.addWrite(o.Path.Empty,l.snap.getChild(c)));else{if(!l.children)throw i.assertionError("WriteRecord should have .snap or .children");if(n.contains(h))c=o.Path.relativePath(n,h),s=s.addWrites(c,l.children);else if(h.contains(n))if(c=o.Path.relativePath(h,n),c.isEmpty())s=s.addWrites(o.Path.Empty,l.children);else{var p=r.safeGet(l.children,c.getFront());if(p){var d=p.getChild(c.popFront());s=s.addWrite(o.Path.Empty,d)}}}}}return s},e}();t.WriteTree=l;var h=function(){function e(e,t){this.Jr=e,this.$r=t}return e.prototype.calcCompleteEventCache=function(e,t,n){return this.$r.calcCompleteEventCache(this.Jr,e,t,n)},e.prototype.calcCompleteEventChildren=function(e){return this.$r.calcCompleteEventChildren(this.Jr,e)},e.prototype.calcEventCacheAfterServerOverwrite=function(e,t,n){return this.$r.calcEventCacheAfterServerOverwrite(this.Jr,e,t,n)},e.prototype.shadowingWrite=function(e){return this.$r.shadowingWrite(this.Jr.child(e))},e.prototype.calcIndexedSlice=function(e,t,n,r,i){return this.$r.calcIndexedSlice(this.Jr,e,t,n,r,i)},e.prototype.calcCompleteChild=function(e,t){return this.$r.calcCompleteChild(this.Jr,e,t)},e.prototype.child=function(t){return new e(this.Jr.child(t),this.$r)},e}();t.WriteTreeRef=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(22),i=n(2),o=n(0),a=n(5),s=n(3),u=n(0),l=function(){function e(e){this.$r=e}return e.prototype.addWrite=function(t,n){if(t.isEmpty())return new e(new r.ImmutableTree(n));var o=this.$r.findRootMostValueAndPath(t);if(null!=o){var a=o.path,s=o.value,u=i.Path.relativePath(a,t);return s=s.updateChild(u,n),new e(this.$r.set(a,s))}var l=new r.ImmutableTree(n);return new e(this.$r.setTree(t,l))},e.prototype.addWrites=function(e,t){var n=this;return o.forEach(t,function(t,r){n=n.addWrite(e.child(t),r)}),n},e.prototype.removeWrite=function(t){return t.isEmpty()?e.Empty:new e(this.$r.setTree(t,r.ImmutableTree.Empty))},e.prototype.hasCompleteWrite=function(e){return null!=this.getCompleteNode(e)},e.prototype.getCompleteNode=function(e){var t=this.$r.findRootMostValueAndPath(e);return null!=t?this.$r.get(t.path).getChild(i.Path.relativePath(t.path,e)):null},e.prototype.getCompleteChildren=function(){var e=[],t=this.$r.value;return null!=t?t.isLeafNode()||t.forEachChild(s.PRIORITY_INDEX,function(t,n){e.push(new a.NamedNode(t,n))}):this.$r.children.inorderTraversal(function(t,n){null!=n.value&&e.push(new a.NamedNode(t,n.value))}),e},e.prototype.childCompoundWrite=function(t){if(t.isEmpty())return this;var n=this.getCompleteNode(t);return new e(null!=n?new r.ImmutableTree(n):this.$r.subtree(t))},e.prototype.isEmpty=function(){return this.$r.isEmpty()},e.prototype.apply=function(t){return e.Zr(i.Path.Empty,this.$r,t)},e.Empty=new e(new r.ImmutableTree(null)),e.Zr=function(t,n,r){if(null!=n.value)return r.updateChild(t,n.value);var i=null;return n.children.inorderTraversal(function(n,o){".priority"===n?(u.assert(null!==o.value,"Priority writes must always be leaf nodes"),i=o.value):r=e.Zr(t.child(n),o,r)}),r.getChild(t).isEmpty()||null===i||(r=r.updateChild(t.child(".priority"),i)),r},e}();t.CompoundWrite=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=function(){function e(){this.ei=r.ChildrenNode.EMPTY_NODE}return e.prototype.getNode=function(e){return this.ei.getChild(e)},e.prototype.updateSnapshot=function(e,t){this.ei=this.ei.updateChild(e,t)},e}();t.SnapshotHolder=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=function(){function e(e){this.ti=e}return e.prototype.getToken=function(e){return this.ti.INTERNAL.getToken(e).then(null,function(e){return e&&"auth/token-not-initialized"===e.code?(r.log("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)})},e.prototype.addTokenChangeListener=function(e){this.ti.INTERNAL.addAuthTokenListener(e)},e.prototype.removeTokenChangeListener=function(e){this.ti.INTERNAL.removeAuthTokenListener(e)},e.prototype.notifyForInvalidToken=function(){var e='Provided authentication credentials for the app named "'+this.ti.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.ti.options?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.ti.options?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',r.warn(e)},e}();t.AuthTokenProvider=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(0),o=function(){function e(){this.ni={}}return e.prototype.incrementCounter=function(e,t){void 0===t&&(t=1),i.contains(this.ni,e)||(this.ni[e]=0),this.ni[e]+=t},e.prototype.get=function(){return r.deepCopy(this.ni)},e}();t.StatsCollection=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(1),o=n(48),a=1e4,s=3e4,u=function(){function e(e,t){this.Z=t,this.ri={},this.G=new o.StatsListener(e);var n=a+(s-a)*Math.random();i.setTimeoutNonBlocking(this.ii.bind(this),Math.floor(n))}return e.prototype.includeStat=function(e){this.ri[e]=!0},e.prototype.ii=function(){var e=this,t=this.G.get(),n={},o=!1;r.forEach(t,function(t,i){i>0&&r.contains(e.ri,t)&&(n[t]=i,o=!0)}),o&&this.Z.reportStats(n),i.setTimeoutNonBlocking(this.ii.bind(this),Math.floor(2*Math.random()*3e5))},e}();t.StatsReporter=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=function(){function e(){this.oi=[],this.ai=0}return e.prototype.queueEvents=function(e){for(var t=null,n=0;n<e.length;n++){var r=e[n],i=r.getPath();null===t||i.equals(t.getPath())||(this.oi.push(t),t=null),null===t&&(t=new o(i)),t.add(r)}t&&this.oi.push(t)},e.prototype.raiseEventsAtPath=function(e,t){this.queueEvents(t),this.si(function(t){return t.equals(e)})},e.prototype.raiseEventsForChangedPath=function(e,t){this.queueEvents(t),this.si(function(t){return t.contains(e)||e.contains(t)})},e.prototype.si=function(e){this.ai++;for(var t=!0,n=0;n<this.oi.length;n++){var r=this.oi[n];r&&(e(r.getPath())?(this.oi[n].raise(),this.oi[n]=null):t=!1)}t&&(this.oi=[]),this.ai--},e}();t.EventQueue=i;var o=function(){function e(e){this.Yn=e,this.ui=[]}return e.prototype.add=function(e){this.ui.push(e)},e.prototype.raise=function(){for(var e=0;e<this.ui.length;e++){var t=this.ui[e];if(null!==t){this.ui[e]=null;var n=t.getEventRunner();r.logger&&r.log("event: "+t),r.exceptionGuard(n)}}},e.prototype.getPath=function(){return this.Yn},e}();t.EventList=o},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(50),o=n(0),a=function(e){function t(){var t,n,r=e.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",t="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",t="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",t="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",t="webkitHidden")),r.ot=!0,n&&document.addEventListener(n,function(){var e=!document[t];e!==r.ot&&(r.ot=e,r.trigger("visible",e))},!1),r}return r(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return o.assert("visible"===e,"Unknown event type: "+e),[this.ot]},t}(i.EventEmitter);t.VisibilityMonitor=a},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(50),a=n(0),s=function(e){function t(){var t=e.call(this,["online"])||this;return t.li=!0,"undefined"==typeof window||void 0===window.addEventListener||a.isMobileCordova()||(window.addEventListener("online",function(){t.li||(t.li=!0,t.trigger("online",!0))},!1),window.addEventListener("offline",function(){t.li&&(t.li=!1,t.trigger("online",!1))},!1)),t}return r(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return i.assert("online"===e,"Unknown event type: "+e),[this.li]},t.prototype.currentlyOnline=function(){return this.li},t}(o.EventEmitter);t.OnlineMonitor=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(52),i=n(53),o=n(1),a=function(){function e(e){this.hi(e)}return Object.defineProperty(e,"ALL_TRANSPORTS",{get:function(){return[r.BrowserPollConnection,i.WebSocketConnection]},enumerable:!0,configurable:!0}),e.prototype.hi=function(t){var n=i.WebSocketConnection&&i.WebSocketConnection.isAvailable(),r=n&&!i.WebSocketConnection.previouslyFailed();if(t.webSocketOnly&&(n||o.warn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.ci=[i.WebSocketConnection];else{var a=this.ci=[];o.each(e.ALL_TRANSPORTS,function(e,t){t&&t.isAvailable()&&a.push(t)})}},e.prototype.initialTransport=function(){if(this.ci.length>0)return this.ci[0];throw Error("No transports available")},e.prototype.upgradeTransport=function(){return this.ci.length>1?this.ci[1]:null},e}();t.TransportManager=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=function(){function e(e){this.qt=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return e.prototype.closeAfter=function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},e.prototype.handleResponse=function(e,t){var n=this;this.pendingResponses[e]=t;for(var i=this;this.pendingResponses[this.currentResponseNum]&&"break"!==function(){var e=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var t=0;t<e.length;++t)!function(t){e[t]&&r.exceptionGuard(function(){n.qt(e[t])})}(t);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++}(););},e}();t.PacketReceiver=i},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(1),a=n(0),s=n(0),u=n(0),l=n(54),h=function(e){function t(t,n,r){var i=e.call(this)||this;return i.H=t,i.ee=n,i.Ge=r,i.de=o.logWrapper("p:rest:"),i.ze={},i}return r(t,e),t.prototype.reportStats=function(e){throw Error("Method not implemented.")},t.pi=function(e,t){return void 0!==t?"tag$"+t:(i.assert(e.getQueryParams().isDefault(),"should have a tag if it's not a default query."),""+e.path)},t.prototype.listen=function(e,n,r,i){var o=this,a=""+e.path;this.de("Listen called for "+a+" "+e.queryIdentifier());var u=t.pi(e,r),l={};this.ze[u]=l;var h=e.getQueryParams().toRestQueryStringParameters();this.di(a+".json",h,function(e,t){var n=t;if(404===e&&(n=null,e=null),null===e&&o.ee(a,n,!1,r),s.safeGet(o.ze,u)===l){var h;h=e?401==e?"permission_denied":"rest_error:"+e:"ok",i(h,null)}})},t.prototype.unlisten=function(e,n){var r=t.pi(e,n);delete this.ze[r]},t.prototype.refreshAuthToken=function(e){},t.prototype.di=function(e,t,n){var r=this;void 0===t&&(t={}),t.format="export",this.Ge.getToken(!1).then(function(i){var s=i&&i.accessToken;s&&(t.auth=s);var l=(r.H.secure?"https://":"http://")+r.H.host+e+"?"+u.querystring(t);r.de("Sending REST request for "+l);var h=new XMLHttpRequest;h.onreadystatechange=function(){if(n&&4===h.readyState){r.de("REST Response for "+l+" received. status:",h.status,"response:",h.responseText);var e=null;if(h.status>=200&&h.status<300){try{e=a.jsonEval(h.responseText)}catch(e){o.warn("Failed to parse JSON response for "+l+": "+h.responseText)}n(null,e)}else 401!==h.status&&404!==h.status&&o.warn("Got unsuccessful REST response for "+l+" Status: "+h.status),n(h.status);n=null}},h.open("GET",l,!0),h.send()})},t}(l.ServerActions);t.ReadonlyRestClient=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(1),o=n(10),a=n(3),s=n(36),u=n(40),l=n(23),h=n(108),c=n(55),p=n(0),d=function(){function e(){this.fi=!1,this._i=!1,this.yi=!1,this.vi=!1,this.gi=!1,this.mi=0,this.Ci="",this.Ei=null,this.Ni="",this.Pi=null,this.bi="",this.Ne=a.PRIORITY_INDEX}return e.prototype.hasStart=function(){return this._i},e.prototype.isViewFromLeft=function(){return""===this.Ci?this._i:this.Ci===e.Si.VIEW_FROM_LEFT},e.prototype.getIndexStartValue=function(){return r.assert(this._i,"Only valid if start has been set"),this.Ei},e.prototype.getIndexStartName=function(){return r.assert(this._i,"Only valid if start has been set"),this.yi?this.Ni:i.MIN_NAME},e.prototype.hasEnd=function(){return this.vi},e.prototype.getIndexEndValue=function(){return r.assert(this.vi,"Only valid if end has been set"),this.Pi},e.prototype.getIndexEndName=function(){return r.assert(this.vi,"Only valid if end has been set"),this.gi?this.bi:i.MAX_NAME},e.prototype.hasLimit=function(){return this.fi},e.prototype.hasAnchoredLimit=function(){return this.fi&&""!==this.Ci},e.prototype.getLimit=function(){return r.assert(this.fi,"Only valid if limit has been set"),this.mi},e.prototype.getIndex=function(){return this.Ne},e.prototype.Ti=function(){var t=new e;return t.fi=this.fi,t.mi=this.mi,t._i=this._i,t.Ei=this.Ei,t.yi=this.yi,t.Ni=this.Ni,t.vi=this.vi,t.Pi=this.Pi,t.gi=this.gi,t.bi=this.bi,t.Ne=this.Ne,t.Ci=this.Ci,t},e.prototype.limit=function(e){var t=this.Ti();return t.fi=!0,t.mi=e,t.Ci="",t},e.prototype.limitToFirst=function(t){var n=this.Ti();return n.fi=!0,n.mi=t,n.Ci=e.Si.VIEW_FROM_LEFT,n},e.prototype.limitToLast=function(t){var n=this.Ti();return n.fi=!0,n.mi=t,n.Ci=e.Si.VIEW_FROM_RIGHT,n},e.prototype.startAt=function(e,t){var n=this.Ti();return n._i=!0,void 0===e&&(e=null),n.Ei=e,null!=t?(n.yi=!0,n.Ni=t):(n.yi=!1,n.Ni=""),n},e.prototype.endAt=function(e,t){var n=this.Ti();return n.vi=!0,void 0===e&&(e=null),n.Pi=e,void 0!==t?(n.gi=!0,n.bi=t):(n.gi=!1,n.bi=""),n},e.prototype.orderBy=function(e){var t=this.Ti();return t.Ne=e,t},e.prototype.getQueryObject=function(){var t=e.Si,n={};if(this._i&&(n[t.INDEX_START_VALUE]=this.Ei,this.yi&&(n[t.INDEX_START_NAME]=this.Ni)),this.vi&&(n[t.INDEX_END_VALUE]=this.Pi,this.gi&&(n[t.INDEX_END_NAME]=this.bi)),this.fi){n[t.LIMIT]=this.mi;var r=this.Ci;""===r&&(r=this.isViewFromLeft()?t.VIEW_FROM_LEFT:t.VIEW_FROM_RIGHT),n[t.VIEW_FROM]=r}return this.Ne!==a.PRIORITY_INDEX&&(n[t.INDEX]=""+this.Ne),n},e.prototype.loadsAllData=function(){return!(this._i||this.vi||this.fi)},e.prototype.isDefault=function(){return this.loadsAllData()&&this.Ne==a.PRIORITY_INDEX},e.prototype.getNodeFilter=function(){return this.loadsAllData()?new l.IndexedFilter(this.getIndex()):this.hasLimit()?new h.LimitedFilter(this):new c.RangedFilter(this)},e.prototype.toRestQueryStringParameters=function(){var t=e.wi,n={};if(this.isDefault())return n;var i;return this.Ne===a.PRIORITY_INDEX?i=t.PRIORITY_INDEX:this.Ne===s.VALUE_INDEX?i=t.VALUE_INDEX:this.Ne===o.KEY_INDEX?i=t.KEY_INDEX:(r.assert(this.Ne instanceof u.PathIndex,"Unrecognized index type!"),i=""+this.Ne),n[t.ORDER_BY]=p.stringify(i),this._i&&(n[t.START_AT]=p.stringify(this.Ei),this.yi&&(n[t.START_AT]+=","+p.stringify(this.Ni))),this.vi&&(n[t.END_AT]=p.stringify(this.Pi),this.gi&&(n[t.END_AT]+=","+p.stringify(this.bi))),this.fi&&(this.isViewFromLeft()?n[t.LIMIT_TO_FIRST]=this.mi:n[t.LIMIT_TO_LAST]=this.mi),n},e.Si={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},e.wi={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},e.DEFAULT=new e,e}();t.QueryParams=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55),i=n(4),o=n(5),a=n(0),s=n(9),u=function(){function e(e){this.Ii=new r.RangedFilter(e),this.Ne=e.getIndex(),this.mi=e.getLimit(),this.Ri=!e.isViewFromLeft()}return e.prototype.updateChild=function(e,t,n,r,a,s){return this.Ii.matches(new o.NamedNode(t,n))||(n=i.ChildrenNode.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.mi?this.Ii.getIndexedFilter().updateChild(e,t,n,r,a,s):this.Oi(e,t,n,a,s)},e.prototype.updateFullNode=function(e,t,n){var r;if(t.isLeafNode()||t.isEmpty())r=i.ChildrenNode.EMPTY_NODE.withIndex(this.Ne);else if(2*this.mi<t.numChildren()&&t.isIndexed(this.Ne)){r=i.ChildrenNode.EMPTY_NODE.withIndex(this.Ne);var o=void 0;o=this.Ri?t.getReverseIteratorFrom(this.Ii.getEndPost(),this.Ne):t.getIteratorFrom(this.Ii.getStartPost(),this.Ne);for(var a=0;o.hasNext()&&a<this.mi;){var s=o.getNext(),u=void 0;if(!(u=this.Ri?this.Ne.compare(this.Ii.getStartPost(),s)<=0:this.Ne.compare(s,this.Ii.getEndPost())<=0))break;r=r.updateImmediateChild(s.name,s.node),a++}}else{r=t.withIndex(this.Ne),r=r.updatePriority(i.ChildrenNode.EMPTY_NODE);var l=void 0,h=void 0,c=void 0,o=void 0;if(this.Ri){o=r.getReverseIterator(this.Ne),l=this.Ii.getEndPost(),h=this.Ii.getStartPost();var p=this.Ne.getCompare();c=function(e,t){return p(t,e)}}else o=r.getIterator(this.Ne),l=this.Ii.getStartPost(),h=this.Ii.getEndPost(),c=this.Ne.getCompare();for(var a=0,d=!1;o.hasNext();){var s=o.getNext();!d&&c(l,s)<=0&&(d=!0);var u=d&&a<this.mi&&c(s,h)<=0;u?a++:r=r.updateImmediateChild(s.name,i.ChildrenNode.EMPTY_NODE)}}return this.Ii.getIndexedFilter().updateFullNode(e,r,n)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.Ii.getIndexedFilter()},e.prototype.getIndex=function(){return this.Ne},e.prototype.Oi=function(e,t,n,r,u){var l;if(this.Ri){var h=this.Ne.getCompare();l=function(e,t){return h(t,e)}}else l=this.Ne.getCompare();var c=e;a.assert(c.numChildren()==this.mi,"");var p=new o.NamedNode(t,n),d=this.Ri?c.getFirstChild(this.Ne):c.getLastChild(this.Ne),f=this.Ii.matches(p);if(c.hasChild(t)){for(var _=c.getImmediateChild(t),y=r.getChildAfterChild(this.Ne,d,this.Ri);null!=y&&(y.name==t||c.hasChild(y.name));)y=r.getChildAfterChild(this.Ne,y,this.Ri);var v=null==y?1:l(y,p);if(f&&!n.isEmpty()&&v>=0)return null!=u&&u.trackChildChange(s.Change.childChangedChange(t,n,_)),c.updateImmediateChild(t,n);null!=u&&u.trackChildChange(s.Change.childRemovedChange(t,_));var g=c.updateImmediateChild(t,i.ChildrenNode.EMPTY_NODE);return null!=y&&this.Ii.matches(y)?(null!=u&&u.trackChildChange(s.Change.childAddedChange(y.name,y.node)),g.updateImmediateChild(y.name,y.node)):g}return n.isEmpty()?e:f&&l(d,p)>=0?(null!=u&&(u.trackChildChange(s.Change.childRemovedChange(d.name,d.node)),u.trackChildChange(s.Change.childAddedChange(t,n))),c.updateImmediateChild(t,n).updateImmediateChild(d.name,i.ChildrenNode.EMPTY_NODE)):e},e}();t.LimitedFilter=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(0),o=n(21),a=n(41),s=n(2),u=n(110),l=n(3),h=n(1),c=n(42),p=n(7),d=n(0),f=n(11),_=n(4),y=n(17);!function(e){e[e.RUN=0]="RUN",e[e.SENT=1]="SENT",e[e.COMPLETED=2]="COMPLETED",e[e.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",e[e.NEEDS_ABORT=4]="NEEDS_ABORT"}(r=t.TransactionStatus||(t.TransactionStatus={})),y.Repo.Ai=25,y.Repo.prototype.ie=function(){this.Di=new u.Tree},y.Repo.prototype.startTransaction=function(e,t,n,s){this.de("transaction on "+e);var u=function(){},y=new o.Reference(this,e);y.on("value",u);var v=function(){y.off("value",u)},g={path:e,update:t,onComplete:n,status:null,order:h.LUIDGenerator(),applyLocally:s,retryCount:0,unwatcher:v,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},m=this.Mi(e);g.currentInputSnapshot=m;var C=g.update(m.val());if(void 0===C){if(g.unwatcher(),g.currentOutputSnapshotRaw=null,g.currentOutputSnapshotResolved=null,g.onComplete){var E=new a.DataSnapshot(g.currentInputSnapshot,new o.Reference(this,g.path),l.PRIORITY_INDEX);g.onComplete(null,!1,E)}}else{p.validateFirebaseData("transaction failed: Data returned ",C,g.path),g.status=r.RUN;var N=this.Di.subTree(e),P=N.getValue()||[];P.push(g),N.setValue(P);var b=void 0;"object"==typeof C&&null!==C&&d.contains(C,".priority")?(b=d.safeGet(C,".priority"),i.assert(p.isValidPriority(b),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):b=(this.ue.calcCompleteEventCache(e)||_.ChildrenNode.EMPTY_NODE).getPriority().val(),b=b;var S=this.generateServerValues(),T=f.nodeFromJSON(C,b),w=c.resolveDeferredValueSnapshot(T,S);g.currentOutputSnapshotRaw=T,g.currentOutputSnapshotResolved=w,g.currentWriteId=this.pe();var I=this.ue.applyUserOverwrite(e,w,g.currentWriteId,g.applyLocally);this.K.raiseEventsForChangedPath(e,I),this.Li()}},y.Repo.prototype.Mi=function(e,t){return this.ue.calcCompleteEventCache(e,t)||_.ChildrenNode.EMPTY_NODE},y.Repo.prototype.Li=function(e){var t=this;if(void 0===e&&(e=this.Di),e||this.Fi(e),null!==e.getValue()){var n=this.xi(e);i.assert(n.length>0,"Sending zero length transaction queue"),n.every(function(e){return e.status===r.RUN})&&this.ki(e.path(),n)}else e.hasChildren()&&e.forEachChild(function(e){t.Li(e)})},y.Repo.prototype.ki=function(e,t){for(var n=this,u=t.map(function(e){return e.currentWriteId}),c=this.Mi(e,u),p=c,d=c.hash(),f=0;f<t.length;f++){var _=t[f];i.assert(_.status===r.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),_.status=r.SENT,_.retryCount++;var y=s.Path.relativePath(e,_.path);p=p.updateChild(y,_.currentOutputSnapshotRaw)}var v=p.val(!0),g=e;this.Z.put(""+g,v,function(i){n.de("transaction put response",{path:""+g,status:i});var s=[];if("ok"===i){for(var u=[],c=0;c<t.length;c++){if(t[c].status=r.COMPLETED,s=s.concat(n.ue.ackUserWrite(t[c].currentWriteId)),t[c].onComplete){var p=t[c].currentOutputSnapshotResolved,d=new o.Reference(n,t[c].path),f=new a.DataSnapshot(p,d,l.PRIORITY_INDEX);u.push(t[c].onComplete.bind(null,null,!0,f))}t[c].unwatcher()}n.Fi(n.Di.subTree(e)),n.Li(),n.K.raiseEventsForChangedPath(e,s);for(var c=0;c<u.length;c++)h.exceptionGuard(u[c])}else{if("datastale"===i)for(var c=0;c<t.length;c++)t[c].status===r.SENT_NEEDS_ABORT?t[c].status=r.NEEDS_ABORT:t[c].status=r.RUN;else{h.warn("transaction at "+g+" failed: "+i);for(var c=0;c<t.length;c++)t[c].status=r.NEEDS_ABORT,t[c].abortReason=i}n.le(e)}},d)},y.Repo.prototype.le=function(e){var t=this.Wi(e),n=t.path(),r=this.xi(t);return this.ji(r,n),n},y.Repo.prototype.ji=function(e,t){if(0!==e.length){for(var n=[],u=[],_=e.filter(function(e){return e.status===r.RUN}),v=_.map(function(e){return e.currentWriteId}),g=0;g<e.length;g++){var m=e[g],C=s.Path.relativePath(t,m.path),E=!1,N=void 0;if(i.assert(null!==C,"rerunTransactionsUnderNode_: relativePath should not be null."),m.status===r.NEEDS_ABORT)E=!0,N=m.abortReason,u=u.concat(this.ue.ackUserWrite(m.currentWriteId,!0));else if(m.status===r.RUN)if(m.retryCount>=y.Repo.Ai)E=!0,N="maxretry",u=u.concat(this.ue.ackUserWrite(m.currentWriteId,!0));else{var P=this.Mi(m.path,v);m.currentInputSnapshot=P;var b=e[g].update(P.val());if(void 0!==b){p.validateFirebaseData("transaction failed: Data returned ",b,m.path);var S=f.nodeFromJSON(b),T="object"==typeof b&&null!=b&&d.contains(b,".priority");T||(S=S.updatePriority(P.getPriority()));var w=m.currentWriteId,I=this.generateServerValues(),R=c.resolveDeferredValueSnapshot(S,I);m.currentOutputSnapshotRaw=S,m.currentOutputSnapshotResolved=R,m.currentWriteId=this.pe(),v.splice(v.indexOf(w),1),u=u.concat(this.ue.applyUserOverwrite(m.path,R,m.currentWriteId,m.applyLocally)),u=u.concat(this.ue.ackUserWrite(w,!0))}else E=!0,N="nodata",u=u.concat(this.ue.ackUserWrite(m.currentWriteId,!0))}if(this.K.raiseEventsForChangedPath(t,u),u=[],E&&(e[g].status=r.COMPLETED,function(e){setTimeout(e,Math.floor(0))}(e[g].unwatcher),e[g].onComplete))if("nodata"===N){var O=new o.Reference(this,e[g].path),A=e[g].currentInputSnapshot,D=new a.DataSnapshot(A,O,l.PRIORITY_INDEX);n.push(e[g].onComplete.bind(null,null,!1,D))}else n.push(e[g].onComplete.bind(null,Error(N),!1,null))}this.Fi(this.Di);for(var g=0;g<n.length;g++)h.exceptionGuard(n[g]);this.Li()}},y.Repo.prototype.Wi=function(e){for(var t,n=this.Di;null!==(t=e.getFront())&&null===n.getValue();)n=n.subTree(t),e=e.popFront();return n},y.Repo.prototype.xi=function(e){var t=[];return this.Vi(e,t),t.sort(function(e,t){return e.order-t.order}),t},y.Repo.prototype.Vi=function(e,t){var n=this,r=e.getValue();if(null!==r)for(var i=0;i<r.length;i++)t.push(r[i]);e.forEachChild(function(e){n.Vi(e,t)})},y.Repo.prototype.Fi=function(e){var t=this,n=e.getValue();if(n){for(var i=0,o=0;o<n.length;o++)n[o].status!==r.COMPLETED&&(n[i]=n[o],i++);n.length=i,e.setValue(n.length>0?n:null)}e.forEachChild(function(e){t.Fi(e)})},y.Repo.prototype.fe=function(e){var t=this,n=this.Wi(e).path(),r=this.Di.subTree(e);return r.forEachAncestor(function(e){t.Qi(e)}),this.Qi(r),r.forEachDescendant(function(e){t.Qi(e)}),n},y.Repo.prototype.Qi=function(e){var t=e.getValue();if(null!==t){for(var n=[],o=[],a=-1,s=0;s<t.length;s++)t[s].status===r.SENT_NEEDS_ABORT||(t[s].status===r.SENT?(i.assert(a===s-1,"All SENT items should be at beginning of queue."),a=s,t[s].status=r.SENT_NEEDS_ABORT,t[s].abortReason="set"):(i.assert(t[s].status===r.RUN,"Unexpected transaction status in abort"),t[s].unwatcher(),o=o.concat(this.ue.ackUserWrite(t[s].currentWriteId,!0)),t[s].onComplete&&n.push(t[s].onComplete.bind(null,Error("set"),!1,null))));-1===a?e.setValue(null):t.length=a+1,this.K.raiseEventsForChangedPath(e.path(),o);for(var s=0;s<n.length;s++)h.exceptionGuard(n[s])}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(2),o=n(0),a=function(){function e(){this.children={},this.childCount=0,this.value=null}return e}();t.TreeNode=a;var s=function(){function e(e,t,n){void 0===e&&(e=""),void 0===t&&(t=null),void 0===n&&(n=new a),this.qi=e,this.Ui=t,this._e=n}return e.prototype.subTree=function(t){for(var n,r=t instanceof i.Path?t:new i.Path(t),s=this;null!==(n=r.getFront());)s=new e(n,s,o.safeGet(s._e.children,n)||new a),r=r.popFront();return s},e.prototype.getValue=function(){return this._e.value},e.prototype.setValue=function(e){r.assert(void 0!==e,"Cannot set value to undefined"),this._e.value=e,this.Bi()},e.prototype.clear=function(){this._e.value=null,this._e.children={},this._e.childCount=0,this.Bi()},e.prototype.hasChildren=function(){return this._e.childCount>0},e.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},e.prototype.forEachChild=function(t){var n=this;o.forEach(this._e.children,function(r,i){t(new e(r,n,i))})},e.prototype.forEachDescendant=function(e,t,n){t&&!n&&e(this),this.forEachChild(function(t){t.forEachDescendant(e,!0,n)}),t&&n&&e(this)},e.prototype.forEachAncestor=function(e,t){for(var n=t?this:this.parent();null!==n;){if(e(n))return!0;n=n.parent()}return!1},e.prototype.forEachImmediateDescendantWithValue=function(e){this.forEachChild(function(t){null!==t.getValue()?e(t):t.forEachImmediateDescendantWithValue(e)})},e.prototype.path=function(){return new i.Path(null===this.Ui?this.qi:this.Ui.path()+"/"+this.qi)},e.prototype.name=function(){return this.qi},e.prototype.parent=function(){return this.Ui},e.prototype.Bi=function(){null!==this.Ui&&this.Ui.Hi(this.qi,this)},e.prototype.Hi=function(e,t){var n=t.isEmpty(),r=o.contains(this._e.children,e);n&&r?(delete this._e.children[e],this._e.childCount--,this.Bi()):n||r||(this._e.children[e]=t._e,this._e.childCount++,this.Bi())},e}();t.Tree=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(53),i=n(52);t.forceLongPolling=function(){r.WebSocketConnection.forceDisallow(),i.BrowserPollConnection.forceAllow()},t.forceWebSockets=function(){i.BrowserPollConnection.forceDisallow()},t.isWebSocketsAvailable=function(){return r.WebSocketConnection.isAvailable()},t.setSecurityDebugCallback=function(e,t){e.repo.J.rt=t},t.stats=function(e,t){e.repo.stats(t)},t.statsIncrementCounter=function(e,t){e.repo.statsIncrementCounter(t)},t.dataUpdateCount=function(e){return e.repo.dataUpdateCount},t.interceptServerData=function(e,t){return e.repo.he(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(33),i=n(49),o=n(25),a=n(51);t.DataConnection=i.PersistentConnection,i.PersistentConnection.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},i.PersistentConnection.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)},t.RealTimeConnection=a.Connection,t.hijackHash=function(e){var t=i.PersistentConnection.prototype.put;return i.PersistentConnection.prototype.put=function(n,r,i,o){void 0!==o&&(o=e()),t.call(this,n,r,i,o)},function(){i.PersistentConnection.prototype.put=t}},t.ConnectionTarget=r.RepoInfo,t.queryIdentifier=function(e){return e.queryIdentifier()},t.listens=function(e){return e.repo.J.ze},t.forceRestClient=function(e){o.RepoManager.getInstance().forceRestClient(e)}}],[77])}catch(e){throw Error("Cannot instantiate firebase-database.js - be sure to load firebase-app.js first.")}

/*!
 * @license Firebase v4.6.0
 * Build: rev-f5e674c
 * Terms: https://firebase.google.com/terms/
 */
try{webpackJsonpFirebase([3],{116:function(e,t,r){r(117)},117:function(e,t,r){"use strict";function n(e){var t=new Uint8Array(e);return window.btoa(String.fromCharCode.apply(null,t))}function o(e){var t=function(e){return self&&"ServiceWorkerGlobalScope"in self?new A(e):new k(e)},r={Messaging:k};e.INTERNAL.registerService("messaging",t,r)}Object.defineProperty(t,"__esModule",{value:!0});var i,s=r(0),a={AVAILABLE_IN_WINDOW:"only-available-in-window",AVAILABLE_IN_SW:"only-available-in-sw",SHOULD_BE_INHERITED:"should-be-overriden",BAD_SENDER_ID:"bad-sender-id",INCORRECT_GCM_SENDER_ID:"incorrect-gcm-sender-id",PERMISSION_DEFAULT:"permission-default",PERMISSION_BLOCKED:"permission-blocked",UNSUPPORTED_BROWSER:"unsupported-browser",NOTIFICATIONS_BLOCKED:"notifications-blocked",FAILED_DEFAULT_REGISTRATION:"failed-serviceworker-registration",SW_REGISTRATION_EXPECTED:"sw-registration-expected",GET_SUBSCRIPTION_FAILED:"get-subscription-failed",INVALID_SAVED_TOKEN:"invalid-saved-token",SW_REG_REDUNDANT:"sw-reg-redundant",TOKEN_SUBSCRIBE_FAILED:"token-subscribe-failed",TOKEN_SUBSCRIBE_NO_TOKEN:"token-subscribe-no-token",TOKEN_SUBSCRIBE_NO_PUSH_SET:"token-subscribe-no-push-set",USE_SW_BEFORE_GET_TOKEN:"use-sw-before-get-token",INVALID_DELETE_TOKEN:"invalid-delete-token",DELETE_TOKEN_NOT_FOUND:"delete-token-not-found",DELETE_SCOPE_NOT_FOUND:"delete-scope-not-found",BG_HANDLER_FUNCTION_EXPECTED:"bg-handler-function-expected",NO_WINDOW_CLIENT_TO_MSG:"no-window-client-to-msg",UNABLE_TO_RESUBSCRIBE:"unable-to-resubscribe",NO_FCM_TOKEN_FOR_RESUBSCRIBE:"no-fcm-token-for-resubscribe",FAILED_TO_DELETE_TOKEN:"failed-to-delete-token",NO_SW_IN_REG:"no-sw-in-reg",BAD_SCOPE:"bad-scope",BAD_VAPID_KEY:"bad-vapid-key",BAD_SUBSCRIPTION:"bad-subscription",BAD_TOKEN:"bad-token",BAD_PUSH_SET:"bad-push-set",FAILED_DELETE_VAPID_KEY:"failed-delete-vapid-key"},c=(i={},i[a.AVAILABLE_IN_WINDOW]="This method is available in a Window context.",i[a.AVAILABLE_IN_SW]="This method is available in a service worker context.",i["should-be-overriden"]="This method should be overriden by extended classes.",i["bad-sender-id"]="Please ensure that 'messagingSenderId' is set correctly in the options passed into firebase.initializeApp().",i["permission-default"]="The required permissions were not granted and dismissed instead.",i["permission-blocked"]="The required permissions were not granted and blocked instead.",i["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",i["notifications-blocked"]="Notifications have been blocked.",i[a.FAILED_DEFAULT_REGISTRATION]="We are unable to register the default service worker. {$browserErrorMessage}",i["sw-registration-expected"]="A service worker registration was the expected input.",i["get-subscription-failed"]="There was an error when trying to get any existing Push Subscriptions.",i["invalid-saved-token"]="Unable to access details of the saved token.",i["sw-reg-redundant"]="The service worker being used for push was made redundant.",i["token-subscribe-failed"]="A problem occured while subscribing the user to FCM: {$message}",i["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",i["token-subscribe-no-push-set"]="FCM returned an invalid response when getting an FCM token.",i["use-sw-before-get-token"]="You must call useServiceWorker() before calling getToken() to ensure your service worker is used.",i["invalid-delete-token"]="You must pass a valid token into deleteToken(), i.e. the token from getToken().",i["delete-token-not-found"]="The deletion attempt for token could not be performed as the token was not found.",i["delete-scope-not-found"]="The deletion attempt for service worker scope could not be performed as the scope was not found.",i["bg-handler-function-expected"]="The input to setBackgroundMessageHandler() must be a function.",i["no-window-client-to-msg"]="An attempt was made to message a non-existant window client.",i["unable-to-resubscribe"]="There was an error while re-subscribing the FCM token for push messaging. Will have to resubscribe the user on next visit. {$message}",i["no-fcm-token-for-resubscribe"]="Could not find an FCM token and as a result, unable to resubscribe. Will have to resubscribe the user on next visit.",i["failed-to-delete-token"]="Unable to delete the currently saved token.",i["no-sw-in-reg"]="Even though the service worker registration was successful, there was a problem accessing the service worker itself.",i["incorrect-gcm-sender-id"]="Please change your web app manifest's 'gcm_sender_id' value to '103953800507' to use Firebase messaging.",i["bad-scope"]="The service worker scope must be a string with at least one character.",i["bad-vapid-key"]="The public VAPID key must be a string with at least one character.",i["bad-subscription"]="The subscription must be a valid PushSubscription.",i["bad-token"]="The FCM Token used for storage / lookup was not a valid token string.",i["bad-push-set"]="The FCM push set used for storage / lookup was not not a valid push set string.",i["failed-delete-vapid-key"]="The VAPID key could not be deleted.",i),u={codes:a,map:c},_=function(e){return n(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},d=[4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110],f={userVisibleOnly:!0,applicationServerKey:new Uint8Array(d)},h={ENDPOINT:"https://fcm.googleapis.com",APPLICATION_SERVER_KEY:d,SUBSCRIPTION_OPTIONS:f},p="fcm_token_object_Store",l=function(){function e(){this.e=new s.ErrorFactory("messaging","Messaging",u.map),this.t=null}return e.prototype.r=function(){return this.t?this.t:(this.t=new Promise(function(t,r){var n=indexedDB.open(e.DB_NAME,1);n.onerror=function(e){r(e.target.error)},n.onsuccess=function(e){t(e.target.result)},n.onupgradeneeded=function(e){var t=e.target.result,r=t.createObjectStore(p,{keyPath:"swScope"});r.createIndex("fcmSenderId","fcmSenderId",{unique:!1}),r.createIndex("fcmToken","fcmToken",{unique:!0})}}),this.t)},e.prototype.closeDatabase=function(){var e=this;return this.t?this.t.then(function(t){t.close(),e.t=null}):Promise.resolve()},e.prototype.getTokenDetailsFromToken=function(e){return this.r().then(function(t){return new Promise(function(r,n){var o=t.transaction([p]),i=o.objectStore(p),s=i.index("fcmToken"),a=s.get(e);a.onerror=function(e){n(e.target.error)},a.onsuccess=function(e){r(e.target.result)}})})},e.prototype.n=function(e){return this.r().then(function(t){return new Promise(function(r,n){var o=t.transaction([p]),i=o.objectStore(p),s=i.get(e);s.onerror=function(e){n(e.target.error)},s.onsuccess=function(e){r(e.target.result)}})})},e.prototype.o=function(e){return this.r().then(function(t){return new Promise(function(r,n){var o=t.transaction([p]),i=o.objectStore(p),s=[],a=i.openCursor();a.onerror=function(e){n(e.target.error)},a.onsuccess=function(t){var n=t.target.result;n?(n.value.fcmSenderId===e&&s.push(n.value),n.continue()):r(s)}})})},e.prototype.subscribeToFCM=function(e,t,r){var n=this,o=_(t.getKey("p256dh")),i=_(t.getKey("auth")),s="authorized_entity="+e+"&endpoint="+t.endpoint+"&encryption_key="+o+"&encryption_auth="+i;r&&(s+="&pushSet="+r);var a=new Headers;a.append("Content-Type","application/x-www-form-urlencoded");var c={method:"POST",headers:a,body:s};return fetch(h.ENDPOINT+"/fcm/connect/subscribe",c).then(function(e){return e.json()}).then(function(e){var t=e;if(t.error){var r=t.error.message;throw n.e.create(u.codes.TOKEN_SUBSCRIBE_FAILED,{message:r})}if(!t.token)throw n.e.create(u.codes.TOKEN_SUBSCRIBE_NO_TOKEN);if(!t.pushSet)throw n.e.create(u.codes.TOKEN_SUBSCRIBE_NO_PUSH_SET);return{token:t.token,pushSet:t.pushSet}})},e.prototype.i=function(e,t){return e.endpoint===t.endpoint&&_(e.getKey("auth"))===t.auth&&_(e.getKey("p256dh"))===t.p256dh},e.prototype.s=function(e,t,r,n,o){var i={swScope:t.scope,endpoint:r.endpoint,auth:_(r.getKey("auth")),p256dh:_(r.getKey("p256dh")),fcmToken:n,fcmPushSet:o,fcmSenderId:e};return this.r().then(function(e){return new Promise(function(t,r){var n=e.transaction([p],"readwrite"),o=n.objectStore(p),s=o.put(i);s.onerror=function(e){r(e.target.error)},s.onsuccess=function(e){t()}})})},e.prototype.getSavedToken=function(e,t){var r=this;return t instanceof ServiceWorkerRegistration?"string"!=typeof e||0===e.length?Promise.reject(this.e.create(u.codes.BAD_SENDER_ID)):this.o(e).then(function(r){if(0!==r.length){var n=r.findIndex(function(r){return t.scope===r.swScope&&e===r.fcmSenderId});if(-1!==n)return r[n]}}).then(function(e){if(e)return t.pushManager.getSubscription().catch(function(e){throw r.e.create(u.codes.GET_SUBSCRIPTION_FAILED)}).then(function(t){if(t&&r.i(t,e))return e.fcmToken})}):Promise.reject(this.e.create(u.codes.SW_REGISTRATION_EXPECTED))},e.prototype.createToken=function(e,t){var r=this;if("string"!=typeof e||0===e.length)return Promise.reject(this.e.create(u.codes.BAD_SENDER_ID));if(!(t instanceof ServiceWorkerRegistration))return Promise.reject(this.e.create(u.codes.SW_REGISTRATION_EXPECTED));var n,o;return t.pushManager.getSubscription().then(function(e){return e||t.pushManager.subscribe(h.SUBSCRIPTION_OPTIONS)}).then(function(t){return n=t,r.subscribeToFCM(e,n)}).then(function(i){return o=i,r.s(e,t,n,o.token,o.pushSet)}).then(function(){return o.token})},e.prototype.deleteToken=function(e){var t=this;return"string"!=typeof e||0===e.length?Promise.reject(this.e.create(u.codes.INVALID_DELETE_TOKEN)):this.getTokenDetailsFromToken(e).then(function(e){if(!e)throw t.e.create(u.codes.DELETE_TOKEN_NOT_FOUND);return t.r().then(function(r){return new Promise(function(n,o){var i=r.transaction([p],"readwrite"),s=i.objectStore(p),a=s.delete(e.swScope);a.onerror=function(e){o(e.target.error)},a.onsuccess=function(r){if(0===r.target.result)return void o(t.e.create(u.codes.FAILED_TO_DELETE_TOKEN));n(e)}})})})},e}(),g=l,E="messagingSenderId",T=function(){function e(e){var t=this;if(this.e=new s.ErrorFactory("messaging","Messaging",u.map),!e.options[E]||"string"!=typeof e.options[E])throw this.e.create(u.codes.BAD_SENDER_ID);this.a=e.options[E],this.c=new g,this.app=e,this.INTERNAL={},this.INTERNAL.delete=function(){return t.delete}}return e.prototype.getToken=function(){var e=this,t=this.u();return"granted"!==t?"denied"===t?Promise.reject(this.e.create(u.codes.NOTIFICATIONS_BLOCKED)):Promise.resolve(null):this._().then(function(t){return e.c.getSavedToken(e.a,t).then(function(r){return r||e.c.createToken(e.a,t)})})},e.prototype.deleteToken=function(e){var t=this;return this.c.deleteToken(e).then(function(){return t._().then(function(e){if(e)return e.pushManager.getSubscription()}).then(function(e){if(e)return e.unsubscribe()})})},e.prototype._=function(){throw this.e.create(u.codes.SHOULD_BE_INHERITED)},e.prototype.requestPermission=function(){throw this.e.create(u.codes.AVAILABLE_IN_WINDOW)},e.prototype.useServiceWorker=function(e){throw this.e.create(u.codes.AVAILABLE_IN_WINDOW)},e.prototype.onMessage=function(e,t,r){throw this.e.create(u.codes.AVAILABLE_IN_WINDOW)},e.prototype.onTokenRefresh=function(e,t,r){throw this.e.create(u.codes.AVAILABLE_IN_WINDOW)},e.prototype.setBackgroundMessageHandler=function(e){throw this.e.create(u.codes.AVAILABLE_IN_SW)},e.prototype.delete=function(){return this.c.closeDatabase()},e.prototype.u=function(){return Notification.permission},e.prototype.getTokenManager=function(){return this.c},e}(),S=T,b={TYPE_OF_MSG:"firebase-messaging-msg-type",DATA:"firebase-messaging-msg-data"},v={PUSH_MSG_RECEIVED:"push-msg-received",NOTIFICATION_CLICKED:"notification-clicked"},I=function(e,t){return r={},r[b.TYPE_OF_MSG]=e,r[b.DATA]=t,r;var r},m={PARAMS:b,TYPES_OF_MSG:v,createNewMsg:I},y={path:"/firebase-messaging-sw.js",scope:"/firebase-cloud-messaging-push-scope"},N=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),w=function(e){function t(t){var r=e.call(this,t)||this;return r.d,r.f,r.h=null,r.p=Object(s.createSubscribe)(function(e){r.h=e}),r.l=null,r.g=Object(s.createSubscribe)(function(e){r.l=e}),r.T(),r}return N(t,e),t.prototype.getToken=function(){var t=this;return this.S()?this.b().then(function(){return e.prototype.getToken.call(t)}):Promise.reject(this.e.create(u.codes.UNSUPPORTED_BROWSER))},t.prototype.b=function(){var e=this;if(this.f)return this.f;var t=document.querySelector('link[rel="manifest"]');return this.f=t?fetch(t.href).then(function(e){return e.json()}).catch(function(){return Promise.resolve()}).then(function(t){if(t&&t.gcm_sender_id&&"103953800507"!==t.gcm_sender_id)throw e.e.create(u.codes.INCORRECT_GCM_SENDER_ID)}):Promise.resolve(),this.f},t.prototype.requestPermission=function(){var e=this;return"granted"===Notification.permission?Promise.resolve():new Promise(function(t,r){var n=function(n){return"granted"===n?t():r("denied"===n?e.e.create(u.codes.PERMISSION_BLOCKED):e.e.create(u.codes.PERMISSION_DEFAULT))},o=Notification.requestPermission(function(e){o||n(e)});o&&o.then(n)})},t.prototype.useServiceWorker=function(e){if(!(e instanceof ServiceWorkerRegistration))throw this.e.create(u.codes.SW_REGISTRATION_EXPECTED);if(void 0!==this.d)throw this.e.create(u.codes.USE_SW_BEFORE_GET_TOKEN);this.d=e},t.prototype.onMessage=function(e,t,r){return this.p(e,t,r)},t.prototype.onTokenRefresh=function(e,t,r){return this.g(e,t,r)},t.prototype.v=function(e){var t=this,r=e.installing||e.waiting||e.active;return new Promise(function(n,o){if(!r)return void o(t.e.create(u.codes.NO_SW_IN_REG));if("activated"===r.state)return void n(e);if("redundant"===r.state)return void o(t.e.create(u.codes.SW_REG_REDUNDANT));var i=function(){if("activated"===r.state)n(e);else{if("redundant"!==r.state)return;o(t.e.create(u.codes.SW_REG_REDUNDANT))}r.removeEventListener("statechange",i)};r.addEventListener("statechange",i)})},t.prototype._=function(){var e=this;return this.d?this.v(this.d):(this.d=null,navigator.serviceWorker.register(y.path,{scope:y.scope}).catch(function(t){throw e.e.create(u.codes.FAILED_DEFAULT_REGISTRATION,{browserErrorMessage:t.message})}).then(function(t){return e.v(t).then(function(){return e.d=t,t.update(),t})}))},t.prototype.T=function(){var e=this;"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",function(t){if(t.data&&t.data[m.PARAMS.TYPE_OF_MSG]){var r=t.data;switch(r[m.PARAMS.TYPE_OF_MSG]){case m.TYPES_OF_MSG.PUSH_MSG_RECEIVED:case m.TYPES_OF_MSG.NOTIFICATION_CLICKED:var n=r[m.PARAMS.DATA];e.h.next(n)}}},!1)},t.prototype.S=function(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")},t}(S),k=w,O=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),D=function(e){function t(t){var r=e.call(this,t)||this;return self.addEventListener("push",function(e){return r.I(e)},!1),self.addEventListener("pushsubscriptionchange",function(e){return r.m(e)},!1),self.addEventListener("notificationclick",function(e){return r.y(e)},!1),r.N=null,r}return O(t,e),t.prototype.I=function(e){var t,r=this;try{t=e.data.json()}catch(e){return}var n=this.w().then(function(e){if(e){if(t.notification||r.N)return r.k(t)}else{var n=r.O(t);if(n){var o=n.title||"";return self.registration.showNotification(o,n)}if(r.N)return r.N(t)}});e.waitUntil(n)},t.prototype.m=function(e){var t=this,r=this.getToken().then(function(e){if(!e)throw t.e.create(u.codes.NO_FCM_TOKEN_FOR_RESUBSCRIBE);var r=null,n=t.getTokenManager();return n.getTokenDetailsFromToken(e).then(function(e){if(!(r=e))throw t.e.create(u.codes.INVALID_SAVED_TOKEN);return self.registration.pushManager.subscribe(h.SUBSCRIPTION_OPTIONS)}).then(function(e){return n.subscribeToFCM(r.fcmSenderId,e,r.fcmPushSet)}).catch(function(e){return n.deleteToken(r.fcmToken).then(function(){throw t.e.create(u.codes.UNABLE_TO_RESUBSCRIBE,{message:e})})})});e.waitUntil(r)},t.prototype.y=function(e){var t=this;if(e.notification&&e.notification.data&&e.notification.data.FCM_MSG){e.stopImmediatePropagation(),e.notification.close();var r=e.notification.data.FCM_MSG,n=r.notification.click_action;if(n){var o=this.D(n).then(function(e){return e||self.clients.openWindow(n)}).then(function(e){if(e){r.notification,delete r.notification;var n=m.createNewMsg(m.TYPES_OF_MSG.NOTIFICATION_CLICKED,r);return t.A(e,n)}});e.waitUntil(o)}}},t.prototype.O=function(e){if(e&&"object"==typeof e.notification){var t=Object.assign({},e.notification);return t.data=(r={},r.FCM_MSG=e,r),t;var r}},t.prototype.setBackgroundMessageHandler=function(e){if(e&&"function"!=typeof e)throw this.e.create(u.codes.BG_HANDLER_FUNCTION_EXPECTED);this.N=e},t.prototype.D=function(e){var t=new URL(e).href;return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(e){for(var r=null,n=0;n<e.length;n++)if(new URL(e[n].url).href===t){r=e[n];break}if(r)return r.focus(),r})},t.prototype.A=function(e,t){var r=this;return new Promise(function(n,o){if(!e)return o(r.e.create(u.codes.NO_WINDOW_CLIENT_TO_MSG));e.postMessage(t),n()})},t.prototype.w=function(){return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(e){return e.some(function(e){return"visible"===e.visibilityState})})},t.prototype.k=function(e){var t=this;return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(r){var n=m.createNewMsg(m.TYPES_OF_MSG.PUSH_MSG_RECEIVED,e);return Promise.all(r.map(function(e){return t.A(e,n)}))})},t.prototype._=function(){return Promise.resolve(self.registration)},t}(S),A=D,P=r(6);t.registerMessaging=o,o(P.default)}},[116])}catch(e){throw Error("Cannot instantiate firebase-messaging.js - be sure to load firebase-app.js first.")}

/*!
 * @license Firebase v4.6.0
 * Build: rev-f5e674c
 * Terms: https://firebase.google.com/terms/
 */
try{webpackJsonpFirebase([2],{118:function(t,e,n){n(119)},119:function(t,e,n){"use strict";function r(t){return"storage/"+t}function o(){return new te(ee.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function i(t){return new te(ee.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function a(t){return new te(ee.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function s(){return new te(ee.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}function u(t){return new te(ee.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function c(){return new te(ee.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function l(){return new te(ee.CANCELED,"User canceled the upload/download.")}function h(t){return new te(ee.INVALID_URL,"Invalid URL '"+t+"'.")}function p(t){return new te(ee.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function f(){return new te(ee.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function d(){return new te(ee.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function _(){return new te(ee.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function v(t,e,n){return new te(ee.INVALID_ARGUMENT,"Invalid argument in `"+e+"` at index "+t+": "+n)}function b(t,e,n,r){var o,i;return t===e?(o=t,i=1===t?"argument":"arguments"):(o="between "+t+" and "+e,i="arguments"),new te(ee.INVALID_ARGUMENT_COUNT,"Invalid argument count in `"+n+"`: Expected "+o+" "+i+", received "+r+".")}function m(){return new te(ee.APP_DELETED,"The Firebase app was deleted.")}function g(t){return new te(ee.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function y(t,e){return new te(ee.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function R(t){throw new te(ee.INTERNAL_ERROR,"Internal error: "+t)}function E(t){switch(t){case ne.RAW:case ne.BASE64:case ne.BASE64URL:case ne.DATA_URL:return;default:throw"Expected one of the event types: ["+ne.RAW+", "+ne.BASE64+", "+ne.BASE64URL+", "+ne.DATA_URL+"]."}}function w(t,e){switch(t){case ne.RAW:return new re(U(e));case ne.BASE64:case ne.BASE64URL:return new re(A(t,e));case ne.DATA_URL:return new re(N(e),O(e))}throw o()}function U(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|63&r);else if(55296==(64512&r)){var o=n<t.length-1&&56320==(64512&t.charCodeAt(n+1));if(o){var i=r,a=t.charCodeAt(++n);r=65536|(1023&i)<<10|1023&a,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else e.push(239,191,189)}else 56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function T(t){var e;try{e=decodeURIComponent(t)}catch(t){throw y(ne.DATA_URL,"Malformed data URL.")}return U(e)}function A(t,e){switch(t){case ne.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r){var o=n?"-":"_";throw y(t,"Invalid character '"+o+"' found: is it base64url encoded?")}break;case ne.BASE64URL:var i=-1!==e.indexOf("+"),a=-1!==e.indexOf("/");if(i||a){var o=i?"+":"/";throw y(t,"Invalid character '"+o+"' found: is it base64 encoded?")}e=e.replace(/-/g,"+").replace(/_/g,"/")}var s;try{s=atob(e)}catch(e){throw y(t,"Invalid character found")}for(var u=new Uint8Array(s.length),c=0;c<s.length;c++)u[c]=s.charCodeAt(c);return u}function N(t){var e=new oe(t);return e.base64?A(ne.BASE64,e.rest):T(e.rest)}function O(t){return new oe(t).contentType}function C(t,e){return!!(t.length>=e.length)&&t.substring(t.length-e.length)===e}function S(t){switch(t){case ae.RUNNING:case ae.PAUSING:case ae.CANCELING:return se.RUNNING;case ae.PAUSED:return se.PAUSED;case ae.SUCCESS:return se.SUCCESS;case ae.CANCELED:return se.CANCELED;case ae.ERROR:default:return se.ERROR}}function k(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function I(t,e){for(var n in t)k(t,n)&&e(n,t[n])}function L(t){if(null==t)return{};var e={};return I(t,function(t,n){e[t]=n}),e}function P(t){return new Promise(t)}function x(t){return Promise.resolve(t)}function D(t){return Promise.reject(t)}function M(t){return null!=t}function W(t){return void 0!==t}function B(t){return"function"==typeof t}function G(t){return"object"==typeof t}function j(t){return G(t)&&null!==t}function q(t){return G(t)&&!Array.isArray(t)}function F(t){return"string"==typeof t||t instanceof String}function H(t){return"number"==typeof t||t instanceof Number}function z(t){return X()&&t instanceof Blob}function X(){return"undefined"!=typeof Blob}function V(t){var e;try{e=JSON.parse(t)}catch(t){return null}return q(e)?e:null}function K(t){if(0==t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}function Z(t,e){var n=e.split("/").filter(function(t){return t.length>0}).join("/");return 0===t.length?n:t+"/"+n}function J(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function Q(t){return Vt+Zt+t}function Y(t){return Kt+Zt+t}function $(t){return Vt+Jt+t}function tt(t){var e=encodeURIComponent,n="?";return I(t,function(t,r){var o=e(t)+"="+e(r);n=n+o+"&"}),n=n.slice(0,-1)}function et(t,e){return e}function nt(t){return!F(t)||t.length<2?t:(t=t,J(t))}function rt(){function t(t,e){return nt(e)}function e(t,e){return M(e)?+e:e}function n(t,e){if(!(F(e)&&e.length>0))return[];var n=encodeURIComponent;return e.split(",").map(function(e){var r=t.bucket,o=t.fullPath;return Y("/b/"+n(r)+"/o/"+n(o))+tt({alt:"media",token:e})})}if(pe)return pe;var r=[];r.push(new he("bucket")),r.push(new he("generation")),r.push(new he("metageneration")),r.push(new he("name","fullPath",!0));var o=new he("name");o.xform=t,r.push(o);var i=new he("size");return i.xform=e,r.push(i),r.push(new he("timeCreated")),r.push(new he("updated")),r.push(new he("md5Hash",null,!0)),r.push(new he("cacheControl",null,!0)),r.push(new he("contentDisposition",null,!0)),r.push(new he("contentEncoding",null,!0)),r.push(new he("contentLanguage",null,!0)),r.push(new he("contentType",null,!0)),r.push(new he("metadata","customMetadata",!0)),r.push(new he("downloadTokens","downloadURLs",!1,n)),pe=r}function ot(t,e){function n(){var n=t.bucket,r=t.fullPath,o=new le(n,r);return e.makeStorageReference(o)}Object.defineProperty(t,"ref",{get:n})}function it(t,e,n){var r={};r.type="file";for(var o=n.length,i=0;i<o;i++){var a=n[i];r[a.local]=a.xform(r,e[a.server])}return ot(r,t),r}function at(t,e,n){var r=V(e);return null===r?null:it(t,r,n)}function st(t,e){for(var n={},r=e.length,o=0;o<r;o++){var i=e[o];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}function ut(t){if(!t||!G(t))throw"Expected Metadata object.";for(var e in t){var n=t[e];if("customMetadata"===e){if(!G(n))throw"Expected object for 'customMetadata' mapping."}else if(j(n))throw"Mapping for '"+e+"' cannot be an object."}}function ct(t,e,n){for(var r=e.length,o=e.length,i=0;i<e.length;i++)if(e[i].optional){r=i;break}if(!(r<=n.length&&n.length<=o))throw b(r,o,t,n.length);for(var i=0;i<n.length;i++)try{e[i].validator(n[i])}catch(e){throw e instanceof Error?v(i,t,e.message):v(i,t,e)}}function lt(t,e){return function(n){t(n),e(n)}}function ht(t,e){function n(t){if(!F(t))throw"Expected string."}var r;return r=t?lt(n,t):n,new fe(r,e)}function pt(){function t(t){if(!(t instanceof Uint8Array||t instanceof ArrayBuffer||X()&&t instanceof Blob))throw"Expected Blob or File."}return new fe(t)}function ft(t){return new fe(ut,t)}function dt(){function t(t){if(!(H(t)&&t>=0))throw"Expected a number 0 or greater."}return new fe(t)}function _t(t,e){function n(e){if(!(null===e||M(e)&&e instanceof Object))throw"Expected an Object.";void 0!==t&&null!==t&&t(e)}return new fe(n,e)}function vt(t){function e(t){if(null!==t&&!B(t))throw"Expected a Function."}return new fe(e,t)}function bt(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function mt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=bt();if(void 0!==n){for(var r=new n,o=0;o<t.length;o++)r.append(t[o]);return r.getBlob()}if(X())return new Blob(t);throw Error("This browser doesn't seem to support creating Blobs")}function gt(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}function yt(t,e){return-1!==t.indexOf(e)}function Rt(t){return Array.prototype.slice.call(t)}function Et(t,e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}function wt(t){if(!t)throw o()}function Ut(t,e){function n(n,r){var o=at(t,r,e);return wt(null!==o),o}return n}function Tt(t){function e(e,n){var r;return r=401===e.getStatus()?s():402===e.getStatus()?a(t.bucket):403===e.getStatus()?u(t.path):n,r.setServerResponseProp(n.serverResponseProp()),r}return e}function At(t){function e(e,r){var o=n(e,r);return 404===e.getStatus()&&(o=i(t.path)),o.setServerResponseProp(r.serverResponseProp()),o}var n=Tt(t);return e}function Nt(t,e,n){var r=e.fullServerUrl(),o=Q(r),i=t.maxOperationRetryTime(),a=new _e(o,"GET",Ut(t,n),i);return a.errorHandler=At(e),a}function Ot(t,e,n,r){var o=e.fullServerUrl(),i=Q(o),a=st(n,r),s={"Content-Type":"application/json; charset=utf-8"},u=t.maxOperationRetryTime(),c=new _e(i,"PATCH",Ut(t,r),u);return c.headers=s,c.body=a,c.errorHandler=At(e),c}function Ct(t,e){function n(t,e){}var r=e.fullServerUrl(),o=Q(r),i=t.maxOperationRetryTime(),a=new _e(o,"DELETE",n,i);return a.successCodes=[200,204],a.errorHandler=At(e),a}function St(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function kt(t,e,n){var r=L(n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=St(null,e)),r}function It(t,e,n,r,o){var i=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"},s=function(){for(var t="",e=0;e<2;e++)t+=(""+Math.random()).slice(2);return t}();a["Content-Type"]="multipart/related; boundary="+s;var u=kt(e,r,o),c=st(u,n),l="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+c+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",h="\r\n--"+s+"--",p=de.getBlob(l,r,h);if(null===p)throw f();var d={name:u.fullPath},_=$(i),v=t.maxUploadRetryTime(),b=new _e(_,"POST",Ut(t,n),v);return b.urlParams=d,b.headers=a,b.body=p.uploadData(),b.errorHandler=Tt(e),b}function Lt(t,e){var n;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(t){wt(!1)}return wt(yt(e||["active"],n)),n}function Pt(t,e,n,r,o){function i(t,e){Lt(t);var n;try{n=t.getResponseHeader("X-Goog-Upload-URL")}catch(t){wt(!1)}return wt(F(n)),n}var a=e.bucketOnlyServerUrl(),s=kt(e,r,o),u={name:s.fullPath},c=$(a),l={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":s.contentType,"Content-Type":"application/json; charset=utf-8"},h=st(s,n),p=t.maxUploadRetryTime(),f=new _e(c,"POST",i,p);return f.urlParams=u,f.headers=l,f.body=h,f.errorHandler=Tt(e),f}function xt(t,e,n,r){function o(t,e){var n,o=Lt(t,["active","final"]);try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(t){wt(!1)}var i=parseInt(n,10);return wt(!isNaN(i)),new ve(i,r.size(),"final"===o)}var i={"X-Goog-Upload-Command":"query"},a=t.maxUploadRetryTime(),s=new _e(n,"POST",o,a);return s.headers=i,s.errorHandler=Tt(e),s}function Dt(t,e,n,r,o,i,a,s){function u(t,n){var o,a=Lt(t,["active","final"]),s=c.current+h,u=r.size();return o="final"===a?Ut(e,i)(t,n):null,new ve(s,u,"final"===a,o)}var c=new ve(0,0);if(a?(c.current=a.current,c.total=a.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw d();var l=c.total-c.current,h=l;o>0&&(h=Math.min(h,o));var p=c.current,_=p+h,v=h===l?"upload, finalize":"upload",b={"X-Goog-Upload-Command":v,"X-Goog-Upload-Offset":c.current},m=r.slice(p,_);if(null===m)throw f();var g=e.maxUploadRetryTime(),y=new _e(n,"POST",u,g);return y.headers=b,y.body=m.uploadData(),y.progressCallback=s||null,y.errorHandler=Tt(t),y}function Mt(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];x(!0).then(function(){t.apply(null,e)})}}function Wt(t,e,n){function r(){return 2===h}function o(){p||(p=!0,e.apply(null,arguments))}function i(e){c=setTimeout(function(){c=null,t(a,r())},e)}function a(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!p){if(t)return void o.apply(null,arguments);if(r()||l)return void o.apply(null,arguments);u<64&&(u*=2);var a;1===h?(h=2,a=0):a=1e3*(u+Math.random()),i(a)}}function s(t){f||(f=!0,p||(null!==c?(t||(h=2),clearTimeout(c),i(0)):t||(h=1)))}var u=1,c=null,l=!1,h=0,p=!1,f=!1;return i(0),setTimeout(function(){l=!0,s(!0)},n),s}function Bt(t){t(!1)}function Gt(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}function jt(t){var e=void 0!==Xt.default?Xt.default.SDK_VERSION:"AppManager";t["X-Firebase-Storage-Version"]="webjs/"+e}function qt(t,e,n){var r=tt(t.urlParams),o=t.url+r,i=L(t.headers);return Gt(i,e),jt(i),new Ue(o,t.method,i,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,n)}function Ft(t,e,n){return new Ae(t,new ce,n)}function Ht(t){var e={TaskState:se,TaskEvent:ie,StringFormat:ne,Storage:Ae,Reference:ye};t.INTERNAL.registerService(Oe,Ft,e,void 0,!0)}Object.defineProperty(e,"__esModule",{value:!0});var zt,Xt=n(6),Vt="https://firebasestorage.googleapis.com",Kt="https://firebasestorage.googleapis.com",Zt="/v0",Jt="/v0",Qt=12e4,Yt=6e4,$t=-9007199254740991,te=function(){function t(t,e){this.t=r(t),this.e="Firebase Storage: "+e,this.n=null,this.r="FirebaseError"}return t.prototype.codeProp=function(){return this.code},t.prototype.codeEquals=function(t){return r(t)===this.codeProp()},t.prototype.serverResponseProp=function(){return this.n},t.prototype.setServerResponseProp=function(t){this.n=t},Object.defineProperty(t.prototype,"name",{get:function(){return this.r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"code",{get:function(){return this.t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this.e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverResponse",{get:function(){return this.n},enumerable:!0,configurable:!0}),t}(),ee={UNKNOWN:"unknown",OBJECT_NOT_FOUND:"object-not-found",BUCKET_NOT_FOUND:"bucket-not-found",PROJECT_NOT_FOUND:"project-not-found",QUOTA_EXCEEDED:"quota-exceeded",UNAUTHENTICATED:"unauthenticated",UNAUTHORIZED:"unauthorized",RETRY_LIMIT_EXCEEDED:"retry-limit-exceeded",INVALID_CHECKSUM:"invalid-checksum",CANCELED:"canceled",INVALID_EVENT_NAME:"invalid-event-name",INVALID_URL:"invalid-url",INVALID_DEFAULT_BUCKET:"invalid-default-bucket",NO_DEFAULT_BUCKET:"no-default-bucket",CANNOT_SLICE_BLOB:"cannot-slice-blob",SERVER_FILE_WRONG_SIZE:"server-file-wrong-size",NO_DOWNLOAD_URL:"no-download-url",INVALID_ARGUMENT:"invalid-argument",INVALID_ARGUMENT_COUNT:"invalid-argument-count",APP_DELETED:"app-deleted",INVALID_ROOT_OPERATION:"invalid-root-operation",INVALID_FORMAT:"invalid-format",INTERNAL_ERROR:"internal-error"},ne={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},re=function(){function t(t,e){this.data=t,this.contentType=e||null}return t}(),oe=function(){function t(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw y(ne.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n=e[1]||null;null!=n&&(this.base64=C(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=t.substring(t.indexOf(",")+1)}return t}(),ie={STATE_CHANGED:"state_changed"},ae={RUNNING:"running",PAUSING:"pausing",PAUSED:"paused",SUCCESS:"success",CANCELING:"canceling",CANCELED:"canceled",ERROR:"error"},se={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(zt=zt||(zt={}));var ue=function(){function t(){var t=this;this.o=!1,this.i=new XMLHttpRequest,this.a=zt.NO_ERROR,this.s=P(function(e,n){t.i.addEventListener("abort",function(n){t.a=zt.ABORT,e(t)}),t.i.addEventListener("error",function(n){t.a=zt.NETWORK_ERROR,e(t)}),t.i.addEventListener("load",function(n){e(t)})})}return t.prototype.send=function(t,e,n,r){var o=this;if(this.o)throw R("cannot .send() more than once");return this.o=!0,this.i.open(e,t,!0),M(r)&&I(r,function(t,e){o.i.setRequestHeader(t,""+e)}),M(n)?this.i.send(n):this.i.send(),this.s},t.prototype.getErrorCode=function(){if(!this.o)throw R("cannot .getErrorCode() before sending");return this.a},t.prototype.getStatus=function(){if(!this.o)throw R("cannot .getStatus() before sending");try{return this.i.status}catch(t){return-1}},t.prototype.getResponseText=function(){if(!this.o)throw R("cannot .getResponseText() before sending");return this.i.responseText},t.prototype.abort=function(){this.i.abort()},t.prototype.getResponseHeader=function(t){return this.i.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){M(this.i.upload)&&this.i.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){M(this.i.upload)&&this.i.upload.removeEventListener("progress",t)},t}(),ce=function(){function t(){}return t.prototype.createXhrIo=function(){return new ue},t}(),le=function(){function t(t,e){this.bucket=t,this.u=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.u},enumerable:!0,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e){var n;try{n=t.makeFromUrl(e)}catch(n){return new t(e,"")}if(""===n.path)return n;throw p(e)},t.makeFromUrl=function(e){function n(t){"/"===t.path.charAt(t.path.length-1)&&(t.u=t.u.slice(0,-1))}function r(t){t.u=decodeURIComponent(t.path)}for(var o=null,i=RegExp("^gs://([A-Za-z0-9.\\-]+)(/(.*))?$","i"),a={bucket:1,path:3},s=RegExp("^https?://firebasestorage\\.googleapis\\.com/v[A-Za-z0-9_]+/b/([A-Za-z0-9.\\-]+)/o(/([^?#]*).*)?$","i"),u={bucket:1,path:3},c=[{regex:i,indices:a,postModify:n},{regex:s,indices:u,postModify:r}],l=0;l<c.length;l++){var p=c[l],f=p.regex.exec(e);if(f){var d=f[p.indices.bucket],_=f[p.indices.path];_||(_=""),o=new t(d,_),p.postModify(o);break}}if(null==o)throw h(e);return o},t}(),he=function(){function t(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||et}return t}(),pe=null,fe=function(){function t(t,e){var n=this;this.validator=function(e){n.optional&&!W(e)||t(e)},this.optional=!!e}return t}(),de=function(){function t(t,e){var n=0,r="";z(t)?(this.c=t,n=t.size,r=t.type):t instanceof ArrayBuffer?(e?this.c=new Uint8Array(t):(this.c=new Uint8Array(t.byteLength),this.c.set(new Uint8Array(t))),n=this.c.length):t instanceof Uint8Array&&(e?this.c=t:(this.c=new Uint8Array(t.length),this.c.set(t)),n=t.length),this.l=n,this.h=r}return t.prototype.size=function(){return this.l},t.prototype.type=function(){return this.h},t.prototype.slice=function(e,n){if(z(this.c)){var r=this.c,o=gt(r,e,n);return null===o?null:new t(o)}return new t(new Uint8Array(this.c.buffer,e,n-e),!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(X()){var r=e.map(function(e){return e instanceof t?e.c:e});return new t(mt.apply(null,r))}var o=e.map(function(t){return F(t)?w(ne.RAW,t).data:t.c}),i=0;o.forEach(function(t){i+=t.byteLength});var a=new Uint8Array(i),s=0;return o.forEach(function(t){for(var e=0;e<t.length;e++)a[s++]=t[e]}),new t(a,!0)},t.prototype.uploadData=function(){return this.c},t}(),_e=function(){function t(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}return t}(),ve=function(){function t(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null}return t}(),be=function(){function t(t,e,n){if(B(t)||M(e)||M(n))this.next=t,this.error=e||null,this.complete=n||null;else{var r=t;this.next=r.next||null,this.error=r.error||null,this.complete=r.complete||null}}return t}(),me=function(){function t(t,e,n,r,o,i){this.bytesTransferred=t,this.totalBytes=e,this.state=n,this.metadata=r,this.task=o,this.ref=i}return Object.defineProperty(t.prototype,"downloadURL",{get:function(){if(null!==this.metadata){var t=this.metadata.downloadURLs;return null!=t&&null!=t[0]?t[0]:null}return null},enumerable:!0,configurable:!0}),t}(),ge=function(){function t(t,e,n,r,o,i){void 0===i&&(i=null);var a=this;this.p=0,this.f=!1,this.d=!1,this._=[],this.v=null,this.b=null,this.m=null,this.g=1,this.y=null,this.R=null,this.w=t,this.U=e,this.T=n,this.A=o,this.N=i,this.O=r,this.C=this.S(this.A),this.k=ae.RUNNING,this.I=function(t){a.m=null,a.g=1,t.codeEquals(ee.CANCELED)?(a.f=!0,a.L()):(a.v=t,a.P(ae.ERROR))},this.x=function(t){a.m=null,t.codeEquals(ee.CANCELED)?a.L():(a.v=t,a.P(ae.ERROR))},this.D=P(function(t,e){a.y=t,a.R=e,a.M()}),this.D.then(null,function(){})}return t.prototype.W=function(){var t=this,e=this.p;return function(n,r){t.B(e+n)}},t.prototype.S=function(t){return t.size()>262144},t.prototype.M=function(){this.k===ae.RUNNING&&null===this.m&&(this.C?null===this.b?this.G():this.f?this.j():this.d?this.q():this.F():this.H())},t.prototype.z=function(t){var e=this;this.U.getAuthToken().then(function(n){switch(e.k){case ae.RUNNING:t(n);break;case ae.CANCELING:e.P(ae.CANCELED);break;case ae.PAUSING:e.P(ae.PAUSED)}})},t.prototype.G=function(){var t=this;this.z(function(e){var n=Pt(t.U,t.T,t.O,t.A,t.N),r=t.U.makeRequest(n,e);t.m=r,r.getPromise().then(function(e){t.m=null,t.b=e,t.f=!1,t.L()},t.I)})},t.prototype.j=function(){var t=this,e=this.b;this.z(function(n){var r=xt(t.U,t.T,e,t.A),o=t.U.makeRequest(r,n);t.m=o,o.getPromise().then(function(e){e=e,t.m=null,t.B(e.current),t.f=!1,e.finalized&&(t.d=!0),t.L()},t.I)})},t.prototype.F=function(){var t=this,e=262144*this.g,n=new ve(this.p,this.A.size()),r=this.b;this.z(function(o){var i;try{i=Dt(t.T,t.U,r,t.A,e,t.O,n,t.W())}catch(e){return t.v=e,void t.P(ae.ERROR)}var a=t.U.makeRequest(i,o);t.m=a,a.getPromise().then(function(e){t.X(),t.m=null,t.B(e.current),e.finalized?(t.N=e.metadata,t.P(ae.SUCCESS)):t.L()},t.I)})},t.prototype.X=function(){262144*this.g<33554432&&(this.g*=2)},t.prototype.q=function(){var t=this;this.z(function(e){var n=Nt(t.U,t.T,t.O),r=t.U.makeRequest(n,e);t.m=r,r.getPromise().then(function(e){t.m=null,t.N=e,t.P(ae.SUCCESS)},t.x)})},t.prototype.H=function(){var t=this;this.z(function(e){var n=It(t.U,t.T,t.O,t.A,t.N),r=t.U.makeRequest(n,e);t.m=r,r.getPromise().then(function(e){t.m=null,t.N=e,t.B(t.A.size()),t.P(ae.SUCCESS)},t.I)})},t.prototype.B=function(t){var e=this.p;this.p=t,this.p!==e&&this.V()},t.prototype.P=function(t){if(this.k!==t)switch(t){case ae.CANCELING:case ae.PAUSING:this.k=t,null!==this.m&&this.m.cancel();break;case ae.RUNNING:var e=this.k===ae.PAUSED;this.k=t,e&&(this.V(),this.M());break;case ae.PAUSED:this.k=t,this.V();break;case ae.CANCELED:this.v=l(),this.k=t,this.V();break;case ae.ERROR:case ae.SUCCESS:this.k=t,this.V()}},t.prototype.L=function(){switch(this.k){case ae.PAUSING:this.P(ae.PAUSED);break;case ae.CANCELING:this.P(ae.CANCELED);break;case ae.RUNNING:this.M()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=S(this.k);return new me(this.p,this.A.size(),t,this.N,this,this.w)},enumerable:!0,configurable:!0}),t.prototype.on=function(t,e,n,r){function o(e){if(t!==ie.STATE_CHANGED)throw"Expected one of the event types: ["+ie.STATE_CHANGED+"]."}function i(t){try{return void c(t)}catch(t){}try{if(l(t),!(W(t.next)||W(t.error)||W(t.complete)))throw"";return}catch(t){throw u}}function a(t){function e(e,n,o){null!==t&&ct("on",t,arguments);var i=new be(e,n,r);return h.K(i),function(){h.Z(i)}}return e}function s(t){if(null===t)throw u;i(t)}void 0===e&&(e=void 0),void 0===n&&(n=void 0),void 0===r&&(r=void 0);var u="Expected a function or an Object with one of `next`, `error`, `complete` properties.",c=vt(!0).validator,l=_t(null,!0).validator;ct("on",[ht(o),_t(i,!0),vt(!0),vt(!0)],arguments);var h=this,p=[_t(s),vt(!0),vt(!0)];return W(e)||W(n)||W(r)?a(null)(e,n,r):a(p)},t.prototype.then=function(t,e){return this.D.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype.K=function(t){this._.push(t),this.J(t)},t.prototype.Z=function(t){Et(this._,t)},t.prototype.V=function(){var t=this;this.Q(),Rt(this._).forEach(function(e){t.J(e)})},t.prototype.Q=function(){if(null!==this.y){var t=!0;switch(S(this.k)){case se.SUCCESS:Mt(this.y.bind(null,this.snapshot))();break;case se.CANCELED:case se.ERROR:Mt(this.R.bind(null,this.v))();break;default:t=!1}t&&(this.y=null,this.R=null)}},t.prototype.J=function(t){switch(S(this.k)){case se.RUNNING:case se.PAUSED:null!==t.next&&Mt(t.next.bind(t,this.snapshot))();break;case se.SUCCESS:null!==t.complete&&Mt(t.complete.bind(t))();break;case se.CANCELED:case se.ERROR:null!==t.error&&Mt(t.error.bind(t,this.v))();break;default:null!==t.error&&Mt(t.error.bind(t,this.v))()}},t.prototype.resume=function(){ct("resume",[],arguments);var t=this.k===ae.PAUSED||this.k===ae.PAUSING;return t&&this.P(ae.RUNNING),t},t.prototype.pause=function(){ct("pause",[],arguments);var t=this.k===ae.RUNNING;return t&&this.P(ae.PAUSING),t},t.prototype.cancel=function(){ct("cancel",[],arguments);var t=this.k===ae.RUNNING||this.k===ae.PAUSING;return t&&this.P(ae.CANCELING),t},t}(),ye=function(){function t(t,e){this.authWrapper=t,this.location=e instanceof le?e:le.makeFromUrl(e)}return t.prototype.toString=function(){return ct("toString",[],arguments),"gs://"+this.location.bucket+"/"+this.location.path},t.prototype.newRef=function(e,n){return new t(e,n)},t.prototype.mappings=function(){return rt()},t.prototype.child=function(t){ct("child",[ht()],arguments);var e=Z(this.location.path,t),n=new le(this.location.bucket,e);return this.newRef(this.authWrapper,n)},Object.defineProperty(t.prototype,"parent",{get:function(){var t=K(this.location.path);if(null===t)return null;var e=new le(this.location.bucket,t);return this.newRef(this.authWrapper,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){var t=new le(this.location.bucket,"");return this.newRef(this.authWrapper,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this.location.bucket},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this.location.path},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return J(this.location.path)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this.authWrapper.service()},enumerable:!0,configurable:!0}),t.prototype.put=function(t,e){return void 0===e&&(e=null),ct("put",[pt(),ft(!0)],arguments),this.Y("put"),new ge(this,this.authWrapper,this.location,this.mappings(),new de(t),e)},t.prototype.putString=function(t,e,n){void 0===e&&(e=ne.RAW),ct("putString",[ht(),ht(E,!0),ft(!0)],arguments),this.Y("putString");var r=w(e,t),o=L(n);return!M(o.contentType)&&M(r.contentType)&&(o.contentType=r.contentType),new ge(this,this.authWrapper,this.location,this.mappings(),new de(r.data,!0),o)},t.prototype.delete=function(){ct("delete",[],arguments),this.Y("delete");var t=this;return this.authWrapper.getAuthToken().then(function(e){var n=Ct(t.authWrapper,t.location);return t.authWrapper.makeRequest(n,e).getPromise()})},t.prototype.getMetadata=function(){ct("getMetadata",[],arguments),this.Y("getMetadata");var t=this;return this.authWrapper.getAuthToken().then(function(e){var n=Nt(t.authWrapper,t.location,t.mappings());return t.authWrapper.makeRequest(n,e).getPromise()})},t.prototype.updateMetadata=function(t){ct("updateMetadata",[ft()],arguments),this.Y("updateMetadata");var e=this;return this.authWrapper.getAuthToken().then(function(n){var r=Ot(e.authWrapper,e.location,t,e.mappings());return e.authWrapper.makeRequest(r,n).getPromise()})},t.prototype.getDownloadURL=function(){return ct("getDownloadURL",[],arguments),this.Y("getDownloadURL"),this.getMetadata().then(function(t){var e=t.downloadURLs[0];if(M(e))return e;throw _()})},t.prototype.Y=function(t){if(""===this.location.path)throw g(t)},t}(),Re=function(){function t(t){this.D=D(t)}return t.prototype.getPromise=function(){return this.D},t.prototype.cancel=function(t){void 0===t&&(t=!1)},t}(),Ee=function(){function t(){this.$={},this.tt=$t}return t.prototype.addRequest=function(t){function e(){delete r.$[n]}var n=this.tt;this.tt++,this.$[n]=t;var r=this;t.getPromise().then(e,e)},t.prototype.clear=function(){I(this.$,function(t,e){e&&e.cancel(!0)}),this.$={}},t}(),we=function(){function t(e,n,r,o,i){if(this.et=null,this.nt=!1,this.rt=e,null!==this.rt){var a=this.rt.options;M(a)&&(this.et=t.ot(a))}this.it=n,this.at=r,this.st=i,this.ut=o,this.ct=Qt,this.lt=Yt,this.ht=new Ee}return t.ot=function(t){var e=t.storageBucket||null;return null==e?null:le.makeFromBucketSpec(e).bucket},t.prototype.getAuthToken=function(){return null!==this.rt&&M(this.rt.INTERNAL)&&M(this.rt.INTERNAL.getToken)?this.rt.INTERNAL.getToken().then(function(t){return null!==t?t.accessToken:null},function(t){return null}):x(null)},t.prototype.bucket=function(){if(this.nt)throw m();return this.et},t.prototype.service=function(){return this.ut},t.prototype.makeStorageReference=function(t){return this.it(this,t)},t.prototype.makeRequest=function(t,e){if(this.nt)return new Re(m());var n=this.at(t,e,this.st);return this.ht.addRequest(n),n},t.prototype.deleteApp=function(){this.nt=!0,this.rt=null,this.ht.clear()},t.prototype.maxUploadRetryTime=function(){return this.lt},t.prototype.setMaxUploadRetryTime=function(t){this.lt=t},t.prototype.maxOperationRetryTime=function(){return this.ct},t.prototype.setMaxOperationRetryTime=function(t){this.ct=t},t}(),Ue=function(){function t(t,e,n,r,o,i,a,s,u,c,l){this.pt=null,this.ft=null,this.y=null,this.R=null,this.dt=!1,this._t=!1,this.vt=t,this.bt=e,this.mt=n,this.gt=r,this.yt=o.slice(),this.Rt=i.slice(),this.Et=a,this.wt=s,this.Ut=c,this.Tt=u,this.st=l;var h=this;this.D=P(function(t,e){h.y=t,h.R=e,h.M()})}return t.prototype.M=function(){function t(t,e){function r(t){var e=t.loaded,r=t.lengthComputable?t.total:-1;null!==n.Ut&&n.Ut(e,r)}if(e)return void t(!1,new Te(!1,null,!0));var o=n.st.createXhrIo();n.pt=o,null!==n.Ut&&o.addUploadProgressListener(r),o.send(n.vt,n.bt,n.gt,n.mt).then(function(e){null!==n.Ut&&e.removeUploadProgressListener(r),n.pt=null,e=e;var o=e.getErrorCode()===zt.NO_ERROR,i=e.getStatus();if(!o||n.At(i)){var a=e.getErrorCode()===zt.ABORT;return void t(!1,new Te(!1,null,a))}var s=yt(n.yt,i);t(!0,new Te(s,e))})}function e(t,e){var r=n.y,i=n.R,a=e.xhr;if(e.wasSuccessCode)try{var s=n.Et(a,a.getResponseText());W(s)?r(s):r()}catch(t){i(t)}else if(null!==a){var u=o();u.setServerResponseProp(a.getResponseText()),i(n.wt?n.wt(a,u):u)}else if(e.canceled){var u=n._t?m():l();i(u)}else{var u=c();i(u)}}var n=this;this.dt?e(!1,new Te(!1,null,!0)):this.ft=Wt(t,e,this.Tt)},t.prototype.getPromise=function(){return this.D},t.prototype.cancel=function(t){this.dt=!0,this._t=t||!1,null!==this.ft&&Bt(this.ft),null!==this.pt&&this.pt.abort()},t.prototype.At=function(t){var e=t>=500&&t<600,n=[408,429],r=yt(n,t),o=yt(this.Rt,t);return e||r||o},t}(),Te=function(){function t(t,e,n){this.wasSuccessCode=t,this.xhr=e,this.canceled=!!n}return t}(),Ae=function(){function t(t,e,n){function r(t,e){return new ye(t,e)}if(this.et=null,this.U=new we(t,r,qt,this,e),this.rt=t,null!=n)this.et=le.makeFromBucketSpec(n);else{var o=this.U.bucket();null!=o&&(this.et=new le(o,""))}this.Nt=new Ne(this)}return t.prototype.ref=function(t){function e(t){if(/^[A-Za-z]+:\/\//.test(t))throw"Expected child path but got a URL, use refFromURL instead."}if(ct("ref",[ht(e,!0)],arguments),null==this.et)throw Error("No Storage Bucket defined in Firebase Options.");var n=new ye(this.U,this.et);return null!=t?n.child(t):n},t.prototype.refFromURL=function(t){function e(t){if(!/^[A-Za-z]+:\/\//.test(t))throw"Expected full URL but got a child path, use ref instead.";try{le.makeFromUrl(t)}catch(t){throw"Expected valid full URL but got an invalid one."}}return ct("refFromURL",[ht(e,!1)],arguments),new ye(this.U,t)},Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this.U.maxUploadRetryTime()},enumerable:!0,configurable:!0}),t.prototype.setMaxUploadRetryTime=function(t){ct("setMaxUploadRetryTime",[dt()],arguments),this.U.setMaxUploadRetryTime(t)},Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this.U.maxOperationRetryTime()},enumerable:!0,configurable:!0}),t.prototype.setMaxOperationRetryTime=function(t){ct("setMaxOperationRetryTime",[dt()],arguments),this.U.setMaxOperationRetryTime(t)},Object.defineProperty(t.prototype,"app",{get:function(){return this.rt},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"INTERNAL",{get:function(){return this.Nt},enumerable:!0,configurable:!0}),t}(),Ne=function(){function t(t){this.ut=t}return t.prototype.delete=function(){return this.ut.U.deleteApp(),x(void 0)},t}();e.registerStorage=Ht;var Oe="storage";Ht(Xt.default)}},[118])}catch(t){throw Error("Cannot instantiate firebase-storage.js - be sure to load firebase-app.js first.")}

//# sourceMappingURL=firebase.js.map;
define("firebase", (function (global) {
    return function () {
        var ret, fn;
        return ret || global.firebase;
    };
}(this)));

/*!
 * @license Firebase v4.6.0
 * Build: rev-f5e674c
 * Terms: https://firebase.google.com/terms/
 */
try{webpackJsonpFirebase([1],{113:function(t,e,n){n(114)},114:function(t,e,n){"use strict";function r(){return Kt}function i(t){Kt=t}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(Kt<=Vt.DEBUG){var i=(new Date).toISOString(),o=n.map(s);console.log.apply(console,["Firestore ("+jt+") "+i+" ["+t+"]: "+e].concat(o))}}function a(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Kt<=Vt.ERROR){var r=(new Date).toISOString(),i=e.map(s);console.error.apply(console,["Firestore ("+jt+") "+r+": "+t].concat(i))}}function s(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(e){return t}}function u(t){var e="FIRESTORE ("+jt+") INTERNAL ASSERTION FAILED: "+t;throw a(e),Error(e)}function c(t,e){t||u(e)}function h(){return Qt.getPlatform().emptyByteString}function l(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new Ht(Wt.INVALID_ARGUMENT,t)}n.prototype=t.prototype;for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n}function f(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function p(t,e){return void 0!==t?t:e}function d(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=parseInt(n,10);isNaN(r)||e(r,t[n])}}function y(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function m(t){c(null!=t&&"object"==typeof t,"isEmpty() expects object parameter.");for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function g(t){c(t&&"object"==typeof t,"shallowCopy() expects object parameter.");var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function v(t,e,n){if(e.length!==n)throw new Ht(Wt.INVALID_ARGUMENT,"Function "+t+"() requires "+P(n,"argument")+", but was called with "+P(e.length,"argument")+".")}function b(t,e,n){if(e.length<n)throw new Ht(Wt.INVALID_ARGUMENT,"Function "+t+"() requires at least "+P(n,"argument")+", but was called with "+P(e.length,"argument")+".")}function w(t,e,n,r){if(e.length<n||e.length>r)throw new Ht(Wt.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+P(e.length,"argument")+".")}function I(t,e,n,r){if(!(e instanceof Array)||e.length<r)throw new Ht(Wt.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" argument to be an array with at least "+P(r,"element")+".")}function T(t,e,n,r){C(t,e,_(n)+" argument",r)}function E(t,e,n,r){void 0!==r&&T(t,e,n,r)}function S(t,e,n,r){C(t,e,n+" option",r)}function N(t,e,n,r){void 0!==r&&S(t,e,n,r)}function C(t,e,n,r){if(typeof r!==e||"object"===e&&!D(r)){var i=A(r);throw new Ht(Wt.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function D(t){return"object"==typeof t&&null!==t&&Object.getPrototypeOf(t)===Object.prototype}function A(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=k(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":u("Unknown wrong type: "+typeof t)}function k(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/,n=e.exec(""+t.constructor);if(n&&n.length>1)return n[1]}return null}function R(t,e,n){if(void 0===n)throw new Ht(Wt.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+_(e)+" argument, but it was undefined.")}function O(t,e,n){y(e,function(e,r){if(n.indexOf(e)<0)throw new Ht(Wt.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))})}function M(t,e,n,r){var i=A(r);return new Ht(Wt.INVALID_ARGUMENT,"Function "+t+"() requires its "+_(n)+" argument to be a "+e+", but it was: "+i)}function _(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function P(t,e){return t+" "+e+(1===t?"":"s")}function L(t,e){return t<e?-1:t>e?1:0}function x(t,e){return null!==t&&void 0!==t?!(!e||!t.equals(e)):t===e}function B(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}function U(t){var e=t.length-1;return 0===t.length?"":"\0"===t.charAt(e)?t.substring(0,e):t.substring(0,e)+String.fromCharCode(t.charCodeAt(e)-1)}function F(t){return t+"\0"}function V(){if("undefined"==typeof Uint8Array)throw new Ht(Wt.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function q(){if(!Qt.getPlatform().base64Available)throw new Ht(Wt.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function j(t,e){return t<e?-1:t>e?1:t===e?0:isNaN(t)?isNaN(e)?0:-1:1}function K(t,e){return t===e?0!==t||1/t==1/e:t!==t&&e!==e}function Q(t){return null===t||void 0===t}function G(t){return _e(t)&&t<=Me&&t>=Oe}function W(t,e,n){if(n.equals(ge.INSTANCE)){if(e!==Le.EQUAL)throw new Ht(Wt.INVALID_ARGUMENT,"Invalid query. You can only perform equals comparisons on null.");return new Be(t)}if(n.equals(Ie.NAN)){if(e!==Le.EQUAL)throw new Ht(Wt.INVALID_ARGUMENT,"Invalid query. You can only perform equals comparisons on NaN.");return new Ue(t)}return new xe(t,e,n)}function H(t){switch(t){case Wt.OK:return u("Treated status OK as error");case Wt.CANCELLED:case Wt.UNKNOWN:case Wt.DEADLINE_EXCEEDED:case Wt.RESOURCE_EXHAUSTED:case Wt.INTERNAL:case Wt.UNAVAILABLE:case Wt.UNAUTHENTICATED:return!1;case Wt.INVALID_ARGUMENT:case Wt.NOT_FOUND:case Wt.ALREADY_EXISTS:case Wt.PERMISSION_DENIED:case Wt.FAILED_PRECONDITION:case Wt.ABORTED:case Wt.OUT_OF_RANGE:case Wt.UNIMPLEMENTED:case Wt.DATA_LOSS:return!0;default:return u("Unknown status code: "+t)}}function z(t){var e=tn[t];if(void 0!==e)return X(e)}function X(t){switch(t){case tn.OK:return Wt.OK;case tn.CANCELLED:return Wt.CANCELLED;case tn.UNKNOWN:return Wt.UNKNOWN;case tn.DEADLINE_EXCEEDED:return Wt.DEADLINE_EXCEEDED;case tn.RESOURCE_EXHAUSTED:return Wt.RESOURCE_EXHAUSTED;case tn.INTERNAL:return Wt.INTERNAL;case tn.UNAVAILABLE:return Wt.UNAVAILABLE;case tn.UNAUTHENTICATED:return Wt.UNAUTHENTICATED;case tn.INVALID_ARGUMENT:return Wt.INVALID_ARGUMENT;case tn.NOT_FOUND:return Wt.NOT_FOUND;case tn.ALREADY_EXISTS:return Wt.ALREADY_EXISTS;case tn.PERMISSION_DENIED:return Wt.PERMISSION_DENIED;case tn.FAILED_PRECONDITION:return Wt.FAILED_PRECONDITION;case tn.ABORTED:return Wt.ABORTED;case tn.OUT_OF_RANGE:return Wt.OUT_OF_RANGE;case tn.UNIMPLEMENTED:return Wt.UNIMPLEMENTED;case tn.DATA_LOSS:return Wt.DATA_LOSS;default:return u("Unknown status code: "+t)}}function Y(t){if(void 0===t)return tn.OK;switch(t){case Wt.OK:return tn.OK;case Wt.CANCELLED:return tn.CANCELLED;case Wt.UNKNOWN:return tn.UNKNOWN;case Wt.DEADLINE_EXCEEDED:return tn.DEADLINE_EXCEEDED;case Wt.RESOURCE_EXHAUSTED:return tn.RESOURCE_EXHAUSTED;case Wt.INTERNAL:return tn.INTERNAL;case Wt.UNAVAILABLE:return tn.UNAVAILABLE;case Wt.UNAUTHENTICATED:return tn.UNAUTHENTICATED;case Wt.INVALID_ARGUMENT:return tn.INVALID_ARGUMENT;case Wt.NOT_FOUND:return tn.NOT_FOUND;case Wt.ALREADY_EXISTS:return tn.ALREADY_EXISTS;case Wt.PERMISSION_DENIED:return tn.PERMISSION_DENIED;case Wt.FAILED_PRECONDITION:return tn.FAILED_PRECONDITION;case Wt.ABORTED:return tn.ABORTED;case Wt.OUT_OF_RANGE:return tn.OUT_OF_RANGE;case Wt.UNIMPLEMENTED:return tn.UNIMPLEMENTED;case Wt.DATA_LOSS:return tn.DATA_LOSS;default:return u("Unknown status code: "+t)}}function J(t){switch(t){case 200:return Wt.OK;case 400:return Wt.INVALID_ARGUMENT;case 401:return Wt.UNAUTHENTICATED;case 403:return Wt.PERMISSION_DENIED;case 404:return Wt.NOT_FOUND;case 409:return Wt.ABORTED;case 416:return Wt.OUT_OF_RANGE;case 429:return Wt.RESOURCE_EXHAUSTED;case 499:return Wt.CANCELLED;case 500:return Wt.UNKNOWN;case 501:return Wt.UNIMPLEMENTED;case 503:return Wt.UNAVAILABLE;case 504:return Wt.DEADLINE_EXCEEDED;default:return t>=200&&t<300?Wt.OK:t>=400&&t<500?Wt.FAILED_PRECONDITION:t>=500&&t<600?Wt.INTERNAL:Wt.UNKNOWN}}function Z(){return ln}function $(){return fn}function tt(){return pn}function et(){return dn}function nt(t,e){e.length>0&&(t.resumeToken=e)}function rt(t,e){c(!Q(t),e+" is missing")}function it(t){return"number"==typeof t?t:"string"==typeof t?parseInt(t,10):u("can't parse "+t)}function ot(t,e,n){return e===n||!e&&n in t}function at(t){if(t.search(Ln)>=0)throw new Ht(Wt.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Pn.bind.apply(Pn,[void 0].concat(t.split("."))))}catch(e){throw new Ht(Wt.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}function st(t,e){var n=function(t){switch(t){case xn.Added:return 1;case xn.Modified:case xn.Metadata:return 2;case xn.Removed:return 0;default:return u("Unknown ChangeType: "+t)}};return n(t)-n(e)}function ut(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=ht(e)),e=ct(t.get(n),e);return ht(e)}function ct(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+=sr+cr;break;case sr:n+=sr+hr;break;default:n+=o}}return n}function ht(t){return t+sr+ur}function lt(t){var e=t.length;if(c(e>=2,"Invalid path "+t),2===e)return c(t.charAt(0)===sr&&t.charAt(1)===ur,"Non-empty path "+t+" had length 2"),re.EMPTY_PATH;for(var n=e-2,r=[],i="",o=0;o<e;){var a=t.indexOf(sr,o);switch((a<0||a>n)&&u('Invalid encoded resource path: "'+t+'"'),t.charAt(a+1)){case ur:var s=t.substring(o,a),h=void 0;0===i.length?h=s:(i+=s,h=i,i=""),r.push(h);break;case cr:i+=t.substring(o,a),i+="\0";break;case hr:i+=t.substring(o,a+1);break;default:u('Invalid encoded resource path: "'+t+'"')}o=a+2}return new re(r)}function ft(t,e){c(0===e,"Unexpected upgrade from version "+e),t.createObjectStore(pr.store,{keyPath:pr.keyPath}),t.createObjectStore(dr.store,{keyPath:dr.keyPath}),t.createObjectStore(br.store,{keyPath:br.keyPath}).createIndex(br.documentTargetsIndex,br.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(vr.store,{keyPath:vr.keyPath}).createIndex(vr.queryTargetsIndexName,vr.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(yr.store),t.createObjectStore(gr.store),t.createObjectStore(fr.store),t.createObjectStore(wr.store)}function pt(t){return new Gn(function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){n(t.target.error)}})}function dt(t){return c("string"==typeof t,"Persisting non-string stream token not supported."),t}function yt(t){return vt(t,dr.store)}function mt(t){return vt(t,yr.store)}function gt(t){return vt(t,pr.store)}function vt(t,e){return t instanceof Sr?t.store(e):u("Invalid transaction object provided!")}function bt(t){return Tt(t,vr.store)}function wt(t){return Tt(t,wr.store)}function It(t){return Tt(t,br.store)}function Tt(t,e){return t instanceof Sr?t.store(e):u("Invalid transaction object provided!")}function Et(t){return t instanceof Sr?t.store(gr.store):u("Invalid transaction object provided!")}function St(t){return t.path.toArray()}function Nt(t){return void 0!==t.documents}function Ct(t){if(!t)return new oi;switch(t.type){case"google-auth":return new si(t.client);case"gapi":return new ci(t.client,t.sessionIndex||"0");case"provider":return t.client;default:throw new Ht(Wt.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}function Dt(t){return At(t,["next","error","complete"])}function At(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=e;r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}function kt(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Jt||t instanceof Xt||t instanceof bi||t instanceof li)}function Rt(t,e,n){if(!kt(n)||!D(n)){var r=A(n);throw"an object"===r?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function Ot(t,e){if(e instanceof Pn)return e.t;if("string"==typeof e)return Mt(t,e);throw new Ht(Wt.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function Mt(t,e){try{return at(e).t}catch(e){var n=_t(e);throw new Ht(Wt.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function _t(t){return t instanceof Error?t.message:""+t}function Pt(t,e){return void 0===e?{merge:!1}:(O(t,e,["merge"]),N(t,"boolean","merge",e.merge),e)}function Lt(t,e,n){if(e instanceof ki){if(e.firestore!==n)throw new Ht(Wt.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw M(t,"DocumentReference",1,e)}function xt(t,e){if(e.oldDocs.isEmpty()){var n,r=0;return e.docChanges.map(function(i){var o=new Ri(t,i.doc.key,i.doc,e.fromCache);return c(i.type===xn.Added,"Invalid event type for first snapshot"),c(!n||e.query.docComparator(n,i.doc)<0,"Got added events in wrong order"),n=i.doc,{type:"added",doc:o,oldIndex:-1,newIndex:r++}})}var i=e.oldDocs;return e.docChanges.map(function(n){var r=new Ri(t,n.doc.key,n.doc,e.fromCache),o=-1,a=-1;return n.type!==xn.Added&&(o=i.indexOf(n.doc.key),c(o>=0,"Index for document not found"),i=i.delete(n.doc.key)),n.type!==xn.Removed&&(i=i.add(n.doc),a=i.indexOf(n.doc.key)),{type:Bt(n.type),doc:r,oldIndex:o,newIndex:a}})}function Bt(t){switch(t){case xn.Added:return"added";case xn.Modified:case xn.Metadata:return"modified";case xn.Removed:return"removed";default:return u("Unknown change type: "+t)}}function Ut(t){t.INTERNAL.registerService("firestore",function(t){return new Ci(t)},g(ji))}function Ft(t){Ut(t)}Object.defineProperty(e,"__esModule",{value:!0});var Vt,qt=n(6),jt=qt.default.SDK_VERSION;!function(t){t[t.DEBUG=0]="DEBUG",t[t.ERROR=1]="ERROR",t[t.SILENT=2]="SILENT"}(Vt=Vt||(Vt={}));var Kt=Vt.ERROR,Qt=function(){function t(){}return t.setPlatform=function(e){t.platform&&u("Platform already defined"),t.platform=e},t.getPlatform=function(){return t.platform||u("Platform not set"),t.platform},t}(),Gt=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Wt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ht=function(t){function e(e,n){var r=t.call(this,n)||this;return r.code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Gt(e,t),e}(Error),zt=function(){function t(){}return t.newId=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return c(20===e.length,"Invalid auto ID: "+e),e},t}(),Xt=function(){function t(t){q(),this.e=t}return t.fromBase64String=function(e){v("Blob.fromBase64String",arguments,1),T("Blob.fromBase64String","string",1,e),q();try{return new t(Qt.getPlatform().atob(e))}catch(t){throw new Ht(Wt.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},t.fromUint8Array=function(e){if(v("Blob.fromUint8Array",arguments,1),V(),!(e instanceof Uint8Array))throw M("Blob.fromUint8Array","Uint8Array",1,e);return new t(Array.prototype.map.call(e,function(t){return String.fromCharCode(t)}).join(""))},t.prototype.toBase64=function(){return v("Blob.toBase64",arguments,0),q(),Qt.getPlatform().btoa(this.e)},t.prototype.toUint8Array=function(){v("Blob.toUint8Array",arguments,0),V();for(var t=new Uint8Array(this.e.length),e=0;e<this.e.length;e++)t[e]=this.e.charCodeAt(e);return t},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t.prototype.n=function(t){return this.e===t.e},t.prototype.r=function(t){return L(this.e,t.e)},t}(),Yt=l(Xt,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),Jt=function(){function t(t,e){if(v("GeoPoint",arguments,2),T("GeoPoint","number",1,t),T("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new Ht(Wt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Ht(Wt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this.p=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.p},enumerable:!0,configurable:!0}),t.prototype.n=function(t){return this._lat===t._lat&&this.p===t.p},t.prototype.r=function(t){return L(this._lat,t._lat)||L(this.p,t.p)},t}(),Zt=function(){function t(t,e,n,r){this.databaseId=t,this.persistenceKey=e,this.host=n,this.ssl=r}return t}(),$t="(default)",te=function(){function t(t,e){this.projectId=t,this.database=e||$t}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return this.database===$t},enumerable:!0,configurable:!0}),t.prototype.equals=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.compareTo=function(t){return L(this.projectId,t.projectId)||L(this.database,t.database)},t}(),ee=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ne=function(){function t(t,e,n){this.init(t,e,n)}return t.prototype.init=function(t,e,n){void 0===e?e=0:e>t.length&&u("offset "+e+" out of range "+t.length),void 0===n?n=t.length-e:n>t.length-e&&u("length "+n+" out of range "+(t.length-e)),this.segments=t,this.offset=e,this.len=n},t.prototype.construct=function(t,e,n){var r=Object.create(Object.getPrototypeOf(this));return r.init(t,e,n),r},Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),t.prototype.equals=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):"string"==typeof e?n.push(e):u("Unknown parameter type for Path.child(): "+e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,c(this.length>=t,"Can't call popFirst() with less segments"),this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return c(!this.isEmpty(),"Can't call popLast() on empty path"),this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return c(!this.isEmpty(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},t.prototype.lastSegment=function(){return c(!this.isEmpty(),"Can't call lastSegment() on empty path"),this.segments[this.limit()-1]},t.prototype.get=function(t){return c(t<this.length,"Index out of range"),this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),re=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ee(e,t),e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(t){if(t.indexOf("//")>=0)throw new Ht(Wt.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new e(t.split("/").filter(function(t){return t.length>0}))},e.EMPTY_PATH=new e([]),e}(ne),ie=/^[_a-zA-Z][_a-zA-Z0-9]*$/,oe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ee(e,t),e.isValidIdentifier=function(t){return ie.test(t)},e.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Ht(Wt.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Ht(Wt.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ht(Wt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new Ht(Wt.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.EMPTY_PATH=new e([]),e}(ne),ae=function(){function t(e){this.path=e,c(t.isDocumentKey(e),"Invalid DocumentKey with an odd number of segments: "+e.toArray().join("/"))}return t.prototype.equals=function(t){return null!==t&&0===re.comparator(this.path,t.path)},t.prototype.toString=function(){return""+this.path},t.comparator=function(t,e){return re.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new re(e.slice()))},t.fromPathString=function(e){return new t(re.fromString(e))},t.EMPTY=new t(new re([])),t}(),se=function(){function t(t,e,n,r){this.key=t,this.version=e,this.data=n,this.hasLocalMutations=r.hasLocalMutations}return t.prototype.field=function(t){return this.data.field(t)},t.prototype.fieldValue=function(t){var e=this.field(t);return e?e.value():void 0},t.prototype.value=function(){return this.data.value()},t.prototype.equals=function(e){return e instanceof t&&this.key.equals(e.key)&&this.version.equals(e.version)&&this.data.equals(e.data)&&this.hasLocalMutations===e.hasLocalMutations},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data+", {hasLocalMutations: "+this.hasLocalMutations+"})"},t.compareByKey=function(t,e){return ae.comparator(t.key,e.key)},t.compareByField=function(t,e,n){var r=e.field(t),i=n.field(t);return void 0!==r&&void 0!==i?r.compareTo(i):u("Trying to compare documents on fields that don't exist")},t}(),ue=function(){function t(t,e){this.key=t,this.version=e}return t.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},t.prototype.equals=function(t){return t&&t.version.equals(this.version)&&t.key.equals(this.key)},t.compareByKey=function(t,e){return ae.comparator(t.key,e.key)},t}(),ce=function(){function t(t,e){this.comparator=t,this.root=e||le.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,le.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,le.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e=this.root,n=null;!e.isEmpty();){var r=this.comparator(t,e.key);if(0===r){if(e.left.isEmpty())return n?n.key:null;for(e=e.left;!e.right.isEmpty();)e=e.right;return e.key}r<0?e=e.left:r>0&&(n=e,e=e.right)}throw u("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal(function(e,n){return t(e,n),!1})},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(t){return new he(this.root,null,this.comparator,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new he(this.root,t,this.comparator,!1,e)},t.prototype.getReverseIterator=function(t){return new he(this.root,null,this.comparator,!0,t)},t.prototype.getReverseIteratorFrom=function(t,e){return new he(this.root,t,this.comparator,!0,e)},t}(),he=function(){function t(t,e,n,r,i){this.resultGenerator=i||null,this.isReverse=r,this.nodeStack=[];for(var o=1;!t.isEmpty();)if(o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse?t.left:t.right;else{if(0===o){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){c(this.nodeStack.length>0,"getNext() called on iterator when hasNext() is false.");var t,e=this.nodeStack.pop();if(t=this.resultGenerator?this.resultGenerator(e.key,e.value):{key:e.key,value:e.value},this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return this.resultGenerator?this.resultGenerator(t.key,t.value):{key:t.key,value:t.value}},t}(),le=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n)),r.fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw u("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed())throw u("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check();if(t!==this.right.check())throw u("Black depths differ");return t+(this.isRed()?0:1)},t.EMPTY=null,t.RED=!0,t.BLACK=!1,t}(),fe=function(){function t(){this.size=0}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new le(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}();le.EMPTY=new fe;var pe,de=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(t){t[t.NullValue=0]="NullValue",t[t.BooleanValue=1]="BooleanValue",t[t.NumberValue=2]="NumberValue",t[t.TimestampValue=3]="TimestampValue",t[t.StringValue=4]="StringValue",t[t.BlobValue=5]="BlobValue",t[t.RefValue=6]="RefValue",t[t.GeoPointValue=7]="GeoPointValue",t[t.ArrayValue=8]="ArrayValue",t[t.ObjectValue=9]="ObjectValue"}(pe=pe||(pe={}));var ye,me=function(){function t(){}return t.prototype.toString=function(){var t=this.value();return null===t?"null":""+t},t.prototype.defaultCompareTo=function(t){return c(this.typeOrder!==t.typeOrder,"Default compareTo should not be used for values of same type."),L(this.typeOrder,t.typeOrder)},t}(),ge=function(t){function e(){var e=t.call(this)||this;return e.typeOrder=pe.NullValue,e.internalValue=null,e}return de(e,t),e.prototype.value=function(){return null},e.prototype.equals=function(t){return t instanceof e},e.prototype.compareTo=function(t){return t instanceof e?0:this.defaultCompareTo(t)},e.INSTANCE=new e,e}(me),ve=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=pe.BooleanValue,n}return de(e,t),e.prototype.value=function(){return this.internalValue},e.prototype.equals=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?L(this,t):this.defaultCompareTo(t)},e.of=function(t){return t?e.TRUE:e.FALSE},e.TRUE=new e(!0),e.FALSE=new e(!1),e}(me),be=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=pe.NumberValue,n}return de(e,t),e.prototype.value=function(){return this.internalValue},e.prototype.compareTo=function(t){return t instanceof e?j(this.internalValue,t.internalValue):this.defaultCompareTo(t)},e}(me),we=function(t){function e(e){return t.call(this,e)||this}return de(e,t),e.prototype.equals=function(t){return t instanceof e&&K(this.internalValue,t.internalValue)},e}(be),Ie=function(t){function e(e){var n=t.call(this,e)||this;return n.internalValue=e,n}return de(e,t),e.prototype.equals=function(t){return t instanceof e&&K(this.internalValue,t.internalValue)},e.NAN=new e(NaN),e.POSITIVE_INFINITY=new e(1/0),e.NEGATIVE_INFINITY=new e(-1/0),e}(be),Te=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=pe.StringValue,n}return de(e,t),e.prototype.value=function(){return this.internalValue},e.prototype.equals=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?L(this.internalValue,t.internalValue):this.defaultCompareTo(t)},e}(me),Ee=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=pe.TimestampValue,n}return de(e,t),e.prototype.value=function(){return this.internalValue.toDate()},e.prototype.equals=function(t){return t instanceof e&&this.internalValue.equals(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue.compareTo(t.internalValue):t instanceof Se?-1:this.defaultCompareTo(t)},e}(me),Se=function(t){function e(e){var n=t.call(this)||this;return n.localWriteTime=e,n.typeOrder=pe.TimestampValue,n}return de(e,t),e.prototype.value=function(){return null},e.prototype.equals=function(t){return t instanceof e&&this.localWriteTime.equals(t.localWriteTime)},e.prototype.compareTo=function(t){return t instanceof e?this.localWriteTime.compareTo(t.localWriteTime):t instanceof Ee?1:this.defaultCompareTo(t)},e.prototype.toString=function(){return"<ServerTimestamp localTime="+this.localWriteTime+">"},e}(me),Ne=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=pe.BlobValue,n}return de(e,t),e.prototype.value=function(){return this.internalValue},e.prototype.equals=function(t){return t instanceof e&&this.internalValue.n(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue.r(t.internalValue):this.defaultCompareTo(t)},e}(me),Ce=function(t){function e(e,n){var r=t.call(this)||this;return r.databaseId=e,r.key=n,r.typeOrder=pe.RefValue,r}return de(e,t),e.prototype.value=function(){return this.key},e.prototype.equals=function(t){return t instanceof e&&this.key.equals(t.key)&&this.databaseId.equals(t.databaseId)},e.prototype.compareTo=function(t){if(t instanceof e){var n=this.databaseId.compareTo(t.databaseId);return 0!==n?n:ae.comparator(this.key,t.key)}return this.defaultCompareTo(t)},e}(me),De=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=pe.GeoPointValue,n}return de(e,t),e.prototype.value=function(){return this.internalValue},e.prototype.equals=function(t){return t instanceof e&&this.internalValue.n(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue.r(t.internalValue):this.defaultCompareTo(t)},e}(me),Ae=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=pe.ObjectValue,n}return de(e,t),e.prototype.value=function(){var t={};return this.internalValue.inorderTraversal(function(e,n){t[e]=n.value()}),t},e.prototype.forEach=function(t){this.internalValue.inorderTraversal(t)},e.prototype.equals=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext();if(i.key!==o.key||!i.value.equals(o.value))return!1}return!n.hasNext()&&!r.hasNext()}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext(),a=L(i.key,o.key)||i.value.compareTo(o.value);if(a)return a}return L(n.hasNext(),r.hasNext())}return this.defaultCompareTo(t)},e.prototype.set=function(t,n){if(c(!t.isEmpty(),"Cannot set field for empty path on ObjectValue"),1===t.length)return this.setChild(t.firstSegment(),n);var r=this.child(t.firstSegment());r instanceof e||(r=e.EMPTY);var i=r.set(t.popFirst(),n);return this.setChild(t.firstSegment(),i)},e.prototype.delete=function(t){if(c(!t.isEmpty(),"Cannot delete field for empty path on ObjectValue"),1===t.length)return new e(this.internalValue.remove(t.firstSegment()));var n=this.child(t.firstSegment());if(n instanceof e){var r=n.delete(t.popFirst());return new e(this.internalValue.insert(t.firstSegment(),r))}return this},e.prototype.contains=function(t){return void 0!==this.field(t)},e.prototype.field=function(t){c(!t.isEmpty(),"Can't get field of empty path");var n=this;return t.forEach(function(t){n=n instanceof e?n.internalValue.get(t)||void 0:void 0}),n},e.prototype.toString=function(){return JSON.stringify(this.value())},e.prototype.child=function(t){return this.internalValue.get(t)||void 0},e.prototype.setChild=function(t,n){return new e(this.internalValue.insert(t,n))},e.EMPTY=new e(new ce(L)),e}(me),ke=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=pe.ArrayValue,n}return de(e,t),e.prototype.value=function(){return this.internalValue.map(function(t){return t.value()})},e.prototype.forEach=function(t){this.internalValue.forEach(t)},e.prototype.equals=function(t){if(t instanceof e){if(this.internalValue.length!==t.internalValue.length)return!1;for(var n=0;n<this.internalValue.length;n++)if(!this.internalValue[n].equals(t.internalValue[n]))return!1;return!0}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=Math.min(this.internalValue.length,t.internalValue.length),r=0;r<n;r++){var i=this.internalValue[r].compareTo(t.internalValue[r]);if(i)return i}return L(this.internalValue.length,t.internalValue.length)}return this.defaultCompareTo(t)},e.prototype.toString=function(){return JSON.stringify(this.value())},e}(me),Re=Number,Oe=Re.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),Me=Re.MAX_SAFE_INTEGER||Math.pow(2,53)-1,_e=Re.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Pe=function(){function t(t,e,n,r,i,o){void 0===e&&(e=[]),void 0===n&&(n=[]),void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=null),this.path=t,this.explicitOrderBy=e,this.filters=n,this.limit=r,this.startAt=i,this.endAt=o,this.memoizedCanonicalId=null,this.memoizedOrderBy=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}return t.atPath=function(e){return new t(e)},Object.defineProperty(t.prototype,"orderBy",{get:function(){if(null===this.memoizedOrderBy){var t=this.getInequalityFilterField(),e=this.getFirstOrderByField();if(null!==t&&null===e)t.isKeyField()?this.memoizedOrderBy=[je]:this.memoizedOrderBy=[new qe(t),je];else{c(null===t||null!==e&&t.equals(e),"First orderBy should match inequality field."),this.memoizedOrderBy=[];for(var n=!1,r=0,i=this.explicitOrderBy;r<i.length;r++){var o=i[r];this.memoizedOrderBy.push(o),o.field.isKeyField()&&(n=!0)}if(!n){var a=this.explicitOrderBy.length>0?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:Fe.ASCENDING;this.memoizedOrderBy.push(a===Fe.ASCENDING?je:Ke)}}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),t.prototype.addFilter=function(e){c(null==this.getInequalityFilterField()||!(e instanceof xe)||!e.isInequality()||e.field.equals(this.getInequalityFilterField()),"Query must only have one inequality field."),c(!ae.isDocumentKey(this.path),"No filtering allowed for document query");var n=this.filters.concat([e]);return new t(this.path,this.explicitOrderBy.slice(),n,this.limit,this.startAt,this.endAt)},t.prototype.addOrderBy=function(e){c(!ae.isDocumentKey(this.path),"No ordering allowed for document query"),c(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var n=this.explicitOrderBy.concat([e]);return new t(this.path,n,this.filters.slice(),this.limit,this.startAt,this.endAt)},t.prototype.withLimit=function(e){return new t(this.path,this.explicitOrderBy.slice(),this.filters.slice(),e,this.startAt,this.endAt)},t.prototype.withStartAt=function(e){return new t(this.path,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,e,this.endAt)},t.prototype.withEndAt=function(e){return new t(this.path,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,e)},t.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var t=this.path.canonicalString();t+="|f:";for(var e=0,n=this.filters;e<n.length;e++)t+=n[e].canonicalId(),t+=",";t+="|ob:";for(var r=0,i=this.orderBy;r<i.length;r++)t+=i[r].canonicalId(),t+=",";Q(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.memoizedCanonicalId=t}return this.memoizedCanonicalId},t.prototype.toString=function(){var t="Query("+this.path.canonicalString();return this.filters.length>0&&(t+=", filters: ["+this.filters.join(", ")+"]"),Q(this.limit)||(t+=", limit: "+this.limit),this.explicitOrderBy.length>0&&(t+=", orderBy: ["+this.explicitOrderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),t+")"},t.prototype.equals=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].equals(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(var e=0;e<this.filters.length;e++)if(!this.filters[e].equals(t.filters[e]))return!1;return!!this.path.equals(t.path)&&!(null!==this.startAt?!this.startAt.equals(t.startAt):null!==t.startAt)&&(null!==this.endAt?this.endAt.equals(t.endAt):null===t.endAt)},t.prototype.docComparator=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],a=o.compare(t,e);if(0!==a)return a;n=n||o.field.isKeyField()}return c(n,"orderBy used that doesn't compare on key field"),0},t.prototype.matches=function(t){return this.matchesAncestor(t)&&this.matchesOrderBy(t)&&this.matchesFilters(t)&&this.matchesBounds(t)},t.prototype.hasLimit=function(){return!Q(this.limit)},t.prototype.getFirstOrderByField=function(){return this.explicitOrderBy.length>0?this.explicitOrderBy[0].field:null},t.prototype.getInequalityFilterField=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof xe&&n.isInequality())return n.field}return null},t.prototype.isDocumentQuery=function(){return ae.isDocumentKey(this.path)&&0===this.filters.length},t.prototype.matchesAncestor=function(t){var e=t.key.path;return ae.isDocumentKey(this.path)?this.path.equals(e):this.path.isPrefixOf(e)&&this.path.length===e.length-1},t.prototype.matchesOrderBy=function(t){for(var e=0,n=this.explicitOrderBy;e<n.length;e++){var r=n[e];if(!r.field.isKeyField()&&void 0===t.field(r.field))return!1}return!0},t.prototype.matchesFilters=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},t.prototype.matchesBounds=function(t){return!(this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,t)||this.endAt&&this.endAt.sortsBeforeDocument(this.orderBy,t))},t.prototype.assertValidBound=function(t){c(t.position.length<=this.orderBy.length,"Bound is longer than orderBy")},t}(),Le=function(){function t(t){this.name=t}return t.fromString=function(e){switch(e){case"<":return t.LESS_THAN;case"<=":return t.LESS_THAN_OR_EQUAL;case"==":return t.EQUAL;case">=":return t.GREATER_THAN_OR_EQUAL;case">":return t.GREATER_THAN;default:return u("Unknown relation: "+e)}},t.prototype.toString=function(){return this.name},t.prototype.equals=function(t){return this.name===t.name},t.LESS_THAN=new t("<"),t.LESS_THAN_OR_EQUAL=new t("<="),t.EQUAL=new t("=="),t.GREATER_THAN=new t(">"),t.GREATER_THAN_OR_EQUAL=new t(">="),t}(),xe=function(){function t(t,e,n){this.field=t,this.op=e,this.value=n}return t.prototype.matches=function(t){if(this.field.isKeyField()){c(this.value instanceof Ce,"Comparing on key, but filter value not a RefValue");var e=this.value,n=ae.comparator(t.key,e.key);return this.matchesComparison(n)}var r=t.field(this.field);return void 0!==r&&this.matchesValue(r)},t.prototype.matchesValue=function(t){return this.value.typeOrder===t.typeOrder&&this.matchesComparison(t.compareTo(this.value))},t.prototype.matchesComparison=function(t){switch(this.op){case Le.LESS_THAN:return t<0;case Le.LESS_THAN_OR_EQUAL:return t<=0;case Le.EQUAL:return 0===t;case Le.GREATER_THAN:return t>0;case Le.GREATER_THAN_OR_EQUAL:return t>=0;default:return u("Unknown relation op"+this.op)}},t.prototype.isInequality=function(){return this.op!==Le.EQUAL},t.prototype.canonicalId=function(){return this.field.canonicalString()+""+this.op+this.value},t.prototype.equals=function(e){return e instanceof t&&this.op.equals(e.op)&&this.field.equals(e.field)&&this.value.equals(e.value)},t.prototype.toString=function(){return this.field.canonicalString()+" "+this.op+" "+this.value.value()},t}(),Be=function(){function t(t){this.field=t}return t.prototype.matches=function(t){var e=t.field(this.field);return void 0!==e&&null===e.value()},t.prototype.canonicalId=function(){return this.field.canonicalString()+" IS null"},t.prototype.toString=function(){return this.field.canonicalString()+" IS null"},t.prototype.equals=function(e){return e instanceof t&&this.field.equals(e.field)},t}(),Ue=function(){function t(t){this.field=t}return t.prototype.matches=function(t){var e=t.field(this.field).value();return"number"==typeof e&&isNaN(e)},t.prototype.canonicalId=function(){return this.field.canonicalString()+" IS NaN"},t.prototype.toString=function(){return this.field.canonicalString()+" IS NaN"},t.prototype.equals=function(e){return e instanceof t&&this.field.equals(e.field)},t}(),Fe=function(){function t(t){this.name=t}return t.prototype.toString=function(){return this.name},t.ASCENDING=new t("asc"),t.DESCENDING=new t("desc"),t}(),Ve=function(){function t(t,e){this.position=t,this.before=e}return t.prototype.canonicalId=function(){for(var t=this.before?"b:":"a:",e=0,n=this.position;e<n.length;e++)t+=""+n[e];return t},t.prototype.sortsBeforeDocument=function(t,e){c(this.position.length<=t.length,"Bound has more components than query's orderBy");for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(i.field.isKeyField())c(o instanceof Ce,"Bound has a non-key value where the key path is being used."),n=ae.comparator(o.key,e.key);else{var a=e.field(i.field);c(void 0!==a,"Field should exist since document matched the orderBy already."),n=o.compareTo(a)}if(i.dir===Fe.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},t.prototype.equals=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++){var n=this.position[e],r=t.position[e];return n.equals(r)}return!0},t}(),qe=function(){function t(t,e){this.field=t,void 0===e&&(e=Fe.ASCENDING),this.dir=e,this.isKeyOrderBy=t.isKeyField()}return t.prototype.compare=function(t,e){var n=this.isKeyOrderBy?se.compareByKey(t,e):se.compareByField(this.field,t,e);switch(this.dir){case Fe.ASCENDING:return n;case Fe.DESCENDING:return-1*n;default:return u("Unknown direction: "+this.dir)}},t.prototype.canonicalId=function(){return this.field.canonicalString()+""+this.dir},t.prototype.toString=function(){return this.field.canonicalString()+" ("+this.dir+")"},t.prototype.equals=function(t){return this.dir===t.dir&&this.field.equals(t.field)},t}(),je=new qe(oe.keyField(),Fe.ASCENDING),Ke=new qe(oe.keyField(),Fe.DESCENDING),Qe=RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/),Ge=function(){function t(t,e){this.seconds=t,this.nanos=e,c(e>=0,"timestamp nanoseconds out of range: "+e),c(e<1e9,"timestamp nanoseconds out of range"+e),c(t>=-62135596800,"timestamp seconds out of range: "+t),c(t<253402300800,"timestamp seconds out of range"+t)}return t.now=function(){return t.fromEpochMilliseconds(Date.now())},t.fromDate=function(e){return t.fromEpochMilliseconds(e.getTime())},t.fromEpochMilliseconds=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.fromISOString=function(e){var n=0,r=Qe.exec(e);if(c(!!r,"invalid timestamp: "+e),r[1]){var i=r[1];i=(i+"000000000").substr(0,9),n=parseInt(i,10)}var o=new Date(e);return new t(Math.floor(o.getTime()/1e3),n)},t.prototype.toDate=function(){return new Date(this.toEpochMilliseconds())},t.prototype.toEpochMilliseconds=function(){return 1e3*this.seconds+this.nanos/1e6},t.prototype.compareTo=function(t){return this.seconds===t.seconds?L(this.nanos,t.nanos):L(this.seconds,t.seconds)},t.prototype.equals=function(t){return t.seconds===this.seconds&&t.nanos===this.nanos},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanos="+this.nanos+")"},t}(),We=function(){function t(t){this.timestamp=t}return t.fromMicroseconds=function(e){var n=Math.floor(e/1e6);return new t(new Ge(n,e%1e6*1e3))},t.fromTimestamp=function(e){return new t(e)},t.forDeletedDoc=function(){return t.MIN},t.prototype.compareTo=function(t){return this.timestamp.compareTo(t.timestamp)},t.prototype.equals=function(t){return this.timestamp.equals(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanos/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp+")"},t.prototype.toTimestamp=function(){return this.timestamp},t.MIN=new t(new Ge(0,0)),t}();!function(t){t[t.Listen=0]="Listen",t[t.ExistenceFilterMismatch=1]="ExistenceFilterMismatch",t[t.LimboResolution=2]="LimboResolution"}(ye=ye||(ye={}));var He,ze=function(){function t(t,e,n,r,i){void 0===r&&(r=We.MIN),void 0===i&&(i=h()),this.query=t,this.targetId=e,this.purpose=n,this.snapshotVersion=r,this.resumeToken=i}return t.prototype.update=function(e){return new t(this.query,this.targetId,this.purpose,e.snapshotVersion,e.resumeToken)},t.prototype.equals=function(t){return this.targetId===t.targetId&&this.purpose===t.purpose&&this.snapshotVersion.equals(t.snapshotVersion)&&this.resumeToken===t.resumeToken&&this.query.equals(t.query)},t}(),Xe=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ye=function(){function t(t){this.fields=t}return t.prototype.equals=function(t){return B(this.fields,t.fields)},t}(),Je=function(){function t(){}return t.prototype.equals=function(e){return e instanceof t},t.instance=new t,t}(),Ze=function(){function t(t,e){this.field=t,this.transform=e}return t.prototype.equals=function(t){return this.field.equals(t.field)&&this.transform.equals(t.transform)},t}(),$e=function(){function t(t,e){this.version=t,this.transformResults=e}return t}();!function(t){t[t.Set=0]="Set",t[t.Patch=1]="Patch",t[t.Transform=2]="Transform",t[t.Delete=3]="Delete"}(He=He||(He={}));var tn,en=function(){function t(t,e){this.updateTime=t,this.exists=e,c(void 0===t||void 0===e,'Precondition can specify "exists" or "updateTime" but not both')}return t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),t.prototype.isValidFor=function(t){return void 0!==this.updateTime?t instanceof se&&t.version.equals(this.updateTime):void 0!==this.exists?this.exists?t instanceof se:null===t||t instanceof ue:(c(this.isNone,"Precondition should be empty"),!0)},t.prototype.equals=function(t){return x(this.updateTime,t.updateTime)&&this.exists===t.exists},t.NONE=new t,t}(),nn=function(){function t(){}return t.prototype.verifyKeyMatches=function(t){null!=t&&c(t.key.equals(this.key),"Can only apply a mutation to a document with the same key")},t.getPostMutationVersion=function(t){return t instanceof se?t.version:We.MIN},t}(),rn=function(t){function e(e,n,r){var i=t.call(this)||this;return i.key=e,i.value=n,i.precondition=r,i.type=He.Set,i}return Xe(e,t),e.prototype.applyToRemoteDocument=function(t,e){this.verifyKeyMatches(t),c(null==e.transformResults,"Transform results received by SetMutation.");var n=nn.getPostMutationVersion(t);return new se(this.key,n,this.value,{hasLocalMutations:!1})},e.prototype.applyToLocalView=function(t,e){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var n=nn.getPostMutationVersion(t);return new se(this.key,n,this.value,{hasLocalMutations:!0})},e.prototype.equals=function(t){return t instanceof e&&this.key.equals(t.key)&&this.value.equals(t.value)&&this.precondition.equals(t.precondition)},e}(nn),on=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.key=e,o.data=n,o.fieldMask=r,o.precondition=i,o.type=He.Patch,o}return Xe(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),c(null==e.transformResults,"Transform results received by PatchMutation."),!this.precondition.isValidFor(t))return t;var n=nn.getPostMutationVersion(t),r=this.patchDocument(t);return new se(this.key,n,r,{hasLocalMutations:!1})},e.prototype.applyToLocalView=function(t,e){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var n=nn.getPostMutationVersion(t),r=this.patchDocument(t);return new se(this.key,n,r,{hasLocalMutations:!0})},e.prototype.equals=function(t){return t instanceof e&&this.key.equals(t.key)&&this.fieldMask.equals(t.fieldMask)&&this.precondition.equals(t.precondition)},e.prototype.patchDocument=function(t){var e;return e=t instanceof se?t.data:Ae.EMPTY,this.patchObject(e)},e.prototype.patchObject=function(t){for(var e=0,n=this.fieldMask.fields;e<n.length;e++){var r=n[e],i=this.data.field(r);t=void 0!==i?t.set(r,i):t.delete(r)}return t},e}(nn),an=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.fieldTransforms=n,r.type=He.Transform,r.precondition=en.exists(!0),r}return Xe(e,t),e.prototype.applyToRemoteDocument=function(t,e){this.verifyKeyMatches(t),c(null!=e.transformResults,"Transform results missing for TransformMutation.");var n=e.transformResults;if(!this.precondition.isValidFor(t))return t;var r=this.requireDocument(t),i=this.transformObject(r.data,n);return new se(this.key,r.version,i,{hasLocalMutations:!1})},e.prototype.applyToLocalView=function(t,e){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var n=this.requireDocument(t),r=this.localTransformResults(e),i=this.transformObject(n.data,r);return new se(this.key,n.version,i,{hasLocalMutations:!0})},e.prototype.equals=function(t){return t instanceof e&&this.key.equals(t.key)&&B(this.fieldTransforms,t.fieldTransforms)&&this.precondition.equals(t.precondition)},e.prototype.requireDocument=function(t){c(t instanceof se,"Unknown MaybeDocument type "+t);var e=t;return c(e.key.equals(this.key),"Can only transform a document with the same key"),e},e.prototype.localTransformResults=function(t){for(var e=[],n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],o=i.transform;if(!(o instanceof Je))return u("Encountered unknown transform: "+o);e.push(new Se(t))}return e},e.prototype.transformObject=function(t,e){c(e.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=0;n<this.fieldTransforms.length;n++){var r=this.fieldTransforms[n],i=r.transform,o=r.field;if(!(i instanceof Je))return u("Encountered unknown transform: "+i);t=t.set(o,e[n])}return t},e}(nn),sn=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.precondition=n,r.type=He.Delete,r}return Xe(e,t),e.prototype.applyToRemoteDocument=function(t,e){return this.verifyKeyMatches(t),c(null==e.transformResults,"Transform results received by DeleteMutation."),new ue(this.key,We.MIN)},e.prototype.applyToLocalView=function(t,e){return this.verifyKeyMatches(t),this.precondition.isValidFor(t)?(t&&c(t.key.equals(this.key),"Can only apply mutation to document with same key"),new ue(this.key,We.forDeletedDoc())):t},e.prototype.equals=function(t){return t instanceof e&&this.key.equals(t.key)&&this.precondition.equals(t.precondition)},e}(nn),un=function(){function t(t){this.count=t}return t.prototype.equals=function(t){return t&&t.count===this.count},t}();!function(t){t[t.OK=0]="OK",t[t.CANCELLED=1]="CANCELLED",t[t.UNKNOWN=2]="UNKNOWN",t[t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",t[t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",t[t.NOT_FOUND=5]="NOT_FOUND",t[t.ALREADY_EXISTS=6]="ALREADY_EXISTS",t[t.PERMISSION_DENIED=7]="PERMISSION_DENIED",t[t.UNAUTHENTICATED=16]="UNAUTHENTICATED",t[t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",t[t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",t[t.ABORTED=10]="ABORTED",t[t.OUT_OF_RANGE=11]="OUT_OF_RANGE",t[t.UNIMPLEMENTED=12]="UNIMPLEMENTED",t[t.INTERNAL=13]="INTERNAL",t[t.UNAVAILABLE=14]="UNAVAILABLE",t[t.DATA_LOSS=15]="DATA_LOSS"}(tn||(tn={}));var cn,hn=function(){function t(t){this.comparator=t,this.data=new ce(this.comparator)}return t.fromMapKeys=function(e){var n=new t(e.comparator);return e.forEach(function(t){n=n.add(t)}),n},t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return t.forEach(function(t){e=e.add(t)}),e},t.prototype.equals=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),ln=new ce(ae.comparator),fn=new ce(ae.comparator),pn=new ce(ae.comparator),dn=new hn(ae.comparator),yn=function(){function t(t,e,n){this.snapshotVersion=t,this.targetChanges=e,this.documentUpdates=n}return t.prototype.addDocumentUpdate=function(t){this.documentUpdates=this.documentUpdates.insert(t.key,t)},t.prototype.handleExistenceFilterMismatch=function(t){this.targetChanges[t]={mapping:new vn,snapshotVersion:We.MIN,currentStatusUpdate:cn.MarkNotCurrent,resumeToken:h()}},t}();!function(t){t[t.None=0]="None",t[t.MarkNotCurrent=1]="MarkNotCurrent",t[t.MarkCurrent=2]="MarkCurrent"}(cn=cn||(cn={}));var mn,gn=et(),vn=function(){function t(){this.docs=gn}return Object.defineProperty(t.prototype,"documents",{get:function(){return this.docs},enumerable:!0,configurable:!0}),t.prototype.add=function(t){this.docs=this.docs.add(t)},t.prototype.delete=function(t){this.docs=this.docs.delete(t)},t.prototype.equals=function(t){return null!==t&&this.docs.equals(t.docs)},t}(),bn=function(){function t(){this.addedDocuments=gn,this.removedDocuments=gn}return t.prototype.applyToKeySet=function(t){var e=t;return this.addedDocuments.forEach(function(t){return e=e.add(t)}),this.removedDocuments.forEach(function(t){return e=e.delete(t)}),e},t.prototype.add=function(t){this.addedDocuments=this.addedDocuments.add(t),this.removedDocuments=this.removedDocuments.delete(t)},t.prototype.delete=function(t){this.addedDocuments=this.addedDocuments.delete(t),this.removedDocuments=this.removedDocuments.add(t)},t.prototype.equals=function(t){return null!==t&&this.addedDocuments.equals(t.addedDocuments)&&this.removedDocuments.equals(t.removedDocuments)},t}(),wn=function(){function t(t,e,n,r){this.updatedTargetIds=t,this.removedTargetIds=e,this.key=n,this.newDoc=r}return t}(),In=function(){function t(t,e){this.targetId=t,this.existenceFilter=e}return t}();!function(t){t[t.NoChange=0]="NoChange",t[t.Added=1]="Added",t[t.Removed=2]="Removed",t[t.Current=3]="Current",t[t.Reset=4]="Reset"}(mn=mn||(mn={}));var Tn=function(){function t(t,e,n,r){void 0===n&&(n=h()),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}return t}(),En=function(){function t(t,e,n){this.snapshotVersion=t,this.listenTargets=e,this.existenceFilters={},this.targetChanges={},this.documentUpdates=Z(),this.frozen=!1,this.pendingTargetResponses=g(n)}return t.prototype.add=function(t){c(!this.frozen,"Trying to modify frozen WatchChangeAggregator."),t instanceof wn?this.addDocumentChange(t):t instanceof Tn?this.addTargetChange(t):t instanceof In?this.addExistenceFilterChange(t):u("Unknown watch change: "+t)},t.prototype.addChanges=function(t){var e=this;c(!this.frozen,"Trying to modify frozen WatchChangeAggregator."),t.forEach(function(t){return e.add(t)})},t.prototype.createRemoteEvent=function(){var t=this,e=this.targetChanges;return d(this.targetChanges,function(n){t.isActiveTarget(n)||delete e[n]}),this.frozen=!0,new yn(this.snapshotVersion,e,this.documentUpdates)},t.prototype.ensureTargetChange=function(t){var e=this.targetChanges[t];return e||(e={currentStatusUpdate:cn.None,snapshotVersion:this.snapshotVersion,mapping:new bn,resumeToken:h()},this.targetChanges[t]=e),e},t.prototype.isActiveTarget=function(t){return!f(this.pendingTargetResponses,t)&&f(this.listenTargets,t)},t.prototype.addDocumentChange=function(t){for(var e=!1,n=0,r=t.updatedTargetIds;n<r.length;n++){var i=r[n];if(this.isActiveTarget(i)){var o=this.ensureTargetChange(i);o.mapping.add(t.key),e=!0}}for(var a=0,s=t.removedTargetIds;a<s.length;a++){var i=s[a];if(this.isActiveTarget(i)){var o=this.ensureTargetChange(i);o.mapping.delete(t.key),e=!0}}t.newDoc&&e&&(this.documentUpdates=this.documentUpdates.insert(t.key,t.newDoc))},t.prototype.addTargetChange=function(t){var e=this;t.targetIds.forEach(function(n){var r=e.ensureTargetChange(n);switch(t.state){case mn.NoChange:e.isActiveTarget(n)&&nt(r,t.resumeToken);break;case mn.Added:e.recordTargetResponse(n),f(e.pendingTargetResponses,n)||(r.mapping=new bn,r.currentStatusUpdate=cn.None,delete e.existenceFilters[n]),nt(r,t.resumeToken);break;case mn.Removed:e.recordTargetResponse(n),c(!t.cause,"WatchChangeAggregator does not handle errored targets");break;case mn.Current:e.isActiveTarget(n)&&(r.currentStatusUpdate=cn.MarkCurrent,nt(r,t.resumeToken));break;case mn.Reset:e.isActiveTarget(n)&&(r.mapping=new vn,nt(r,t.resumeToken));break;default:u("Unknown target watch change state: "+t.state)}})},t.prototype.recordTargetResponse=function(t){var e=(this.pendingTargetResponses[t]||0)-1;0===e?delete this.pendingTargetResponses[t]:this.pendingTargetResponses[t]=e},t.prototype.addExistenceFilterChange=function(t){this.isActiveTarget(t.targetId)&&(this.existenceFilters[t.targetId]=t.existenceFilter)},t}(),Sn=function(){var t={};return t[Fe.ASCENDING.name]="ASCENDING",t[Fe.DESCENDING.name]="DESCENDING",t}(),Nn=function(){var t={};return t[Le.LESS_THAN.name]="LESS_THAN",t[Le.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",t[Le.GREATER_THAN.name]="GREATER_THAN",t[Le.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",t[Le.EQUAL.name]="EQUAL",t}(),Cn=function(){function t(t,e){this.databaseId=t,this.options=e}return t.prototype.emptyByteString=function(){return this.options.useProto3Json?"":new Uint8Array(0)},t.prototype.unsafeCastProtoByteString=function(t){return t},t.prototype.fromRpcStatus=function(t){var e=void 0===t.code?Wt.UNKNOWN:X(t.code);return new Ht(e,t.message||"")},t.prototype.toTimestamp=function(t){return{seconds:t.seconds,nanos:t.nanos}},t.prototype.fromTimestamp=function(t){if("string"==typeof t)return Ge.fromISOString(t);c(!!t,"Cannot deserialize null or undefined timestamp.");var e=it(t.seconds||"0"),n=t.nanos||0;return new Ge(e,n)},t.prototype.toBytes=function(t){return this.options.useProto3Json?t.toBase64():this.unsafeCastProtoByteString(t.toUint8Array())},t.prototype.fromBlob=function(t){return"string"==typeof t?(c(this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),Xt.fromBase64String(t)):(c(!this.options.useProto3Json,"Expected bytes to be passed in as string, but got something else instead."),Xt.fromUint8Array(t))},t.prototype.toVersion=function(t){return this.toTimestamp(t.toTimestamp())},t.prototype.fromVersion=function(t){return c(!!t,"Trying to deserialize version that isn't set"),We.fromTimestamp(this.fromTimestamp(t))},t.prototype.toResourceName=function(t,e){return this.fullyQualifiedPrefixPath(t).child("documents").child(e).canonicalString()},t.prototype.fromResourceName=function(t){var e=re.fromString(t);return c(this.isValidResourceName(e),"Tried to deserialize invalid key "+e),e},t.prototype.toName=function(t){return this.toResourceName(this.databaseId,t.path)},t.prototype.fromName=function(t){var e=this.fromResourceName(t);return c(e.get(1)===this.databaseId.projectId,"Tried to deserialize key from different project: "+e.get(1)+" vs "+this.databaseId.projectId),c(!e.get(3)&&!this.databaseId.database||e.get(3)===this.databaseId.database,"Tried to deserialize key from different database: "+e.get(3)+" vs "+this.databaseId.database),new ae(this.extractLocalPathFromResourceName(e))},t.prototype.toQueryPath=function(t){return 0===t.length?this.encodedDatabaseId:this.toResourceName(this.databaseId,t)},t.prototype.fromQueryPath=function(t){var e=this.fromResourceName(t);return 4===e.length?re.EMPTY_PATH:this.extractLocalPathFromResourceName(e)},Object.defineProperty(t.prototype,"encodedDatabaseId",{get:function(){return new re(["projects",this.databaseId.projectId,"databases",this.databaseId.database]).canonicalString()},enumerable:!0,configurable:!0}),t.prototype.fullyQualifiedPrefixPath=function(t){return new re(["projects",t.projectId,"databases",t.database])},t.prototype.extractLocalPathFromResourceName=function(t){return c(t.length>4&&"documents"===t.get(4),"tried to deserialize invalid key "+t),t.popFirst(5)},t.prototype.isValidResourceName=function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)},t.prototype.toValue=function(t){if(t instanceof ge)return{nullValue:"NULL_VALUE"};if(t instanceof ve)return{booleanValue:t.value()};if(t instanceof we)return{integerValue:""+t.value()};if(t instanceof Ie){var e=t.value();if(this.options.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:t.value()}}return t instanceof Te?{stringValue:t.value()}:t instanceof Ae?{mapValue:this.toMapValue(t)}:t instanceof ke?{arrayValue:this.toArrayValue(t)}:t instanceof Ee?{timestampValue:this.toTimestamp(t.internalValue)}:t instanceof De?{geoPointValue:{latitude:t.value().latitude,longitude:t.value().longitude}}:t instanceof Ne?{bytesValue:this.toBytes(t.value())}:t instanceof Ce?{referenceValue:this.toResourceName(t.databaseId,t.key.path)}:u("Unknown FieldValue "+JSON.stringify(t))},t.prototype.fromValue=function(t){var e=this,n=t.value_type;if(ot(t,n,"nullValue"))return ge.INSTANCE;if(ot(t,n,"booleanValue"))return ve.of(t.booleanValue);if(ot(t,n,"integerValue"))return new we(it(t.integerValue));if(ot(t,n,"doubleValue")){if(this.options.useProto3Json){if("NaN"===t.doubleValue)return Ie.NAN;if("Infinity"===t.doubleValue)return Ie.POSITIVE_INFINITY;if("-Infinity"===t.doubleValue)return Ie.NEGATIVE_INFINITY}return new Ie(t.doubleValue)}if(ot(t,n,"stringValue"))return new Te(t.stringValue);if(ot(t,n,"mapValue"))return this.fromFields(t.mapValue.fields||{});if(ot(t,n,"arrayValue")){rt(t.arrayValue,"arrayValue");var r=t.arrayValue.values||[];return new ke(r.map(function(t){return e.fromValue(t)}))}if(ot(t,n,"timestampValue"))return rt(t.timestampValue,"timestampValue"),new Ee(this.fromTimestamp(t.timestampValue));if(ot(t,n,"geoPointValue")){rt(t.geoPointValue,"geoPointValue");var i=t.geoPointValue.latitude||0,o=t.geoPointValue.longitude||0;return new De(new Jt(i,o))}if(ot(t,n,"bytesValue")){rt(t.bytesValue,"bytesValue");var a=this.fromBlob(t.bytesValue);return new Ne(a)}if(ot(t,n,"referenceValue")){rt(t.referenceValue,"referenceValue");var s=this.fromResourceName(t.referenceValue),c=new te(s.get(1),s.get(3)),h=new ae(this.extractLocalPathFromResourceName(s));return new Ce(c,h)}return u("Unknown Value proto "+JSON.stringify(t))},t.prototype.toMutationDocument=function(t,e){return{name:this.toName(t),fields:this.toFields(e)}},t.prototype.toDocument=function(t){return c(!t.hasLocalMutations,"Can't serialize documents with mutations."),{name:this.toName(t.key),fields:this.toFields(t.data),updateTime:this.toTimestamp(t.version.toTimestamp())}},t.prototype.fromDocument=function(t){return new se(this.fromName(t.name),this.fromVersion(t.updateTime),this.fromFields(t.fields||{}),{hasLocalMutations:!1})},t.prototype.toFields=function(t){var e=this,n={};return t.forEach(function(t,r){n[t]=e.toValue(r)}),n},t.prototype.fromFields=function(t){var e=this,n=t,r=Ae.EMPTY;return y(n,function(t,n){r=r.set(new oe([t]),e.fromValue(n))}),r},t.prototype.toMapValue=function(t){return{fields:this.toFields(t)}},t.prototype.toArrayValue=function(t){var e=this,n=[];return t.forEach(function(t){n.push(e.toValue(t))}),{values:n}},t.prototype.fromFound=function(t){c(!!t.found,"Tried to deserialize a found document from a missing document."),rt(t.found.name,"doc.found.name"),rt(t.found.updateTime,"doc.found.updateTime");var e=this.fromName(t.found.name),n=this.fromVersion(t.found.updateTime),r=this.fromFields(t.found.fields||{});return new se(e,n,r,{hasLocalMutations:!1})},t.prototype.fromMissing=function(t){c(!!t.missing,"Tried to deserialize a missing document from a found document."),c(!!t.readTime,"Tried to deserialize a missing document without a read time.");var e=this.fromName(t.missing),n=this.fromVersion(t.readTime);return new ue(e,n)},t.prototype.fromMaybeDocument=function(t){var e=t.result_type;return ot(t,e,"found")?this.fromFound(t):ot(t,e,"missing")?this.fromMissing(t):u("invalid batch get response: "+JSON.stringify(t))},t.prototype.toWatchTargetChangeState=function(t){switch(t){case mn.Added:return"ADD";case mn.Current:return"CURRENT";case mn.NoChange:return"NO_CHANGE";case mn.Removed:return"REMOVE";case mn.Reset:return"RESET";default:return u("Unknown WatchTargetChangeState: "+t)}},t.prototype.toTestWatchChange=function(t){if(t instanceof In)return{filter:{count:t.existenceFilter.count,targetId:t.targetId}};if(t instanceof wn){if(t.newDoc instanceof se){var e=t.newDoc;return{documentChange:{document:{name:this.toName(e.key),fields:this.toFields(e.data),updateTime:this.toVersion(e.version)},targetIds:t.updatedTargetIds,removedTargetIds:t.removedTargetIds}}}if(t.newDoc instanceof ue){var e=t.newDoc;return{documentDelete:{document:this.toName(e.key),readTime:this.toVersion(e.version),removedTargetIds:t.removedTargetIds}}}if(null===t.newDoc)return{documentRemove:{document:this.toName(t.key),removedTargetIds:t.removedTargetIds}}}if(t instanceof Tn){var n=void 0;return t.cause&&(n={code:Y(t.cause.code),message:t.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(t.state),targetIds:t.targetIds,resumeToken:this.unsafeCastProtoByteString(t.resumeToken),cause:n}}}return u("Unrecognized watch change: "+JSON.stringify(t))},t.prototype.fromWatchChange=function(t){var e,n=t.change_type;if(ot(t,n,"targetChange")){rt(t.targetChange,"targetChange");var r=this.fromWatchTargetChangeState(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=t.targetChange.resumeToken||this.emptyByteString(),a=t.targetChange.cause,s=a&&this.fromRpcStatus(a);e=new Tn(r,i,o,s||null)}else if(ot(t,n,"documentChange")){rt(t.documentChange,"documentChange"),rt(t.documentChange.document,"documentChange.name"),rt(t.documentChange.document.name,"documentChange.document.name"),rt(t.documentChange.document.updateTime,"documentChange.document.updateTime");var c=t.documentChange,h=this.fromName(c.document.name),l=this.fromVersion(c.document.updateTime),f=this.fromFields(c.document.fields||{}),p=new se(h,l,f,{hasLocalMutations:!1}),d=c.targetIds||[],y=c.removedTargetIds||[];e=new wn(d,y,p.key,p)}else if(ot(t,n,"documentDelete")){rt(t.documentDelete,"documentDelete"),rt(t.documentDelete.document,"documentDelete.document");var m=t.documentDelete,h=this.fromName(m.document),l=m.readTime?this.fromVersion(m.readTime):We.forDeletedDoc(),p=new ue(h,l),y=m.removedTargetIds||[];e=new wn([],y,p.key,p)}else if(ot(t,n,"documentRemove")){rt(t.documentRemove,"documentRemove"),rt(t.documentRemove.document,"documentRemove");var g=t.documentRemove,h=this.fromName(g.document),y=g.removedTargetIds||[];e=new wn([],y,h,null)}else{if(!ot(t,n,"filter"))return u("Unknown change type "+JSON.stringify(t));rt(t.filter,"filter"),rt(t.filter.targetId,"filter.targetId");var v=t.filter,b=v.count||0,w=new un(b),I=v.targetId;e=new In(I,w)}return e},t.prototype.fromWatchTargetChangeState=function(t){return"NO_CHANGE"===t?mn.NoChange:"ADD"===t?mn.Added:"REMOVE"===t?mn.Removed:"CURRENT"===t?mn.Current:"RESET"===t?mn.Reset:u("Got unexpected TargetChange.state: "+t)},t.prototype.versionFromListenResponse=function(t){if(!ot(t,t.response_type,"targetChange"))return We.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length?We.MIN:e.readTime?this.fromVersion(e.readTime):We.MIN},t.prototype.toMutation=function(t){var e,n=this;if(t instanceof rn)e={update:this.toMutationDocument(t.key,t.value)};else if(t instanceof sn)e={delete:this.toName(t.key)};else if(t instanceof on)e={update:this.toMutationDocument(t.key,t.data),updateMask:this.toDocumentMask(t.fieldMask)};else{if(!(t instanceof an))return u("Unknown mutation type "+t.type);e={transform:{document:this.toName(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.toFieldTransform(t)})}}}return t.precondition.isNone||(e.currentDocument=this.toPrecondition(t.precondition)),e},t.prototype.fromMutation=function(t){var e=this,n=t.currentDocument?this.fromPrecondition(t.currentDocument):en.NONE;if(t.update){rt(t.update.name,"name");var r=this.fromName(t.update.name),i=this.fromFields(t.update.fields||{});if(t.updateMask){var o=this.fromDocumentMask(t.updateMask);return new on(r,i,o,n)}return new rn(r,i,n)}if(t.delete){var r=this.fromName(t.delete);return new sn(r,n)}if(t.transform){var r=this.fromName(t.transform.document),a=t.transform.fieldTransforms.map(function(t){return e.fromFieldTransform(t)});return c(!0===n.exists,'Transforms only support precondition "exists == true"'),new an(r,a)}return u("unknown mutation proto: "+JSON.stringify(t))},t.prototype.toPrecondition=function(t){return c(!t.isNone,"Can't serialize an empty precondition"),void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:u("Unknown precondition")},t.prototype.fromPrecondition=function(t){return void 0!==t.updateTime?en.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?en.exists(t.exists):en.NONE},t.prototype.fromWriteResult=function(t){var e=this,n=t.updateTime?this.fromVersion(t.updateTime):null,r=null;return t.transformResults&&(r=t.transformResults.map(function(t){return e.fromValue(t)})),new $e(n,r)},t.prototype.fromWriteResults=function(t){var e=this;return(t||[]).map(function(t){return e.fromWriteResult(t)})},t.prototype.toFieldTransform=function(t){return c(t.transform instanceof Je,"Unknown transform: "+t.transform),{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"}},t.prototype.fromFieldTransform=function(t){c("REQUEST_TIME"===t.setToServerValue,"Unknown transform proto: "+JSON.stringify(t));var e=oe.fromServerFormat(t.fieldPath);return new Ze(e,Je.instance)},t.prototype.toDocumentsTarget=function(t){return{documents:[this.toQueryPath(t.path)]}},t.prototype.fromDocumentsTarget=function(t){var e=t.documents.length;c(1===e,"DocumentsTarget contained other than 1 document: "+e);var n=t.documents[0];return Pe.atPath(this.fromQueryPath(n))},t.prototype.toQueryTarget=function(t){var e={structuredQuery:{}};if(t.path.isEmpty())e.parent=this.toQueryPath(re.EMPTY_PATH);else{var n=t.path;c(n.length%2!=0,"Document queries with filters are not supported."),e.parent=this.toQueryPath(n.popLast()),e.structuredQuery.from=[{collectionId:n.lastSegment()}]}var r=this.toFilter(t.filters);r&&(e.structuredQuery.where=r);var i=this.toOrder(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.toLimit(t.limit);return void 0!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.toCursor(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.toCursor(t.endAt)),e},t.prototype.fromQueryTarget=function(t){var e=this.fromQueryPath(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0;if(r>0){c(1===r,"StructuredQuery.from with more than one collection is not supported.");var i=n.from[0];e=e.child(i.collectionId)}var o=[];n.where&&(o=this.fromFilter(n.where));var a=[];n.orderBy&&(a=this.fromOrder(n.orderBy));var s=null;n.limit&&(s=n.limit);var u=null;n.startAt&&(u=this.fromCursor(n.startAt));var h=null;return n.endAt&&(h=this.fromCursor(n.endAt)),new Pe(e,a,o,s,u,h)},t.prototype.toListenRequestLabels=function(t){var e=this.toLabel(t.purpose);return null==e?null:{"goog-listen-tags":e}},t.prototype.toLabel=function(t){switch(t){case ye.Listen:return null;case ye.ExistenceFilterMismatch:return"existence-filter-mismatch";case ye.LimboResolution:return"limbo-document";default:return u("Unrecognized query purpose: "+t)}},t.prototype.toTarget=function(t){var e,n=t.query;return e=n.isDocumentQuery()?{documents:this.toDocumentsTarget(n)}:{query:this.toQueryTarget(n)},e.targetId=t.targetId,t.resumeToken.length>0&&(e.resumeToken=this.unsafeCastProtoByteString(t.resumeToken)),e},t.prototype.toFilter=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof xe?e.toRelationFilter(t):e.toUnaryFilter(t)});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},t.prototype.fromFilter=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.fromUnaryFilter(t)]:void 0!==t.fieldFilter?[this.fromRelationFilter(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.fromFilter(t)}).reduce(function(t,e){return t.concat(e)}):u("Unknown filter: "+JSON.stringify(t)):[]},t.prototype.toOrder=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.toPropertyOrder(t)})},t.prototype.fromOrder=function(t){var e=this;return t.map(function(t){return e.fromPropertyOrder(t)})},t.prototype.toLimit=function(t){if(!Q(t))return t},t.prototype.toCursor=function(t){var e=this;return{before:t.before,values:t.position.map(function(t){return e.toValue(t)})}},t.prototype.fromCursor=function(t){var e=this,n=!!t.before,r=t.values.map(function(t){return e.fromValue(t)});return new Ve(r,n)},t.prototype.toDirection=function(t){return Sn[t.name]},t.prototype.fromDirection=function(t){switch(t){case"ASCENDING":return Fe.ASCENDING;case"DESCENDING":return Fe.DESCENDING;default:return}},t.prototype.toOperatorName=function(t){return Nn[t.name]},t.prototype.fromOperatorName=function(t){switch(t){case"EQUAL":return Le.EQUAL;case"GREATER_THAN":return Le.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return Le.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return Le.LESS_THAN;case"LESS_THAN_OR_EQUAL":return Le.LESS_THAN_OR_EQUAL;case"OPERATOR_UNSPECIFIED":return u("Unspecified relation");default:return u("Unknown relation")}},t.prototype.toFieldPathReference=function(t){return{fieldPath:t.canonicalString()}},t.prototype.fromFieldPathReference=function(t){return oe.fromServerFormat(t.fieldPath)},t.prototype.toPropertyOrder=function(t){return{field:this.toFieldPathReference(t.field),direction:this.toDirection(t.dir)}},t.prototype.fromPropertyOrder=function(t){return new qe(this.fromFieldPathReference(t.field),this.fromDirection(t.direction))},t.prototype.toRelationFilter=function(t){return t instanceof xe?{fieldFilter:{field:this.toFieldPathReference(t.field),op:this.toOperatorName(t.op),value:this.toValue(t.value)}}:u("Unrecognized filter: "+JSON.stringify(t))},t.prototype.fromRelationFilter=function(t){return new xe(this.fromFieldPathReference(t.fieldFilter.field),this.fromOperatorName(t.fieldFilter.op),this.fromValue(t.fieldFilter.value))},t.prototype.toUnaryFilter=function(t){return t instanceof Ue?{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NAN"}}:t instanceof Be?{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NULL"}}:u("Unrecognized filter: "+JSON.stringify(t))},t.prototype.fromUnaryFilter=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.fromFieldPathReference(t.unaryFilter.field);return new Ue(e);case"IS_NULL":var n=this.fromFieldPathReference(t.unaryFilter.field);return new Be(n);case"OPERATOR_UNSPECIFIED":return u("Unspecified filter");default:return u("Unknown filter")}},t.prototype.toDocumentMask=function(t){return{fieldPaths:t.fields.map(function(t){return t.canonicalString()})}},t.prototype.fromDocumentMask=function(t){var e=t.fieldPaths||[],n=e.map(function(t){return oe.fromServerFormat(t)});return new Ye(n)},t}(),Dn=n(115),An=function(){function t(t){this.wrappedOnOpen=null,this.wrappedOnClose=null,this.wrappedOnMessage=null,this.sendFn=t.sendFn,this.closeFn=t.closeFn}return t.prototype.onOpen=function(t){c(!this.wrappedOnOpen,"Called onOpen on stream twice!"),this.wrappedOnOpen=t},t.prototype.onClose=function(t){c(!this.wrappedOnClose,"Called onClose on stream twice!"),this.wrappedOnClose=t},t.prototype.onMessage=function(t){c(!this.wrappedOnMessage,"Called onMessage on stream twice!"),this.wrappedOnMessage=t},t.prototype.close=function(){this.closeFn()},t.prototype.send=function(t){this.sendFn(t)},t.prototype.callOnOpen=function(){c(null!==this.wrappedOnOpen,"Cannot call onOpen because no callback was set"),this.wrappedOnOpen()},t.prototype.callOnClose=function(t){c(null!==this.wrappedOnClose,"Cannot call onClose because no callback was set"),this.wrappedOnClose(t)},t.prototype.callOnMessage=function(t){c(null!==this.wrappedOnMessage,"Cannot call onMessage because no callback was set"),this.wrappedOnMessage(t)},t}(),kn="Connection",Rn="gl-js/ fire/"+jt,On=function(){function t(t){this.databaseId=t.databaseId,this.pool=new Dn.XhrIoPool;var e=t.ssl?"https":"http";this.baseUrl=e+"://"+t.host}return t.prototype.modifyHeadersForRequest=function(t,e){if(e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n]);t["X-Goog-Api-Client"]=Rn,t["google-cloud-resource-prefix"]="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},t.prototype.invoke=function(t,e,n){var r=this,i=this.makeUrl(t);return new Promise(function(s,c){r.pool.getObject(function(h){h.listenOnce(Dn.EventType.COMPLETE,function(){try{switch(h.getLastErrorCode()){case Dn.ErrorCode.NO_ERROR:var e=h.getResponseJson();o(kn,"XHR received:",JSON.stringify(e)),s(e);break;case Dn.ErrorCode.TIMEOUT:a('RPC "'+t+'" timed out, retrying.'),c(new Ht(Wt.DEADLINE_EXCEEDED,"Request time out"));break;case Dn.ErrorCode.HTTP_ERROR:var n=h.getStatus();a('RPC "'+t+'" failed with status:',n,"response text:",h.getResponseText()),n>0?c(new Ht(J(n),"Server responded with status "+h.getStatusText())):(a(kn,'RPC "'+t+'" failed, retrying.'),c(new Ht(Wt.UNAVAILABLE,"Connection failed.")));break;default:u('RPC "'+t+'" failed with unanticipated webchannel error '+h.getLastErrorCode()+": "+h.getLastError()+", giving up.")}}finally{o(kn,'RPC "'+t+'" completed.'),r.pool.releaseObject(h)}});var l=JSON.stringify(e);o(kn,"XHR sending: ",i+" "+l);var f={"Content-Type":"text/plain"};r.modifyHeadersForRequest(f,n),h.send(i,"POST",l,f,15)})})},t.prototype.openStream=function(e,n){var r=t.RPC_STREAM_SERVICE_MAPPING[e],i=t.RPC_STREAM_NAME_MAPPING[e];r&&i||u("Unknown RPC name: "+e);var a=[this.baseUrl,"/",r,"/",i,"/channel"],s=Object(Dn.createWebChannelTransport)(),h={backgroundChannelTest:!0,httpSessionIdParam:"gsessionid",initMessageHeaders:{},sendRawJson:!0,supportsCrossDomainXhr:!0};this.modifyHeadersForRequest(h.initMessageHeaders,n);var l=a.join("");o(kn,"Creating WebChannel: "+l+" "+h);var f=s.createWebChannel(l,h),p=!1,d=!1,y=new An({sendFn:function(t){d?o(kn,"Not sending because WebChannel is closed:",t):(p||(o(kn,"Opening WebChannel transport."),f.open(),p=!0),o(kn,"WebChannel sending:",t),f.send(t))},closeFn:function(){return f.close()}}),m=function(t,e){f.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return m(Dn.WebChannel.EventType.OPEN,function(){d||o(kn,"WebChannel transport opened.")}),m(Dn.WebChannel.EventType.CLOSE,function(){d||(d=!0,o(kn,"WebChannel transport closed"),y.callOnClose())}),m(Dn.WebChannel.EventType.ERROR,function(t){d||(d=!0,o(kn,"WebChannel transport errored:",t),y.callOnClose(new Ht(Wt.UNAVAILABLE,"The operation could not be completed")))}),m(Dn.WebChannel.EventType.MESSAGE,function(t){if(!d){var e=t.data[0];c(!!e,"Got a webchannel message without data.");var n=e.error||e[0]&&e[0].error;if(n){o(kn,"WebChannel received error:",n);var r=n.status,i=z(r),a=n.message;void 0===i&&(i=Wt.INTERNAL,a="Unknown error status: "+r+" with message "+n.message),d=!0,y.callOnClose(new Ht(i,a)),f.close()}else o(kn,"WebChannel received:",e),y.callOnMessage(e)}}),setTimeout(function(){y.callOnOpen()},0),y},t.prototype.makeUrl=function(t){var e=[this.baseUrl,"/","v1beta1"];return e.push("/projects/"),e.push(this.databaseId.projectId),e.push("/databases/"),e.push(this.databaseId.database),e.push("/documents"),e.push(":"),e.push(t),e.join("")},t.RPC_STREAM_SERVICE_MAPPING={Write:"google.firestore.v1beta1.Firestore",Listen:"google.firestore.v1beta1.Firestore"},t.RPC_STREAM_NAME_MAPPING={Write:"Write",Listen:"Listen"},t}(),Mn=function(){function t(){this.emptyByteString="",this.base64Available="undefined"!=typeof atob}return t.prototype.loadConnection=function(t){return Promise.resolve(new On(t))},t.prototype.newSerializer=function(t){return new Cn(t,{useProto3Json:!0})},t.prototype.atob=function(t){return atob(t)},t.prototype.btoa=function(t){return btoa(t)},t}();Qt.setPlatform(new Mn);var _n,Pn=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];I("FieldPath",t,"fieldNames",1);for(var n=0;n<t.length;++n)if(T("FieldPath","string",n,t[n]),0===t[n].length)throw new Ht(Wt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.t=new oe(t)}return t.documentId=function(){return t.d},t.d=new t(oe.keyField().canonicalString()),t}(),Ln=RegExp("[~\\*/\\[\\]]");!function(t){t[t.Unknown=0]="Unknown",t[t.Healthy=1]="Healthy",t[t.Failed=2]="Failed"}(_n=_n||(_n={}));var xn;!function(t){t[t.Added=0]="Added",t[t.Removed=1]="Removed",t[t.Modified=2]="Modified",t[t.Metadata=3]="Metadata"}(xn=xn||(xn={}));var Bn;!function(t){t[t.Local=0]="Local",t[t.Synced=1]="Synced"}(Bn=Bn||(Bn={}));var Un,Fn=function(){function t(){this.changeMap=new ce(ae.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.changeMap.get(e);if(!n)return void(this.changeMap=this.changeMap.insert(e,t));t.type!==xn.Added&&n.type===xn.Metadata?this.changeMap=this.changeMap.insert(e,t):t.type===xn.Metadata&&n.type!==xn.Removed?this.changeMap=this.changeMap.insert(e,{type:n.type,doc:t.doc}):t.type===xn.Modified&&n.type===xn.Modified?this.changeMap=this.changeMap.insert(e,{type:xn.Modified,doc:t.doc}):t.type===xn.Modified&&n.type===xn.Added?this.changeMap=this.changeMap.insert(e,{type:xn.Added,doc:t.doc}):t.type===xn.Removed&&n.type===xn.Added?this.changeMap=this.changeMap.remove(e):t.type===xn.Removed&&n.type===xn.Modified?this.changeMap=this.changeMap.insert(e,{type:xn.Removed,doc:n.doc}):t.type===xn.Added&&n.type===xn.Removed?this.changeMap=this.changeMap.insert(e,{type:xn.Modified,doc:t.doc}):u("unsupported combination of changes: "+JSON.stringify(t)+" after "+JSON.stringify(n))},t.prototype.getChanges=function(){var t=[];return this.changeMap.inorderTraversal(function(e,n){t.push(n)}),t},t}(),Vn=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||ae.comparator(e.key,n.key)}:function(t,e){return ae.comparator(t.key,e.key)},this.keyedMap=$(),this.sortedSet=new ce(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.prevDoc=function(t){c(this.has(t),"Trying to get a previous document to non-existing key: "+t);var e=this.keyedMap.get(t);return this.sortedSet.getPredecessorKey(e)},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.equals=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.equals(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(""+e)}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),qn=function(){function t(t){this.mapKeyFn=t,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(a.equals(t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0===r)return void(this.inner[n]=[[t,e]]);for(var i=0;i<r.length;i++)if(r[i][0].equals(t))return void(r[i]=[t,e]);r.push([t,e])},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].equals(t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){y(this.inner,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];t(a,s)}})},t.prototype.isEmpty=function(){return m(this.inner)},t}(),jn=function(){function t(){this.listeners=[]}return t}(),Kn=function(){function t(t){this.syncEngine=t,this.queries=new qn(function(t){return t.canonicalId()}),this.onlineState=_n.Unknown,this.syncEngine.subscribe(this.onChange.bind(this),this.onError.bind(this))}return t.prototype.listen=function(t){var e=t.query,n=!1,r=this.queries.get(e);return r||(n=!0,r=new jn,this.queries.set(e,r)),r.listeners.push(t),t.onOnlineStateChanged(this.onlineState),r.viewSnap&&t.onViewSnapshot(r.viewSnap),n?this.syncEngine.listen(e).then(function(t){return r.targetId=t,t}):Promise.resolve(r.targetId)},t.prototype.unlisten=function(t){var e=t.query,n=!1,r=this.queries.get(e);if(r){var i=r.listeners.indexOf(t);i>=0&&(r.listeners.splice(i,1),n=0===r.listeners.length)}return n?(this.queries.delete(e),this.syncEngine.unlisten(e)):Promise.resolve()},t.prototype.onChange=function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e],i=r.query,o=this.queries.get(i);if(o){for(var a=0,s=o.listeners;a<s.length;a++)s[a].onViewSnapshot(r);o.viewSnap=r}}},t.prototype.onError=function(t,e){var n=this.queries.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++){var o=i[r];o.onError(e)}this.queries.delete(t)},t.prototype.onOnlineStateChanged=function(t){this.onlineState=t,this.queries.forEach(function(e,n){for(var r=0,i=n.listeners;r<i.length;r++)i[r].onOnlineStateChanged(t)})},t}(),Qn=function(){function t(t,e,n){this.query=t,this.queryObserver=e,this.raisedInitialEvent=!1,this.onlineState=_n.Unknown,this.options=n||{}}return t.prototype.onViewSnapshot=function(t){if(c(t.docChanges.length>0||t.syncStateChanged,"We got a new snapshot with no changes?"),!this.options.includeDocumentMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];i.type!==xn.Metadata&&e.push(i)}t={query:t.query,docs:t.docs,oldDocs:t.oldDocs,docChanges:e,fromCache:t.fromCache,hasPendingWrites:t.hasPendingWrites,syncStateChanged:t.syncStateChanged}}this.raisedInitialEvent?this.shouldRaiseEvent(t)&&this.queryObserver.next(t):this.shouldRaiseInitialEvent(t,this.onlineState)&&this.raiseInitialEvent(t),this.snap=t},t.prototype.onError=function(t){this.queryObserver.error(t)},t.prototype.onOnlineStateChanged=function(t){this.onlineState=t,this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,t)&&this.raiseInitialEvent(this.snap)},t.prototype.shouldRaiseInitialEvent=function(t,e){if(c(!this.raisedInitialEvent,"Determining whether to raise first event but already had first event"),!t.fromCache)return!0;var n=e!==_n.Failed;return this.options.waitForSyncWhenOnline&&n?(c(t.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!t.docs.isEmpty()||e===_n.Failed},t.prototype.shouldRaiseEvent=function(t){if(t.docChanges.length>0)return!0;var e=this.snap&&this.snap.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeQueryMetadataChanges},t.prototype.raiseInitialEvent=function(e){c(!this.raisedInitialEvent,"Trying to raise initial events for second time"),e={query:e.query,docs:e.docs,oldDocs:Vn.emptySet(e.docs),docChanges:t.getInitialViewChanges(e),fromCache:e.fromCache,hasPendingWrites:e.hasPendingWrites,syncStateChanged:!0},this.raisedInitialEvent=!0,this.queryObserver.next(e)},t.getInitialViewChanges=function(t){var e=[];return t.docs.forEach(function(t){e.push({type:xn.Added,doc:t})}),e},t}(),Gn=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=null,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&u("Called next() or catch() twice for PersistencePromise"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t(function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}})},t.prototype.toPromise=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.waitFor=function(e){return e.reduce(function(t,e,n){return t.next(function(){return e})},t.resolve())},t.map=function(e){var n=[],r=!0,i=t.resolve(null);return e.reduce(function(t,e){return t.next(function(t){return r||n.push(t),r=!1,e})},i).next(function(t){return n.push(t),n})},t}(),Wn=function(){function t(){this.isEager=!0,this.sources=[],this.potentialGarbage=et()}return t.prototype.addGarbageSource=function(t){this.sources.push(t),t.setGarbageCollector(this)},t.prototype.removeGarbageSource=function(t){this.sources.splice(this.sources.indexOf(t),1),t.setGarbageCollector(null)},t.prototype.addPotentialGarbageKey=function(t){this.potentialGarbage=this.potentialGarbage.add(t)},t.prototype.collectGarbage=function(t){var e=this,n=[],r=et();return this.potentialGarbage.forEach(function(i){var o=e.documentHasAnyReferences(t,i);n.push(o.next(function(t){return t||(r=r.add(i)),Gn.resolve()}))}),this.potentialGarbage=et(),Gn.waitFor(n).next(function(){return r})},t.prototype.documentHasAnyReferences=function(t,e){var n=Gn.resolve(!1);return this.sources.map(function(n){return function(){return n.containsKey(t,e)}}).reduce(function(t,e){return t.next(function(t){return t?Gn.resolve(!0):e()})},n)},t}(),Hn=function(){function t(t,e,n){this.query=t,this.addedKeys=e,this.removedKeys=n}return t.fromSnapshot=function(e){for(var n=et(),r=et(),i=0,o=e.docChanges;i<o.length;i++){var a=o[i];switch(a.type){case xn.Added:n=n.add(a.doc.key);break;case xn.Removed:r=r.add(a.doc.key)}}return new t(e.query,n,r)},t}(),zn=function(){function t(){this.refsByKey=new hn(Xn.compareByKey),this.refsByTarget=new hn(Xn.compareByTargetId),this.garbageCollector=null}return t.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},t.prototype.addReference=function(t,e){var n=new Xn(t,e);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)},t.prototype.addReferences=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},t.prototype.removeReference=function(t,e){this.removeRef(new Xn(t,e))},t.prototype.removeReferences=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},t.prototype.removeReferencesForId=function(t){var e=this,n=ae.EMPTY,r=new Xn(n,t),i=new Xn(n,t+1);this.refsByTarget.forEachInRange([r,i],function(t){e.removeRef(t)})},t.prototype.removeAllReferences=function(){var t=this;this.refsByKey.forEach(function(e){return t.removeRef(e)})},t.prototype.removeRef=function(t){this.refsByKey=this.refsByKey.delete(t),this.refsByTarget=this.refsByTarget.delete(t),null!==this.garbageCollector&&this.garbageCollector.addPotentialGarbageKey(t.key)},t.prototype.referencesForId=function(t){var e=ae.EMPTY,n=new Xn(e,t),r=new Xn(e,t+1),i=et();return this.refsByTarget.forEachInRange([n,r],function(t){i=i.add(t.key)}),i},t.prototype.setGarbageCollector=function(t){this.garbageCollector=t},t.prototype.containsKey=function(t,e){var n=new Xn(e,0),r=this.refsByKey.firstAfterOrEqual(n);return Gn.resolve(null!==r&&e.equals(r.key))},t}(),Xn=function(){function t(t,e){this.key=t,this.targetOrBatchId=e}return t.compareByKey=function(t,e){return ae.comparator(t.key,e.key)||L(t.targetOrBatchId,e.targetOrBatchId)},t.compareByTargetId=function(t,e){return L(t.targetOrBatchId,e.targetOrBatchId)||ae.comparator(t.key,e.key)},t}(),Yn=1;!function(t){t[t.LocalStore=0]="LocalStore",t[t.SyncEngine=1]="SyncEngine"}(Un||(Un={}));var Jn,Zn=function(){function t(t,e){void 0===e&&(e=0),this.generatorId=t;var n=e>>Yn<<Yn,r=e-n;this.previousId=r>=t?n|this.generatorId:(n|this.generatorId)-(1<<Yn)}return t.prototype.next=function(){return this.previousId+=1<<Yn,this.previousId},t.forLocalStore=function(e){return void 0===e&&(e=0),new t(Un.LocalStore,e)},t.forSyncEngine=function(){return new t(Un.SyncEngine)},t}(),$n=function(){function t(t){this.key=t}return t}(),tr=function(){function t(t){this.key=t}return t}(),er=function(){function t(t,e){this.query=t,this.syncedDocuments=e,this.syncState=null,this.current=!1,this.limboDocuments=et(),this.mutatedKeys=et(),this.documentSet=new Vn(t.docComparator.bind(t))}return t.prototype.computeDocChanges=function(t,e){var n=this,r=e?e.changeSet:new Fn,i=e?e.documentSet:this.documentSet,o=e?e.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=this.query.hasLimit()&&i.size===this.query.limit?i.last():null;if(t.inorderTraversal(function(t,e){var h=i.get(t),l=e instanceof se?e:null;if(l&&(c(t.equals(l.key),"Mismatching keys found in document changes: "+t+" != "+l.key),l=n.query.matches(l)?l:null),l?(a=a.add(l),o=l.hasLocalMutations?o.add(t):o.delete(t)):(a=a.delete(t),o=o.delete(t)),h&&l){var f=h.data.equals(l.data);f&&h.hasLocalMutations===l.hasLocalMutations||(f?r.track({type:xn.Metadata,doc:l}):r.track({type:xn.Modified,doc:l}),u&&n.query.docComparator(l,u)>0&&(s=!0))}else!h&&l?r.track({type:xn.Added,doc:l}):h&&!l&&(r.track({type:xn.Removed,doc:h}),u&&(s=!0))}),this.query.hasLimit())for(;a.size>this.query.limit;){var h=a.last();a=a.delete(h.key),r.track({type:xn.Removed,doc:h})}return c(!s||!e,"View was refilled using docs that themselves needed refilling."),{documentSet:a,changeSet:r,needsRefill:s,mutatedKeys:o}},t.prototype.applyChanges=function(t,e){var n=this;c(!t.needsRefill,"Cannot apply changes that need a refill");var r=this.documentSet;this.documentSet=t.documentSet,this.mutatedKeys=t.mutatedKeys;var i=t.changeSet.getChanges();i.sort(function(t,e){return st(t.type,e.type)||n.query.docComparator(t.doc,e.doc)});var o=this.applyTargetChange(e),a=0===this.limboDocuments.size&&this.current,s=a?Bn.Synced:Bn.Local,u=s!==this.syncState;return this.syncState=s,0!==i.length||u?{snapshot:{query:this.query,docs:t.documentSet,oldDocs:r,docChanges:i,fromCache:s===Bn.Local,syncStateChanged:u,hasPendingWrites:!t.mutatedKeys.isEmpty()},limboChanges:o}:{limboChanges:o}},t.prototype.shouldBeInLimbo=function(t){return!this.syncedDocuments.has(t)&&!!this.documentSet.has(t)&&!this.documentSet.get(t).hasLocalMutations},t.prototype.applyTargetChange=function(t){var e=this;if(t){var n=t.mapping;switch(n instanceof vn?this.syncedDocuments=n.documents:n instanceof bn&&(this.syncedDocuments=n.applyToKeySet(this.syncedDocuments)),t.currentStatusUpdate){case cn.MarkCurrent:this.current=!0;break;case cn.MarkNotCurrent:this.current=!1;break;case cn.None:break;default:u("Unknown current status update: "+t.currentStatusUpdate)}}var r=this.limboDocuments;this.limboDocuments=et(),this.current&&this.documentSet.forEach(function(t){e.shouldBeInLimbo(t.key)&&(e.limboDocuments=e.limboDocuments.add(t.key))});var i=[];return r.forEach(function(t){e.limboDocuments.has(t)||i.push(new tr(t))}),this.limboDocuments.forEach(function(t){r.has(t)||i.push(new $n(t))}),i},t}(),nr=function(){function t(t,e,n,r){this.query=t,this.targetId=e,this.resumeToken=n,this.view=r}return t}(),rr=function(){function t(t,e,n){this.localStore=t,this.remoteStore=e,this.currentUser=n,this.viewHandler=null,this.errorHandler=null,this.queryViewsByQuery=new qn(function(t){return t.canonicalId()}),this.queryViewsByTarget={},this.limboTargetsByKey=new ce(ae.comparator),this.limboKeysByTarget={},this.limboDocumentRefs=new zn,this.limboCollector=new Wn,this.mutationUserCallbacks={},this.targetIdGenerator=Zn.forSyncEngine()}return t.prototype.subscribe=function(t,e){c(null!==t&&null!==e,"View and error handlers cannot be null"),c(null===this.viewHandler&&null===this.errorHandler,"SyncEngine already has a subscriber."),this.viewHandler=t,this.errorHandler=e,this.limboCollector.addGarbageSource(this.limboDocumentRefs)},t.prototype.listen=function(t){var e=this;return this.assertSubscribed("listen()"),c(!this.queryViewsByQuery.has(t),"We already listen to the query: "+t),this.localStore.allocateQuery(t).then(function(n){return e.localStore.executeQuery(t).then(function(r){return e.localStore.remoteDocumentKeys(n.targetId).then(function(i){var o=new er(t,i),a=o.computeDocChanges(r),s=o.applyChanges(a);c(0===s.limboChanges.length,"View returned limbo docs before target ack from the server."),c(!!s.snapshot,"applyChanges for new view should always return a snapshot");var u=new nr(t,n.targetId,n.resumeToken,o);e.queryViewsByQuery.set(t,u),e.queryViewsByTarget[n.targetId]=u,e.viewHandler([s.snapshot]),e.remoteStore.listen(n)})}).then(function(){return n.targetId})})},t.prototype.unlisten=function(t){var e=this;this.assertSubscribed("unlisten()");var n=this.queryViewsByQuery.get(t);return c(!!n,"Trying to unlisten on query not found:"+t),this.localStore.releaseQuery(t).then(function(){return e.remoteStore.unlisten(n.targetId),e.removeAndCleanupQuery(n).then(function(){return e.localStore.collectGarbage()})})},t.prototype.write=function(t,e){var n=this;return this.assertSubscribed("write()"),this.localStore.localWrite(t).then(function(t){return n.addMutationCallback(t.batchId,e),n.emitNewSnapsAndNotifyLocalStore(t.changes)}).then(function(){return n.remoteStore.fillWritePipeline()})},t.prototype.wrapUpdateFunctionError=function(t){return t},t.prototype.runTransaction=function(t,e){var n=this;void 0===e&&(e=5),c(e>=0,"Got negative number of retries for transaction.");var r=this.remoteStore.createTransaction();return function(){try{var e=t(r);return!Q(e)&&e.catch&&e.then?e.catch(function(t){return Promise.reject(n.wrapUpdateFunctionError(t))}):Promise.reject(Error("Transaction callback must return a Promise"))}catch(t){return Promise.reject(n.wrapUpdateFunctionError(t))}}().then(function(i){return r.commit().then(function(){return i}).catch(function(r){return 0===e?Promise.reject(r):n.runTransaction(t,e-1)})})},t.prototype.applyRemoteEvent=function(t){var e=this;return this.assertSubscribed("applyRemoteEvent()"),d(t.targetChanges,function(n,r){var i=e.limboKeysByTarget[n];i&&r.currentStatusUpdate===cn.MarkCurrent&&!t.documentUpdates.get(i)&&t.addDocumentUpdate(new ue(i,t.snapshotVersion))}),this.localStore.applyRemoteEvent(t).then(function(n){return e.emitNewSnapsAndNotifyLocalStore(n,t)})},t.prototype.rejectListen=function(t,e){var n=this;this.assertSubscribed("rejectListens()");var r=this.limboKeysByTarget[t];if(r){this.limboTargetsByKey=this.limboTargetsByKey.remove(r),delete this.limboKeysByTarget[t];var i=new ce(ae.comparator);i=i.insert(r,new ue(r,We.forDeletedDoc()));var o=new yn(We.MIN,{},i);return this.applyRemoteEvent(o)}var a=this.queryViewsByTarget[t];return c(!!a,"Unknown targetId: "+t),this.localStore.releaseQuery(a.query).then(function(){return n.removeAndCleanupQuery(a).then(function(){n.errorHandler(a.query,e)})})},t.prototype.applySuccessfulWrite=function(t){var e=this;return this.assertSubscribed("applySuccessfulWrite()"),this.processUserCallback(t.batch.batchId,null),this.localStore.acknowledgeBatch(t).then(function(t){return e.emitNewSnapsAndNotifyLocalStore(t)})},t.prototype.rejectFailedWrite=function(t,e){var n=this;return this.assertSubscribed("rejectFailedWrite()"),this.processUserCallback(t,e),this.localStore.rejectBatch(t).then(function(t){return n.emitNewSnapsAndNotifyLocalStore(t)})},t.prototype.addMutationCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];n||(n=new ce(L)),n=n.insert(t,e),this.mutationUserCallbacks[this.currentUser.toKey()]=n},t.prototype.processUserCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];if(n){var r=n.get(t);r&&(c(t===n.minKey(),"Mutation callbacks processed out-of-order?"),e?r.reject(e):r.resolve(),n=n.remove(t)),this.mutationUserCallbacks[this.currentUser.toKey()]=n}},t.prototype.removeAndCleanupQuery=function(t){return this.queryViewsByQuery.delete(t.query),delete this.queryViewsByTarget[t.targetId],this.limboDocumentRefs.removeReferencesForId(t.targetId),this.gcLimboDocuments()},t.prototype.updateTrackedLimbos=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof $n?(this.limboDocumentRefs.addReference(i.key,t),this.trackLimboChange(i)):i instanceof tr?(o("SyncEngine","Document no longer in limbo: "+i.key),this.limboDocumentRefs.removeReference(i.key,t)):u("Unknown limbo change: "+JSON.stringify(i))}return this.gcLimboDocuments()},t.prototype.trackLimboChange=function(t){var e=t.key;if(!this.limboTargetsByKey.get(e)){o("SyncEngine","New document in limbo: "+e);var n=this.targetIdGenerator.next(),r=Pe.atPath(e.path);this.limboKeysByTarget[n]=e,this.remoteStore.listen(new ze(r,n,ye.Listen)),this.limboTargetsByKey=this.limboTargetsByKey.insert(e,n)}},t.prototype.gcLimboDocuments=function(){var t=this;return this.limboCollector.collectGarbage(null).next(function(e){e.forEach(function(e){var n=t.limboTargetsByKey.get(e);null!==n&&(t.remoteStore.unlisten(n),t.limboTargetsByKey=t.limboTargetsByKey.remove(e),delete t.limboKeysByTarget[n])})}).toPromise()},t.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},t.prototype.emitNewSnapsAndNotifyLocalStore=function(t,e){var n=this,r=[],i=[],o=[];return this.queryViewsByQuery.forEach(function(a,s){o.push(Promise.resolve().then(function(){var e=s.view.computeDocChanges(t);return e.needsRefill?n.localStore.executeQuery(s.query).then(function(t){return s.view.computeDocChanges(t,e)}):e}).then(function(t){var o=e&&e.targetChanges[s.targetId],a=s.view.applyChanges(t,o);return n.updateTrackedLimbos(s.targetId,a.limboChanges).then(function(){if(a.snapshot){r.push(a.snapshot);var t=Hn.fromSnapshot(a.snapshot);i.push(t)}})}))}),Promise.all(o).then(function(){return n.viewHandler(r),n.localStore.notifyLocalViewChanges(i)}).then(function(){return n.localStore.collectGarbage()})},t.prototype.assertSubscribed=function(t){c(null!==this.viewHandler&&null!==this.errorHandler,"Trying to call "+t+" before calling subscribe().")},t.prototype.handleUserChange=function(t){var e=this;return this.currentUser=t,this.localStore.handleUserChange(t).then(function(t){return e.emitNewSnapsAndNotifyLocalStore(t)}).then(function(){return e.remoteStore.handleUserChange(t)})},t}(),ir=-1,or=function(){function t(t,e,n){this.batchId=t,this.localWriteTime=e,this.mutations=n}return t.prototype.applyToRemoteDocument=function(t,e,n){e&&c(e.key.equals(t),"applyToRemoteDocument: key "+t+" should match maybeDoc key\n        "+e.key);var r=n.mutationResults;c(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.equals(t)){var a=r[i];e=o.applyToRemoteDocument(e,a)}}return e},t.prototype.applyToLocalView=function(t,e){e&&c(e.key.equals(t),"applyToLocalDocument: key "+t+" should match maybeDoc key\n        "+e.key);for(var n=0;n<this.mutations.length;n++){var r=this.mutations[n];r.key.equals(t)&&(e=r.applyToLocalView(e,this.localWriteTime))}return e},t.prototype.keys=function(){for(var t=et(),e=0,n=this.mutations;e<n.length;e++){var r=n[e];t=t.add(r.key)}return t},t.prototype.equals=function(t){return this.batchId===t.batchId&&B(this.mutations,t.mutations)},t.prototype.isTombstone=function(){return 0===this.mutations.length},t.prototype.toTombstone=function(){return new t(this.batchId,this.localWriteTime,[])},t}(),ar=function(){function t(t,e,n,r,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.streamToken=r,this.docVersions=i}return t.from=function(e,n,r,i){c(e.mutations.length===r.length,"Mutations sent "+e.mutations.length+" must equal results received "+r.length);for(var o=tt(),a=e.mutations,s=0;s<a.length;s++){var u=r[s].version;null===u&&(u=n),o=o.insert(a[s].key,u)}return new t(e,n,r,i,o)},t}(),sr="",ur="",cr="",hr="",lr=function(){function t(t,e){this.seconds=t,this.nanos=e}return t}(),fr=function(){function t(t,e){this.ownerId=t,this.leaseTimestampMs=e}return t.store="owner",t}(),pr=function(){function t(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}return t.store="mutationQueues",t.keyPath="userId",t}(),dr=function(){function t(t,e,n,r){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.mutations=r}return t.store="mutations",t.keyPath=["userId","batchId"],t}(),yr=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,ut(e)]},t.key=function(t,e,n){return[t,ut(e),n]},t.store="documentMutations",t.PLACEHOLDER=new t,t}(),mr=function(){function t(t,e){this.path=t,this.readTime=e}return t}(),gr=function(){function t(t,e){this.noDocument=t,this.document=e}return t.store="remoteDocuments",t}(),vr=function(){function t(t,e,n,r,i,o){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.query=o}return t.store="targets",t.keyPath="targetId",t.queryTargetsIndexName="queryTargetsIndex",t.queryTargetsKeyPath=["canonicalId","targetId"],t}(),br=function(){function t(t,e){this.targetId=t,this.path=e}return t.store="targetDocuments",t.keyPath=["targetId","path"],t.documentTargetsIndex="documentTargetsIndex",t.documentTargetsKeyPath=["path","targetId"],t}(),wr=function(){function t(t,e,n){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n}return t.key="targetGlobalKey",t.store="targetGlobal",t}(),Ir=[pr.store,dr.store,yr.store,gr.store,vr.store,fr.store,wr.store,br.store],Tr=function(){function t(t){this.db=t}return t.openOrCreate=function(e,n,r){return c(t.isAvailable(),"IndexedDB not supported in current environment."),o("SimpleDb","Opening database:",e),new Gn(function(i,a){var s=window.indexedDB.open(e,n);s.onsuccess=function(e){var n=e.target.result;i(new t(n))},s.onerror=function(t){a(t.target.error)},s.onupgradeneeded=function(t){o("SimpleDb",'Database "'+e+'" requires upgrade from version:',t.oldVersion);var n=t.target.result;r(n,t.oldVersion)}}).toPromise()},t.delete=function(t){return o("SimpleDb","Removing database:",t),pt(window.indexedDB.deleteDatabase(t)).toPromise()},t.isAvailable=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;var t=window.navigator.userAgent;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0)},t.prototype.runTransaction=function(t,e,n){var r=new Sr(this.db,t,e),i=n(r).catch(function(t){return r.abort(),Gn.reject(t)}).toPromise();return r.completionPromise.then(function(){return i})},t.prototype.close=function(){this.db.close()},t}(),Er=function(){function t(t){this.dbCursor=t,this.shouldStop=!1,this.nextKey=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skipToKey",{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.dbCursor=t},enumerable:!0,configurable:!0}),t.prototype.done=function(){this.shouldStop=!0},t.prototype.skip=function(t){this.nextKey=t},t.prototype.delete=function(){return pt(this.dbCursor.delete())},t}(),Sr=function(){function t(t,e,n){var r=this;this.aborted=!1,this.transaction=t.transaction(n,e),this.completionPromise=new Promise(function(t,e){r.transaction.onabort=r.transaction.oncomplete=function(e){t()},r.transaction.onerror=function(t){e(t.target.error)}})}return t.prototype.abort=function(){this.aborted||(o("SimpleDb","Aborting transaction."),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return c(!!e,"Object store not part of transaction: "+t),new Nr(e)},t}(),Nr=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(o("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(o("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),pt(n)},t.prototype.get=function(t){var e=this;return pt(this.store.get(t)).next(function(n){return void 0===n&&(n=null),o("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return o("SimpleDb","DELETE",this.store.name,t),pt(this.store.delete(t))},t.prototype.loadAll=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.iterateCursor(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.deleteAll=function(t,e){o("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.keysOnly=!1;var r=this.cursor(n);return this.iterateCursor(r,function(t,e,n){return n.delete()})},t.prototype.iterate=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.iterateCursor(r,e)},t.prototype.iterateCursor=function(t,e){var n=[];return new Gn(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(!i)return void r();var o=new Er(i),a=e(i.primaryKey,i.value,o);a instanceof Gn&&n.push(a),o.isDone?r():null===o.skipToKey?i.continue():i.continue(o.skipToKey)}}).next(function(){return Gn.waitFor(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:(c(void 0===e,"3rd argument must not be defined if 2nd is a range."),e=t)),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.keysOnly?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}(),Cr=function(){function t(t,e){this.userId=t,this.serializer=e,this.garbageCollector=null}return t.forUser=function(e,n){return c(""!==e.uid,"UserID must not be an empty string."),new t(e.isUnauthenticated()?"":e.uid,n)},t.prototype.start=function(e){var n=this;return t.loadNextBatchIdFromDb(e).next(function(t){return n.nextBatchId=t,gt(e).get(n.userId)}).next(function(t){return t||(t=new pr(n.userId,ir,"")),n.metadata=t,n.metadata.lastAcknowledgedBatchId>=n.nextBatchId?n.checkEmpty(e).next(function(t){return c(t,"Reset nextBatchID is only possible when the queue is empty"),n.metadata.lastAcknowledgedBatchId=ir,gt(e).put(n.metadata)}):Gn.resolve()})},t.loadNextBatchIdFromDb=function(t){var e=ir;return yt(t).iterate({reverse:!0},function(t,n,r){var i=t[0];if(t[1]>e&&(e=n.batchId),""===i)r.done();else{var o=U(i);r.skip([o])}}).next(function(){return e+1})},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound(this.keyForBatchId(Number.NEGATIVE_INFINITY),this.keyForBatchId(Number.POSITIVE_INFINITY));return yt(t).iterate({range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.getNextBatchId=function(t){return Gn.resolve(this.nextBatchId)},t.prototype.getHighestAcknowledgedBatchId=function(t){return Gn.resolve(this.metadata.lastAcknowledgedBatchId)},t.prototype.acknowledgeBatch=function(t,e,n){var r=e.batchId;return c(r>this.metadata.lastAcknowledgedBatchId,"Mutation batchIDs must be acknowledged in order"),this.metadata.lastAcknowledgedBatchId=r,this.metadata.lastStreamToken=dt(n),gt(t).put(this.metadata)},t.prototype.getLastStreamToken=function(t){return Gn.resolve(this.metadata.lastStreamToken)},t.prototype.setLastStreamToken=function(t,e){return this.metadata.lastStreamToken=dt(e),gt(t).put(this.metadata)},t.prototype.addMutationBatch=function(t,e,n){var r=this,i=this.nextBatchId;this.nextBatchId++;var o=new or(i,e,n),a=this.serializer.toDbMutationBatch(this.userId,o);return yt(t).put(a).next(function(){for(var e=[],o=0,a=n;o<a.length;o++){var s=a[o],u=(ut(s.key.path),yr.key(r.userId,s.key.path,i));mt(t).put(u,yr.PLACEHOLDER)}return Gn.waitFor(e)}).next(function(){return o})},t.prototype.lookupMutationBatch=function(t,e){var n=this;return yt(t).get(this.keyForBatchId(e)).next(function(t){return t?n.serializer.fromDbMutationBatch(t):null})},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=IDBKeyRange.lowerBound(this.keyForBatchId(e+1)),i=null;return yt(t).iterate({range:r},function(t,r,o){r.userId===n.userId&&(c(r.batchId>e,"Should have found mutation after "+e),i=n.serializer.fromDbMutationBatch(r)),o.done()}).next(function(){return i})},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound(this.keyForBatchId(ir),this.keyForBatchId(Number.POSITIVE_INFINITY));return yt(t).loadAll(n).next(function(t){return t.map(function(t){return e.serializer.fromDbMutationBatch(t)})})},t.prototype.getAllMutationBatchesThroughBatchId=function(t,e){var n=this,r=IDBKeyRange.bound(this.keyForBatchId(ir),this.keyForBatchId(e));return yt(t).loadAll(r).next(function(t){return t.map(function(t){return n.serializer.fromDbMutationBatch(t)})})},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=yr.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return mt(t).iterate({range:i},function(r,i,a){var s=r[0],c=r[1],h=r[2],l=lt(c);if(s!==n.userId||!e.path.equals(l))return void a.done();var f=n.keyForBatchId(h);return yt(t).get(f).next(function(t){null===t&&u("Dangling document-mutation reference found: "+r+" which points to "+f),o.push(n.serializer.fromDbMutationBatch(t))})}).next(function(){return o})},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this;c(!e.isDocumentQuery(),"Document queries shouldn't go down this path");var r=e.path,i=r.length+1,o=yr.prefixForPath(this.userId,r),a=(o[1],IDBKeyRange.lowerBound(o)),s=new hn(L);return mt(t).iterate({range:a},function(t,e,o){var a=t[0],u=t[1],c=t[2],h=lt(u);if(a!==n.userId||!r.isPrefixOf(h))return void o.done();h.length===i&&(s=s.add(c))}).next(function(){var e=[],r=[];return s.forEach(function(i){var o=n.keyForBatchId(i);r.push(yt(t).get(o).next(function(t){null===t&&u("Dangling document-mutation reference found, which points to "+o),e.push(n.serializer.fromDbMutationBatch(t))}))}),Gn.waitFor(r).next(function(){return e})})},t.prototype.removeMutationBatches=function(t,e){for(var n=yt(t),r=mt(t),i=[],o=this,a=0,s=e;a<s.length;a++){var u=s[a];!function(t){var e=IDBKeyRange.only(o.keyForBatchId(t.batchId)),a=0,s=n.iterate({range:e},function(t,e,n){return a++,n.delete()});i.push(s.next(function(){c(1===a,"Dangling document-mutation reference found: Missing batch "+t.batchId)}));for(var u=0,h=t.mutations;u<h.length;u++){var l=h[u],f=yr.key(o.userId,l.key.path,t.batchId);i.push(r.delete(f)),null!==o.garbageCollector&&o.garbageCollector.addPotentialGarbageKey(l.key)}}(u)}return Gn.waitFor(i)},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next(function(n){if(!n)return Gn.resolve();var r=IDBKeyRange.lowerBound(yr.prefixForUser(e.userId)),i=[];return mt(t).iterate({range:r},function(t,n,r){if(t[0]!==e.userId)return void r.done();var o=lt(t[1]);i.push(o)}).next(function(){c(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map(function(t){return t.canonicalString()}))})})},t.prototype.setGarbageCollector=function(t){this.garbageCollector=t},t.prototype.containsKey=function(t,e){var n=this,r=yr.prefixForPath(this.userId,e.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return mt(t).iterate({range:o,keysOnly:!0},function(t,e,r){var o=t[0],s=t[1];t[2],o===n.userId&&s===i&&(a=!0),r.done()}).next(function(){return a})},t.prototype.keyForBatchId=function(t){return[this.userId,t]},t}(),Dr=function(){function t(t){this.serializer=t,this.lastRemoteSnapshotVersion=We.MIN,this.metadata=new wr(0,0,We.MIN.toTimestamp()),this.garbageCollector=null}return t.prototype.start=function(t){var e=this;return wt(t).get(wr.key).next(function(t){if(null!==t){e.metadata=t;var n=t.lastRemoteSnapshotVersion;e.lastRemoteSnapshotVersion=We.fromTimestamp(new Ge(n.seconds,n.nanos))}return Gn.resolve()})},t.prototype.getHighestTargetId=function(){return this.metadata.highestTargetId},t.prototype.getLastRemoteSnapshotVersion=function(){return this.lastRemoteSnapshotVersion},t.prototype.setLastRemoteSnapshotVersion=function(t,e){return this.lastRemoteSnapshotVersion=e,this.metadata.lastRemoteSnapshotVersion=e.toTimestamp(),wt(t).put(wr.key,this.metadata)},t.prototype.addQueryData=function(t,e){var n=this,r=e.targetId,i=bt(t).put(this.serializer.toDbTarget(e));return r>this.metadata.highestTargetId?(this.metadata.highestTargetId=r,i.next(function(){return wt(t).put(wr.key,n.metadata)})):i},t.prototype.removeQueryData=function(t,e){return this.removeMatchingKeysForTargetId(t,e.targetId).next(function(){bt(t).delete(e.targetId)})},t.prototype.getQueryData=function(t,e){var n=this,r=e.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return bt(t).iterate({range:i,index:vr.queryTargetsIndexName},function(t,r,i){var a=n.serializer.fromDbTarget(r);e.equals(a.query)&&(o=a,i.done())}).next(function(){return o})},t.prototype.addMatchingKeys=function(t,e,n){var r=[],i=It(t);return e.forEach(function(t){var e=ut(t.path);r.push(i.put(new br(n,e)))}),Gn.waitFor(r)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=[],o=It(t);return e.forEach(function(t){var e=ut(t.path);i.push(o.delete([n,e])),null!==r.garbageCollector&&r.garbageCollector.addPotentialGarbageKey(t)}),Gn.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=It(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return this.notifyGCForRemovedKeys(t,r).next(function(){return n.delete(r)})},t.prototype.notifyGCForRemovedKeys=function(t,e){var n=this,r=It(t);return null!==this.garbageCollector&&this.garbageCollector.isEager?r.iterate({range:e,keysOnly:!0},function(t,e,r){var i=lt(t[1]),o=new ae(i);c(null!==n.garbageCollector,"GarbageCollector for query cache set to null during key removal."),n.garbageCollector.addPotentialGarbageKey(o)}):Gn.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=It(t),i=et();return r.iterate({range:n,keysOnly:!0},function(t,e,n){var r=lt(t[1]),o=new ae(r);i=i.add(o)}).next(function(){return i})},t.prototype.setGarbageCollector=function(t){this.garbageCollector=t},t.prototype.containsKey=function(t,e){c(null!==t,"Persistence Transaction cannot be null for query cache containsKey");var n=ut(e.path),r=IDBKeyRange.bound([n],[F(n)],!1,!0),i=0;return It(t).iterate({index:br.documentTargetsIndex,keysOnly:!0,range:r},function(t,e,n){i++,n.done()}).next(function(){return i>0})},t}(),Ar=function(){function t(t){this.serializer=t}return t.prototype.addEntry=function(t,e){return Et(t).put(St(e.key),this.serializer.toDbRemoteDocument(e))},t.prototype.removeEntry=function(t,e){return Et(t).delete(St(e))},t.prototype.getEntry=function(t,e){var n=this;return Et(t).get(St(e)).next(function(t){return t?n.serializer.fromDbRemoteDocument(t):null})},t.prototype.getDocumentsMatchingQuery=function(t,e){var n=this,r=$(),i=e.path.toArray(),o=IDBKeyRange.lowerBound(i);return Et(t).iterate({range:o},function(t,i,o){var a=n.serializer.fromDbRemoteDocument(i);e.path.isPrefixOf(a.key.path)?a instanceof se&&e.matches(a)&&(r=r.insert(a.key,a)):o.done()}).next(function(){return r})},t}(),kr=function(){function t(t){this.remoteSerializer=t}return t.prototype.fromDbRemoteDocument=function(t){if(t.document)return this.remoteSerializer.fromDocument(t.document);if(t.noDocument){var e=ae.fromSegments(t.noDocument.path),n=t.noDocument.readTime,r=new Ge(n.seconds,n.nanos);return new ue(e,We.fromTimestamp(r))}return u("Unexpected DbRemoteDocument")},t.prototype.toDbRemoteDocument=function(t){if(t instanceof se){var e=this.remoteSerializer.toDocument(t);return new gr(null,e)}var n=t.key.path.toArray(),r=t.version.toTimestamp(),i=new lr(r.seconds,r.nanos);return new gr(new mr(n,i),null)},t.prototype.toDbMutationBatch=function(t,e){var n=this,r=e.mutations.map(function(t){return n.remoteSerializer.toMutation(t)});return new dr(t,e.batchId,e.localWriteTime.toEpochMilliseconds(),r)},t.prototype.fromDbMutationBatch=function(t){var e=this,n=t.mutations.map(function(t){return e.remoteSerializer.fromMutation(t)}),r=Ge.fromEpochMilliseconds(t.localWriteTimeMs);return new or(t.batchId,r,n)},t.prototype.fromDbTarget=function(t){var e,n=new Ge(t.readTime.seconds,t.readTime.nanos),r=We.fromTimestamp(n);return e=Nt(t.query)?this.remoteSerializer.fromDocumentsTarget(t.query):this.remoteSerializer.fromQueryTarget(t.query),new ze(e,t.targetId,ye.Listen,r,t.resumeToken)},t.prototype.toDbTarget=function(t){c(ye.Listen===t.purpose,"Only queries with purpose "+ye.Listen+" may be stored, got "+t.purpose);var e,n=t.snapshotVersion.toTimestamp(),r=new lr(n.seconds,n.nanos);e=t.query.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(t.query):this.remoteSerializer.toQueryTarget(t.query),c("string"==typeof t.resumeToken,"Persisting non-string resume token not supported.");var i=t.resumeToken;return new vr(t.targetId,t.query.canonicalId(),r,i,0,e)},t}(),Rr="There is another tab open with offline persistence enabled. Only one such tab is allowed at a time. The other tab must be closed or persistence must be disabled.",Or=function(){function t(e,n){this.ownerId=this.generateOwnerId(),this.dbName=e+t.MAIN_DATABASE,this.serializer=new kr(n),this.localStoragePrefix=e}return t.prototype.start=function(){var e=this;return t.isAvailable()?(c(!this.started,"IndexedDbPersistence double-started!"),this.started=!0,Tr.openOrCreate(this.dbName,1,ft).then(function(t){e.simpleDb=t}).then(function(){return e.tryAcquireOwnerLease()}).then(function(){e.scheduleOwnerLeaseRefreshes(),e.attachWindowUnloadHook()})):(this.persistenceError=new Ht(Wt.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled."),Promise.reject(this.persistenceError))},t.prototype.shutdown=function(){var t=this;return c(this.started,"IndexedDbPersistence shutdown without start!"),this.started=!1,this.detachWindowUnloadHook(),this.stopOwnerLeaseRefreshes(),this.releaseOwnerLease().then(function(){t.simpleDb.close()})},t.prototype.getMutationQueue=function(t){return Cr.forUser(t,this.serializer)},t.prototype.getQueryCache=function(){return new Dr(this.serializer)},t.prototype.getRemoteDocumentCache=function(){return new Ar(this.serializer)},t.prototype.runTransaction=function(t,e){var n=this;return this.persistenceError?Promise.reject(this.persistenceError):(o("IndexedDbPersistence","Starting transaction:",t),this.simpleDb.runTransaction("readwrite",Ir,function(t){return n.ensureOwnerLease(t).next(function(){return e(t)})}))},t.isAvailable=function(){return Tr.isAvailable()},t.buildStoragePrefix=function(t){var e=t.databaseId.projectId;return t.databaseId.isDefaultDatabase||(e+="."+t.databaseId.database),"firestore/"+t.persistenceKey+"/"+e+"/"},t.prototype.tryAcquireOwnerLease=function(){var t=this;return this.simpleDb.runTransaction("readwrite",[fr.store],function(e){var n=e.store(fr.store);return n.get("owner").next(function(e){if(t.validOwner(e))return o("IndexedDbPersistence","Valid owner already. Failing. Current owner:",e),t.persistenceError=new Ht(Wt.FAILED_PRECONDITION,Rr),Gn.reject(t.persistenceError);var r=new fr(t.ownerId,Date.now());return o("IndexedDbPersistence","No valid owner. Acquiring owner lease. Current owner:",e,"New owner:",r),n.put("owner",r)})})},t.prototype.releaseOwnerLease=function(){var t=this;return this.simpleDb.runTransaction("readwrite",[fr.store],function(e){var n=e.store(fr.store);return n.get("owner").next(function(e){return null!==e&&e.ownerId===t.ownerId?(o("IndexedDbPersistence","Releasing owner lease."),n.delete("owner")):Gn.resolve()})})},t.prototype.ensureOwnerLease=function(t){var e=this;return t.store(fr.store).get("owner").next(function(t){return null===t||t.ownerId!==e.ownerId?(e.persistenceError=new Ht(Wt.FAILED_PRECONDITION,Rr),Gn.reject(e.persistenceError)):Gn.resolve()})},t.prototype.validOwner=function(t){var e=Date.now(),n=e-5e3,r=e;return!(null===t||t.leaseTimestampMs<n||(t.leaseTimestampMs>r?(a("Persistence owner-lease is in the future. Discarding.",t),1):t.ownerId===this.getZombiedOwnerId()))},t.prototype.scheduleOwnerLeaseRefreshes=function(){var t=this;this.ownerLeaseRefreshHandle=setInterval(function(){t.runTransaction("Refresh owner timestamp",function(e){return e.store(fr.store).put("owner",new fr(t.ownerId,Date.now()))}).catch(function(e){a(e),t.stopOwnerLeaseRefreshes()})},4e3)},t.prototype.stopOwnerLeaseRefreshes=function(){this.ownerLeaseRefreshHandle&&(clearInterval(this.ownerLeaseRefreshHandle),this.ownerLeaseRefreshHandle=null)},t.prototype.attachWindowUnloadHook=function(){var t=this;this.windowUnloadHandler=function(){t.setZombiedOwnerId(t.ownerId),t.shutdown()},window.addEventListener("unload",this.windowUnloadHandler)},t.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(window.removeEventListener("unload",this.windowUnloadHandler),this.windowUnloadHandler=null)},t.prototype.getZombiedOwnerId=function(){try{var t=window.localStorage.getItem(this.zombiedOwnerLocalStorageKey());return o("IndexedDbPersistence","Zombied ownerID from LocalStorage:",t),t}catch(t){return a("IndexedDbPersistence","Failed to get zombie owner id.",t),null}},t.prototype.setZombiedOwnerId=function(t){try{null===t?window.localStorage.removeItem(this.zombiedOwnerLocalStorageKey()):window.localStorage.setItem(this.zombiedOwnerLocalStorageKey(),t)}catch(t){a("IndexedDbPersistence","Failed to set zombie owner id.",t)}},t.prototype.zombiedOwnerLocalStorageKey=function(){return this.localStoragePrefix+"zombiedOwnerId"},t.prototype.generateOwnerId=function(){return zt.newId()},t.MAIN_DATABASE="main",t}(),Mr=function(){function t(t,e){this.remoteDocumentCache=t,this.mutationQueue=e}return t.prototype.getDocument=function(t,e){var n=this;return this.remoteDocumentCache.getEntry(t,e).next(function(r){return n.computeLocalDocument(t,e,r)})},t.prototype.getDocuments=function(t,e){var n=this,r=[],i=Z();return e.forEach(function(e){r.push(n.getDocument(t,e).next(function(t){t||(t=new ue(e,We.forDeletedDoc())),i=i.insert(e,t)}))}),Gn.waitFor(r).next(function(){return i})},t.prototype.getDocumentsMatchingQuery=function(t,e){return ae.isDocumentKey(e.path)?this.getDocumentsMatchingDocumentQuery(t,e.path):this.getDocumentsMatchingCollectionQuery(t,e)},t.prototype.getDocumentsMatchingDocumentQuery=function(t,e){return this.getDocument(t,new ae(e)).next(function(t){var e=$();return t instanceof se&&(e=e.insert(t.key,t)),e})},t.prototype.getDocumentsMatchingCollectionQuery=function(t,e){var n,r=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(t,e).next(function(e){return r.computeLocalDocuments(t,e)}).next(function(i){return n=i,r.mutationQueue.getAllMutationBatchesAffectingQuery(t,e)}).next(function(e){for(var i=et(),o=0,a=e;o<a.length;o++)for(var s=a[o],u=0,c=s.mutations;u<c.length;u++){var h=c[u];n.get(h.key)||(i=i.add(h.key))}var l=[];return i.forEach(function(e){l.push(r.getDocument(t,e).next(function(t){t instanceof se&&(n=n.insert(t.key,t))}))}),Gn.waitFor(l)}).next(function(){return n.forEach(function(t,r){e.matches(r)||(n=n.remove(t))}),n})},t.prototype.computeLocalDocument=function(t,e,n){return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(t,e).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];n=o.applyToLocalView(e,n)}return n})},t.prototype.computeLocalDocuments=function(t,e){var n=this,r=[];return e.forEach(function(i,o){r.push(n.computeLocalDocument(t,i,o).next(function(t){t instanceof se?e=e.insert(t.key,t):t instanceof ue?e=e.remove(t.key):u("Unknown MaybeDocument: "+t)}))}),Gn.waitFor(r).next(function(){return e})},t}(),_r=function(){function t(t){this.remoteDocumentCache=t,this.changes=Z()}return t.prototype.addEntry=function(t){var e=this.assertChanges();this.changes=e.insert(t.key,t)},t.prototype.getEntry=function(t,e){var n=this.assertChanges(),r=n.get(e);return r?Gn.resolve(r):this.remoteDocumentCache.getEntry(t,e)},t.prototype.apply=function(t){var e=this,n=this.assertChanges(),r=[];return n.forEach(function(n,i){r.push(e.remoteDocumentCache.addEntry(t,i))}),this.changes=null,Gn.waitFor(r)},t.prototype.assertChanges=function(){return c(null!==this.changes,"Changes have already been applied."),this.changes},t}(),Pr=function(){function t(t,e,n){this.persistence=t,this.garbageCollector=n,this.localViewReferences=new zn,this.targetIds={},this.targetIdGenerator=Zn.forLocalStore(),this.heldBatchResults=[],this.mutationQueue=t.getMutationQueue(e),this.remoteDocuments=t.getRemoteDocumentCache(),this.queryCache=t.getQueryCache(),this.localDocuments=new Mr(this.remoteDocuments,this.mutationQueue),this.garbageCollector.addGarbageSource(this.localViewReferences),this.garbageCollector.addGarbageSource(this.queryCache),this.garbageCollector.addGarbageSource(this.mutationQueue)}return t.prototype.start=function(){var t=this;return this.persistence.runTransaction("Start LocalStore",function(e){return t.startMutationQueue(e).next(function(){return t.startQueryCache(e)})})},t.prototype.handleUserChange=function(t){var e=this;return this.persistence.runTransaction("Handle user change",function(n){var r;return e.mutationQueue.getAllMutationBatches(n).next(function(i){return r=i,e.garbageCollector.removeGarbageSource(e.mutationQueue),e.mutationQueue=e.persistence.getMutationQueue(t),e.garbageCollector.addGarbageSource(e.mutationQueue),e.startMutationQueue(n)}).next(function(){return e.localDocuments=new Mr(e.remoteDocuments,e.mutationQueue),e.mutationQueue.getAllMutationBatches(n)}).next(function(t){for(var i=et(),o=0,a=[r,t];o<a.length;o++)for(var s=a[o],u=0,c=s;u<c.length;u++)for(var h=c[u],l=0,f=h.mutations;l<f.length;l++){var p=f[l];i=i.add(p.key)}return e.localDocuments.getDocuments(n,i)})})},t.prototype.startQueryCache=function(t){var e=this;return this.queryCache.start(t).next(function(){var t=e.queryCache.getHighestTargetId();e.targetIdGenerator=Zn.forLocalStore(t)})},t.prototype.startMutationQueue=function(t){var e=this;return this.mutationQueue.start(t).next(function(){return e.heldBatchResults=[],e.mutationQueue.getHighestAcknowledgedBatchId(t)}).next(function(n){return n!==ir?e.mutationQueue.getAllMutationBatchesThroughBatchId(t,n):Gn.resolve([])}).next(function(n){return n.length>0?e.mutationQueue.removeMutationBatches(t,n):Gn.resolve()})},t.prototype.localWrite=function(t){var e=this;return this.persistence.runTransaction("Locally write mutations",function(n){var r,i=Ge.now();return e.mutationQueue.addMutationBatch(n,i,t).next(function(t){r=t;var i=r.keys();return e.localDocuments.getDocuments(n,i)}).next(function(t){return{batchId:r.batchId,changes:t}})})},t.prototype.acknowledgeBatch=function(t){var e=this;return this.persistence.runTransaction("Acknowledge batch",function(n){var r;return e.mutationQueue.acknowledgeBatch(n,t.batch,t.streamToken).next(function(){if(e.shouldHoldBatchResult(t.commitVersion))return e.heldBatchResults.push(t),r=et(),Gn.resolve();var i=new _r(e.remoteDocuments);return e.releaseBatchResults(n,[t],i).next(function(t){return r=t,i.apply(n)})}).next(function(){return e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,r)})})},t.prototype.rejectBatch=function(t){var e=this;return this.persistence.runTransaction("Reject batch",function(n){var r,i;return e.mutationQueue.lookupMutationBatch(n,t).next(function(i){return c(null!=i,"Attempt to reject nonexistent batch!"),r=i,e.mutationQueue.getHighestAcknowledgedBatchId(n).next(function(e){return c(t>e,"Acknowledged batches can't be rejected."),r})}).next(function(){return e.removeMutationBatch(n,r)}).next(function(t){return i=t,e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,i)})})},t.prototype.getLastStreamToken=function(){var t=this;return this.persistence.runTransaction("Get last stream token",function(e){return t.mutationQueue.getLastStreamToken(e)})},t.prototype.setLastStreamToken=function(t){var e=this;return this.persistence.runTransaction("Set last stream token",function(n){return e.mutationQueue.setLastStreamToken(n,t)})},t.prototype.getLastRemoteSnapshotVersion=function(){return this.queryCache.getLastRemoteSnapshotVersion()},t.prototype.applyRemoteEvent=function(t){var e=this,n=new _r(this.remoteDocuments);return this.persistence.runTransaction("Apply remote event",function(r){var i=[];d(t.targetChanges,function(t,n){var o=e.targetIds[t];if(o){var a=n.mapping;if(a)if(a instanceof vn)i.push(e.queryCache.removeMatchingKeysForTargetId(r,t).next(function(){return e.queryCache.addMatchingKeys(r,a.documents,t)}));else{if(!(a instanceof bn))return u("Unknown mapping type: "+JSON.stringify(a));i.push(e.queryCache.removeMatchingKeys(r,a.removedDocuments,t).next(function(){return e.queryCache.addMatchingKeys(r,a.addedDocuments,t)}))}var s=n.resumeToken;s.length>0&&(o=o.update({resumeToken:s,snapshotVersion:n.snapshotVersion}),e.targetIds[t]=o,i.push(e.queryCache.addQueryData(r,o)))}});var a=et();t.documentUpdates.forEach(function(t,s){a=a.add(t),i.push(n.getEntry(r,t).next(function(r){null==r||s.version.equals(We.MIN)||s.version.compareTo(r.version)>=0?n.addEntry(s):o("LocalStore","Ignoring outdated watch update for ",t,". Current version:",r.version," Watch version:",s.version),e.garbageCollector.addPotentialGarbageKey(t)}))});var s=e.queryCache.getLastRemoteSnapshotVersion(),h=t.snapshotVersion;h.equals(We.MIN)||(c(h.compareTo(s)>=0,"Watch stream reverted to previous snapshot?? "+h+" < "+s),i.push(e.queryCache.setLastRemoteSnapshotVersion(r,h)));var l;return Gn.waitFor(i).next(function(){return e.releaseHeldBatchResults(r,n)}).next(function(t){return l=t,n.apply(r)}).next(function(){return e.localDocuments.getDocuments(r,a.unionWith(l))})})},t.prototype.notifyLocalViewChanges=function(t){var e=this;return this.persistence.runTransaction("Notify local view changes",function(n){for(var r=[],i=0,o=t;i<o.length;i++){var a=o[i];!function(t){r.push(e.queryCache.getQueryData(n,t.query).next(function(n){c(null!==n,"Local view changes contain unallocated query.");var r=n.targetId;e.localViewReferences.addReferences(t.addedKeys,r),e.localViewReferences.removeReferences(t.removedKeys,r)}))}(a)}return Gn.waitFor(r)})},t.prototype.nextMutationBatch=function(t){var e=this;return this.persistence.runTransaction("Get next mutation batch",function(n){return void 0===t&&(t=ir),e.mutationQueue.getNextMutationBatchAfterBatchId(n,t)})},t.prototype.readDocument=function(t){var e=this;return this.persistence.runTransaction("read document",function(n){return e.localDocuments.getDocument(n,t)})},t.prototype.allocateQuery=function(t){var e=this;return this.persistence.runTransaction("Allocate query",function(n){var r;return e.queryCache.getQueryData(n,t).next(function(i){if(i)return r=i,Gn.resolve();var o=e.targetIdGenerator.next();return r=new ze(t,o,ye.Listen),e.queryCache.addQueryData(n,r)}).next(function(){return c(!e.targetIds[r.targetId],"Tried to allocate an already allocated query: "+t),e.targetIds[r.targetId]=r,r})})},t.prototype.releaseQuery=function(t){var e=this;return this.persistence.runTransaction("Release query",function(n){return e.queryCache.getQueryData(n,t).next(function(r){return c(null!=r,"Tried to release nonexistent query: "+t),e.localViewReferences.removeReferencesForId(r.targetId),delete e.targetIds[r.targetId],e.garbageCollector.isEager?e.queryCache.removeQueryData(n,r):Gn.resolve()}).next(function(){if(m(e.targetIds)){var t=new _r(e.remoteDocuments);return e.releaseHeldBatchResults(n,t).next(function(){t.apply(n)})}return Gn.resolve()})})},t.prototype.executeQuery=function(t){var e=this;return this.persistence.runTransaction("Execute query",function(n){return e.localDocuments.getDocumentsMatchingQuery(n,t)})},t.prototype.remoteDocumentKeys=function(t){var e=this;return this.persistence.runTransaction("Remote document keys",function(n){return e.queryCache.getMatchingKeysForTargetId(n,t)})},t.prototype.collectGarbage=function(){var t=this;return this.persistence.runTransaction("Garbage collection",function(e){return t.garbageCollector.collectGarbage(e).next(function(n){var r=[];return n.forEach(function(n){r.push(t.remoteDocuments.removeEntry(e,n))}),Gn.waitFor(r)})})},t.prototype.releaseHeldBatchResults=function(t,e){for(var n=[],r=0,i=this.heldBatchResults;r<i.length;r++){var o=i[r];if(!this.isRemoteUpToVersion(o.commitVersion))break;n.push(o)}return 0===n.length?Gn.resolve(et()):(this.heldBatchResults.splice(0,n.length),this.releaseBatchResults(t,n,e))},t.prototype.isRemoteUpToVersion=function(t){var e=this.queryCache.getLastRemoteSnapshotVersion();return t.compareTo(e)<=0||m(this.targetIds)},t.prototype.shouldHoldBatchResult=function(t){return!this.isRemoteUpToVersion(t)||this.heldBatchResults.length>0},t.prototype.releaseBatchResults=function(t,e,n){for(var r=this,i=Gn.resolve(),o=0,a=e;o<a.length;o++){var s=a[o];!function(e){i=i.next(function(){return r.applyWriteToRemoteDocuments(t,e,n)})}(s)}return i.next(function(){return r.removeMutationBatches(t,e.map(function(t){return t.batch}))})},t.prototype.removeMutationBatch=function(t,e){return this.removeMutationBatches(t,[e])},t.prototype.removeMutationBatches=function(t,e){for(var n=et(),r=0,i=e;r<i.length;r++)for(var o=i[r],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key;n=n.add(c)}return this.mutationQueue.removeMutationBatches(t,e).next(function(){return n})},t.prototype.applyWriteToRemoteDocuments=function(t,e,n){var r=e.batch,i=r.keys(),o=Gn.resolve();return i.forEach(function(i){o=o.next(function(){return n.getEntry(t,i)}).next(function(t){var o=t,a=e.docVersions.get(i);c(null!==a,"ackVersions should contain every doc in the write."),(!o||o.version.compareTo(a)<0)&&(o=r.applyToRemoteDocument(i,o,e),o?n.addEntry(o):c(!t,"Mutation batch "+r+" applied to document "+t+" resulted in null"))})}),o},t}(),Lr=function(){function t(){this.mutationQueue=[],this.nextBatchId=1,this.highestAcknowledgedBatchId=ir,this.lastStreamToken=h(),this.garbageCollector=null,this.batchesByDocumentKey=new hn(Xn.compareByKey)}return t.prototype.start=function(t){return 0===this.mutationQueue.length&&(this.nextBatchId=1,this.highestAcknowledgedBatchId=ir),c(this.highestAcknowledgedBatchId<this.nextBatchId,"highestAcknowledgedBatchId must be less than the nextBatchId"),Gn.resolve()},t.prototype.checkEmpty=function(t){return Gn.resolve(0===this.mutationQueue.length)},t.prototype.getNextBatchId=function(t){return Gn.resolve(this.nextBatchId)},t.prototype.getHighestAcknowledgedBatchId=function(t){return Gn.resolve(this.highestAcknowledgedBatchId)},t.prototype.acknowledgeBatch=function(t,e,n){var r=e.batchId;c(r>this.highestAcknowledgedBatchId,"Mutation batchIDs must be acknowledged in order");var i=this.indexOfExistingBatchId(r,"acknowledged"),o=this.mutationQueue[i];return c(r===o.batchId,"Queue ordering failure: expected batch "+r+", got batch "+o.batchId),c(!o.isTombstone(),"Can't acknowledge a previously removed batch"),this.highestAcknowledgedBatchId=r,this.lastStreamToken=n,Gn.resolve()},t.prototype.getLastStreamToken=function(t){return Gn.resolve(this.lastStreamToken)},t.prototype.setLastStreamToken=function(t,e){return this.lastStreamToken=e,Gn.resolve()},t.prototype.addMutationBatch=function(t,e,n){c(0!==n.length,"Mutation batches should not be empty");var r=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&c(this.mutationQueue[this.mutationQueue.length-1].batchId<r,"Mutation batchIDs must be monotonically increasing order");var i=new or(r,e,n);this.mutationQueue.push(i);for(var o=0,a=n;o<a.length;o++){var s=a[o];this.batchesByDocumentKey=this.batchesByDocumentKey.add(new Xn(s.key,r))}return Gn.resolve(i)},t.prototype.lookupMutationBatch=function(t,e){return Gn.resolve(this.findMutationBatch(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this.mutationQueue.length;e=Math.max(e+1,this.highestAcknowledgedBatchId);for(var r=this.indexOfBatchId(e),i=r<0?0:r;i<n;i++){var o=this.mutationQueue[i];if(!o.isTombstone())return Gn.resolve(o)}return Gn.resolve(null)},t.prototype.getAllMutationBatches=function(t){return Gn.resolve(this.getAllLiveMutationBatchesBeforeIndex(this.mutationQueue.length))},t.prototype.getAllMutationBatchesThroughBatchId=function(t,e){var n=this.mutationQueue.length,r=this.indexOfBatchId(e);return r<0?r=0:r>=n?r=n:r++,Gn.resolve(this.getAllLiveMutationBatchesBeforeIndex(r))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Xn(e,0),i=new Xn(e,Number.POSITIVE_INFINITY),o=[];return this.batchesByDocumentKey.forEachInRange([r,i],function(t){c(e.equals(t.key),"Should only iterate over a single key's batches");var r=n.findMutationBatch(t.targetOrBatchId);c(null!==r,"Batches in the index must exist in the main table"),o.push(r)}),Gn.resolve(o)},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=r;ae.isDocumentKey(o)||(o=o.child(""));var a=new Xn(new ae(o),0),s=new hn(L);this.batchesByDocumentKey.forEachWhile(function(t){var e=t.key.path;return!!r.isPrefixOf(e)&&(e.length===i&&(s=s.add(t.targetOrBatchId)),!0)},a);var u=[];return s.forEach(function(t){var e=n.findMutationBatch(t);null!==e&&u.push(e)}),Gn.resolve(u)},t.prototype.removeMutationBatches=function(t,e){var n=e.length;c(n>0,"Should not remove mutations when none exist.");var r=e[0].batchId,i=this.mutationQueue.length,o=this.indexOfExistingBatchId(r,"removed");c(this.mutationQueue[o].batchId===r,"Removed batches must exist in the queue");for(var a=1,s=o+1;a<n&&s<i;){var u=this.mutationQueue[s];u.isTombstone()?s++:(c(u.batchId===e[a].batchId,"Removed batches must be contiguous in the queue"),a++,s++)}if(0===o){for(;s<i;s++){var u=this.mutationQueue[s];if(!u.isTombstone())break}var h=s-o;this.mutationQueue.splice(o,h)}else for(var l=o;l<s;l++)this.mutationQueue[l]=this.mutationQueue[l].toTombstone();for(var f=this.batchesByDocumentKey,p=0,d=e;p<d.length;p++)for(var u=d[p],y=u.batchId,m=0,g=u.mutations;m<g.length;m++){var v=g[m],b=v.key;null!==this.garbageCollector&&this.garbageCollector.addPotentialGarbageKey(b);var w=new Xn(b,y);f=f.delete(w)}return this.batchesByDocumentKey=f,Gn.resolve()},t.prototype.setGarbageCollector=function(t){this.garbageCollector=t},t.prototype.containsKey=function(t,e){var n=new Xn(e,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return Gn.resolve(e.equals(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return 0===this.mutationQueue.length&&c(this.batchesByDocumentKey.isEmpty(),"Document leak -- detected dangling mutation references when queue is empty."),Gn.resolve()},t.prototype.getAllLiveMutationBatchesBeforeIndex=function(t){for(var e=[],n=0;n<t;n++){var r=this.mutationQueue[n];r.isTombstone()||e.push(r)}return e},t.prototype.indexOfExistingBatchId=function(t,e){var n=this.indexOfBatchId(t);return c(n>=0&&n<this.mutationQueue.length,"Batches must exist to be "+e),n},t.prototype.indexOfBatchId=function(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId},t.prototype.findMutationBatch=function(t){var e=this.indexOfBatchId(t);if(e<0||e>=this.mutationQueue.length)return null;var n=this.mutationQueue[e];return c(n.batchId===t,"If found batch must match"),n.isTombstone()?null:n},t}(),xr=function(){function t(){this.queries=new qn(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=We.MIN,this.highestTargetId=0,this.references=new zn}return t.prototype.start=function(t){return Gn.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(){return this.lastRemoteSnapshotVersion},t.prototype.getHighestTargetId=function(){return this.highestTargetId},t.prototype.setLastRemoteSnapshotVersion=function(t,e){return this.lastRemoteSnapshotVersion=e,Gn.resolve()},t.prototype.addQueryData=function(t,e){this.queries.set(e.query,e);var n=e.targetId;return n>this.highestTargetId&&(this.highestTargetId=n),Gn.resolve()},t.prototype.removeQueryData=function(t,e){return this.queries.delete(e.query),this.references.removeReferencesForId(e.targetId),Gn.resolve()},t.prototype.getQueryData=function(t,e){var n=this.queries.get(e)||null;return Gn.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this.references.addReferences(e,n),Gn.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){return this.references.removeReferences(e,n),Gn.resolve()},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this.references.removeReferencesForId(e),Gn.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this.references.referencesForId(e);return Gn.resolve(n)},t.prototype.setGarbageCollector=function(t){this.references.setGarbageCollector(t)},t.prototype.containsKey=function(t,e){return this.references.containsKey(t,e)},t}(),Br=function(){function t(){this.docs=Z()}return t.prototype.addEntry=function(t,e){return this.docs=this.docs.insert(e.key,e),Gn.resolve()},t.prototype.removeEntry=function(t,e){return this.docs=this.docs.remove(e),Gn.resolve()},t.prototype.getEntry=function(t,e){return Gn.resolve(this.docs.get(e))},t.prototype.getDocumentsMatchingQuery=function(t,e){for(var n=$(),r=new ae(e.path.child("")),i=this.docs.getIteratorFrom(r);i.hasNext();){var o=i.getNext(),a=o.key,s=o.value;if(!e.path.isPrefixOf(a.path))break;s instanceof se&&e.matches(s)&&(n=n.insert(s.key,s))}return Gn.resolve(n)},t}(),Ur=function(){function t(){this.mutationQueues={},this.remoteDocumentCache=new Br,this.queryCache=new xr,this.started=!1}return t.prototype.start=function(){return c(!this.started,"MemoryPersistence double-started!"),this.started=!0,Promise.resolve()},t.prototype.shutdown=function(){return c(this.started,"MemoryPersistence shutdown without start!"),this.started=!1,Promise.resolve()},t.prototype.getMutationQueue=function(t){var e=this.mutationQueues[t.toKey()];return e||(e=new Lr,this.mutationQueues[t.toKey()]=e),e},t.prototype.getQueryCache=function(){return this.queryCache},t.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},t.prototype.runTransaction=function(t,e){return o("MemoryPersistence","Starting transaction:",t),e(new Fr).toPromise()},t}(),Fr=function(){function t(){}return t}(),Vr=function(){function t(){this.isEager=!1}return t.prototype.addGarbageSource=function(t){},t.prototype.removeGarbageSource=function(t){},t.prototype.addPotentialGarbageKey=function(t){},t.prototype.collectGarbage=function(t){return Gn.resolve(et())},t}(),qr=function(){function t(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return t}(),jr=function(){function t(t,e,n){this.initialDelayMs=t,this.backoffFactor=e,this.maxDelayMs=n,this.reset()}return t.prototype.reset=function(){this.currentBaseMs=0},t.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},t.prototype.backoffAndWait=function(){var t=new qr,e=this.currentBaseMs+this.jitterDelayMs();return this.currentBaseMs>0&&o("ExponentialBackoff","Backing off for "+e+" ms (base delay: "+this.currentBaseMs+" ms)"),setTimeout(function(){t.resolve()},e),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs),t.promise},t.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},t}(),Kr=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(t){t[t.Initial=0]="Initial",t[t.Auth=1]="Auth",t[t.Open=2]="Open",t[t.Error=3]="Error",t[t.Backoff=4]="Backoff",t[t.Stopped=5]="Stopped"}(Jn||(Jn={}));var Qr,Gr=1e3,Wr=6e4,Hr=1.5,zr=function(){function t(t,e,n,r,i){this.queue=t,this.connection=e,this.credentialsProvider=n,this.stream=null,this.listener=null,this.backoff=new jr(i||Gr,Hr,Wr),this.state=Jn.Initial,this.listener=r}return t.prototype.isStarted=function(){return this.state===Jn.Backoff||this.state===Jn.Auth||this.state===Jn.Open},t.prototype.isOpen=function(){return this.state===Jn.Open},t.prototype.start=function(){if(this.state===Jn.Error)return void this.performBackoff();c(this.state===Jn.Initial,"Already started"),this.auth()},t.prototype.stop=function(){this.state=Jn.Stopped,this.listener=null,null!==this.stream&&(this.stream.close(),this.stream=null)},t.prototype.inhibitBackoff=function(){c(!this.isStarted(),"Can only inhibit backoff in a stopped state"),this.state=Jn.Initial,this.backoff.reset()},t.prototype.auth=function(){var t=this;c(this.state===Jn.Initial,"Must be in initial state to auth"),this.state=Jn.Auth,this.credentialsProvider.getToken(!1).then(function(e){t.startStream(e)},function(e){t.queue.schedule(function(){if(t.state!==Jn.Stopped){var n=new Ht(Wt.UNKNOWN,"Fetching auth token failed: "+e.message);return t.handleStreamClose(n)}return Promise.resolve()})})},t.prototype.startStream=function(t){var e=this;if(this.state!==Jn.Stopped){c(this.state===Jn.Auth,"Trying to start stream in a non-auth state");var n=function(t){e.queue.schedule(function(){return e.state!==Jn.Stopped?t():Promise.resolve()})};null!==this.listener&&(this.stream=this.startRpc(t),this.stream.onOpen(function(){n(function(){return c(e.state===Jn.Auth,"Expected stream to be in state auth, but was "+e.state),e.state=Jn.Open,e.listener.onOpen()})}),this.stream.onClose(function(t){n(function(){return e.handleStreamClose(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})}))}},t.prototype.performBackoff=function(){var t=this;c(this.state===Jn.Error,"Should only perform backoff in an error case"),this.state=Jn.Backoff,this.backoff.backoffAndWait().then(function(){t.queue.schedule(function(){return t.state===Jn.Stopped?Promise.resolve():(t.state=Jn.Initial,t.start(),c(t.isStarted(),"PersistentStream should have started"),Promise.resolve())})})},t.prototype.handleStreamClose=function(t){return c(this.isStarted(),"Can't handle server close on non-started stream"),o("PersistentStream","close with error: "+t),this.stream=null,this.state=Jn.Error,t&&t.code===Wt.RESOURCE_EXHAUSTED&&(o("PersistentStream","Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()),this.listener.onClose(t)},t}(),Xr=function(t){function e(e,n,r,i,o,a,s){var u=t.call(this,n,r,i,a,s)||this;return u.databaseInfo=e,u.serializer=o,u}return Kr(e,t),e.prototype.startRpc=function(t){return this.connection.openStream("Listen",t)},e.prototype.onMessage=function(t){this.backoff.reset();var e=this.serializer.fromWatchChange(t),n=this.serializer.versionFromListenResponse(t);return this.listener.onWatchChange(e,n)},e.prototype.watch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.addTarget=this.serializer.toTarget(t);var n=this.serializer.toListenRequestLabels(t);n&&(e.labels=n),this.stream.send(e)},e.prototype.unwatch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.removeTarget=t,this.stream.send(e)},e}(zr),Yr=function(t){function e(e,n,r,i,o,a,s){var u=t.call(this,n,r,i,a,s)||this;return u.databaseInfo=e,u.serializer=o,u.y=!1,u}return Kr(e,t),Object.defineProperty(e.prototype,"handshakeComplete",{get:function(){return this.y},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.y=!1,t.prototype.start.call(this)},e.prototype.startRpc=function(t){return this.connection.openStream("Write",t)},e.prototype.onMessage=function(t){if(c(!!t.streamToken,"Got a write response without a stream token"),this.lastStreamToken=t.streamToken,this.y){this.backoff.reset();var e=this.serializer.fromWriteResults(t.writeResults),n=this.serializer.fromVersion(t.commitTime);return this.listener.onMutationResult(n,e)}return c(!t.writeResults||0===t.writeResults.length,"Got mutation results for handshake"),this.y=!0,this.listener.onHandshakeComplete()},e.prototype.writeHandshake=function(){c(this.isOpen(),"Writing handshake requires an opened stream"),c(!this.y,"Handshake already completed");var t={};t.database=this.serializer.encodedDatabaseId,this.stream.send(t)},e.prototype.writeMutations=function(t){var e=this;c(this.isOpen(),"Writing mutations requires an opened stream"),c(this.y,"Handshake must be complete before writing mutations"),c(this.lastStreamToken.length>0,"Trying to write mutation without a token");var n={streamToken:this.lastStreamToken,writes:t.map(function(t){return e.serializer.toMutation(t)})};this.stream.send(n)},e}(zr),Jr=function(){function t(t,e,n,r,i,o){this.databaseInfo=t,this.queue=e,this.connection=n,this.credentials=r,this.serializer=i,this.initialBackoffDelay=o}return t.prototype.newPersistentWriteStream=function(t){return new Yr(this.databaseInfo,this.queue,this.connection,this.credentials,this.serializer,t,this.initialBackoffDelay)},t.prototype.newPersistentWatchStream=function(t){return new Xr(this.databaseInfo,this.queue,this.connection,this.credentials,this.serializer,t,this.initialBackoffDelay)},t.prototype.commit=function(t){var e=this,n={writes:t.map(function(t){return e.serializer.toMutation(t)})};return this.invokeRPC("commit",n).then(function(t){return e.serializer.fromWriteResults(t.writeResults)})},t.prototype.lookup=function(t){var e=this,n={documents:t.map(function(t){return e.serializer.toName(t)})};return this.invokeRPC("batchGet",n).then(function(n){var r=Z();n.forEach(function(t){var n=e.serializer.fromMaybeDocument(t);r=r.insert(n.key,n)});var i=[];return t.forEach(function(t){var e=r.get(t);c(!!e,"Missing entity in write response for "+t),i.push(e)}),i})},t.prototype.invokeRPC=function(t,e){var n=this;return this.credentials.getToken(!1).then(function(r){return n.connection.invoke(t,e,r)})},t}(),Zr=function(){function t(t){this.datastore=t,this.readVersions=tt(),this.mutations=[],this.committed=!1}return t.prototype.recordVersion=function(t){var e=t.version;t instanceof ue&&(e=We.forDeletedDoc());var n=this.readVersions.get(t.key);if(null!==n){if(!e.equals(n))throw new Ht(Wt.ABORTED,"Document version changed between two reads.")}else this.readVersions=this.readVersions.insert(t.key,e)},t.prototype.lookup=function(t){var e=this;return this.committed?Promise.reject("Transaction has already completed."):this.mutations.length>0?Promise.reject("Transactions lookups are invalid after writes."):this.datastore.lookup(t).then(function(t){return t.forEach(function(t){return e.recordVersion(t)}),t})},t.prototype.write=function(t){if(this.committed)throw new Ht(Wt.FAILED_PRECONDITION,"Transaction has already completed.");this.mutations=this.mutations.concat(t)},t.prototype.precondition=function(t){var e=this.readVersions.get(t);return e?en.updateTime(e):en.NONE},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t);if(e&&e.equals(We.forDeletedDoc()))throw new Ht(Wt.FAILED_PRECONDITION,"Can't update a document that doesn't exist.");return e?en.updateTime(e):en.exists(!0)},t.prototype.set=function(t,e){this.write(e.toMutations(t,this.precondition(t)))},t.prototype.update=function(t,e){this.write(e.toMutations(t,this.preconditionForUpdate(t)))},t.prototype.delete=function(t){this.write([new sn(t,this.precondition(t))]),this.readVersions=this.readVersions.insert(t,We.forDeletedDoc())},t.prototype.commit=function(){var t=this,e=this.readVersions;return this.mutations.forEach(function(t){e=e.remove(t.key)}),e.isEmpty()?this.datastore.commit(this.mutations).then(function(){t.committed=!0}):Promise.reject(Error("Every document read in a transaction must also be written."))},t}(),$r=function(){function t(t,e,n,r,i){this.databaseInfo=t,this.asyncQueue=e,this.localStore=n,this.datastore=r,this.onlineStateHandler=i,this.pendingWrites=[],this.lastBatchSeen=ir,this.listenTargets={},this.pendingTargetResponses={},this.accumulatedWatchChanges=[],this.watchStream=null,this.writeStream=null,this.watchStreamOnlineState=_n.Unknown,this.watchStreamFailures=0}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.setOnlineStateToHealthy=function(){this.updateAndBroadcastOnlineState(_n.Healthy)},t.prototype.setOnlineStateToUnknown=function(){this.watchStreamFailures=0,this.updateAndBroadcastOnlineState(_n.Unknown)},t.prototype.updateOnlineStateAfterFailure=function(){this.watchStreamOnlineState===_n.Healthy?this.setOnlineStateToUnknown():++this.watchStreamFailures>=2&&this.updateAndBroadcastOnlineState(_n.Failed)},t.prototype.updateAndBroadcastOnlineState=function(t){var e=this.watchStreamOnlineState!==t;this.watchStreamOnlineState=t,e&&this.onlineStateHandler(t)},t.prototype.isNetworkEnabled=function(){return c(null==this.watchStream==(null==this.writeStream),"WatchStream and WriteStream should both be null or non-null"),null!=this.watchStream},t.prototype.enableNetwork=function(){var t=this;return c(null==this.watchStream,"enableNetwork() called with non-null watchStream."),c(null==this.writeStream,"enableNetwork() called with non-null writeStream."),this.watchStream=this.datastore.newPersistentWatchStream({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)}),this.writeStream=this.datastore.newPersistentWriteStream({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)}),this.localStore.getLastStreamToken().then(function(e){return t.writeStream.lastStreamToken=e,t.shouldStartWatchStream()&&t.startWatchStream(),t.updateAndBroadcastOnlineState(_n.Unknown),t.fillWritePipeline()})},t.prototype.disableNetwork=function(){return this.updateAndBroadcastOnlineState(_n.Failed),this.watchStream.stop(),this.writeStream.stop(),this.cleanUpWatchStreamState(),this.cleanUpWriteStreamState(),this.writeStream=null,this.watchStream=null,Promise.resolve()},t.prototype.shutdown=function(){return o("RemoteStore","RemoteStore shutting down."),this.disableNetwork(),Promise.resolve(void 0)},t.prototype.listen=function(t){c(!f(this.listenTargets,t.targetId),"listen called with duplicate targetId!"),this.listenTargets[t.targetId]=t,this.shouldStartWatchStream()?this.startWatchStream():this.isNetworkEnabled()&&this.watchStream.isOpen()&&this.sendWatchRequest(t)},t.prototype.unlisten=function(t){c(f(this.listenTargets,t),"unlisten called without assigned target ID!"),this.listenTargets[t],delete this.listenTargets[t],this.isNetworkEnabled()&&this.watchStream.isOpen()&&this.sendUnwatchRequest(t)},t.prototype.sendWatchRequest=function(t){this.recordPendingTargetRequest(t.targetId),this.watchStream.watch(t)},t.prototype.sendUnwatchRequest=function(t){this.recordPendingTargetRequest(t),this.watchStream.unwatch(t)},t.prototype.recordPendingTargetRequest=function(t){this.pendingTargetResponses[t]=(this.pendingTargetResponses[t]||0)+1},t.prototype.startWatchStream=function(){c(this.shouldStartWatchStream(),"startWriteStream() called when shouldStartWatchStream() is false."),this.watchStream.start()},t.prototype.shouldStartWatchStream=function(){return this.isNetworkEnabled()&&!this.watchStream.isStarted()&&!m(this.listenTargets)},t.prototype.cleanUpWatchStreamState=function(){this.accumulatedWatchChanges=[],this.pendingTargetResponses={}},t.prototype.onWatchStreamOpen=function(){var t=this;return d(this.listenTargets,function(e,n){t.sendWatchRequest(n)}),Promise.resolve()},t.prototype.onWatchStreamClose=function(t){return c(this.isNetworkEnabled(),"onWatchStreamClose() should only be called when the network is enabled"),this.cleanUpWatchStreamState(),this.shouldStartWatchStream()?(this.updateOnlineStateAfterFailure(),this.startWatchStream()):this.setOnlineStateToUnknown(),Promise.resolve()},t.prototype.onWatchStreamChange=function(t,e){if(this.setOnlineStateToHealthy(),t instanceof Tn&&t.state===mn.Removed&&t.cause)return this.handleTargetError(t);if(this.accumulatedWatchChanges.push(t),!e.equals(We.MIN)&&e.compareTo(this.localStore.getLastRemoteSnapshotVersion())>=0){var n=this.accumulatedWatchChanges;return this.accumulatedWatchChanges=[],this.handleWatchChangeBatch(e,n)}return Promise.resolve()},t.prototype.handleWatchChangeBatch=function(t,e){var n=this,r=new En(t,this.listenTargets,this.pendingTargetResponses);r.addChanges(e);var i=r.createRemoteEvent();this.pendingTargetResponses=r.pendingTargetResponses;var o=[];return d(r.existenceFilters,function(e,r){var a=n.listenTargets[e];if(a){var s=a.query;if(s.isDocumentQuery())if(0===r.count){var u=new ae(s.path),h=new ue(u,t);i.addDocumentUpdate(h)}else c(1===r.count,"Single document existence filter with count: "+r.count);else{var l=n.localStore.remoteDocumentKeys(e).then(function(t){if(i.targetChanges[e]){var o=i.targetChanges[e].mapping;null!==o&&(o instanceof bn?t=o.applyToKeySet(t):(c(o instanceof vn,"Expected either reset or update mapping but got something else: "+o),t=o.documents))}if(t.size!==r.count){i.handleExistenceFilterMismatch(e);var u=new ze(s,e,a.purpose);n.listenTargets[e]=u,n.sendUnwatchRequest(e);var h=new ze(s,e,ye.ExistenceFilterMismatch);n.sendWatchRequest(h)}});o.push(l)}}}),Promise.all(o).then(function(){return d(i.targetChanges,function(t,e){if(e.resumeToken.length>0){var r=n.listenTargets[t];r&&(n.listenTargets[t]=r.update({resumeToken:e.resumeToken,snapshotVersion:e.snapshotVersion}))}}),n.syncEngine.applyRemoteEvent(i)})},t.prototype.handleTargetError=function(t){var e=this;c(!!t.cause,"Handling target error without a cause");var n=t.cause,r=Promise.resolve();return t.targetIds.forEach(function(t){r=r.then(function(){return f(e.listenTargets,t)?(delete e.listenTargets[t],e.syncEngine.rejectListen(t,n)):Promise.resolve()})}),r},t.prototype.cleanUpWriteStreamState=function(){this.lastBatchSeen=ir,this.pendingWrites=[]},t.prototype.fillWritePipeline=function(){var t=this;return this.canWriteMutations()?this.localStore.nextMutationBatch(this.lastBatchSeen).then(function(e){return null===e?Promise.resolve():(t.commit(e),t.fillWritePipeline())}):Promise.resolve()},t.prototype.canWriteMutations=function(){return this.isNetworkEnabled()&&this.pendingWrites.length<10},t.prototype.outstandingWrites=function(){return this.pendingWrites.length},t.prototype.commit=function(t){c(this.canWriteMutations(),"commit called when batches can't be written"),this.lastBatchSeen=t.batchId,this.pendingWrites.push(t),this.shouldStartWriteStream()?this.startWriteStream():this.isNetworkEnabled()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(t.mutations)},t.prototype.shouldStartWriteStream=function(){return this.isNetworkEnabled()&&!this.writeStream.isStarted()&&this.pendingWrites.length>0},t.prototype.startWriteStream=function(){c(this.shouldStartWriteStream(),"startWriteStream() called when shouldStartWriteStream() is false."),this.writeStream.start()},t.prototype.onWriteStreamOpen=function(){return this.writeStream.writeHandshake(),Promise.resolve()},t.prototype.onWriteHandshakeComplete=function(){var t=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then(function(){for(var e=0,n=t.pendingWrites;e<n.length;e++){var r=n[e];t.writeStream.writeMutations(r.mutations)}})},t.prototype.onMutationResult=function(t,e){var n=this;c(this.pendingWrites.length>0,"Got result for empty pending writes");var r=this.pendingWrites.shift(),i=ar.from(r,t,e,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(i).then(function(){return n.fillWritePipeline()})},t.prototype.onWriteStreamClose=function(t){var e=this;if(c(this.isNetworkEnabled(),"onWriteStreamClose() should only be called when the network is enabled"),this.pendingWrites.length>0){c(!!t,"We have pending writes, but the write stream closed without an error");var n=void 0;return n=this.writeStream.handshakeComplete?this.handleWriteError(t):this.handleHandshakeError(t),n.then(function(){e.shouldStartWriteStream()&&e.startWriteStream()})}return Promise.resolve()},t.prototype.handleHandshakeError=function(t){return H(t.code)||t.code===Wt.ABORTED?(o("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=h(),this.localStore.setLastStreamToken(h())):Promise.resolve()},t.prototype.handleWriteError=function(t){var e=this;if(H(t.code)){var n=this.pendingWrites.shift();return this.writeStream.inhibitBackoff(),this.syncEngine.rejectFailedWrite(n.batchId,t).then(function(){return e.fillWritePipeline()})}return Promise.resolve()},t.prototype.createTransaction=function(){return new Zr(this.datastore)},t.prototype.handleUserChange=function(t){return o("RemoteStore","RemoteStore changing users: uid=",t.uid),this.disableNetwork(),this.enableNetwork()},t}(),ti=function(){function t(t,e,n,r){this.platform=t,this.databaseInfo=e,this.credentials=n,this.asyncQueue=r}return t.prototype.start=function(t){var e=this,n=new qr,r=new qr,i=!1;return this.credentials.setUserChangeListener(function(o){i?e.asyncQueue.schedule(function(){return e.handleUserChange(o)}):(i=!0,e.initializePersistence(t,r).then(function(){return e.initializeRest(o)}).then(n.resolve,n.reject))}),this.asyncQueue.schedule(function(){return n.promise}),r.promise},t.prototype.enableNetwork=function(){var t=this;return this.asyncQueue.schedule(function(){return t.remoteStore.enableNetwork()})},t.prototype.initializePersistence=function(t,e){var n=this;return t?this.startIndexedDbPersistence().then(e.resolve).catch(function(t){return e.reject(t),n.canFallback(t)?(console.warn("Error enabling offline storage. Falling back to storage disabled: "+t),n.startMemoryPersistence()):Promise.reject(t)}):(e.resolve(),this.startMemoryPersistence())},t.prototype.canFallback=function(t){return t.code===Wt.FAILED_PRECONDITION||t.code===Wt.UNIMPLEMENTED},t.prototype.startIndexedDbPersistence=function(){this.garbageCollector=new Vr;var t=Or.buildStoragePrefix(this.databaseInfo),e=new Cn(this.databaseInfo.databaseId,{useProto3Json:!0});return this.persistence=new Or(t,e),this.persistence.start()},t.prototype.startMemoryPersistence=function(){return this.garbageCollector=new Wn,this.persistence=new Ur,this.persistence.start()},t.prototype.initializeRest=function(t){var e=this;return this.platform.loadConnection(this.databaseInfo).then(function(n){e.localStore=new Pr(e.persistence,t,e.garbageCollector);var r=e.platform.newSerializer(e.databaseInfo.databaseId),i=new Jr(e.databaseInfo,e.asyncQueue,n,e.credentials,r),o=function(t){e.eventMgr.onOnlineStateChanged(t)};return e.remoteStore=new $r(e.databaseInfo,e.asyncQueue,e.localStore,i,o),e.syncEngine=new rr(e.localStore,e.remoteStore,t),e.remoteStore.syncEngine=e.syncEngine,e.eventMgr=new Kn(e.syncEngine),e.localStore.start()}).then(function(){return e.remoteStore.start()})},t.prototype.handleUserChange=function(t){return this.asyncQueue.verifyOperationInProgress(),o("FirestoreClient","User Changed: "+t.uid),this.syncEngine.handleUserChange(t)},t.prototype.disableNetwork=function(){var t=this;return this.asyncQueue.schedule(function(){return t.remoteStore.disableNetwork()})},t.prototype.shutdown=function(){var t=this;return this.asyncQueue.schedule(function(){return t.credentials.removeUserChangeListener(),t.remoteStore.shutdown()}).then(function(){return t.persistence.shutdown()})},t.prototype.listen=function(t,e,n){var r=this,i=new Qn(t,e,n);return this.asyncQueue.schedule(function(){return r.eventMgr.listen(i)}),i},t.prototype.unlisten=function(t){var e=this;this.asyncQueue.schedule(function(){return e.eventMgr.unlisten(t)})},t.prototype.write=function(t){var e=this,n=new qr;return this.asyncQueue.schedule(function(){return e.syncEngine.write(t,n)}),n.promise},t.prototype.databaseId=function(){return this.databaseInfo.databaseId},t.prototype.transaction=function(t){var e=this;return this.asyncQueue.schedule(function(){return Promise.resolve()}).then(function(){return e.syncEngine.runTransaction(t)})},t}(),ei=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.scheduleEvent(this.observer.next,t)},t.prototype.error=function(t){this.scheduleEvent(this.observer.error,t)},t.prototype.mute=function(){this.muted=!0},t.prototype.scheduleEvent=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),ni=function(){function t(){this.tail=Promise.resolve(),this.delayedOpCount=0,this.operationInProgress=!1}return t.prototype.schedule=function(t,e){var n=this;if(this.failure&&u("AsyncQueue is already failed: "+this.failure.message),(e||0)>0){this.delayedOpCount++;var r=new qr;return setTimeout(function(){n.scheduleInternal(function(){return t().then(function(t){r.resolve(t)})}),n.delayedOpCount--},e),r.promise}return this.scheduleInternal(t)},t.prototype.scheduleInternal=function(t){var e=this;return this.tail=this.tail.then(function(){return e.operationInProgress=!0,t().catch(function(t){throw e.failure=t,e.operationInProgress=!1,a("INTERNAL UNHANDLED ERROR: ",t.stack||t.message),t}).then(function(){e.operationInProgress=!1})}),this.tail},t.prototype.verifyOperationInProgress=function(){c(this.operationInProgress,"verifyOpInProgress() called when no op in progress on this queue.")},t.prototype.drain=function(){return c(0===this.delayedOpCount,"draining doesn't handle delayed ops."),this.schedule(function(){return Promise.resolve(void 0)})},t}(),ri=function(){function t(t){this.uid=t}return t.prototype.isUnauthenticated=function(){return null==this.uid},t.prototype.toKey=function(){return this.isUnauthenticated()?"anonymous-user":"uid:"+this.uid},t.prototype.equals=function(t){return t.uid===this.uid},t.UNAUTHENTICATED=new t(null),t.GOOGLE_CREDENTIALS=new t("google-credentials-uid"),t.FIRST_PARTY=new t("first-party-uid"),t}(),ii=function(){function t(t,e){this.user=e,this.type="OAuth",this.authHeaders={Authorization:"Bearer "+t}}return t}(),oi=function(){function t(){this.userListener=null}return t.prototype.getToken=function(t){return Promise.resolve(null)},t.prototype.setUserChangeListener=function(t){c(!this.userListener,"Can only call setUserChangeListener() once."),this.userListener=t,t(ri.UNAUTHENTICATED)},t.prototype.removeUserChangeListener=function(){c(null!==this.userListener,"removeUserChangeListener() when no listener registered"),this.userListener=null},t}(),ai=function(){function t(t){var e=this;this.app=t,this.tokenListener=null,this.userCounter=0,this.userListener=null,this.tokenListener=function(){var t=e.getUser();e.currentUser&&t.equals(e.currentUser)||(e.currentUser=t,e.userCounter++,e.userListener&&e.userListener(e.currentUser))},this.userCounter=0,this.app.INTERNAL.addAuthTokenListener(this.tokenListener)}return t.prototype.getToken=function(t){var e=this;c(null!=this.tokenListener,"getToken cannot be called after listener removed.");var n=this.userCounter;return this.app.INTERNAL.getToken(t).then(function(t){if(e.userCounter!==n)throw new Ht(Wt.ABORTED,"getToken aborted due to uid change.");return t?(c("string"==typeof t.accessToken,"Invalid tokenData returned from getToken():"+t),new ii(t.accessToken,e.currentUser)):null})},t.prototype.setUserChangeListener=function(t){c(!this.userListener,"Can only call setUserChangeListener() once."),this.userListener=t,this.currentUser&&t(this.currentUser)},t.prototype.removeUserChangeListener=function(){c(null!=this.tokenListener,"removeUserChangeListener() called twice"),c(null!==this.userListener,"removeUserChangeListener() called when no listener registered"),this.app.INTERNAL.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.userListener=null},t.prototype.getUser=function(){"function"!=typeof this.app.INTERNAL.getUid&&u("This version of the Firestore SDK requires at least version 3.7.0 of firebase.js.");var t=this.app.INTERNAL.getUid();return c(null===t||"string"==typeof t,"Received invalid UID: "+t),new ri(t)},t}(),si=function(){function t(t){this.authClient=t}return t.prototype.getToken=function(t){var e=this;return new Promise(function(t,n){e.authClient.getAccessToken(function(e,r){e?n(e):t(new ii(r,ri.GOOGLE_CREDENTIALS))})})},t.prototype.setUserChangeListener=function(t){t(ri.GOOGLE_CREDENTIALS)},t.prototype.removeUserChangeListener=function(){},t}(),ui=function(){function t(t,e){this.gapi=t,this.sessionIndex=e,this.type="FirstParty",this.user=ri.FIRST_PARTY,c(this.gapi&&this.gapi.auth&&this.gapi.auth.getAuthHeaderValueForFirstParty,"unexpected gapi interface")}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){return{Authorization:this.gapi.auth.getAuthHeaderValueForFirstParty([]),"X-Goog-AuthUser":this.sessionIndex}},enumerable:!0,configurable:!0}),t}(),ci=function(){function t(t,e){this.gapi=t,this.sessionIndex=e,c(this.gapi&&this.gapi.auth&&this.gapi.auth.getAuthHeaderValueForFirstParty,"unexpected gapi interface")}return t.prototype.getToken=function(t){return Promise.resolve(new ui(this.gapi,this.sessionIndex))},t.prototype.setUserChangeListener=function(t){t(ri.FIRST_PARTY)},t.prototype.removeUserChangeListener=function(){},t}(),hi=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),li=function(){function t(){}return t.delete=function(){return fi.instance},t.serverTimestamp=function(){return pi.instance},t}(),fi=function(t){function e(){return t.call(this)||this}return hi(e,t),e.instance=new e,e}(li),pi=function(t){function e(){return t.call(this)||this}return hi(e,t),e.instance=new e,e}(li),di=l(li,"Use FieldValue.<field>() instead."),yi=/^__.*__$/,mi=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[];return null!==this.fieldMask?n.push(new on(t,this.data,this.fieldMask,e)):n.push(new rn(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new an(t,this.fieldTransforms)),n},t}(),gi=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[new on(t,this.data,this.fieldMask,e)];return this.fieldTransforms.length>0&&n.push(new an(t,this.fieldTransforms)),n},t}();!function(t){t[t.Set=0]="Set",t[t.Update=1]="Update",t[t.QueryValue=2]="QueryValue"}(Qr||(Qr={}));var vi=function(){function t(t,e,n,r,i,o){this.dataSource=t,this.methodName=e,this.path=n,this.arrayElement=r,void 0===i&&this.validatePath(),this.arrayElement=void 0!==r&&r,this.fieldTransforms=i||[],this.fieldMask=o||[]}return t.prototype.childContextForField=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePathSegment(e),r},t.prototype.childContextForFieldPath=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePath(),r},t.prototype.childContextForArray=function(e){return new t(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},t.prototype.createError=function(t){var e=null===this.path||this.path.isEmpty()?"":" (found in field "+this.path+")";return new Ht(Wt.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},t.prototype.validatePath=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.validatePathSegment(this.path.get(t))},t.prototype.validatePathSegment=function(t){if(this.isWrite()&&yi.test(t))throw this.createError("Document fields cannot begin and end with __")},t.prototype.isWrite=function(){return this.dataSource===Qr.Set||this.dataSource===Qr.Update},t}(),bi=function(){function t(t,e){this.databaseId=t,this.key=e}return t}(),wi=function(){function t(t){this.preConverter=t}return t.prototype.parseSetData=function(t,e,n){var r=this,i=new vi(Qr.Set,t,oe.EMPTY_PATH);Rt("Data must be an object, but it was:",i,e);var o=void 0!==n.merge&&n.merge,a=Ae.EMPTY;y(e,function(t,e){var n=new Pn(t).t,o=i.childContextForFieldPath(n);e=r.runPreConverter(e,o);var s=r.parseData(e,o);s&&(a=a.set(n,s))});var s=o?new Ye(i.fieldMask):null;return new mi(a,s,i.fieldTransforms)},t.prototype.parseUpdateData=function(t,e){var n=this,r=new vi(Qr.Update,t,oe.EMPTY_PATH);Rt("Data must be an object, but it was:",r,e);var i=[],o=Ae.EMPTY;y(e,function(e,a){var s=Mt(t,e),u=r.childContextForFieldPath(s);if((a=n.runPreConverter(a,u))instanceof fi)i.push(s);else{var c=n.parseData(a,u);null!=c&&(i.push(s),o=o.set(s,c))}});var a=new Ye(i);return new gi(o,a,r.fieldTransforms)},t.prototype.parseUpdateVarargs=function(t,e,n,r){var i=new vi(Qr.Update,t,oe.EMPTY_PATH),o=[Ot(t,e)],a=[n];if(r.length%2!=0)throw new Ht(Wt.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var s=0;s<r.length;s+=2)o.push(Ot(t,r[s])),a.push(r[s+1]);for(var u=[],c=Ae.EMPTY,s=0;s<o.length;++s){var h=o[s],l=i.childContextForFieldPath(h),f=this.runPreConverter(a[s],l);if(f instanceof fi)u.push(h);else{var p=this.parseData(f,l);null!=p&&(u.push(h),c=c.set(h,p))}}var d=new Ye(u);return new gi(c,d,i.fieldTransforms)},t.prototype.parseQueryValue=function(t,e){var n=new vi(Qr.QueryValue,t,oe.EMPTY_PATH),r=this.parseData(e,n);return c(null!=r,"Parsed data should not be null."),c(0===n.fieldTransforms.length,"Field transforms should have been disallowed."),r},t.prototype.runPreConverter=function(t,e){try{return this.preConverter(t)}catch(t){var n=_t(t);throw e.createError(n)}},t.prototype.parseData=function(t,e){if((t=this.runPreConverter(t,e))instanceof Array){if(e.arrayElement)throw e.createError("Nested arrays are not supported");return e.path&&e.fieldMask.push(e.path),this.parseArray(t,e)}return kt(t)?(Rt("Unsupported field value:",e,t),this.parseObject(t,e)):(e.path&&e.fieldMask.push(e.path),this.parseScalarValue(t,e))},t.prototype.parseArray=function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var a=o[i],s=this.parseData(a,e.childContextForArray(r));null==s&&(s=ge.INSTANCE),n.push(s),r++}return new ke(n)},t.prototype.parseObject=function(t,e){var n=this,r=new ce(L);return y(t,function(t,i){var o=n.parseData(i,e.childContextForField(t));null!=o&&(r=r.insert(t,o))}),new Ae(r)},t.prototype.parseScalarValue=function(t,e){if(null===t)return ge.INSTANCE;if("number"==typeof t)return G(t)?new we(t):new Ie(t);if("boolean"==typeof t)return ve.of(t);if("string"==typeof t)return new Te(t);if(t instanceof Date)return new Ee(Ge.fromDate(t));if(t instanceof Jt)return new De(t);if(t instanceof Xt)return new Ne(t);if(t instanceof bi)return new Ce(t.databaseId,t.key);if(t instanceof li){if(t instanceof fi)throw e.dataSource!==Qr.Update?e.createError("FieldValue.delete() can only be used with update()"):(c(null==e.path||e.path.length>0,"FieldValue.delete() at the top level should have already been handled."),e.createError("FieldValue.delete() can only appear at the top level of your update data"));if(t instanceof pi){if(e.dataSource!==Qr.Set&&e.dataSource!==Qr.Update)throw e.createError("FieldValue.serverTimestamp() can only be used with set() and update()");if(null===e.path)throw e.createError("FieldValue.serverTimestamp() is not currently supported inside arrays");return e.fieldTransforms.push(new Ze(e.path,Je.instance)),null}return u("Unknown FieldValue type: "+t)}throw e.createError("Unsupported field value: "+A(t))},t}(),Ii=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ti="firestore.googleapis.com",Ei=!0,Si=function(){function t(t){if(void 0===t.host){if(void 0!==t.ssl)throw new Ht(Wt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Ti,this.ssl=Ei}else S("settings","string","host",t.host),this.host=t.host,N("settings","boolean","ssl",t.ssl),this.ssl=p(t.ssl,Ei);O("settings",t,["host","ssl","credentials"]),N("settings","object","credentials",t.credentials),this.credentials=t.credentials}return t.prototype.equals=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials},t}(),Ni=function(){function t(){}return t}(),Ci=function(){function t(e){var n=this;this.INTERNAL={delete:function(){return n.k?n.k.shutdown():Promise.resolve()},disableNetwork:function(){return n.k.disableNetwork()},enableNetwork:function(){return n.k.enableNetwork()}};var r=new Ni;if("object"==typeof e.options){var i=e;r.firebaseApp=i,r.databaseId=t.databaseIdFromApp(i),r.persistenceKey=r.firebaseApp.name,r.credentials=new ai(i)}else{var o=e;if(!o.projectId)throw new Ht(Wt.INVALID_ARGUMENT,"Must provide projectId");r.databaseId=new te(o.projectId,o.database),r.persistenceKey="[DEFAULT]",r.credentials=new oi}r.settings=new Si({}),this._=r,this._databaseId=r.databaseId}return t.prototype.settings=function(t){if(v("Firestore.settings",arguments,1),T("Firestore.settings","object",1,t),f(t,"persistence"))throw new Ht(Wt.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var e=new Si(t);if(this.k&&!this._.settings.equals(e))throw new Ht(Wt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this._.settings=e,void 0!==e.credentials&&(this._.credentials=Ct(e.credentials))},t.prototype.enablePersistence=function(){if(this.k)throw new Ht(Wt.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");return this.configureClient(!0)},t.prototype.ensureClientConfigured=function(){return this.k||this.configureClient(!1),this.k},t.prototype.configureClient=function(t){var e=this;c(!!this._.settings.host,"FirestoreSettings.host cannot be falsey"),c(!this.k,"configureClient() called multiple times");var n=new Zt(this._.databaseId,this._.persistenceKey,this._.settings.host,this._.settings.ssl),r=function(t){if(t instanceof ki){var n=e._.databaseId,r=t.firestore._.databaseId;if(!r.equals(n))throw new Ht(Wt.INVALID_ARGUMENT,"Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return new bi(e._.databaseId,t.x)}return t};return this._dataConverter=new wi(r),this.k=new ti(Qt.getPlatform(),n,this._.credentials,new ni),this.k.start(t)},t.databaseIdFromApp=function(t){var e=t.options;if(!f(e,"projectId")){if(f(e,"firestoreId"))throw new Ht(Wt.INVALID_ARGUMENT,'"firestoreId" is now specified as "projectId" in firebase.initializeApp.');throw new Ht(Wt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.')}if(f(e,"firestoreOptions"))throw new Ht(Wt.INVALID_ARGUMENT,'"firestoreOptions" values are now specified with Firestore.settings()');var n=e.projectId;if(!n||"string"!=typeof n)throw new Ht(Wt.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new te(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this._.firebaseApp)throw new Ht(Wt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._.firebaseApp},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(v("Firestore.collection",arguments,1),T("Firestore.collection","string",1,t),!t)throw new Ht(Wt.INVALID_ARGUMENT,"Must provide a non-empty collection path to collection()");return this.ensureClientConfigured(),new _i(re.fromString(t),this)},t.prototype.doc=function(t){if(v("Firestore.doc",arguments,1),T("Firestore.doc","string",1,t),!t)throw new Ht(Wt.INVALID_ARGUMENT,"Must provide a non-empty document path to doc()");return this.ensureClientConfigured(),ki.forPath(re.fromString(t),this)},t.prototype.runTransaction=function(t){var e=this;return v("Firestore.runTransaction",arguments,1),T("Firestore.runTransaction","function",1,t),this.ensureClientConfigured().transaction(function(n){return t(new Di(e,n))})},t.prototype.batch=function(){return this.ensureClientConfigured(),new Ai(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(r()){case Vt.DEBUG:return"debug";case Vt.ERROR:return"error";case Vt.SILENT:return"silent";default:return u("Unknown log level: "+r())}},enumerable:!0,configurable:!0}),t.setLogLevel=function(t){switch(v("Firestore.setLogLevel",arguments,1),T("Firestore.setLogLevel","string",1,t),t){case"debug":i(Vt.DEBUG);break;case"error":i(Vt.ERROR);break;case"silent":i(Vt.SILENT);break;default:throw new Ht(Wt.INVALID_ARGUMENT,"Invalid log level: "+t)}},t}(),Di=function(){function t(t,e){this.q=t,this.Q=e}return t.prototype.get=function(t){var e=this;v("Transaction.get",arguments,1);var n=Lt("Transaction.get",t,this.q);return this.Q.lookup([n.x]).then(function(t){if(!t||1!==t.length)return u("Mismatch in docs returned from document lookup.");var r=t[0];return r instanceof ue?new Ri(e.q,n.x,null,!1):new Ri(e.q,n.x,r,!1)})},t.prototype.set=function(t,e,n){w("Transaction.set",arguments,2,3);var r=Lt("Transaction.set",t,this.q);n=Pt("Transaction.set",n);var i=this.q._dataConverter.parseSetData("Transaction.set",e,n);return this.Q.set(r.x,i),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,a;return"string"==typeof e||e instanceof Pn?(b("Transaction.update",arguments,3),o=Lt("Transaction.update",t,this.q),a=this.q._dataConverter.parseUpdateVarargs("Transaction.update",e,n,r)):(v("Transaction.update",arguments,2),o=Lt("Transaction.update",t,this.q),a=this.q._dataConverter.parseUpdateData("Transaction.update",e)),this.Q.update(o.x,a),this},t.prototype.delete=function(t){v("Transaction.delete",arguments,1);var e=Lt("Transaction.delete",t,this.q);return this.Q.delete(e.x),this},t}(),Ai=function(){function t(t){this.q=t,this.z=[],this.tt=!1}return t.prototype.set=function(t,e,n){w("WriteBatch.set",arguments,2,3),this.verifyNotCommitted();var r=Lt("WriteBatch.set",t,this.q);n=Pt("WriteBatch.set",n);var i=this.q._dataConverter.parseSetData("WriteBatch.set",e,n);return this.z=this.z.concat(i.toMutations(r.x,en.NONE)),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.verifyNotCommitted();var o,a;return"string"==typeof e||e instanceof Pn?(b("WriteBatch.update",arguments,3),o=Lt("WriteBatch.update",t,this.q),a=this.q._dataConverter.parseUpdateVarargs("WriteBatch.update",e,n,r)):(v("WriteBatch.update",arguments,2),o=Lt("WriteBatch.update",t,this.q),a=this.q._dataConverter.parseUpdateData("WriteBatch.update",e)),this.z=this.z.concat(a.toMutations(o.x,en.exists(!0))),this},t.prototype.delete=function(t){v("WriteBatch.delete",arguments,1),this.verifyNotCommitted();var e=Lt("WriteBatch.delete",t,this.q);return this.z=this.z.concat(new sn(e.x,en.NONE)),this},t.prototype.commit=function(){return this.verifyNotCommitted(),this.tt=!0,this.z.length>0?this.q.ensureClientConfigured().write(this.z):Promise.resolve()},t.prototype.verifyNotCommitted=function(){if(this.tt)throw new Ht(Wt.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),ki=function(){function t(t,e){this.x=t,this.firestore=e,this.k=this.firestore.ensureClientConfigured()}return t.forPath=function(e,n){if(e.length%2!=0)throw new Ht(Wt.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(new ae(e),n)},Object.defineProperty(t.prototype,"id",{get:function(){return this.x.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new _i(this.x.path.popLast(),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.x.path.canonicalString()},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(v("DocumentReference.collection",arguments,1),T("DocumentReference.collection","string",1,t),!t)throw new Ht(Wt.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=re.fromString(t);return new _i(this.x.path.child(e),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw M("isEqual","DocumentReference",1,e);return this.firestore===e.firestore&&this.x.equals(e.x)},t.prototype.set=function(t,e){w("DocumentReference.set",arguments,1,2),e=Pt("DocumentReference.set",e);var n=this.firestore._dataConverter.parseSetData("DocumentReference.set",t,e);return this.k.write(n.toMutations(this.x,en.NONE))},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i;return"string"==typeof t||t instanceof Pn?(b("DocumentReference.update",arguments,2),i=this.firestore._dataConverter.parseUpdateVarargs("DocumentReference.update",t,e,n)):(v("DocumentReference.update",arguments,1),i=this.firestore._dataConverter.parseUpdateData("DocumentReference.update",t)),this.k.write(i.toMutations(this.x,en.exists(!0)))},t.prototype.delete=function(){return v("DocumentReference.delete",arguments,0),this.k.write([new sn(this.x,en.NONE)])},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];w("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!=typeof t[i]||Dt(t[i])||(r=t[i],O("DocumentReference.onSnapshot",r,["includeMetadataChanges"]),N("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeDocumentMetadataChanges:r.includeMetadataChanges,includeQueryMetadataChanges:r.includeMetadataChanges};return Dt(t[i])?n=t[i]:(T("DocumentReference.onSnapshot","function",i,t[i]),E("DocumentReference.onSnapshot","function",i+1,t[i+1]),E("DocumentReference.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(o,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new ei({next:function(t){if(e.next){c(t.docs.size<=1,"Too many documents returned on a document query");var r=t.docs.get(n.x);e.next(new Ri(n.firestore,n.x,r,t.fromCache))}},error:r}),o=this.k.listen(Pe.atPath(this.x.path),i,t);return function(){i.mute(),n.k.unlisten(o)}},t.prototype.get=function(){var t=this;return v("DocumentReference.get",arguments,0),new Promise(function(e,n){var r=t.onSnapshotInternal({includeQueryMetadataChanges:!0,includeDocumentMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(t){r(),!t.exists&&t.metadata.fromCache?n(new Ht(Wt.ABORTED,"Failed to get document because the client is offline.")):e(t)},error:n})})},t}(),Ri=function(){function t(t,e,n,r){this.q=t,this.x=e,this.et=n,this.nt=r}return t.prototype.data=function(){if(v("DocumentSnapshot.data",arguments,0),!this.et)throw new Ht(Wt.NOT_FOUND,"This document doesn't exist. Check doc.exists to make sure the document exists before calling doc.data().");return this.convertObject(this.et.data)},t.prototype.get=function(t){if(v("DocumentSnapshot.get",arguments,1),!this.et)throw new Ht(Wt.NOT_FOUND,"This document doesn't exist. Check doc.exists to make sure the document exists before calling doc.get().");var e=this.et.data.field(Ot("DocumentSnapshot.get",t));return void 0===e?void 0:this.convertValue(e)},Object.defineProperty(t.prototype,"id",{get:function(){return this.x.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new ki(this.x,this.q)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this.et},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return{hasPendingWrites:null!==this.et&&this.et.hasLocalMutations,fromCache:this.nt}},enumerable:!0,configurable:!0}),t.prototype.convertObject=function(t){var e=this,n={};return t.forEach(function(t,r){n[t]=e.convertValue(r)}),n},t.prototype.convertValue=function(t){if(t instanceof Ae)return this.convertObject(t);if(t instanceof ke)return this.convertArray(t);if(t instanceof Ce){var e=t.value(),n=this.q.ensureClientConfigured().databaseId();return t.databaseId.equals(n)||a("Document "+this.x.path+" contains a document reference within a different database ("+t.databaseId.projectId+"/"+t.databaseId.database+") which is not supported. It will be treated as a reference in the current database ("+n.projectId+"/"+n.database+") instead."),new ki(e,this.q)}return t.value()},t.prototype.convertArray=function(t){var e=this;return t.internalValue.map(function(t){return e.convertValue(t)})},t}(),Oi=function(){function t(t,e){this.rt=t,this.firestore=e}return t.prototype.where=function(e,n,r){v("Query.where",arguments,3),T("Query.where","string",2,n),R("Query.where",3,r);var i,o=Ot("Query.where",e);if(o.isKeyField())if("string"==typeof r){if(-1!==r.indexOf("/"))throw new Ht(Wt.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a valid document ID if the first parameter is FieldPath.documentId(), but it contains a slash.");if(""===r)throw new Ht(Wt.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a valid document ID if the first parameter is FieldPath.documentId(), but it was an empty string.");var a=this.rt.path.child(new re([r]));c(a.length%2==0,"Path should be a document key"),i=new Ce(this.firestore._databaseId,new ae(a))}else{if(!(r instanceof ki))throw new Ht(Wt.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a string or a DocumentReference if the first parameter is FieldPath.documentId(), but it was: "+A(r)+".");var s=r;i=new Ce(this.firestore._databaseId,s.x)}else i=this.firestore._dataConverter.parseQueryValue("Query.where",r);var u=W(o,Le.fromString(n),i);return this.validateNewFilter(u),new t(this.rt.addFilter(u),this.firestore)},t.prototype.orderBy=function(e,n){w("Query.orderBy",arguments,1,2),E("Query.orderBy","string",2,n);var r;if(void 0===n||"asc"===n)r=Fe.ASCENDING;else{if("desc"!==n)throw new Ht(Wt.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r=Fe.DESCENDING}if(null!==this.rt.startAt)throw new Ht(Wt.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.rt.endAt)throw new Ht(Wt.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=Ot("Query.orderBy",e),o=new qe(i,r);return this.validateNewOrderBy(o),new t(this.rt.addOrderBy(o),this.firestore)},t.prototype.limit=function(e){if(v("Query.limit",arguments,1),T("Query.limit","number",1,e),e<=0)throw new Ht(Wt.INVALID_ARGUMENT,"Invalid Query. Query limit ("+e+") is invalid. Limit must be positive.");return new t(this.rt.withLimit(e),this.firestore)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];b("Query.startAt",arguments,1);var i=this.boundFromDocOrFields("Query.startAt",e,n,!0);return new t(this.rt.withStartAt(i),this.firestore)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];b("Query.startAfter",arguments,1);var i=this.boundFromDocOrFields("Query.startAfter",e,n,!1);return new t(this.rt.withStartAt(i),this.firestore)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];b("Query.endBefore",arguments,1);var i=this.boundFromDocOrFields("Query.endBefore",e,n,!0);return new t(this.rt.withEndAt(i),this.firestore)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];b("Query.endAt",arguments,1);var i=this.boundFromDocOrFields("Query.endAt",e,n,!1);return new t(this.rt.withEndAt(i),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw M("isEqual","Query",1,e);return this.firestore===e.firestore&&this.rt.equals(e.rt)},t.prototype.boundFromDocOrFields=function(t,e,n,r){if(R(t,1,e),e instanceof Ri){if(n.length>0)throw new Ht(Wt.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new Ht(Wt.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.boundFromDocument(t,i.et,r)}var o=[e].concat(n);return this.boundFromFields(t,o,r)},t.prototype.boundFromDocument=function(t,e,n){for(var r=[],i=0,o=this.rt.orderBy;i<o.length;i++){var a=o[i];if(a.field.isKeyField())r.push(new Ce(this.firestore._databaseId,e.key));else{var s=e.field(a.field);if(void 0===s){var u=a.field.canonicalString();throw new Ht(Wt.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}r.push(s)}}return new Ve(r,n)},t.prototype.boundFromFields=function(t,e,n){var r=this.rt.explicitOrderBy;if(e.length>r.length)throw new Ht(Wt.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var a=e[o];if(r[o].field.isKeyField()){if("string"!=typeof a)throw new Ht(Wt.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof a);if(-1!==a.indexOf("/"))throw new Ht(Wt.INVALID_ARGUMENT,"Invalid query. Document ID '"+a+"' contains a slash in "+t+"()");var s=new ae(this.rt.path.child(a));i.push(new Ce(this.firestore._databaseId,s))}else{var u=this.firestore._dataConverter.parseQueryValue(t,a);i.push(u)}}return new Ve(i,n)},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];w("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof t[i]||Dt(t[i])||(r=t[i],O("Query.onSnapshot",r,["includeQueryMetadataChanges","includeDocumentMetadataChanges"]),N("Query.onSnapshot","boolean","includeDocumentMetadataChanges",r.includeDocumentMetadataChanges),N("Query.onSnapshot","boolean","includeQueryMetadataChanges",r.includeQueryMetadataChanges),i++),Dt(t[i])?n=t[i]:(T("Query.onSnapshot","function",i,t[i]),E("Query.onSnapshot","function",i+1,t[i+1]),E("Query.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(r,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new ei({next:function(t){e.next&&e.next(new Mi(n.firestore,n.rt,t))},error:r}),o=this.firestore.ensureClientConfigured(),a=o.listen(this.rt,i,t);return function(){i.mute(),o.unlisten(a)}},t.prototype.get=function(){var t=this;return v("Query.get",arguments,0),new Promise(function(e,n){var r=t.onSnapshotInternal({includeDocumentMetadataChanges:!1,includeQueryMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(t){r(),e(t)},error:n})})},t.prototype.validateNewFilter=function(t){if(t instanceof xe&&t.isInequality()){var e=this.rt.getInequalityFilterField();if(null!==e&&!e.equals(t.field))throw new Ht(Wt.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+e+"' and '"+t.field+"'");var n=this.rt.getFirstOrderByField();null!==n&&this.validateOrderByAndInequalityMatch(t.field,n)}},t.prototype.validateNewOrderBy=function(t){if(null===this.rt.getFirstOrderByField()){var e=this.rt.getInequalityFilterField();null!==e&&this.validateOrderByAndInequalityMatch(e,t.field)}},t.prototype.validateOrderByAndInequalityMatch=function(t,e){if(!e.equals(t))throw new Ht(Wt.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t+"' and so you must also use '"+t+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e+"' instead.")},t}(),Mi=function(){function t(t,e,n){this.q=t,this.it=e,this.ot=n,this._cachedChanges=null,this.metadata={fromCache:n.fromCache,hasPendingWrites:n.hasPendingWrites}}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this.ot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.ot.docs.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;w("QuerySnapshot.forEach",arguments,1,2),T("QuerySnapshot.forEach","function",1,t),this.ot.docs.forEach(function(r){t.call(e,n.convertToDocumentImpl(r))})},Object.defineProperty(t.prototype,"query",{get:function(){return new Oi(this.it,this.q)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"docChanges",{get:function(){return this._cachedChanges||(this._cachedChanges=xt(this.q,this.ot)),this._cachedChanges},enumerable:!0,configurable:!0}),t.prototype.convertToDocumentImpl=function(t){return new Ri(this.q,t.key,t,this.metadata.fromCache)},t}(),_i=function(t){function e(e,n){var r=t.call(this,Pe.atPath(e),n)||this;if(e.length%2!=1)throw new Ht(Wt.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.canonicalString()+" has "+e.length);return r}return Ii(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.rt.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.rt.path.popLast();return t.isEmpty()?null:new ki(new ae(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.rt.path.canonicalString()},enumerable:!0,configurable:!0}),e.prototype.doc=function(t){if(w("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=zt.newId()),T("CollectionReference.doc","string",1,t),""===t)throw new Ht(Wt.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=re.fromString(t);return ki.forPath(this.rt.path.child(e),this.firestore)},e.prototype.add=function(t){v("CollectionReference.add",arguments,1),T("CollectionReference.add","object",1,t);var e=this.doc();return e.set(t).then(function(){return e})},e}(Oi),Pi=l(Ci,"Use firebase.firestore() instead."),Li=l(Di,"Use firebase.firestore().runTransaction() instead."),xi=l(Ai,"Use firebase.firestore().batch() instead."),Bi=l(ki,"Use firebase.firestore().doc() instead."),Ui=l(Ri),Fi=l(Oi),Vi=l(Mi),qi=l(_i,"Use firebase.firestore().collection() instead."),ji={Firestore:Pi,GeoPoint:Jt,Blob:Yt,Transaction:Li,WriteBatch:xi,DocumentReference:Bi,DocumentSnapshot:Ui,Query:Fi,QuerySnapshot:Vi,CollectionReference:qi,FieldPath:Pn,FieldValue:di,setLogLevel:Ci.setLogLevel};e.registerFirestore=Ft,Ft(qt.default)},115:function(module,exports,__webpack_require__){(function(){function l(t){return"string"==typeof t}function aa(){}function ba(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function n(t){return"array"==ba(t)}function ca(t){var e=ba(t);return"array"==e||"object"==e&&"number"==typeof t.length}function da(t){return"function"==ba(t)}function p(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function fa(t,e,n){return t.call.apply(t.bind,arguments)}function ha(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function r(t,e,n){return r=Function.prototype.bind&&-1!=(""+Function.prototype.bind).indexOf("native code")?fa:ha,r.apply(null,arguments)}function ia(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function u(t,e){function n(){}n.prototype=e.prototype,t.L=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Bb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function ja(t){if(Error.captureStackTrace)Error.captureStackTrace(this,ja);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=t+"")}function ka(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function ma(t,e){return t<e?-1:t>e?1:0}function na(t,e){e.unshift(t),ja.call(this,ka.apply(null,e)),e.shift()}function oa(t,e){throw new na("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function w(){0!=qa&&(ra[this[q]||(this[q]=++ea)]=this),this.i=this.i,this.v=this.v}function ua(t){t:{for(var e=va,n=t.length,r=l(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:l(t)?t.charAt(e):t[e]}function wa(t){if(!n(t))for(var e=t.length-1;0<=e;e--)delete t[e];t.length=0}function xa(t){return Array.prototype.concat.apply([],arguments)}function ya(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function y(t){return-1!=x.indexOf(t)}function Ba(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Ca(t){var e,n=[],r=0;for(e in t)n[r++]=t[e];return n}function Da(t){var e,n=[],r=0;for(e in t)n[r++]=e;return n}function Ea(t){var e,n={};for(e in t)n[e]=t[e];return n}function Ga(t,e){for(var n,r,i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(var o=0;o<Fa.length;o++)n=Fa[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Ha(t){return Ha[" "](t),t}function Ia(t,e){var n=Ja;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}function Oa(){var t=k.document;return t?t.documentMode:void 0}function Ua(t){return Ia(t,function(){for(var e=0,n=la(Pa+"").split("."),r=la(t+"").split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=ma(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||ma(0==a[2].length,0==s[2].length)||ma(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e})}function A(t,e){this.type=t,this.a=this.target=e,this.Qa=!0}function ab(t,e){if(A.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(Ma){t:{try{Ha(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,null===r?(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0):(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=l(t.pointerType)?t.pointerType:bb[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}function db(t){return!(!t||!t[cb])}function fb(t,e,n,r,i){this.listener=t,this.a=null,this.src=e,this.type=n,this.capture=!!r,this.da=i,this.key=++eb,this.X=this.ba=!1}function gb(t){t.X=!0,t.listener=null,t.a=null,t.src=null,t.da=null}function hb(t){this.src=t,this.a={},this.b=0}function ib(t,e,n,r,i,o){var a=""+e;(e=t.a[a])||(e=t.a[a]=[],t.b++);var s=jb(e,n,i,o);return-1<s?(t=e[s],r||(t.ba=!1)):(t=new fb(n,t.src,a,!!i,o),t.ba=r,e.push(t)),t}function kb(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=sa(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(gb(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function lb(t,e,n,r,i){return t=t.a[""+e],e=-1,t&&(e=jb(t,n,r,i)),-1<e?t[e]:null}function jb(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.X&&o.listener==e&&o.capture==!!n&&o.da==r)return i}return-1}function pb(t,e,r,i,o){if(i&&i.once)return qb(t,e,r,i,o);if(n(e)){for(var a=0;a<e.length;a++)pb(t,e[a],r,i,o);return null}return r=rb(r),db(t)?t.$(e,r,p(i)?!!i.capture:!!i,o):sb(t,e,r,!1,i,o)}function sb(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=p(i)?!!i.capture:!!i,s=tb(t);if(s||(t[mb]=s=new hb(t)),n=ib(s,e,n,r,a,o),n.a)return n;if(r=ub(),n.a=r,r.src=t,r.listener=n,t.addEventListener)$a||(i=a),void 0===i&&(i=!1),t.addEventListener(""+e,r,i);else{if(!t.attachEvent)throw Error("addEventListener and attachEvent are unavailable.");t.attachEvent(vb(""+e),r)}return ob++,n}function ub(){var t=wb,e=Ya?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}function qb(t,e,r,i,o){if(n(e)){for(var a=0;a<e.length;a++)qb(t,e[a],r,i,o);return null}return r=rb(r),db(t)?t.Ia(e,r,p(i)?!!i.capture:!!i,o):sb(t,e,r,!0,i,o)}function xb(t,e,r,i,o){if(n(e))for(var a=0;a<e.length;a++)xb(t,e[a],r,i,o);else i=p(i)?!!i.capture:!!i,r=rb(r),db(t)?t.xa(e,r,i,o):t&&(t=tb(t))&&(e=lb(t,e,r,i,o))&&yb(e)}function yb(t){if("number"!=typeof t&&t&&!t.X){var e=t.src;if(db(e))kb(e.c,t);else{var n=t.type,r=t.a;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent&&e.detachEvent(vb(n),r),ob--,(n=tb(e))?(kb(n,t),0==n.b&&(n.src=null,e[mb]=null)):gb(t)}}}function vb(t){return t in nb?nb[t]:nb[t]="on"+t}function zb(t,e,n,r){var i=!0;if((t=tb(t))&&(e=t.a[""+e]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.X&&(o=Ab(o,r),i=i&&!1!==o)}return i}function Ab(t,e){var n=t.listener,r=t.da||t.src;return t.ba&&yb(t),n.call(r,e)}function wb(t,e){if(t.X)return!0;if(!Ya){if(!e)t:{e=["window","event"];for(var n=k,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(r=e,e=new ab(r,this),n=!0,!(0>r.keyCode||void 0!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){i=!0}(i||void 0==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.a;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.a=r[i];var o=zb(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.a=r[i],o=zb(r[i],t,!1,e),n=n&&o}return n}return Ab(t,new ab(e,this))}function tb(t){return t=t[mb],t instanceof hb?t:null}function rb(t){return da(t)?t:(t[Bb]||(t[Bb]=function(e){return t.handleEvent(e)}),t[Bb])}function B(){w.call(this),this.c=new hb(this),this.P=this,this.J=null}function Cb(t,e,n,r){if(!(e=t.c.a[e+""]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.X&&a.capture==n){var s=a.listener,u=a.da||a.src;a.ba&&kb(t.c,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Qa}function Db(t){return!/^\s*$/.test(t)&&/^[\],:{}\s\u2028\u2029]*$/.test(t.replace(/\\["\\\/bfnrtu]/g,"@").replace(/(?:"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)[\s\u2028\u2029]*(?=:|,|]|}|$)/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,""))}function Eb(a){if(a+="",Db(a))try{return eval("("+a+")")}catch(t){}throw Error("Invalid JSON string: "+a)}function Fb(t){var e=[];return Gb(new Hb,t,e),e.join("")}function Hb(){}function Gb(t,e,r){if(null==e)r.push("null");else{if("object"==typeof e){if(n(e)){var i=e;e=i.length,r.push("[");for(var o="",a=0;a<e;a++)r.push(o),Gb(t,i[a],r),o=",";return void r.push("]")}if(!(e instanceof String||e instanceof Number||e instanceof Boolean)){r.push("{"),o="";for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&"function"!=typeof(a=e[i])&&(r.push(o),Ib(i,r),r.push(":"),Gb(t,a,r),o=",");return void r.push("}")}e=e.valueOf()}switch(typeof e){case"string":Ib(e,r);break;case"number":r.push(isFinite(e)&&!isNaN(e)?e+"":"null");break;case"boolean":r.push(e+"");break;case"function":r.push("null");break;default:throw Error("Unknown type: "+typeof e)}}}function Ib(t,e){e.push('"',t.replace(Lb,function(t){var e=Jb[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),Jb[t]=e),e}),'"')}function Mb(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Ob(){var t=Pb,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Nb(){this.next=this.b=this.a=null}function Qb(t){k.setTimeout(function(){throw t},0)}function Sb(){var t=k.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!y("Presto")&&(t=function(){var t=document.createElement("IFRAME");t.style.display="none",t.src="",document.documentElement.appendChild(t);var e=t.contentWindow;t=e.document,t.open(),t.write(""),t.close();var n="callImmediate"+Math.random(),i="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=r(function(t){"*"!=i&&t.origin!=i||t.data!=n||this.port1.onmessage()},this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,i)}}}),void 0!==t&&!y("Trident")&&!y("MSIE")){var e=new t,n={},i=n;return e.port1.onmessage=function(){if(void 0!==n.next){n=n.next;var t=n.Ca;n.Ca=null,t()}},function(t){i.next={Ca:t},i=i.next,e.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){k.setTimeout(t,0)}}function Ub(){if(-1!=(k.Promise+"").indexOf("[native code]")){var t=k.Promise.resolve(void 0);Tb=function(){t.then(Vb)}}else Tb=function(){var t=Vb;!da(k.setImmediate)||k.Window&&k.Window.prototype&&!y("Edge")&&k.Window.prototype.setImmediate==k.setImmediate?(Rb||(Rb=Sb()),Rb(t)):k.setImmediate(t)}}function Vb(){for(var t;t=Ob();){try{t.a.call(t.b)}catch(t){Qb(t)}C.g(t),C.b<C.f&&(C.b++,t.next=C.a,C.a=t)}Wb=!1}function Xb(e,n){B.call(this),this.b=e||1,this.a=n||k,this.f=r(this.jb,this),this.g=t()}function Yb(t){t.Z=!1,t.K&&(t.a.clearTimeout(t.K),t.K=null)}function Zb(t,e,n){if(da(t))n&&(t=r(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=r(t.handleEvent,t)}return 2147483647<+e?-1:k.setTimeout(t,e||0)}function $b(t,e,n){w.call(this),this.f=null!=n?r(t,n):t,this.c=e,this.b=r(this.cb,this),this.a=[]}function ac(t){t.W=Zb(t.b,t.c),t.f.apply(null,t.a)}function D(t){w.call(this),this.b=t,this.a={}}function cc(t){Ba(t.a,function(t,e){this.a.hasOwnProperty(e)&&yb(t)},t),t.a={}}function dc(t,e,n,r,i){this.reset(t,e,n,r,i)}function fc(t){this.f=t,this.b=this.c=this.a=null}function E(t,e){this.name=t,this.value=e}function lc(t){return t.c?t.c:t.a?lc(t.a):(oa("Root logger has no level set."),null)}function F(t,e){t.log(gc,e,void 0)}function G(t,e){t.log(hc,e,void 0)}function oc(t){nc||(nc=new fc(""),mc[""]=nc,nc.c=jc);var e;if(!(e=mc[t])){e=new fc(t);var n=t.lastIndexOf("."),r=t.substr(n+1);n=oc(t.substr(0,n)),n.b||(n.b={}),n.b[r]=e,e.a=n,mc[t]=e}return e}function pc(t,e){t&&t.log(ic,e,void 0)}function H(t,e){t&&t.log(kc,e,void 0)}function qc(){this.a=oc("goog.labs.net.webChannel.WebChannelDebug")}function rc(t,e,r,i){if(r)try{var o=JSON.parse(r);if(o)for(var a=0;a<o.length;a++)if(n(o[a])){var s=o[a];if(!(2>s.length)){var u=s[1];if(n(u)&&!(1>u.length)){var c=u[0];if("noop"!=c&&"stop"!=c&&"close"!=c)for(var h=1;h<u.length;h++)u[h]=""}}}var l=Fb(o)}catch(e){I(t,"Exception parsing expected JS array - probably was not JS"),l=r}else l=null;I(t,"XMLHTTP TEXT ("+e+"): "+l+(i?" "+i:""))}function sc(t,e,n){(t=t.a)&&F(t,(n||"Exception")+e)}function I(t,e){pc(t.a,e)}function tc(t){A.call(this,"serverreachability",t)}function uc(){J.dispatchEvent(new tc(J))}function vc(t){A.call(this,"statevent",t)}function K(){J.dispatchEvent(new vc(J))}function wc(t){A.call(this,"timingevent",t)}function xc(t,e){if(!da(t))throw Error("Fn must not be null and must be a function");return k.setTimeout(function(){t()},e)}function Ac(){}function Bc(t){var e;return(e=t.a)||(e={},Cc(t)&&(e[0]=!0,e[1]=!0),e=t.a=e),e}function Ec(){}function Fc(t){return(t=Cc(t))?new ActiveXObject(t):new XMLHttpRequest}function Cc(t){if(!t.b&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<4;n++){var r=e[n];try{return new ActiveXObject(r),t.b=r}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.b}function L(t,e,n,r,i){this.m=t,this.b=e,this.f=r,this.S=i||1,this.M=new D(this),this.P=Gc,t=this.F=new Xb,t.b=Hc,t.K&&t.Z?(Yb(t),t.start()):t.K&&Yb(t),this.h=null,this.c=!1,this.a=this.B=this.g=this.l=this.I=this.H=this.T=this.o=null,this.C=0,this.i=this.j=null,this.v=-1,this.s=!1,this.N=0,this.G=null,this.J=!1}function Ic(t,e){switch(t){case 0:return"Non-200 return code ("+e+")";case 1:return"XMLHTTP failure (no data)";case 2:return"HttpConnection timeout";default:return"Unknown error"}}function Lc(t,e,n){t.I=1,t.l=Mc(M(e)),t.B=n,t.J=!0,Nc(t,null)}function Oc(t,e,n,r){t.I=1,t.l=Mc(M(e)),t.B=null,t.J=n,Nc(t,r)}function Nc(e,n){e.H=t(),Pc(e),e.g=M(e.l),Qc(e.g,"t",e.S),e.C=0,e.a=e.m.ra(e.m.fa()?n:null),0<e.N&&(e.G=new $b(r(e.Ra,e,e.a),e.N)),e.M.$(e.a,"readystatechange",e.gb),n=e.h?Ea(e.h):{},e.B?(e.j||(e.j="POST"),n["Content-Type"]="application/x-www-form-urlencoded",e.a.ta(e.g,e.j,e.B,n)):(e.j="GET",e.a.ta(e.g,e.j,null,n)),uc();var i=e.B;if(i){n="",i=i.split("&");for(var o=0;o<i.length;o++){var a=i[o].split("=");if(1<a.length){var s=a[0];a=a[1];var u=s.split("_");n=2<=u.length&&"type"==u[1]?n+(s+"=")+a+"&":n+(s+"=redacted&")}}}else n=null;I(e.b,"XMLHTTP REQ ("+e.f+") [attempt "+e.S+"]: "+e.j+"\n"+e.g+"\n"+n)}function Sc(t,e,n){for(var r=!0;!t.s&&t.C<n.length;){var i=Wc(t,n);if(i==Kc){4==e&&(t.i=4,K(),r=!1),rc(t.b,t.f,null,"[Incomplete Response]");break}if(i==Jc){t.i=4,K(),rc(t.b,t.f,n,"[Invalid Chunk]"),r=!1;break}rc(t.b,t.f,i,null),Tc(t,i)}4==e&&0==n.length&&(t.i=1,K(),r=!1),t.c=t.c&&r,r||(rc(t.b,t.f,n,"[Invalid Chunked Response]"),Uc(t),Vc(t))}function Wc(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?Kc:(n=+e.substring(n,r),isNaN(n)?Jc:(r+=1)+n>e.length?Kc:(e=e.substr(r,n),t.C=r+n,e))}function Pc(e){e.T=t()+e.P,Xc(e,e.P)}function Xc(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=xc(r(t.eb,t),e)}function Rc(t){t.o&&(k.clearTimeout(t.o),t.o=null)}function Vc(t){t.m.Ka()||t.s||t.m.wa(t)}function Uc(t){Rc(t);var e=t.G;e&&"function"==typeof e.Y&&e.Y(),t.G=null,Yb(t.F),cc(t.M),t.a&&(e=t.a,t.a=null,e.abort(),e.Y())}function Tc(t,e){try{t.m.Na(t,e),uc()}catch(e){sc(t.b,e,"Error in httprequest callback")}}function Yc(t){if(t.A&&"function"==typeof t.A)return t.A();if(l(t))return t.split("");if(ca(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}return Ca(t)}function Zc(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(ca(t)||l(t))ta(t,e,void 0);else{if(t.O&&"function"==typeof t.O)var n=t.O();else if(t.A&&"function"==typeof t.A)n=void 0;else if(ca(t)||l(t)){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else n=Da(t);r=Yc(t),i=r.length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function O(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t){t instanceof O?(n=t.O(),r=t.A()):(n=Da(t),r=Ca(t));for(var i=0;i<n.length;i++)this.set(n[i],r[i])}}function ad(t){t.b={},t.a.length=0,t.c=0}function bd(t,e){return!!P(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&$c(t),!0)}function $c(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];P(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)r=t.a[e],P(i,r)||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function P(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function dd(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Q(t,e){this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1;var n;t instanceof Q?(this.h=void 0!==e?e:t.h,ed(this,t.f),this.j=t.j,fd(this,t.b),gd(this,t.i),this.a=t.a,hd(this,id(t.c)),this.g=t.g):t&&(n=(t+"").match(cd))?(this.h=!!e,ed(this,n[1]||"",!0),this.j=jd(n[2]||""),fd(this,n[3]||"",!0),gd(this,n[4]),this.a=jd(n[5]||"",!0),hd(this,n[6]||"",!0),this.g=jd(n[7]||"")):(this.h=!!e,this.c=new kd(null,0,this.h))}function M(t){return new Q(t)}function ed(t,e,n){t.f=n?jd(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function fd(t,e,n){t.b=n?jd(e,!0):e}function gd(t,e){if(e){if(e=+e,isNaN(e)||0>e)throw Error("Bad port number "+e);t.i=e}else t.i=null}function hd(t,e,n){e instanceof kd?(t.c=e,qd(t.c,t.h)):(n||(e=ld(e,rd)),t.c=new kd(e,0,t.h))}function R(t,e,n){t.c.set(e,n)}function Qc(t,e,r){n(r)||(r=[r+""]),sd(t.c,e,r)}function Mc(e){return R(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^t()).toString(36)),e}function td(t){return t instanceof Q?M(t):new Q(t,void 0)}function ud(t,e,n,r){var i=new Q(null,void 0);return t&&ed(i,t),e&&fd(i,e),n&&gd(i,n),r&&(i.a=r),i}function jd(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ld(t,e,n){return l(t)?(t=encodeURI(t).replace(e,vd),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function vd(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(15&t).toString(16)}function kd(t,e,n){this.b=this.a=null,this.c=t||null,this.f=!!n}function S(t){t.a||(t.a=new O,t.b=0,t.c&&dd(t.c,function(e,n){e=decodeURIComponent(e.replace(/\+/g," ")),S(t),t.c=null,e=wd(t,e);var r=t.a.get(e);r||t.a.set(e,r=[]),r.push(n),t.b+=1}))}function xd(t,e){S(t),e=wd(t,e),P(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,bd(t.a,e))}function yd(t,e){return S(t),e=wd(t,e),P(t.a.b,e)}function sd(t,e,n){xd(t,e),0<n.length&&(t.c=null,t.a.set(wd(t,e),ya(n)),t.b+=n.length)}function id(t){var e=new kd;return e.c=t.c,t.a&&(e.a=new O(t.a),e.b=t.b),e}function wd(t,e){return e+="",t.f&&(e=e.toLowerCase()),e}function qd(t,e){e&&!t.f&&(S(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(xd(this,e),sd(this,n,t))},t)),t.f=e}function zd(){this.a=t()}function Bd(){Ad||(Ad=new zd)}function Cd(){Ad||(Ad=new zd)}function Dd(){}function Fd(){A.call(this,"d")}function Gd(){A.call(this,"c")}function Hd(t,e){this.a=t,this.b=e,this.c=this.i=null,this.h=!1,this.l=null,this.f=-1,this.m=this.g=null}function Id(t){I(t.b,"TestConnection: starting stage 2");var e=t.a.J.a;if(null!=e)I(t.b,"Buffered"),K(),e?(K(),Jd(t.a,t,!1)):(K(),Jd(t.a,t,!0));else{t.c=new L(t,t.b,0,void 0,void 0),t.c.h=t.i,e=Kd(t.a,t.g,t.l),K(),Qc(e,"TYPE","xmlhttp");var n=t.a.j,r=t.a.N;n&&r&&R(e,n,r),Oc(t.c,e,!1,t.g)}}function Md(){this.a=this.b=null}function Nd(t){if(this.a=new O,t){t=Yc(t);for(var e=t.length,n=0;n<e;n++){var r=t[n];this.a.set(T(r),r)}}}function T(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[q]||(t[q]=++ea)):e.charAt(0)+t}function Od(t){this.f=t||Pd,this.c=k.pa&&k.pa.La&&k.pa.La()&&k.pa.La().Cb?this.f:1,this.a=null,1<this.c&&(this.a=new Nd),this.b=null}function Qd(t,e){t.a||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(t.c=t.f,t.a=new Nd,t.b&&(Rd(t,t.b),t.b=null))}function Sd(t){return!!t.b||!!t.a&&t.a.u()>=t.c}function Td(t,e){return t.b?t.b==e:!!t.a&&t.a.contains(e)}function Rd(t,e){t.a?t.a.a.set(T(e),e):t.b=e}function Ud(t,e){this.a=t,this.b=e}function Vd(t,e){this.a=t,this.b=e}function Wd(){this.a=new Vd}function Xd(t,e,n){var r=n||"";try{Zc(t,function(t,n){var i=t;p(t)&&(i=Fb(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function Yd(t,e){var n=new qc;I(n,"TestLoadImage: loading "+t);var r=new Image;r.onload=ia(Zd,n,r,"TestLoadImage: loaded",!0,e),r.onerror=ia(Zd,n,r,"TestLoadImage: error",!1,e),r.onabort=ia(Zd,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=ia(Zd,n,r,"TestLoadImage: timeout",!1,e),k.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}function Zd(t,e,n,r,i){try{I(t,n),e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(e){sc(t,e)}}function U(t){B.call(this),this.headers=new O,this.G=t||null,this.f=!1,this.F=this.a=null,this.M=this.s="",this.j=0,this.g="",this.h=this.I=this.o=this.H=!1,this.l=0,this.B=null,this.N=$d,this.C=this.m=!1}function ee(t){return z&&Ua(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}function va(t){return"content-type"==t.toLowerCase()}function ce(t,e){t.f=!1,t.a&&(t.h=!0,t.a.abort(),t.h=!1),t.g=e,t.j=5,fe(t),ge(t)}function fe(t){t.H||(t.H=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function he(t){if(t.f&&void 0!==goog)if(t.F[1]&&4==N(t)&&2==t.V())H(t.b,V(t,"Local request error detected and ignored"));else if(t.o&&4==N(t))Zb(t.Ma,0,t);else if(t.dispatchEvent("readystatechange"),4==N(t)){H(t.b,V(t,"Request complete")),t.f=!1;try{var e=t.V();t:switch(e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var n=!0;break t;default:n=!1}var r;if(!(r=n)){var i;if(i=0===e){var o=(t.s+"").match(cd)[1]||null;if(!o&&k.self&&k.self.location){var a=k.self.location.protocol;o=a.substr(0,a.length-1)}i=!ae.test(o?o.toLowerCase():"")}r=i}r?(t.dispatchEvent("complete"),t.dispatchEvent("success")):(t.j=6,t.g=t.Ha()+" ["+t.V()+"]",fe(t))}finally{ge(t)}}}function ge(t,e){if(t.a){de(t);var n=t.a,r=t.F[0]?aa:null;t.a=null,t.F=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(e){(t=t.b)&&F(t,"Problem encountered resetting onreadystatechange: "+e.message)}}}function de(t){t.a&&t.C&&(t.a.ontimeout=null),"number"==typeof t.B&&(k.clearTimeout(t.B),t.B=null)}function N(t){return t.a?t.a.readyState:0}function V(t,e){return e+" ["+t.M+" "+t.s+" "+t.V()+"]"}function ie(t){var e="";return Ba(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}function je(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}if(r)return t;if(n=ie(n),l(t)){if(e=encodeURIComponent(e+""),n=null!=n?"="+encodeURIComponent(n+""):"",e+=n){if(n=t.indexOf("#"),0>n&&(n=t.length),0>(r=t.indexOf("?"))||r>n){r=n;var i=""}else i=t.substring(r+1,n);t=[t.substr(0,r),i,t.substr(n)],n=t[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return R(t,e,n),t}function ke(t,e,n){this.za=e||0,this.Ba=0,this.h=[],this.l=[],this.a=new qc,this.J=n||new Md,this.ia=this.ya=this.H=this.ja=this.b=this.N=this.j=this.ha=this.f=this.P=this.i=null,this.Va=this.I=0,this.ka=this.C=this.s=this.m=this.o=this.c=null,this.v=this.Aa=this.S=-1,this.ga=this.B=this.G=0,this.T=t&&t.supportsCrossDomainXhr||!1,this.M="",this.g=new Od(t&&t.concurrentRequestLimit),this.la=new Wd,this.F=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,this.Ua=t&&t.fastHandshake||!1}function le(e){if(I(e.a,"disconnect()"),me(e),3==e.D){var n=e.I++,r=M(e.H);R(r,"SID",e.M),R(r,"RID",n),R(r,"TYPE","terminate"),ne(e,r),n=new L(e,e.a,0,n,void 0),n.I=2,n.l=Mc(M(r)),r=!1,k.navigator&&k.navigator.sendBeacon&&(r=k.navigator.sendBeacon(""+n.l,"")),r||((new Image).src=n.l),n.H=t(),Pc(n)}oe(e)}function me(t){t.C&&(t.C.abort(),t.C=null),t.b&&(t.b.cancel(),t.b=null),t.m&&(k.clearTimeout(t.m),t.m=null),pe(t),t.g.cancel(),t.o&&(k.clearTimeout(t.o),t.o=null)}function qe(t,e){if(1e3==t.h.length){var n="Already have 1000 queued maps upon queueing "+Fb(e),r=t.a.a;r&&F(r,n)}t.h.push(new Ud(t.Va++,e)),3==t.D&&re(t)}function re(t){Sd(t.g)||t.o||(t.o=xc(r(t.Pa,t),0),t.G=0)}function te(t,e){if(e){t.h=t.l.concat(t.h),t.l.length=0;var n=t.I-1}else n=t.I++;e=se(t);var r=M(t.H);R(r,"SID",t.M),R(r,"RID",n),R(r,"AID",t.S),ne(t,r),t.f&&t.i&&je(r,t.f,t.i),n=new L(t,t.a,0,n,t.G+1),null===t.f&&(n.h=t.i),n.setTimeout(Math.round(1e4)+Math.round(1e4*Math.random())),Rd(t.g,n),Lc(n,r,e)}function ne(t,e){t.c&&Zc({},function(t,n){R(e,n,t)})}function se(t){var e=Math.min(t.h.length,1e3),n=t.c?r(t.c.Wa,t.c,t):null,i=t.h,o=["count="+e];if(0<e){var a=i[0].a;o.push("ofs="+a)}else a=0;for(var s=0;s<e;s++){var u=i[s].a,c=i[s].b;u-=a;try{Xd(c,o,"req"+u+"_")}catch(t){n&&n(c)}}return n=o.join("&"),t.l=t.l.concat(t.h.splice(0,e)),n}function ue(t){if(!t.b&&!t.m){t.ga=1;var e=t.Oa;Tb||Ub(),Wb||(Tb(),Wb=!0);var n=Pb,r=C.get();r.set(e,t),n.b?n.b.next=r:n.a=r,n.b=r,t.B=0}}function ve(t){return t.b||t.m?((t=t.a.a)&&F(t,"Request already in progress"),!1):!(3<=t.B||(I(t.a,"Going to retry GET"),t.ga++,t.m=xc(r(t.Oa,t),we(t,t.B)),t.B++,0))}function Jd(t,e,n){I(t.a,"Test Connection Finished");var r=e.m;r&&Qd(t.g,r),t.ka=n,t.v=e.f,I(t.a,"connectChannel_()"),t.H=xe(t,t.ja),re(t)}function Ld(t,e){I(t.a,"Test Connection Failed"),t.v=e.f,W(t,2)}function pe(t){null!=t.s&&(k.clearTimeout(t.s),t.s=null)}function we(t,e){var n=5e3+Math.floor(1e4*Math.random());return t.sa()||(I(t.a,"Inactive channel"),n*=2),n*e}function W(t,e){if(I(t.a,"Error code "+e),2==e){var n=null;t.c&&(n=null);var i=r(t.ib,t);n||(n=new Q("//www.google.com/images/cleardot.gif"),k.location&&"http"==k.location.protocol||ed(n,"https"),Mc(n)),Yd(""+n,i)}else K();I(t.a,"HttpChannel: error - "+e),t.D=0,t.c&&t.c.Da(t,e),oe(t),me(t)}function oe(t){if(t.D=0,t.v=-1,t.c)if(0==t.l.length&&0==t.h.length)t.c.na(t);else{I(t.a,"Number of undelivered maps, pending: "+t.l.length+", outgoing: "+t.h.length);var e=ya(t.l),n=ya(t.h);t.l.length=0,t.h.length=0,t.c.na(t,e,n)}}function xe(t,e){return e=ye(t,null,e),I(t.a,"GetForwardChannelUri: "+e),e}function Kd(t,e,n){return e=ye(t,t.fa()?e:null,n),I(t.a,"GetBackChannelUri: "+e),e}function ye(t,e,n){var r=td(n);if(""!=r.b)e&&fd(r,e+"."+r.b),gd(r,r.i);else{var i,o=k.location;i=e?e+"."+o.hostname:o.hostname,r=ud(o.protocol,i,o.port,n)}return t.ha&&Ba(t.ha,function(t,e){R(r,e,t)}),e=t.j,n=t.N,e&&n&&R(r,e,n),R(r,"VER",t.oa),ne(t,r),r}function ze(){}function Ae(t){for(var e=arguments[0],n=1;n<arguments.length;n++){var r=arguments[n];if(0==r.lastIndexOf("/",0))e=r;else{var i;(i=""==e)||(i=e.length-1,i=0<=i&&e.indexOf("/",i)==i),e+=i?r:"/"+r}}return e}function Be(){if(z&&!(10<=+Va))throw Error("Environmental error: no available transport.")}function X(t,e){B.call(this),this.a=new ke(e,20),this.b=t,this.s=e&&e.testUrl?e.testUrl:Ae(this.b,"test"),this.f=oc("goog.labs.net.webChannel.WebChannelBaseTransport"),this.g=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,this.a.P=e&&e.initMessageHeaders||null,(t=e&&e.httpHeadersOverwriteParam)&&!/^[\s\xa0]*$/.test(t)&&(this.a.f=t),this.o=e&&e.supportsCrossDomainXhr||!1,this.m=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!/^[\s\xa0]*$/.test(e)&&(this.a.j=e,null!==(t=this.g)&&e in t&&(t=this.g,e in t&&delete t[e],(t=this.f)&&G(t,"Ignore httpSessionIdParam also specified with messageUrlParams: "+e))),this.h=new Ce(this)}function De(t){Fd.call(this),this.data=t}function Ee(){Gd.call(this),this.status=1}function Ce(t){this.a=t}function Ge(){this.b=[],this.a=[]}function He(t){return 0==t.b.length&&(t.b=t.a,t.b.reverse(),t.a=[]),t.b.pop()}function Ie(t,e){if(w.call(this),this.h=t||0,this.c=e||10,this.h>this.c)throw Error(Je);this.a=new Ge,this.b=new Nd,this.g=null,this.aa()}function Ke(t){if("function"==typeof t.Y)t.Y();else for(var e in t)t[e]=null}function Le(t,e){this.a=t,this.b=e}function Me(t){if(this.a=[],t)t:{if(t instanceof Me){var e=t.O();if(t=t.A(),0>=this.u()){for(var n=this.a,r=0;r<e.length;r++)n.push(new Le(e[r],t[r]));break t}}else e=Da(t),t=Ca(t);for(r=0;r<e.length;r++)Ne(this,e[r],t[r])}}function Ne(t,e,n){var r=t.a;for(r.push(new Le(e,n)),e=r.length-1,t=t.a,n=t[e];0<e&&(r=e-1>>1,t[r].a>n.a);)t[e]=t[r],e=r;t[e]=n}function Oe(){Me.call(this)}function Y(t,e){this.f=new Oe,Ie.call(this,t,e)}function Z(t,e,n,r){this.l=t,this.j=!!r,Y.call(this,e,n)}var g,goog=goog||{},k=this,q="closure_uid_"+(1e9*Math.random()>>>0),ea=0,t=Date.now||function(){return+new Date};u(ja,Error),ja.prototype.name="CustomError";var la=String.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};u(na,ja),na.prototype.name="AssertionError";var qa=0,ra={};w.prototype.i=!1,w.prototype.Y=function(){if(!this.i&&(this.i=!0,this.w(),0!=qa)){var t=this[q]||(this[q]=++ea);delete ra[t]}},w.prototype.w=function(){if(this.v)for(;this.v.length;)this.v.shift()()};var sa=Array.prototype.indexOf?function(t,e,n){return Array.prototype.indexOf.call(t,e,n)}:function(t,e,n){if(n=null==n?0:0>n?Math.max(0,t.length+n):n,l(t))return l(e)&&1==e.length?t.indexOf(e,n):-1;for(;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},ta=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=l(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)},x;t:{var za=k.navigator;if(za){var Aa=za.userAgent;if(Aa){x=Aa;break t}}x=""}var Fa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");Ha[" "]=aa;var Ka=y("Opera"),z=y("Trident")||y("MSIE"),La=y("Edge"),Ma=y("Gecko")&&!(-1!=x.toLowerCase().indexOf("webkit")&&!y("Edge"))&&!(y("Trident")||y("MSIE"))&&!y("Edge"),Na=-1!=x.toLowerCase().indexOf("webkit")&&!y("Edge"),Pa;t:{var Qa="",Sa=function(){var t=x;return Ma?/rv\:([^\);]+)(\)|;)/.exec(t):La?/Edge\/([\d\.]+)/.exec(t):z?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):Na?/WebKit\/(\S+)/.exec(t):Ka?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(Sa&&(Qa=Sa?Sa[1]:""),z){var Ta=Oa();if(null!=Ta&&Ta>parseFloat(Qa)){Pa=Ta+"";break t}}Pa=Qa}var Ja={},Va,Wa=k.document;Va=Wa&&z?Oa()||("CSS1Compat"==Wa.compatMode?parseInt(Pa,10):5):void 0;var Xa=Object.freeze||function(t){return t},Ya=!z||9<=+Va,Za=z&&!Ua("9"),$a=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});return k.addEventListener("test",aa,e),k.removeEventListener("test",aa,e),t}();A.prototype.b=function(){this.Qa=!1},u(ab,A);var bb=Xa({2:"touch",3:"pen",4:"mouse"});ab.prototype.b=function(){ab.L.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Za)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var cb="closure_listenable_"+(1e6*Math.random()|0),eb=0,mb="closure_lm_"+(1e6*Math.random()|0),nb={},ob=0,Bb="__closure_events_fn_"+(1e9*Math.random()>>>0);u(B,w),B.prototype[cb]=!0,g=B.prototype,g.addEventListener=function(t,e,n,r){pb(this,t,e,n,r)},g.removeEventListener=function(t,e,n,r){xb(this,t,e,n,r)},g.dispatchEvent=function(t){var e,n=this.J;if(n)for(e=[];n;n=n.J)e.push(n);n=this.P;var r=t.type||t;if(l(t))t=new A(t,n);else if(t instanceof A)t.target=t.target||n;else{var i=t;t=new A(r,n),Ga(t,i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.a=e[o];i=Cb(a,r,!0,t)&&i}if(a=t.a=n,i=Cb(a,r,!0,t)&&i,i=Cb(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)a=t.a=e[o],i=Cb(a,r,!1,t)&&i;return i},g.w=function(){if(B.L.w.call(this),this.c){var t,e=this.c,n=0;for(t in e.a){for(var r=e.a[t],i=0;i<r.length;i++)++n,gb(r[i]);delete e.a[t],e.b--}}this.J=null},g.$=function(t,e,n,r){return ib(this.c,t+"",e,!1,n,r)},g.Ia=function(t,e,n,r){return ib(this.c,t+"",e,!0,n,r)},g.xa=function(t,e,n,r){var i=this.c;if((t+="")in i.a){var o=i.a[t];e=jb(o,e,n,r),-1<e?(gb(o[e]),Array.prototype.splice.call(o,e,1),0==o.length&&(delete i.a[t],i.b--),i=!0):i=!1}else i=!1;return i};var Jb={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Lb=/\uffff/.test("")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;Mb.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var C=new Mb(function(){return new Nb},function(t){t.reset()},100);Nb.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Nb.prototype.reset=function(){this.next=this.b=this.a=null};var Rb,Tb,Wb=!1,Pb=new function(){this.b=this.a=null};u(Xb,B),g=Xb.prototype,g.Z=!1,g.K=null,g.jb=function(){if(this.Z){var e=t()-this.g;0<e&&e<.8*this.b?this.K=this.a.setTimeout(this.f,this.b-e):(this.K&&(this.a.clearTimeout(this.K),this.K=null),this.dispatchEvent("tick"),this.Z&&(this.K=this.a.setTimeout(this.f,this.b),this.g=t()))}},g.start=function(){this.Z=!0,this.K||(this.K=this.a.setTimeout(this.f,this.b),this.g=t())},g.w=function(){Xb.L.w.call(this),Yb(this),delete this.a},u($b,w),g=$b.prototype,g.ea=!1,g.W=null,g.Ya=function(t){this.a=arguments,this.W?this.ea=!0:ac(this)},g.w=function(){$b.L.w.call(this),this.W&&(k.clearTimeout(this.W),this.W=null,this.ea=!1,this.a=[])},g.cb=function(){this.W=null,this.ea&&(this.ea=!1,ac(this))},u(D,w);var bc=[];D.prototype.$=function(t,e,r,i){n(e)||(e&&(bc[0]=""+e),e=bc);for(var o=0;o<e.length;o++){var a=pb(t,e[o],r||this.handleEvent,i||!1,this.b||this);if(!a)break;this.a[a.key]=a}return this},D.prototype.xa=function(t,e,r,i,o){if(n(e))for(var a=0;a<e.length;a++)this.xa(t,e[a],r,i,o);else r=r||this.handleEvent,i=p(i)?!!i.capture:!!i,o=o||this.b||this,r=rb(r),i=!!i,(e=db(t)?lb(t.c,e+"",r,i,o):t&&(t=tb(t))?lb(t,e,r,i,o):null)&&(yb(e),delete this.a[e.key]);return this},D.prototype.w=function(){D.L.w.call(this),cc(this)},D.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},dc.prototype.a=null;var ec=0;dc.prototype.reset=function(e,n,r,i,o){"number"==typeof o||ec++,i||t(),this.b=n,delete this.a},E.prototype.toString=function(){return this.name};var gc=new E("SEVERE",1e3),hc=new E("WARNING",900),ic=new E("INFO",800),jc=new E("CONFIG",700),kc=new E("FINE",500);fc.prototype.log=function(t,e,n){if(t.value>=lc(this).value)for(da(e)&&(e=e()),t=new dc(t,e+"",this.f),n&&(t.a=n),n="log:"+t.b,(t=k.console)&&t.timeStamp&&t.timeStamp(n),(t=k.msWriteProfilerMark)&&t(n),n=this;n;)n=n.a};var mc={},nc=null,J=new B;u(tc,A),u(vc,A),u(wc,A);var yc={NO_ERROR:0,kb:1,rb:2,qb:3,nb:4,pb:5,sb:6,Sa:7,TIMEOUT:8,vb:9},zc={mb:"complete",zb:"success",Ta:"error",Sa:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",tb:"incrementaldata",wb:"progress",ob:"downloadprogress",Ab:"uploadprogress"};Ac.prototype.a=null;var Dc;u(Ec,Ac),Dc=new Ec;var Gc=45e3,Hc=250,Jc={},Kc={};g=L.prototype,g.setTimeout=function(t){this.P=t},g.gb=function(t){t=t.target;var e=this.G;e&&3==N(t)?(I(this.b,"Throttling readystatechange."),e.Ya()):this.Ra(t)},g.Ra=function(t){try{if(t==this.a){var e=N(this.a),n=this.a.Ga();if(!(3>e||3==e&&!Ka&&!this.a.U())){this.s||4!=e||7==n||uc(),Rc(this);var r=this.a.V();this.v=r;var i=this.a.U();if(i||I(this.b,"No response text for uri "+this.g+" status "+r),this.c=200==r,I(this.b,"XMLHTTP RESP ("+this.f+") [ attempt "+this.S+"]: "+this.j+"\n"+this.g+"\n"+e+" "+r),this.c)this.J?(Sc(this,e,i),Ka&&this.c&&3==e&&(this.M.$(this.F,"tick",this.fb),this.F.start())):(rc(this.b,this.f,i,null),Tc(this,i)),4==e&&Uc(this),this.c&&!this.s&&(4==e?this.m.wa(this):(this.c=!1,Pc(this)));else{if(400==r&&0<i.indexOf("Unknown SID")){this.i=3,K();var o=this.b.a;o&&G(o,"XMLHTTP Unknown SID ("+this.f+")")}else{this.i=0,K();var a=this.b.a;a&&G(a,"XMLHTTP Bad status "+r+" ("+this.f+")")}Uc(this),Vc(this)}}}else{var s=this.b.a;s&&G(s,"Called back with an unexpected xmlhttp")}}catch(t){I(this.b,"Failed call to OnXmlHttpReadyStateChanged_"),this.a&&this.a.U()?sc(this.b,t,"ResponseText: "+this.a.U()):sc(this.b,t,"No response text")}},g.fb=function(){var t=N(this.a),e=this.a.U();this.C<e.length&&(Rc(this),Sc(this,t,e),this.c&&4!=t&&Pc(this))},g.cancel=function(){this.s=!0,Uc(this)},g.eb=function(){this.o=null;var e=t();if(0<=e-this.T)this.c&&(e=this.b.a)&&F(e,"Received watchdog timeout even though request loaded successfully"),I(this.b,"TIMEOUT: "+this.g),2!=this.I&&(uc(),K()),Uc(this),this.i=2,Vc(this);else{var n=this.b.a;n&&G(n,"WatchDog timer called too early"),Xc(this,this.T-e)}},g=O.prototype,g.u=function(){return this.c},g.A=function(){$c(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},g.O=function(){return $c(this),this.a.concat()},g.get=function(t,e){return P(this.b,t)?this.b[t]:e},g.set=function(t,e){P(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},g.forEach=function(t,e){for(var n=this.O(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var cd=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;Q.prototype.toString=function(){var t=[],e=this.f;e&&t.push(ld(e,md,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(ld(e,md,!0),"@"),t.push(encodeURIComponent(n+"").replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",n+"")),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(ld(n,"/"==n.charAt(0)?nd:od,!0))),(n=""+this.c)&&t.push("?",n),(n=this.g)&&t.push("#",ld(n,pd)),t.join("")},Q.prototype.resolve=function(t){var e=M(this),n=!!t.f;n?ed(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?fd(e,t.b):n=null!=t.i;var r=t.a;if(n)gd(e,t.i);else if(n=!!t.a){if("/"!=r.charAt(0))if(this.b&&!this.a)r="/"+r;else{var i=e.a.lastIndexOf("/");-1!=i&&(r=e.a.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.a=r:n=""!=""+t.c,n?hd(e,id(t.c)):n=!!t.g,n&&(e.g=t.g),e};var md=/[#\/\?@]/g,od=/[\#\?:]/g,nd=/[\#\?]/g,rd=/[\#\?@]/g,pd=/#/g;g=kd.prototype,g.u=function(){return S(this),this.b},g.forEach=function(t,e){S(this),this.a.forEach(function(n,r){ta(n,function(n){t.call(e,n,r,this)},this)},this)},g.O=function(){S(this);for(var t=this.a.A(),e=this.a.O(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},g.A=function(t){S(this);var e=[];if(l(t))yd(this,t)&&(e=xa(e,this.a.get(wd(this,t))));else{t=this.a.A();for(var n=0;n<t.length;n++)e=xa(e,t[n])}return e},g.set=function(t,e){return S(this),this.c=null,t=wd(this,t),yd(this,t)&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},g.get=function(t,e){return t=t?this.A(t):[],0<t.length?t[0]+"":e},g.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.O(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(r+"");r=this.A(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(r[o]+"")),t.push(a)}}return this.c=t.join("&")};var Ad=null;zd.prototype.set=function(t){this.a=t},zd.prototype.reset=function(){this.set(t())},zd.prototype.get=function(){return this.a},u(Cd,Bd);var Ed={OPEN:"a",lb:"b",Ta:"c",ub:"d"};u(Fd,A),u(Gd,A),g=Hd.prototype,g.R=null,g.ra=function(t){return this.a.ra(t)},g.abort=function(){this.c&&(this.c.cancel(),this.c=null),this.f=-1},g.Ka=function(){return!1},g.Na=function(t,e){if(this.f=t.v,0==this.R){if(I(this.b,"TestConnection: Got data for stage 1"),!this.a.F&&(t=t.a)){var n=t.a?t.a.getResponseHeader("X-Client-Wire-Protocol"):null;this.m=n||null,this.a.j&&((t=t.a?t.a.getResponseHeader("X-HTTP-Session-Id"):null)?this.a.N=t:(t=this.b.a)&&G(t,"Missing X_HTTP_SESSION_ID in the handshake response"))}if(e){try{var r=this.a.la.a.parse(e)}catch(t){return sc(this.b,t),void Ld(this.a,this)}this.g=r[0]}else I(this.b,"TestConnection: Null responseText"),Ld(this.a,this)}else 1==this.R&&(this.h?K():"11111"==e?(K(),this.h=!0,(!z||10<=+Va)&&(this.f=200,this.c.cancel(),I(this.b,"Test connection succeeded; using streaming connection"),K(),Jd(this.a,this,!0))):(K(),this.h=!1))},g.wa=function(){this.f=this.c.v,this.c.c?0==this.R?(this.R=1,I(this.b,"TestConnection: request complete for initial check"),Id(this)):1==this.R&&(I(this.b,"TestConnection: request complete for stage 2"),this.h?(I(this.b,"Test connection succeeded; using streaming connection"),K(),Jd(this.a,this,!0)):(I(this.b,"Test connection failed; not using streaming"),K(),Jd(this.a,this,!1))):(I(this.b,"TestConnection: request failed, in state "+this.R),0==this.R?K():1==this.R&&K(),Ld(this.a,this))},g.fa=function(){return this.a.fa()},g.sa=function(){return this.a.sa()},Nd.prototype.u=function(){return this.a.u()},Nd.prototype.contains=function(t){return t=T(t),P(this.a.b,t)},Nd.prototype.A=function(){return this.a.A()};var Pd=10;Od.prototype.cancel=function(){this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(ta(this.a.A(),function(t){t.cancel()}),ad(this.a.a))},Vd.prototype.stringify=function(t){return k.JSON.stringify(t,this.a)},Vd.prototype.parse=function(t){return k.JSON.parse(t,this.b)},u(U,B);var $d="";U.prototype.b=oc("goog.net.XhrIo");var ae=/^https?$/i,be=["POST","PUT"];g=U.prototype,g.ta=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.s+"; newUri="+t);e=e?e.toUpperCase():"GET",this.s=t,this.g="",this.j=0,this.M=e,this.H=!1,this.f=!0,this.a=Fc(this.G?this.G:Dc),this.F=Bc(this.G?this.G:Dc),this.a.onreadystatechange=r(this.Ma,this);try{H(this.b,V(this,"Opening Xhr")),this.I=!0,this.a.open(e,t+"",!0),this.I=!1}catch(t){return H(this.b,V(this,"Error opening Xhr: "+t.message)),void ce(this,t)}t=n||"";var o=new O(this.headers);i&&Zc(i,function(t,e){o.set(e,t)}),i=ua(o.O()),n=k.FormData&&t instanceof k.FormData,!(0<=sa(be,e))||i||n||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.N&&(this.a.responseType=this.N),"withCredentials"in this.a&&this.a.withCredentials!==this.m&&(this.a.withCredentials=this.m);try{de(this),0<this.l&&(this.C=ee(this.a),H(this.b,V(this,"Will abort after "+this.l+"ms if incomplete, xhr2 "+this.C)),this.C?(this.a.timeout=this.l,this.a.ontimeout=r(this.Ja,this)):this.B=Zb(this.Ja,this.l,this)),H(this.b,V(this,"Sending request")),this.o=!0,this.a.send(t),this.o=!1}catch(t){H(this.b,V(this,"Send error: "+t.message)),ce(this,t)}},g.Ja=function(){void 0!==goog&&this.a&&(this.g="Timed out after "+this.l+"ms, aborting",this.j=8,H(this.b,V(this,this.g)),this.dispatchEvent("timeout"),this.abort(8))},g.abort=function(t){this.a&&this.f&&(H(this.b,V(this,"Aborting")),this.f=!1,this.h=!0,this.a.abort(),this.h=!1,this.j=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),ge(this))},g.w=function(){this.a&&(this.f&&(this.f=!1,this.h=!0,this.a.abort(),this.h=!1),ge(this,!0)),U.L.w.call(this)},g.Ma=function(){this.i||(this.I||this.o||this.h?he(this):this.bb())},g.bb=function(){he(this)},g.V=function(){try{return 2<N(this)?this.a.status:-1}catch(t){return-1}},g.Ha=function(){try{return 2<N(this)?this.a.statusText:""}catch(t){return H(this.b,"Can not get status: "+t.message),""}},g.U=function(){try{return this.a?this.a.responseText:""}catch(t){return H(this.b,"Can not get responseText: "+t.message),""}},g.Za=function(t){if(this.a){var e=this.a.responseText;t&&0==e.indexOf(t)&&(e=e.substring(t.length));t:{if(t=e,k.JSON)try{var n=k.JSON.parse(t);break t}catch(t){}n=Eb(t)}return n}},g.Ga=function(){return this.j},g.$a=function(){return l(this.g)?this.g:this.g+""},g=ke.prototype,g.oa=8,g.D=1,g.Ka=function(){return 0==this.D},g.Pa=function(t){if(this.o=null,I(this.a,"startForwardChannel_"),1==this.D)if(t)(t=this.a.a)&&F(t,"Not supposed to retry the open");else{I(this.a,"open_()"),this.I=Math.floor(1e5*Math.random()),t=this.I++;var e=new L(this,this.a,0,t,void 0),n=this.i;this.P&&(n?(n=Ea(n),Ga(n,this.P)):n=this.P),null===this.f&&(e.h=n);var r=se(this),i=M(this.H);R(i,"RID",t),0<this.za&&R(i,"CVER",this.za),this.F&&this.j&&R(i,"X-HTTP-Session-Id",this.j),ne(this,i),this.f&&n&&je(i,this.f,n),Rd(this.g,e),this.Ua?(R(i,"$req",r),Lc(e,i,null)):Lc(e,i,r),this.D=2}else 3==this.D&&(t?te(this,t):0==this.h.length?I(this.a,"startForwardChannel_ returned: nothing to send"):Sd(this.g)?(t=this.a.a)&&F(t,"startForwardChannel_ returned: connection already in progress"):(te(this),I(this.a,"startForwardChannel_ finished, sent request")))},g.Oa=function(){this.m=null,I(this.a,"Creating new HttpRequest"),this.b=new L(this,this.a,0,"rpc",this.ga),null===this.f&&(this.b.h=this.i),this.b.N=0;var t=M(this.ya);R(t,"RID","rpc"),R(t,"SID",this.M),R(t,"CI",this.ka?"0":"1"),R(t,"AID",this.S),ne(this,t),R(t,"TYPE","xmlhttp"),this.f&&this.i&&je(t,this.f,this.i),Oc(this.b,t,!0,this.ia),I(this.a,"New Request created")},g.Na=function(t,e){if(0!=this.D&&(this.b==t||Td(this.g,t)))if(this.v=t.v,Td(this.g,t)&&3==this.D){try{var i=this.la.a.parse(e)}catch(t){i=null}if(n(i)&&3==i.length)if(e=i,0==e[0])t:if(I(this.a,"Server claims our backchannel is missing."),this.m)I(this.a,"But we are currently starting the request.");else{if(this.b){if(!(this.b.H+3e3<t.H))break t;pe(this),this.b.cancel(),this.b=null}else(t=this.a.a)&&G(t,"We do not have a BackChannel established");ve(this),K()}else this.Aa=e[1],0<(t=this.Aa-this.S)&&(e=e[2],I(this.a,e+" bytes (in "+t+" arrays) are outstanding on the BackChannel"),37500>e&&this.ka&&0==this.B&&!this.s&&(this.s=xc(r(this.ab,this),6e3)));else I(this.a,"Bad POST response data returned"),W(this,11)}else if(this.b==t&&pe(this),!/^[\s\xa0]*$/.test(e))for(e=i=this.la.a.parse(e),i=0;i<e.length;i++){var o=e[i];if(this.S=o[0],o=o[1],2==this.D)if("c"==o[0]){this.M=o[1],this.ia=o[2];var a=o[3];null!=a&&(this.oa=a,I(this.a,"VER="+this.oa)),o=o[4],null!=o&&(this.Ba=o,I(this.a,"SVER="+this.Ba)),this.F&&(o=t.a)&&((a=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)&&Qd(this.g,a),this.j&&((o=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)?(this.N=o,R(this.H,this.j,o)):(o=this.a.a)&&G(o,"Missing X_HTTP_SESSION_ID in the handshake response"))),this.D=3,this.c&&this.c.Fa(this),this.ya=Kd(this,this.ia,this.ja),ue(this)}else"stop"!=o[0]&&"close"!=o[0]||W(this,7);else 3==this.D&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?W(this,7):le(this):"noop"!=o[0]&&this.c&&this.c.Ea(this,o),this.B=0)}},g.ab=function(){null!=this.s&&(this.s=null,this.b.cancel(),this.b=null,ve(this),K())},g.wa=function(e){if(I(this.a,"Request complete"),this.b==e){pe(this),this.b=null;var n=2}else{if(!Td(this.g,e))return;n=this.g,n.b&&n.b==e?n.b=null:n.a&&n.a.contains(e)&&bd(n.a.a,T(e)),n=1}if(this.v=e.v,0!=this.D)if(e.c)1==n?(t(),J.dispatchEvent(new wc(J)),re(this),this.l.length=0):ue(this);else{var i=e.i;if(3==i||0==i&&0<this.v)I(this.a,"Not retrying due to error type");else{I(this.a,"Maybe retrying, last error: "+Ic(i,this.v));var o;if((o=1==n)&&(Sd(this.g)||this.o?((e=this.a.a)&&F(e,"Request already in progress"),o=!1):1==this.D||2==this.D||2<=this.G?o=!1:(I(this.a,"Going to retry POST"),this.o=xc(r(this.Pa,this,e),we(this,this.G)),this.G++,o=!0)),o||2==n&&ve(this))return;I(this.a,"Exceeded max number of retries")}switch(I(this.a,"Error: HTTP request failed"),i){case 1:W(this,5);break;case 4:W(this,10);break;case 3:W(this,6);break;default:W(this,2)}}},g.ib=function(t){t?I(this.a,"Successfully pinged google.com"):I(this.a,"Failed to ping google.com"),K()},g.ra=function(t){if(t&&!this.T)throw Error("Can't create secondary domain capable XhrIo object.");return t=new U,t.m=this.T,t},g.sa=function(){return!!this.c&&!0},g.fa=function(){return this.T},new Cd,g=ze.prototype,g.Fa=function(){},g.Ea=function(){},g.Da=function(){},g.na=function(){},g.Wa=function(){},Be.prototype.a=function(t,e){return new X(t,e)},u(X,B),X.prototype.j=function(){this.a.c=this.h,this.o&&(this.a.T=!0);var t=this.a,e=this.s,n=this.b,r=this.g||void 0;I(t.a,"connect()"),K(),t.ja=n,t.ha=r||{},t.F&&(I(t.a,"connect() bypassed channel-test."),t.J.b=[],t.J.a=!1),I(t.a,"connectTest_()"),t.C=new Hd(t,t.a),null===t.f&&(t.C.i=t.i),n=e,t.f&&t.i&&(n=je(e,t.f,t.i)),t=t.C,t.l=n,e=xe(t.a,t.l),K(),(n=t.a.J.b)?(t.g=n[0],t.R=1,Id(t)):(Qc(e,"MODE","init"),!t.a.F&&t.a.j&&Qc(e,"X-HTTP-Session-Id",t.a.j),t.c=new L(t,t.b,0,void 0,void 0),t.c.h=t.i,Oc(t.c,e,!1,null),t.R=0)},X.prototype.close=function(){le(this.a)},X.prototype.l=function(t){if(this.m){var e={};e.__data__=Fb(t),qe(this.a,e)}else qe(this.a,t)},X.prototype.w=function(){this.a.c=null,delete this.h,le(this.a),delete this.a,X.L.w.call(this)},u(De,Fd),u(Ee,Gd),u(Ce,ze),Ce.prototype.Fa=function(){pc(this.a.f,"WebChannel opened on "+this.a.b),this.a.dispatchEvent("a")},Ce.prototype.Ea=function(t,e){this.a.dispatchEvent(new De(e))},Ce.prototype.Da=function(t,e){pc(this.a.f,"WebChannel aborted on "+this.a.b+" due to channel error: "+e),this.a.dispatchEvent(new Ee)},Ce.prototype.na=function(){pc(this.a.f,"WebChannel closed on "+this.a.b),this.a.dispatchEvent("b")};var Fe=ia(function(t,e){function n(){}n.prototype=t.prototype;var r=new n;return t.apply(r,Array.prototype.slice.call(arguments,1)),r},Be);Ge.prototype.u=function(){return this.b.length+this.a.length},Ge.prototype.contains=function(t){return 0<=sa(this.b,t)||0<=sa(this.a,t)},Ge.prototype.A=function(){for(var t=[],e=this.b.length-1;0<=e;--e)t.push(this.b[e]);var n=this.a.length;for(e=0;e<n;++e)t.push(this.a[e]);return t},u(Ie,w);var Je="[goog.structs.Pool] Min can not be greater than max";g=Ie.prototype,g.ca=function(){var e=t();if(!(null!=this.g&&0>e-this.g)){for(var n;0<this.a.u()&&(n=He(this.a),!this.va(n));)this.aa();return!n&&this.u()<this.c&&(n=this.qa()),n&&(this.g=e,this.b.a.set(T(n),n)),n}},g.hb=function(t){return!!bd(this.b.a,T(t))&&(this.ma(t),!0)},g.ma=function(t){bd(this.b.a,T(t)),this.va(t)&&this.u()<this.c?this.a.a.push(t):Ke(t)},g.aa=function(){for(var t=this.a;this.u()<this.h;){var e=this.qa();t.a.push(e)}for(;this.u()>this.c&&0<this.a.u();)Ke(He(t))},g.qa=function(){return{}},g.va=function(t){return"function"!=typeof t.Xa||t.Xa()},g.contains=function(t){return this.a.contains(t)||this.b.contains(t)},g.u=function(){return this.a.u()+this.b.u()},g.w=function(){if(Ie.L.w.call(this),0<this.b.u())throw Error("[goog.structs.Pool] Objects not released");delete this.b;for(var t=this.a;0!=t.b.length||0!=t.a.length;)Ke(He(t));delete this.a},Me.prototype.A=function(){for(var t=this.a,e=[],n=t.length,r=0;r<n;r++)e.push(t[r].b);return e},Me.prototype.O=function(){for(var t=this.a,e=[],n=t.length,r=0;r<n;r++)e.push(t[r].a);return e},Me.prototype.u=function(){return this.a.length},u(Oe,Me),u(Y,Ie),g=Y.prototype,g.ca=function(t,e){if(!t)return Y.L.ca.call(this);Ne(this.f,void 0!==e?e:100,t),this.ua()},g.ua=function(){for(var t=this.f;0<t.u();){var e=this.ca();if(!e)break;var n=t,r=n.a,i=r.length,o=r[0];if(0>=i)o=void 0;else{if(1==i)wa(r);else{r[0]=r.pop(),r=0,n=n.a,i=n.length;for(var a=n[r];r<i>>1;){var s=2*r+1,u=2*r+2;if(s=u<i&&n[u].a<n[s].a?u:s,n[s].a>a.a)break;n[r]=n[s],r=s}n[r]=a}o=o.b}o.apply(this,[e])}},g.ma=function(t){Y.L.ma.call(this,t),this.ua()},g.aa=function(){Y.L.aa.call(this),this.ua()},g.w=function(){Y.L.w.call(this),k.clearTimeout(void 0),wa(this.f.a),this.f=null},u(Z,Y),Z.prototype.qa=function(){var t=new U,e=this.l;return e&&e.forEach(function(e,n){t.headers.set(n,e)}),this.j&&(t.m=!0),t},Z.prototype.va=function(t){return!t.i&&!t.a},Be.prototype.createWebChannel=Be.prototype.a,X.prototype.send=X.prototype.l,X.prototype.open=X.prototype.j,X.prototype.close=X.prototype.close,yc.NO_ERROR=0,yc.TIMEOUT=8,yc.HTTP_ERROR=6,zc.COMPLETE="complete",Dd.EventType=Ed,Ed.OPEN="a",Ed.CLOSE="b",Ed.ERROR="c",Ed.MESSAGE="d",B.prototype.listen=B.prototype.$,Z.prototype.getObject=Z.prototype.ca,Z.prototype.releaseObject=Z.prototype.hb,U.prototype.listenOnce=U.prototype.Ia,U.prototype.getLastError=U.prototype.$a,U.prototype.getLastErrorCode=U.prototype.Ga,U.prototype.getStatus=U.prototype.V,U.prototype.getStatusText=U.prototype.Ha,U.prototype.getResponseJson=U.prototype.Za,U.prototype.getResponseText=U.prototype.U,U.prototype.getResponseText=U.prototype.U,U.prototype.send=U.prototype.ta,module.exports={createWebChannelTransport:Fe,ErrorCode:yc,EventType:zc,WebChannel:Dd,XhrIoPool:Z}}).call("undefined"!=typeof window?window:this)}},[113])}catch(t){throw Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}
//# sourceMappingURL=firebase-firestore.js.map;
define("firestore", ["firebase"], (function (global) {
    return function () {
        var ret, fn;
        return ret || global.firebase.firestore;
    };
}(this)));

define('m_firebase',['firebase','firestore'],function() {
		var config = {
		    apiKey				: "AIzaSyB48o8PHd85LMeQYMkYd4hR8Gu1-d8gJYs",
		    authDomain			: "connect-9109d.firebaseapp.com",
		    databaseURL			: "https://connect-9109d.firebaseio.com",
		    storageBucket		: "connect-9109d.appspot.com",
		    messagingSenderId	: "737839044422",
		    projectId 			: "connect-9109d"
		};

		firebase.initializeApp(config);
		return firebase;
	//@>>> URL FUNCTIONS
});
/*
	@schema
		url
*/;
/**
 * Template7 1.1.2
 * Mobile-first JavaScript template engine
 * 
 * http://www.idangero.us/template7/
 * 
 * Copyright 2016, Vladimir Kharlampidi
 * The iDangero.us
 * http://www.idangero.us/
 * 
 * Licensed under MIT
 * 
 * Released on: December 12, 2016
 */
window.Template7 = (function () {
    'use strict';
    function isArray(arr) {
        return Object.prototype.toString.apply(arr) === '[object Array]';
    }
    function isObject(obj) {
        return obj instanceof Object;
    }
    function isFunction(func) {
        return typeof func === 'function';
    }
    function _escape(string) {
        return typeof window !== 'undefined' && window.escape ? window.escape(string) : string
            .replace(/&/g, '&amp;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;')
            .replace(/"/g, '&quot;');
    }
    var cache = {};
    var quoteSingleRexExp = new RegExp('\'', 'g');
    var quoteDoubleRexExp = new RegExp('"', 'g');
    function helperToSlices(string) {
        var helperParts = string.replace(/[{}#}]/g, '').split(' ');
        var slices = [];
        var shiftIndex, i, j;
        for (i = 0; i < helperParts.length; i++) {
            var part = helperParts[i];
            var blockQuoteRegExp, openingQuote;
            if (i === 0) slices.push(part);
            else {
                if (part.indexOf('"') === 0 || part.indexOf('\'') === 0) {
                    blockQuoteRegExp = part.indexOf('"') === 0 ? quoteDoubleRexExp : quoteSingleRexExp;
                    openingQuote = part.indexOf('"') === 0 ? '"' : '\'';
                    // Plain String
                    if (part.match(blockQuoteRegExp).length === 2) {
                        // One word string
                        slices.push(part);
                    }
                    else {
                        // Find closed Index
                        shiftIndex = 0;
                        for (j = i + 1; j < helperParts.length; j++) {
                            part += ' ' + helperParts[j];
                            if (helperParts[j].indexOf(openingQuote) >= 0) {
                                shiftIndex = j;
                                slices.push(part);
                                break;
                            }
                        }
                        if (shiftIndex) i = shiftIndex;
                    }
                }
                else {
                    if (part.indexOf('=') > 0) {
                        // Hash
                        var hashParts = part.split('=');
                        var hashName = hashParts[0];
                        var hashContent = hashParts[1];
                        if (!blockQuoteRegExp) {
                            blockQuoteRegExp = hashContent.indexOf('"') === 0 ? quoteDoubleRexExp : quoteSingleRexExp;
                            openingQuote = hashContent.indexOf('"') === 0 ? '"' : '\'';
                        }
                        if (hashContent.match(blockQuoteRegExp).length !== 2) {
                            shiftIndex = 0;
                            for (j = i + 1; j < helperParts.length; j++) {
                                hashContent += ' ' + helperParts[j];
                                if (helperParts[j].indexOf(openingQuote) >= 0) {
                                    shiftIndex = j;
                                    break;
                                }
                            }
                            if (shiftIndex) i = shiftIndex;
                        }
                        var hash = [hashName, hashContent.replace(blockQuoteRegExp,'')];
                        slices.push(hash);
                    }
                    else {
                        // Plain variable
                        slices.push(part);
                    }
                }
            }
        }
        return slices;
    }
    function stringToBlocks(string) {
        var blocks = [], i, j, k;
        if (!string) return [];
        var _blocks = string.split(/({{[^{^}]*}})/);
        for (i = 0; i < _blocks.length; i++) {
            var block = _blocks[i];
            if (block === '') continue;
            if (block.indexOf('{{') < 0) {
                blocks.push({
                    type: 'plain',
                    content: block
                });
            }
            else {
                if (block.indexOf('{/') >= 0) {
                    continue;
                }
                if (block.indexOf('{#') < 0 && block.indexOf(' ') < 0 && block.indexOf('else') < 0) {
                    // Simple variable
                    blocks.push({
                        type: 'variable',
                        contextName: block.replace(/[{}]/g, '')
                    });
                    continue;
                }
                // Helpers
                var helperSlices = helperToSlices(block);
                var helperName = helperSlices[0];
                var isPartial = helperName === '>';
                var helperContext = [];
                var helperHash = {};
                for (j = 1; j < helperSlices.length; j++) {
                    var slice = helperSlices[j];
                    if (isArray(slice)) {
                        // Hash
                        helperHash[slice[0]] = slice[1] === 'false' ? false : slice[1];
                    }
                    else {
                        helperContext.push(slice);
                    }
                }

                if (block.indexOf('{#') >= 0) {
                    // Condition/Helper
                    var helperStartIndex = i;
                    var helperContent = '';
                    var elseContent = '';
                    var toSkip = 0;
                    var shiftIndex;
                    var foundClosed = false, foundElse = false, foundClosedElse = false, depth = 0;
                    for (j = i + 1; j < _blocks.length; j++) {
                        if (_blocks[j].indexOf('{{#') >= 0) {
                            depth ++;
                        }
                        if (_blocks[j].indexOf('{{/') >= 0) {
                            depth --;
                        }
                        if (_blocks[j].indexOf('{{#' + helperName) >= 0) {
                            helperContent += _blocks[j];
                            if (foundElse) elseContent += _blocks[j];
                            toSkip ++;
                        }
                        else if (_blocks[j].indexOf('{{/' + helperName) >= 0) {
                            if (toSkip > 0) {
                                toSkip--;
                                helperContent += _blocks[j];
                                if (foundElse) elseContent += _blocks[j];
                            }
                            else {
                                shiftIndex = j;
                                foundClosed = true;
                                break;
                            }
                        }
                        else if (_blocks[j].indexOf('else') >= 0 && depth === 0) {
                            foundElse = true;
                        }
                        else {
                            if (!foundElse) helperContent += _blocks[j];
                            if (foundElse) elseContent += _blocks[j];
                        }

                    }
                    if (foundClosed) {
                        if (shiftIndex) i = shiftIndex;
                        blocks.push({
                            type: 'helper',
                            helperName: helperName,
                            contextName: helperContext,
                            content: helperContent,
                            inverseContent: elseContent,
                            hash: helperHash
                        });
                    }
                }
                else if (block.indexOf(' ') > 0) {
                    if (isPartial) {
                        helperName = '_partial';
                        if (helperContext[0]) helperContext[0] = '"' + helperContext[0].replace(/"|'/g, '') + '"';
                    }
                    blocks.push({
                        type: 'helper',
                        helperName: helperName,
                        contextName: helperContext,
                        hash: helperHash
                    });
                }
            }
        }
        return blocks;
    }
    var Template7 = function (template, options) {
        var t = this;
        t.template = template;

        function getCompileFn(block, depth) {
            if (block.content) return compile(block.content, depth);
            else return function () {return ''; };
        }
        function getCompileInverse(block, depth) {
            if (block.inverseContent) return compile(block.inverseContent, depth);
            else return function () {return ''; };
        }
        function getCompileVar(name, ctx) {
            var variable, parts, levelsUp = 0, initialCtx = ctx;
            if (name.indexOf('../') === 0) {
                levelsUp = name.split('../').length - 1;
                var newDepth = ctx.split('_')[1] - levelsUp;
                ctx = 'ctx_' + (newDepth >= 1 ? newDepth : 1);
                parts = name.split('../')[levelsUp].split('.');
            }
            else if (name.indexOf('@global') === 0) {
                ctx = 'Template7.global';
                parts = name.split('@global.')[1].split('.');
            }
            else if (name.indexOf('@root') === 0) {
                ctx = 'root';
                parts = name.split('@root.')[1].split('.');
            }
            else {
                parts = name.split('.');
            }
            variable = ctx;
            for (var i = 0; i < parts.length; i++) {
                var part = parts[i];
                if (part.indexOf('@') === 0) {
                    if (i > 0) {
                        variable += '[(data && data.' + part.replace('@', '') + ')]';
                    }
                    else {
                        variable = '(data && data.' + name.replace('@', '') + ')';
                    }
                }
                else {
                    if (isFinite(part)) {
                        variable += '[' + part + ']';
                    }
                    else {
                        if (part === 'this' || part.indexOf('this.') >= 0 || part.indexOf('this[') >= 0 || part.indexOf('this(') >= 0) {
                            variable = part.replace('this', ctx);
                        }
                        else {
                            variable += '.' + part;
                        }
                    }
                }
            }

            return variable;
        }
        function getCompiledArguments(contextArray, ctx) {
            var arr = [];
            for (var i = 0; i < contextArray.length; i++) {
                if (/^['"]/.test(contextArray[i])) arr.push(contextArray[i]);
                else if (/^(true|false|\d+)$/.test(contextArray[i])) arr.push(contextArray[i]);
                else {
                    arr.push(getCompileVar(contextArray[i], ctx));
                }
            }

            return arr.join(', ');
        }
        function compile(template, depth) {
            depth = depth || 1;
            template = template || t.template;
            if (typeof template !== 'string') {
                throw new Error('Template7: Template must be a string');
            }
            var blocks = stringToBlocks(template);
            if (blocks.length === 0) {
                return function () { return ''; };
            }
            var ctx = 'ctx_' + depth;
            var resultString = '';
            if (depth === 1) {
                resultString += '(function (' + ctx + ', data, root) {\n';
            }
            else {
                resultString += '(function (' + ctx + ', data) {\n';
            }
            if (depth === 1) {
                resultString += 'function isArray(arr){return Object.prototype.toString.apply(arr) === \'[object Array]\';}\n';
                resultString += 'function isFunction(func){return (typeof func === \'function\');}\n';
                resultString += 'function c(val, ctx) {if (typeof val !== "undefined" && val !== null) {if (isFunction(val)) {return val.call(ctx);} else return val;} else return "";}\n';
                resultString += 'root = root || ctx_1 || {};\n';
            }
            resultString += 'var r = \'\';\n';
            var i, j, context;
            for (i = 0; i < blocks.length; i++) {
                var block = blocks[i];
                // Plain block
                if (block.type === 'plain') {
                    resultString += 'r +=\'' + (block.content).replace(/\r/g, '\\r').replace(/\n/g, '\\n').replace(/'/g, '\\' + '\'') + '\';';
                    continue;
                }
                var variable, compiledArguments;
                // Variable block
                if (block.type === 'variable') {
                    variable = getCompileVar(block.contextName, ctx);
                    resultString += 'r += c(' + variable + ', ' + ctx + ');';
                }
                // Helpers block
                if (block.type === 'helper') {
                    if (block.helperName in t.helpers) {
                        compiledArguments = getCompiledArguments(block.contextName, ctx);

                        resultString += 'r += (Template7.helpers.' + block.helperName + ').call(' + ctx + ', ' + (compiledArguments && (compiledArguments + ', ')) +'{hash:' + JSON.stringify(block.hash) + ', data: data || {}, fn: ' + getCompileFn(block, depth + 1) + ', inverse: ' + getCompileInverse(block, depth + 1) + ', root: root});';

                    }
                    else {
                        if (block.contextName.length > 0) {
                            throw new Error('Template7: Missing helper: "' + block.helperName + '"');
                        }
                        else {
                            variable = getCompileVar(block.helperName, ctx);
                            resultString += 'if (' + variable + ') {';
                            resultString += 'if (isArray(' + variable + ')) {';
                            resultString += 'r += (Template7.helpers.each).call(' + ctx + ', ' + variable + ', {hash:' + JSON.stringify(block.hash) + ', data: data || {}, fn: ' + getCompileFn(block, depth+1) + ', inverse: ' + getCompileInverse(block, depth+1) + ', root: root});';
                            resultString += '}else {';
                            resultString += 'r += (Template7.helpers.with).call(' + ctx + ', ' + variable + ', {hash:' + JSON.stringify(block.hash) + ', data: data || {}, fn: ' + getCompileFn(block, depth+1) + ', inverse: ' + getCompileInverse(block, depth+1) + ', root: root});';
                            resultString += '}}';
                        }
                    }
                }
            }
            resultString += '\nreturn r;})';
            return eval.call(window, resultString);
        }
        t.compile = function (template) {
            if (!t.compiled) {
                t.compiled = compile(template);
            }
            return t.compiled;
        };
    };
    Template7.prototype = {
        options: {},
        partials: {},
        helpers: {
            '_partial' : function (partialName, options) {
                var p = Template7.prototype.partials[partialName];
                if (!p || (p && !p.template)) return '';
                if (!p.compiled) {
                    p.compiled = new Template7(p.template).compile();
                }
                var ctx = this;
                for (var hashName in options.hash) {
                    ctx[hashName] = options.hash[hashName];
                }
                return p.compiled(ctx, options.data, options.root);
            },
            'escape': function (context, options) {
                if (typeof context !== 'string') {
                    throw new Error('Template7: Passed context to "escape" helper should be a string');
                }
                return _escape(context);
            },
            'if': function (context, options) {
                if (isFunction(context)) { context = context.call(this); }
                if (context) {
                    return options.fn(this, options.data);
                }
                else {
                    return options.inverse(this, options.data);
                }
            },
            'unless': function (context, options) {
                if (isFunction(context)) { context = context.call(this); }
                if (!context) {
                    return options.fn(this, options.data);
                }
                else {
                    return options.inverse(this, options.data);
                }
            },
            'each': function (context, options) {
                var ret = '', i = 0;
                if (isFunction(context)) { context = context.call(this); }
                if (isArray(context)) {
                    if (options.hash.reverse) {
                        context = context.reverse();
                    }
                    for (i = 0; i < context.length; i++) {
                        ret += options.fn(context[i], {first: i === 0, last: i === context.length - 1, index: i});
                    }
                    if (options.hash.reverse) {
                        context = context.reverse();
                    }
                }
                else {
                    for (var key in context) {
                        i++;
                        ret += options.fn(context[key], {key: key});
                    }
                }
                if (i > 0) return ret;
                else return options.inverse(this);
            },
            'with': function (context, options) {
                if (isFunction(context)) { context = context.call(this); }
                return options.fn(context);
            },
            'join': function (context, options) {
                if (isFunction(context)) { context = context.call(this); }
                return context.join(options.hash.delimiter || options.hash.delimeter);
            },
            'js': function (expression, options) {
                var func;
                if (expression.indexOf('return')>=0) {
                    func = '(function(){'+expression+'})';
                }
                else {
                    func = '(function(){return ('+expression+')})';
                }
                return eval.call(this, func).call(this);
            },
            'js_compare': function (expression, options) {
                var func;
                if (expression.indexOf('return')>=0) {
                    func = '(function(){'+expression+'})';
                }
                else {
                    func = '(function(){return ('+expression+')})';
                }
                var condition = eval.call(this, func).call(this);
                if (condition) {
                    return options.fn(this, options.data);
                }
                else {
                    return options.inverse(this, options.data);
                }
            }
        }
    };
    var t7 = function (template, data) {
        if (arguments.length === 2) {
            var instance = new Template7(template);
            var rendered = instance.compile()(data);
            instance = null;
            return (rendered);
        }
        else return new Template7(template);
    };
    t7.registerHelper = function (name, fn) {
        Template7.prototype.helpers[name] = fn;
    };
    t7.unregisterHelper = function (name) {
        Template7.prototype.helpers[name] = undefined;
        delete Template7.prototype.helpers[name];
    };
    t7.registerPartial = function (name, template) {
        Template7.prototype.partials[name] = {template: template};
    };
    t7.unregisterPartial = function (name, template) {
        if (Template7.prototype.partials[name]) {
            Template7.prototype.partials[name] = undefined;
            delete Template7.prototype.partials[name];
        }
    };
    t7.compile = function (template, options) {
        var instance = new Template7(template, options);
        return instance.compile();
    };

    t7.options = Template7.prototype.options;
    t7.helpers = Template7.prototype.helpers;
    t7.partials = Template7.prototype.partials;
    return t7;
})();
//# sourceMappingURL=template7.js.map
;
define("template7", (function (global) {
    return function () {
        var ret, fn;
        return ret || global.Template7;
    };
}(this)));

define('v_view',['jquery','template7','dictionary'], function ($,Template7, DICTIONARY) {






	function _d_issetDomEl (iNdomElement) {
		/*
			@discr
				check dom element for isset
			@inputs
				@required
					iNdomElement -> string
			@return 
				bool
		*/
		if($(iNdomElement).length >0) return true;
		return false;
	}
	function _d_addDataToViewEl (iNdomElement,iNaddedData,iNwhere) {
		/*
			@inputs
				@required
					iNdomElement -> string
					iNaddedData -> string | object of dom
				@optional
					iNwhere -> string [default = begin] [begin, end, before, after]
		*/
		switch(iNwhere){
			case "change":
				$(iNdomElement).html(iNaddedData);
			break;

			case "end":
				$(iNdomElement).append(iNaddedData);
			break;

			case "before":
				$(iNdomElement).before(iNaddedData);
			break;

			case "after":
				$(iNdomElement).after(iNaddedData);
			break;

			default: // start
				$(iNdomElement).prepend(iNaddedData);
			break;
		}
	}	
	// chief container for body
		var html_cont = `
			<div id='container'>

		      <div class='backTopLineInContainer'></div>
		      <div id='block'>

		      	<div id='appsBlock'>
		      		{{View_listApps}}
		      	</div>
				<div id='menusBlock'>
		            {{View_listViews}}
		        </div>
				<div id="viewBlock">
				   {{View_chiefView}}
				</div>

			  </div>

			</div>
		`;
		function _initWithObj (iNdata) {
			/*
				@discr
					get canvas with object (iNdata)
				@input
					iNdata -> Object
						arrListApps -> array (array with objects by data for list apps)
				@return
					canvas (template)
				@deps
					html_cont 		: var
					View_listViews 	: var
					View_chiefView 	: var
					Template7 		: Object
			*/
			var temp = Template7.compile(html_cont);
        	return temp (
        		{
        			'View_listApps'  : _getViewListApps( iNdata['arrListApps']),
        			'View_listViews' : View_listViews,
        			'View_chiefView' : View_chiefView,
        		}
        	);
		}



	// list view for output categories, menus, lists, chats 
		var View_listViews = `
			<div class='topBlockInMenusBlock'>
                <div id='IconUserInMenusBlock'>
                  <a href='#'><img src='https://cdn.ramman.net/images/icons/users/noPhoto.png'></a>
                </div>
                <div id='UserNameInMenusBlock'>
                  <a href='/sign' class='CML'>[system-signIn]/[system-signUp]</a>
                </div>
                <div class='ChoosePlaceInMenusBlock'></div>
            </div>
            <div class='searchBlockInMenusBlock'>
                <form class='searchContainerInSearchBlock' class='CML'>
                  <input type="text" class='searchInputInSearchBlock' placeholder="...">
                  <input type="submit" class='submitInputInSearchBlock' value="">
                </form>
            </div>
            <div class='usersBlockContainerInMenusBlock appLeftMenuWindow'>
                
            </div>
		`;
		

        

	// chief biggest view for output chief information
		var View_chiefView = `
			<div class="topBlockInViewBlock">
			   <div class="viewesInTopViewBlock">
			      <div id="IconUserInViewBlock"><a href="#"><img src="https://cdn.ramman.net/images/icons/apps/app_market.png"></a></div>
			      <div id="UserNameInViewBlock"><a href="#" class="CML" cmlk="[dictionary-name]"></a></div>
			      <div id="UserTypeInViewBlock"><a href="#" class="CML" cmlk="[dictionary-service]"></a></div>
			   </div>
			</div>
			<div id="viewAndChatBlockInViewBlock" class="appChiefWindow">
			</div>
		`;
		/* in viewAndChatBlockInViewBlock for chat app
			<div id="subViewInViewAndChatBlock">
			  <div id="menuWindowInSubView"></div>
			  <div id="viewWindow" class="appChiefWindow">
			  </div>
			  <div class="chatBlockInViewBlock">
			     <div class="viewesFooterUnderWindow">
			        <div id="senderBlockInViewBlock">
			           <div id="bottomViewInMsgBlock">
			              <ul class="rawBlockInBottomView">
			                 <li class="LineInBottomViewRawBlock">1</li>
			                 <li class="LineInBottomViewRawBlock">2</li>
			              </ul>
			           </div>
			           <div id="forTextInputInSenderBlock">
			              <textarea></textarea>
			           </div>
			           <div id="sendButtonInSenderBlock" class="sendTextMsgButton"></div>
			           <img src="https://cdn.ramman.net/images/icons/miniConnectWebIcon.png" id="ConnectButtonInFuncButtons">
			        </div>
			     </div>
			  </div>
			</div>
	    */
		

	//<? View_listApps 
		// for output apps icon with name for chosing
			var View_listApps = `
				<div class='bTopInAppsBlock'>
		            <img src='https://cdn.ramman.net/images/buttons/bTopInAppsBlock.png'>
		        </div>
		        <div class='AppsContainerInAppBlock'>{{listApps}}</div>
		        <div class='bBottomInAppsBlock'>
		            <img src='https://cdn.ramman.net/images/buttons/bBottomInAppsBlock.png'>
		        </div>
	        `;
	        // icon, name, dictionaryKey  {listApps} -> View_listApps
		        var Template_listApps_apps = `
		        	{{#each apps}}
		        	<div class='appBlockInAppBlock'>
			        	<div class="appsInAppBlock">
						  <img src="{{icon}}">
						  <div class="appsNameInAppsBlock CML" cmlk="{{dc}}">{{name}}</div>
						</div>
					</div>
					{{/each}}
		        `;
        //methods
        	function getListApps (iNarrayApps) {
				var temp = Template7.compile(Template_listApps_apps);
        		return temp({'apps':iNarrayApps});
			}
			function _getViewListApps(iNarrayApps) {
				var temp = Template7.compile(View_listApps);
        		return temp( { 'listApps':getListApps(iNarrayApps) });
			}	

    //>! View_listApps 
	
    //<? work with loader
    		const loader_timeoutid = {};
    		function loader_clearTimeout ( iNloaderKey, iNloaderCode ) {
    			if ( typeof loader_timeoutid[iNloaderKey] == 'object' && typeof loader_timeoutid[iNloaderKey][iNloaderCode] != 'undefined' )
					clearTimeout ( loader_timeoutid[iNloaderKey][iNloaderCode]);
    		}

    		function loader_saveTimeout  ( iNloaderKey, iNloaderCode , iNtimeout ) {
    			// create object if its not
    			if ( typeof loader_timeoutid[iNloaderKey] != 'object' ) loader_timeoutid[iNloaderKey] = {};
    			// save timeout to object 
    			loader_timeoutid[iNloaderKey][iNloaderCode] = iNtimeout;
    		}




    		const loader_templates = {}; // var _v_html_loader 
			loader_templates ['default'] = `
				<div class="rcontent_loader rConnectLoaderKey_{{loader_key}}" rconnect_loader_code="{{loader_code}}" style="width: 100%; height: 100%;">
					<div class="connect_centerPosition">
						<img id="rcontent_loader_image" src="https://cdn.ramman.net/images/gif/loader.min.gif">
						<div class ="CML operationName" style=" font-size: 1.5rem;">[system-load]</div>
					</div>
				</div>
			`;
			loader_templates ['forMenuListKey'] = `
				<div class="rcontent_loader rConnectLoaderKey_{{loader_key}}" rconnect_loader_code="{{loader_code}}" style="width: 100%; height: 100%; background: #f2f2f2; color: rgba(0, 0, 0, 0.75); border: 1px dashed rgba(0, 179, 211, 0.5);">
				   <div class="connect_centerPosition">
				      <i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i>
				      <div class="CML operationName" style=" font-size: 1.5rem;"></div>
				   </div>
				</div>
			`;


			function setTextInLoader (iNtext) {
				/*
					@discr
						set text in loader
					@inputs
						@required
							iNtext -> string

				*/
				$('.rcontent_loader .operationName').text(iNtext);
			}

			function setTextInLoaderWithDictionary (iNtext) {
				/*
					@discr
						set text in loader
					@inputs
						@required
							iNtext -> string

				*/
				$('.rcontent_loader .operationName').text( DICTIONARY.withString(iNtext) );
			}
			
			function showLoader ( iNid, iNloaderKey, iNloaderCode ) {
				console.log('showLoader - iNid, iNloaderKey, iNloaderCode',iNid, iNloaderKey, iNloaderCode);
				// get loader key for get template from object {$loader_templates}
				if ( typeof iNloaderKey != 'string' )  iNloaderKey = loader_getDefaultKey();
				// get loader code for get template from object {$loader_templates}
				if ( typeof iNloaderCode != 'string' )  iNloaderCode = loader_getDefaultCode();
				// get loader container
				if ( typeof(iNid) != 'string' ) 		iNid = loader_getDefaultSelector();

				// closer other loader if they isset
				closeLoader(iNid, iNloaderKey, iNloaderCode);
				// get loader template by its key
				let loaderContent = loader_getContentByTemplate (iNloaderKey, iNloaderCode);// loader_templates[iNloaderKey];
				// add to dom our loader
				$(iNid).append( loaderContent );
			}

			function closeLoader (iNid, iNloaderKey, iNloaderCode) {
				console.log('closeLoader - iNid, iNloaderKey, iNloaderCode',iNid, iNloaderKey, iNloaderCode);
				// get dom path to loader
				let loaderPathToDom = loader_getPathToLoader (iNid, iNloaderKey, iNloaderCode);
				console.log('closeLoader - loaderPathToDom - ',loaderPathToDom);
				// remove loader
				$(loaderPathToDom).remove();
			}

			function closeLoaderByTimeout (iNms, iNid, iNloaderKey, iNloaderCode) {
				// clear timeout if its isset
				loader_clearTimeout ( iNloaderKey, iNloaderCode );

              	// get time
				let second = iNms || 1000;
				
				// get timeout id
				let timeout = setTimeout(
					() => {
						closeLoader (iNid, iNloaderKey, iNloaderCode)
					}, 
					second
				);

				// save timeout
				loader_saveTimeout  ( iNloaderKey, iNloaderCode , timeout );
			}



			function loader_getPathToLoader (iNid, iNloaderKey, iNloaderCode ) {
				//loader key
				if(typeof iNloaderKey != 'string') 	iNloaderKey 	= loader_getDefaultKey();
				//loader code
				if(typeof iNloaderCode != 'string') iNloaderCode 	= loader_getDefaultCode();
				//loader selector
				if(typeof iNid != 'string') 		iNid 			= loader_getDefaultSelector();

				let baseSelectorForLoaders = loader_getBaseClassForLoaders();

				let loaderPathToDom = `${iNid} ${baseSelectorForLoaders}.rConnectLoaderKey_${iNloaderKey}[rconnect_loader_code='${iNloaderCode}']`;
				// loaderPathToDom @example "body .rcontent_loader.rConnectLoaderKey_default[rconnect_loader_code='default']"

				return loaderPathToDom;
			}

			function loader_getContentByTemplate (iNloaderKey, iNloaderCode) {
				//loader key
				let loader_key = iNloaderKey;
				//loader code
				let loader_code = iNloaderCode;


				// get loader template by its key
				let loaderTemplate = loader_templates[loader_key];

				// get loader box
				let loaderTemplateBox = Template7.compile( loaderTemplate );
				let objForGetBox = {
					'loader_key' 		: loader_key,
					'loader_code' 		: loader_code
				};
				let loaderBox = loaderTemplateBox(objForGetBox);

				return DICTIONARY.withString ( loaderBox );

			}
			function loader_getBaseClassForLoaders () {
				let defaultSelector = '.rcontent_loader';
				return defaultSelector;
			}
			function loader_getDefaultKey () {
				let defaultKey = 'default';
				return defaultKey;//loader_templates[defaultKey] 
			}
			function loader_getDefaultCode () {
				let defaultCode = 'default';
				return defaultCode; 
			}
			function loader_getDefaultSelector () {
				let defaultSelector = 'body';
				return defaultSelector; 
			}
	//>! work with loader
	
	


	return {
	  // common base functions
	    'd_issetDomEl'          : _d_issetDomEl,
	    'd_addDataToViewEl'     : _d_addDataToViewEl,

	  // constructors functions
	    'initWithObj'           : _initWithObj,

	  //p 'getListApps'            : 'getListApps',
	    '_getViewListApps'      : _getViewListApps,

	  // functions for loader
	    'showLoader'          			: showLoader,
	    'closeLoader'         			: closeLoader,
	    'setTextInLoaderWithDictionary' : setTextInLoaderWithDictionary,
	    'loader_clearTimeout' 			: loader_clearTimeout,
    	'loader_saveTimeout' 			: loader_saveTimeout,
    	'closeLoaderByTimeout' 			: closeLoaderByTimeout

	}
});
/*!
 * sweetalert2 v7.0.6
 * Released under the MIT License.
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :
  typeof define === 'function' && define.amd ? define('sweetalert2',factory) :
  (global.Sweetalert2 = factory());
}(this, (function () { 'use strict';

var styles = ".swal2-buttonswrapper button { margin: 0.5rem; } body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown) {\n  overflow-y: hidden; }\n\nbody.swal2-toast-shown {\n  overflow-y: auto; }\n  body.swal2-toast-shown.swal2-has-input > .swal2-container > .swal2-toast {\n    -webkit-box-orient: vertical;\n    -webkit-box-direction: normal;\n        -ms-flex-direction: column;\n            flex-direction: column; }\n    body.swal2-toast-shown.swal2-has-input > .swal2-container > .swal2-toast .swal2-icon {\n      margin: 0 0 15px; }\n    body.swal2-toast-shown.swal2-has-input > .swal2-container > .swal2-toast .swal2-buttonswrapper {\n      -webkit-box-flex: 1;\n          -ms-flex: 1;\n              flex: 1;\n      -ms-flex-item-align: stretch;\n          align-self: stretch;\n      -webkit-box-pack: end;\n          -ms-flex-pack: end;\n              justify-content: flex-end; }\n    body.swal2-toast-shown.swal2-has-input > .swal2-container > .swal2-toast .swal2-loading {\n      -webkit-box-pack: center;\n          -ms-flex-pack: center;\n              justify-content: center; }\n    body.swal2-toast-shown.swal2-has-input > .swal2-container > .swal2-toast .swal2-input {\n      height: 32px;\n      font-size: 14px;\n      margin: 5px auto; }\n  body.swal2-toast-shown > .swal2-container {\n    position: fixed;\n    background-color: transparent; }\n    body.swal2-toast-shown > .swal2-container.swal2-shown {\n      background-color: transparent; }\n    body.swal2-toast-shown > .swal2-container.swal2-top {\n      top: 0;\n      left: 50%;\n      bottom: auto;\n      right: auto;\n      -webkit-transform: translateX(-50%);\n              transform: translateX(-50%); }\n    body.swal2-toast-shown > .swal2-container.swal2-top-right {\n      top: 0;\n      left: auto;\n      bottom: auto;\n      right: 0; }\n    body.swal2-toast-shown > .swal2-container.swal2-top-left {\n      top: 0;\n      left: 0;\n      bottom: auto;\n      right: auto; }\n    body.swal2-toast-shown > .swal2-container.swal2-center-left {\n      top: 50%;\n      left: 0;\n      bottom: auto;\n      right: auto;\n      -webkit-transform: translateY(-50%);\n              transform: translateY(-50%); }\n    body.swal2-toast-shown > .swal2-container.swal2-center {\n      top: 50%;\n      left: 50%;\n      bottom: auto;\n      right: auto;\n      -webkit-transform: translate(-50%, -50%);\n              transform: translate(-50%, -50%); }\n    body.swal2-toast-shown > .swal2-container.swal2-center-right {\n      top: 50%;\n      left: auto;\n      bottom: auto;\n      right: 0;\n      -webkit-transform: translateY(-50%);\n              transform: translateY(-50%); }\n    body.swal2-toast-shown > .swal2-container.swal2-bottom-left {\n      top: auto;\n      left: 0;\n      bottom: 0;\n      right: auto; }\n    body.swal2-toast-shown > .swal2-container.swal2-bottom {\n      top: auto;\n      left: 50%;\n      bottom: 0;\n      right: auto;\n      -webkit-transform: translateX(-50%);\n              transform: translateX(-50%); }\n    body.swal2-toast-shown > .swal2-container.swal2-bottom-right {\n      top: auto;\n      left: auto;\n      bottom: 0;\n      right: 0; }\n\nbody.swal2-iosfix {\n  position: fixed;\n  left: 0;\n  right: 0; }\n\nbody.swal2-no-backdrop > .swal2-shown {\n  top: auto;\n  bottom: auto;\n  left: auto;\n  right: auto;\n  background-color: transparent; }\n  body.swal2-no-backdrop > .swal2-shown > .swal2-modal {\n    -webkit-box-shadow: 0 0 10px rgba(0, 0, 0, 0.4);\n            box-shadow: 0 0 10px rgba(0, 0, 0, 0.4); }\n  body.swal2-no-backdrop > .swal2-shown.swal2-top {\n    top: 0;\n    left: 50%;\n    -webkit-transform: translateX(-50%);\n            transform: translateX(-50%); }\n  body.swal2-no-backdrop > .swal2-shown.swal2-top-left {\n    top: 0;\n    left: 0; }\n  body.swal2-no-backdrop > .swal2-shown.swal2-top-right {\n    top: 0;\n    right: 0; }\n  body.swal2-no-backdrop > .swal2-shown.swal2-center {\n    top: 50%;\n    left: 50%;\n    -webkit-transform: translate(-50%, -50%);\n            transform: translate(-50%, -50%); }\n  body.swal2-no-backdrop > .swal2-shown.swal2-center-left {\n    top: 50%;\n    left: 0;\n    -webkit-transform: translateY(-50%);\n            transform: translateY(-50%); }\n  body.swal2-no-backdrop > .swal2-shown.swal2-center-right {\n    top: 50%;\n    right: 0;\n    -webkit-transform: translateY(-50%);\n            transform: translateY(-50%); }\n  body.swal2-no-backdrop > .swal2-shown.swal2-bottom {\n    bottom: 0;\n    left: 50%;\n    -webkit-transform: translateX(-50%);\n            transform: translateX(-50%); }\n  body.swal2-no-backdrop > .swal2-shown.swal2-bottom-left {\n    bottom: 0;\n    left: 0; }\n  body.swal2-no-backdrop > .swal2-shown.swal2-bottom-right {\n    bottom: 0;\n    right: 0; }\n\n.swal2-container {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: row;\n          flex-direction: row;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  position: fixed;\n  padding: 10px;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: transparent;\n  z-index: 1060; }\n  .swal2-container.swal2-top {\n    -webkit-box-align: start;\n        -ms-flex-align: start;\n            align-items: flex-start; }\n  .swal2-container.swal2-top-left {\n    -webkit-box-align: start;\n        -ms-flex-align: start;\n            align-items: flex-start;\n    -webkit-box-pack: start;\n        -ms-flex-pack: start;\n            justify-content: flex-start; }\n  .swal2-container.swal2-top-right {\n    -webkit-box-align: start;\n        -ms-flex-align: start;\n            align-items: flex-start;\n    -webkit-box-pack: end;\n        -ms-flex-pack: end;\n            justify-content: flex-end; }\n  .swal2-container.swal2-center {\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center; }\n  .swal2-container.swal2-center-left {\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n    -webkit-box-pack: start;\n        -ms-flex-pack: start;\n            justify-content: flex-start; }\n  .swal2-container.swal2-center-right {\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n    -webkit-box-pack: end;\n        -ms-flex-pack: end;\n            justify-content: flex-end; }\n  .swal2-container.swal2-bottom {\n    -webkit-box-align: end;\n        -ms-flex-align: end;\n            align-items: flex-end; }\n  .swal2-container.swal2-bottom-left {\n    -webkit-box-align: end;\n        -ms-flex-align: end;\n            align-items: flex-end;\n    -webkit-box-pack: start;\n        -ms-flex-pack: start;\n            justify-content: flex-start; }\n  .swal2-container.swal2-bottom-right {\n    -webkit-box-align: end;\n        -ms-flex-align: end;\n            align-items: flex-end;\n    -webkit-box-pack: end;\n        -ms-flex-pack: end;\n            justify-content: flex-end; }\n  .swal2-container.swal2-grow-fullscreen > .swal2-modal {\n    display: -webkit-box !important;\n    display: -ms-flexbox !important;\n    display: flex !important;\n    -webkit-box-flex: 1;\n        -ms-flex: 1;\n            flex: 1;\n    -ms-flex-item-align: stretch;\n        align-self: stretch;\n    -webkit-box-pack: center;\n        -ms-flex-pack: center;\n            justify-content: center; }\n  .swal2-container.swal2-grow-row > .swal2-modal {\n    display: -webkit-box !important;\n    display: -ms-flexbox !important;\n    display: flex !important;\n    -webkit-box-flex: 1;\n        -ms-flex: 1;\n            flex: 1;\n    -ms-flex-line-pack: center;\n        align-content: center;\n    -webkit-box-pack: center;\n        -ms-flex-pack: center;\n            justify-content: center; }\n  .swal2-container.swal2-grow-column {\n    -webkit-box-flex: 1;\n        -ms-flex: 1;\n            flex: 1;\n    -webkit-box-orient: vertical;\n    -webkit-box-direction: normal;\n        -ms-flex-direction: column;\n            flex-direction: column; }\n    .swal2-container.swal2-grow-column.swal2-top, .swal2-container.swal2-grow-column.swal2-center, .swal2-container.swal2-grow-column.swal2-bottom {\n      -webkit-box-align: center;\n          -ms-flex-align: center;\n              align-items: center; }\n    .swal2-container.swal2-grow-column.swal2-top-left, .swal2-container.swal2-grow-column.swal2-center-left, .swal2-container.swal2-grow-column.swal2-bottom-left {\n      -webkit-box-align: start;\n          -ms-flex-align: start;\n              align-items: flex-start; }\n    .swal2-container.swal2-grow-column.swal2-top-right, .swal2-container.swal2-grow-column.swal2-center-right, .swal2-container.swal2-grow-column.swal2-bottom-right {\n      -webkit-box-align: end;\n          -ms-flex-align: end;\n              align-items: flex-end; }\n    .swal2-container.swal2-grow-column > .swal2-modal {\n      display: -webkit-box !important;\n      display: -ms-flexbox !important;\n      display: flex !important;\n      -webkit-box-flex: 1;\n          -ms-flex: 1;\n              flex: 1;\n      -ms-flex-line-pack: center;\n          align-content: center;\n      -webkit-box-pack: center;\n          -ms-flex-pack: center;\n              justify-content: center; }\n  .swal2-container:not(.swal2-top):not(.swal2-top-left):not(.swal2-top-right):not(.swal2-center-left):not(.swal2-center-right):not(.swal2-bottom):not(.swal2-bottom-left):not(.swal2-bottom-right) > .swal2-modal {\n    margin: auto; }\n  @media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {\n    .swal2-container .swal2-modal {\n      margin: 0 !important; } }\n  .swal2-container.swal2-fade {\n    -webkit-transition: background-color .1s;\n    transition: background-color .1s; }\n  .swal2-container.swal2-shown {\n    background-color: rgba(0, 0, 0, 0.4); }\n\n.swal2-popup {\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  background-color: #fff;\n  font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;\n  border-radius: 5px;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  text-align: center;\n  overflow-x: hidden;\n  overflow-y: auto;\n  display: none;\n  position: relative;\n  max-width: 100%; }\n  .swal2-popup.swal2-toast {\n    width: 300px;\n    padding: 0 15px;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: normal;\n        -ms-flex-direction: row;\n            flex-direction: row;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n    overflow-y: hidden;\n    -webkit-box-shadow: 0 0 10px #d9d9d9;\n            box-shadow: 0 0 10px #d9d9d9; }\n    .swal2-popup.swal2-toast .swal2-title {\n      max-width: 300px;\n      font-size: 16px;\n      text-align: left; }\n    .swal2-popup.swal2-toast .swal2-content {\n      font-size: 14px;\n      text-align: left; }\n    .swal2-popup.swal2-toast .swal2-icon {\n      width: 32px;\n      height: 32px;\n      margin: 0 15px 0 0; }\n      .swal2-popup.swal2-toast .swal2-icon.swal2-success .swal2-success-ring {\n        width: 32px;\n        height: 32px; }\n      .swal2-popup.swal2-toast .swal2-icon.swal2-info, .swal2-popup.swal2-toast .swal2-icon.swal2-warning, .swal2-popup.swal2-toast .swal2-icon.swal2-question {\n        font-size: 26px;\n        line-height: 32px; }\n      .swal2-popup.swal2-toast .swal2-icon.swal2-error [class^='swal2-x-mark-line'] {\n        top: 14px;\n        width: 22px; }\n        .swal2-popup.swal2-toast .swal2-icon.swal2-error [class^='swal2-x-mark-line'][class$='left'] {\n          left: 5px; }\n        .swal2-popup.swal2-toast .swal2-icon.swal2-error [class^='swal2-x-mark-line'][class$='right'] {\n          right: 5px; }\n    .swal2-popup.swal2-toast .swal2-buttonswrapper {\n      margin: 0 0 0 5px; }\n    .swal2-popup.swal2-toast .swal2-styled {\n      margin: 0 0 0 5px;\n      padding: 5px 10px; }\n      .swal2-popup.swal2-toast .swal2-styled:focus {\n        -webkit-box-shadow: 0 0 0 1px #fff, 0 0 0 2px rgba(50, 100, 150, 0.4);\n                box-shadow: 0 0 0 1px #fff, 0 0 0 2px rgba(50, 100, 150, 0.4); }\n    .swal2-popup.swal2-toast .swal2-validationerror {\n      width: 100%;\n      margin: 5px -20px; }\n    .swal2-popup.swal2-toast .swal2-success {\n      border-color: #a5dc86; }\n      .swal2-popup.swal2-toast .swal2-success [class^='swal2-success-circular-line'] {\n        border-radius: 50%;\n        position: absolute;\n        width: 32px;\n        height: 64px;\n        -webkit-transform: rotate(45deg);\n                transform: rotate(45deg); }\n        .swal2-popup.swal2-toast .swal2-success [class^='swal2-success-circular-line'][class$='left'] {\n          border-radius: 64px 0 0 64px;\n          top: -4px;\n          left: -15px;\n          -webkit-transform: rotate(-45deg);\n                  transform: rotate(-45deg);\n          -webkit-transform-origin: 32px 32px;\n                  transform-origin: 32px 32px; }\n        .swal2-popup.swal2-toast .swal2-success [class^='swal2-success-circular-line'][class$='right'] {\n          border-radius: 0 64px 64px 0;\n          top: -5px;\n          left: 14px;\n          -webkit-transform-origin: 0 32px;\n                  transform-origin: 0 32px; }\n      .swal2-popup.swal2-toast .swal2-success .swal2-success-ring {\n        width: 32px;\n        height: 32px; }\n      .swal2-popup.swal2-toast .swal2-success .swal2-success-fix {\n        width: 7px;\n        height: 90px;\n        left: 28px;\n        top: 8px; }\n      .swal2-popup.swal2-toast .swal2-success [class^='swal2-success-line'] {\n        height: 5px; }\n        .swal2-popup.swal2-toast .swal2-success [class^='swal2-success-line'][class$='tip'] {\n          width: 12px;\n          left: 3px;\n          top: 18px; }\n        .swal2-popup.swal2-toast .swal2-success [class^='swal2-success-line'][class$='long'] {\n          width: 22px;\n          right: 3px;\n          top: 15px; }\n    .swal2-popup.swal2-toast .swal2-animate-success-line-tip {\n      -webkit-animation: animate-toast-success-tip .75s;\n              animation: animate-toast-success-tip .75s; }\n    .swal2-popup.swal2-toast .swal2-animate-success-line-long {\n      -webkit-animation: animate-toast-success-long .75s;\n              animation: animate-toast-success-long .75s; }\n  .swal2-popup:focus {\n    outline: none; }\n  .swal2-popup.swal2-loading {\n    overflow-y: hidden; }\n  .swal2-popup .swal2-title {\n    color: #595959;\n    font-size: 30px;\n    text-align: center;\n    font-weight: 600;\n    text-transform: none;\n    position: relative;\n    margin: 0 0 .4em;\n    padding: 0;\n    display: block;\n    word-wrap: break-word; }\n  .swal2-popup .swal2-buttonswrapper {\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n    -webkit-box-pack: center;\n        -ms-flex-pack: center;\n            justify-content: center;\n    margin-top: 15px; }\n    .swal2-popup .swal2-buttonswrapper:not(.swal2-loading) .swal2-styled[disabled] {\n      opacity: .4;\n      cursor: no-drop; }\n    .swal2-popup .swal2-buttonswrapper.swal2-loading .swal2-styled.swal2-confirm {\n      -webkit-box-sizing: border-box;\n              box-sizing: border-box;\n      border: 4px solid transparent;\n      border-color: transparent;\n      width: 40px;\n      height: 40px;\n      padding: 0;\n      margin: 7.5px;\n      vertical-align: top;\n      background-color: transparent !important;\n      color: transparent;\n      cursor: default;\n      border-radius: 100%;\n      -webkit-animation: rotate-loading 1.5s linear 0s infinite normal;\n              animation: rotate-loading 1.5s linear 0s infinite normal;\n      -webkit-user-select: none;\n         -moz-user-select: none;\n          -ms-user-select: none;\n              user-select: none; }\n    .swal2-popup .swal2-buttonswrapper.swal2-loading .swal2-styled.swal2-cancel {\n      margin-left: 30px;\n      margin-right: 30px; }\n    .swal2-popup .swal2-buttonswrapper.swal2-loading :not(.swal2-styled).swal2-confirm::after {\n      display: inline-block;\n      content: '';\n      margin-left: 5px;\n      vertical-align: -1px;\n      height: 15px;\n      width: 15px;\n      border: 3px solid #999999;\n      -webkit-box-shadow: 1px 1px 1px #fff;\n              box-shadow: 1px 1px 1px #fff;\n      border-right-color: transparent;\n      border-radius: 50%;\n      -webkit-animation: rotate-loading 1.5s linear 0s infinite normal;\n              animation: rotate-loading 1.5s linear 0s infinite normal; }\n  .swal2-popup .swal2-styled {\n    border: 0;\n    border-radius: 3px;\n    -webkit-box-shadow: none;\n            box-shadow: none;\n    color: #fff;\n    cursor: pointer;\n    font-size: 17px;\n    font-weight: 500;\n    margin: 15px 5px 0;\n    padding: 10px 32px; }\n    .swal2-popup .swal2-styled:focus {\n      outline: none;\n      -webkit-box-shadow: 0 0 0 2px #fff, 0 0 0 4px rgba(50, 100, 150, 0.4);\n              box-shadow: 0 0 0 2px #fff, 0 0 0 4px rgba(50, 100, 150, 0.4); }\n  .swal2-popup .swal2-image {\n    margin: 20px auto;\n    max-width: 100%; }\n  .swal2-popup .swal2-close {\n    background: transparent;\n    border: 0;\n    margin: 0;\n    padding: 0;\n    width: 38px;\n    height: 40px;\n    font-size: 36px;\n    line-height: 40px;\n    font-family: serif;\n    position: absolute;\n    top: 5px;\n    right: 8px;\n    cursor: pointer;\n    color: #cccccc;\n    -webkit-transition: color .1s ease;\n    transition: color .1s ease; }\n    .swal2-popup .swal2-close:hover {\n      color: #d55; }\n  .swal2-popup > .swal2-input,\n  .swal2-popup > .swal2-file,\n  .swal2-popup > .swal2-textarea,\n  .swal2-popup > .swal2-select,\n  .swal2-popup > .swal2-radio,\n  .swal2-popup > .swal2-checkbox {\n    display: none; }\n  .swal2-popup .swal2-content {\n    font-size: 18px;\n    text-align: center;\n    font-weight: 300;\n    position: relative;\n    float: none;\n    margin: 0;\n    padding: 0;\n    line-height: normal;\n    color: #545454;\n    word-wrap: break-word; }\n  .swal2-popup .swal2-input,\n  .swal2-popup .swal2-file,\n  .swal2-popup .swal2-textarea,\n  .swal2-popup .swal2-select,\n  .swal2-popup .swal2-radio,\n  .swal2-popup .swal2-checkbox {\n    margin: 20px auto; }\n  .swal2-popup .swal2-input,\n  .swal2-popup .swal2-file,\n  .swal2-popup .swal2-textarea {\n    width: 100%;\n    -webkit-box-sizing: border-box;\n            box-sizing: border-box;\n    font-size: 18px;\n    border-radius: 3px;\n    border: 1px solid #d9d9d9;\n    -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06);\n            box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06);\n    -webkit-transition: border-color .3s, -webkit-box-shadow .3s;\n    transition: border-color .3s, -webkit-box-shadow .3s;\n    transition: border-color .3s, box-shadow .3s;\n    transition: border-color .3s, box-shadow .3s, -webkit-box-shadow .3s; }\n    .swal2-popup .swal2-input.swal2-inputerror,\n    .swal2-popup .swal2-file.swal2-inputerror,\n    .swal2-popup .swal2-textarea.swal2-inputerror {\n      border-color: #f27474 !important;\n      -webkit-box-shadow: 0 0 2px #f27474 !important;\n              box-shadow: 0 0 2px #f27474 !important; }\n    .swal2-popup .swal2-input:focus,\n    .swal2-popup .swal2-file:focus,\n    .swal2-popup .swal2-textarea:focus {\n      outline: none;\n      border: 1px solid #b4dbed;\n      -webkit-box-shadow: 0 0 3px #c4e6f5;\n              box-shadow: 0 0 3px #c4e6f5; }\n    .swal2-popup .swal2-input::-webkit-input-placeholder,\n    .swal2-popup .swal2-file::-webkit-input-placeholder,\n    .swal2-popup .swal2-textarea::-webkit-input-placeholder {\n      color: #cccccc; }\n    .swal2-popup .swal2-input:-ms-input-placeholder,\n    .swal2-popup .swal2-file:-ms-input-placeholder,\n    .swal2-popup .swal2-textarea:-ms-input-placeholder {\n      color: #cccccc; }\n    .swal2-popup .swal2-input::-ms-input-placeholder,\n    .swal2-popup .swal2-file::-ms-input-placeholder,\n    .swal2-popup .swal2-textarea::-ms-input-placeholder {\n      color: #cccccc; }\n    .swal2-popup .swal2-input::placeholder,\n    .swal2-popup .swal2-file::placeholder,\n    .swal2-popup .swal2-textarea::placeholder {\n      color: #cccccc; }\n  .swal2-popup .swal2-range input {\n    float: left;\n    width: 80%; }\n  .swal2-popup .swal2-range output {\n    float: right;\n    width: 20%;\n    font-size: 20px;\n    font-weight: 600;\n    text-align: center; }\n  .swal2-popup .swal2-range input,\n  .swal2-popup .swal2-range output {\n    height: 43px;\n    line-height: 43px;\n    vertical-align: middle;\n    margin: 20px auto;\n    padding: 0; }\n  .swal2-popup .swal2-input {\n    height: 43px;\n    padding: 0 12px; }\n    .swal2-popup .swal2-input[type='number'] {\n      max-width: 150px; }\n  .swal2-popup .swal2-file {\n    font-size: 20px; }\n  .swal2-popup .swal2-textarea {\n    height: 108px;\n    padding: 12px; }\n  .swal2-popup .swal2-select {\n    color: #545454;\n    font-size: inherit;\n    padding: 5px 10px;\n    min-width: 40%;\n    max-width: 100%; }\n  .swal2-popup .swal2-radio {\n    border: 0; }\n    .swal2-popup .swal2-radio label:not(:first-child) {\n      margin-left: 20px; }\n    .swal2-popup .swal2-radio input,\n    .swal2-popup .swal2-radio span {\n      vertical-align: middle; }\n    .swal2-popup .swal2-radio input {\n      margin: 0 3px 0 0; }\n  .swal2-popup .swal2-checkbox {\n    color: #545454; }\n    .swal2-popup .swal2-checkbox input,\n    .swal2-popup .swal2-checkbox span {\n      vertical-align: middle; }\n  .swal2-popup .swal2-validationerror {\n    background-color: #f0f0f0;\n    margin: 0 -20px;\n    overflow: hidden;\n    padding: 10px;\n    color: gray;\n    font-size: 16px;\n    font-weight: 300;\n    display: none; }\n    .swal2-popup .swal2-validationerror::before {\n      content: '!';\n      display: inline-block;\n      width: 24px;\n      height: 24px;\n      border-radius: 50%;\n      background-color: #ea7d7d;\n      color: #fff;\n      line-height: 24px;\n      text-align: center;\n      margin-right: 10px; }\n\n@supports (-ms-accelerator: true) {\n  .swal2-range input {\n    width: 100% !important; }\n  .swal2-range output {\n    display: none; } }\n\n@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {\n  .swal2-range input {\n    width: 100% !important; }\n  .swal2-range output {\n    display: none; } }\n\n.swal2-icon {\n  width: 80px;\n  height: 80px;\n  border: 4px solid transparent;\n  border-radius: 50%;\n  margin: 20px auto 30px;\n  padding: 0;\n  position: relative;\n  -webkit-box-sizing: content-box;\n          box-sizing: content-box;\n  cursor: default;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none; }\n  .swal2-icon.swal2-error {\n    border-color: #f27474; }\n    .swal2-icon.swal2-error .swal2-x-mark {\n      position: relative;\n      display: block; }\n    .swal2-icon.swal2-error [class^='swal2-x-mark-line'] {\n      position: absolute;\n      height: 5px;\n      width: 47px;\n      background-color: #f27474;\n      display: block;\n      top: 37px;\n      border-radius: 2px; }\n      .swal2-icon.swal2-error [class^='swal2-x-mark-line'][class$='left'] {\n        -webkit-transform: rotate(45deg);\n                transform: rotate(45deg);\n        left: 17px; }\n      .swal2-icon.swal2-error [class^='swal2-x-mark-line'][class$='right'] {\n        -webkit-transform: rotate(-45deg);\n                transform: rotate(-45deg);\n        right: 16px; }\n  .swal2-icon.swal2-warning {\n    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;\n    color: #f8bb86;\n    border-color: #facea8;\n    font-size: 60px;\n    line-height: 80px;\n    text-align: center; }\n  .swal2-icon.swal2-info {\n    font-family: 'Open Sans', sans-serif;\n    color: #3fc3ee;\n    border-color: #9de0f6;\n    font-size: 60px;\n    line-height: 80px;\n    text-align: center; }\n  .swal2-icon.swal2-question {\n    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;\n    color: #87adbd;\n    border-color: #c9dae1;\n    font-size: 60px;\n    line-height: 80px;\n    text-align: center; }\n  .swal2-icon.swal2-success {\n    border-color: #a5dc86; }\n    .swal2-icon.swal2-success [class^='swal2-success-circular-line'] {\n      border-radius: 50%;\n      position: absolute;\n      width: 60px;\n      height: 120px;\n      -webkit-transform: rotate(45deg);\n              transform: rotate(45deg); }\n      .swal2-icon.swal2-success [class^='swal2-success-circular-line'][class$='left'] {\n        border-radius: 120px 0 0 120px;\n        top: -7px;\n        left: -33px;\n        -webkit-transform: rotate(-45deg);\n                transform: rotate(-45deg);\n        -webkit-transform-origin: 60px 60px;\n                transform-origin: 60px 60px; }\n      .swal2-icon.swal2-success [class^='swal2-success-circular-line'][class$='right'] {\n        border-radius: 0 120px 120px 0;\n        top: -11px;\n        left: 30px;\n        -webkit-transform: rotate(-45deg);\n                transform: rotate(-45deg);\n        -webkit-transform-origin: 0 60px;\n                transform-origin: 0 60px; }\n    .swal2-icon.swal2-success .swal2-success-ring {\n      width: 80px;\n      height: 80px;\n      border: 4px solid rgba(165, 220, 134, 0.2);\n      border-radius: 50%;\n      -webkit-box-sizing: content-box;\n              box-sizing: content-box;\n      position: absolute;\n      left: -4px;\n      top: -4px;\n      z-index: 2; }\n    .swal2-icon.swal2-success .swal2-success-fix {\n      width: 7px;\n      height: 90px;\n      position: absolute;\n      left: 28px;\n      top: 8px;\n      z-index: 1;\n      -webkit-transform: rotate(-45deg);\n              transform: rotate(-45deg); }\n    .swal2-icon.swal2-success [class^='swal2-success-line'] {\n      height: 5px;\n      background-color: #a5dc86;\n      display: block;\n      border-radius: 2px;\n      position: absolute;\n      z-index: 2; }\n      .swal2-icon.swal2-success [class^='swal2-success-line'][class$='tip'] {\n        width: 25px;\n        left: 14px;\n        top: 46px;\n        -webkit-transform: rotate(45deg);\n                transform: rotate(45deg); }\n      .swal2-icon.swal2-success [class^='swal2-success-line'][class$='long'] {\n        width: 47px;\n        right: 8px;\n        top: 38px;\n        -webkit-transform: rotate(-45deg);\n                transform: rotate(-45deg); }\n\n.swal2-progresssteps {\n  font-weight: 600;\n  margin: 0 0 20px;\n  padding: 0; }\n  .swal2-progresssteps li {\n    display: inline-block;\n    position: relative; }\n  .swal2-progresssteps .swal2-progresscircle {\n    background: #3085d6;\n    border-radius: 2em;\n    color: #fff;\n    height: 2em;\n    line-height: 2em;\n    text-align: center;\n    width: 2em;\n    z-index: 20; }\n    .swal2-progresssteps .swal2-progresscircle:first-child {\n      margin-left: 0; }\n    .swal2-progresssteps .swal2-progresscircle:last-child {\n      margin-right: 0; }\n    .swal2-progresssteps .swal2-progresscircle.swal2-activeprogressstep {\n      background: #3085d6; }\n      .swal2-progresssteps .swal2-progresscircle.swal2-activeprogressstep ~ .swal2-progresscircle {\n        background: #add8e6; }\n      .swal2-progresssteps .swal2-progresscircle.swal2-activeprogressstep ~ .swal2-progressline {\n        background: #add8e6; }\n  .swal2-progresssteps .swal2-progressline {\n    background: #3085d6;\n    height: .4em;\n    margin: 0 -1px;\n    z-index: 10; }\n\n[class^='swal2'] {\n  -webkit-tap-highlight-color: transparent; }\n\n@-webkit-keyframes showSweetToast {\n  0% {\n    -webkit-transform: translateY(-10px) rotateZ(2deg);\n            transform: translateY(-10px) rotateZ(2deg);\n    opacity: 0; }\n  33% {\n    -webkit-transform: translateY(0) rotateZ(-2deg);\n            transform: translateY(0) rotateZ(-2deg);\n    opacity: .5; }\n  66% {\n    -webkit-transform: translateY(5px) rotateZ(2deg);\n            transform: translateY(5px) rotateZ(2deg);\n    opacity: .7; }\n  100% {\n    -webkit-transform: translateY(0) rotateZ(0);\n            transform: translateY(0) rotateZ(0);\n    opacity: 1; } }\n\n@keyframes showSweetToast {\n  0% {\n    -webkit-transform: translateY(-10px) rotateZ(2deg);\n            transform: translateY(-10px) rotateZ(2deg);\n    opacity: 0; }\n  33% {\n    -webkit-transform: translateY(0) rotateZ(-2deg);\n            transform: translateY(0) rotateZ(-2deg);\n    opacity: .5; }\n  66% {\n    -webkit-transform: translateY(5px) rotateZ(2deg);\n            transform: translateY(5px) rotateZ(2deg);\n    opacity: .7; }\n  100% {\n    -webkit-transform: translateY(0) rotateZ(0);\n            transform: translateY(0) rotateZ(0);\n    opacity: 1; } }\n\n@-webkit-keyframes hideSweetToast {\n  0% {\n    opacity: 1; }\n  33% {\n    opacity: .5; }\n  100% {\n    -webkit-transform: rotateZ(1deg);\n            transform: rotateZ(1deg);\n    opacity: 0; } }\n\n@keyframes hideSweetToast {\n  0% {\n    opacity: 1; }\n  33% {\n    opacity: .5; }\n  100% {\n    -webkit-transform: rotateZ(1deg);\n            transform: rotateZ(1deg);\n    opacity: 0; } }\n\n@-webkit-keyframes showSweetAlert {\n  0% {\n    -webkit-transform: scale(0.7);\n            transform: scale(0.7); }\n  45% {\n    -webkit-transform: scale(1.05);\n            transform: scale(1.05); }\n  80% {\n    -webkit-transform: scale(0.95);\n            transform: scale(0.95); }\n  100% {\n    -webkit-transform: scale(1);\n            transform: scale(1); } }\n\n@keyframes showSweetAlert {\n  0% {\n    -webkit-transform: scale(0.7);\n            transform: scale(0.7); }\n  45% {\n    -webkit-transform: scale(1.05);\n            transform: scale(1.05); }\n  80% {\n    -webkit-transform: scale(0.95);\n            transform: scale(0.95); }\n  100% {\n    -webkit-transform: scale(1);\n            transform: scale(1); } }\n\n@-webkit-keyframes hideSweetAlert {\n  0% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n    opacity: 1; }\n  100% {\n    -webkit-transform: scale(0.5);\n            transform: scale(0.5);\n    opacity: 0; } }\n\n@keyframes hideSweetAlert {\n  0% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n    opacity: 1; }\n  100% {\n    -webkit-transform: scale(0.5);\n            transform: scale(0.5);\n    opacity: 0; } }\n\n.swal2-show {\n  -webkit-animation: showSweetAlert .3s;\n          animation: showSweetAlert .3s; }\n  .swal2-show.swal2-toast {\n    -webkit-animation: showSweetToast .5s;\n            animation: showSweetToast .5s; }\n  .swal2-show.swal2-noanimation {\n    -webkit-animation: none;\n            animation: none; }\n\n.swal2-hide {\n  -webkit-animation: hideSweetAlert .15s forwards;\n          animation: hideSweetAlert .15s forwards; }\n  .swal2-hide.swal2-toast {\n    -webkit-animation: hideSweetToast .2s forwards;\n            animation: hideSweetToast .2s forwards; }\n  .swal2-hide.swal2-noanimation {\n    -webkit-animation: none;\n            animation: none; }\n\n@-webkit-keyframes animate-success-tip {\n  0% {\n    width: 0;\n    left: 1px;\n    top: 19px; }\n  54% {\n    width: 0;\n    left: 1px;\n    top: 19px; }\n  70% {\n    width: 50px;\n    left: -8px;\n    top: 37px; }\n  84% {\n    width: 17px;\n    left: 21px;\n    top: 48px; }\n  100% {\n    width: 25px;\n    left: 14px;\n    top: 45px; } }\n\n@keyframes animate-success-tip {\n  0% {\n    width: 0;\n    left: 1px;\n    top: 19px; }\n  54% {\n    width: 0;\n    left: 1px;\n    top: 19px; }\n  70% {\n    width: 50px;\n    left: -8px;\n    top: 37px; }\n  84% {\n    width: 17px;\n    left: 21px;\n    top: 48px; }\n  100% {\n    width: 25px;\n    left: 14px;\n    top: 45px; } }\n\n@-webkit-keyframes animate-success-long {\n  0% {\n    width: 0;\n    right: 46px;\n    top: 54px; }\n  65% {\n    width: 0;\n    right: 46px;\n    top: 54px; }\n  84% {\n    width: 55px;\n    right: 0;\n    top: 35px; }\n  100% {\n    width: 47px;\n    right: 8px;\n    top: 38px; } }\n\n@keyframes animate-success-long {\n  0% {\n    width: 0;\n    right: 46px;\n    top: 54px; }\n  65% {\n    width: 0;\n    right: 46px;\n    top: 54px; }\n  84% {\n    width: 55px;\n    right: 0;\n    top: 35px; }\n  100% {\n    width: 47px;\n    right: 8px;\n    top: 38px; } }\n\n@-webkit-keyframes animate-toast-success-tip {\n  0% {\n    width: 0;\n    left: 1px;\n    top: 9px; }\n  54% {\n    width: 0;\n    left: 1px;\n    top: 9px; }\n  70% {\n    width: 24px;\n    left: -4px;\n    top: 17px; }\n  84% {\n    width: 8px;\n    left: 10px;\n    top: 20px; }\n  100% {\n    width: 12px;\n    left: 3px;\n    top: 18px; } }\n\n@keyframes animate-toast-success-tip {\n  0% {\n    width: 0;\n    left: 1px;\n    top: 9px; }\n  54% {\n    width: 0;\n    left: 1px;\n    top: 9px; }\n  70% {\n    width: 24px;\n    left: -4px;\n    top: 17px; }\n  84% {\n    width: 8px;\n    left: 10px;\n    top: 20px; }\n  100% {\n    width: 12px;\n    left: 3px;\n    top: 18px; } }\n\n@-webkit-keyframes animate-toast-success-long {\n  0% {\n    width: 0;\n    right: 22px;\n    top: 26px; }\n  65% {\n    width: 0;\n    right: 22px;\n    top: 26px; }\n  84% {\n    width: 26px;\n    right: 0;\n    top: 15px; }\n  100% {\n    width: 22px;\n    right: 3px;\n    top: 15px; } }\n\n@keyframes animate-toast-success-long {\n  0% {\n    width: 0;\n    right: 22px;\n    top: 26px; }\n  65% {\n    width: 0;\n    right: 22px;\n    top: 26px; }\n  84% {\n    width: 26px;\n    right: 0;\n    top: 15px; }\n  100% {\n    width: 22px;\n    right: 3px;\n    top: 15px; } }\n\n@-webkit-keyframes rotatePlaceholder {\n  0% {\n    -webkit-transform: rotate(-45deg);\n            transform: rotate(-45deg); }\n  5% {\n    -webkit-transform: rotate(-45deg);\n            transform: rotate(-45deg); }\n  12% {\n    -webkit-transform: rotate(-405deg);\n            transform: rotate(-405deg); }\n  100% {\n    -webkit-transform: rotate(-405deg);\n            transform: rotate(-405deg); } }\n\n@keyframes rotatePlaceholder {\n  0% {\n    -webkit-transform: rotate(-45deg);\n            transform: rotate(-45deg); }\n  5% {\n    -webkit-transform: rotate(-45deg);\n            transform: rotate(-45deg); }\n  12% {\n    -webkit-transform: rotate(-405deg);\n            transform: rotate(-405deg); }\n  100% {\n    -webkit-transform: rotate(-405deg);\n            transform: rotate(-405deg); } }\n\n.swal2-animate-success-line-tip {\n  -webkit-animation: animate-success-tip .75s;\n          animation: animate-success-tip .75s; }\n\n.swal2-animate-success-line-long {\n  -webkit-animation: animate-success-long .75s;\n          animation: animate-success-long .75s; }\n\n.swal2-success.swal2-animate-success-icon .swal2-success-circular-line-right {\n  -webkit-animation: rotatePlaceholder 4.25s ease-in;\n          animation: rotatePlaceholder 4.25s ease-in; }\n\n@-webkit-keyframes animate-error-icon {\n  0% {\n    -webkit-transform: rotateX(100deg);\n            transform: rotateX(100deg);\n    opacity: 0; }\n  100% {\n    -webkit-transform: rotateX(0deg);\n            transform: rotateX(0deg);\n    opacity: 1; } }\n\n@keyframes animate-error-icon {\n  0% {\n    -webkit-transform: rotateX(100deg);\n            transform: rotateX(100deg);\n    opacity: 0; }\n  100% {\n    -webkit-transform: rotateX(0deg);\n            transform: rotateX(0deg);\n    opacity: 1; } }\n\n.swal2-animate-error-icon {\n  -webkit-animation: animate-error-icon .5s;\n          animation: animate-error-icon .5s; }\n\n@-webkit-keyframes animate-x-mark {\n  0% {\n    -webkit-transform: scale(0.4);\n            transform: scale(0.4);\n    margin-top: 26px;\n    opacity: 0; }\n  50% {\n    -webkit-transform: scale(0.4);\n            transform: scale(0.4);\n    margin-top: 26px;\n    opacity: 0; }\n  80% {\n    -webkit-transform: scale(1.15);\n            transform: scale(1.15);\n    margin-top: -6px; }\n  100% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n    margin-top: 0;\n    opacity: 1; } }\n\n@keyframes animate-x-mark {\n  0% {\n    -webkit-transform: scale(0.4);\n            transform: scale(0.4);\n    margin-top: 26px;\n    opacity: 0; }\n  50% {\n    -webkit-transform: scale(0.4);\n            transform: scale(0.4);\n    margin-top: 26px;\n    opacity: 0; }\n  80% {\n    -webkit-transform: scale(1.15);\n            transform: scale(1.15);\n    margin-top: -6px; }\n  100% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n    margin-top: 0;\n    opacity: 1; } }\n\n.swal2-animate-x-mark {\n  -webkit-animation: animate-x-mark .5s;\n          animation: animate-x-mark .5s; }\n\n@-webkit-keyframes rotate-loading {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg); }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg); } }\n\n@keyframes rotate-loading {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg); }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg); } }\n";

var defaultParams = {
  title: '',
  titleText: '',
  text: '',
  html: '',
  type: null,
  toast: false,
  customClass: '',
  target: 'body',
  backdrop: true,
  animation: true,
  allowOutsideClick: true,
  allowEscapeKey: true,
  allowEnterKey: true,
  showConfirmButton: true,
  showCancelButton: false,
  preConfirm: null,
  confirmButtonText: 'OK',
  confirmButtonAriaLabel: '',
  confirmButtonColor: '#3085d6',
  confirmButtonClass: null,
  cancelButtonText: 'Cancel',
  cancelButtonAriaLabel: '',
  cancelButtonColor: '#aaa',
  cancelButtonClass: null,
  buttonsStyling: true,
  reverseButtons: false,
  focusConfirm: true,
  focusCancel: false,
  showCloseButton: false,
  closeButtonAriaLabel: 'Close this dialog',
  showLoaderOnConfirm: false,
  imageUrl: null,
  imageWidth: null,
  imageHeight: null,
  imageAlt: '',
  imageClass: null,
  timer: null,
  width: 500,
  padding: 20,
  background: '#fff',
  input: null,
  inputPlaceholder: '',
  inputValue: '',
  inputOptions: {},
  inputAutoTrim: true,
  inputClass: null,
  inputAttributes: {},
  inputValidator: null,
  grow: false,
  position: 'center',
  progressSteps: [],
  currentProgressStep: null,
  progressStepsDistance: '40px',
  onBeforeOpen: null,
  onOpen: null,
  onClose: null,
  useRejections: false,
  expectRejections: false
};

var deprecatedParams = ['useRejections', 'expectRejections'];

var swalPrefix = 'swal2-';

var prefix = function prefix(items) {
  var result = {};
  for (var i in items) {
    result[items[i]] = swalPrefix + items[i];
  }
  return result;
};

var swalClasses = prefix(['container', 'shown', 'iosfix', 'popup', 'modal', 'no-backdrop', 'toast', 'toast-shown', 'overlay', 'fade', 'show', 'hide', 'noanimation', 'close', 'title', 'content', 'contentwrapper', 'buttonswrapper', 'confirm', 'cancel', 'icon', 'image', 'input', 'has-input', 'file', 'range', 'select', 'radio', 'checkbox', 'textarea', 'inputerror', 'validationerror', 'progresssteps', 'activeprogressstep', 'progresscircle', 'progressline', 'loading', 'styled', 'top', 'top-left', 'top-right', 'center', 'center-left', 'center-right', 'bottom', 'bottom-left', 'bottom-right', 'grow-row', 'grow-column', 'grow-fullscreen']);

var iconTypes = prefix(['success', 'warning', 'info', 'question', 'error']);

var consolePrefix = 'SweetAlert2:';

/*
 * Set hover, active and focus-states for buttons (source: http://www.sitepoint.com/javascript-generate-lighter-darker-color)
 */
var colorLuminance = function colorLuminance(hex, lum) {
  // Validate hex string
  hex = String(hex).replace(/[^0-9a-f]/gi, '');
  if (hex.length < 6) {
    hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];
  }
  lum = lum || 0;

  // Convert to decimal and change luminosity
  var rgb = '#';
  for (var i = 0; i < 3; i++) {
    var c = parseInt(hex.substr(i * 2, 2), 16);
    c = Math.round(Math.min(Math.max(0, c + c * lum), 255)).toString(16);
    rgb += ('00' + c).substr(c.length);
  }

  return rgb;
};

/**
 * Check if variable exists
 * @param variable
 */
var isDefined = function isDefined(variable) {
  return typeof variable !== 'undefined';
};

/**
 * Filter the unique values into a new array
 * @param arr
 */
var uniqueArray = function uniqueArray(arr) {
  var result = [];
  for (var i in arr) {
    if (result.indexOf(arr[i]) === -1) {
      result.push(arr[i]);
    }
  }
  return result;
};

/**
 * Standardise console warnings
 * @param message
 */
var warn = function warn(message) {
  console.warn(consolePrefix + ' ' + message);
};

/**
 * Standardise console errors
 * @param message
 */
var error = function error(message) {
  console.error(consolePrefix + ' ' + message);
};

/**
 * Private global state for `warnOnce`
 * @type {Array}
 * @private
 */
var previousWarnOnceMessages = [];

/**
 * Show a console warning, but only if it hasn't already been shown
 * @param message
 */
var warnOnce = function warnOnce(message) {
  if (!(previousWarnOnceMessages.indexOf(message) !== -1)) {
    previousWarnOnceMessages.push(message);
    warn(message);
  }
};

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) {
  return typeof obj;
} : function (obj) {
  return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
};





















var _extends = Object.assign || function (target) {
  for (var i = 1; i < arguments.length; i++) {
    var source = arguments[i];

    for (var key in source) {
      if (Object.prototype.hasOwnProperty.call(source, key)) {
        target[key] = source[key];
      }
    }
  }

  return target;
};

var popupParams = _extends({}, defaultParams);
var queue = [];

var previousWindowKeyDown = void 0;
var windowOnkeydownOverridden = void 0;

/*
 * Check for the existence of Promise
 * Hopefully to avoid many github issues
 */
if (!isDefined(Promise)) {
  error('This package requires a Promise library, please include a shim to enable it in this browser (See: https://github.com/limonte/sweetalert2/wiki/Migration-from-SweetAlert-to-SweetAlert2#1-ie-support)');
}

/**
 * Show relevant warnings for given params
 *
 * @param params
 */
var showWarningsForParams = function showWarningsForParams(params) {
  for (var param in params) {
    if (!sweetAlert$1.isValidParameter(param)) {
      warn('Unknown parameter "' + param + '"');
    }
    if (sweetAlert$1.isDeprecatedParameter(param)) {
      warnOnce('The parameter "' + param + '" is deprecated and will be removed in the next major release.');
    }
  }
};

/**
 * Set type, text and actions on popup
 *
 * @param params
 * @returns {boolean}
 */
var setParameters = function setParameters(params) {
  // If a custom element is set, determine if it is valid
  if (typeof params.target === 'string' && !document.querySelector(params.target) || typeof params.target !== 'string' && !params.target.appendChild) {
    warn('Target parameter is not valid, defaulting to "body"');
    params.target = 'body';
  }

  var popup = void 0;
  var oldPopup = getPopup();
  var targetElement = typeof params.target === 'string' ? document.querySelector(params.target) : params.target;
  // If the model target has changed, refresh the popup
  if (oldPopup && targetElement && oldPopup.parentNode !== targetElement.parentNode) {
    popup = init(params);
  } else {
    popup = oldPopup || init(params);
  }

  // Set popup width
  var popupWidth = params.width === defaultParams.width && params.toast ? 'auto' : params.width;
  popup.style.width = typeof popupWidth === 'number' ? popupWidth + 'px' : popupWidth;

  var popupPadding = params.padding === defaultParams.padding && params.toast ? 'inherit' : params.padding;
  popup.style.padding = typeof popupPadding === 'number' ? popupPadding + 'px' : popupPadding;
  popup.style.background = params.background;
  var successIconParts = popup.querySelectorAll('[class^=swal2-success-circular-line], .swal2-success-fix');
  for (var i = 0; i < successIconParts.length; i++) {
    successIconParts[i].style.background = params.background;
  }

  var container = getContainer();
  var title = getTitle();
  var content = getContent();
  var buttonsWrapper = getButtonsWrapper();
  var confirmButton = getConfirmButton();
  var cancelButton = getCancelButton();
  var closeButton = getCloseButton();

  // Title
  if (params.titleText) {
    title.innerText = params.titleText;
  } else {
    title.innerHTML = params.title.split('\n').join('<br />');
  }

  if (!params.backdrop) {
    addClass(document.body, swalClasses['no-backdrop']);
  }

  // Content
  if (params.text || params.html) {
    if (_typeof(params.html) === 'object') {
      content.innerHTML = '';
      if (0 in params.html) {
        for (var _i = 0; _i in params.html; _i++) {
          content.appendChild(params.html[_i].cloneNode(true));
        }
      } else {
        content.appendChild(params.html.cloneNode(true));
      }
    } else if (params.html) {
      content.innerHTML = params.html;
    } else if (params.text) {
      content.textContent = params.text;
    }
    show(content);
  } else {
    hide(content);
  }

  // Position
  if (params.position in swalClasses) {
    addClass(container, swalClasses[params.position]);
  }

  // Grow
  if (params.grow && typeof params.grow === 'string') {
    var growClass = 'grow-' + params.grow;
    if (growClass in swalClasses) {
      addClass(container, swalClasses[growClass]);
    }
  }

  // Close button
  if (params.showCloseButton) {
    closeButton.setAttribute('aria-label', params.closeButtonAriaLabel);
    show(closeButton);
  } else {
    hide(closeButton);
  }

  // Default Class
  popup.className = swalClasses.popup;
  if (params.toast) {
    addClass(document.body, swalClasses['toast-shown']);
    addClass(popup, swalClasses.toast);
  } else {
    addClass(popup, swalClasses.modal);
  }

  // Custom Class
  if (params.customClass) {
    addClass(popup, params.customClass);
  }

  // Progress steps
  var progressStepsContainer = getProgressSteps();
  var currentProgressStep = parseInt(params.currentProgressStep === null ? sweetAlert$1.getQueueStep() : params.currentProgressStep, 10);
  if (params.progressSteps.length) {
    show(progressStepsContainer);
    empty(progressStepsContainer);
    if (currentProgressStep >= params.progressSteps.length) {
      warn('Invalid currentProgressStep parameter, it should be less than progressSteps.length ' + '(currentProgressStep like JS arrays starts from 0)');
    }
    params.progressSteps.forEach(function (step, index) {
      var circle = document.createElement('li');
      addClass(circle, swalClasses.progresscircle);
      circle.innerHTML = step;
      if (index === currentProgressStep) {
        addClass(circle, swalClasses.activeprogressstep);
      }
      progressStepsContainer.appendChild(circle);
      if (index !== params.progressSteps.length - 1) {
        var line = document.createElement('li');
        addClass(line, swalClasses.progressline);
        line.style.width = params.progressStepsDistance;
        progressStepsContainer.appendChild(line);
      }
    });
  } else {
    hide(progressStepsContainer);
  }

  // Icon
  var icons = getIcons();
  for (var _i2 = 0; _i2 < icons.length; _i2++) {
    hide(icons[_i2]);
  }
  if (params.type) {
    var validType = false;
    for (var iconType in iconTypes) {
      if (params.type === iconType) {
        validType = true;
        break;
      }
    }
    if (!validType) {
      error('Unknown alert type: ' + params.type);
      return false;
    }
    var icon = popup.querySelector('.' + swalClasses.icon + '.' + iconTypes[params.type]);
    show(icon);

    // Animate icon
    if (params.animation) {
      switch (params.type) {
        case 'success':
          addClass(icon, 'swal2-animate-success-icon');
          addClass(icon.querySelector('.swal2-success-line-tip'), 'swal2-animate-success-line-tip');
          addClass(icon.querySelector('.swal2-success-line-long'), 'swal2-animate-success-line-long');
          break;
        case 'error':
          addClass(icon, 'swal2-animate-error-icon');
          addClass(icon.querySelector('.swal2-x-mark'), 'swal2-animate-x-mark');
          break;
        default:
          break;
      }
    }
  }

  // Custom image
  var image = getImage();
  if (params.imageUrl) {
    image.setAttribute('src', params.imageUrl);
    image.setAttribute('alt', params.imageAlt);
    show(image);

    if (params.imageWidth) {
      image.setAttribute('width', params.imageWidth);
    } else {
      image.removeAttribute('width');
    }

    if (params.imageHeight) {
      image.setAttribute('height', params.imageHeight);
    } else {
      image.removeAttribute('height');
    }

    image.className = swalClasses.image;
    if (params.imageClass) {
      addClass(image, params.imageClass);
    }
  } else {
    hide(image);
  }

  // Cancel button
  if (params.showCancelButton) {
    cancelButton.style.display = 'inline-block';
  } else {
    hide(cancelButton);
  }

  // Confirm button
  if (params.showConfirmButton) {
    removeStyleProperty(confirmButton, 'display');
  } else {
    hide(confirmButton);
  }

  // Buttons wrapper
  if (!params.showConfirmButton && !params.showCancelButton) {
    hide(buttonsWrapper);
  } else {
    show(buttonsWrapper);
  }

  // Edit text on confirm and cancel buttons
  confirmButton.innerHTML = params.confirmButtonText;
  cancelButton.innerHTML = params.cancelButtonText;

  // ARIA labels for confirm and cancel buttons
  confirmButton.setAttribute('aria-label', params.confirmButtonAriaLabel);
  cancelButton.setAttribute('aria-label', params.cancelButtonAriaLabel);

  // Set buttons to selected background colors
  if (params.buttonsStyling) {
    confirmButton.style.backgroundColor = params.confirmButtonColor;
    cancelButton.style.backgroundColor = params.cancelButtonColor;
  }

  // Add buttons custom classes
  confirmButton.className = swalClasses.confirm;
  addClass(confirmButton, params.confirmButtonClass);
  cancelButton.className = swalClasses.cancel;
  addClass(cancelButton, params.cancelButtonClass);

  // Buttons styling
  if (params.buttonsStyling) {
    addClass(confirmButton, swalClasses.styled);
    addClass(cancelButton, swalClasses.styled);
  } else {
    removeClass(confirmButton, swalClasses.styled);
    removeClass(cancelButton, swalClasses.styled);

    confirmButton.style.backgroundColor = confirmButton.style.borderLeftColor = confirmButton.style.borderRightColor = '';
    cancelButton.style.backgroundColor = cancelButton.style.borderLeftColor = cancelButton.style.borderRightColor = '';
  }

  // CSS animation
  if (params.animation === true) {
    removeClass(popup, swalClasses.noanimation);
  } else {
    addClass(popup, swalClasses.noanimation);
  }

  // showLoaderOnConfirm && preConfirm
  if (params.showLoaderOnConfirm && !params.preConfirm) {
    warn('showLoaderOnConfirm is set to true, but preConfirm is not defined.\n' + 'showLoaderOnConfirm should be used together with preConfirm, see usage example:\n' + 'https://limonte.github.io/sweetalert2/#ajax-request');
  }
};

/**
 * Animations
 *
 * @param animation
 * @param onBeforeOpen
 * @param onComplete
 */
var openPopup = function openPopup(animation, onBeforeOpen, onComplete) {
  var container = getContainer();
  var popup = getPopup();

  if (onBeforeOpen !== null && typeof onBeforeOpen === 'function') {
    onBeforeOpen(popup);
  }

  if (animation) {
    addClass(popup, swalClasses.show);
    addClass(container, swalClasses.fade);
    removeClass(popup, swalClasses.hide);
  } else {
    removeClass(popup, swalClasses.fade);
  }
  show(popup);

  // scrolling is 'hidden' until animation is done, after that 'auto'
  container.style.overflowY = 'hidden';
  if (animationEndEvent && !hasClass(popup, swalClasses.noanimation)) {
    popup.addEventListener(animationEndEvent, function swalCloseEventFinished() {
      popup.removeEventListener(animationEndEvent, swalCloseEventFinished);
      container.style.overflowY = 'auto';
    });
  } else {
    container.style.overflowY = 'auto';
  }

  addClass(document.documentElement, swalClasses.shown);
  addClass(document.body, swalClasses.shown);
  addClass(container, swalClasses.shown);
  if (isModal()) {
    fixScrollbar();
    iOSfix();
  }
  states.previousActiveElement = document.activeElement;
  if (onComplete !== null && typeof onComplete === 'function') {
    setTimeout(function () {
      onComplete(popup);
    });
  }
};

var fixScrollbar = function fixScrollbar() {
  // for queues, do not do this more than once
  if (states.previousBodyPadding !== null) {
    return;
  }
  // if the body has overflow
  if (document.body.scrollHeight > window.innerHeight) {
    // add padding so the content doesn't shift after removal of scrollbar
    states.previousBodyPadding = document.body.style.paddingRight;
    document.body.style.paddingRight = measureScrollbar() + 'px';
  }
};

var undoScrollbar = function undoScrollbar() {
  if (states.previousBodyPadding !== null) {
    document.body.style.paddingRight = states.previousBodyPadding;
    states.previousBodyPadding = null;
  }
};

// Fix iOS scrolling http://stackoverflow.com/q/39626302/1331425
var iOSfix = function iOSfix() {
  var iOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
  if (iOS && !hasClass(document.body, swalClasses.iosfix)) {
    var offset = document.body.scrollTop;
    document.body.style.top = offset * -1 + 'px';
    addClass(document.body, swalClasses.iosfix);
  }
};

var undoIOSfix = function undoIOSfix() {
  if (hasClass(document.body, swalClasses.iosfix)) {
    var offset = parseInt(document.body.style.top, 10);
    removeClass(document.body, swalClasses.iosfix);
    document.body.style.top = '';
    document.body.scrollTop = offset * -1;
  }
};

// SweetAlert entry point
var sweetAlert$1 = function sweetAlert() {
  for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }

  // Prevent run in Node env
  if (!isDefined(window)) {
    return;
  }

  if (!isDefined(args[0])) {
    error('SweetAlert2 expects at least 1 attribute!');
    return false;
  }

  var params = _extends({}, popupParams);

  switch (_typeof(args[0])) {
    case 'string':
      params.title = args[0];
      params.html = args[1];
      params.type = args[2];

      break;

    case 'object':
      showWarningsForParams(args[0]);
      _extends(params, args[0]);
      params.extraParams = args[0].extraParams;

      if (params.input === 'email' && params.inputValidator === null) {
        var inputValidator = function inputValidator(email) {
          return new Promise(function (resolve, reject) {
            var emailRegex = /^[a-zA-Z0-9.+_-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]{2,24}$/;
            if (emailRegex.test(email)) {
              resolve();
            } else {
              reject('Invalid email address');
            }
          });
        };
        params.inputValidator = params.expectRejections ? inputValidator : sweetAlert.adaptInputValidator(inputValidator);
      }

      if (params.input === 'url' && params.inputValidator === null) {
        var _inputValidator = function _inputValidator(url) {
          return new Promise(function (resolve, reject) {
            // taken from https://stackoverflow.com/a/3809435/1331425
            var urlRegex = /^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)$/;
            if (urlRegex.test(url)) {
              resolve();
            } else {
              reject('Invalid URL');
            }
          });
        };
        params.inputValidator = params.expectRejections ? _inputValidator : sweetAlert.adaptInputValidator(_inputValidator);
      }
      break;

    default:
      error('Unexpected type of argument! Expected "string" or "object", got ' + _typeof(args[0]));
      return false;
  }

  setParameters(params);

  var container = getContainer();
  var popup = getPopup();

  return new Promise(function (resolve, reject) {
    // functions to handle all resolving/rejecting/settling
    var succeedWith = function succeedWith(value) {
      sweetAlert.closePopup(params.onClose);
      if (params.useRejections) {
        resolve(value);
      } else {
        resolve({ value: value });
      }
    };
    var dismissWith = function dismissWith(dismiss) {
      sweetAlert.closePopup(params.onClose);
      if (params.useRejections) {
        reject(dismiss);
      } else {
        resolve({ dismiss: dismiss });
      }
    };
    var errorWith = function errorWith(error$$1) {
      sweetAlert.closePopup(params.onClose);
      reject(error$$1);
    };

    // Close on timer
    if (params.timer) {
      popup.timeout = setTimeout(function () {
        return dismissWith('timer');
      }, params.timer);
    }

    // Get input element by specified type or, if type isn't specified, by params.input
    var getInput = function getInput(inputType) {
      inputType = inputType || params.input;
      if (!inputType) {
        return null;
      }
      switch (inputType) {
        case 'select':
        case 'textarea':
        case 'file':
          return getChildByClass(popup, swalClasses[inputType]);
        case 'checkbox':
          return popup.querySelector('.' + swalClasses.checkbox + ' input');
        case 'radio':
          return popup.querySelector('.' + swalClasses.radio + ' input:checked') || popup.querySelector('.' + swalClasses.radio + ' input:first-child');
        case 'range':
          return popup.querySelector('.' + swalClasses.range + ' input');
        default:
          return getChildByClass(popup, swalClasses.input);
      }
    };

    // Get the value of the popup input
    var getInputValue = function getInputValue() {
      var input = getInput();
      if (!input) {
        return null;
      }
      switch (params.input) {
        case 'checkbox':
          return input.checked ? 1 : 0;
        case 'radio':
          return input.checked ? input.value : null;
        case 'file':
          return input.files.length ? input.files[0] : null;
        default:
          return params.inputAutoTrim ? input.value.trim() : input.value;
      }
    };

    // input autofocus
    if (params.input) {
      setTimeout(function () {
        var input = getInput();
        if (input) {
          focusInput(input);
        }
      }, 0);
    }

    var confirm = function confirm(value) {
      if (params.showLoaderOnConfirm) {
        sweetAlert.showLoading();
      }

      if (params.preConfirm) {
        var preConfirmPromise = Promise.resolve().then(function () {
          return params.preConfirm(value, params.extraParams);
        });
        if (params.expectRejections) {
          preConfirmPromise.then(function (preConfirmValue) {
            return succeedWith(preConfirmValue || value);
          }, function (validationError) {
            sweetAlert.hideLoading();
            if (validationError) {
              sweetAlert.showValidationError(validationError);
            }
          });
        } else {
          preConfirmPromise.then(function (preConfirmValue) {
            if (isVisible(getValidationError())) {
              sweetAlert.hideLoading();
            } else {
              succeedWith(preConfirmValue || value);
            }
          }, function (error$$1) {
            return errorWith(error$$1);
          });
        }
      } else {
        succeedWith(value);
      }
    };

    // Mouse interactions
    var onButtonEvent = function onButtonEvent(event) {
      var e = event || window.event;
      var target = e.target || e.srcElement;
      var confirmButton = getConfirmButton();
      var cancelButton = getCancelButton();
      var targetedConfirm = confirmButton && (confirmButton === target || confirmButton.contains(target));
      var targetedCancel = cancelButton && (cancelButton === target || cancelButton.contains(target));

      switch (e.type) {
        case 'mouseover':
        case 'mouseup':
          if (params.buttonsStyling) {
            if (targetedConfirm) {
              confirmButton.style.backgroundColor = colorLuminance(params.confirmButtonColor, -0.1);
            } else if (targetedCancel) {
              cancelButton.style.backgroundColor = colorLuminance(params.cancelButtonColor, -0.1);
            }
          }
          break;
        case 'mouseout':
          if (params.buttonsStyling) {
            if (targetedConfirm) {
              confirmButton.style.backgroundColor = params.confirmButtonColor;
            } else if (targetedCancel) {
              cancelButton.style.backgroundColor = params.cancelButtonColor;
            }
          }
          break;
        case 'mousedown':
          if (params.buttonsStyling) {
            if (targetedConfirm) {
              confirmButton.style.backgroundColor = colorLuminance(params.confirmButtonColor, -0.2);
            } else if (targetedCancel) {
              cancelButton.style.backgroundColor = colorLuminance(params.cancelButtonColor, -0.2);
            }
          }
          break;
        case 'click':
          // Clicked 'confirm'
          if (targetedConfirm && sweetAlert.isVisible()) {
            sweetAlert.disableButtons();
            if (params.input) {
              var inputValue = getInputValue();

              if (params.inputValidator) {
                sweetAlert.disableInput();
                var validationPromise = Promise.resolve().then(function () {
                  return params.inputValidator(inputValue, params.extraParams);
                });
                if (params.expectRejections) {
                  validationPromise.then(function () {
                    sweetAlert.enableButtons();
                    sweetAlert.enableInput();
                    confirm(inputValue);
                  }, function (validationError) {
                    sweetAlert.enableButtons();
                    sweetAlert.enableInput();
                    if (validationError) {
                      sweetAlert.showValidationError(validationError);
                    }
                  });
                } else {
                  validationPromise.then(function (validationError) {
                    sweetAlert.enableButtons();
                    sweetAlert.enableInput();
                    if (validationError) {
                      sweetAlert.showValidationError(validationError);
                    } else {
                      confirm(inputValue);
                    }
                  }, function (error$$1) {
                    return errorWith(error$$1);
                  });
                }
              } else {
                confirm(inputValue);
              }
            } else {
              confirm(true);
            }

            // Clicked 'cancel'
          } else if (targetedCancel && sweetAlert.isVisible()) {
            sweetAlert.disableButtons();
            dismissWith('cancel');
          }
          break;
        default:
      }
    };

    var buttons = popup.querySelectorAll('button');
    for (var i = 0; i < buttons.length; i++) {
      buttons[i].onclick = onButtonEvent;
      buttons[i].onmouseover = onButtonEvent;
      buttons[i].onmouseout = onButtonEvent;
      buttons[i].onmousedown = onButtonEvent;
    }

    // Closing popup by close button
    getCloseButton().onclick = function () {
      dismissWith('close');
    };

    if (params.toast) {
      // Closing popup by overlay click
      popup.onclick = function (e) {
        if (e.target !== popup || params.showConfirmButton || params.showCancelButton) {
          return;
        }
        if (params.allowOutsideClick) {
          sweetAlert.closePopup(params.onClose);
          dismissWith('overlay');
        }
      };
    } else {
      container.onclick = function (e) {
        if (e.target !== container) {
          return;
        }
        if (params.allowOutsideClick) {
          dismissWith('overlay');
        }
      };
    }

    var buttonsWrapper = getButtonsWrapper();
    var confirmButton = getConfirmButton();
    var cancelButton = getCancelButton();

    // Reverse buttons (Confirm on the right side)
    if (params.reverseButtons) {
      confirmButton.parentNode.insertBefore(cancelButton, confirmButton);
    } else {
      confirmButton.parentNode.insertBefore(confirmButton, cancelButton);
    }

    // Focus handling
    var setFocus = function setFocus(index, increment) {
      var focusableElements = getFocusableElements(params.focusCancel);
      // search for visible elements and select the next possible match
      for (var _i3 = 0; _i3 < focusableElements.length; _i3++) {
        index = index + increment;

        // rollover to first item
        if (index === focusableElements.length) {
          index = 0;

          // go to last item
        } else if (index === -1) {
          index = focusableElements.length - 1;
        }

        // determine if element is visible
        var el = focusableElements[index];
        if (isVisible(el)) {
          return el.focus();
        }
      }
    };

    var handleKeyDown = function handleKeyDown(event) {
      var e = event || window.event;

      var arrowKeys = ['ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown', 'Left', 'Right', 'Up', 'Down' // IE11
      ];

      if (e.key === 'Enter' && !e.isComposing) {
        if (e.target === getInput()) {
          if (e.target.tagName.toLowerCase() === 'textarea') {
            return; // do not submit
          }

          sweetAlert.clickConfirm();
          e.preventDefault();
        }

        // TAB
      } else if (e.key === 'Tab') {
        var targetElement = e.target || e.srcElement;

        var focusableElements = getFocusableElements(params.focusCancel);
        var btnIndex = -1; // Find the button - note, this is a nodelist, not an array.
        for (var _i4 = 0; _i4 < focusableElements.length; _i4++) {
          if (targetElement === focusableElements[_i4]) {
            btnIndex = _i4;
            break;
          }
        }

        if (!e.shiftKey) {
          // Cycle to the next button
          setFocus(btnIndex, 1);
        } else {
          // Cycle to the prev button
          setFocus(btnIndex, -1);
        }
        e.stopPropagation();
        e.preventDefault();

        // ARROWS - switch focus between buttons
      } else if (arrowKeys.indexOf(e.key) !== -1) {
        // focus Cancel button if Confirm button is currently focused
        if (document.activeElement === confirmButton && isVisible(cancelButton)) {
          cancelButton.focus();
          // and vice versa
        } else if (document.activeElement === cancelButton && isVisible(confirmButton)) {
          confirmButton.focus();
        }

        // ESC
      } else if ((e.key === 'Escape' || e.key === 'Esc') && params.allowEscapeKey === true) {
        dismissWith('esc');
      }
    };

    if (!windowOnkeydownOverridden) {
      previousWindowKeyDown = window.onkeydown;
      windowOnkeydownOverridden = true;
      window.onkeydown = handleKeyDown;
    }

    // Loading state
    if (params.buttonsStyling) {
      confirmButton.style.borderLeftColor = params.confirmButtonColor;
      confirmButton.style.borderRightColor = params.confirmButtonColor;
    }

    /**
     * Show spinner instead of Confirm button and disable Cancel button
     */
    sweetAlert.hideLoading = sweetAlert.disableLoading = function () {
      if (!params.showConfirmButton) {
        hide(confirmButton);
        if (!params.showCancelButton) {
          hide(getButtonsWrapper());
        }
      }
      removeClass(buttonsWrapper, swalClasses.loading);
      removeClass(popup, swalClasses.loading);
      popup.removeAttribute('aria-busy');
      confirmButton.disabled = false;
      cancelButton.disabled = false;
    };

    sweetAlert.getTitle = function () {
      return getTitle();
    };
    sweetAlert.getContent = function () {
      return getContent();
    };
    sweetAlert.getInput = function () {
      return getInput();
    };
    sweetAlert.getImage = function () {
      return getImage();
    };
    sweetAlert.getButtonsWrapper = function () {
      return getButtonsWrapper();
    };
    sweetAlert.getConfirmButton = function () {
      return getConfirmButton();
    };
    sweetAlert.getCancelButton = function () {
      return getCancelButton();
    };

    sweetAlert.enableButtons = function () {
      confirmButton.disabled = false;
      cancelButton.disabled = false;
    };

    sweetAlert.disableButtons = function () {
      confirmButton.disabled = true;
      cancelButton.disabled = true;
    };

    sweetAlert.enableConfirmButton = function () {
      confirmButton.disabled = false;
    };

    sweetAlert.disableConfirmButton = function () {
      confirmButton.disabled = true;
    };

    sweetAlert.enableInput = function () {
      var input = getInput();
      if (!input) {
        return false;
      }
      if (input.type === 'radio') {
        var radiosContainer = input.parentNode.parentNode;
        var radios = radiosContainer.querySelectorAll('input');
        for (var _i5 = 0; _i5 < radios.length; _i5++) {
          radios[_i5].disabled = false;
        }
      } else {
        input.disabled = false;
      }
    };

    sweetAlert.disableInput = function () {
      var input = getInput();
      if (!input) {
        return false;
      }
      if (input && input.type === 'radio') {
        var radiosContainer = input.parentNode.parentNode;
        var radios = radiosContainer.querySelectorAll('input');
        for (var _i6 = 0; _i6 < radios.length; _i6++) {
          radios[_i6].disabled = true;
        }
      } else {
        input.disabled = true;
      }
    };

    // Show block with validation error
    sweetAlert.showValidationError = function (error$$1) {
      var validationError = getValidationError();
      validationError.innerHTML = error$$1;
      show(validationError);

      var input = getInput();
      if (input) {
        input.setAttribute('aria-invalid', true);
        input.setAttribute('aria-describedBy', swalClasses.validationerror);
        focusInput(input);
        addClass(input, swalClasses.inputerror);
      }
    };

    // Hide block with validation error
    sweetAlert.resetValidationError = function () {
      var validationError = getValidationError();
      hide(validationError);

      var input = getInput();
      if (input) {
        input.removeAttribute('aria-invalid');
        input.removeAttribute('aria-describedBy');
        removeClass(input, swalClasses.inputerror);
      }
    };

    sweetAlert.getProgressSteps = function () {
      return params.progressSteps;
    };

    sweetAlert.setProgressSteps = function (progressSteps) {
      params.progressSteps = progressSteps;
      setParameters(params);
    };

    sweetAlert.showProgressSteps = function () {
      show(getProgressSteps());
    };

    sweetAlert.hideProgressSteps = function () {
      hide(getProgressSteps());
    };

    sweetAlert.enableButtons();
    sweetAlert.hideLoading();
    sweetAlert.resetValidationError();

    if (params.input) {
      addClass(document.body, swalClasses['has-input']);
    }

    // inputs
    var inputTypes = ['input', 'file', 'range', 'select', 'radio', 'checkbox', 'textarea'];
    var input = void 0;
    for (var _i7 = 0; _i7 < inputTypes.length; _i7++) {
      var inputClass = swalClasses[inputTypes[_i7]];
      var inputContainer = getChildByClass(popup, inputClass);
      input = getInput(inputTypes[_i7]);

      // set attributes
      if (input) {
        for (var j in input.attributes) {
          if (input.attributes.hasOwnProperty(j)) {
            var attrName = input.attributes[j].name;
            if (attrName !== 'type' && attrName !== 'value') {
              input.removeAttribute(attrName);
            }
          }
        }
        for (var attr in params.inputAttributes) {
          input.setAttribute(attr, params.inputAttributes[attr]);
        }
      }

      // set class
      inputContainer.className = inputClass;
      if (params.inputClass) {
        addClass(inputContainer, params.inputClass);
      }

      hide(inputContainer);
    }

    var populateInputOptions = void 0;
    switch (params.input) {
      case 'text':
      case 'email':
      case 'password':
      case 'number':
      case 'tel':
      case 'url':
        input = getChildByClass(popup, swalClasses.input);
        input.value = params.inputValue;
        input.placeholder = params.inputPlaceholder;
        input.type = params.input;
        show(input);
        break;
      case 'file':
        input = getChildByClass(popup, swalClasses.file);
        input.placeholder = params.inputPlaceholder;
        input.type = params.input;
        show(input);
        break;
      case 'range':
        var range = getChildByClass(popup, swalClasses.range);
        var rangeInput = range.querySelector('input');
        var rangeOutput = range.querySelector('output');
        rangeInput.value = params.inputValue;
        rangeInput.type = params.input;
        rangeOutput.value = params.inputValue;
        show(range);
        break;
      case 'select':
        var select = getChildByClass(popup, swalClasses.select);
        select.innerHTML = '';
        if (params.inputPlaceholder) {
          var placeholder = document.createElement('option');
          placeholder.innerHTML = params.inputPlaceholder;
          placeholder.value = '';
          placeholder.disabled = true;
          placeholder.selected = true;
          select.appendChild(placeholder);
        }
        populateInputOptions = function populateInputOptions(inputOptions) {
          for (var optionValue in inputOptions) {
            var option = document.createElement('option');
            option.value = optionValue;
            option.innerHTML = inputOptions[optionValue];
            if (params.inputValue.toString() === optionValue) {
              option.selected = true;
            }
            select.appendChild(option);
          }
          show(select);
          select.focus();
        };
        break;
      case 'radio':
        var radio = getChildByClass(popup, swalClasses.radio);
        radio.innerHTML = '';
        populateInputOptions = function populateInputOptions(inputOptions) {
          for (var radioValue in inputOptions) {
            var radioInput = document.createElement('input');
            var radioLabel = document.createElement('label');
            var radioLabelSpan = document.createElement('span');
            radioInput.type = 'radio';
            radioInput.name = swalClasses.radio;
            radioInput.value = radioValue;
            if (params.inputValue.toString() === radioValue) {
              radioInput.checked = true;
            }
            radioLabelSpan.innerHTML = inputOptions[radioValue];
            radioLabel.appendChild(radioInput);
            radioLabel.appendChild(radioLabelSpan);
            radioLabel.for = radioInput.id;
            radio.appendChild(radioLabel);
          }
          show(radio);
          var radios = radio.querySelectorAll('input');
          if (radios.length) {
            radios[0].focus();
          }
        };
        break;
      case 'checkbox':
        var checkbox = getChildByClass(popup, swalClasses.checkbox);
        var checkboxInput = getInput('checkbox');
        checkboxInput.type = 'checkbox';
        checkboxInput.value = 1;
        checkboxInput.id = swalClasses.checkbox;
        checkboxInput.checked = Boolean(params.inputValue);
        var label = checkbox.getElementsByTagName('span');
        if (label.length) {
          checkbox.removeChild(label[0]);
        }
        label = document.createElement('span');
        label.innerHTML = params.inputPlaceholder;
        checkbox.appendChild(label);
        show(checkbox);
        break;
      case 'textarea':
        var textarea = getChildByClass(popup, swalClasses.textarea);
        textarea.value = params.inputValue;
        textarea.placeholder = params.inputPlaceholder;
        show(textarea);
        break;
      case null:
        break;
      default:
        error('Unexpected type of input! Expected "text", "email", "password", "number", "tel", "select", "radio", "checkbox", "textarea", "file" or "url", got "' + params.input + '"');
        break;
    }

    if (params.input === 'select' || params.input === 'radio') {
      if (params.inputOptions instanceof Promise) {
        sweetAlert.showLoading();
        params.inputOptions.then(function (inputOptions) {
          sweetAlert.hideLoading();
          populateInputOptions(inputOptions);
        });
      } else if (_typeof(params.inputOptions) === 'object') {
        populateInputOptions(params.inputOptions);
      } else {
        error('Unexpected type of inputOptions! Expected object or Promise, got ' + _typeof(params.inputOptions));
      }
    }

    openPopup(params.animation, params.onBeforeOpen, params.onOpen);

    if (!params.toast) {
      if (!params.allowEnterKey) {
        if (document.activeElement) {
          document.activeElement.blur();
        }
      } else if (params.focusCancel && isVisible(cancelButton)) {
        cancelButton.focus();
      } else if (params.focusConfirm && isVisible(confirmButton)) {
        confirmButton.focus();
      } else {
        setFocus(-1, 1);
      }
    }

    // fix scroll
    getContainer().scrollTop = 0;
  });
};

/*
 * Global function to determine if swal2 popup is shown
 */
sweetAlert$1.isVisible = function () {
  return !!getPopup();
};

/*
 * Global function for chaining sweetAlert popups
 */
sweetAlert$1.queue = function (steps) {
  queue = steps;
  var resetQueue = function resetQueue() {
    queue = [];
    document.body.removeAttribute('data-swal2-queue-step');
  };
  var queueResult = [];
  return new Promise(function (resolve, reject) {
    (function step(i, callback) {
      if (i < queue.length) {
        document.body.setAttribute('data-swal2-queue-step', i);

        sweetAlert$1(queue[i]).then(function (result) {
          if (isDefined(result.value)) {
            queueResult.push(result.value);
            step(i + 1, callback);
          } else {
            resetQueue();
            resolve({ dismiss: result.dismiss });
          }
        });
      } else {
        resetQueue();
        resolve({ value: queueResult });
      }
    })(0);
  });
};

/*
 * Global function for getting the index of current popup in queue
 */
sweetAlert$1.getQueueStep = function () {
  return document.body.getAttribute('data-swal2-queue-step');
};

/*
 * Global function for inserting a popup to the queue
 */
sweetAlert$1.insertQueueStep = function (step, index) {
  if (index && index < queue.length) {
    return queue.splice(index, 0, step);
  }
  return queue.push(step);
};

/*
 * Global function for deleting a popup from the queue
 */
sweetAlert$1.deleteQueueStep = function (index) {
  if (isDefined(queue[index])) {
    queue.splice(index, 1);
  }
};

/*
 * Global function to close sweetAlert
 */
sweetAlert$1.close = sweetAlert$1.closePopup = sweetAlert$1.closeModal = sweetAlert$1.closeToast = function (onComplete) {
  var container = getContainer();
  var popup = getPopup();
  if (!popup) {
    return;
  }
  removeClass(popup, swalClasses.show);
  addClass(popup, swalClasses.hide);
  clearTimeout(popup.timeout);

  if (!isToast()) {
    resetPrevState();
    window.onkeydown = previousWindowKeyDown;
    windowOnkeydownOverridden = false;
  }

  var removePopupAndResetState = function removePopupAndResetState() {
    if (container.parentNode) {
      container.parentNode.removeChild(container);
    }
    removeClass(document.documentElement, swalClasses.shown);
    removeClass(document.body, swalClasses.shown);
    removeClass(document.body, swalClasses['no-backdrop']);
    removeClass(document.body, swalClasses['has-input']);
    removeClass(document.body, swalClasses['toast-shown']);

    if (isModal()) {
      undoScrollbar();
      undoIOSfix();
    }
  };

  // If animation is supported, animate
  if (animationEndEvent && !hasClass(popup, swalClasses.noanimation)) {
    popup.addEventListener(animationEndEvent, function swalCloseEventFinished() {
      popup.removeEventListener(animationEndEvent, swalCloseEventFinished);
      if (hasClass(popup, swalClasses.hide)) {
        removePopupAndResetState();
      }
    });
  } else {
    // Otherwise, remove immediately
    removePopupAndResetState();
  }
  if (onComplete !== null && typeof onComplete === 'function') {
    setTimeout(function () {
      onComplete(popup);
    });
  }
};

/*
 * Global function to click 'Confirm' button
 */
sweetAlert$1.clickConfirm = function () {
  return getConfirmButton().click();
};

/*
 * Global function to click 'Cancel' button
 */
sweetAlert$1.clickCancel = function () {
  return getCancelButton().click();
};

/**
 * Show spinner instead of Confirm button and disable Cancel button
 */
sweetAlert$1.showLoading = sweetAlert$1.enableLoading = function () {
  var popup = getPopup();
  if (!popup) {
    sweetAlert$1('');
  }
  popup = getPopup();
  var buttonsWrapper = getButtonsWrapper();
  var confirmButton = getConfirmButton();
  var cancelButton = getCancelButton();

  show(buttonsWrapper);
  show(confirmButton, 'inline-block');
  addClass(buttonsWrapper, swalClasses.loading);
  addClass(popup, swalClasses.loading);
  confirmButton.disabled = true;
  cancelButton.disabled = true;

  popup.setAttribute('aria-busy', true);
  popup.focus();
};

/**
 * Is valid parameter
 * @param {String} paramName
 */
sweetAlert$1.isValidParameter = function (paramName) {
  return defaultParams.hasOwnProperty(paramName) || paramName === 'extraParams';
};

/**
 * Is deprecated parameter
 * @param {String} paramName
 */
sweetAlert$1.isDeprecatedParameter = function (paramName) {
  return deprecatedParams.indexOf(paramName) !== -1;
};

/**
 * Set default params for each popup
 * @param {Object} userParams
 */
sweetAlert$1.setDefaults = function (userParams) {
  if (!userParams || (typeof userParams === 'undefined' ? 'undefined' : _typeof(userParams)) !== 'object') {
    return error('the argument for setDefaults() is required and has to be a object');
  }

  showWarningsForParams(userParams);

  // assign valid params from userParams to popupParams
  for (var param in userParams) {
    if (sweetAlert$1.isValidParameter(param)) {
      popupParams[param] = userParams[param];
    }
  }
};

/**
 * Reset default params for each popup
 */
sweetAlert$1.resetDefaults = function () {
  popupParams = _extends({}, defaultParams);
};

/**
 * Adapt a legacy inputValidator for use with expectRejections=false
 */
sweetAlert$1.adaptInputValidator = function (legacyValidator) {
  return function adaptedInputValidator(inputValue, extraParams) {
    return legacyValidator.call(this, inputValue, extraParams).then(function () {
      return undefined;
    }, function (validationError) {
      return validationError;
    });
  };
};

sweetAlert$1.noop = function () {};

sweetAlert$1.version = '7.0.6';

sweetAlert$1.default = sweetAlert$1;

// Remember state in cases where opening and handling a modal will fiddle with it.
var states = {
  previousActiveElement: null,
  previousBodyPadding: null

  /*
   * Add modal + overlay to DOM
   */
};var init = function init(params) {
  // Clean up the old popup if it exists
  var c = getContainer();
  if (c) {
    c.parentNode.removeChild(c);
    removeClass(document.body, swalClasses['no-backdrop']);
    removeClass(document.body, swalClasses['has-input']);
    removeClass(document.body, swalClasses['toast-shown']);
  }

  if (!isDefined(document)) {
    error('SweetAlert2 requires document to initialize');
    return;
  }

  var container = document.createElement('div');
  container.className = swalClasses.container;
  container.innerHTML = sweetHTML;

  var targetElement = typeof params.target === 'string' ? document.querySelector(params.target) : params.target;
  targetElement.appendChild(container);

  var popup = getPopup();
  var input = getChildByClass(popup, swalClasses.input);
  var file = getChildByClass(popup, swalClasses.file);
  var range = popup.querySelector('.' + swalClasses.range + ' input');
  var rangeOutput = popup.querySelector('.' + swalClasses.range + ' output');
  var select = getChildByClass(popup, swalClasses.select);
  var checkbox = popup.querySelector('.' + swalClasses.checkbox + ' input');
  var textarea = getChildByClass(popup, swalClasses.textarea);

  // a11y
  popup.setAttribute('aria-live', params.toast ? 'polite' : 'assertive');

  var resetValidationError = function resetValidationError() {
    sweetAlert$1.isVisible() && sweetAlert$1.resetValidationError();
  };

  input.oninput = resetValidationError;
  file.onchange = resetValidationError;
  select.onchange = resetValidationError;
  checkbox.onchange = resetValidationError;
  textarea.oninput = resetValidationError;

  range.oninput = function () {
    resetValidationError();
    rangeOutput.value = range.value;
  };

  range.onchange = function () {
    resetValidationError();
    range.previousSibling.value = range.value;
  };

  return popup;
};

/*
 * Manipulate DOM
 */

var sweetHTML = ('\n <div role="dialog" aria-modal="true" aria-labelledby="' + swalClasses.title + '" aria-describedby="' + swalClasses.content + '" class="' + swalClasses.popup + '" tabindex="-1">\n   <ul class="' + swalClasses.progresssteps + '"></ul>\n   <div class="' + swalClasses.icon + ' ' + iconTypes.error + '">\n     <span class="swal2-x-mark"><span class="swal2-x-mark-line-left"></span><span class="swal2-x-mark-line-right"></span></span>\n   </div>\n   <div class="' + swalClasses.icon + ' ' + iconTypes.question + '">?</div>\n   <div class="' + swalClasses.icon + ' ' + iconTypes.warning + '">!</div>\n   <div class="' + swalClasses.icon + ' ' + iconTypes.info + '">i</div>\n   <div class="' + swalClasses.icon + ' ' + iconTypes.success + '">\n     <div class="swal2-success-circular-line-left"></div>\n     <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>\n     <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>\n     <div class="swal2-success-circular-line-right"></div>\n   </div>\n   <img class="' + swalClasses.image + '" />\n   <div class="' + swalClasses.contentwrapper + '">\n   <h2 class="' + swalClasses.title + '" id="' + swalClasses.title + '"></h2>\n   <div id="' + swalClasses.content + '" class="' + swalClasses.content + '"></div>\n   </div>\n   <input class="' + swalClasses.input + '" />\n   <input type="file" class="' + swalClasses.file + '" />\n   <div class="' + swalClasses.range + '">\n     <output></output>\n     <input type="range" />\n   </div>\n   <select class="' + swalClasses.select + '"></select>\n   <div class="' + swalClasses.radio + '"></div>\n   <label for="' + swalClasses.checkbox + '" class="' + swalClasses.checkbox + '">\n     <input type="checkbox" />\n   </label>\n   <textarea class="' + swalClasses.textarea + '"></textarea>\n   <div class="' + swalClasses.validationerror + '" id="' + swalClasses.validationerror + '"></div>\n   <div class="' + swalClasses.buttonswrapper + '">\n     <button type="button" class="' + swalClasses.confirm + '">OK</button>\n     <button type="button" class="' + swalClasses.cancel + '">Cancel</button>\n   </div>\n   <button type="button" class="' + swalClasses.close + '">\xD7</button>\n </div>\n').replace(/(^|\n)\s*/g, '');

var getContainer = function getContainer() {
  return document.body.querySelector('.' + swalClasses.container);
};

var getPopup = function getPopup() {
  return getContainer() ? getContainer().querySelector('.' + swalClasses.popup) : null;
};

var getIcons = function getIcons() {
  var popup = getPopup();
  return popup.querySelectorAll('.' + swalClasses.icon);
};

var elementByClass = function elementByClass(className) {
  return getContainer() ? getContainer().querySelector('.' + className) : null;
};

var getTitle = function getTitle() {
  return elementByClass(swalClasses.title);
};

var getContent = function getContent() {
  return elementByClass(swalClasses.content);
};

var getImage = function getImage() {
  return elementByClass(swalClasses.image);
};

var getProgressSteps = function getProgressSteps() {
  return elementByClass(swalClasses.progresssteps);
};

var getValidationError = function getValidationError() {
  return elementByClass(swalClasses.validationerror);
};

var getConfirmButton = function getConfirmButton() {
  return elementByClass(swalClasses.confirm);
};

var getCancelButton = function getCancelButton() {
  return elementByClass(swalClasses.cancel);
};

var getButtonsWrapper = function getButtonsWrapper() {
  return elementByClass(swalClasses.buttonswrapper);
};

var getCloseButton = function getCloseButton() {
  return elementByClass(swalClasses.close);
};

var getFocusableElements = function getFocusableElements() {
  var focusableElementsWithTabindex = Array.from(getPopup().querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'))
  // sort according to tabindex
  .sort(function (a, b) {
    a = parseInt(a.getAttribute('tabindex'));
    b = parseInt(b.getAttribute('tabindex'));
    if (a > b) {
      return 1;
    } else if (a < b) {
      return -1;
    }
    return 0;
  });

  var otherFocusableElements = Array.prototype.slice.call(getPopup().querySelectorAll('button, input:not([type=hidden]), textarea, select, a, [tabindex="0"]'));

  return uniqueArray(focusableElementsWithTabindex.concat(otherFocusableElements));
};

var isModal = function isModal() {
  return !document.body.classList.contains(swalClasses['toast-shown']);
};

var isToast = function isToast() {
  return document.body.classList.contains(swalClasses['toast-shown']);
};

var hasClass = function hasClass(elem, className) {
  if (elem.classList) {
    return elem.classList.contains(className);
  }
  return false;
};

var focusInput = function focusInput(input) {
  input.focus();

  // place cursor at end of text in text input
  if (input.type !== 'file') {
    // http://stackoverflow.com/a/2345915/1331425
    var val = input.value;
    input.value = '';
    input.value = val;
  }
};

var addClass = function addClass(elem, className) {
  if (!elem || !className) {
    return;
  }
  var classes = className.split(/\s+/).filter(Boolean);
  classes.forEach(function (className) {
    elem.classList.add(className);
  });
};

var removeClass = function removeClass(elem, className) {
  if (!elem || !className) {
    return;
  }
  var classes = className.split(/\s+/).filter(Boolean);
  classes.forEach(function (className) {
    elem.classList.remove(className);
  });
};

var getChildByClass = function getChildByClass(elem, className) {
  for (var i = 0; i < elem.childNodes.length; i++) {
    if (hasClass(elem.childNodes[i], className)) {
      return elem.childNodes[i];
    }
  }
};

var show = function show(elem, display) {
  if (!display) {
    display = elem === getPopup() || elem === getButtonsWrapper() ? 'flex' : 'block';
  }
  elem.style.opacity = '';
  elem.style.display = display;
};

var hide = function hide(elem) {
  elem.style.opacity = '';
  elem.style.display = 'none';
};

var empty = function empty(elem) {
  while (elem.firstChild) {
    elem.removeChild(elem.firstChild);
  }
};

// borrowed from jquery $(elem).is(':visible') implementation
var isVisible = function isVisible(elem) {
  return elem.offsetWidth || elem.offsetHeight || elem.getClientRects().length;
};

var removeStyleProperty = function removeStyleProperty(elem, property) {
  if (elem.style.removeProperty) {
    elem.style.removeProperty(property);
  } else {
    elem.style.removeAttribute(property);
  }
};

var animationEndEvent = function () {
  // Prevent run in Node env
  if (!isDefined(document)) {
    return false;
  }

  var testEl = document.createElement('div');
  var transEndEventNames = {
    'WebkitAnimation': 'webkitAnimationEnd',
    'OAnimation': 'oAnimationEnd oanimationend',
    'animation': 'animationend'
  };
  for (var i in transEndEventNames) {
    if (transEndEventNames.hasOwnProperty(i) && isDefined(testEl.style[i])) {
      return transEndEventNames[i];
    }
  }

  return false;
}();

// Reset previous window keydown handler and focued element
var resetPrevState = function resetPrevState() {
  if (states.previousActiveElement && states.previousActiveElement.focus) {
    var x = window.scrollX;
    var y = window.scrollY;
    states.previousActiveElement.focus();
    if (isDefined(x) && isDefined(y)) {
      // IE doesn't have scrollX/scrollY support
      window.scrollTo(x, y);
    }
  }
};

// Measure width of scrollbar
// https://github.com/twbs/bootstrap/blob/master/js/modal.js#L279-L286
var measureScrollbar = function measureScrollbar() {
  var supportsTouch = 'ontouchstart' in window || navigator.msMaxTouchPoints;
  if (supportsTouch) {
    return 0;
  }
  var scrollDiv = document.createElement('div');
  scrollDiv.style.width = '50px';
  scrollDiv.style.height = '50px';
  scrollDiv.style.overflow = 'scroll';
  document.body.appendChild(scrollDiv);
  var scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;
  document.body.removeChild(scrollDiv);
  return scrollbarWidth;
};

/**
 * Inject a string of CSS into the page header
 *
 * @param {String} css
 */
var injectCSS = function injectCSS() {
  var css = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';

  // Prevent run in Node env
  if (!isDefined(document)) {
    return false;
  }

  var head = document.head || document.getElementsByTagName('head')[0];
  var style = document.createElement('style');
  style.type = 'text/css';
  head.appendChild(style);

  if (style.styleSheet) {
    style.styleSheet.cssText = css;
  } else {
    style.appendChild(document.createTextNode(css));
  }
};

injectCSS(styles);

return sweetAlert$1;

})));
if (typeof window !== 'undefined' && window.Sweetalert2) window.sweetAlert = window.swal = window.Sweetalert2;
define('m_view',['jquery','dictionary','v_view','sweetalert2'], 
	function ( $, DICTIONARY, VIEW, SWAL ) {
	//<? transactor methods
		function _t_issetDomEl (iNdomElement) {
			return VIEW.d_issetDomEl(iNdomElement,iNaddedData,iNwhere);
		}
		
		function _t_addDataToViewEl (iNdomElement,iNaddedData,iNwhere) {
			VIEW.d_addDataToViewEl(iNdomElement,iNaddedData,iNwhere)
		}
		function _td_setTextInLoader (iNtext) {
			VIEW.setTextInLoader(iNtext)
		}
		
	//>! transactor methods

	//<? base methods
		function _init () {
			/*
				@discr
					create base canvas 
				@inputs
					@required
						iNdomElement -> string
				@return 
					bool
			*/
			_t_addDataToViewEl(
					'body',
					VIEW.initWithObj(
						{
							'arrListApps' : ArrForTemplate_appsForListApps
						}
					),
					'change'
			);
			DICTIONARY.start();
		}

	
		
		

		//<? work with modal windows sweetalert
			function _modalWindow_vError(iName,iNtext){
			    SWAL (
			      iName,
			      iNtext,
			      'error'
			    )
			}
			function _modalWindow_vSuccess(iName,iNtext){
			    SWAL (
			      iName,
			      iNtext,
			      'success'
			    )
			}
		//>! work with modal windows sweetalert
	//>? base methods

	//<? View_listApps 
		var ArrForTemplate_appsForListApps = [
    		{
    			'icon' : 'https://cdn.ramman.net/images/icons/apps/app_chat.png',
    			'dc'   : '[app-chat]',
    			'name' : 'Talking'
    		},
    		{
    			'icon' : 'https://cdn.ramman.net/images/icons/apps/app_market.png',
    			'dc'   : '[app-market]',
    			'name' : 'Market'
    		},
    		{
    			'icon' : 'https://cdn.ramman.net/images/icons/apps/app_onepay.png',
    			'dc'   : '[app-onepay]',
    			'name' : 'OnePay'
    		},
    		{
    			'icon' : 'https://cdn.ramman.net/images/icons/apps/app_sharepay.png',
    			'dc'   : '[app-sharepay]',
    			'name' : 'SharePay'
    		}
    	];
    	//methods
			function getViewListApps() {
        		return VIEW.getViewListApps(ArrForTemplate_appsForListApps);
			}	
	//>! View_listApps 

	//<? work with loader
		// for view loader [optional with determine view by path to output loader]
			function _showLoader (iNid) {
				VIEW.d_showLoader(iNid);
				DICTIONARY.start('.rcontent_loader');
			}
			function _t_closeLoader (iNid) {
				VIEW.d_closeLoader(iNid);
			}
			function _d_setTextInLoaderByKey (iNkey) {
				/*
					@discr
						set text in loader by dictionary key
					@inputs
						@required
							iNtext -> string
					@deps
						function: DICTIONARY -> withString
						function: _t_setTextInLoader

				*/
				var text = DICTIONARY.withString(iNkey);
				_t_setTextInLoader(text);
			}

		// for hide loader  [optional with determine view by path to delete loader]
			
	//>! work with loader
	return {
		
		// showLoader 		: _showLoader,
		// closeLoader 	: _t_closeLoader,

		isset 			: _t_issetDomEl,
		add 			: _t_addDataToViewEl,

		success 		: _modalWindow_vSuccess,
		error 			: _modalWindow_vError,
		// checkAppInList  : _checkAppInList,
		// checkAppInChief : _checkAppInChief,

		init 					: _init,
		view 			: VIEW,
		// d_setTextInLoader 		: _td_setTextInLoader,
		// d_setTextInLoaderByKey 	: _d_setTextInLoaderByKey,

		/* private
			getViewListApps
		*/
	}
});
define('v_app',['jquery','template7','v_view'],function($,Template7,V_VIEW){
	const CONST = {
		'pathAppHeader' 	  : '#block #viewBlock .topBlockInViewBlock',
		'pathAppView' 	  	  : '#block #viewBlock #viewAndChatBlockInViewBlock.appChiefWindow',
		'nameInAppHeader' 	  : 'appHeaderInChiefBlock', // class
		'pageNameInAppHeader' : 'appPage',// class

		'pathMenuHeader' 	  : '#block #menusBlock .topBlockInMenusBlock',
		'nameInMenuHeader' 	  : 'menuHeaderInMenusBlock', // class
		'pageNameInMenuHeader': 'appPage', // class


	};
	const _ = {};
	// appName -> String, views -> array of objects {viewName,viewContent}
	const templates = {};
		
		templates['chiefForAppInList'] = `
			<div class='app' app-name='{{app}}'>
			  {{#if page}}
		          <div class='view' view-name='{{page}}'>
		          	{{content}}
		          </div>
	          {{/if}}
	          {{other}}
	        </div>
	    `;
	    templates['pageForAppInList'] = `
	    		{{before}}
	    		<div class='view {{class}}' view-name='{{page}}' {{attr}}>
		          	{{content}}
		        </div>
		        {{after}}
	    `;

	    //< templates for header
		    templates['appContentChiefHeader'] = `
				<div class="`+ CONST['nameInAppHeader'] +`" app-name="{{app}}">
					{{#if page}}
						<div class='`+ CONST['pageNameInAppHeader'] +`' page-name="{{page}}">
							{{content}}
						</div>
					{{else}}
						{{other}}
					{{/if}}
				</div>
		    `;
			    templates['pageContentChiefHeader'] = `
					<div class='`+ CONST['pageNameInAppHeader'] +`' page-name="{{page}}">
						{{content}}
					</div>
			    `;
		    templates['appContentMenuHeader'] = `
				<div class="`+ CONST['nameInMenuHeader'] +`" app-name="{{app}}">
					{{#if page}}
						<div class='`+ CONST['pageNameInMenuHeader'] +`' page-name="{{page}}">
							{{content}}
						</div>
					{{else}}
						{{other}}
					{{/if}}
				</div>
		    `;
			    templates['pageContentMenuHeader'] = `
					<div class='`+ CONST['pageNameInMenuHeader'] +`'  page-name="{{page}}">
					    {{content}}
					</div>
			    `;

	    templates['chiefForAppInView'] = `
			<div class='viewesInWindow app {{class}}' app-name='{{app}}' {{attr}}>
				  {{other}}
			</div>
		`;
		/* DELETED because this twart for auto add page attr when app not exist
			{{#if page1}}
				  {{if content}}
			    <div class='view' view-name='{{page}}'>{{content}}</div>
			  {{/if}}
			{{/if}}
	  	*/
	    templates['pageForAppInView'] = `
	          <div class='view {{class}}' view-name='{{page}}' {{attr}}>
	          	{{content}}{{other}}
	          </div>
	    `;
	    //> templates for header
	   
	    
	    //< template for modal window

	   
    function getListApp (iNdata) {
    	/*
    		@inputs
    			@required
        			iNdata -> object
        				app  -> String
						@optional
							page 	-> String {chain #1}
							content -> String {chain #1}
							after 	-> String 
							before 	-> String 
							class 	-> String 

			@deps
				templates['chiefForAppInList'] : var
    	*/
    	getAttrAndClassForAppAndPage(iNdata);
    	var temp = Template7.compile(templates['chiefForAppInList']);
    	return temp(iNdata);
    } _.getListApp = getListApp;

    function getPageForListApp (iNdata) {
    	/*
			@discr
				get page for list app by object (iNdata)
			@inputs
				@required
					iNdata -> object
						page 		-> string
						content 	-> string
						@optional
							after 	-> String 
							before 	-> String 
							class 	-> String 
				@optional
		*/

		getAttrAndClassForAppAndPage(iNdata);
		var temp = Template7.compile(templates['pageForAppInList']);
		return temp(iNdata);
    } _.getPageForListApp = getPageForListApp

    function d_updatePageInListApp (iNdata) {
    	/*
			@discr
				update page in list app by object (iNdata)
			@inputs
				@required
					iNdata -> object
						app 		-> string
						page 		-> string
						content 	-> string
						@optional
							extra		-> string
				@optional
		*/
		var selector = '.usersBlockContainerInMenusBlock .app[app-name="'+iNdata['app']+'"] .view[view-name="'+iNdata['page']+'"]';
		if(typeof(iNdata['extra']) == 'string') selector += ' ' + iNdata['extra'];
    	$(selector).html(iNdata['content']);
    } _.d_updatePageInListApp = d_updatePageInListApp;

    function d_clearPageInListApp (iNdata) {
    	/*
			@discr
				clear page in list app by object (iNdata)
			@inputs
				@required
					iNdata -> object
						app 		-> string
						page 		-> string
						content 	-> string
						@optional
							extra		-> string
				@optional
			@deps
				function : d_updatePageInListApp
		*/
		iNdata['html'] = '';
		d_updatePageInListApp(iNdata);
    } _.d_clearPageInListApp = d_clearPageInListApp;

    function d_checkPageInListApp (iNdata) {
    	/*
			@discr
				update isset page in list app by object (iNdata)
			@inputs
				@required
					iNdata -> object
						page 		-> string
						app 	-> string
						@optional
							extra		-> string
				@optional
			@return
				int : 0 - false, 0< true
		*/
		var selector = '.usersBlockContainerInMenusBlock .app[app-name="'+iNdata['app']+'"] .view[view-name="'+iNdata['page']+'"]';
		if(typeof(iNdata['extra']) == 'string') selector += ' ' + iNdata['extra'];
    	return $(selector).length;
    } _.d_checkPageInListApp = d_checkPageInListApp;

    function d_checkListApp (iNdata) {
    	/*
			@discr
				check isset list app by object (iNdata)
			@inputs
				@required
					iNdata -> object
						app 	-> string
						@optional
							extra		-> string
				@optional
			@return
				int : 0 - false, 0< true
		*/
		var selector = '.usersBlockContainerInMenusBlock .app[app-name="'+iNdata['app']+'"]';
		if(typeof(iNdata['extra']) == 'string') selector += ' ' + iNdata['extra'];
    	return $(selector).length;
    } _.d_checkListApp = d_checkListApp;
	
	function d_createPageInListApp (iNdata) {
    	/*
			@discr
				create page for list app
			@inputs
				@required
					iNdata -> object
						app 		-> string
						page 		-> string
						content 	-> string
						@optional
							attr		-> string
							extra		-> string 
				@optional
			@return
				int : 0 - false, 0< true
		*/
		// if we have app

		
		var selector = '.usersBlockContainerInMenusBlock .app[app-name="'+iNdata['app']+'"] ';
		if(typeof(iNdata['extra']) == 'string') selector += ' ' + iNdata['extra'];
    	V_VIEW.d_addDataToViewEl(selector, getPageForListApp(iNdata) ,'change');
    } _.d_createPageInListApp = d_createPageInListApp;
    
    function addContentToChiefApp (iNdata,iNcontent) {
    	/*
			@discr
				add content to isset in DOM app and page
			@inputs
				@required
					iNdata -> object
						app 		-> string
						page 		-> string
						content 	-> string
						@optional
							type		-> string
				@optional
			@return
		*/
    	var selector = '#viewAndChatBlockInViewBlock .viewesInWindow.app[app-name="'+iNdata['app']+'"] .view[view-name="'+ iNdata['page']+ '"]';
    	if (typeof iNdata['type'] != 'string') iNdata['type']='begin';
    	V_VIEW.d_addDataToViewEl(selector, iNcontent,iNdata['type']);
    } _.addContentToChiefApp = addContentToChiefApp;

    function d_createListApp (iNdata) {
    	/*
			@discr
				create list app [@optional - with page]
			@inputs
				@required
					iNdata -> object
						app 		-> string
						@optional
							page 		-> string
							content 	-> string
							attr		-> object
								class		-> string
							before		-> string 
							after		-> string 

							extra		-> string 
				@optional
			@return
				int : 0 - false, 0< true
		*/
		var selector = '.usersBlockContainerInMenusBlock'; 
		if(typeof(iNdata['extra']) == 'string') selector += ' ' + iNdata['extra'];
		getAttrAndClassForAppAndPage(iNdata);
    	V_VIEW.d_addDataToViewEl(selector, getListApp(iNdata) ,'end');
    } _.d_createListApp = d_createListApp;



    
		function getChiefApp (iNdata) {
			/*
				@discr
					get app template by object (iNdata) [with page] [with other] [withoout content]
					if isset page create with page
					else if isset other created with data
					else simple create app container
				@inputs
					@required
						iNdata -> object
							@required
								app -> string
							@optional
								content -> string
								page 	-> string
								other 	-> string
								attr 	-> object
									class 	-> string OR array
					@optional
				@deps
					function: getAttrAndClassForAppAndPage
					object: Template7
				*/
			getAttrAndClassForAppAndPage(iNdata);
			var temp = Template7.compile(templates['chiefForAppInView']);
			return temp(iNdata);
		} _.getChiefApp = getChiefApp;

		function getPageForChiefApp (iNdata) {
			/*
				@discr
					get page for app by object (iNdata)
				@inputs
					@required
						iNdata -> object
							page 		-> string
							content 	-> string
							@otional
								attr 	-> object
									class 	-> string OR array
					@optional
				@deps
					function: getAttrAndClassForAppAndPage
					object: Template7
			*/

			getAttrAndClassForAppAndPage(iNdata);
			var temp = Template7.compile(templates['pageForAppInView']);
			return temp(iNdata);
		} _.getPageForChiefApp = getPageForChiefApp;

			function getAttrAndClassForAppAndPage (iNdata) {
				/*
					@example
						getAttrAndClassForAppAndPage({
							attr: { 
								'class' : ['myNewClass'],
								'attrName' : 'attrValue'
							}
						});
					@discr
						get page for app by object (iNdata)
					@inputs
						@required
						@optional
							iNdata -> object
								attr 		-> string
						@optional
					@return 
						void [result = to iNdata right date]
				*/
				var attrString = '',classString = '', attrArray = iNdata['attr'],thisValue;
				if( typeof(iNdata['attr']) == 'object' ) {
					for (var iKey in attrArray ) {
						if( iKey == 'class' ) {
							// add class 
							if( typeof(attrArray[iKey]) == 'string') 
								attrArray[iKey] = [attrArray[iKey]];
							classString += ' ' + attrArray[iKey].join(' ');
						} else {
							//add attr
							attrString +=  iKey + "='" + attrArray[iKey] + "'";
						}
					}
				}
				iNdata['class'] = classString; iNdata['attr'] = attrString;
			}
		function d_updatePageInChiefApp (iNdata) {
        	/*
				@discr
					update page in chieft app by object (iNdata)
				@inputs
					@required
						iNdata -> object
							app 		-> string
							page 		-> string
							content 	-> string
							@optional
								extra		-> string
					@optional
			*/
			var selector = CONST['pathAppView'] + ' .app[app-name="'+iNdata['app']+'"] .view[view-name="'+iNdata['page']+'"]';
			if(typeof(iNdata['extra']) == 'string') 	selector += ' ' + iNdata['extra'];
        	$(selector).html(iNdata['content']);

        } _.d_updatePageInChiefApp = d_updatePageInChiefApp;

        function d_clearPageInChiefApp (iNdata) {
        	/*
				@discr
					clear page for chief app by object (iNdata)
				@inputs
					@required
						iNdata -> object
							app 		-> string
							page 		-> string
							content 	-> string
							@optional
								extra		-> string
					@optional
				@deps
					function : d_updatePageInChiefApp
			*/
        	iNdata['content'] = '';
			d_updatePageInChiefApp(iNdata);
        } _.d_clearPageInChiefApp = d_clearPageInChiefApp;

        function d_checkPageInChiefApp (iNdata) {
        	/*
				@discr
					get isset page lengthin chief app by object (iNdata)
				@inputs
					@required
						iNdata -> object
							page 		-> string
							app 		-> string
							@optional
								extra		-> string
					@optional
				@return
					int : 0 - false, 0< true
			*/
			var selector = CONST['pathAppView'] + ' .app[app-name="'+iNdata['app']+'"] .view[view-name="'+iNdata['page']+'"]';
			if(typeof(iNdata['extra']) == 'string') selector += ' ' + iNdata['extra'];
        	return $(selector).length;
        } _.d_checkPageInChiefApp = d_checkPageInChiefApp;

        function d_checkChiefApp (iNdata) {
        	/*
				@discr
					check isset chief app by object (iNdata)
				@inputs
					@required
						iNdata -> object
							app 	-> string
							@optional
								extra		-> string
					@optional
				@return
					int : 0 - false, 0< true
			*/
			var selector = CONST['pathAppView'] + ' .app[app-name="'+iNdata['app']+'"]';
			if(typeof(iNdata['extra']) == 'string') selector += ' ' + iNdata['extra'];
        	return $(selector).length;
        } _.d_checkChiefApp = d_checkChiefApp;
		
		function d_createPageInChiefApp (iNdata ) {
        	/*
				@discr
					create page for chief app
				@inputs
					@required
						iNdata -> object
							app 		-> string
							page 		-> string
							content 	-> string
							@optional
								attr	-> object
									class	-> 
									attrKey : attrBalue
								extra	-> string 
					@optional
				@deps
					function : getPageForChiefApp
				@return
					int : 0 - false, 0< true
			*/
			var selector = CONST['pathAppView'] + ' .app[app-name="'+iNdata['app']+'"] ';
			if(typeof(iNdata['extra']) == 'string') selector += ' ' + iNdata['extra'];
        	V_VIEW.d_addDataToViewEl(selector, getPageForChiefApp(iNdata) ,'end')
        } _.d_createPageInChiefApp = d_createPageInChiefApp;
        
        function d_createChiefApp (iNdata) {
        	/*
				@discr
					create chief app [@optional - with page]
				@inputs
					@required
						iNdata -> object
							app 		-> string
							@optional
								page 		-> string
								content 	-> string

								attr		-> string
								extra		-> string

								other -		> string
					@optional
				@return
					int : 0 - false, 0< true
			*/
			var selector = CONST['pathAppView']; 
			if(typeof(iNdata['extra']) == 'string') selector += ' ' + iNdata['extra'];
        	V_VIEW.d_addDataToViewEl(selector, getChiefApp(iNdata) ,'change')
        } _.d_createChiefApp = d_createChiefApp;

        //< app headers
	        
        	function d_hideAppHeader (iNdata) {
	        	/*
	        		@discr
	        			hide app page of header
	        		@inputs
	        			iNdata -> object
	        				app  -> string
	        	*/
	        	$( 
	        		CONST['pathAppHeader'] + ' ' 	+ 
	        		'.'+CONST['nameInAppHeader'] 	+
        			'[app-name="' + iNdata['app'] + '"]'
        		).hide();
	        } _.d_hideAppHeader = d_hideAppHeader;

	        function d_hideAppHeaders (iNdata) {
	        	/*
	        		@discr
	        			hide app page of header
	        		@inputs
	        			iNdata -> object
	        				app  -> string
	        	*/
	        	$( 
	        		CONST['pathAppHeader'] + ' ' 	+ 
	        		'.'+CONST['nameInAppHeader']
        		).hide();
	        }
	        function d_removeAppHeader (iNdata) {
	        	/*
	        		@discr
	        			hide app page of header
	        		@inputs
	        			iNdata -> object
	        				app  -> string
	        	*/
	        	$( 
	        		CONST['pathAppHeader'] + ' ' 	+ 
	        		'.'+CONST['nameInAppHeader'] 	+
        			'[app-name="' + iNdata['app'] + '"]'
        		).remove();
	        } _.d_removeAppHeader = d_removeAppHeader;

		        function d_hideAppPagesHeader (iNdata) {
		        	/*
		        		@discr
		        			hide app page of header
		        		@inputs
		        			iNdata -> object
		        				app  -> string
		        	*/
		        	$( 
		        		CONST['pathAppHeader'] + ' ' 		+ 
		        		'.'+CONST['nameInAppHeader'] 		+
	        			'[app-name="' + iNdata['app'] + '"] '	+
	        			'.'+CONST['pageNameInAppHeader']
	        		).hide();
		        } _.d_hideAppPagesHeader = d_hideAppPagesHeader;

	        function d_showAppHeader (iNdata) {
	        	/*
	        		@discr
	        			show app of header
	        		@inputs
	        			iNdata -> object
	        				app  -> string
	        	*/
	        	$( 
	        		CONST['pathAppHeader'] + ' ' 		+ 
	        		'.'+CONST['nameInAppHeader']  		+
	        		'[app-name="'+ iNdata['app'] +'"]' 
        		).show();
	        } _.d_showAppHeader = d_showAppHeader;

		        function d_showAppPageHeader (iNdata) {
		        	/*
		        		@discr
		        			show app of header
		        		@inputs
		        			iNdata -> object
		        				app  -> string
		        				page -> string
		        	*/
		        	$(
		        		CONST['pathAppHeader'] + ' ' 		+ 
		        		'.'+CONST['nameInAppHeader']  		+
		        		'[app-name="'+ iNdata['app'] +'"]' + ' '+ 
		        		'.'+CONST['pageNameInAppHeader']  +
		        		'[page-name="'+ iNdata['page'] +'"]' 
	        		).show();
		        } _.d_showAppPageHeader = d_showAppPageHeader;

            function d_viewAppPageHeader (iNdata) {
	        	/*
	        		@discr
	        			wathc app page of header
	        		@inputs
	        			iNdata -> object
	        				app  -> string
	        				page -> string
	        	*/
	        	// hide apps
	        	d_hideAppHeaders(iNdata);

	        	// show this app
	        	d_showAppHeader(iNdata); 

				// hide other pages app
	        	d_hideAppPagesHeader(iNdata);

	        	// show this page
	        	d_showAppPageHeader(iNdata); 
	        } _.d_viewAppPageHeader = d_viewAppPageHeader;

	        function d_setAppHeader (iNcontent) {
	        	/*
	        		@discr
	        			set content for app into header block
	        		@inputs
	        			iNcontent -> string
	        	*/
	        	$( CONST['pathAppHeader'] + ' .topBlockInViewBlock' ).html(iNcontent);
	        } _.d_setAppHeader = d_setAppHeader;

	        function d_getLengthAppHeader (iNdata) {
	        	/*
	        		@discr
	        			set content for app into header block
	        		@inputs
	        			iNdata -> string
	        				app
        					@optional
	        					page
	        	*/
	        	var selector = CONST['pathAppHeader'] + ' .topBlockInViewBlock .' + CONST['nameInAppHeader'] + '[app-name="'+iNdata['app']+'"]';
	        	if ( typeof iNdata['page'] == 'string' )
	        		selector += '.' + CONST['pageNameInAppHeader'] + '[page-name="'+ iNdata['page'] +'"]';
	        	return $(selector).length;
	        } _.d_getLengthAppHeader = d_getLengthAppHeader;


	       	function getAppHeader (iNdata) {
	        	/*
	        		@discr
	        			get content for app headery by template
	        		@inputs
	        			iNdata -> object
	        				@required
	        					app
	        				@optional
	        					page
	        					content
	        					attr
				*/
        		var temp = Template7.compile(templates['appContentChiefHeader']);
        		return temp(iNdata)
        	} _.getAppHeader = getAppHeader;

        	function getPageAppHeader (iNdata) {
	        	/*
	        		@discr
	        			get content for app menu headery by template
	        		@inputs
	        			iNdata -> object
	        				@required
	        					page
	        					content
	        				@optional
				*/
        		var temp = Template7.compile(templates['pageContentChiefHeader']);
        		return temp(iNdata)
        	} _.getPageAppHeader = getPageAppHeader;

        function d_addAppHeaderByTemplate (iNdata,iNtype) {
        	/*
        		@discr
        			add content for app into  header block by template
        		@inputs
        			iNdata -> object
        				app 
        				page
        				content
    				iNtype -> string
    					in [end,begin, after, before, change]

        	*/
        	if( typeof iNtype != 'string' ) iNtype = 'end';
        	var selector = CONST['pathAppHeader'],
        		content = getAppHeader(iNdata);
			V_VIEW.d_addDataToViewEl(selector, content ,iNtype);
        } _.d_addAppHeaderByTemplate = d_addAppHeaderByTemplate;

        function safeViewAppHeaderWithContent (iNdata,iNtype) {
			/*
				@discr
					add safe content to chief app header and view this
				@inputs
					iNdata -> object
						app
						page
						content
					@optional
					iNtype -> string 
						in [end,begin, after, before, change]
			*/
			if( typeof iNtype != 'string' ) iNtype = 'end';
			safeAddAppHeader(iNdata,iNtype);
			//view this menu 
			d_viewAppPageHeader(iNdata);
		} _.safeViewAppHeaderWithContent = safeViewAppHeaderWithContent;

		function safeAddAppHeader (iNdata,iNtype) {
			/*
				@discr
					add safe content to chief app header
				@inputs
					iNdata -> object
						app
						page
						content
					@optional
					iNtype -> string 
						in [end,begin, after, before, change]
			*/
			if( typeof iNtype != 'string' ) iNtype = 'end';
			if( d_getLengthAppHeader ({'app':iNdata['app']}) < 1 ) {
				// check app container
				d_addAppHeaderByTemplate(iNdata,iNtype);
			} else if ( typeof iNdata['page'] == 'string' && d_getLengthAppHeader(iNdata) < 1 ) {
				d_addPageAppHeaderByTemplate( iNdata,iNtype);
			}

		} _.safeAddAppHeader =safeAddAppHeader;

        function d_addPageAppHeaderByTemplate (iNdata,iNtype) {
        	/*
        		@discr
        			add content with page for app into  header block by template
        		@inputs
        			iNdata -> object
        				app
        				page
        				content
    				@optional
					iNtype -> string 
						in [end,begin, after, before, change]

        	*/
        	if( typeof iNtype != 'string') iNtype = 'end';
        	var selector = CONST['pathAppHeader'] + ' .' + CONST['nameInAppHeader']+'[app-name="'+iNdata['app']+'"]',
        		content = getPageAppHeader(iNdata);
			V_VIEW.d_addDataToViewEl(selector, content /* getPageForListApp(content) */, iNtype); 
        } _.d_addPageAppHeaderByTemplate = d_addPageAppHeaderByTemplate;


	        function d_hideMenuHeader (iNdata) {
	        	/*
	        		@discr
	        			hide app page of header
	        		@inputs
	        			iNdata -> object
	        				app  -> string
	        	*/
	        	$( 
	        		CONST['pathMenuHeader'] + ' ' 	+ 
	        		'.'+CONST['nameInMenuHeader'] 	+
        			'[app-name="' + iNdata['app'] + '"]'
        		).hide();
	        } _.d_hideMenuHeader = d_hideMenuHeader;



	        function d_checkMenuHeader (iNdata) {
		    	/*
					@discr
						update isset page in list app by object (iNdata)
					@inputs
						@required
							iNdata -> object
								page 		-> string
								app 	-> string
								@optional
									extra		-> string
						@optional
					@return
						int : 0 - false, 0< true
				*/
				var selector = '#menusBlock .topBlockInMenusBlock .menuHeaderInMenusBlock[app-name="'+iNdata['app']+'"] .appPage[view-name="'+iNdata['page']+'"]';
				if(typeof(iNdata['extra']) == 'string') selector += ' ' + iNdata['extra'];
		    	return $(selector).length;
		    } _.d_checkMenuHeader = d_checkMenuHeader;



	        function d_removeMenuHeader (iNdata) {
	        	/*
	        		@discr
	        			hide app page of header
	        		@inputs
	        			iNdata -> object
	        				app  -> string
	        	*/
	        	$( 
	        		CONST['pathMenuHeader'] + ' ' 	+ 
	        		'.'+CONST['nameInMenuHeader'] 	+
        			'[app-name="' + iNdata['app'] + '"]'
        		).remove();
	        } _.d_removeMenuHeader = d_removeMenuHeader;

		        function d_hideMenuPagesHeader (iNdata) {
		        	/*
		        		@discr
		        			hide app page of header
		        		@inputs
		        			iNdata -> object
		        				app  -> string
		        	*/
		        	$( 
		        		CONST['pathMenuHeader'] + ' ' 		+ 
		        		'.'+CONST['nameInMenuHeader'] 			+
	        			'[app-name="' + iNdata['app'] + '"] '	+
	        			'.'+CONST['pageNameInMenuHeader']
	        		).hide();
		        } _.d_hideMenuPagesHeader = d_hideMenuPagesHeader;

	        function d_showMenuHeader (iNdata) {
	        	/*
	        		@discr
	        			show app of menu header
	        		@inputs
	        			iNdata -> object
	        				app  -> string
	        	*/
	        	$( 
	        		CONST['pathMenuHeader'] + ' ' 		+ 
	        		'.'+CONST['nameInMenuHeader']  		+
	        		'[app-name="'+ iNdata['app'] +'"]' 
        		).show();
	        } _.d_showMenuHeader = d_showMenuHeader;

		        function d_showMenuPageHeader (iNdata) {
		        	/*
		        		@discr
		        			show app of menu header
		        		@inputs
		        			iNdata -> object
		        				app  -> string
		        				page -> string
		        	*/
		        	$(
		        		CONST['pathMenuHeader'] + ' ' 		+ 
		        		'.'+CONST['nameInMenuHeader']  		+
		        		'[app-name="'+ iNdata['app'] +'"]' + ' '+ 
		        		'.'+CONST['pageNameInMenuHeader']  +
		        		'[page-name="'+ iNdata['page'] +'"]' 
	        		).show();
		        } _.d_showMenuPageHeader = d_showMenuPageHeader;

            function d_viewMenuPageHeader (iNdata) {
	        	/*
	        		@discr
	        			wathc app page of menu header
	        		@inputs
	        			iNdata -> object
	        				app  -> string
	        				page -> string
	        	*/
	        	// hide apps
	        	d_hideMenuHeader(iNdata);

	        	// show this app
	        	d_showMenuHeader(iNdata); 

				// hide other pages app
	        	d_hideMenuPagesHeader(iNdata);

	        	// show this page
	        	d_showMenuPageHeader(iNdata); 
	        } _.d_viewMenuPageHeader = d_viewMenuPageHeader;

	        function d_setMenuHeader (iNcontent) {
	        	/*
	        		@discr
	        			set content for app into menu header block
	        		@inputs
	        			iNcontent -> string
				*/
	        	$( CONST['pathMenuHeader']).html(iNcontent);
	        } _.d_setMenuHeader = d_setMenuHeader;

	        function safeViewMenuHeaderWithContent (iNdata,iNtype) {
				/*
					@discr
						add safe content to menu header and view this
					@inputs
						iNdata -> object
							app
							page
							content
						@optional
						iNtype -> string 
							in [end,begin, after, before, change]
				*/
				if( typeof iNtype != 'string' ) iNtype = 'end';
				safeAddAppMenuHeader(iNdata,iNtype);
				//view this menu 
				d_viewMenuPageHeader(iNdata);
			} _.safeViewMenuHeaderWithContent = safeViewMenuHeaderWithContent;

			function safeAddAppMenuHeader (iNdata,iNtype) {
				/*
					@discr
						add safe content to menu app header
					@inputs
						iNdata -> object
							app
							page
							content
						@optional
						iNtype -> string 
							in [end,begin, after, before, change]
				*/
				if( typeof iNtype != 'string' ) iNtype = 'end';
				if( d_getLengthMenuHeader ({'app':iNdata['app']}) < 1 ) {
					// check app container
					d_addAppMenuHeaderByTemplate(iNdata,iNtype);
				} else if ( typeof iNdata['page'] == 'string' && d_getLengthMenuHeader(iNdata) < 1 ) {
					// check page container
					d_addPageMenuHeaderByTemplate( iNdata,iNtype);
				}
			} _.safeAddAppMenuHeader = safeAddAppMenuHeader;

	        	function getAppMenuHeader (iNdata) {
		        	/*
		        		@discr
		        			get content for app menu headery by template
		        		@inputs
		        			iNdata -> object
		        				@required
		        					app
		        				@optional
		        					page
		        					content
		        					attr
					*/
	        		var temp = Template7.compile(templates['appContentMenuHeader']);
	        		return temp(iNdata)
	        	} _.getAppMenuHeader = getAppMenuHeader;

	        	function d_getLengthMenuHeader (iNdata) {
	        	/*
	        		@discr
	        			get length of elements or 0
	        		@inputs
	        			iNdata -> string
	        				app
        					@optional
	        					page
	        	*/
	        	var selector = CONST['pathMenuHeader'] + ' .' + CONST['nameInMenuHeader'] + '[app-name="'+iNdata['app']+'"]';
	        	if ( typeof iNdata['page'] == 'string' )
	        		selector += '.' + CONST['pageNameInMenuHeader'] + '[page-name="'+ iNdata['page'] +'"]';
	        	return $(selector).length;
	        }

	        	function getPageMenuHeader (iNdata) {
		        	/*
		        		@discr
		        			get content for app menu headery by template
		        		@inputs
		        			iNdata -> object
		        				@required
		        					page
		        					content
		        				@optional
					*/
	        		var temp = Template7.compile(templates['pageContentMenuHeader']);
	        		return temp(iNdata)
	        	} _.getPageMenuHeader = getPageMenuHeader;

	        function d_addAppMenuHeaderByTemplate (iNdata,iNtype) {
	        	/*
	        		@discr
	        			add content for app into menu header block by template
	        		@inputs
	        			iNdata -> object
	        				app
	        				page
	        				content
	        				@optional
	        					other
	    				iNtype -> string
	    					in [end,begin, after, before, change]
	        	*/
				if( typeof iNtype != 'string' ) iNtype = 'end';
	        	var selector = CONST['pathMenuHeader'],
	        		content = getAppMenuHeader(iNdata);
	        	// d_addAppHeaderByTemplate(iNdata,iNtype);
				V_VIEW.d_addDataToViewEl(selector, content ,iNtype);//getPageForListApp(content)
	        } _.d_addAppMenuHeaderByTemplate = d_addAppMenuHeaderByTemplate;
	        


	        function d_addPageMenuHeaderByTemplate (iNdata,iNtype) {
	        	/*
	        		@discr
	        			add content with page for app into menu header block by template
	        		@inputs
	        			iNdata -> object
	        				app
	        				page
	        				content
	        				@optional
	        					other
    					iNtype -> string
    						in [end,begin, after, before, change]
	        	*/
	    		
				if( typeof iNtype != 'string' ) iNtype = 'end';		
	        	var selector = CONST['pathMenuHeader'] + ' .' + CONST['nameInMenuHeader']+'[app-name="'+iNdata['app']+'"]',
	        		content = getPageMenuHeader(iNdata);
				V_VIEW.d_addDataToViewEl(selector, content ,iNtype);
	        } _.d_addPageMenuHeaderByTemplate = d_addPageMenuHeaderByTemplate
        //> app headers

        function d_showApps (iNarray,iNtypeApp) {
        	/*
        		@example
        			d_showApps(['chat'],'chief')
        			d_showApps('chat') == d_showApps('chat','chief')
        		@disc
					did show apps in passed by 1st argument as string or array (multu effect) and by 2nd argument in Chief (default) or List container
        		@input
        			@required
	        			iNarray -> array || string
	        				(array)
	        					namesOfApp
	    					(stirng)
	    						nameOfApp
					@optional
						iNtypeApp -> string [chief || list]
							{DEFAULT - chief}
				@return
				@deps
        	*/
        	var selector, appNameForIletiral;

        	if( typeof(iNtypeApp) != 'string' || iNtypeApp == 'chief') selector = '#viewWindow .app'
        	else selector = '.usersBlockContainerInMenusBlock .app'
    		if(typeof(iNarray) !=  'object' || Array.isArray(iNarray) != true) iNarray = [iNarray];
    		for (var iKey in iNarray) {
    			appNameForIletiral = iNarray[iKey];
    			$(selector + '[app-name="' + appNameForIletiral + '"]').show();
    		}
        } _.d_showApps = d_showApps;

        function d_hideApps (iNarray,iNtypeApp) {
        	/*
        		@example
        			d_hideApps(['chat'],'chief')
        			d_hideApps('chat') == d_showApps('chat','chief')
        			d_hideApps() 		== d_showApps('all','chief')
        		@disc
					did show apps in passed by 1st argument as string or array (multu effect) and by 2nd argument in Chief (default) or List container
        		@input
        			@required
	        			iNarray -> array || string
	        				(array)
	        					namesOfApp
	    					(stirng)
	    						nameOfApp
    						Default [all]
					@optional
						iNtypeApp -> string [chief || list]
							{DEFAULT - chief}
				@return
				@deps
        	*/
        	var selector, appNameForIletiral,thisSelector;

        	if( typeof(iNtypeApp) != 'string' || iNtypeApp == 'chief') selector = '#viewWindow .app';
        	if( typeof(iNarray) != 'string' && typeof(iNarray) != 'object' ) iNarray = 'all';
        	else selector = '.usersBlockContainerInMenusBlock .app'
    		if(typeof(iNarray) !=  'object' || Array.isArray(iNarray) != true) iNarray = [iNarray];
    		for (var iKey in iNarray) {
    			thisSelector = selector
    			appNameForIletiral = iNarray[iKey];
    			if(appNameForIletiral != 'all') {
    				thisSelector += '[app-name="' + appNameForIletiral + '"]';
    			}
    			$(thisSelector).hide();
    		}
        } _.d_hideApps = d_hideApps;

        function d_removeApps (iNarray,iNtypeApp) {
        	/*
        		@example
        			d_hideApps(['chat'],'chief')
        			d_hideApps('chat') == d_showApps('chat','chief')
        			d_hideApps() 		== d_showApps('all','chief')
        		@disc
					did show apps in passed by 1st argument as string or array (multu effect) and by 2nd argument in Chief (default) or List container
        		@input
        			@required
	        			iNarray -> array || string
	        				(array)
	        					namesOfApp
	    					(stirng)
	    						nameOfApp
    						Default [all]
					@optional
						iNtypeApp -> string [chief || list]
							{DEFAULT - chief}
				@return
				@deps
        	*/
        	var selector, appNameForIletiral,thisSelector;

        	if( typeof(iNtypeApp) != 'string' || iNtypeApp == 'chief') selector = '#viewWindow .app';
        	if( typeof(iNarray) != 'string' && typeof(iNarray) != 'object' ) iNarray = 'all';
        	else selector = '.usersBlockContainerInMenusBlock .app'
    		if(typeof(iNarray) !=  'object' || Array.isArray(iNarray) != true) iNarray = [iNarray];
    		for (var iKey in iNarray) {
    			thisSelector = selector
    			appNameForIletiral = iNarray[iKey];
    			if(appNameForIletiral != 'all') {
    				thisSelector += '[app-name="' + appNameForIletiral + '"]';
    			}
    			$(thisSelector).remove();
    		}
        } _.d_removeApps =d_removeApps;

		function d_showPages (iNapp,iNarray,iNtypeApp) {
			/*
        		@example
        			d_showPages('chat',['private'],'chief')
        			d_showPages('chat','private') == d_showPages('chat','chief')
        		@disc
					did show page of apps in passed by 1nd argument as string name of app, by 2nd argument as string or array (multu effect) and by 3d argument in Chief (default) or List container
        		@input
        			@required
        				iNapp -> string
	        			iNarray -> array || string
	        				(array)
	        					namesOfApp
	    					(stirng)
	    						nameOfApp
					@optional
						iNtypeApp -> string [chief || list]
							{DEFAULT - chief}
				@return
				@deps
					function : d_showApps
        	*/
        	var selector, appName, pageNameForIletiral;
        	// show app
        	d_showApps(iNapp,iNtypeApp)
        	// choose list of chief container
        	if( typeof(iNtypeApp) != 'string' || iNtypeApp == 'chief') selector = '#viewWindow .app'
        	else selector = '.usersBlockContainerInMenusBlock .app'
    		// create array if need with page names for show
    		if(typeof(iNarray) !=  'object' || Array.isArray(iNarray) != true) iNarray = [iNarray];
    		for (var iKey in iNarray) {
    			pageNameForIletiral = iNarray[iKey];
    			$(selector + '[app-name="' + appName + '"] .view[view-name="'+pageNameForIletiral+'"]').show();
    		}
    	} _.d_showPages = d_showPages;

    	function d_viewPage (iNdata) {
    		/*
        		@example
        			d_openPage('chat','index')
        		@disc
					open page with hide all other app and other pages in this app
				@input
        			@required
        				iNdata -> object
	        				app -> string
	        				page -> string
							@optional
								type -> string
									by default 'chief' OR 'list'

				@return
				@algoritm
					#0 set default values if need
					#1 hide all pages in this app
					#2 show this page in this app
				@deps
					function : d_showPages
					function : d_hidePages
        	*/
        	if(typeof(iNdata['type']) != 'string' || iNdata['type'] != 'list') iNdata['type'] = 'chief'
        	// d_hidePages(iNdata['app'],'all',iNdata['type']);
        	d_showPages(iNdata['app'],iNdata['page'],iNdata['type']);
		} _.d_viewPage = d_viewPage;

		function d_viewApp (iNdata) {
    		/*
        		@example
        			d_viewApp('chat','index','chief')
        			d_viewApp('chat','index')
        		@disc
					open page with hide all other app and other pages in this app
				@input
        			@required
        				iNdata
	        				app -> string
						@optional
							type -> string
								by default 'chief' OR 'list'

				@return
				@algoritm
					#0 set default values if need
					#1 hide all apps
					#2 show this app
				@deps
					function : d_hideApps
					function : d_showApps
        	*/
        	if(typeof(iNdata['type']) != 'string' || iNdata['type'] != 'list') iNdata['type'] = 'chief'
        	// d_hideApps('all',iNdata['type']);
        	d_showApps(iNdata['app'],iNdata['type']);
		} _.d_viewApp = d_viewApp;

        function d_hidePages (iNapp,iNarray,iNtypeApp) {
        	/*
        		@example
        			d_hidePages('chat',['private'],'chief')
        			d_hidePages('chat','private') == d_hidePages('chat','chief')
        			d_hidePages('chat') == d_hidePages('chat','all')
        		@disc
					did hide page of apps in passed by 1nd argument as string name of app, by 2nd argument as string or array (multu effect) and by 3d argument in Chief (default) or List container
        		@input
        			@required
        				iNapp -> string
	        			iNarray -> array || string
	        				(array)
	        					namesOfApp
	    					(stirng)
	    						nameOfApp
					@optional
						iNtypeApp -> string [chief || list]
							{DEFAULT - chief}
				@return
				@deps
					function : d_hideApps
        	*/
        	var selector, appName, pageNameForIletiral, thisSelector;
        	// show app
        	d_hideApps(iNapp,iNtypeApp)
        	// choose list of chief container
        	if( typeof(iNtypeApp) != 'string' || iNtypeApp == 'chief') selector = '#viewWindow .app';
        	if( typeof(iNarray) != 'string' || typeof(iNarray) == 'object') iNarray = 'all';
        	else selector = '.usersBlockContainerInMenusBlock .app'
    		// create array if need with page names for show
    		if(typeof(iNarray) !=  'object' || Array.isArray(iNarray) != true) iNarray = [iNarray];

    		selector += '[app-name="' + appName + '"] .view';
    		for (var iKey in iNarray) {
    			thisSelector = selector;
    			pageNameForIletiral = iNarray[iKey];
    			if(pageNameForIletiral != 'all') {
    				thisSelector += '[view-name="'+pageNameForIletiral+'"]';
    			}
    			$(thisSelector).hide();
    		}
    			
        } _.d_hidePages = d_hidePages;

		

		//@> work with templates from app
	 		function getTemplate (iNapp) {
				if(typeof(iNapp.templates) == 'object')
					return iNapp.templates;
				return false;
			}

			function getPageTemplate (iNapp) {
				var template = getTemplate(iNapp);
				if(typeof(template['page']) == 'object')
					return template['page'];
				return false;
			}
			
			function getPageMenuTemplate (iNapp,iName) {
				var pageTemplate = getPageTemplate(iNapp);
				if( typeof pageTemplate['menu'] == 'object' && typeof pageTemplate['menu'][iName] != 'undefined')
					return pageTemplate['menu'][iName];
				return false;
			} _.getPageMenuTemplate = getPageMenuTemplate;

			function getPageViewTemplate (iNapp,iName) {
				var pageTemplate = getPageTemplate(iNapp);
				if(typeof(pageTemplate['view']) == 'object' && typeof(pageTemplate['view'][iName]) != 'undefined')
					return pageTemplate['view'][iName];
				return false;
			} _.getPageViewTemplate = getPageViewTemplate;

			function getAppTemplate (iNapp,iName) {
				var template = getTemplate(iNapp);
				if(typeof(template['app']) == 'object' && typeof(pageTemplate['app'][iName]) != 'undefined')
					return template['app'];
				return false;
			} _.getAppTemplate = getAppTemplate;
		//@>  work with templates  from app



		


		//@< work with header
			function d_loadCSS (filename,iNclass){ 
				var file = document.createElement("link");
				   file.setAttribute("rel", "stylesheet");
				   file.setAttribute("type", "text/css");
				   file.setAttribute("href", filename);
				   file.setAttribute("class", iNclass);
			   document.head.appendChild(file);
			} _.d_loadCSS = d_loadCSS;

			function d_loadJS (filename,iNclass) { 
			  var fileref = document.createElement('script');
				  fileref.setAttribute("type","text/javascript");
				  fileref.setAttribute("src", filename);
				  fileref.setAttribute("class", iNclass);
			  document.getElementsByTagName("head")[0].appendChild(fileref);

			} _.d_loadJS = d_loadJS;

			function d_removeByClass (iNclass) {
				$('.'+iNclass).remove();
			} _.d_removeByClass = d_removeByClass;

		//@> work with header

		//@< effects animation
		function effScrollToButtom(el,iNspeed){
	        if(typeof(iNspeed) == 'undefined') iNspeed ='slow';
	        $(el).animate({ scrollTop: $(el)[0].scrollHeight }, iNspeed);
	    } _.effScrollToButtom = effScrollToButtom;
		//@> effects animation


		//@< LINKS work with href.links
			function convertDomElementToLink (iNthis) {
				/*
					@disct
						we create link from dom element
					@inputs
						@required
						iNthis -> object (dom selector)
					@return : Void
				*/
	        	$(iNthis).addClass('appHref');
	        	$(iNthis).addClass('connect_href');
			} _ ['convertDomElementToLink'] = convertDomElementToLink;

			function convertDomElementToAppLink (iNthis,iNdata) {
				/*
					@disct
						we create link to app from dom element
					@inputs
						@required
						iNthis -> object (dom selector)
						@optional
							iNdata -> object 
								@optional
									app 	-> string (@default 'base')
									page 	-> string (@default 'index')
									data 	-> string (@default '')
					@return : Void

				*/
				if(typeof iNdata != 'object') iNdata = {};
				// create values for open app OR set default values for them
				var appName 	= iNdata['appName']||'base',
					pageName 	= iNdata['pageName']||'index',
					data 		= iNdata['data']||'';

				// create link
				convertDomElementToLink(iNthis);

	        	// then we add app name and page name
	        	$(iNthis).attr('app-name',appName);
	        	$(iNthis).attr('page-name',pageName);

	        	// add data to this links
	        	$(iNthis).attr('data',data);

			} _ ['convertDomElementToAppLink'] = convertDomElementToAppLink;

		//@> LINKS work with href.links

		//@< LODADER
			function createLoaderInAppView () {
				V_VIEW.showLoader('#viewBlock');
			}
			_.createLoaderInAppView = createLoaderInAppView;

			function delLoaderInAppView () {
				V_VIEW.closeLoader('#viewBlock');
			}
			_.delLoaderInAppView = delLoaderInAppView;

			function createLoaderInMenuView () {
				V_VIEW.showLoader('#menusBlock');
			}
			_.createLoaderInMenuView = createLoaderInMenuView;
			
			function delLoaderInMenuView () {
				V_VIEW.closeLoader('#menusBlock');
			}
			_.delLoaderInMenuView = delLoaderInMenuView;


			_.delLoader 	= V_VIEW.closeLoader;
			_.createLoader 	= V_VIEW.showLoader;

		//@> LODADER

		//@< SIDE BUTTONS
			function sideButtons_disableSelectedEffects () {
				/*
					@discr
						deleted selected class from all side buttons
					@inputs
						@required
				*/
				$('.appsBpxInAppBlock').removeClass('selected');
			} _.sideButtons_disableSelectedEffects = sideButtons_disableSelectedEffects;

			function sideButtons_addSelectedEffectsByFilter (iNfilter) {
				/*
					@discr
						add select class for show effects by filter (service id)
					@inputs
						@required
						@optional
							iNfilter -> string
				*/
				
				// remove selected class from all btn
				sideButtons_disableSelectedEffects();

				var baseClass = '.appsBpxInAppBlock';

				switch(iNfilter) {

					case "market":
						$(baseClass + '.filterMarket').addClass('selected');
					break;
					
					case "onepay":
						$(baseClass + '.filterOnepay').addClass('selected');
					break;
					
					case "sharepay":
						$(baseClass + '.filterSharepay').addClass('selected');
					break;
					
					case "edocument":
						$(baseClass + '.filterEdocument').addClass('selected');
					break;

					default :
						$(baseClass + '.filterAll').addClass('selected');
					break;
				}
			} _.sideButtons_addSelectedEffectsByFilter = sideButtons_addSelectedEffectsByFilter;
		//@> SIDE BUTTONS

		function clear () {
			// right header
			$('#menusBlock .topBlockInMenusBlock').html('');
			// right body
	        $('#menusBlock .usersBlockContainerInMenusBlock').html('');

			// left header
	        $('#viewBlock .topBlockInViewBlock').html('');
			// left body
	        $('#viewBlock #viewAndChatBlockInViewBlock').html('');
		} _.clear = clear;

		return _;
  //       return {
		//   // loader
		//   	delLoaderInMenuView 	: delLoaderInMenuView,
		//   	createLoaderInMenuView 	: createLoaderInMenuView,
		//   	delLoaderInAppView 		: delLoaderInAppView,
		//   	createLoaderInAppView 	: createLoaderInAppView,
		//   	delLoader 				: V_VIEW.closeLoader,
		//   	createLoader 			: V_VIEW.showLoader,

  //   	  // functions for work with template
  //   	  	'getAppTemplate'		: getAppTemplate,
  //   	  	'getPageViewTemplate'	: getPageViewTemplate,
  //   	  	'getPageMenuTemplate'	: getPageMenuTemplate,

		//   // functions for list app
		//     'getListApp'            : getListApp,
		//     'getPageForListApp'     : getPageForListApp,
		//     'd_updatePageInListApp' : d_updatePageInListApp,
		//     'd_clearPageInListApp'  : d_clearPageInListApp,
		//     'd_checkPageInListApp'  : d_checkPageInListApp,
		//     'd_checkListApp'        : d_checkListApp,
		//     'd_createPageInListApp' : d_createPageInListApp,
		//     'd_createListApp'       : d_createListApp,

		//   // functions for chief app
		//     'getChiefApp'           : getChiefApp,
		//     'getPageForChiefApp'    : getPageForChiefApp,
		//     'd_updatePageInChiefApp': d_updatePageInChiefApp,
		//     'd_clearPageInChiefApp' : d_clearPageInChiefApp,
		//     'd_checkPageInChiefApp' : d_checkPageInChiefApp,
		//     'd_checkChiefApp'       : d_checkChiefApp,
		//     'd_createPageInChiefApp': d_createPageInChiefApp,
		//     'd_createChiefApp'      : d_createChiefApp,
		//     'addContentToChiefApp'	: addContentToChiefApp,

		//    // effect functions for chief and list apps
		//     'd_showApps'            : d_showApps,
		//     'd_hideApps'            : d_hideApps,
		//     'd_removeApps'          : d_removeApps,
		//     'd_showPages'           : d_showPages,
		//     'd_hidePages'           : d_hidePages,
		//     'd_viewPage'            : d_viewPage,
		//     'd_viewApp'             : d_viewApp,


	 //       //< functions for headers
		//     	//app menu header
		// 		    'd_addPageMenuHeaderByTemplate'		: d_addPageMenuHeaderByTemplate,
		// 		    'd_addAppMenuHeaderByTemplate'		: d_addAppMenuHeaderByTemplate,
		// 		    'safeViewAppHeaderWithContent'		: safeViewAppHeaderWithContent, // @new of 24 08 2017
		// 		    'safeAddAppHeader'					: safeAddAppHeader, // @new of 24 08 2017
		// 		    'getPageMenuHeader'           		: getPageMenuHeader,
		// 		    'getAppMenuHeader'           		: getAppMenuHeader,
		// 		    'd_setMenuHeader'            		: d_setMenuHeader,
		// 		    'd_viewMenuPageHeader' 				: d_viewMenuPageHeader,
		// 		    'd_showMenuPageHeader' 				: d_showMenuPageHeader,
		// 		    'd_showMenuHeader'            		: d_showMenuHeader,
		// 		    'd_hideMenuPagesHeader'           	: d_hideMenuPagesHeader,
		// 		    'd_hideMenuHeader'          		: d_hideMenuHeader,
		// 		    'd_removeMenuHeader'          		: d_removeMenuHeader,
		// 		    'd_checkMenuHeader'				: d_checkMenuHeader,

		//     	//app header
		// 		    'd_addPageAppHeaderByTemplate'		: d_addPageAppHeaderByTemplate,
		// 		    'd_addAppHeaderByTemplate'			: d_addAppHeaderByTemplate,
		// 		    'safeViewMenuHeaderWithContent'		: safeViewMenuHeaderWithContent, // @new of 24 08 2017
		// 		    'safeAddAppMenuHeader'				: safeAddAppMenuHeader, // @new of 24 08 2017
		// 		    'getPageAppHeader'           		: getPageAppHeader,
		// 		    'getAppHeader'           			: getAppHeader,
		// 		    'd_setAppHeader'            		: d_setAppHeader,
		// 		    'd_viewAppPageHeader' 				: d_viewAppPageHeader,
		// 		    'd_showAppPageHeader' 				: d_showAppPageHeader,
		// 		    'd_showAppHeader'            		: d_showAppHeader,
		// 		    'd_hideAppPagesHeader'           	: d_hideAppPagesHeader,
		// 		    'd_hideAppHeader'          			: d_hideAppHeader,
		// 		    'd_removeAppHeader'          		: d_removeAppHeader,
	 //       //> functions for headers

		// 	//work with header
		// 		'd_loadCSS' 		: d_loadCSS,
		// 		'd_loadJS' 			: d_loadJS,
		// 		'd_removeByClass' 	: d_removeByClass,

		// 	//effects
		// 		'effScrollToButtom' 		: effScrollToButtom,

		// }

});
define('m_app',['v_app','jquery','v_view'],function(VIEW,$,V_VIEW) {
	const _ = {'view':VIEW};
	// create temp local storage for works 
	window.connectTempLocalStorage = {};

	//@<<< TIME FUNCTIONS
		function _getSec () {
		    return new Date().getTime()/1000;
		}
		_['getSec'] = _getSec;

		function _getTime () {
		    return new Date().getTime();
		}
		_['getTime'] = _getTime;
	//@>>> TIME FUNCTIONS

	//@<<< LOCAL STORAGE
			function _getLocalStorage () {
		    	return localStorage;
			}
			_['getLocalStorage'] = _getLocalStorage;

			function getStringOfLocalStorage() {
	          var a = {}, lstorage = _getLocalStorage();
	          for (var i = 0; i < lstorage.length; i++) {
	              var k = lstorage.key(i);
	              var v = lstorage.getItem(k);
	              a[k] = v;
	          }
	          var s = JSON.stringify(a);
	          return s;
	      }
	      _['getStringOfLocalStorage'] = getStringOfLocalStorage;

			function _getTempStorage (argument) {
		    	return window.connectTempLocalStorage;
			}
			_['getTempStorage'] = _getTempStorage;

			function _storage_copyLocalToTemp () {
				window.connectTempLocalStorage = _getLocalStorage()||{};
			}
			_['storage_copyLocalToTemp'] = _storage_copyLocalToTemp;

		function _save ( name, value ) {
			if ( getGlobalVar('m_routing').getUserDomain() ) {
				//if we are in subdomain
				 _saveTempStorage( name, value );
			} 
				//if we are in chief site
		    	return _saveLocalStorage ( name , value );

			
			// 		_saveLocalStorage ( name , value );
			// return _saveTempStorage( name, value );
		}
		_['save'] = _save;

			function _saveTempStorage ( name, value ) {
				return window.connectTempLocalStorage[name] = value;
			}
			_['saveTempStorage'] = _saveTempStorage;

			function _saveLocalStorage ( name, value ) {
				return localStorage.setItem( name , value );
			}
			_['saveLocalStorage'] = _saveLocalStorage;

		function _get (name) {
	    	return _getFromLocalStorageByKey( name );
		}
		_['get'] = _get;

			function _getFromTempStorageByKey (name) {
			    return window.connectTempLocalStorage[name];
			}
			_['getFromTempStorageByKey'] = _getFromTempStorageByKey;

			function _getFromLocalStorageByKey (name) {
			    return localStorage.getItem(name);
			}
			_['getFromLocalStorageByKey'] = _getFromLocalStorageByKey;

		function _del (name) {
		    localStorage.removeItem(name);
		}
		_['del'] = _del;

		function _clear () {
			// clear temp storage
			_clearTempStorage (  );
			// clear local storage
			_clearLocalStorage(); 
		}
		_['clear'] = _clear;

			function _clearLocalStorage (argument) {
		    	localStorage.clear();
			}
			_['clearLocalStorage'] = _clearLocalStorage;

			function _clearTempStorage (argument) {
		    	window.connectTempLocalStorage = {};
			}
			_['clearTempStorage'] = _clearTempStorage;
			
	//@>>> LOCAL STORAGE

	//@@@<<< IMPORTS
		function _addScript (iNhref,iNfuntion) {
			$.getScript(iNhref, iNfuntion );//( data, textStatus, jqxhr )
		}
		_['addScript'] = _addScript;
	//@@@>>> IMPORTS

	function _forEach (data, callback){
	  for(var key in data){
	    if(data.hasOwnProperty(key)){
	      callback(key, data[key]);
	    }
	  }
	}
	_['forEach'] = _forEach;

	/*?<<< json object  */
		function _getJsonKey (ObjectThis){
		    return Object.keys(ObjectThis)[0];
		}
		_['getJsonKey'] = _getJsonKey;

		function _getJsonKeys (ObjectThis){
		    return Object.keys(ObjectThis);
		}
		_['getJsonKeys'] = _getJsonKeys;
	/*!>>> json object  */

	/*?<<< SOUND */
		function _addSource (elem, path) {
		  $('<source>').attr('src', path).appendTo(elem);
		}
		_['addSource'] = _addSource;

		    function _playSound(iNsrc){
		        var audio = $('<audio />', {
		           autoPlay : 'autoplay'
		         });
		         _addSource(audio, iNsrc);
		         audio.appendTo('body');
		    }
			_['playSound'] = _playSound;
	/*?<<< SOUND  */

	

	//@< private vars
		const globalPrefix 			= 'global-';
		const prefixForApp_ 		= 'rammanApp-';
		const prefixForGlobalApp_ 	= globalPrefix + prefixForApp_;
		const prefixForGlobalVar 	= globalPrefix + 'var-';
		const openPageName_ 		= 'openPage';
	//@> private vars

	function _setApp (iNapp) {
		/*
			@discr
				save open app in global window
			@input
				@required
					iNapp -> string
		*/
		window.rammanNowOpenedApp = iNapp;
	}
	_['setApp'] = _setApp;

	function setOpeningPageByApp (iNapp,iNpage) {
		/*
			@discr
				save open app and page in global window
			@input
				@required
					iNapp -> string
					iNpage -> string
		*/
		// _setApp(iNapp);
		window[prefixForApp_ + iNapp+'-'+openPageName_] = iNpage;
	}
	_['setOpeningPageByApp'] = setOpeningPageByApp;



	function getOpeningPageByApp (iNapp) {
		/*
			@discr
				get open page or false
			@input
				@required
					iNapp -> string
		*/
		return window[prefixForApp_ + iNapp+'-'+openPageName_] || false;
	}
	_['getOpeningPageByApp'] = getOpeningPageByApp; window.getOpeningPageByApp = getOpeningPageByApp;

	function getOpeningApp () {
		/*
			@discr
				get opening app or false
			@input
				@required
			@return
				object: app
		*/
		var thisApp = window.rammanNowOpenedApp||false;
		return thisApp;
	} _.getOpeningApp = getOpeningApp; window.getOpeningApp = getOpeningApp;

	//
	//
	function addAppToStoryLog (iNapp) {
		/*
			@discr
				add app to log fix time and count of opened times
			@input
				@required
					iNapp -> string
			@return
				object: app
		*/
		if ( typeof window['connectAppStory'] != 'object') 			window['connectAppStory'] 			= {};
		if ( typeof window['connectAppStory'][iNapp] != 'object') 	window['connectAppStory'][iNapp] 	= {};

		// fixed amount open in time
		window['connectAppStory'][iNapp]['count'] 	= (window['connectAppStory'][iNapp]['count']||0) + 1;

		// fixed open time
		window['connectAppStory'][iNapp]['time'] 	= new Date().getTime();
		
	} _.addAppToStoryLog = addAppToStoryLog;

	function addAppPageToStoryLog (iNapp,iNpage) {
		/*
			@discr
				add app of page to log fix time and count of opened times
			@input
				@required
					iNapp -> string
					iNpage -> string
			@return
				object: app
		*/
		// add app for first
		addAppToStoryLog(iNapp);

		// add page
		if ( typeof window['connectAppStory'][iNapp]['pages'] != 'object') 		window['connectAppStory'][iNapp]['pages'] 	= {};
		if ( typeof window['connectAppStory'][iNapp]['pages'][iNpage] != 'object') 		window['connectAppStory'][iNapp]['pages'][iNpage] 	= {};

		// fixed amount open in time
		window['connectAppStory'][iNapp]['pages'][iNpage]['count'] 	= (window['connectAppStory'][iNapp]['pages'][iNpage]['count']||0) + 1;

		// fixed open time
		window['connectAppStory'][iNapp]['pages'][iNpage]['time'] 	= new Date().getTime();
		
	} _.addAppPageToStoryLog = addAppPageToStoryLog;

	function getAppFromStoryLog (iNapp) {
		/*
			@discr
				get app from story for check opened app or no
			@input
				@required
					iNapp -> string
			@return
				object: app
		*/
		// add app for first


		if ( typeof window['connectAppStory'] != 'object') 			return false;
		if ( typeof window['connectAppStory'][iNapp] != 'object') 	return false;
		return window['connectAppStory'][iNapp];
		
	} _.getAppFromStoryLog = getAppFromStoryLog; 

	function getAppPageFromStoryLog (iNapp,iNpage) {
		/*
			@discr
				get page of app from story for check opened page or no
			@input
				@required
					iNapp -> string
					iNpage -> string
			@return
				false OR object: 
					{
						count -> number
						time -> number (timestamp)
					}

		*/
		// add app for first

		if(!getAppFromStoryLog(iNapp)) return false;

		
		// get page
		if ( typeof window['connectAppStory'][iNapp]['pages'] != 'object') 				return false;
		if ( typeof window['connectAppStory'][iNapp]['pages'][iNpage] != 'object') 		return false;

		return window['connectAppStory'][iNapp]['pages'][iNpage];
		
	} _.getAppPageFromStoryLog = getAppPageFromStoryLog;
	//
	//


	function _invokeOpenedApp (iNmethodName) {
		/*
			@discr
				invoke Method For Open App
			@input
				@required
				@optional
					iNmethodName -> string
		*/
		if ( typeof iNmethodName == 'string' && getOpeningApp() != false && typeof getOpeningApp()[iNmethodName] == 'function') {
			let thisFunc =  getOpeningApp()[iNmethodName];	
			thisFunc();
		}
		return getOpeningApp();
	}
	_['invokeOpenedApp'] = _invokeOpenedApp;

	function _invokeApp (iNappName,iNmethodName) {
		/*
			@example
				invo
				_invokeApp('chat','onAppear')
				_invokeApp('chat','name')

			@discr
				invoke Method of Var from global App
			@input
				@required
				@optional
					iNmethodName -> string
			@return
				false OR 
		*/
		var appName = iNappName,appPrefix = prefixForApp_+'-',method=iNmethodName;
		if( typeof(window[appPrefix+ appName]) == 'object' && typeof(window[appPrefix+ appName][method]) != 'undefined')
				switch( typeof(window[appPrefix+ appName][method]) ){
					case 'function':
						var result =  window[appPrefix+ appName][method]();
						if( typeof(result) != 'undefined' ) return result;
						return true;
					break;
					default:
						return window[appPrefix+ appName][method];
					break;
				}
		return false;
	}
	_['invokeApp'] = _invokeApp;

	//<? transactors
		function _td_hidePages (iNapp,iNarray,iNtypeApp) {
			V_VIEW.d_hidePages (iNapp,iNarray,iNtypeApp)
		}
		_['d_hidePages'] = _td_hidePages;

		function _td_showPages (iNapp,iNarray,iNtypeApp) {
			V_VIEW.d_showPages (iNapp,iNarray,iNtypeApp)
		}
		_['d_showPages'] = _td_showPages;

		function _td_showApps (iNarray,iNtypeApp) {
			V_VIEW.d_showApps (iNarray,iNtypeApp)
		}
		_['d_showApps'] = _td_showApps;

		function _td_hideApps (iNarray,iNtypeApp) {
			V_VIEW.d_hideApps (iNarray,iNtypeApp)
		}
		_['d_hideApps'] = _td_hideApps;

		function _td_openPage (iNapp,iNpage,iNtype) {
			VIEW.d_openPage (iNapp,iNpage,iNtype);
		}
		_['d_openPage'] = _td_openPage;
	//>! transactors

	//< lambda funtions
		var initFunction = (iNapp) => {

		}
	//> lambda function
	function createOrUpdateApp (objectForCreateApp,iNapp,iNdataForApp) {
		/*
			@discr
				create app with app init or invoke app update functions
			@input
				@required
					objectForCreateApp -> object
						app
						@optional
							other
							page
							content

							extra
					iNapp -> app object
					iNdataForApp -> string
				@optional
			@deps
				funciton : VIEW.d_checkChiefApp,
				funciton : VIEW.d_createChiefApp,
				funciton : getOpeningPageByApp
			@return
			@algorithm
				#1 check for isset app
				#2 [- create app] [with page] -> [did function] -> end
				#2 if (isset app) $page 
					#3 check for isset page	in view
					#4 [- create page] [with $content if isset] -> [did function] -> end
				#2 [did function] -> end
		*/
		// know about isset app
		if ( !isApp(iNapp) ) {
				// create app if its has not custom onCreate method 
				if ( typeof iNapp.onCreate != 'function' ) {
					// safe add attributes if it exists 
					var appAttr = getAppAttr(iNapp);
					if( appAttr != false) objectForCreateApp['attr'] = appAttr;

					if( typeof iNapp.getTemplate == 'function' ) 
						iNapp.getTemplate(objectForCreateApp);
					VIEW.d_createChiefApp(objectForCreateApp);
				} else {
					iNapp.onCreate ( iNdataForApp, objectForCreateApp );
				}

				//then invoke app init method
				iNapp.onInit(iNdataForApp,objectForCreateApp);
		} else if ( getOpeningPageByApp(objectForCreateApp['app']) != objectForCreateApp['page']) {
			// we safe invoke app onUpdate method
			if ( typeof(iNapp['onUpdate']) == 'function' ) iNapp.onUpdate(iNdataForApp);
		}
	}

		function isApp (iNapp) {
			/*
			 	@discr
			 		know isset app with default or custom method
		 		@input
		 			@required
		 				iNapp -> object of app
		 		@return BOOL
			*/
			if( typeof iNapp['isApp'] != 'function' )
				 return (VIEW.d_checkChiefApp ( {'app': iNapp.name } ) > 0) ? true : false;
			else 
				return iNapp['isApp']();
		}

		function isPage (iNapp,iNpage) {
			/*
			 	@discr
			 		know isset page of app  with default or custom method
		 		@input
		 			@required
		 				iNapp 	-> object of  app
		 				iNpage 	-> string
		 		@return BOOL
			*/
			var thisPage = getPageFuncitons(iNapp,iNpage);
			var objectForGetPage = {'app': iNapp.name, 'page' : iNpage };
			if( typeof thisPage['isPage'] != 'function' ) 
				 return (VIEW.d_checkPageInChiefApp ( objectForGetPage ) > 0) ? true : false;
			else
				return thisPage['isPage']();
			
		}


	function rightCloseLastAppOrAnotherPageFromThisApp (iNapp,iNdata) {
		/*
			@discr
				right closed last app with OnDisappear
			@input
				@required
					iNapp 		-> app object
					iNdata -> object
						app
						@optional
							other
							page
							content

							extra
				@optional
			@deps
			@return
			@algorithmh 
		*/
		// if we open this app from another appName != nowOpenedApp
		if ( iNdata['app'] != getOpeningApp().name ) {
			// did safe invoke onDisappear, onOut methods for app is opening now
			var pagesFunctionsFromAnotherApp =  getPageFuncitons(getOpeningApp(),getOpeningPageByApp( getOpeningApp().name ) );//  _invokeApp(getOpeningApp(),'pages');
			// did safe invoke for pages from another app onDisappear, onOut
			if ( pagesFunctionsFromAnotherApp != false) {
				// invoke onDesappear for page 
					if ( typeof(pagesFunctionsFromAnotherApp['onDisappear']) == 'function' )
						pagesFunctionsFromAnotherApp['onDisappear']();

				// invoke onOut for page
					if ( typeof(pagesFunctionsFromAnotherApp['onOut']) == 'function' )
						pagesFunctionsFromAnotherApp['onOut']();

				// hide another app page with custom or default mehtods
					if ( typeof(pagesFunctionsFromAnotherApp['onHide']) == 'function' )
						pagesFunctionsFromAnotherApp['onHide']();
					else 
						VIEW.d_hidePages(getOpeningApp().name, getOpeningPageByApp( getOpeningApp().name ));
			}


			// did safe close last open app
			_invokeOpenedApp('onDisappear');
			_invokeOpenedApp('onOut');

			// hide another app with custom or defatult methods
			if( typeof getOpeningApp()['onHide'] == 'function' ) {
				getOpeningApp()['onHide']();
			} else {
				VIEW.d_hideApps( getOpeningApp().name );
			}

			// did safe invoke thisApp.onIn in
			if ( typeof(iNapp.onIn) == 'function' ) iNapp.onIn(); 

			//did app appear functions and 
			iNapp.onAppear();
		} else if( getOpeningPageByApp(iNdata['app']) != iNdata['page']) {
			// if this app now open and this page does not open we have to invoke page open page on onDisappear
			// did safe invoke onDisappear  methods for this app
			var pagesFunctionsFromThisApp = getPageFuncitons( iNapp , getOpeningPageByApp( getOpeningApp().name ) );// _invokeApp(getOpeningApp(),'pages');

			if (pagesFunctionsFromThisApp != false) {
				// invoke safe onDesappear for page 
					if ( typeof(pagesFunctionsFromThisApp['onDisappear']) == 'function' )
						pagesFunctionsFromThisApp['onDisappear']();
			}

			// hide  app last page with custom or default mehtods
				if ( typeof(pagesFunctionsFromThisApp['onHide']) == 'function' )
					pagesFunctionsFromThisApp['onHide']();
				else 
					VIEW.d_hidePages( iNdata['app'], getOpeningPageByApp( iNdata['app'] ));		
		}
	}
	function rightInvokePageFunctions (iNapp,iNdata,objectForCreatePage,iNdataForApp) {
		/*
			@discr
			@input
				@required
					iNapp -> app object
					objectForCreatePage -> object
						app
						page
						@optional
					iNdataForApp -> string
				@optional
					iNapp 		-> app object
					iNfunction  -> function
			@deps
			@return
			@algorithm
				#1 check for isset app
				#2 [- create app] [with page] -> [did function] -> end
				#2 if (isset app) $page 
					#3 check for isset page	in view
					#4 [- create page] [with $content if isset] -> [did function] -> end
				#2 [did function] -> end
		*/
		// we invoke onInit or onUpate for page functions if it need

		// get this page functions
		var pageFunctions = getPageFuncitons(iNapp,objectForCreatePage['page']);
		if( !isPage(iNapp,objectForCreatePage['page']) ) {
			// page is not isset - create page
			// create page and invoke page init method
			// safe add attributes if it exists 
			var pageAttr = getPageAttr(iNapp,iNdata['page']);
			if( pageAttr != false) objectForCreatePage['attr'] = pageAttr;

			if( typeof pageFunctions.getTemplate == 'function' ) 
				pageFunctions.getTemplate(objectForCreatePage);
			// 
			if(typeof pageFunctions['onCreate'] == 'function')
				pageFunctions['onCreate']();
			else
				VIEW.d_createPageInChiefApp(objectForCreatePage);

			if( typeof pageFunctions.onInit == 'function') 
				pageFunctions.onInit(iNdataForApp,objectForCreatePage);

		} else {
			// page isset - change content page because if already isset
			// safe invoke page init method
			if( typeof (pageFunctions.onUpdate) == 'function') 
				pageFunctions.onUpdate(iNdataForApp,objectForCreatePage);
			else
				VIEW.d_updatePageInChiefApp(objectForCreatePage)
		}

		// set this page as openinig
		if( typeof pageFunctions['setPage'] != 'function' )
			setOpeningPageByApp(iNdata['app'],iNdata['page']);
		else
			pageFunctions['setPage'](iNdataForApp,objectForCreatePage);

		// invoke safe page appear functions
		if( typeof(pageFunctions['onAppear']) == 'function' ){
			pageFunctions ['onAppear'](iNdataForApp,objectForCreatePage);
		}

		// if we have not onView functions for pages we need invoke default viewPage functions
		if( typeof(pageFunctions['onView']) != 'function')
			VIEW.d_viewPage(objectForCreatePage);
		else // if we have override function onView for page we invoke it
			pageFunctions['onView'](iNdataForApp,objectForCreatePage);
	}
	function _readyChiefApp (iNdata,iNapp,iNdataForApp,iNfunction) {
		/*
			@discr
			@input
				@required
					iNdata -> object
						app
						@optional
							other
							page
							content

							extra
				@optional
					iNapp 		-> app object
					iNfunction  -> function
			@deps
			@return
			@algorithm
				#1 check for isset app
				#2 [- create app] [with page] -> [did function] -> end
				#2 if (isset app) $page 
					#3 check for isset page	in view
					#4 [- create page] [with $content if isset] -> [did function] -> end
				#2 [did function] -> end
		*/
		if ( typeof iNapp != 'object' ) {
			return false;
		}

		if( typeof(iNapp['onLoader']) != 'function')
			VIEW.createLoader();
		else
			iNapp['onLoader'](iNdataForApp,objectForCreateApp);

		if(iNapp['name'] != iNdata['app'] || typeof iNapp['pages'][ iNdata['page'] ] != 'object') {
			return false;
		}
		if( typeof(iNapp['onAccess']) == 'function' && !iNapp['onAccess'](iNdataForApp,objectForCreateApp) ) {
			return false;
		}

		var dataForCheckApp, issetApps, objectForCreateApp,intIssetPages,objectForCreatePage;
		// create obj for check for isset app
		dataForCheckApp = {'app':iNdata['app'],'page':iNdata['page']};
		if ( typeof(iNdata['extra']) == 'string' ) dataForCheckApp['extra'] = iNdata['extra'];
		// create app if is not isset
		objectForCreateApp  = _clone(dataForCheckApp);
		objectForCreatePage = _clone(dataForCheckApp);
		// prepare obj for create app 
		if(typeof(iNdata['other']) 		== 'string') 	objectForCreateApp['other'] 	= iNdata['other'];
		if(typeof(iNdata['content']) 	== 'string') 	objectForCreateApp['content'] 	= iNdata['content'];
		if(typeof(iNdata['page']) 		== 'string') 	objectForCreateApp['page'] 		= iNdata['page'];

		//creating app or invoke on update
		createOrUpdateApp ( objectForCreateApp, iNapp, iNdataForApp );

		// safe right closed app another app what is opening now or close open page
		rightCloseLastAppOrAnotherPageFromThisApp (iNapp,iNdata);

		// set this app and page as opening now 
		
		// if we have not onViewApp functions we need invoke default viewApp functions
		if( typeof(iNapp['onView']) != 'function')
			VIEW.d_viewApp(objectForCreateApp);
		else // if we have override function we invoke it
			iNapp['onView'](iNdataForApp,objectForCreateApp);

		// set this app as openinig if this app inited
		if ( typeof iNapp['setApp'] != 'function' )
			_setApp ( iNapp );
		else
			iNapp['setApp']( iNdataForApp , iNdata );

		// add app to log
		addAppPageToStoryLog(iNdata['app'],iNdata['page'])


		// invoke app on appear functions
		iNapp['onAppear'] ( iNdataForApp , iNdataForApp );

		// right functions OnInit OnUpdate OnDisappear
		rightInvokePageFunctions (iNapp,iNdata,objectForCreatePage,iNdataForApp);


		// safe did appear function for page
		// if(typeof(iNapp.pages[objectForCreateApp['page']].onAppear) == 'function') iNapp.pages[objectForCreateApp['page']].onAppear();
		// did show this app + show if need and invoke onEnter if need ADD
		// VIEW._d_viewPage(objectForCreateApp);

		// safe invoke passed function
		if (typeof(iNfunction) == 'function')iNfunction();
	}
	_['readyChiefApp'] = _readyChiefApp;

	
	function _readyListApp (iNdata, iNapp,iNfunction) {
		/*
			@discr
			@input
				@required
					iNdata -> object
						app
						@optional
							other
							page
							content

							extra
				@optional
					iNfunction -> object
						createApp  : function
						createPage : function
						createPage : function
			@deps
			@return
			@algorithm
				#1 check for isset app
				#2 [- create app] [with page] -> [did function] -> end
				#2 if (isset app) $page 
					#3 check for isset page	in view
					#4 [- create page] [with $content if isset] -> [did function] -> end
				#2 [did function] -> end
		*/
		var dataForCheckApp, issetApps, objectForCreateApp,intIssetPages,objectForCreatePage,pagesAttr;
		// create obj for check for isset app
		// dataForCheckApp = {'app':iNdata['app']};
		if(typeof(iNdata['extra']) == 'string') dataForCheckApp['extra'] = iNdata['extra'];
		// get count this apps
		issetApps = VIEW.d_checkListApp(dataForCheckApp);
		// create app if it is not isset

		// prepare obj
		objectForCreateApp = {'app':iNdata['app']};
		// if(typeof(iNdata['attr']) == 'string') 		objectForCreateApp['attr'] 		= iNdata['attr'];
		if(typeof(iNdata['other']) == 'string') 	objectForCreateApp['other'] 	= iNdata['other'];
		// if(typeof(iNdata['content']) == 'string') 	objectForCreateApp['content'] 	= iNdata['content'];
		if(typeof(iNdata['page']) == 'string') 		objectForCreateApp['page'] 		= iNdata['page'];

		if (issetApps < 1) {
			VIEW.d_createPageInListApp(objectForCreateApp);
		} 

		if( typeof(iNdata['page'] ) == 'string' ) {
			objectForCreatePage = {'page':iNdata['page'],'app':iNdata['app']};

			// get page menus attr for list app
			pagesMenusAttr = getPageMenusAttr(iNapp,iNdata['page']);
			if( pagesMenusAttr != false) 	objectForCreatePage['attr'] 	= pagesMenusAttr;

			if( typeof(iNdata['content']) == 'string') 	objectForCreatePage['content'] 	= iNdata['content'];

			intIssetPages = VIEW.d_checkPageInListApp(objectForCreatePage);
			if(intIssetPages < 1) {
				//if page is not isset
				VIEW.d_createPageInListApp(objectForCreatePage);
			} else {
				// page isset - change content if isset
				// VIEW.d_updatePageInListApp(objectForCreatePage)
			}
		}
		if (typeof(iNfunction) == 'function')iNfunction();
	}
	_['readyListApp'] = _readyListApp;


	//@< getter for pages from app funcitons
		function getPageMenus (iNapp,iName) {
			var page = getPage(iNapp,iName);
			if( 
				page != false && 
				typeof page['menus'] == 'object'  
			) {
				return page['menus'];
			}
			return false;
		}

		function getPageFuncitons (iNapp,iName) {
			var page = getPage(iNapp,iName);
			if( 
				page != false && 
				typeof page['functions'] == 'object'  
			) {
				return page['functions'];
			}
			return false;
		}
		function getPageMenusAttr (iNapp,iName) {
			var menus = getPageMenus(iNapp,iName);
			if( 
				menus != false  && 
				typeof menus['attr'] == 'object' 
			) {
				return iNapp['pages'][ iName ]['menus']['attr'];
			}
			return false;
		}
		function getPages (iNapp) {
			if( 
				typeof(iNapp) == 'object' && 
				typeof iNapp['pages'] == 'object' 
			) {
				return iNapp['pages'];
			}
			return false;
		}
		function getPage (iNapp,iName) {
			var pages = getPages(iNapp);
			if( 
				pages != false && 
				typeof pages[ iName ] == 'object'  
			) {
				return pages[ iName ];
			}
			return false;

		}
		function getPageAttr (iNapp,iName) {
			var page = getPage(iNapp,iName);
			if( 
				page != false && 
				typeof page['attr'] == 'object'  
			) {
				return page['attr'];
			}
			return false;
		}
	//@> getter for pages from app funcitons

	//@< getter for  options from app funcitons
		function getAppOptions (iNapp) {
			if( 
				typeof(iNapp) == 'object' && 
				typeof iNapp['options'] == 'object' 
			) {
				return iNapp['options'];
			}
			return false;
		}
		function getAppAttr (iNapp) {
			var options = getAppOptions(iNapp);
			if( 
				options != false && 
				typeof options['attr'] == 'object'  
			) {
				return options['attr'];
			}
			return false;
		}
		function getAppMenus (iNapp) {
			var options = getAppOptions(iNapp);
			if( 
				options != false && 
				typeof options['menus'] == 'object'  
			) {
				return options['menus'];
			}
			return false;
		}
		function getAppMenusAttr (iNapp) {
			var menus = getAppMenus(iNapp);
			if( 
				menus != false && 
				typeof menus['attr'] == 'object'  
			) {
				return menus['attr'];
			}
			return false;
		}

	//@> getter for  options from app funcitons



	function _openChiefApp (iNdata,iNapp,iNstring,iNfunction) {
		/*
			@discr
			@example
				_openChiefApp({'app':'chat'}
			@input
				@required
					iNdata -> object
						app
						@optional
							other
							page
							content

							extra
				@optional
					iNfunction -> function
			@deps
				function : _readyApp
			@return
			@algorithm
				#1 show loader
				#2 invoke func ready app
				#3 close loader
		*/
		
		_readyChiefApp (iNdata,iNapp,iNstring,function () {
			if(typeof(iNfunction) == 'function') iNfunction();
			// VIEW.createLoader();
		});
	}
	_['openChiefApp'] = _openChiefApp;

	function _openListApp (iNdata,iNfunction) {
		/*
			@discr
			@input
				@required
					iNdata -> object
						app
						@optional
							other
							page
							content

							extra
				@optional
					iNfunction -> function
			@deps
				function : _readyApp
			@return
			@algorithm
				#1 show loader
				#2 invoke func ready app
				#3 close loader
		*/
		VIEW.createLoader();
		_readyListApp (iNdata,function () {
			if(typeof(iNfunction) == 'function') iNfunction();
			VIEW.createLoader();
		});
	}
	_['openListApp'] = _openListApp;
	

	// function _openApp ( iNdata, iNapp,iNtype) {
	// 	/*
	// 		@disc
	// 			open app
	// 				check funcitons optional
	// 				check apps
	// 				check pages
					
	// 		@input
	// 			@input
	// 				@required
	// 					iNdata
	// 						@required
	// 							app
	// 							page
	// 						@optional
	// 							extra
	// 							content
	// 							other
	// 					iNapp -> app object
	// 				@optional
	// 					iNtype

	// 		@deps
	// 			function : getAppByName 
	// 	*/

	// 	//get module name by app name
	// 	var page, objForOpenApp = iNdata, appName = objForOpenApp['app'], pageName = objForOpenApp['page'];
	// 	// iNapp = getAppByName(appName);
	// 	if ( typeof(iNapp.pages) != 'object' || typeof(iNapp.pages[pageName]) != 'object' ) return false;
	// 	//get data from pages
	// 	page = iNapp.pages[pageName];



	// 	_openChiefApp ( objForOpenApp ,iNapp, function () {
	// 		if( typeof(iNapp['onStart']) == 'function' ) iNapp.onStart();
	// 		// iNapp.onInit();

	// 		if ( typeof(iNapp['openPage']) != 'function' )
	// 			d_openPage(appName,pageName, iNtype);
	// 		else
	// 			iNapp.openPage( appName, pageName, iNtype);
	// 		iNapp.onAppear();
	// 		if( typeof(iNapp['onFinish']) == 'function' ) iNapp.onFinish();
	// 	});
	// }

	function _closeApp (iName,iNpage) {
		/*
			@disc
			@deps
				function : getAppByName
		*/

		//get module name by app name
		var app = getAppByName(iName);
		app.onDisappear();
		app.onClose();
	}
	_['closeApp'] = _closeApp;

	function _clone(obj) {
	    if (null == obj || ( "object" != typeof obj && "array" != typeof obj )) return obj;
	    if(Array.isArray(obj) == true) {
	    	return obj.slice();
	    }
	    var copy = obj.constructor();
	    for (var attr in obj) {
	        if (obj.hasOwnProperty(attr)) copy[attr] = obj[attr];
	    }
	    return copy;
	}
	_['clone'] = _clone;




	function getGlobalApp(iNname){
		if( typeof window[prefixForGlobalApp_+iNname] == 'undefined' )
			return false;
		return window[prefixForGlobalApp_+iNname];
	}
	_['getGlobalApp'] = getGlobalApp;

	function setGlobalApp(iNapp){

		if( typeof window[prefixForGlobalVar+iNapp.name] == 'undefined' && typeof iNapp == 'object' && typeof iNapp.name == 'string') {
			window[prefixForGlobalApp_+iNapp.name] = iNapp;
		}
	}
	_['setGlobalApp'] = setGlobalApp;

	function getGlobalVar (iNname) {
		if( typeof window[prefixForGlobalVar+iNname] == 'undefined' )
			return false;
		return window[prefixForGlobalVar+iNname];
	}
	_['getGlobalVar'] = getGlobalVar;

	function setGlobalVar(iNname,iNobject){
		if( typeof window[prefixForGlobalVar+iNname] == 'undefined' && typeof iNobject == 'object' && typeof iNname == 'string') {
			window[prefixForGlobalVar+iNname] = iNobject;
		}
	}
	_['setGlobalVar'] = setGlobalVar;


	//@< work with header
		// var _td_loadCSS  		= VIEW.d_loadCSS;
		// var _td_removeByClass  	= VIEW.d_removeByClass;
		// var _td_loadJS  		= VIEW.d_loadJS;
		// _['d_loadCSS'] = _td_loadCSS;
	//@< work with header


	//@< work with global functions
	function globalFunctions_invoke (iName) {
		if(typeof window.GF == 'object' && typeof window.GF[iName] == 'function') {
			window.GF[iName]();
			return true;
		}
		return false;
	}
	_['globalFunctions_invoke'] = globalFunctions_invoke;

	function globalFunctions_create (iName, iNfunction) {
		if(typeof window.GF != 'object') window.GF = {};
		window.GF[iName] = iNfunction;
		return true;
	}
	_['globalFunctions_create'] = globalFunctions_create;
	//@> work with global functions

	return _;
	// {
	// 	'globalFunctions_invoke' : globalFunctions_invoke,
	// 	'globalFunctions_create' : globalFunctions_create,

	//     'openChiefApp'  : _openChiefApp,
	//     'openListApp'   : _openListApp,
	//     'readyListApp'  : _readyListApp,
	//     'readyChiefApp' : _readyChiefApp,
	//     'invokeOpenApp' : _invokeOpenedApp,
	//     'invokeApp' 	: _invokeApp,
	//     'clone' 		: _clone,

	//     'setApp' 		: _setApp,
	//     'setPage' 		: setOpeningPageByApp,
	//     'thisApp' 		: getOpeningApp,
	//     'thisPage' 		: getOpeningPageByApp, 

	//     'd_hidePages'   : _td_hidePages,
	//     'd_showPages'   : _td_showPages,
	//     'd_hideApps'    : _td_hideApps,
	//     'd_showApps'    : _td_showApps,
	//     'd_openPage'    : _td_openPage,

	//     //work with header
	//     'd_loadCSS' 		: _td_loadCSS,
	//     'd_loadJS' 			: _td_loadJS,
	//     'd_removeByClass' 	: _td_removeByClass,
	// 	'addScript' 		: _addScript,

	//     //  time functions
	//     'getSec' : _getSec,
	// 	'getTime' : _getTime,

	// 	//  local storage
	// 	'save' : _save,
	// 	'get' : _get,
	// 	'del' : _del,
	// 	'clear' : _clear,

	// 	//  object functions
	// 	'getJsonKey' : _getJsonKey,
	// 	'getJsonKeys' : _getJsonKeys,
	// 	'forEach' : _forEach,

	// 	//  audio functions
	// 	'playSound' : _playSound,
	// 		'addSource' : addSource,


	// 	//  global resourse
	// 	'setGlobalApp' : setGlobalApp,
	// 	'setGlobalVar' : setGlobalVar,
	// 	'getGlobalVar' : getGlobalVar,
	// 	'getGlobalApp' : getGlobalApp,

	// 	'view' : VIEW
	// }
});
define('url',[],function () {
	const URL = {};
	const _ = {'db':URL};

	//@< user files
		URL['gstorage'] = 'https://gstorage.ramman.net';
		URL['cdn'] 		= 'https://cdn.ramman.net';
		URL['main'] 	= 'https://ramman.net';

		URL['userNonePhoto']= URL['cdn'] + '/web/res/images/icons/user/noPhoto.png';
		URL['userNonePhoto']= URL['cdn'] + '/web/res/images/icons/user/noPhoto.png';


		function getUserIconByUid (iNuid) {
		    return  URL['gstorage'] + '/users/' + iNuid + '/public/icons/1.jpg';
		} _.getUserIconByUid = getUserIconByUid;

		function getChatIconByChatId (iNchatId) {
		    return  URL['gstorage'] + '/chats/' + iNchatId + '/public/icons/1.jpg';
		} _.getChatIconByChatId = getChatIconByChatId;
	//@>



	//@< api 
		const API = {}; URL.api = API;

		//@< api > chat
			const APICHAT 		= {}; API['chat'] = APICHAT;
			APICHAT['create'] 	= URL['main'] + '/api/chat';
		//@> api > chat

      	//@< api > page
			const APIPAGE 		= {}; API['page'] = APIPAGE;
			APIPAGE['get'] 		= URL['main'] + '/api/service/page';
		//@> api > page

		//@< api > user
			const APIUSER 		= {}; API['user'] = APIUSER;
			APIUSER['sign']		= URL['main'] + '/api/web/sign';
		//@> api > user


		//@< api > getUrl
			const APIGETURL 		= {}; API['getUrl'] = APIGETURL;
			APIGETURL['forChat']	= URL['main'] + '/api/geturl/chat';
		//@> api > getUrl

	//@> api 





	return _;
});
/*! Simple JavaScript Inheritance
 * By John Resig http://ejohn.org/
 * MIT Licensed.
 */
!function(){"use strict";var a=!1;window.JQClass=function(){},JQClass.classes={},JQClass.extend=function b(c){function d(){!a&&this._init&&this._init.apply(this,arguments)}var e=this.prototype;a=!0;var f=new this;a=!1;for(var g in c)if("function"==typeof c[g]&&"function"==typeof e[g])f[g]=function(a,b){return function(){var c=this._super;this._super=function(b){return e[a].apply(this,b||[])};var d=b.apply(this,arguments);return this._super=c,d}}(g,c[g]);else if("object"==typeof c[g]&&"object"==typeof e[g]&&"defaultOptions"===g){var h,i=e[g],j=c[g],k={};for(h in i)k[h]=i[h];for(h in j)k[h]=j[h];f[g]=k}else f[g]=c[g];return d.prototype=f,d.prototype.constructor=d,d.extend=b,d}}(),/*! Abstract base class for collection plugins v1.0.2.
	Written by Keith Wood (wood.keith{at}optusnet.com.au) December 2013.
	Licensed under the MIT license (http://keith-wood.name/licence.html). */
function($){"use strict";function camelCase(a){return a.replace(/-([a-z])/g,function(a,b){return b.toUpperCase()})}JQClass.classes.JQPlugin=JQClass.extend({name:"plugin",defaultOptions:{},regionalOptions:{},deepMerge:!0,_getMarker:function(){return"is-"+this.name},_init:function(){$.extend(this.defaultOptions,this.regionalOptions&&this.regionalOptions[""]||{});var a=camelCase(this.name);$[a]=this,$.fn[a]=function(b){var c=Array.prototype.slice.call(arguments,1),d=this,e=this;return this.each(function(){if("string"==typeof b){if("_"===b[0]||!$[a][b])throw"Unknown method: "+b;var f=$[a][b].apply($[a],[this].concat(c));if(f!==d&&void 0!==f)return e=f,!1}else $[a]._attach(this,b)}),e}},setDefaults:function(a){$.extend(this.defaultOptions,a||{})},_attach:function(a,b){if(a=$(a),!a.hasClass(this._getMarker())){a.addClass(this._getMarker()),b=$.extend(this.deepMerge,{},this.defaultOptions,this._getMetadata(a),b||{});var c=$.extend({name:this.name,elem:a,options:b},this._instSettings(a,b));a.data(this.name,c),this._postAttach(a,c),this.option(a,b)}},_instSettings:function(a,b){return{}},_postAttach:function(a,b){},_getMetadata:function(elem){try{var data=elem.data(this.name.toLowerCase())||"";data=data.replace(/(\\?)'/g,function(a,b){return b?"'":'"'}).replace(/([a-zA-Z0-9]+):/g,function(a,b,c){var d=data.substring(0,c).match(/"/g);return d&&d.length%2!==0?b+":":'"'+b+'":'}).replace(/\\:/g,":"),data=$.parseJSON("{"+data+"}");for(var key in data)if(data.hasOwnProperty(key)){var value=data[key];"string"==typeof value&&value.match(/^new Date\(([-0-9,\s]*)\)$/)&&(data[key]=eval(value))}return data}catch(a){return{}}},_getInst:function(a){return $(a).data(this.name)||{}},option:function(a,b,c){a=$(a);var d=a.data(this.name),e=b||{};return!b||"string"==typeof b&&"undefined"==typeof c?(e=(d||{}).options,e&&b?e[b]:e):void(a.hasClass(this._getMarker())&&("string"==typeof b&&(e={},e[b]=c),this._optionsChanged(a,d,e),$.extend(d.options,e)))},_optionsChanged:function(a,b,c){},destroy:function(a){a=$(a),a.hasClass(this._getMarker())&&(this._preDestroy(a,this._getInst(a)),a.removeData(this.name).removeClass(this._getMarker()))},_preDestroy:function(a,b){}}),$.JQPlugin={createPlugin:function(a,b){"object"==typeof a&&(b=a,a="JQPlugin"),a=camelCase(a);var c=camelCase(b.name);JQClass.classes[c]=JQClass.classes[a].extend(b),new JQClass.classes[c]}}}(jQuery);
//# sourceMappingURL=jquery.plugin.min.map;
define("jquery.plugin", ["jquery"], (function (global) {
    return function () {
        var ret, fn;
        return ret || global.JQClass;
    };
}(this)));

/*! http://keith-wood.name/countdown.html
	Countdown for jQuery v2.1.0.
	Written by Keith Wood (wood.keith{at}optusnet.com.au) January 2008.
	Available under the MIT (http://keith-wood.name/licence.html) license. 
	Please attribute the author if you use it. */
!function(a){"use strict";var b="countdown",c=0,d=1,e=2,f=3,g=4,h=5,i=6;a.JQPlugin.createPlugin({name:b,defaultOptions:{until:null,since:null,timezone:null,serverSync:null,format:"dHMS",layout:"",compact:!1,padZeroes:!1,significant:0,description:"",expiryUrl:"",expiryText:"",alwaysExpire:!1,onExpiry:null,onTick:null,tickInterval:1},regionalOptions:{"":{labels:["Years","Months","Weeks","Days","Hours","Minutes","Seconds"],labels1:["Year","Month","Week","Day","Hour","Minute","Second"],compactLabels:["y","m","w","d"],whichLabels:null,digits:["0","1","2","3","4","5","6","7","8","9"],timeSeparator:":",isRTL:!1}},_rtlClass:b+"-rtl",_sectionClass:b+"-section",_amountClass:b+"-amount",_periodClass:b+"-period",_rowClass:b+"-row",_holdingClass:b+"-holding",_showClass:b+"-show",_descrClass:b+"-descr",_timerElems:[],_init:function(){function b(a){var h=a<1e12?e?window.performance.now()+window.performance.timing.navigationStart:d():a||d();h-g>=1e3&&(c._updateElems(),g=h),f(b)}var c=this;this._super(),this._serverSyncs=[];var d="function"==typeof Date.now?Date.now:function(){return(new Date).getTime()},e=window.performance&&"function"==typeof window.performance.now,f=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||null,g=0;!f||a.noRequestAnimationFrame?(a.noRequestAnimationFrame=null,a.countdown._timer=setInterval(function(){c._updateElems()},1e3)):(g=window.animationStartTime||window.webkitAnimationStartTime||window.mozAnimationStartTime||window.oAnimationStartTime||window.msAnimationStartTime||d(),f(b))},UTCDate:function(a,b,c,d,e,f,g,h){"object"==typeof b&&b instanceof Date&&(h=b.getMilliseconds(),g=b.getSeconds(),f=b.getMinutes(),e=b.getHours(),d=b.getDate(),c=b.getMonth(),b=b.getFullYear());var i=new Date;return i.setUTCFullYear(b),i.setUTCDate(1),i.setUTCMonth(c||0),i.setUTCDate(d||1),i.setUTCHours(e||0),i.setUTCMinutes((f||0)-(Math.abs(a)<30?60*a:a)),i.setUTCSeconds(g||0),i.setUTCMilliseconds(h||0),i},periodsToSeconds:function(a){return 31557600*a[0]+2629800*a[1]+604800*a[2]+86400*a[3]+3600*a[4]+60*a[5]+a[6]},resync:function(){var b=this;a("."+this._getMarker()).each(function(){var c=a.data(this,b.name);if(c.options.serverSync){for(var d=null,e=0;e<b._serverSyncs.length;e++)if(b._serverSyncs[e][0]===c.options.serverSync){d=b._serverSyncs[e];break}if(b._eqNull(d[2])){var f=a.isFunction(c.options.serverSync)?c.options.serverSync.apply(this,[]):null;d[2]=(f?(new Date).getTime()-f.getTime():0)-d[1]}c._since&&c._since.setMilliseconds(c._since.getMilliseconds()+d[2]),c._until.setMilliseconds(c._until.getMilliseconds()+d[2])}});for(var c=0;c<b._serverSyncs.length;c++)b._eqNull(b._serverSyncs[c][2])||(b._serverSyncs[c][1]+=b._serverSyncs[c][2],delete b._serverSyncs[c][2])},_instSettings:function(a,b){return{_periods:[0,0,0,0,0,0,0]}},_addElem:function(a){this._hasElem(a)||this._timerElems.push(a)},_hasElem:function(b){return a.inArray(b,this._timerElems)>-1},_removeElem:function(b){this._timerElems=a.map(this._timerElems,function(a){return a===b?null:a})},_updateElems:function(){for(var a=this._timerElems.length-1;a>=0;a--)this._updateCountdown(this._timerElems[a])},_optionsChanged:function(b,c,d){d.layout&&(d.layout=d.layout.replace(/&lt;/g,"<").replace(/&gt;/g,">")),this._resetExtraLabels(c.options,d);var e=c.options.timezone!==d.timezone;a.extend(c.options,d),this._adjustSettings(b,c,!this._eqNull(d.until)||!this._eqNull(d.since)||e);var f=new Date;(c._since&&c._since<f||c._until&&c._until>f)&&this._addElem(b[0]),this._updateCountdown(b,c)},_updateCountdown:function(b,c){if(b=b.jquery?b:a(b),c=c||this._getInst(b)){if(b.html(this._generateHTML(c)).toggleClass(this._rtlClass,c.options.isRTL),"pause"!==c._hold&&a.isFunction(c.options.onTick)){var d="lap"!==c._hold?c._periods:this._calculatePeriods(c,c._show,c.options.significant,new Date);1!==c.options.tickInterval&&this.periodsToSeconds(d)%c.options.tickInterval!==0||c.options.onTick.apply(b[0],[d])}var e="pause"!==c._hold&&(c._since?c._now.getTime()<c._since.getTime():c._now.getTime()>=c._until.getTime());if(e&&!c._expiring){if(c._expiring=!0,this._hasElem(b[0])||c.options.alwaysExpire){if(this._removeElem(b[0]),a.isFunction(c.options.onExpiry)&&c.options.onExpiry.apply(b[0],[]),c.options.expiryText){var f=c.options.layout;c.options.layout=c.options.expiryText,this._updateCountdown(b[0],c),c.options.layout=f}c.options.expiryUrl&&(window.location=c.options.expiryUrl)}c._expiring=!1}else"pause"===c._hold&&this._removeElem(b[0])}},_resetExtraLabels:function(a,b){var c=null;for(c in b)c.match(/[Ll]abels[02-9]|compactLabels1/)&&(a[c]=b[c]);for(c in a)c.match(/[Ll]abels[02-9]|compactLabels1/)&&"undefined"==typeof b[c]&&(a[c]=null)},_eqNull:function(a){return"undefined"==typeof a||null===a},_adjustSettings:function(b,c,d){for(var e=null,f=0;f<this._serverSyncs.length;f++)if(this._serverSyncs[f][0]===c.options.serverSync){e=this._serverSyncs[f][1];break}var g=null,h=null;if(this._eqNull(e)){var i=a.isFunction(c.options.serverSync)?c.options.serverSync.apply(b[0],[]):null;g=new Date,h=i?g.getTime()-i.getTime():0,this._serverSyncs.push([c.options.serverSync,h])}else g=new Date,h=c.options.serverSync?e:0;var j=c.options.timezone;j=this._eqNull(j)?-g.getTimezoneOffset():j,(d||!d&&this._eqNull(c._until)&&this._eqNull(c._since))&&(c._since=c.options.since,this._eqNull(c._since)||(c._since=this.UTCDate(j,this._determineTime(c._since,null)),c._since&&h&&c._since.setMilliseconds(c._since.getMilliseconds()+h)),c._until=this.UTCDate(j,this._determineTime(c.options.until,g)),h&&c._until.setMilliseconds(c._until.getMilliseconds()+h)),c._show=this._determineShow(c)},_preDestroy:function(a,b){this._removeElem(a[0]),a.empty()},pause:function(a){this._hold(a,"pause")},lap:function(a){this._hold(a,"lap")},resume:function(a){this._hold(a,null)},toggle:function(b){var c=a.data(b,this.name)||{};this[c._hold?"resume":"pause"](b)},toggleLap:function(b){var c=a.data(b,this.name)||{};this[c._hold?"resume":"lap"](b)},_hold:function(b,c){var d=a.data(b,this.name);if(d){if("pause"===d._hold&&!c){d._periods=d._savePeriods;var e=d._since?"-":"+";d[d._since?"_since":"_until"]=this._determineTime(e+d._periods[0]+"y"+e+d._periods[1]+"o"+e+d._periods[2]+"w"+e+d._periods[3]+"d"+e+d._periods[4]+"h"+e+d._periods[5]+"m"+e+d._periods[6]+"s"),this._addElem(b)}d._hold=c,d._savePeriods="pause"===c?d._periods:null,a.data(b,this.name,d),this._updateCountdown(b,d)}},getTimes:function(b){var c=a.data(b,this.name);return c?"pause"===c._hold?c._savePeriods:c._hold?this._calculatePeriods(c,c._show,c.options.significant,new Date):c._periods:null},_determineTime:function(a,b){var c=this,d=function(a){var b=new Date;return b.setTime(b.getTime()+1e3*a),b},e=function(a){a=a.toLowerCase();for(var b=new Date,d=b.getFullYear(),e=b.getMonth(),f=b.getDate(),g=b.getHours(),h=b.getMinutes(),i=b.getSeconds(),j=/([+-]?[0-9]+)\s*(s|m|h|d|w|o|y)?/g,k=j.exec(a);k;){switch(k[2]||"s"){case"s":i+=parseInt(k[1],10);break;case"m":h+=parseInt(k[1],10);break;case"h":g+=parseInt(k[1],10);break;case"d":f+=parseInt(k[1],10);break;case"w":f+=7*parseInt(k[1],10);break;case"o":e+=parseInt(k[1],10),f=Math.min(f,c._getDaysInMonth(d,e));break;case"y":d+=parseInt(k[1],10),f=Math.min(f,c._getDaysInMonth(d,e))}k=j.exec(a)}return new Date(d,e,f,g,h,i,0)},f=this._eqNull(a)?b:"string"==typeof a?e(a):"number"==typeof a?d(a):a;return f&&f.setMilliseconds(0),f},_getDaysInMonth:function(a,b){return 32-new Date(a,b,32).getDate()},_normalLabels:function(a){return a},_generateHTML:function(b){var j=this;b._periods=b._hold?b._periods:this._calculatePeriods(b,b._show,b.options.significant,new Date);var k=!1,l=0,m=b.options.significant,n=a.extend({},b._show),o=null;for(o=c;o<=i;o++)k=k||"?"===b._show[o]&&b._periods[o]>0,n[o]="?"!==b._show[o]||k?b._show[o]:null,l+=n[o]?1:0,m-=b._periods[o]>0?1:0;var p=[!1,!1,!1,!1,!1,!1,!1];for(o=i;o>=c;o--)b._show[o]&&(b._periods[o]?p[o]=!0:(p[o]=m>0,m--));var q=b.options.compact?b.options.compactLabels:b.options.labels,r=b.options.whichLabels||this._normalLabels,s=function(a){var c=b.options["compactLabels"+r(b._periods[a])];return n[a]?j._translateDigits(b,b._periods[a])+(c?c[a]:q[a])+" ":""},t=b.options.padZeroes?2:1,u=function(a){var c=b.options["labels"+r(b._periods[a])];return!b.options.significant&&n[a]||b.options.significant&&p[a]?'<span class="'+j._sectionClass+'"><span class="'+j._amountClass+'">'+j._minDigits(b,b._periods[a],t)+'</span><span class="'+j._periodClass+'">'+(c?c[a]:q[a])+"</span></span>":""};return b.options.layout?this._buildLayout(b,n,b.options.layout,b.options.compact,b.options.significant,p):(b.options.compact?'<span class="'+this._rowClass+" "+this._amountClass+(b._hold?" "+this._holdingClass:"")+'">'+s(c)+s(d)+s(e)+s(f)+(n[g]?this._minDigits(b,b._periods[g],2):"")+(n[h]?(n[g]?b.options.timeSeparator:"")+this._minDigits(b,b._periods[h],2):"")+(n[i]?(n[g]||n[h]?b.options.timeSeparator:"")+this._minDigits(b,b._periods[i],2):""):'<span class="'+this._rowClass+" "+this._showClass+(b.options.significant||l)+(b._hold?" "+this._holdingClass:"")+'">'+u(c)+u(d)+u(e)+u(f)+u(g)+u(h)+u(i))+"</span>"+(b.options.description?'<span class="'+this._rowClass+" "+this._descrClass+'">'+b.options.description+"</span>":"")},_buildLayout:function(b,j,k,l,m,n){for(var o=b.options[l?"compactLabels":"labels"],p=b.options.whichLabels||this._normalLabels,q=function(a){return(b.options[(l?"compactLabels":"labels")+p(b._periods[a])]||o)[a]},r=function(a,c){return b.options.digits[Math.floor(a/c)%10]},s={desc:b.options.description,sep:b.options.timeSeparator,yl:q(c),yn:this._minDigits(b,b._periods[c],1),ynn:this._minDigits(b,b._periods[c],2),ynnn:this._minDigits(b,b._periods[c],3),y1:r(b._periods[c],1),y10:r(b._periods[c],10),y100:r(b._periods[c],100),y1000:r(b._periods[c],1e3),ol:q(d),on:this._minDigits(b,b._periods[d],1),onn:this._minDigits(b,b._periods[d],2),onnn:this._minDigits(b,b._periods[d],3),o1:r(b._periods[d],1),o10:r(b._periods[d],10),o100:r(b._periods[d],100),o1000:r(b._periods[d],1e3),wl:q(e),wn:this._minDigits(b,b._periods[e],1),wnn:this._minDigits(b,b._periods[e],2),wnnn:this._minDigits(b,b._periods[e],3),w1:r(b._periods[e],1),w10:r(b._periods[e],10),w100:r(b._periods[e],100),w1000:r(b._periods[e],1e3),dl:q(f),dn:this._minDigits(b,b._periods[f],1),dnn:this._minDigits(b,b._periods[f],2),dnnn:this._minDigits(b,b._periods[f],3),d1:r(b._periods[f],1),d10:r(b._periods[f],10),d100:r(b._periods[f],100),d1000:r(b._periods[f],1e3),hl:q(g),hn:this._minDigits(b,b._periods[g],1),hnn:this._minDigits(b,b._periods[g],2),hnnn:this._minDigits(b,b._periods[g],3),h1:r(b._periods[g],1),h10:r(b._periods[g],10),h100:r(b._periods[g],100),h1000:r(b._periods[g],1e3),ml:q(h),mn:this._minDigits(b,b._periods[h],1),mnn:this._minDigits(b,b._periods[h],2),mnnn:this._minDigits(b,b._periods[h],3),m1:r(b._periods[h],1),m10:r(b._periods[h],10),m100:r(b._periods[h],100),m1000:r(b._periods[h],1e3),sl:q(i),sn:this._minDigits(b,b._periods[i],1),snn:this._minDigits(b,b._periods[i],2),snnn:this._minDigits(b,b._periods[i],3),s1:r(b._periods[i],1),s10:r(b._periods[i],10),s100:r(b._periods[i],100),s1000:r(b._periods[i],1e3)},t=k,u=c;u<=i;u++){var v="yowdhms".charAt(u),w=new RegExp("\\{"+v+"<\\}([\\s\\S]*)\\{"+v+">\\}","g");t=t.replace(w,!m&&j[u]||m&&n[u]?"$1":"")}return a.each(s,function(a,b){var c=new RegExp("\\{"+a+"\\}","g");t=t.replace(c,b)}),t},_minDigits:function(a,b,c){return b=""+b,b.length>=c?this._translateDigits(a,b):(b="0000000000"+b,this._translateDigits(a,b.substr(b.length-c)))},_translateDigits:function(a,b){return(""+b).replace(/[0-9]/g,function(b){return a.options.digits[b]})},_determineShow:function(a){var b=a.options.format,j=[];return j[c]=b.match("y")?"?":b.match("Y")?"!":null,j[d]=b.match("o")?"?":b.match("O")?"!":null,j[e]=b.match("w")?"?":b.match("W")?"!":null,j[f]=b.match("d")?"?":b.match("D")?"!":null,j[g]=b.match("h")?"?":b.match("H")?"!":null,j[h]=b.match("m")?"?":b.match("M")?"!":null,j[i]=b.match("s")?"?":b.match("S")?"!":null,j},_calculatePeriods:function(a,b,j,k){a._now=k,a._now.setMilliseconds(0);var l=new Date(a._now.getTime());a._since?k.getTime()<a._since.getTime()?a._now=k=l:k=a._since:(l.setTime(a._until.getTime()),k.getTime()>a._until.getTime()&&(a._now=k=l));var m=[0,0,0,0,0,0,0];if(b[c]||b[d]){var n=this._getDaysInMonth(k.getFullYear(),k.getMonth()),o=this._getDaysInMonth(l.getFullYear(),l.getMonth()),p=l.getDate()===k.getDate()||l.getDate()>=Math.min(n,o)&&k.getDate()>=Math.min(n,o),q=function(a){return 60*(60*a.getHours()+a.getMinutes())+a.getSeconds()},r=Math.max(0,12*(l.getFullYear()-k.getFullYear())+l.getMonth()-k.getMonth()+(l.getDate()<k.getDate()&&!p||p&&q(l)<q(k)?-1:0));m[c]=b[c]?Math.floor(r/12):0,m[d]=b[d]?r-12*m[c]:0,k=new Date(k.getTime());var s=k.getDate()===n,t=this._getDaysInMonth(k.getFullYear()+m[c],k.getMonth()+m[d]);k.getDate()>t&&k.setDate(t),k.setFullYear(k.getFullYear()+m[c]),k.setMonth(k.getMonth()+m[d]),s&&k.setDate(t)}var u=Math.floor((l.getTime()-k.getTime())/1e3),v=null,w=function(a,c){m[a]=b[a]?Math.floor(u/c):0,u-=m[a]*c};if(w(e,604800),w(f,86400),w(g,3600),w(h,60),w(i,1),u>0&&!a._since){var x=[1,12,4.3482,7,24,60,60],y=i,z=1;for(v=i;v>=c;v--)b[v]&&(m[y]>=z&&(m[y]=0,u=1),u>0&&(m[v]++,u=0,y=v,z=1)),z*=x[v]}if(j)for(v=c;v<=i;v++)j&&m[v]?j--:j||(m[v]=0);return m}})}(jQuery);
//# sourceMappingURL=jquery.countdown.min.map;
define("jquery.countdown", ["jquery","jquery.plugin"], (function (global) {
    return function () {
        var ret, fn;
        return ret || global.jQuery.fn.countdown;
    };
}(this)));

define('m_user',['jquery','m_firebase','dictionary','m_view','m_app','url','jquery.countdown'], function ($,FIREBASE,DICTIONARY,M_VIEW,M_APP,URL) {
  	const _ = {};
	//@@@<<< USER
		function getUserCountry() {
			return M_APP.get('ConnectUserCountry');
		}
    	_['getUserCountry'] = getUserCountry;

		function saveUserCountry(iNcountry) {
			return M_APP.save('ConnectUserCountry',iNcountry);
		}
    	_['saveUserCountry'] = saveUserCountry;

		function getUserLang () {
			return M_APP.get('ConnectUserLang');
		}
    	_['getUserLang'] = getUserLang;

		function saveUserLang (iNlang) {
			return M_APP.save('ConnectUserLang',iNlang);
		}
    	_['saveUserLang'] = saveUserLang;
	//@@@>>> USER
	function signOut (inSuccess,iNerror){
		// clear app
    	M_APP.view.clear();

		if( getMyId() ) {
			// invoke global function for deleted note from fb db 
			M_APP.globalFunctions_invoke('devise_removeNoteFromDatabase');
		}
		// clear local storage
	    M_APP.clear();

		// sign out from fb auth
	    FIREBASE.auth().signOut().then( 
    	() =>  {

		    // if we are in subdomain we also have sign out from main domain
		    var ROUTING = M_APP.getGlobalVar('m_routing');
			if ( ROUTING.getUserDomain() ) {
	    		//off interval function
	    		M_APP.getGlobalVar('m_synchronize').subDomain_clearIntervalFunction();

	    		// view loader
	    		M_APP.view.createLoader();
				
				// send sign out comman to main domain  //synchronize with main domain oure temp storage
				M_APP.getGlobalVar('m_synchronize').subDomain_sendCommandForSignOut();
			}
	    	if (typeof (inSuccess) == 'function') inSuccess();
	    }, (error) => {
    		console.warn('signOut error', error ); 
	    	if (typeof (iNerror) == 'function') iNerror(error);
	    });
	}
    _['signOut'] = signOut;

	function signIn (token,iNfuntion) {
    	// clear app
    	M_APP.view.clear();
    	
	    FIREBASE.auth().signInWithCustomToken(token).then( 
	    (user) => {

	    	// save new user id
	        M_APP.save('uid', FIREBASE.auth().currentUser.uid );
	        
	        // if we are in subdomain we also have sign in main domain
	    	var ROUTING = M_APP.getGlobalVar('m_routing');
	    	if ( ROUTING.getUserDomain() ) {
				//we are in subdomain -> we copy local storage to temp for sync with main domanin our subdomain
				M_APP.storage_copyLocalToTemp();
				//add flag @connectFlagForSyncUserChanged -> with this flag we pass out signIn user to main domain from this subdomain in synchronize.js
				M_APP.saveTempStorage ( '@connectFlagForSync_UserSignIn', 1 );
			}

			// invoke passed success func or pass to base app by default
	        if(typeof(iNfuntion) != 'undefined') {
	        	iNfuntion(); 
	        } else {
	        	if ( ROUTING.getUserDomain() ) {
		        	// pass to chief subdomain
		        	M_APP.getGlobalVar('engine').passToApp({'app':'base','page':'index','data':''});

	        	} else {
		        	// pass to sub chiefdomain
		        	M_APP.getGlobalVar('engine').passToApp({'app':'base','page':'index','user': getMyLogin(),'data':''});

	        	}
	        }


	    	
		}).catch(function(error) {
			console.warn('signIn error', error ); 
	    });
	}
    _['signIn'] = signIn;

	function getMyId () {
    	var uidType = M_APP.get('uidType'), r;
    	if(uidType != null) {
    		if (uidType == '?' ) {
    			r = M_APP.get('aUid');
    		} else {
    			r = M_APP.get('uid');
			}
    	}
    	if (r != getMyFirebaseUid() ) {
			return false;
    	}
    	return r;
    }
    _['getMyId'] = getMyId;

    function getMyIdFromObj (iNdata) {
    	var r = false;
    	if ( typeof iNdata == 'string' ) iNdata = JSON.parse(iNdata);
    	if ( typeof iNdata == 'object' ) {
    		var uidType = iNdata['uidType'];
    		if( typeof uidType == 'string'  && uidType == '?') {
    			r = iNdata['aUid'];
    		} else {
				r = iNdata['uid'];
			}
    	}
    	return r;
    }
    _['getMyIdFromObj'] = getMyIdFromObj;

    function getMyFirebaseUid () {
		var result = checkSignIn();
    	if(result){
    		result = FIREBASE.auth().currentUser.uid;
    	}
        return result;
    }
    window.getMyFirebaseUid = getMyFirebaseUid;

    function getMyToken () {
    	return M_APP.get('token');
    }
    _['getMyToken'] = getMyToken;

    function getMyLogin () {
    	var uidType = M_APP.get('uidType');
    	if(uidType != null) {
    		if (uidType == '?' ) {
    			return 'anonym';
    		} else if( getMyId() ){
    			return M_APP.get('user');
			}
    	}
    }
    window.getMyLogin = getMyLogin;
    _['getMyLogin'] = getMyLogin;

    	function  checkSignIn () {
    		return FIREBASE.auth().currentUser;
    	}
		_['checkSignIn'] = checkSignIn;



	function  authByAnonym( iNfuntion,iNloader ) {
		if ( typeof ( iNloader ) == 'undefined' ) iNloader=true;
		if ( iNloader == true  ) M_VIEW.view.showLoader ();
	    $.ajax(
	    {
	        url: URL.db.api.user.sign, //'https://ramman.net/api/web/sign',
	        type: 'POST',
	        data: JSON.stringify({'type':'signInByAnonim'}),
	        beforeSend: function(request) {
	            request.setRequestHeader("Content-Type", 'application/json');
	        },
	        dataType: 'json',
	        success: function(iNdate2) {
	            var status = iNdate2.status;
	            if(status == 1) {           
	                var fkey 	= iNdate2['fkey']; 
	                 	uid 	= iNdate2['uid'];  
	                 	token 	= iNdate2['token'];      
	                M_APP.save('uidCreated',M_APP.getTime());
	                M_APP.save('uidType',"?");
	                M_APP.save('aUid',uid);
	                M_APP.save('aToken',token);
	                M_APP.save('fkey',fkey);
	                M_APP.del('sentConfirmedTime');
	                M_APP.del('sentSmsTime');
	                M_APP.del('user');
	                signIn(fkey,iNfuntion);
	            } else {                                        
	                M_VIEW.error ( DICTIONARY.get('error-wrongLogin') );
	            }
	            if( iNloader==true ) M_VIEW.view.closeLoader();
	        },
	        error: function () {
	        	if( iNloader==true ) M_VIEW.view.closeLoader();
	        }

	    });
	}
	_['authByAnonym'] = authByAnonym;

	function authByUserAndPswd (iNdata) {
		// view loader
		$('.page-loader').show();
		// disbaled signIn btn while we get answer for request
		$('.page-log_submit').prop( "disabled", true );


	    $.ajax({
	        url: URL.db.api.user.sign,//'https://ramman.net/api/web/sign',
	        type: 'POST',
	        data: JSON.stringify(iNdata),
	        beforeSend: function(request) {
	            request.setRequestHeader("Content-Type", 'application/json');
	        },
	        dataType: 'json',
	        success: function(iNdate2) {
				// hide loader
				$('.page-loader').hide();
				// enable signIn btn we get answer
				$('.page-log_submit').prop( "disabled", false );


	            var status = iNdate2.status;
	            if(status == 1) {
	                setMyIcon(iNdate2.info.icon);
	                setMyToken(iNdate2.token);
	                setMyLogin(iNdate2.user);
	                setMyDisplayName(iNdate2.displayName);
	                
	                M_APP.save('sentSmsTime',M_APP.getTime());
	                startSmsTimer ('signin');
	            } else {                                        //    
	                M_VIEW.error(DICTIONARY.get('error-wrongLogin'));
	            }
	        }
	    });
	}
	_['authByUserAndPswd'] = authByUserAndPswd;

	function checkSmsCode (Obj) {
	    if( typeof(M_APP.get('token')) != 'undefined' &&  typeof(M_APP.get('user')) != 'undefined'){
	        var iNdata 		= {};
	        var formBlock 	= $(Obj).serializeObject();
	        iNdata['token'] = M_APP.get('token');
	        iNdata['user'] 	= M_APP.get('user');
	        iNdata['aToken']= M_APP.get('aToken');
	        iNdata['lang']	= getUserLang('aToken');
	        iNdata['country']= getUserCountry();
	        iNdata['aUid']		= getMyId();

	        var formBlockSignIn = $('.formSignIn').serializeObject();
	        var formBlockCheckCode = $('.formSmsCode').serializeObject();
	        if ( typeof(formBlockSignIn['moveType']) != 'undefined' ) iNdata['aType'] = 1;
	        iNdata.type 		= 'checkCode';
	        iNdata.code 		= formBlock.code;
	        iNdata['codeType'] 	= formBlock['codeType'];
	        M_VIEW.view.showLoader ();
	        $.ajax({
	            url: URL.db.api.user.sign,//'https://ramman.net/api/web/sign',
	            type: 'POST',
	            data: JSON.stringify(iNdata),
	            beforeSend: function(request) {
	                request.setRequestHeader("Content-Type", 'application/json');
	            },
	            dataType: 'json',
	            success: function(iNdate2) {
	                var status = iNdate2.status;
	                if(status == 1) {
	                    var fkey 	= iNdate2.fkey;
	                    M_APP.save('confirmed',1);
	                    M_APP.save('sentConfirmedTime',M_APP.getTime());
	                    M_APP.save('uidType','@');
	                    signIn(fkey);
	                } else {                                        //    
	                	M_VIEW.view.closeLoader(); 
	                    M_VIEW.error(DICTIONARY.get('error-wrongCode'));
	                }
	            },
	            error: function (){ M_VIEW.view.closeLoader(); }
	        });
	        return false;
	    }
	    
	}
    _['checkSmsCode'] = checkSmsCode;

	function checkToken (iNfuntion,iNloader) {
		// checkSignIn
		var checkSign  		= getMyId();
		if ( checkSign == null ) {
			// if not signed
			authByAnonym(iNfuntion,iNloader);
		} else 
			if(typeof(iNfuntion)=='function')iNfuntion(); 
	}
    _['checkToken'] = checkToken;

	function  signUpByUserAndPswd (Obj) {
		M_VIEW.view.showLoader();
	    var formBlock = $(Obj).serializeObject();
	    $.ajax({
	        url: URL.db.api.user.sign,//'https://ramman.net/api/web/sign',
	        type: 'POST',
	        data: JSON.stringify(formBlock),
	        beforeSend: function(request) {
	            request.setRequestHeader("Content-Type", 'application/json');
	        },
	        dataType: 'json',
	        success: function(iNdate2) {
	            var status = iNdate2.status;
	            if(status == 1) {
	                setMyIcon(iNdate2.info.icon);
	                setMyToken(iNdate2.token);
	                setMyLogin(iNdate2.user);
	                setMyDisplayName(iNdate2.displayName);
	                M_APP.saveUserCountry(formBlock['country']);
	                M_APP.saveUserLang(formBlock['lang']);
	                M_APP.save('sentSmsTime',M_APP.getTime());
	                startSmsTimer('signup');
	            } else {                                        //    
	                M_VIEW.error(DICTIONARY.get('error-issetUser'));
	            }
	            M_VIEW.view.closeLoader();
	        },
	        error: function () {
	        	M_VIEW.view.closeLoader();
	        }
	    });
	    return false;
	}
    _['signUpByUserAndPswd'] = signUpByUserAndPswd;


    
	function setMyDisplayName (iNname) {
	    M_APP.save('userDisplayName',iNname);
    }
    function getMyDisplayName (iNname) {
	    return M_APP.get('userDisplayName');
	}
    _['getMyDisplayName'] = getMyDisplayName;
    


    function setMyIcon (iNurl) {
    	// DELETE CHANGE
	    // M_APP.save('userIcon',iNurl);
    }
    function getMyIcon () {
    	return URL.getUserIconByUid( getMyId() );//M_APP.get('userIcon');
	}
    _['getMyIcon'] = getMyIcon;

    function getIconNonePhoto () {
    	return URL.db.userNonePhoto;
    } _.getIconNonePhoto = getIconNonePhoto;

    function setMyLogin (iNlogin) {
	    M_APP.save('user',iNlogin);
	}
 //    function getMyLogin () {
	//     return M_APP.get('user');
	// }
 //    _['getMyLogin'] = getMyLogin;

	function setMyToken (iNtoken) {
	    M_APP.save('token',iNtoken);
	}
    function getMyToken (iNlogin) {
	    return M_APP.get('token');
	}
    _['getMyToken'] = getMyToken;

	function startTimer ( iNid, iNendTime, enfFunction ) {	    
	    $(iNid).countdown ( 'destroy' );
	    $(iNid)
	    .countdown (
			{
				until: iNendTime, // second
				description: '',
				onExpiry: function () { 
					// $(this).hide();
        			if ( typeof(enfFunction) == 'function' ) enfFunction();
				}, 
				layout: '{mnn}:{snn}' // NOT 03 to 3
			}
		);
	}
    _['startTimer'] = startTimer;

	function startSmsTimer (iNtype) {
		
	    var sentSmsTime = parseInt(M_APP.get('sentSmsTime'));
	    var nowSec = M_APP.getTime();

	    if( typeof(sentSmsTime) != 'undefined' & (sentSmsTime + 300000) > nowSec ) {
	        $('.page-reSendSms').hide();
	        $('.page-LastTimeForExpireSms').show();
	        $('.page-formSignIn,.formSignUp').hide();
	        $('.page-formSmsCode').show();
	        if(typeof(iNtype) == 'string') $('#codeType').val(iNtype);
	        startTimer('.page-LastTimeForExpireSms',300/*sentSmsTime + 300000*/,function (){$('.page-reSendSms').show();$('.page-LastTimeForExpireSms').hide()});
	    }
	}
    _['startSmsTimer'] = startSmsTimer;

	//to other file
	function sendForm (iNform) {
	    authByUserAndPswd(
	        $(iNform).serializeObject()
	    );
	    return false;
	}
    _['sendForm'] = sendForm;

	$.fn.serializeObject = function()
	{
	   var o = {};
	   var a = this.serializeArray();
	   $.each(a, function() {
	       if (o[this.name]) {
	           if (!o[this.name].push) {
	               o[this.name] = [o[this.name]];
	           }
	           o[this.name].push(this.value || '');
	       } else {
	           o[this.name] = this.value || '';
	       }
	   });
	   return o;
	};


	function reSendSms () {
	    var iNdata = {'type':'reSendSms','user':M_APP.get('user'),'token':M_APP.get('token')};
	    var st = parseInt( M_APP.get('sentSmsTime') )+ 300000;
	    var nowSec = M_APP.getTime();
	    if(st<nowSec) {
	    	M_VIEW.view.showLoader();
	        $.ajax({
	            url: URL.db.api.user.sign,//'https://ramman.net/api/web/sign',
	            type: 'POST',
	            data: JSON.stringify(iNdata),
	            beforeSend: function(request) {
	                request.setRequestHeader("Content-Type", 'application/json');
	            },
	            dataType: 'json',
	            success: function(iNdate2) {
	                var status = iNdate2.status;
	                if(status == 1) {                               //   ,   
	                    M_APP.save('sentSmsTime',M_APP.getTime());
	                    startSmsTimer();
	                } else if(status == 0){                                     //    
	                    M_VIEW.error(DICTIONARY.get('error-wrongCode'));
	                }else {
	                    M_VIEW.error(DICTIONARY.get('error-needUpdatePage'));
	                }
	                M_VIEW.view.closeLoader();
	            },
	            error: function () {
	            	M_VIEW.view.closeLoader();
	            }
	        });
	    } else M_VIEW.error(DICTIONARY.get('error-smsCodeIsNotExpired'));
	    return false;
	}
    _['reSendSms'] = reSendSms;






	return _;
});
/*!
 * Platform.js <https://mths.be/platform>
 * Copyright 2014-2016 Benjamin Tan <https://demoneaux.github.io/>
 * Copyright 2011-2013 John-David Dalton <http://allyoucanleet.com/>
 * Available under MIT license <https://mths.be/mit>
 */
;(function() {
  'use strict';

  /** Used to determine if values are of the language type `Object`. */
  var objectTypes = {
    'function': true,
    'object': true
  };

  /** Used as a reference to the global object. */
  var root = (objectTypes[typeof window] && window) || this;

  /** Backup possible global object. */
  var oldRoot = root;

  /** Detect free variable `exports`. */
  var freeExports = objectTypes[typeof exports] && exports;

  /** Detect free variable `module`. */
  var freeModule = objectTypes[typeof module] && module && !module.nodeType && module;

  /** Detect free variable `global` from Node.js or Browserified code and use it as `root`. */
  var freeGlobal = freeExports && freeModule && typeof global == 'object' && global;
  if (freeGlobal && (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal || freeGlobal.self === freeGlobal)) {
    root = freeGlobal;
  }

  /**
   * Used as the maximum length of an array-like object.
   * See the [ES6 spec](http://people.mozilla.org/~jorendorff/es6-draft.html#sec-tolength)
   * for more details.
   */
  var maxSafeInteger = Math.pow(2, 53) - 1;

  /** Regular expression to detect Opera. */
  var reOpera = /\bOpera/;

  /** Possible global object. */
  var thisBinding = this;

  /** Used for native method references. */
  var objectProto = Object.prototype;

  /** Used to check for own properties of an object. */
  var hasOwnProperty = objectProto.hasOwnProperty;

  /** Used to resolve the internal `[[Class]]` of values. */
  var toString = objectProto.toString;

  /*--------------------------------------------------------------------------*/

  /**
   * Capitalizes a string value.
   *
   * @private
   * @param {string} string The string to capitalize.
   * @returns {string} The capitalized string.
   */
  function capitalize(string) {
    string = String(string);
    return string.charAt(0).toUpperCase() + string.slice(1);
  }

  /**
   * A utility function to clean up the OS name.
   *
   * @private
   * @param {string} os The OS name to clean up.
   * @param {string} [pattern] A `RegExp` pattern matching the OS name.
   * @param {string} [label] A label for the OS.
   */
  function cleanupOS(os, pattern, label) {
    // Platform tokens are defined at:
    // http://msdn.microsoft.com/en-us/library/ms537503(VS.85).aspx
    // http://web.archive.org/web/20081122053950/http://msdn.microsoft.com/en-us/library/ms537503(VS.85).aspx
    var data = {
      '10.0': '10',
      '6.4':  '10 Technical Preview',
      '6.3':  '8.1',
      '6.2':  '8',
      '6.1':  'Server 2008 R2 / 7',
      '6.0':  'Server 2008 / Vista',
      '5.2':  'Server 2003 / XP 64-bit',
      '5.1':  'XP',
      '5.01': '2000 SP1',
      '5.0':  '2000',
      '4.0':  'NT',
      '4.90': 'ME'
    };
    // Detect Windows version from platform tokens.
    if (pattern && label && /^Win/i.test(os) && !/^Windows Phone /i.test(os) &&
        (data = data[/[\d.]+$/.exec(os)])) {
      os = 'Windows ' + data;
    }
    // Correct character case and cleanup string.
    os = String(os);

    if (pattern && label) {
      os = os.replace(RegExp(pattern, 'i'), label);
    }

    os = format(
      os.replace(/ ce$/i, ' CE')
        .replace(/\bhpw/i, 'web')
        .replace(/\bMacintosh\b/, 'Mac OS')
        .replace(/_PowerPC\b/i, ' OS')
        .replace(/\b(OS X) [^ \d]+/i, '$1')
        .replace(/\bMac (OS X)\b/, '$1')
        .replace(/\/(\d)/, ' $1')
        .replace(/_/g, '.')
        .replace(/(?: BePC|[ .]*fc[ \d.]+)$/i, '')
        .replace(/\bx86\.64\b/gi, 'x86_64')
        .replace(/\b(Windows Phone) OS\b/, '$1')
        .replace(/\b(Chrome OS \w+) [\d.]+\b/, '$1')
        .split(' on ')[0]
    );

    return os;
  }

  /**
   * An iteration utility for arrays and objects.
   *
   * @private
   * @param {Array|Object} object The object to iterate over.
   * @param {Function} callback The function called per iteration.
   */
  function each(object, callback) {
    var index = -1,
        length = object ? object.length : 0;

    if (typeof length == 'number' && length > -1 && length <= maxSafeInteger) {
      while (++index < length) {
        callback(object[index], index, object);
      }
    } else {
      forOwn(object, callback);
    }
  }

  /**
   * Trim and conditionally capitalize string values.
   *
   * @private
   * @param {string} string The string to format.
   * @returns {string} The formatted string.
   */
  function format(string) {
    string = trim(string);
    return /^(?:webOS|i(?:OS|P))/.test(string)
      ? string
      : capitalize(string);
  }

  /**
   * Iterates over an object's own properties, executing the `callback` for each.
   *
   * @private
   * @param {Object} object The object to iterate over.
   * @param {Function} callback The function executed per own property.
   */
  function forOwn(object, callback) {
    for (var key in object) {
      if (hasOwnProperty.call(object, key)) {
        callback(object[key], key, object);
      }
    }
  }

  /**
   * Gets the internal `[[Class]]` of a value.
   *
   * @private
   * @param {*} value The value.
   * @returns {string} The `[[Class]]`.
   */
  function getClassOf(value) {
    return value == null
      ? capitalize(value)
      : toString.call(value).slice(8, -1);
  }

  /**
   * Host objects can return type values that are different from their actual
   * data type. The objects we are concerned with usually return non-primitive
   * types of "object", "function", or "unknown".
   *
   * @private
   * @param {*} object The owner of the property.
   * @param {string} property The property to check.
   * @returns {boolean} Returns `true` if the property value is a non-primitive, else `false`.
   */
  function isHostType(object, property) {
    var type = object != null ? typeof object[property] : 'number';
    return !/^(?:boolean|number|string|undefined)$/.test(type) &&
      (type == 'object' ? !!object[property] : true);
  }

  /**
   * Prepares a string for use in a `RegExp` by making hyphens and spaces optional.
   *
   * @private
   * @param {string} string The string to qualify.
   * @returns {string} The qualified string.
   */
  function qualify(string) {
    return String(string).replace(/([ -])(?!$)/g, '$1?');
  }

  /**
   * A bare-bones `Array#reduce` like utility function.
   *
   * @private
   * @param {Array} array The array to iterate over.
   * @param {Function} callback The function called per iteration.
   * @returns {*} The accumulated result.
   */
  function reduce(array, callback) {
    var accumulator = null;
    each(array, function(value, index) {
      accumulator = callback(accumulator, value, index, array);
    });
    return accumulator;
  }

  /**
   * Removes leading and trailing whitespace from a string.
   *
   * @private
   * @param {string} string The string to trim.
   * @returns {string} The trimmed string.
   */
  function trim(string) {
    return String(string).replace(/^ +| +$/g, '');
  }

  /*--------------------------------------------------------------------------*/

  /**
   * Creates a new platform object.
   *
   * @memberOf platform
   * @param {Object|string} [ua=navigator.userAgent] The user agent string or
   *  context object.
   * @returns {Object} A platform object.
   */
  function parse(ua) {

    /** The environment context object. */
    var context = root;

    /** Used to flag when a custom context is provided. */
    var isCustomContext = ua && typeof ua == 'object' && getClassOf(ua) != 'String';

    // Juggle arguments.
    if (isCustomContext) {
      context = ua;
      ua = null;
    }

    /** Browser navigator object. */
    var nav = context.navigator || {};

    /** Browser user agent string. */
    var userAgent = nav.userAgent || '';

    ua || (ua = userAgent);

    /** Used to flag when `thisBinding` is the [ModuleScope]. */
    var isModuleScope = isCustomContext || thisBinding == oldRoot;

    /** Used to detect if browser is like Chrome. */
    var likeChrome = isCustomContext
      ? !!nav.likeChrome
      : /\bChrome\b/.test(ua) && !/internal|\n/i.test(toString.toString());

    /** Internal `[[Class]]` value shortcuts. */
    var objectClass = 'Object',
        airRuntimeClass = isCustomContext ? objectClass : 'ScriptBridgingProxyObject',
        enviroClass = isCustomContext ? objectClass : 'Environment',
        javaClass = (isCustomContext && context.java) ? 'JavaPackage' : getClassOf(context.java),
        phantomClass = isCustomContext ? objectClass : 'RuntimeObject';

    /** Detect Java environments. */
    var java = /\bJava/.test(javaClass) && context.java;

    /** Detect Rhino. */
    var rhino = java && getClassOf(context.environment) == enviroClass;

    /** A character to represent alpha. */
    var alpha = java ? 'a' : '\u03b1';

    /** A character to represent beta. */
    var beta = java ? 'b' : '\u03b2';

    /** Browser document object. */
    var doc = context.document || {};

    /**
     * Detect Opera browser (Presto-based).
     * http://www.howtocreate.co.uk/operaStuff/operaObject.html
     * http://dev.opera.com/articles/view/opera-mini-web-content-authoring-guidelines/#operamini
     */
    var opera = context.operamini || context.opera;

    /** Opera `[[Class]]`. */
    var operaClass = reOpera.test(operaClass = (isCustomContext && opera) ? opera['[[Class]]'] : getClassOf(opera))
      ? operaClass
      : (opera = null);

    /*------------------------------------------------------------------------*/

    /** Temporary variable used over the script's lifetime. */
    var data;

    /** The CPU architecture. */
    var arch = ua;

    /** Platform description array. */
    var description = [];

    /** Platform alpha/beta indicator. */
    var prerelease = null;

    /** A flag to indicate that environment features should be used to resolve the platform. */
    var useFeatures = ua == userAgent;

    /** The browser/environment version. */
    var version = useFeatures && opera && typeof opera.version == 'function' && opera.version();

    /** A flag to indicate if the OS ends with "/ Version" */
    var isSpecialCasedOS;

    /* Detectable layout engines (order is important). */
    var layout = getLayout([
      { 'label': 'EdgeHTML', 'pattern': 'Edge' },
      'Trident',
      { 'label': 'WebKit', 'pattern': 'AppleWebKit' },
      'iCab',
      'Presto',
      'NetFront',
      'Tasman',
      'KHTML',
      'Gecko'
    ]);

    /* Detectable browser names (order is important). */
    var name = getName([
      'Adobe AIR',
      'Arora',
      'Avant Browser',
      'Breach',
      'Camino',
      'Electron',
      'Epiphany',
      'Fennec',
      'Flock',
      'Galeon',
      'GreenBrowser',
      'iCab',
      'Iceweasel',
      'K-Meleon',
      'Konqueror',
      'Lunascape',
      'Maxthon',
      { 'label': 'Microsoft Edge', 'pattern': 'Edge' },
      'Midori',
      'Nook Browser',
      'PaleMoon',
      'PhantomJS',
      'Raven',
      'Rekonq',
      'RockMelt',
      { 'label': 'Samsung Internet', 'pattern': 'SamsungBrowser' },
      'SeaMonkey',
      { 'label': 'Silk', 'pattern': '(?:Cloud9|Silk-Accelerated)' },
      'Sleipnir',
      'SlimBrowser',
      { 'label': 'SRWare Iron', 'pattern': 'Iron' },
      'Sunrise',
      'Swiftfox',
      'Waterfox',
      'WebPositive',
      'Opera Mini',
      { 'label': 'Opera Mini', 'pattern': 'OPiOS' },
      'Opera',
      { 'label': 'Opera', 'pattern': 'OPR' },
      'Chrome',
      { 'label': 'Chrome Mobile', 'pattern': '(?:CriOS|CrMo)' },
      { 'label': 'Firefox', 'pattern': '(?:Firefox|Minefield)' },
      { 'label': 'Firefox for iOS', 'pattern': 'FxiOS' },
      { 'label': 'IE', 'pattern': 'IEMobile' },
      { 'label': 'IE', 'pattern': 'MSIE' },
      'Safari'
    ]);

    /* Detectable products (order is important). */
    var product = getProduct([
      { 'label': 'BlackBerry', 'pattern': 'BB10' },
      'BlackBerry',
      { 'label': 'Galaxy S', 'pattern': 'GT-I9000' },
      { 'label': 'Galaxy S2', 'pattern': 'GT-I9100' },
      { 'label': 'Galaxy S3', 'pattern': 'GT-I9300' },
      { 'label': 'Galaxy S4', 'pattern': 'GT-I9500' },
      { 'label': 'Galaxy S5', 'pattern': 'SM-G900' },
      { 'label': 'Galaxy S6', 'pattern': 'SM-G920' },
      { 'label': 'Galaxy S6 Edge', 'pattern': 'SM-G925' },
      { 'label': 'Galaxy S7', 'pattern': 'SM-G930' },
      { 'label': 'Galaxy S7 Edge', 'pattern': 'SM-G935' },
      'Google TV',
      'Lumia',
      'iPad',
      'iPod',
      'iPhone',
      'Kindle',
      { 'label': 'Kindle Fire', 'pattern': '(?:Cloud9|Silk-Accelerated)' },
      'Nexus',
      'Nook',
      'PlayBook',
      'PlayStation Vita',
      'PlayStation',
      'TouchPad',
      'Transformer',
      { 'label': 'Wii U', 'pattern': 'WiiU' },
      'Wii',
      'Xbox One',
      { 'label': 'Xbox 360', 'pattern': 'Xbox' },
      'Xoom'
    ]);

    /* Detectable manufacturers. */
    var manufacturer = getManufacturer({
      'Apple': { 'iPad': 1, 'iPhone': 1, 'iPod': 1 },
      'Archos': {},
      'Amazon': { 'Kindle': 1, 'Kindle Fire': 1 },
      'Asus': { 'Transformer': 1 },
      'Barnes & Noble': { 'Nook': 1 },
      'BlackBerry': { 'PlayBook': 1 },
      'Google': { 'Google TV': 1, 'Nexus': 1 },
      'HP': { 'TouchPad': 1 },
      'HTC': {},
      'LG': {},
      'Microsoft': { 'Xbox': 1, 'Xbox One': 1 },
      'Motorola': { 'Xoom': 1 },
      'Nintendo': { 'Wii U': 1,  'Wii': 1 },
      'Nokia': { 'Lumia': 1 },
      'Samsung': { 'Galaxy S': 1, 'Galaxy S2': 1, 'Galaxy S3': 1, 'Galaxy S4': 1 },
      'Sony': { 'PlayStation': 1, 'PlayStation Vita': 1 }
    });

    /* Detectable operating systems (order is important). */
    var os = getOS([
      'Windows Phone',
      'Android',
      'CentOS',
      { 'label': 'Chrome OS', 'pattern': 'CrOS' },
      'Debian',
      'Fedora',
      'FreeBSD',
      'Gentoo',
      'Haiku',
      'Kubuntu',
      'Linux Mint',
      'OpenBSD',
      'Red Hat',
      'SuSE',
      'Ubuntu',
      'Xubuntu',
      'Cygwin',
      'Symbian OS',
      'hpwOS',
      'webOS ',
      'webOS',
      'Tablet OS',
      'Tizen',
      'Linux',
      'Mac OS X',
      'Macintosh',
      'Mac',
      'Windows 98;',
      'Windows '
    ]);

    /*------------------------------------------------------------------------*/

    /**
     * Picks the layout engine from an array of guesses.
     *
     * @private
     * @param {Array} guesses An array of guesses.
     * @returns {null|string} The detected layout engine.
     */
    function getLayout(guesses) {
      return reduce(guesses, function(result, guess) {
        return result || RegExp('\\b' + (
          guess.pattern || qualify(guess)
        ) + '\\b', 'i').exec(ua) && (guess.label || guess);
      });
    }

    /**
     * Picks the manufacturer from an array of guesses.
     *
     * @private
     * @param {Array} guesses An object of guesses.
     * @returns {null|string} The detected manufacturer.
     */
    function getManufacturer(guesses) {
      return reduce(guesses, function(result, value, key) {
        // Lookup the manufacturer by product or scan the UA for the manufacturer.
        return result || (
          value[product] ||
          value[/^[a-z]+(?: +[a-z]+\b)*/i.exec(product)] ||
          RegExp('\\b' + qualify(key) + '(?:\\b|\\w*\\d)', 'i').exec(ua)
        ) && key;
      });
    }

    /**
     * Picks the browser name from an array of guesses.
     *
     * @private
     * @param {Array} guesses An array of guesses.
     * @returns {null|string} The detected browser name.
     */
    function getName(guesses) {
      return reduce(guesses, function(result, guess) {
        return result || RegExp('\\b' + (
          guess.pattern || qualify(guess)
        ) + '\\b', 'i').exec(ua) && (guess.label || guess);
      });
    }

    /**
     * Picks the OS name from an array of guesses.
     *
     * @private
     * @param {Array} guesses An array of guesses.
     * @returns {null|string} The detected OS name.
     */
    function getOS(guesses) {
      return reduce(guesses, function(result, guess) {
        var pattern = guess.pattern || qualify(guess);
        if (!result && (result =
              RegExp('\\b' + pattern + '(?:/[\\d.]+|[ \\w.]*)', 'i').exec(ua)
            )) {
          result = cleanupOS(result, pattern, guess.label || guess);
        }
        return result;
      });
    }

    /**
     * Picks the product name from an array of guesses.
     *
     * @private
     * @param {Array} guesses An array of guesses.
     * @returns {null|string} The detected product name.
     */
    function getProduct(guesses) {
      return reduce(guesses, function(result, guess) {
        var pattern = guess.pattern || qualify(guess);
        if (!result && (result =
              RegExp('\\b' + pattern + ' *\\d+[.\\w_]*', 'i').exec(ua) ||
              RegExp('\\b' + pattern + ' *\\w+-[\\w]*', 'i').exec(ua) ||
              RegExp('\\b' + pattern + '(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)', 'i').exec(ua)
            )) {
          // Split by forward slash and append product version if needed.
          if ((result = String((guess.label && !RegExp(pattern, 'i').test(guess.label)) ? guess.label : result).split('/'))[1] && !/[\d.]+/.test(result[0])) {
            result[0] += ' ' + result[1];
          }
          // Correct character case and cleanup string.
          guess = guess.label || guess;
          result = format(result[0]
            .replace(RegExp(pattern, 'i'), guess)
            .replace(RegExp('; *(?:' + guess + '[_-])?', 'i'), ' ')
            .replace(RegExp('(' + guess + ')[-_.]?(\\w)', 'i'), '$1 $2'));
        }
        return result;
      });
    }

    /**
     * Resolves the version using an array of UA patterns.
     *
     * @private
     * @param {Array} patterns An array of UA patterns.
     * @returns {null|string} The detected version.
     */
    function getVersion(patterns) {
      return reduce(patterns, function(result, pattern) {
        return result || (RegExp(pattern +
          '(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)', 'i').exec(ua) || 0)[1] || null;
      });
    }

    /**
     * Returns `platform.description` when the platform object is coerced to a string.
     *
     * @name toString
     * @memberOf platform
     * @returns {string} Returns `platform.description` if available, else an empty string.
     */
    function toStringPlatform() {
      return this.description || '';
    }

    /*------------------------------------------------------------------------*/

    // Convert layout to an array so we can add extra details.
    layout && (layout = [layout]);

    // Detect product names that contain their manufacturer's name.
    if (manufacturer && !product) {
      product = getProduct([manufacturer]);
    }
    // Clean up Google TV.
    if ((data = /\bGoogle TV\b/.exec(product))) {
      product = data[0];
    }
    // Detect simulators.
    if (/\bSimulator\b/i.test(ua)) {
      product = (product ? product + ' ' : '') + 'Simulator';
    }
    // Detect Opera Mini 8+ running in Turbo/Uncompressed mode on iOS.
    if (name == 'Opera Mini' && /\bOPiOS\b/.test(ua)) {
      description.push('running in Turbo/Uncompressed mode');
    }
    // Detect IE Mobile 11.
    if (name == 'IE' && /\blike iPhone OS\b/.test(ua)) {
      data = parse(ua.replace(/like iPhone OS/, ''));
      manufacturer = data.manufacturer;
      product = data.product;
    }
    // Detect iOS.
    else if (/^iP/.test(product)) {
      name || (name = 'Safari');
      os = 'iOS' + ((data = / OS ([\d_]+)/i.exec(ua))
        ? ' ' + data[1].replace(/_/g, '.')
        : '');
    }
    // Detect Kubuntu.
    else if (name == 'Konqueror' && !/buntu/i.test(os)) {
      os = 'Kubuntu';
    }
    // Detect Android browsers.
    else if ((manufacturer && manufacturer != 'Google' &&
        ((/Chrome/.test(name) && !/\bMobile Safari\b/i.test(ua)) || /\bVita\b/.test(product))) ||
        (/\bAndroid\b/.test(os) && /^Chrome/.test(name) && /\bVersion\//i.test(ua))) {
      name = 'Android Browser';
      os = /\bAndroid\b/.test(os) ? os : 'Android';
    }
    // Detect Silk desktop/accelerated modes.
    else if (name == 'Silk') {
      if (!/\bMobi/i.test(ua)) {
        os = 'Android';
        description.unshift('desktop mode');
      }
      if (/Accelerated *= *true/i.test(ua)) {
        description.unshift('accelerated');
      }
    }
    // Detect PaleMoon identifying as Firefox.
    else if (name == 'PaleMoon' && (data = /\bFirefox\/([\d.]+)\b/.exec(ua))) {
      description.push('identifying as Firefox ' + data[1]);
    }
    // Detect Firefox OS and products running Firefox.
    else if (name == 'Firefox' && (data = /\b(Mobile|Tablet|TV)\b/i.exec(ua))) {
      os || (os = 'Firefox OS');
      product || (product = data[1]);
    }
    // Detect false positives for Firefox/Safari.
    else if (!name || (data = !/\bMinefield\b/i.test(ua) && /\b(?:Firefox|Safari)\b/.exec(name))) {
      // Escape the `/` for Firefox 1.
      if (name && !product && /[\/,]|^[^(]+?\)/.test(ua.slice(ua.indexOf(data + '/') + 8))) {
        // Clear name of false positives.
        name = null;
      }
      // Reassign a generic name.
      if ((data = product || manufacturer || os) &&
          (product || manufacturer || /\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(os))) {
        name = /[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(os) ? os : data) + ' Browser';
      }
    }
    // Add Chrome version to description for Electron.
    else if (name == 'Electron' && (data = (/\bChrome\/([\d.]+)\b/.exec(ua) || 0)[1])) {
      description.push('Chromium ' + data);
    }
    // Detect non-Opera (Presto-based) versions (order is important).
    if (!version) {
      version = getVersion([
        '(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))',
        'Version',
        qualify(name),
        '(?:Firefox|Minefield|NetFront)'
      ]);
    }
    // Detect stubborn layout engines.
    if ((data =
          layout == 'iCab' && parseFloat(version) > 3 && 'WebKit' ||
          /\bOpera\b/.test(name) && (/\bOPR\b/.test(ua) ? 'Blink' : 'Presto') ||
          /\b(?:Midori|Nook|Safari)\b/i.test(ua) && !/^(?:Trident|EdgeHTML)$/.test(layout) && 'WebKit' ||
          !layout && /\bMSIE\b/i.test(ua) && (os == 'Mac OS' ? 'Tasman' : 'Trident') ||
          layout == 'WebKit' && /\bPlayStation\b(?! Vita\b)/i.test(name) && 'NetFront'
        )) {
      layout = [data];
    }
    // Detect Windows Phone 7 desktop mode.
    if (name == 'IE' && (data = (/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(ua) || 0)[1])) {
      name += ' Mobile';
      os = 'Windows Phone ' + (/\+$/.test(data) ? data : data + '.x');
      description.unshift('desktop mode');
    }
    // Detect Windows Phone 8.x desktop mode.
    else if (/\bWPDesktop\b/i.test(ua)) {
      name = 'IE Mobile';
      os = 'Windows Phone 8.x';
      description.unshift('desktop mode');
      version || (version = (/\brv:([\d.]+)/.exec(ua) || 0)[1]);
    }
    // Detect IE 11 identifying as other browsers.
    else if (name != 'IE' && layout == 'Trident' && (data = /\brv:([\d.]+)/.exec(ua))) {
      if (name) {
        description.push('identifying as ' + name + (version ? ' ' + version : ''));
      }
      name = 'IE';
      version = data[1];
    }
    // Leverage environment features.
    if (useFeatures) {
      // Detect server-side environments.
      // Rhino has a global function while others have a global object.
      if (isHostType(context, 'global')) {
        if (java) {
          data = java.lang.System;
          arch = data.getProperty('os.arch');
          os = os || data.getProperty('os.name') + ' ' + data.getProperty('os.version');
        }
        if (isModuleScope && isHostType(context, 'system') && (data = [context.system])[0]) {
          os || (os = data[0].os || null);
          try {
            data[1] = context.require('ringo/engine').version;
            version = data[1].join('.');
            name = 'RingoJS';
          } catch(e) {
            if (data[0].global.system == context.system) {
              name = 'Narwhal';
            }
          }
        }
        else if (
          typeof context.process == 'object' && !context.process.browser &&
          (data = context.process)
        ) {
          if (typeof data.versions == 'object') {
            if (typeof data.versions.electron == 'string') {
              description.push('Node ' + data.versions.node);
              name = 'Electron';
              version = data.versions.electron;
            } else if (typeof data.versions.nw == 'string') {
              description.push('Chromium ' + version, 'Node ' + data.versions.node);
              name = 'NW.js';
              version = data.versions.nw;
            }
          } 
          if (!name) {
            name = 'Node.js';
            arch = data.arch;
            os = data.platform;
            version = /[\d.]+/.exec(data.version)
            version = version ? version[0] : 'unknown';
          }
        }
        else if (rhino) {
          name = 'Rhino';
        }
      }
      // Detect Adobe AIR.
      else if (getClassOf((data = context.runtime)) == airRuntimeClass) {
        name = 'Adobe AIR';
        os = data.flash.system.Capabilities.os;
      }
      // Detect PhantomJS.
      else if (getClassOf((data = context.phantom)) == phantomClass) {
        name = 'PhantomJS';
        version = (data = data.version || null) && (data.major + '.' + data.minor + '.' + data.patch);
      }
      // Detect IE compatibility modes.
      else if (typeof doc.documentMode == 'number' && (data = /\bTrident\/(\d+)/i.exec(ua))) {
        // We're in compatibility mode when the Trident version + 4 doesn't
        // equal the document mode.
        version = [version, doc.documentMode];
        if ((data = +data[1] + 4) != version[1]) {
          description.push('IE ' + version[1] + ' mode');
          layout && (layout[1] = '');
          version[1] = data;
        }
        version = name == 'IE' ? String(version[1].toFixed(1)) : version[0];
      }
      // Detect IE 11 masking as other browsers.
      else if (typeof doc.documentMode == 'number' && /^(?:Chrome|Firefox)\b/.test(name)) {
        description.push('masking as ' + name + ' ' + version);
        name = 'IE';
        version = '11.0';
        layout = ['Trident'];
        os = 'Windows';
      }
      os = os && format(os);
    }
    // Detect prerelease phases.
    if (version && (data =
          /(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(version) ||
          /(?:alpha|beta)(?: ?\d)?/i.exec(ua + ';' + (useFeatures && nav.appMinorVersion)) ||
          /\bMinefield\b/i.test(ua) && 'a'
        )) {
      prerelease = /b/i.test(data) ? 'beta' : 'alpha';
      version = version.replace(RegExp(data + '\\+?$'), '') +
        (prerelease == 'beta' ? beta : alpha) + (/\d+\+?/.exec(data) || '');
    }
    // Detect Firefox Mobile.
    if (name == 'Fennec' || name == 'Firefox' && /\b(?:Android|Firefox OS)\b/.test(os)) {
      name = 'Firefox Mobile';
    }
    // Obscure Maxthon's unreliable version.
    else if (name == 'Maxthon' && version) {
      version = version.replace(/\.[\d.]+/, '.x');
    }
    // Detect Xbox 360 and Xbox One.
    else if (/\bXbox\b/i.test(product)) {
      if (product == 'Xbox 360') {
        os = null;
      }
      if (product == 'Xbox 360' && /\bIEMobile\b/.test(ua)) {
        description.unshift('mobile mode');
      }
    }
    // Add mobile postfix.
    else if ((/^(?:Chrome|IE|Opera)$/.test(name) || name && !product && !/Browser|Mobi/.test(name)) &&
        (os == 'Windows CE' || /Mobi/i.test(ua))) {
      name += ' Mobile';
    }
    // Detect IE platform preview.
    else if (name == 'IE' && useFeatures) {
      try {
        if (context.external === null) {
          description.unshift('platform preview');
        }
      } catch(e) {
        description.unshift('embedded');
      }
    }
    // Detect BlackBerry OS version.
    // http://docs.blackberry.com/en/developers/deliverables/18169/HTTP_headers_sent_by_BB_Browser_1234911_11.jsp
    else if ((/\bBlackBerry\b/.test(product) || /\bBB10\b/.test(ua)) && (data =
          (RegExp(product.replace(/ +/g, ' *') + '/([.\\d]+)', 'i').exec(ua) || 0)[1] ||
          version
        )) {
      data = [data, /BB10/.test(ua)];
      os = (data[1] ? (product = null, manufacturer = 'BlackBerry') : 'Device Software') + ' ' + data[0];
      version = null;
    }
    // Detect Opera identifying/masking itself as another browser.
    // http://www.opera.com/support/kb/view/843/
    else if (this != forOwn && product != 'Wii' && (
          (useFeatures && opera) ||
          (/Opera/.test(name) && /\b(?:MSIE|Firefox)\b/i.test(ua)) ||
          (name == 'Firefox' && /\bOS X (?:\d+\.){2,}/.test(os)) ||
          (name == 'IE' && (
            (os && !/^Win/.test(os) && version > 5.5) ||
            /\bWindows XP\b/.test(os) && version > 8 ||
            version == 8 && !/\bTrident\b/.test(ua)
          ))
        ) && !reOpera.test((data = parse.call(forOwn, ua.replace(reOpera, '') + ';'))) && data.name) {
      // When "identifying", the UA contains both Opera and the other browser's name.
      data = 'ing as ' + data.name + ((data = data.version) ? ' ' + data : '');
      if (reOpera.test(name)) {
        if (/\bIE\b/.test(data) && os == 'Mac OS') {
          os = null;
        }
        data = 'identify' + data;
      }
      // When "masking", the UA contains only the other browser's name.
      else {
        data = 'mask' + data;
        if (operaClass) {
          name = format(operaClass.replace(/([a-z])([A-Z])/g, '$1 $2'));
        } else {
          name = 'Opera';
        }
        if (/\bIE\b/.test(data)) {
          os = null;
        }
        if (!useFeatures) {
          version = null;
        }
      }
      layout = ['Presto'];
      description.push(data);
    }
    // Detect WebKit Nightly and approximate Chrome/Safari versions.
    if ((data = (/\bAppleWebKit\/([\d.]+\+?)/i.exec(ua) || 0)[1])) {
      // Correct build number for numeric comparison.
      // (e.g. "532.5" becomes "532.05")
      data = [parseFloat(data.replace(/\.(\d)$/, '.0$1')), data];
      // Nightly builds are postfixed with a "+".
      if (name == 'Safari' && data[1].slice(-1) == '+') {
        name = 'WebKit Nightly';
        prerelease = 'alpha';
        version = data[1].slice(0, -1);
      }
      // Clear incorrect browser versions.
      else if (version == data[1] ||
          version == (data[2] = (/\bSafari\/([\d.]+\+?)/i.exec(ua) || 0)[1])) {
        version = null;
      }
      // Use the full Chrome version when available.
      data[1] = (/\bChrome\/([\d.]+)/i.exec(ua) || 0)[1];
      // Detect Blink layout engine.
      if (data[0] == 537.36 && data[2] == 537.36 && parseFloat(data[1]) >= 28 && layout == 'WebKit') {
        layout = ['Blink'];
      }
      // Detect JavaScriptCore.
      // http://stackoverflow.com/questions/6768474/how-can-i-detect-which-javascript-engine-v8-or-jsc-is-used-at-runtime-in-androi
      if (!useFeatures || (!likeChrome && !data[1])) {
        layout && (layout[1] = 'like Safari');
        data = (data = data[0], data < 400 ? 1 : data < 500 ? 2 : data < 526 ? 3 : data < 533 ? 4 : data < 534 ? '4+' : data < 535 ? 5 : data < 537 ? 6 : data < 538 ? 7 : data < 601 ? 8 : '8');
      } else {
        layout && (layout[1] = 'like Chrome');
        data = data[1] || (data = data[0], data < 530 ? 1 : data < 532 ? 2 : data < 532.05 ? 3 : data < 533 ? 4 : data < 534.03 ? 5 : data < 534.07 ? 6 : data < 534.10 ? 7 : data < 534.13 ? 8 : data < 534.16 ? 9 : data < 534.24 ? 10 : data < 534.30 ? 11 : data < 535.01 ? 12 : data < 535.02 ? '13+' : data < 535.07 ? 15 : data < 535.11 ? 16 : data < 535.19 ? 17 : data < 536.05 ? 18 : data < 536.10 ? 19 : data < 537.01 ? 20 : data < 537.11 ? '21+' : data < 537.13 ? 23 : data < 537.18 ? 24 : data < 537.24 ? 25 : data < 537.36 ? 26 : layout != 'Blink' ? '27' : '28');
      }
      // Add the postfix of ".x" or "+" for approximate versions.
      layout && (layout[1] += ' ' + (data += typeof data == 'number' ? '.x' : /[.+]/.test(data) ? '' : '+'));
      // Obscure version for some Safari 1-2 releases.
      if (name == 'Safari' && (!version || parseInt(version) > 45)) {
        version = data;
      }
    }
    // Detect Opera desktop modes.
    if (name == 'Opera' &&  (data = /\bzbov|zvav$/.exec(os))) {
      name += ' ';
      description.unshift('desktop mode');
      if (data == 'zvav') {
        name += 'Mini';
        version = null;
      } else {
        name += 'Mobile';
      }
      os = os.replace(RegExp(' *' + data + '$'), '');
    }
    // Detect Chrome desktop mode.
    else if (name == 'Safari' && /\bChrome\b/.exec(layout && layout[1])) {
      description.unshift('desktop mode');
      name = 'Chrome Mobile';
      version = null;

      if (/\bOS X\b/.test(os)) {
        manufacturer = 'Apple';
        os = 'iOS 4.3+';
      } else {
        os = null;
      }
    }
    // Strip incorrect OS versions.
    if (version && version.indexOf((data = /[\d.]+$/.exec(os))) == 0 &&
        ua.indexOf('/' + data + '-') > -1) {
      os = trim(os.replace(data, ''));
    }
    // Add layout engine.
    if (layout && !/\b(?:Avant|Nook)\b/.test(name) && (
        /Browser|Lunascape|Maxthon/.test(name) ||
        name != 'Safari' && /^iOS/.test(os) && /\bSafari\b/.test(layout[1]) ||
        /^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(name) && layout[1])) {
      // Don't add layout details to description if they are falsey.
      (data = layout[layout.length - 1]) && description.push(data);
    }
    // Combine contextual information.
    if (description.length) {
      description = ['(' + description.join('; ') + ')'];
    }
    // Append manufacturer to description.
    if (manufacturer && product && product.indexOf(manufacturer) < 0) {
      description.push('on ' + manufacturer);
    }
    // Append product to description.
    if (product) {
      description.push((/^on /.test(description[description.length - 1]) ? '' : 'on ') + product);
    }
    // Parse the OS into an object.
    if (os) {
      data = / ([\d.+]+)$/.exec(os);
      isSpecialCasedOS = data && os.charAt(os.length - data[0].length - 1) == '/';
      os = {
        'architecture': 32,
        'family': (data && !isSpecialCasedOS) ? os.replace(data[0], '') : os,
        'version': data ? data[1] : null,
        'toString': function() {
          var version = this.version;
          return this.family + ((version && !isSpecialCasedOS) ? ' ' + version : '') + (this.architecture == 64 ? ' 64-bit' : '');
        }
      };
    }
    // Add browser/OS architecture.
    if ((data = /\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(arch)) && !/\bi686\b/i.test(arch)) {
      if (os) {
        os.architecture = 64;
        os.family = os.family.replace(RegExp(' *' + data), '');
      }
      if (
          name && (/\bWOW64\b/i.test(ua) ||
          (useFeatures && /\w(?:86|32)$/.test(nav.cpuClass || nav.platform) && !/\bWin64; x64\b/i.test(ua)))
      ) {
        description.unshift('32-bit');
      }
    }
    // Chrome 39 and above on OS X is always 64-bit.
    else if (
        os && /^OS X/.test(os.family) &&
        name == 'Chrome' && parseFloat(version) >= 39
    ) {
      os.architecture = 64;
    }

    ua || (ua = null);

    /*------------------------------------------------------------------------*/

    /**
     * The platform object.
     *
     * @name platform
     * @type Object
     */
    var platform = {};

    /**
     * The platform description.
     *
     * @memberOf platform
     * @type string|null
     */
    platform.description = ua;

    /**
     * The name of the browser's layout engine.
     *
     * The list of common layout engines include:
     * "Blink", "EdgeHTML", "Gecko", "Trident" and "WebKit"
     *
     * @memberOf platform
     * @type string|null
     */
    platform.layout = layout && layout[0];

    /**
     * The name of the product's manufacturer.
     *
     * The list of manufacturers include:
     * "Apple", "Archos", "Amazon", "Asus", "Barnes & Noble", "BlackBerry",
     * "Google", "HP", "HTC", "LG", "Microsoft", "Motorola", "Nintendo",
     * "Nokia", "Samsung" and "Sony"
     *
     * @memberOf platform
     * @type string|null
     */
    platform.manufacturer = manufacturer;

    /**
     * The name of the browser/environment.
     *
     * The list of common browser names include:
     * "Chrome", "Electron", "Firefox", "Firefox for iOS", "IE",
     * "Microsoft Edge", "PhantomJS", "Safari", "SeaMonkey", "Silk",
     * "Opera Mini" and "Opera"
     *
     * Mobile versions of some browsers have "Mobile" appended to their name:
     * eg. "Chrome Mobile", "Firefox Mobile", "IE Mobile" and "Opera Mobile"
     *
     * @memberOf platform
     * @type string|null
     */
    platform.name = name;

    /**
     * The alpha/beta release indicator.
     *
     * @memberOf platform
     * @type string|null
     */
    platform.prerelease = prerelease;

    /**
     * The name of the product hosting the browser.
     *
     * The list of common products include:
     *
     * "BlackBerry", "Galaxy S4", "Lumia", "iPad", "iPod", "iPhone", "Kindle",
     * "Kindle Fire", "Nexus", "Nook", "PlayBook", "TouchPad" and "Transformer"
     *
     * @memberOf platform
     * @type string|null
     */
    platform.product = product;

    /**
     * The browser's user agent string.
     *
     * @memberOf platform
     * @type string|null
     */
    platform.ua = ua;

    /**
     * The browser/environment version.
     *
     * @memberOf platform
     * @type string|null
     */
    platform.version = name && version;

    /**
     * The name of the operating system.
     *
     * @memberOf platform
     * @type Object
     */
    platform.os = os || {

      /**
       * The CPU architecture the OS is built for.
       *
       * @memberOf platform.os
       * @type number|null
       */
      'architecture': null,

      /**
       * The family of the OS.
       *
       * Common values include:
       * "Windows", "Windows Server 2008 R2 / 7", "Windows Server 2008 / Vista",
       * "Windows XP", "OS X", "Ubuntu", "Debian", "Fedora", "Red Hat", "SuSE",
       * "Android", "iOS" and "Windows Phone"
       *
       * @memberOf platform.os
       * @type string|null
       */
      'family': null,

      /**
       * The version of the OS.
       *
       * @memberOf platform.os
       * @type string|null
       */
      'version': null,

      /**
       * Returns the OS string.
       *
       * @memberOf platform.os
       * @returns {string} The OS string.
       */
      'toString': function() { return 'null'; }
    };

    platform.parse = parse;
    platform.toString = toStringPlatform;

    if (platform.version) {
      description.unshift(version);
    }
    if (platform.name) {
      description.unshift(name);
    }
    if (os && name && !(os == String(os).split(' ')[0] && (os == name.split(' ')[0] || product))) {
      description.push(product ? '(' + os + ')' : 'on ' + os);
    }
    if (description.length) {
      platform.description = description.join(' ');
    }
    return platform;
  }

  /*--------------------------------------------------------------------------*/

  // Export platform.
  var platform = parse();

  // Some AMD build optimizers, like r.js, check for condition patterns like the following:
  if (typeof define == 'function' && typeof define.amd == 'object' && define.amd) {
    // Expose platform on the global object to prevent errors when platform is
    // loaded by a script tag in the presence of an AMD loader.
    // See http://requirejs.org/docs/errors.html#mismatch for more details.
    root.platform = platform;

    // Define as an anonymous module so platform can be aliased through path mapping.
    define('platform',[],function() {
      return platform;
    });
  }
  // Check for `exports` after `define` in case a build optimizer adds an `exports` object.
  else if (freeExports && freeModule) {
    // Export for CommonJS support.
    forOwn(platform, function(value, key) {
      freeExports[key] = value;
    });
  }
  else {
    // Export to the global object.
    root.platform = platform;
  }
}.call(this));

define('m_routing',[ 'jquery', 'm_user', 'platform' ],function( $, USER, PLATFORM){
	//@<<< URL FUNCTIONS
		const _ = {};
		const USER_DOMAIN = [ // CHANGE
			'sharepay',
			'onepay',
			'market',
			'eskrow'
		];
		if( typeof window['ConnectUrlObject'] != 'object' )
			window['ConnectUrlObject'] = {
				'userDomain' 	: false,
				'user' 			: false,
				'app' 			: false,
				'page' 			: false,
				'data' 			: false
			}
		const chiefDomain = 'ramman.net';
		const protocol = 'https://';


		function getUrlObjectByDomEl (iNobj) {
			var r = {};
			r['app']  = $(iNobj).attr('c-app');
			r['user'] = $(iNobj).attr('c-user');
			r['page'] = $(iNobj).attr('c-page');
			r['data'] = $(iNobj).attr('c-data');
			return r;
		} _['getUrlObjectByDomEl'] = getUrlObjectByDomEl;

		/*?<<< APP PATCH */
			if( typeof window['connectAppPath'] != 'object' ) window['connectAppPath'] = [];
			if( typeof window['connectAppPathNumber'] != 'number' ) window['connectAppPathNumber'] = -1;

			

		    function addAppToPath (iNdata) {
		    	window['connectAppPathNumber']++;
		    	window['connectAppPath'][window['connectAppPathNumber']] = iNdata;
		    } _['addAppToPath'] = addAppToPath;

		/*?<<< APP PATCH  */


		function errorJsHandlerForGoogleAnalyticsAndYandexMetric () {
			/*
			*/
			window.onerror = function handler(msg, file, line, col, err) {
			    if (!window.JSON || handler.count > 5) { return; }

			    var counterId = 46784811, //    .
			        siteInfo = {},
			        pointer = siteInfo,
			        stack = err && err.stack,
			        path = [
			            //     ,       .
			            'JS ' + (!file || /ramman\.net|cdn\.ramman\.net/.test(file) ? 'in' : 'ex') + 'ternal errors',
			            'message: ' + msg,
			            stack ?
			                'stack: ' + stack :
			                (file ? 'file: ' + file + ':' + line + ':' + col : 'nofile'),
			            'href: ' + location.href
			        ];

			    for (var i = 0; i < path.length - 1; i++) {
			        var item = path[i];
			        pointer[item] = {};
			        pointer = pointer[item];
			    }

			    pointer[path[i]] = 1;

			    // send error for google analytics
				googleAnalytics_sendError(JSON.stringify(siteInfo));

				// send error for yandex metrika
			    var url = 'https://mc.yandex.ru/watch/' + counterId + '/' +
			            '?site-info=' + encodeURIComponent(JSON.stringify(siteInfo)) +
			            '&rn=' + Math.random();

			    if (typeof navigator.sendBeacon === 'function') {
			        navigator.sendBeacon(url, ' ');
			    } else {
			        new Image().src = url;
			    }

			    if (handler.count) {
			        handler.count++;
			    } else {
			        handler.count = 1;
			    }
			};
		} _['errorJsHandlerForGoogleAnalyticsAndYandexMetric'] = errorJsHandlerForGoogleAnalyticsAndYandexMetric;

		function yandexMetrika_fixOpenPage (iNurl) {
			console.log('yandexMetrika_fixOpenPage start',iNurl);
			const ycounter = window.yaCounter46784811;
			if(  ycounter ) {
				const extraParamsForWriteEvent = {};
				if( !isBrowser()) {
					extraParamsForWriteEvent['device'] 		= 'desktop';
					extraParamsForWriteEvent['deviceName'] 	= getDeviseName;
				} else {
					extraParamsForWriteEvent['device'] 		= 'browser';
				}
				// get start domain (host)
				if( getUserDomain() ) {
					var host = 'https://'+getUserDomain()+'.ramman.net';
				} else {
					var host = 'https://ramman.net';
				}
				var thisUrl = host + iNurl;
				console.log('yandexMetrika_fixOpenPage - thisUrl',thisUrl);
				ycounter.hit(thisUrl, {params: extraParamsForWriteEvent});//'', referer: 'http://example.com/#main'
			}
		} _['yandexMetrika_fixOpenPage'] = yandexMetrika_fixOpenPage;

		function googleAnalytics_sendError (message) {
			console.log('googleAnalytics_sendError start',iNurl);
			const gcounter = window.ga;
			if(  gcounter ) {
				ga('send', 'exception', {
				    'exDescription': message,
				    'exFatal': false
		 		});
			}
		} _['googleAnalytics_sendError'] = googleAnalytics_sendError;

		function googleAnalytics_fixOpenPage (iNurl) {
			console.log('googleAnalytics_fixOpenPage start',iNurl);
			const gcounter = window.ga;
			if(  gcounter ) {
				// const extraParamsForWriteEvent = {};
				// if( !isBrowser()) {
				// 	extraParamsForWriteEvent['device'] 		= 'desktop';
				// 	extraParamsForWriteEvent['deviceName'] 	= getDeviseName;
				// } else {
				// 	extraParamsForWriteEvent['device'] 		= 'browser';
				// }
				// get start domain (host)
				// if( getUserDomain() ) {
				// 	var host = 'https://'+getUserDomain()+'.ramman.net';
				// } else {
				// 	var host = 'https://ramman.net';
				// }
				// var thisUrl = host + iNurl;
				console.log('googleAnalytics_fixOpenPage - thisUrl',iNurl);
				gcounter('set', 'page', iNurl);//'/new-page.html'
			}
		} _['googleAnalytics_fixOpenPage'] = googleAnalytics_fixOpenPage;

		function writeForAnalytics (iNurl) {
			yandexMetrika_fixOpenPage (iNurl);
			googleAnalytics_fixOpenPage (iNurl);
		} _['writeForAnalytics'] = writeForAnalytics;

		function prepareUrl (iNobj) {
			var r, userDomain  = getUserDomain();
			if(typeof iNobj != 'object') iNobj= {}; 
			
			setUser(iNobj['user']);
			setApp(iNobj['app']);
			setPage(iNobj['page']);
			setData(iNobj['data']);

			if( isBrowser()) {
				// ser url if browser
				var newUrl = '';
				iNobj['user'] = iNobj['user']||getUser();

				if(userDomain != false && iNobj['user'] && iNobj['user'] != userDomain) { 
					// we is in user account by subdomain
					// we want to pass to another user, open by full reloading
					newUrl = protocol + chiefDomain;
					newUrl += getUrl(iNobj);
					goToUrl(newUrl);
					return false;
				}
				// we want to pass in this user field
				newUrl = getUrl(iNobj);
				// set this url
				urlSet(newUrl);
				// write for analytics google && yandex
				writeForAnalytics(newUrl);				
			} else {
			}
			return true;
		} _['prepareUrl'] = prepareUrl;

			function getUrl (iNobject) {
				if ( typeof iNobject != 'object') iNobject ={};
				var user 	= iNobject['user']||getUser(),
					app 	= iNobject['app']||getApp(),
					page 	= iNobject['page']||getPage(),
					data 	= iNobject['data']||getData(),
					newUrl  = '';

				if ( typeof user == 'string' && !getUserDomain() || iNobject['user'] &&  getUserDomain() != iNobject['user'] ) {
					//   && !getUserDomain() || getUserDomain() != user
					newUrl += '/' + user;
				}
				if( typeof app == 'string') {
					newUrl += '/' + app;
				}
				if( typeof page == 'string' ) {
					newUrl += '/' + page;
				}
				if( typeof data == 'string') {
					newUrl += '/?' + data;
				}
				return newUrl;
			}

		function startUrl (iNengine,iNpathType) {
			var objectForEngine = {};
			objectForEngine['user'] = getUser();
			objectForEngine['app'] 	= getApp();
			objectForEngine['page'] = getPage();
			var dataForApp 			= getObjectFromString(getData());
			objectForEngine['data'] = dataForApp;

			if ( typeof iNpathType != 'string' ) {
				// if we dont back or top in app path
				addAppToPath(objectForEngine);
			}

            iNengine.openApp(objectForEngine,dataForApp);
		} _['startUrl'] = startUrl;



		function goToUrl (iNurl) {
			/*
				@inputs
				@example
					goToUrl('/zurab')
			*/
			 if(navigator.userAgent.match(/Android/i)) 
			    document.location=iNurl;      
			  else
			    window.top.location.replace(iNurl);
		} _['goToUrl'] = goToUrl;
		function urlSet (iNurl) {
			/*
				@inputs
				@example
					urlSet('/zurab')
			*/
			var urlDomain = getUserDomain();
			if(urlDomain) {
				iNurl = protocol + urlDomain + '.' + chiefDomain  + iNurl;
			} else {
				iNurl = protocol + chiefDomain  + iNurl;
			}			

		    try {
		      history.pushState(null, null, iNurl);
		      return;
		    } catch(e) {
		    	console.warn('urlSet e',e , iNurl);
		    }
		    // location.hash = '#' + iNurl;
		} _['setUrl'] = urlSet;

		function getUserDomain () {
			var r = false;
			if( isBrowser() ) {
				var firstD = urlGetDomain(1);
				if(firstD != false && firstD != 'ramman' && firstD != 'www')
					r = firstD;
			} else if ( typeof window['ConnectUrlObject']['userDomain'] != 'undefined')
				r = window['ConnectUrlObject']['userDomain'];
			return r;
		} _['getUserDomain'] = getUserDomain;

			function setUserDomain (iNuserDomain) {
				window['ConnectUrlObject']['userDomain'] = iNuserDomain;
			}  _['setUserDomain'] = setUserDomain;

			function urlGetDomain (iNnumber) {
				/*
					@inputs
					@example
						urlGetDomain(1)
				*/
				var loc 	= location.host;

				if(typeof(iNnumber) != 'number') return loc;
				var locArr 	= loc.split('.'); iNnumber--;
				if(typeof(locArr[iNnumber]) != 'undefined')
					return locArr[iNnumber];
				else 
					return null;
			}  _['getDomain'] = urlGetDomain;
		function getUser () {
			var r = false;
			if ( isBrowser() ) {
				var firstD = getUserDomain();
				var length = getUrlLength();
				if(firstD) 
					r = firstD;
				else if (length >= 1)
					r = urlGetPath(1);
			} else if (typeof(window['ConnectUrlObject']['user']) == 'string')
				r = window['ConnectUrlObject']['user'];
			if( typeof r == 'string' && r.length < 2 )	r = false;
			return r||USER.getMyLogin();
		} _['getUser'] = getUser;

			function setUser (iNuser) {
				if( typeof iNuser == 'string' )
					window['ConnectUrlObject']['user'] = iNuser;
				else
					window['ConnectUrlObject']['user'] = false;
			}  _['setUser'] = setUser;

		function getApp () {
			var r = 'base'; // default value
			if( window['ConnectDeviseType'] == '@browser') {
				var firstD = getUserDomain();
				var length = getUrlLength();
				if(firstD) {
					// if isset user domain by 
					if(length > 0)
						r =  urlGetPath(1);
				} else if(length >= 2) {
					r =  urlGetPath(2);
				}
			} else if (typeof(window['ConnectUrlObject']['app']) != 'undefined')
			r = window['ConnectUrlObject']['app']||r;
			return r;
		}  _['getApp'] = getApp;

			function setApp (iNapp) {
				if( typeof iNapp == 'string' )
					window['ConnectUrlObject']['app'] = iNapp;
				else
					window['ConnectUrlObject']['app'] = false;
			}   _['setApp'] = setApp;

		function getPage () {
			var r = 'index'; // default value
			if( window['ConnectDeviseType'] == '@browser') {
				var firstD = getUserDomain();
				var length = getUrlLength();
				if(firstD) {
					if( length >= 2) 
						r =  urlGetPath(2);
				} else if(length >= 3) {
					r = urlGetPath(3);
				}
			} else if (typeof window['ConnectUrlObject']['page'] != 'undefined')
				r = window['ConnectUrlObject']['page']||r ;
			return r;
		}   _['getPage'] = getPage;

			function setPage (iNpage) {
				if( typeof iNpage == 'string' )
					window['ConnectUrlObject']['page'] = iNpage;
				else
					window['ConnectUrlObject']['page'] = false;
			}   _['setPage'] = setPage;

		function getData () {
			var r = false, data = false;
			if( window['ConnectDeviseType'] == '@browser') {
				data = location.search; //location.href.split('?');
				if ( typeof data == 'string' ) {
					data = data.split('?');
					data = data[data.length-1]; // last elem
				}
			}
			r = window['ConnectUrlObject']['data']||data;
			return r;
		}  _['getData'] = getData;

			function setData (iNdata) {
				if( typeof iNdata == 'string' && iNdata.length > 2 )
					window['ConnectUrlObject']['data'] = iNdata;
				else 
					window['ConnectUrlObject']['data'] = false;
				
			}  _['setData'] = setData;

			function urlGetPath (iNnumber) {
				/*
					@inputs
					@example
						urlGetPath(1)
				*/
				var loc 	= location.pathname;
				if(typeof(iNnumber) != 'number') return loc; iNnumber--;
				var locArr 	= loc.split('/').splice(1);
				if(iNnumber <= 0) return locArr[0];
				if(typeof(locArr[iNnumber]) != 'undefined')
					if(typeof(locArr[iNnumber]) == 'string' && locArr[iNnumber].length > 0)
						return locArr[iNnumber];
				return false;
			}  _['getUrlPath'] = urlGetPath;

		function getUrlLength () {
			/*
				@inputs
				@example
					getUrlLength(1)
			*/
			var loc 	= location.pathname,
			 	locArr 	= loc.split('/').splice(1),
				count   = 0;
			// if ( location.search.length < 1) count--;  
			for(var iKey in locArr) {
				if(locArr[iKey].length > 0 )count ++
			}
			return count;
		}  _['getUrlLength'] = getUrlLength;

		function getObjectFromString (iNstr) {
			/*
				@disc
					get json object from string with url get type
				@inputs
					iNstr -> string
				@example
					getObjectFromString('key=value&key2=value2')
						@return -> { key : 'value', key2 : value2 }
			*/
		  if ( typeof iNstr != 'string' ) iNstr ='';
		  var result = {};
		  let res = iNstr.split('&');
		  if(res.length > 0 ) {
		    for(var i in res){
		      var keyAndValue = res[i];
		      var arrayWithKeyAndValue = keyAndValue.split('=');
		      var key = arrayWithKeyAndValue[0];
		      var val = decodeURI(arrayWithKeyAndValue[1]);
		      result[key]=val;
		    }
		  }
		  return result;
		}  _['getObjectFromString'] = getObjectFromString;

		function isBrowser () {
			if ( window['ConnectDeviseType'] == '@browser' ) {
				return true;
			}
			return false;
		}  _['isBrowser'] = isBrowser;

			function setBrowser () {
				window['ConnectDeviseType'] = '@browser';
			} _['setBrowser'] = setBrowser;

			function setDeviseName (iNname) {
				window['ConnectDeviseName'] = iNname;
			} _['setDeviseName'] = setDeviseName;

			function getDeviseName () {
				if ( typeof window['ConnectDeviseName'] != 'string' || window['ConnectDeviseName'].length < 1 ) {
					return PLATFORM.name + ' ' + PLATFORM.os.toString();
				}
				return window['ConnectDeviseName'] + ' ' + PLATFORM.os.toString();
			} _['getDeviseName'] = getDeviseName;

			function getUserAgent () {
				return navigator.userAgent||'';
			} _['getUserAgent'] = getUserAgent;

		function isDesktop () {
			if ( window['ConnectDeviseType'] == '@desktop' ) {
				return true;
			}
			return false;
		}  _['isDesktop'] = isDesktop;

			function setDesktop () {
				window['ConnectDeviseType'] = '@desktop';
			} _['setDesktop'] = setDesktop;


		return _;
	//@>>> URL FUNCTIONS
});
!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define('moment',b):a.moment=b()}(this,function(){"use strict";function a(){return re.apply(null,arguments)}function b(a){re=a}function c(a){return a instanceof Array||"[object Array]"===Object.prototype.toString.call(a)}function d(a){return null!=a&&"[object Object]"===Object.prototype.toString.call(a)}function e(a){var b;for(b in a)return!1;return!0}function f(a){return void 0===a}function g(a){return"number"==typeof a||"[object Number]"===Object.prototype.toString.call(a)}function h(a){return a instanceof Date||"[object Date]"===Object.prototype.toString.call(a)}function i(a,b){var c,d=[];for(c=0;c<a.length;++c)d.push(b(a[c],c));return d}function j(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function k(a,b){for(var c in b)j(b,c)&&(a[c]=b[c]);return j(b,"toString")&&(a.toString=b.toString),j(b,"valueOf")&&(a.valueOf=b.valueOf),a}function l(a,b,c,d){return sb(a,b,c,d,!0).utc()}function m(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function n(a){return null==a._pf&&(a._pf=m()),a._pf}function o(a){if(null==a._isValid){var b=n(a),c=te.call(b.parsedDateParts,function(a){return null!=a}),d=!isNaN(a._d.getTime())&&b.overflow<0&&!b.empty&&!b.invalidMonth&&!b.invalidWeekday&&!b.nullInput&&!b.invalidFormat&&!b.userInvalidated&&(!b.meridiem||b.meridiem&&c);if(a._strict&&(d=d&&0===b.charsLeftOver&&0===b.unusedTokens.length&&void 0===b.bigHour),null!=Object.isFrozen&&Object.isFrozen(a))return d;a._isValid=d}return a._isValid}function p(a){var b=l(NaN);return null!=a?k(n(b),a):n(b).userInvalidated=!0,b}function q(a,b){var c,d,e;if(f(b._isAMomentObject)||(a._isAMomentObject=b._isAMomentObject),f(b._i)||(a._i=b._i),f(b._f)||(a._f=b._f),f(b._l)||(a._l=b._l),f(b._strict)||(a._strict=b._strict),f(b._tzm)||(a._tzm=b._tzm),f(b._isUTC)||(a._isUTC=b._isUTC),f(b._offset)||(a._offset=b._offset),f(b._pf)||(a._pf=n(b)),f(b._locale)||(a._locale=b._locale),ue.length>0)for(c=0;c<ue.length;c++)d=ue[c],e=b[d],f(e)||(a[d]=e);return a}function r(b){q(this,b),this._d=new Date(null!=b._d?b._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),ve===!1&&(ve=!0,a.updateOffset(this),ve=!1)}function s(a){return a instanceof r||null!=a&&null!=a._isAMomentObject}function t(a){return a<0?Math.ceil(a)||0:Math.floor(a)}function u(a){var b=+a,c=0;return 0!==b&&isFinite(b)&&(c=t(b)),c}function v(a,b,c){var d,e=Math.min(a.length,b.length),f=Math.abs(a.length-b.length),g=0;for(d=0;d<e;d++)(c&&a[d]!==b[d]||!c&&u(a[d])!==u(b[d]))&&g++;return g+f}function w(b){a.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+b)}function x(b,c){var d=!0;return k(function(){if(null!=a.deprecationHandler&&a.deprecationHandler(null,b),d){for(var e,f=[],g=0;g<arguments.length;g++){if(e="","object"==typeof arguments[g]){e+="\n["+g+"] ";for(var h in arguments[0])e+=h+": "+arguments[0][h]+", ";e=e.slice(0,-2)}else e=arguments[g];f.push(e)}w(b+"\nArguments: "+Array.prototype.slice.call(f).join("")+"\n"+(new Error).stack),d=!1}return c.apply(this,arguments)},c)}function y(b,c){null!=a.deprecationHandler&&a.deprecationHandler(b,c),we[b]||(w(c),we[b]=!0)}function z(a){return a instanceof Function||"[object Function]"===Object.prototype.toString.call(a)}function A(a){var b,c;for(c in a)b=a[c],z(b)?this[c]=b:this["_"+c]=b;this._config=a,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function B(a,b){var c,e=k({},a);for(c in b)j(b,c)&&(d(a[c])&&d(b[c])?(e[c]={},k(e[c],a[c]),k(e[c],b[c])):null!=b[c]?e[c]=b[c]:delete e[c]);for(c in a)j(a,c)&&!j(b,c)&&d(a[c])&&(e[c]=k({},e[c]));return e}function C(a){null!=a&&this.set(a)}function D(a,b,c){var d=this._calendar[a]||this._calendar.sameElse;return z(d)?d.call(b,c):d}function E(a){var b=this._longDateFormat[a],c=this._longDateFormat[a.toUpperCase()];return b||!c?b:(this._longDateFormat[a]=c.replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)}),this._longDateFormat[a])}function F(){return this._invalidDate}function G(a){return this._ordinal.replace("%d",a)}function H(a,b,c,d){var e=this._relativeTime[c];return z(e)?e(a,b,c,d):e.replace(/%d/i,a)}function I(a,b){var c=this._relativeTime[a>0?"future":"past"];return z(c)?c(b):c.replace(/%s/i,b)}function J(a,b){var c=a.toLowerCase();Ge[c]=Ge[c+"s"]=Ge[b]=a}function K(a){return"string"==typeof a?Ge[a]||Ge[a.toLowerCase()]:void 0}function L(a){var b,c,d={};for(c in a)j(a,c)&&(b=K(c),b&&(d[b]=a[c]));return d}function M(a,b){He[a]=b}function N(a){var b=[];for(var c in a)b.push({unit:c,priority:He[c]});return b.sort(function(a,b){return a.priority-b.priority}),b}function O(b,c){return function(d){return null!=d?(Q(this,b,d),a.updateOffset(this,c),this):P(this,b)}}function P(a,b){return a.isValid()?a._d["get"+(a._isUTC?"UTC":"")+b]():NaN}function Q(a,b,c){a.isValid()&&a._d["set"+(a._isUTC?"UTC":"")+b](c)}function R(a){return a=K(a),z(this[a])?this[a]():this}function S(a,b){if("object"==typeof a){a=L(a);for(var c=N(a),d=0;d<c.length;d++)this[c[d].unit](a[c[d].unit])}else if(a=K(a),z(this[a]))return this[a](b);return this}function T(a,b,c){var d=""+Math.abs(a),e=b-d.length,f=a>=0;return(f?c?"+":"":"-")+Math.pow(10,Math.max(0,e)).toString().substr(1)+d}function U(a,b,c,d){var e=d;"string"==typeof d&&(e=function(){return this[d]()}),a&&(Le[a]=e),b&&(Le[b[0]]=function(){return T(e.apply(this,arguments),b[1],b[2])}),c&&(Le[c]=function(){return this.localeData().ordinal(e.apply(this,arguments),a)})}function V(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function W(a){var b,c,d=a.match(Ie);for(b=0,c=d.length;b<c;b++)Le[d[b]]?d[b]=Le[d[b]]:d[b]=V(d[b]);return function(b){var e,f="";for(e=0;e<c;e++)f+=z(d[e])?d[e].call(b,a):d[e];return f}}function X(a,b){return a.isValid()?(b=Y(b,a.localeData()),Ke[b]=Ke[b]||W(b),Ke[b](a)):a.localeData().invalidDate()}function Y(a,b){function c(a){return b.longDateFormat(a)||a}var d=5;for(Je.lastIndex=0;d>=0&&Je.test(a);)a=a.replace(Je,c),Je.lastIndex=0,d-=1;return a}function Z(a,b,c){bf[a]=z(b)?b:function(a,d){return a&&c?c:b}}function $(a,b){return j(bf,a)?bf[a](b._strict,b._locale):new RegExp(_(a))}function _(a){return aa(a.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,b,c,d,e){return b||c||d||e}))}function aa(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function ba(a,b){var c,d=b;for("string"==typeof a&&(a=[a]),g(b)&&(d=function(a,c){c[b]=u(a)}),c=0;c<a.length;c++)cf[a[c]]=d}function ca(a,b){ba(a,function(a,c,d,e){d._w=d._w||{},b(a,d._w,d,e)})}function da(a,b,c){null!=b&&j(cf,a)&&cf[a](b,c._a,c,a)}function ea(a,b){return new Date(Date.UTC(a,b+1,0)).getUTCDate()}function fa(a,b){return a?c(this._months)?this._months[a.month()]:this._months[(this._months.isFormat||of).test(b)?"format":"standalone"][a.month()]:c(this._months)?this._months:this._months.standalone}function ga(a,b){return a?c(this._monthsShort)?this._monthsShort[a.month()]:this._monthsShort[of.test(b)?"format":"standalone"][a.month()]:c(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function ha(a,b,c){var d,e,f,g=a.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],d=0;d<12;++d)f=l([2e3,d]),this._shortMonthsParse[d]=this.monthsShort(f,"").toLocaleLowerCase(),this._longMonthsParse[d]=this.months(f,"").toLocaleLowerCase();return c?"MMM"===b?(e=nf.call(this._shortMonthsParse,g),e!==-1?e:null):(e=nf.call(this._longMonthsParse,g),e!==-1?e:null):"MMM"===b?(e=nf.call(this._shortMonthsParse,g),e!==-1?e:(e=nf.call(this._longMonthsParse,g),e!==-1?e:null)):(e=nf.call(this._longMonthsParse,g),e!==-1?e:(e=nf.call(this._shortMonthsParse,g),e!==-1?e:null))}function ia(a,b,c){var d,e,f;if(this._monthsParseExact)return ha.call(this,a,b,c);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),d=0;d<12;d++){if(e=l([2e3,d]),c&&!this._longMonthsParse[d]&&(this._longMonthsParse[d]=new RegExp("^"+this.months(e,"").replace(".","")+"$","i"),this._shortMonthsParse[d]=new RegExp("^"+this.monthsShort(e,"").replace(".","")+"$","i")),c||this._monthsParse[d]||(f="^"+this.months(e,"")+"|^"+this.monthsShort(e,""),this._monthsParse[d]=new RegExp(f.replace(".",""),"i")),c&&"MMMM"===b&&this._longMonthsParse[d].test(a))return d;if(c&&"MMM"===b&&this._shortMonthsParse[d].test(a))return d;if(!c&&this._monthsParse[d].test(a))return d}}function ja(a,b){var c;if(!a.isValid())return a;if("string"==typeof b)if(/^\d+$/.test(b))b=u(b);else if(b=a.localeData().monthsParse(b),!g(b))return a;return c=Math.min(a.date(),ea(a.year(),b)),a._d["set"+(a._isUTC?"UTC":"")+"Month"](b,c),a}function ka(b){return null!=b?(ja(this,b),a.updateOffset(this,!0),this):P(this,"Month")}function la(){return ea(this.year(),this.month())}function ma(a){return this._monthsParseExact?(j(this,"_monthsRegex")||oa.call(this),a?this._monthsShortStrictRegex:this._monthsShortRegex):(j(this,"_monthsShortRegex")||(this._monthsShortRegex=rf),this._monthsShortStrictRegex&&a?this._monthsShortStrictRegex:this._monthsShortRegex)}function na(a){return this._monthsParseExact?(j(this,"_monthsRegex")||oa.call(this),a?this._monthsStrictRegex:this._monthsRegex):(j(this,"_monthsRegex")||(this._monthsRegex=sf),this._monthsStrictRegex&&a?this._monthsStrictRegex:this._monthsRegex)}function oa(){function a(a,b){return b.length-a.length}var b,c,d=[],e=[],f=[];for(b=0;b<12;b++)c=l([2e3,b]),d.push(this.monthsShort(c,"")),e.push(this.months(c,"")),f.push(this.months(c,"")),f.push(this.monthsShort(c,""));for(d.sort(a),e.sort(a),f.sort(a),b=0;b<12;b++)d[b]=aa(d[b]),e[b]=aa(e[b]);for(b=0;b<24;b++)f[b]=aa(f[b]);this._monthsRegex=new RegExp("^("+f.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+e.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+d.join("|")+")","i")}function pa(a){return qa(a)?366:365}function qa(a){return a%4===0&&a%100!==0||a%400===0}function ra(){return qa(this.year())}function sa(a,b,c,d,e,f,g){var h=new Date(a,b,c,d,e,f,g);return a<100&&a>=0&&isFinite(h.getFullYear())&&h.setFullYear(a),h}function ta(a){var b=new Date(Date.UTC.apply(null,arguments));return a<100&&a>=0&&isFinite(b.getUTCFullYear())&&b.setUTCFullYear(a),b}function ua(a,b,c){var d=7+b-c,e=(7+ta(a,0,d).getUTCDay()-b)%7;return-e+d-1}function va(a,b,c,d,e){var f,g,h=(7+c-d)%7,i=ua(a,d,e),j=1+7*(b-1)+h+i;return j<=0?(f=a-1,g=pa(f)+j):j>pa(a)?(f=a+1,g=j-pa(a)):(f=a,g=j),{year:f,dayOfYear:g}}function wa(a,b,c){var d,e,f=ua(a.year(),b,c),g=Math.floor((a.dayOfYear()-f-1)/7)+1;return g<1?(e=a.year()-1,d=g+xa(e,b,c)):g>xa(a.year(),b,c)?(d=g-xa(a.year(),b,c),e=a.year()+1):(e=a.year(),d=g),{week:d,year:e}}function xa(a,b,c){var d=ua(a,b,c),e=ua(a+1,b,c);return(pa(a)-d+e)/7}function ya(a){return wa(a,this._week.dow,this._week.doy).week}function za(){return this._week.dow}function Aa(){return this._week.doy}function Ba(a){var b=this.localeData().week(this);return null==a?b:this.add(7*(a-b),"d")}function Ca(a){var b=wa(this,1,4).week;return null==a?b:this.add(7*(a-b),"d")}function Da(a,b){return"string"!=typeof a?a:isNaN(a)?(a=b.weekdaysParse(a),"number"==typeof a?a:null):parseInt(a,10)}function Ea(a,b){return"string"==typeof a?b.weekdaysParse(a)%7||7:isNaN(a)?null:a}function Fa(a,b){return a?c(this._weekdays)?this._weekdays[a.day()]:this._weekdays[this._weekdays.isFormat.test(b)?"format":"standalone"][a.day()]:c(this._weekdays)?this._weekdays:this._weekdays.standalone}function Ga(a){return a?this._weekdaysShort[a.day()]:this._weekdaysShort}function Ha(a){return a?this._weekdaysMin[a.day()]:this._weekdaysMin}function Ia(a,b,c){var d,e,f,g=a.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],d=0;d<7;++d)f=l([2e3,1]).day(d),this._minWeekdaysParse[d]=this.weekdaysMin(f,"").toLocaleLowerCase(),this._shortWeekdaysParse[d]=this.weekdaysShort(f,"").toLocaleLowerCase(),this._weekdaysParse[d]=this.weekdays(f,"").toLocaleLowerCase();return c?"dddd"===b?(e=nf.call(this._weekdaysParse,g),e!==-1?e:null):"ddd"===b?(e=nf.call(this._shortWeekdaysParse,g),e!==-1?e:null):(e=nf.call(this._minWeekdaysParse,g),e!==-1?e:null):"dddd"===b?(e=nf.call(this._weekdaysParse,g),e!==-1?e:(e=nf.call(this._shortWeekdaysParse,g),e!==-1?e:(e=nf.call(this._minWeekdaysParse,g),e!==-1?e:null))):"ddd"===b?(e=nf.call(this._shortWeekdaysParse,g),e!==-1?e:(e=nf.call(this._weekdaysParse,g),e!==-1?e:(e=nf.call(this._minWeekdaysParse,g),e!==-1?e:null))):(e=nf.call(this._minWeekdaysParse,g),e!==-1?e:(e=nf.call(this._weekdaysParse,g),e!==-1?e:(e=nf.call(this._shortWeekdaysParse,g),e!==-1?e:null)))}function Ja(a,b,c){var d,e,f;if(this._weekdaysParseExact)return Ia.call(this,a,b,c);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),d=0;d<7;d++){if(e=l([2e3,1]).day(d),c&&!this._fullWeekdaysParse[d]&&(this._fullWeekdaysParse[d]=new RegExp("^"+this.weekdays(e,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[d]=new RegExp("^"+this.weekdaysShort(e,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[d]=new RegExp("^"+this.weekdaysMin(e,"").replace(".",".?")+"$","i")),this._weekdaysParse[d]||(f="^"+this.weekdays(e,"")+"|^"+this.weekdaysShort(e,"")+"|^"+this.weekdaysMin(e,""),this._weekdaysParse[d]=new RegExp(f.replace(".",""),"i")),c&&"dddd"===b&&this._fullWeekdaysParse[d].test(a))return d;if(c&&"ddd"===b&&this._shortWeekdaysParse[d].test(a))return d;if(c&&"dd"===b&&this._minWeekdaysParse[d].test(a))return d;if(!c&&this._weekdaysParse[d].test(a))return d}}function Ka(a){if(!this.isValid())return null!=a?this:NaN;var b=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=a?(a=Da(a,this.localeData()),this.add(a-b,"d")):b}function La(a){if(!this.isValid())return null!=a?this:NaN;var b=(this.day()+7-this.localeData()._week.dow)%7;return null==a?b:this.add(a-b,"d")}function Ma(a){if(!this.isValid())return null!=a?this:NaN;if(null!=a){var b=Ea(a,this.localeData());return this.day(this.day()%7?b:b-7)}return this.day()||7}function Na(a){return this._weekdaysParseExact?(j(this,"_weekdaysRegex")||Qa.call(this),a?this._weekdaysStrictRegex:this._weekdaysRegex):(j(this,"_weekdaysRegex")||(this._weekdaysRegex=yf),this._weekdaysStrictRegex&&a?this._weekdaysStrictRegex:this._weekdaysRegex)}function Oa(a){return this._weekdaysParseExact?(j(this,"_weekdaysRegex")||Qa.call(this),a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(j(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=zf),this._weekdaysShortStrictRegex&&a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Pa(a){return this._weekdaysParseExact?(j(this,"_weekdaysRegex")||Qa.call(this),a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(j(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Af),this._weekdaysMinStrictRegex&&a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Qa(){function a(a,b){return b.length-a.length}var b,c,d,e,f,g=[],h=[],i=[],j=[];for(b=0;b<7;b++)c=l([2e3,1]).day(b),d=this.weekdaysMin(c,""),e=this.weekdaysShort(c,""),f=this.weekdays(c,""),g.push(d),h.push(e),i.push(f),j.push(d),j.push(e),j.push(f);for(g.sort(a),h.sort(a),i.sort(a),j.sort(a),b=0;b<7;b++)h[b]=aa(h[b]),i[b]=aa(i[b]),j[b]=aa(j[b]);this._weekdaysRegex=new RegExp("^("+j.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+h.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+g.join("|")+")","i")}function Ra(){return this.hours()%12||12}function Sa(){return this.hours()||24}function Ta(a,b){U(a,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),b)})}function Ua(a,b){return b._meridiemParse}function Va(a){return"p"===(a+"").toLowerCase().charAt(0)}function Wa(a,b,c){return a>11?c?"pm":"PM":c?"am":"AM"}function Xa(a){return a?a.toLowerCase().replace("_","-"):a}function Ya(a){for(var b,c,d,e,f=0;f<a.length;){for(e=Xa(a[f]).split("-"),b=e.length,c=Xa(a[f+1]),c=c?c.split("-"):null;b>0;){if(d=Za(e.slice(0,b).join("-")))return d;if(c&&c.length>=b&&v(e,c,!0)>=b-1)break;b--}f++}return null}function Za(a){var b=null;if(!Ff[a]&&"undefined"!=typeof module&&module&&module.exports)try{b=Bf._abbr,require("./locale/"+a),$a(b)}catch(a){}return Ff[a]}function $a(a,b){var c;return a&&(c=f(b)?bb(a):_a(a,b),c&&(Bf=c)),Bf._abbr}function _a(a,b){if(null!==b){var c=Ef;if(b.abbr=a,null!=Ff[a])y("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),c=Ff[a]._config;else if(null!=b.parentLocale){if(null==Ff[b.parentLocale])return Gf[b.parentLocale]||(Gf[b.parentLocale]=[]),Gf[b.parentLocale].push({name:a,config:b}),null;c=Ff[b.parentLocale]._config}return Ff[a]=new C(B(c,b)),Gf[a]&&Gf[a].forEach(function(a){_a(a.name,a.config)}),$a(a),Ff[a]}return delete Ff[a],null}function ab(a,b){if(null!=b){var c,d=Ef;null!=Ff[a]&&(d=Ff[a]._config),b=B(d,b),c=new C(b),c.parentLocale=Ff[a],Ff[a]=c,$a(a)}else null!=Ff[a]&&(null!=Ff[a].parentLocale?Ff[a]=Ff[a].parentLocale:null!=Ff[a]&&delete Ff[a]);return Ff[a]}function bb(a){var b;if(a&&a._locale&&a._locale._abbr&&(a=a._locale._abbr),!a)return Bf;if(!c(a)){if(b=Za(a))return b;a=[a]}return Ya(a)}function cb(){return ze(Ff)}function db(a){var b,c=a._a;return c&&n(a).overflow===-2&&(b=c[ef]<0||c[ef]>11?ef:c[ff]<1||c[ff]>ea(c[df],c[ef])?ff:c[gf]<0||c[gf]>24||24===c[gf]&&(0!==c[hf]||0!==c[jf]||0!==c[kf])?gf:c[hf]<0||c[hf]>59?hf:c[jf]<0||c[jf]>59?jf:c[kf]<0||c[kf]>999?kf:-1,n(a)._overflowDayOfYear&&(b<df||b>ff)&&(b=ff),n(a)._overflowWeeks&&b===-1&&(b=lf),n(a)._overflowWeekday&&b===-1&&(b=mf),n(a).overflow=b),a}function eb(a){var b,c,d,e,f,g,h=a._i,i=Hf.exec(h)||If.exec(h);if(i){for(n(a).iso=!0,b=0,c=Kf.length;b<c;b++)if(Kf[b][1].exec(i[1])){e=Kf[b][0],d=Kf[b][2]!==!1;break}if(null==e)return void(a._isValid=!1);if(i[3]){for(b=0,c=Lf.length;b<c;b++)if(Lf[b][1].exec(i[3])){f=(i[2]||" ")+Lf[b][0];break}if(null==f)return void(a._isValid=!1)}if(!d&&null!=f)return void(a._isValid=!1);if(i[4]){if(!Jf.exec(i[4]))return void(a._isValid=!1);g="Z"}a._f=e+(f||"")+(g||""),lb(a)}else a._isValid=!1}function fb(a){var b,c,d,e,f,g,h,i,j={" GMT":" +0000"," EDT":" -0400"," EST":" -0500"," CDT":" -0500"," CST":" -0600"," MDT":" -0600"," MST":" -0700"," PDT":" -0700"," PST":" -0800"},k="YXWVUTSRQPONZABCDEFGHIKLM";if(b=a._i.replace(/\([^\)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s|\s$/g,""),c=Nf.exec(b)){if(d=c[1]?"ddd"+(5===c[1].length?", ":" "):"",e="D MMM "+(c[2].length>10?"YYYY ":"YY "),f="HH:mm"+(c[4]?":ss":""),c[1]){var l=new Date(c[2]),m=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][l.getDay()];if(c[1].substr(0,3)!==m)return n(a).weekdayMismatch=!0,void(a._isValid=!1)}switch(c[5].length){case 2:0===i?h=" +0000":(i=k.indexOf(c[5][1].toUpperCase())-12,h=(i<0?" -":" +")+(""+i).replace(/^-?/,"0").match(/..$/)[0]+"00");break;case 4:h=j[c[5]];break;default:h=j[" GMT"]}c[5]=h,a._i=c.splice(1).join(""),g=" ZZ",a._f=d+e+f+g,lb(a),n(a).rfc2822=!0}else a._isValid=!1}function gb(b){var c=Mf.exec(b._i);return null!==c?void(b._d=new Date(+c[1])):(eb(b),void(b._isValid===!1&&(delete b._isValid,fb(b),b._isValid===!1&&(delete b._isValid,a.createFromInputFallback(b)))))}function hb(a,b,c){return null!=a?a:null!=b?b:c}function ib(b){var c=new Date(a.now());return b._useUTC?[c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()]:[c.getFullYear(),c.getMonth(),c.getDate()]}function jb(a){var b,c,d,e,f=[];if(!a._d){for(d=ib(a),a._w&&null==a._a[ff]&&null==a._a[ef]&&kb(a),null!=a._dayOfYear&&(e=hb(a._a[df],d[df]),(a._dayOfYear>pa(e)||0===a._dayOfYear)&&(n(a)._overflowDayOfYear=!0),c=ta(e,0,a._dayOfYear),a._a[ef]=c.getUTCMonth(),a._a[ff]=c.getUTCDate()),b=0;b<3&&null==a._a[b];++b)a._a[b]=f[b]=d[b];for(;b<7;b++)a._a[b]=f[b]=null==a._a[b]?2===b?1:0:a._a[b];24===a._a[gf]&&0===a._a[hf]&&0===a._a[jf]&&0===a._a[kf]&&(a._nextDay=!0,a._a[gf]=0),a._d=(a._useUTC?ta:sa).apply(null,f),null!=a._tzm&&a._d.setUTCMinutes(a._d.getUTCMinutes()-a._tzm),a._nextDay&&(a._a[gf]=24)}}function kb(a){var b,c,d,e,f,g,h,i;if(b=a._w,null!=b.GG||null!=b.W||null!=b.E)f=1,g=4,c=hb(b.GG,a._a[df],wa(tb(),1,4).year),d=hb(b.W,1),e=hb(b.E,1),(e<1||e>7)&&(i=!0);else{f=a._locale._week.dow,g=a._locale._week.doy;var j=wa(tb(),f,g);c=hb(b.gg,a._a[df],j.year),d=hb(b.w,j.week),null!=b.d?(e=b.d,(e<0||e>6)&&(i=!0)):null!=b.e?(e=b.e+f,(b.e<0||b.e>6)&&(i=!0)):e=f}d<1||d>xa(c,f,g)?n(a)._overflowWeeks=!0:null!=i?n(a)._overflowWeekday=!0:(h=va(c,d,e,f,g),a._a[df]=h.year,a._dayOfYear=h.dayOfYear)}function lb(b){if(b._f===a.ISO_8601)return void eb(b);if(b._f===a.RFC_2822)return void fb(b);b._a=[],n(b).empty=!0;var c,d,e,f,g,h=""+b._i,i=h.length,j=0;for(e=Y(b._f,b._locale).match(Ie)||[],c=0;c<e.length;c++)f=e[c],d=(h.match($(f,b))||[])[0],d&&(g=h.substr(0,h.indexOf(d)),g.length>0&&n(b).unusedInput.push(g),h=h.slice(h.indexOf(d)+d.length),j+=d.length),Le[f]?(d?n(b).empty=!1:n(b).unusedTokens.push(f),da(f,d,b)):b._strict&&!d&&n(b).unusedTokens.push(f);n(b).charsLeftOver=i-j,h.length>0&&n(b).unusedInput.push(h),b._a[gf]<=12&&n(b).bigHour===!0&&b._a[gf]>0&&(n(b).bigHour=void 0),n(b).parsedDateParts=b._a.slice(0),n(b).meridiem=b._meridiem,b._a[gf]=mb(b._locale,b._a[gf],b._meridiem),jb(b),db(b)}function mb(a,b,c){var d;return null==c?b:null!=a.meridiemHour?a.meridiemHour(b,c):null!=a.isPM?(d=a.isPM(c),d&&b<12&&(b+=12),d||12!==b||(b=0),b):b}function nb(a){var b,c,d,e,f;if(0===a._f.length)return n(a).invalidFormat=!0,void(a._d=new Date(NaN));for(e=0;e<a._f.length;e++)f=0,b=q({},a),null!=a._useUTC&&(b._useUTC=a._useUTC),b._f=a._f[e],lb(b),o(b)&&(f+=n(b).charsLeftOver,f+=10*n(b).unusedTokens.length,n(b).score=f,(null==d||f<d)&&(d=f,c=b));k(a,c||b)}function ob(a){if(!a._d){var b=L(a._i);a._a=i([b.year,b.month,b.day||b.date,b.hour,b.minute,b.second,b.millisecond],function(a){return a&&parseInt(a,10)}),jb(a)}}function pb(a){var b=new r(db(qb(a)));return b._nextDay&&(b.add(1,"d"),b._nextDay=void 0),b}function qb(a){var b=a._i,d=a._f;return a._locale=a._locale||bb(a._l),null===b||void 0===d&&""===b?p({nullInput:!0}):("string"==typeof b&&(a._i=b=a._locale.preparse(b)),s(b)?new r(db(b)):(h(b)?a._d=b:c(d)?nb(a):d?lb(a):rb(a),o(a)||(a._d=null),a))}function rb(b){var e=b._i;f(e)?b._d=new Date(a.now()):h(e)?b._d=new Date(e.valueOf()):"string"==typeof e?gb(b):c(e)?(b._a=i(e.slice(0),function(a){return parseInt(a,10)}),jb(b)):d(e)?ob(b):g(e)?b._d=new Date(e):a.createFromInputFallback(b)}function sb(a,b,f,g,h){var i={};return f!==!0&&f!==!1||(g=f,f=void 0),(d(a)&&e(a)||c(a)&&0===a.length)&&(a=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=h,i._l=f,i._i=a,i._f=b,i._strict=g,pb(i)}function tb(a,b,c,d){return sb(a,b,c,d,!1)}function ub(a,b){var d,e;if(1===b.length&&c(b[0])&&(b=b[0]),!b.length)return tb();for(d=b[0],e=1;e<b.length;++e)b[e].isValid()&&!b[e][a](d)||(d=b[e]);return d}function vb(){var a=[].slice.call(arguments,0);return ub("isBefore",a)}function wb(){var a=[].slice.call(arguments,0);return ub("isAfter",a)}function xb(a){for(var b in a)if(Rf.indexOf(b)===-1||null!=a[b]&&isNaN(a[b]))return!1;for(var c=!1,d=0;d<Rf.length;++d)if(a[Rf[d]]){if(c)return!1;parseFloat(a[Rf[d]])!==u(a[Rf[d]])&&(c=!0)}return!0}function yb(){return this._isValid}function zb(){return Sb(NaN)}function Ab(a){var b=L(a),c=b.year||0,d=b.quarter||0,e=b.month||0,f=b.week||0,g=b.day||0,h=b.hour||0,i=b.minute||0,j=b.second||0,k=b.millisecond||0;this._isValid=xb(b),this._milliseconds=+k+1e3*j+6e4*i+1e3*h*60*60,this._days=+g+7*f,this._months=+e+3*d+12*c,this._data={},this._locale=bb(),this._bubble()}function Bb(a){return a instanceof Ab}function Cb(a){return a<0?Math.round(-1*a)*-1:Math.round(a)}function Db(a,b){U(a,0,0,function(){var a=this.utcOffset(),c="+";return a<0&&(a=-a,c="-"),c+T(~~(a/60),2)+b+T(~~a%60,2)})}function Eb(a,b){var c=(b||"").match(a);if(null===c)return null;var d=c[c.length-1]||[],e=(d+"").match(Sf)||["-",0,0],f=+(60*e[1])+u(e[2]);return 0===f?0:"+"===e[0]?f:-f}function Fb(b,c){var d,e;return c._isUTC?(d=c.clone(),e=(s(b)||h(b)?b.valueOf():tb(b).valueOf())-d.valueOf(),d._d.setTime(d._d.valueOf()+e),a.updateOffset(d,!1),d):tb(b).local()}function Gb(a){return 15*-Math.round(a._d.getTimezoneOffset()/15)}function Hb(b,c,d){var e,f=this._offset||0;if(!this.isValid())return null!=b?this:NaN;if(null!=b){if("string"==typeof b){if(b=Eb($e,b),null===b)return this}else Math.abs(b)<16&&!d&&(b=60*b);return!this._isUTC&&c&&(e=Gb(this)),this._offset=b,this._isUTC=!0,null!=e&&this.add(e,"m"),f!==b&&(!c||this._changeInProgress?Xb(this,Sb(b-f,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,a.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?f:Gb(this)}function Ib(a,b){return null!=a?("string"!=typeof a&&(a=-a),this.utcOffset(a,b),this):-this.utcOffset()}function Jb(a){return this.utcOffset(0,a)}function Kb(a){return this._isUTC&&(this.utcOffset(0,a),this._isUTC=!1,a&&this.subtract(Gb(this),"m")),this}function Lb(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var a=Eb(Ze,this._i);null!=a?this.utcOffset(a):this.utcOffset(0,!0)}return this}function Mb(a){return!!this.isValid()&&(a=a?tb(a).utcOffset():0,(this.utcOffset()-a)%60===0)}function Nb(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Ob(){if(!f(this._isDSTShifted))return this._isDSTShifted;var a={};if(q(a,this),a=qb(a),a._a){var b=a._isUTC?l(a._a):tb(a._a);this._isDSTShifted=this.isValid()&&v(a._a,b.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Pb(){return!!this.isValid()&&!this._isUTC}function Qb(){return!!this.isValid()&&this._isUTC}function Rb(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}function Sb(a,b){var c,d,e,f=a,h=null;return Bb(a)?f={ms:a._milliseconds,d:a._days,M:a._months}:g(a)?(f={},b?f[b]=a:f.milliseconds=a):(h=Tf.exec(a))?(c="-"===h[1]?-1:1,f={y:0,d:u(h[ff])*c,h:u(h[gf])*c,m:u(h[hf])*c,s:u(h[jf])*c,ms:u(Cb(1e3*h[kf]))*c}):(h=Uf.exec(a))?(c="-"===h[1]?-1:1,f={y:Tb(h[2],c),M:Tb(h[3],c),w:Tb(h[4],c),d:Tb(h[5],c),h:Tb(h[6],c),m:Tb(h[7],c),s:Tb(h[8],c)}):null==f?f={}:"object"==typeof f&&("from"in f||"to"in f)&&(e=Vb(tb(f.from),tb(f.to)),f={},f.ms=e.milliseconds,f.M=e.months),d=new Ab(f),Bb(a)&&j(a,"_locale")&&(d._locale=a._locale),d}function Tb(a,b){var c=a&&parseFloat(a.replace(",","."));return(isNaN(c)?0:c)*b}function Ub(a,b){var c={milliseconds:0,months:0};return c.months=b.month()-a.month()+12*(b.year()-a.year()),a.clone().add(c.months,"M").isAfter(b)&&--c.months,c.milliseconds=+b-+a.clone().add(c.months,"M"),c}function Vb(a,b){var c;return a.isValid()&&b.isValid()?(b=Fb(b,a),a.isBefore(b)?c=Ub(a,b):(c=Ub(b,a),c.milliseconds=-c.milliseconds,c.months=-c.months),c):{milliseconds:0,months:0}}function Wb(a,b){return function(c,d){var e,f;return null===d||isNaN(+d)||(y(b,"moment()."+b+"(period, number) is deprecated. Please use moment()."+b+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),f=c,c=d,d=f),c="string"==typeof c?+c:c,e=Sb(c,d),Xb(this,e,a),this}}function Xb(b,c,d,e){var f=c._milliseconds,g=Cb(c._days),h=Cb(c._months);b.isValid()&&(e=null==e||e,f&&b._d.setTime(b._d.valueOf()+f*d),g&&Q(b,"Date",P(b,"Date")+g*d),h&&ja(b,P(b,"Month")+h*d),e&&a.updateOffset(b,g||h))}function Yb(a,b){var c=a.diff(b,"days",!0);return c<-6?"sameElse":c<-1?"lastWeek":c<0?"lastDay":c<1?"sameDay":c<2?"nextDay":c<7?"nextWeek":"sameElse"}function Zb(b,c){var d=b||tb(),e=Fb(d,this).startOf("day"),f=a.calendarFormat(this,e)||"sameElse",g=c&&(z(c[f])?c[f].call(this,d):c[f]);return this.format(g||this.localeData().calendar(f,this,tb(d)))}function $b(){return new r(this)}function _b(a,b){var c=s(a)?a:tb(a);return!(!this.isValid()||!c.isValid())&&(b=K(f(b)?"millisecond":b),"millisecond"===b?this.valueOf()>c.valueOf():c.valueOf()<this.clone().startOf(b).valueOf())}function ac(a,b){var c=s(a)?a:tb(a);return!(!this.isValid()||!c.isValid())&&(b=K(f(b)?"millisecond":b),"millisecond"===b?this.valueOf()<c.valueOf():this.clone().endOf(b).valueOf()<c.valueOf())}function bc(a,b,c,d){return d=d||"()",("("===d[0]?this.isAfter(a,c):!this.isBefore(a,c))&&(")"===d[1]?this.isBefore(b,c):!this.isAfter(b,c))}function cc(a,b){var c,d=s(a)?a:tb(a);return!(!this.isValid()||!d.isValid())&&(b=K(b||"millisecond"),"millisecond"===b?this.valueOf()===d.valueOf():(c=d.valueOf(),this.clone().startOf(b).valueOf()<=c&&c<=this.clone().endOf(b).valueOf()))}function dc(a,b){return this.isSame(a,b)||this.isAfter(a,b)}function ec(a,b){return this.isSame(a,b)||this.isBefore(a,b)}function fc(a,b,c){var d,e,f,g;return this.isValid()?(d=Fb(a,this),d.isValid()?(e=6e4*(d.utcOffset()-this.utcOffset()),b=K(b),"year"===b||"month"===b||"quarter"===b?(g=gc(this,d),"quarter"===b?g/=3:"year"===b&&(g/=12)):(f=this-d,g="second"===b?f/1e3:"minute"===b?f/6e4:"hour"===b?f/36e5:"day"===b?(f-e)/864e5:"week"===b?(f-e)/6048e5:f),c?g:t(g)):NaN):NaN}function gc(a,b){var c,d,e=12*(b.year()-a.year())+(b.month()-a.month()),f=a.clone().add(e,"months");return b-f<0?(c=a.clone().add(e-1,"months"),d=(b-f)/(f-c)):(c=a.clone().add(e+1,"months"),d=(b-f)/(c-f)),-(e+d)||0}function hc(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function ic(){if(!this.isValid())return null;var a=this.clone().utc();return a.year()<0||a.year()>9999?X(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):z(Date.prototype.toISOString)?this.toDate().toISOString():X(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function jc(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var a="moment",b="";this.isLocal()||(a=0===this.utcOffset()?"moment.utc":"moment.parseZone",b="Z");var c="["+a+'("]',d=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",e="-MM-DD[T]HH:mm:ss.SSS",f=b+'[")]';return this.format(c+d+e+f)}function kc(b){b||(b=this.isUtc()?a.defaultFormatUtc:a.defaultFormat);var c=X(this,b);return this.localeData().postformat(c)}function lc(a,b){return this.isValid()&&(s(a)&&a.isValid()||tb(a).isValid())?Sb({to:this,from:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()}function mc(a){return this.from(tb(),a)}function nc(a,b){return this.isValid()&&(s(a)&&a.isValid()||tb(a).isValid())?Sb({from:this,to:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()}function oc(a){return this.to(tb(),a)}function pc(a){var b;return void 0===a?this._locale._abbr:(b=bb(a),null!=b&&(this._locale=b),this)}function qc(){return this._locale}function rc(a){switch(a=K(a)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===a&&this.weekday(0),"isoWeek"===a&&this.isoWeekday(1),"quarter"===a&&this.month(3*Math.floor(this.month()/3)),this}function sc(a){return a=K(a),void 0===a||"millisecond"===a?this:("date"===a&&(a="day"),this.startOf(a).add(1,"isoWeek"===a?"week":a).subtract(1,"ms"))}function tc(){return this._d.valueOf()-6e4*(this._offset||0)}function uc(){return Math.floor(this.valueOf()/1e3)}function vc(){return new Date(this.valueOf())}function wc(){var a=this;return[a.year(),a.month(),a.date(),a.hour(),a.minute(),a.second(),a.millisecond()]}function xc(){var a=this;return{years:a.year(),months:a.month(),date:a.date(),hours:a.hours(),minutes:a.minutes(),seconds:a.seconds(),milliseconds:a.milliseconds()}}function yc(){return this.isValid()?this.toISOString():null}function zc(){return o(this)}function Ac(){
return k({},n(this))}function Bc(){return n(this).overflow}function Cc(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Dc(a,b){U(0,[a,a.length],0,b)}function Ec(a){return Ic.call(this,a,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Fc(a){return Ic.call(this,a,this.isoWeek(),this.isoWeekday(),1,4)}function Gc(){return xa(this.year(),1,4)}function Hc(){var a=this.localeData()._week;return xa(this.year(),a.dow,a.doy)}function Ic(a,b,c,d,e){var f;return null==a?wa(this,d,e).year:(f=xa(a,d,e),b>f&&(b=f),Jc.call(this,a,b,c,d,e))}function Jc(a,b,c,d,e){var f=va(a,b,c,d,e),g=ta(f.year,0,f.dayOfYear);return this.year(g.getUTCFullYear()),this.month(g.getUTCMonth()),this.date(g.getUTCDate()),this}function Kc(a){return null==a?Math.ceil((this.month()+1)/3):this.month(3*(a-1)+this.month()%3)}function Lc(a){var b=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==a?b:this.add(a-b,"d")}function Mc(a,b){b[kf]=u(1e3*("0."+a))}function Nc(){return this._isUTC?"UTC":""}function Oc(){return this._isUTC?"Coordinated Universal Time":""}function Pc(a){return tb(1e3*a)}function Qc(){return tb.apply(null,arguments).parseZone()}function Rc(a){return a}function Sc(a,b,c,d){var e=bb(),f=l().set(d,b);return e[c](f,a)}function Tc(a,b,c){if(g(a)&&(b=a,a=void 0),a=a||"",null!=b)return Sc(a,b,c,"month");var d,e=[];for(d=0;d<12;d++)e[d]=Sc(a,d,c,"month");return e}function Uc(a,b,c,d){"boolean"==typeof a?(g(b)&&(c=b,b=void 0),b=b||""):(b=a,c=b,a=!1,g(b)&&(c=b,b=void 0),b=b||"");var e=bb(),f=a?e._week.dow:0;if(null!=c)return Sc(b,(c+f)%7,d,"day");var h,i=[];for(h=0;h<7;h++)i[h]=Sc(b,(h+f)%7,d,"day");return i}function Vc(a,b){return Tc(a,b,"months")}function Wc(a,b){return Tc(a,b,"monthsShort")}function Xc(a,b,c){return Uc(a,b,c,"weekdays")}function Yc(a,b,c){return Uc(a,b,c,"weekdaysShort")}function Zc(a,b,c){return Uc(a,b,c,"weekdaysMin")}function $c(){var a=this._data;return this._milliseconds=dg(this._milliseconds),this._days=dg(this._days),this._months=dg(this._months),a.milliseconds=dg(a.milliseconds),a.seconds=dg(a.seconds),a.minutes=dg(a.minutes),a.hours=dg(a.hours),a.months=dg(a.months),a.years=dg(a.years),this}function _c(a,b,c,d){var e=Sb(b,c);return a._milliseconds+=d*e._milliseconds,a._days+=d*e._days,a._months+=d*e._months,a._bubble()}function ad(a,b){return _c(this,a,b,1)}function bd(a,b){return _c(this,a,b,-1)}function cd(a){return a<0?Math.floor(a):Math.ceil(a)}function dd(){var a,b,c,d,e,f=this._milliseconds,g=this._days,h=this._months,i=this._data;return f>=0&&g>=0&&h>=0||f<=0&&g<=0&&h<=0||(f+=864e5*cd(fd(h)+g),g=0,h=0),i.milliseconds=f%1e3,a=t(f/1e3),i.seconds=a%60,b=t(a/60),i.minutes=b%60,c=t(b/60),i.hours=c%24,g+=t(c/24),e=t(ed(g)),h+=e,g-=cd(fd(e)),d=t(h/12),h%=12,i.days=g,i.months=h,i.years=d,this}function ed(a){return 4800*a/146097}function fd(a){return 146097*a/4800}function gd(a){if(!this.isValid())return NaN;var b,c,d=this._milliseconds;if(a=K(a),"month"===a||"year"===a)return b=this._days+d/864e5,c=this._months+ed(b),"month"===a?c:c/12;switch(b=this._days+Math.round(fd(this._months)),a){case"week":return b/7+d/6048e5;case"day":return b+d/864e5;case"hour":return 24*b+d/36e5;case"minute":return 1440*b+d/6e4;case"second":return 86400*b+d/1e3;case"millisecond":return Math.floor(864e5*b)+d;default:throw new Error("Unknown unit "+a)}}function hd(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*u(this._months/12):NaN}function id(a){return function(){return this.as(a)}}function jd(a){return a=K(a),this.isValid()?this[a+"s"]():NaN}function kd(a){return function(){return this.isValid()?this._data[a]:NaN}}function ld(){return t(this.days()/7)}function md(a,b,c,d,e){return e.relativeTime(b||1,!!c,a,d)}function nd(a,b,c){var d=Sb(a).abs(),e=tg(d.as("s")),f=tg(d.as("m")),g=tg(d.as("h")),h=tg(d.as("d")),i=tg(d.as("M")),j=tg(d.as("y")),k=e<=ug.ss&&["s",e]||e<ug.s&&["ss",e]||f<=1&&["m"]||f<ug.m&&["mm",f]||g<=1&&["h"]||g<ug.h&&["hh",g]||h<=1&&["d"]||h<ug.d&&["dd",h]||i<=1&&["M"]||i<ug.M&&["MM",i]||j<=1&&["y"]||["yy",j];return k[2]=b,k[3]=+a>0,k[4]=c,md.apply(null,k)}function od(a){return void 0===a?tg:"function"==typeof a&&(tg=a,!0)}function pd(a,b){return void 0!==ug[a]&&(void 0===b?ug[a]:(ug[a]=b,"s"===a&&(ug.ss=b-1),!0))}function qd(a){if(!this.isValid())return this.localeData().invalidDate();var b=this.localeData(),c=nd(this,!a,b);return a&&(c=b.pastFuture(+this,c)),b.postformat(c)}function rd(){if(!this.isValid())return this.localeData().invalidDate();var a,b,c,d=vg(this._milliseconds)/1e3,e=vg(this._days),f=vg(this._months);a=t(d/60),b=t(a/60),d%=60,a%=60,c=t(f/12),f%=12;var g=c,h=f,i=e,j=b,k=a,l=d,m=this.asSeconds();return m?(m<0?"-":"")+"P"+(g?g+"Y":"")+(h?h+"M":"")+(i?i+"D":"")+(j||k||l?"T":"")+(j?j+"H":"")+(k?k+"M":"")+(l?l+"S":""):"P0D"}
//! moment.js locale configuration
//! locale : Belarusian [be]
//! author : Dmitry Demidov : https://github.com/demidov91
//! author: Praleska: http://praleska.pro/
//! Author : Menelion Elensle : https://github.com/Oire
function sd(a,b){var c=a.split("_");return b%10===1&&b%100!==11?c[0]:b%10>=2&&b%10<=4&&(b%100<10||b%100>=20)?c[1]:c[2]}function td(a,b,c){var d={mm:b?"__":"__",hh:b?"__":"__",dd:"__",MM:"__",yy:"__"};return"m"===c?b?"":"":"h"===c?b?"":"":a+" "+sd(d[c],+a)}
//! moment.js locale configuration
//! locale : Breton [br]
//! author : Jean-Baptiste Le Duigou : https://github.com/jbleduigou
function ud(a,b,c){var d={mm:"munutenn",MM:"miz",dd:"devezh"};return a+" "+xd(d[c],a)}function vd(a){switch(wd(a)){case 1:case 3:case 4:case 5:case 9:return a+" bloaz";default:return a+" vloaz"}}function wd(a){return a>9?wd(a%10):a}function xd(a,b){return 2===b?yd(a):a}function yd(a){var b={m:"v",b:"v",d:"z"};return void 0===b[a.charAt(0)]?a:b[a.charAt(0)]+a.substring(1)}
//! moment.js locale configuration
//! locale : Bosnian [bs]
//! author : Nedim Cholich : https://github.com/frontyard
//! based on (hr) translation by Bojan Markovi
function zd(a,b,c){var d=a+" ";switch(c){case"m":return b?"jedna minuta":"jedne minute";case"mm":return d+=1===a?"minuta":2===a||3===a||4===a?"minute":"minuta";case"h":return b?"jedan sat":"jednog sata";case"hh":return d+=1===a?"sat":2===a||3===a||4===a?"sata":"sati";case"dd":return d+=1===a?"dan":"dana";case"MM":return d+=1===a?"mjesec":2===a||3===a||4===a?"mjeseca":"mjeseci";case"yy":return d+=1===a?"godina":2===a||3===a||4===a?"godine":"godina"}}function Ad(a){return a>1&&a<5&&1!==~~(a/10)}function Bd(a,b,c,d){var e=a+" ";switch(c){case"s":return b||d?"pr sekund":"pr sekundami";case"m":return b?"minuta":d?"minutu":"minutou";case"mm":return b||d?e+(Ad(a)?"minuty":"minut"):e+"minutami";break;case"h":return b?"hodina":d?"hodinu":"hodinou";case"hh":return b||d?e+(Ad(a)?"hodiny":"hodin"):e+"hodinami";break;case"d":return b||d?"den":"dnem";case"dd":return b||d?e+(Ad(a)?"dny":"dn"):e+"dny";break;case"M":return b||d?"msc":"mscem";case"MM":return b||d?e+(Ad(a)?"msce":"msc"):e+"msci";break;case"y":return b||d?"rok":"rokem";case"yy":return b||d?e+(Ad(a)?"roky":"let"):e+"lety"}}
//! moment.js locale configuration
//! locale : German (Austria) [de-at]
//! author : lluchs : https://github.com/lluchs
//! author: Menelion Elensle: https://github.com/Oire
//! author : Martin Groller : https://github.com/MadMG
//! author : Mikolaj Dadela : https://github.com/mik01aj
function Cd(a,b,c,d){var e={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[a+" Tage",a+" Tagen"],M:["ein Monat","einem Monat"],MM:[a+" Monate",a+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[a+" Jahre",a+" Jahren"]};return b?e[c][0]:e[c][1]}
//! moment.js locale configuration
//! locale : German (Switzerland) [de-ch]
//! author : sschueller : https://github.com/sschueller
function Dd(a,b,c,d){var e={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[a+" Tage",a+" Tagen"],M:["ein Monat","einem Monat"],MM:[a+" Monate",a+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[a+" Jahre",a+" Jahren"]};return b?e[c][0]:e[c][1]}
//! moment.js locale configuration
//! locale : German [de]
//! author : lluchs : https://github.com/lluchs
//! author: Menelion Elensle: https://github.com/Oire
//! author : Mikolaj Dadela : https://github.com/mik01aj
function Ed(a,b,c,d){var e={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[a+" Tage",a+" Tagen"],M:["ein Monat","einem Monat"],MM:[a+" Monate",a+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[a+" Jahre",a+" Jahren"]};return b?e[c][0]:e[c][1]}
//! moment.js locale configuration
//! locale : Estonian [et]
//! author : Henry Kehlmann : https://github.com/madhenry
//! improvements : Illimar Tambek : https://github.com/ragulka
function Fd(a,b,c,d){var e={s:["mne sekundi","mni sekund","paar sekundit"],m:["he minuti","ks minut"],mm:[a+" minuti",a+" minutit"],h:["he tunni","tund aega","ks tund"],hh:[a+" tunni",a+" tundi"],d:["he peva","ks pev"],M:["kuu aja","kuu aega","ks kuu"],MM:[a+" kuu",a+" kuud"],y:["he aasta","aasta","ks aasta"],yy:[a+" aasta",a+" aastat"]};return b?e[c][2]?e[c][2]:e[c][1]:d?e[c][0]:e[c][1]}function Gd(a,b,c,d){var e="";switch(c){case"s":return d?"muutaman sekunnin":"muutama sekunti";case"m":return d?"minuutin":"minuutti";case"mm":e=d?"minuutin":"minuuttia";break;case"h":return d?"tunnin":"tunti";case"hh":e=d?"tunnin":"tuntia";break;case"d":return d?"pivn":"piv";case"dd":e=d?"pivn":"piv";break;case"M":return d?"kuukauden":"kuukausi";case"MM":e=d?"kuukauden":"kuukautta";break;case"y":return d?"vuoden":"vuosi";case"yy":e=d?"vuoden":"vuotta"}return e=Hd(a,d)+" "+e}function Hd(a,b){return a<10?b?$g[a]:Zg[a]:a}
//! moment.js locale configuration
//! locale : Konkani Latin script [gom-latn]
//! author : The Discoverer : https://github.com/WikiDiscoverer
function Id(a,b,c,d){var e={s:["thodde secondanim","thodde second"],m:["eka mintan","ek minute"],mm:[a+" mintanim",a+" mintam"],h:["eka horan","ek hor"],hh:[a+" horanim",a+" hor"],d:["eka disan","ek dis"],dd:[a+" disanim",a+" dis"],M:["eka mhoinean","ek mhoino"],MM:[a+" mhoineanim",a+" mhoine"],y:["eka vorsan","ek voros"],yy:[a+" vorsanim",a+" vorsam"]};return b?e[c][0]:e[c][1]}
//! moment.js locale configuration
//! locale : Croatian [hr]
//! author : Bojan Markovi : https://github.com/bmarkovic
function Jd(a,b,c){var d=a+" ";switch(c){case"m":return b?"jedna minuta":"jedne minute";case"mm":return d+=1===a?"minuta":2===a||3===a||4===a?"minute":"minuta";case"h":return b?"jedan sat":"jednog sata";case"hh":return d+=1===a?"sat":2===a||3===a||4===a?"sata":"sati";case"dd":return d+=1===a?"dan":"dana";case"MM":return d+=1===a?"mjesec":2===a||3===a||4===a?"mjeseca":"mjeseci";case"yy":return d+=1===a?"godina":2===a||3===a||4===a?"godine":"godina"}}function Kd(a,b,c,d){var e=a;switch(c){case"s":return d||b?"nhny msodperc":"nhny msodperce";case"m":return"egy"+(d||b?" perc":" perce");case"mm":return e+(d||b?" perc":" perce");case"h":return"egy"+(d||b?" ra":" rja");case"hh":return e+(d||b?" ra":" rja");case"d":return"egy"+(d||b?" nap":" napja");case"dd":return e+(d||b?" nap":" napja");case"M":return"egy"+(d||b?" hnap":" hnapja");case"MM":return e+(d||b?" hnap":" hnapja");case"y":return"egy"+(d||b?" v":" ve");case"yy":return e+(d||b?" v":" ve")}return""}function Ld(a){return(a?"":"[mlt] ")+"["+ih[this.day()]+"] LT[-kor]"}
//! moment.js locale configuration
//! locale : Icelandic [is]
//! author : Hinrik rn Sigursson : https://github.com/hinrik
function Md(a){return a%100===11||a%10!==1}function Nd(a,b,c,d){var e=a+" ";switch(c){case"s":return b||d?"nokkrar sekndur":"nokkrum sekndum";case"m":return b?"mnta":"mntu";case"mm":return Md(a)?e+(b||d?"mntur":"mntum"):b?e+"mnta":e+"mntu";case"hh":return Md(a)?e+(b||d?"klukkustundir":"klukkustundum"):e+"klukkustund";case"d":return b?"dagur":d?"dag":"degi";case"dd":return Md(a)?b?e+"dagar":e+(d?"daga":"dgum"):b?e+"dagur":e+(d?"dag":"degi");case"M":return b?"mnuur":d?"mnu":"mnui";case"MM":return Md(a)?b?e+"mnuir":e+(d?"mnui":"mnuum"):b?e+"mnuur":e+(d?"mnu":"mnui");case"y":return b||d?"r":"ri";case"yy":return Md(a)?e+(b||d?"r":"rum"):e+(b||d?"r":"ri")}}
//! moment.js locale configuration
//! locale : Luxembourgish [lb]
//! author : mweimerskirch : https://github.com/mweimerskirch
//! author : David Raison : https://github.com/kwisatz
function Od(a,b,c,d){var e={m:["eng Minutt","enger Minutt"],h:["eng Stonn","enger Stonn"],d:["een Dag","engem Dag"],M:["ee Mount","engem Mount"],y:["ee Joer","engem Joer"]};return b?e[c][0]:e[c][1]}function Pd(a){var b=a.substr(0,a.indexOf(" "));return Rd(b)?"a "+a:"an "+a}function Qd(a){var b=a.substr(0,a.indexOf(" "));return Rd(b)?"viru "+a:"virun "+a}function Rd(a){if(a=parseInt(a,10),isNaN(a))return!1;if(a<0)return!0;if(a<10)return 4<=a&&a<=7;if(a<100){var b=a%10,c=a/10;return Rd(0===b?c:b)}if(a<1e4){for(;a>=10;)a/=10;return Rd(a)}return a/=1e3,Rd(a)}function Sd(a,b,c,d){return b?"kelios sekunds":d?"keli sekundi":"kelias sekundes"}function Td(a,b,c,d){return b?Vd(c)[0]:d?Vd(c)[1]:Vd(c)[2]}function Ud(a){return a%10===0||a>10&&a<20}function Vd(a){return nh[a].split("_")}function Wd(a,b,c,d){var e=a+" ";return 1===a?e+Td(a,b,c[0],d):b?e+(Ud(a)?Vd(c)[1]:Vd(c)[0]):d?e+Vd(c)[1]:e+(Ud(a)?Vd(c)[1]:Vd(c)[2])}function Xd(a,b,c){return c?b%10===1&&b%100!==11?a[2]:a[3]:b%10===1&&b%100!==11?a[0]:a[1]}function Yd(a,b,c){return a+" "+Xd(oh[c],a,b)}function Zd(a,b,c){return Xd(oh[c],a,b)}function $d(a,b){return b?"daas sekundes":"dam sekundm"}function _d(a,b,c,d){var e="";if(b)switch(c){case"s":e=" ";break;case"m":e=" ";break;case"mm":e="%d ";break;case"h":e=" ";break;case"hh":e="%d ";break;case"d":e=" ";break;case"dd":e="%d ";break;case"M":e=" ";break;case"MM":e="%d ";break;case"y":e=" ";break;case"yy":e="%d "}else switch(c){case"s":e=" ";break;case"m":e=" ";break;case"mm":e="%d ";break;case"h":e=" ";break;case"hh":e="%d ";break;case"d":e=" ";break;case"dd":e="%d ";break;case"M":e=" ";break;case"MM":e="%d ";break;case"y":e=" ";break;case"yy":e="%d "}return e.replace(/%d/i,a)}function ae(a){return a%10<5&&a%10>1&&~~(a/10)%10!==1}function be(a,b,c){var d=a+" ";switch(c){case"m":return b?"minuta":"minut";case"mm":return d+(ae(a)?"minuty":"minut");case"h":return b?"godzina":"godzin";case"hh":return d+(ae(a)?"godziny":"godzin");case"MM":return d+(ae(a)?"miesice":"miesicy");case"yy":return d+(ae(a)?"lata":"lat")}}
//! moment.js locale configuration
//! locale : Romanian [ro]
//! author : Vlad Gurdiga : https://github.com/gurdiga
//! author : Valentin Agachi : https://github.com/avaly
function ce(a,b,c){var d={mm:"minute",hh:"ore",dd:"zile",MM:"luni",yy:"ani"},e=" ";return(a%100>=20||a>=100&&a%100===0)&&(e=" de "),a+e+d[c]}
//! moment.js locale configuration
//! locale : Russian [ru]
//! author : Viktorminator : https://github.com/Viktorminator
//! Author : Menelion Elensle : https://github.com/Oire
//! author :   : https://github.com/socketpair
function de(a,b){var c=a.split("_");return b%10===1&&b%100!==11?c[0]:b%10>=2&&b%10<=4&&(b%100<10||b%100>=20)?c[1]:c[2]}function ee(a,b,c){var d={mm:b?"__":"__",hh:"__",dd:"__",MM:"__",yy:"__"};return"m"===c?b?"":"":a+" "+de(d[c],+a)}function fe(a){return a>1&&a<5}function ge(a,b,c,d){var e=a+" ";switch(c){case"s":return b||d?"pr seknd":"pr sekundami";case"m":return b?"minta":d?"mintu":"mintou";case"mm":return b||d?e+(fe(a)?"minty":"mint"):e+"mintami";break;case"h":return b?"hodina":d?"hodinu":"hodinou";case"hh":return b||d?e+(fe(a)?"hodiny":"hodn"):e+"hodinami";break;case"d":return b||d?"de":"dom";case"dd":return b||d?e+(fe(a)?"dni":"dn"):e+"dami";break;case"M":return b||d?"mesiac":"mesiacom";case"MM":return b||d?e+(fe(a)?"mesiace":"mesiacov"):e+"mesiacmi";break;case"y":return b||d?"rok":"rokom";case"yy":return b||d?e+(fe(a)?"roky":"rokov"):e+"rokmi"}}
//! moment.js locale configuration
//! locale : Slovenian [sl]
//! author : Robert Sedovek : https://github.com/sedovsek
function he(a,b,c,d){var e=a+" ";switch(c){case"s":return b||d?"nekaj sekund":"nekaj sekundami";case"m":return b?"ena minuta":"eno minuto";case"mm":return e+=1===a?b?"minuta":"minuto":2===a?b||d?"minuti":"minutama":a<5?b||d?"minute":"minutami":b||d?"minut":"minutami";case"h":return b?"ena ura":"eno uro";case"hh":return e+=1===a?b?"ura":"uro":2===a?b||d?"uri":"urama":a<5?b||d?"ure":"urami":b||d?"ur":"urami";case"d":return b||d?"en dan":"enim dnem";case"dd":return e+=1===a?b||d?"dan":"dnem":2===a?b||d?"dni":"dnevoma":b||d?"dni":"dnevi";case"M":return b||d?"en mesec":"enim mesecem";case"MM":return e+=1===a?b||d?"mesec":"mesecem":2===a?b||d?"meseca":"mesecema":a<5?b||d?"mesece":"meseci":b||d?"mesecev":"meseci";case"y":return b||d?"eno leto":"enim letom";case"yy":return e+=1===a?b||d?"leto":"letom":2===a?b||d?"leti":"letoma":a<5?b||d?"leta":"leti":b||d?"let":"leti"}}function ie(a){var b=a;return b=a.indexOf("jaj")!==-1?b.slice(0,-3)+"leS":a.indexOf("jar")!==-1?b.slice(0,-3)+"waQ":a.indexOf("DIS")!==-1?b.slice(0,-3)+"nem":b+" pIq"}function je(a){var b=a;return b=a.indexOf("jaj")!==-1?b.slice(0,-3)+"Hu":a.indexOf("jar")!==-1?b.slice(0,-3)+"wen":a.indexOf("DIS")!==-1?b.slice(0,-3)+"ben":b+" ret"}function ke(a,b,c,d){var e=le(a);switch(c){case"mm":return e+" tup";case"hh":return e+" rep";case"dd":return e+" jaj";case"MM":return e+" jar";case"yy":return e+" DIS"}}function le(a){var b=Math.floor(a%1e3/100),c=Math.floor(a%100/10),d=a%10,e="";return b>0&&(e+=Rh[b]+"vatlh"),c>0&&(e+=(""!==e?" ":"")+Rh[c]+"maH"),d>0&&(e+=(""!==e?" ":"")+Rh[d]),""===e?"pagh":e}function me(a,b,c,d){var e={s:["viensas secunds","'iensas secunds"],m:["'n mut","'iens mut"],mm:[a+" muts",""+a+" muts"],h:["'n ora","'iensa ora"],hh:[a+" oras",""+a+" oras"],d:["'n ziua","'iensa ziua"],dd:[a+" ziuas",""+a+" ziuas"],M:["'n mes","'iens mes"],MM:[a+" mesen",""+a+" mesen"],y:["'n ar","'iens ar"],yy:[a+" ars",""+a+" ars"]};return d?e[c][0]:b?e[c][0]:e[c][1]}
//! moment.js locale configuration
//! locale : Ukrainian [uk]
//! author : zemlanin : https://github.com/zemlanin
//! Author : Menelion Elensle : https://github.com/Oire
function ne(a,b){var c=a.split("_");return b%10===1&&b%100!==11?c[0]:b%10>=2&&b%10<=4&&(b%100<10||b%100>=20)?c[1]:c[2]}function oe(a,b,c){var d={mm:b?"__":"__",hh:b?"__":"__",dd:"__",MM:"__",yy:"__"};return"m"===c?b?"":"":"h"===c?b?"":"":a+" "+ne(d[c],+a)}function pe(a,b){var c={nominative:"______".split("_"),accusative:"______".split("_"),genitive:"______".split("_")};if(!a)return c.nominative;var d=/(\[[]\]) ?dddd/.test(b)?"accusative":/\[?(?:|)? ?\] ?dddd/.test(b)?"genitive":"nominative";return c[d][a.day()]}function qe(a){return function(){return a+""+(11===this.hours()?"":"")+"] LT"}}var re,se;se=Array.prototype.some?Array.prototype.some:function(a){for(var b=Object(this),c=b.length>>>0,d=0;d<c;d++)if(d in b&&a.call(this,b[d],d,b))return!0;return!1};var te=se,ue=a.momentProperties=[],ve=!1,we={};a.suppressDeprecationWarnings=!1,a.deprecationHandler=null;var xe;xe=Object.keys?Object.keys:function(a){var b,c=[];for(b in a)j(a,b)&&c.push(b);return c};var ye,ze=xe,Ae={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},Be={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},Ce="Invalid date",De="%d",Ee=/\d{1,2}/,Fe={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},Ge={},He={},Ie=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Je=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Ke={},Le={},Me=/\d/,Ne=/\d\d/,Oe=/\d{3}/,Pe=/\d{4}/,Qe=/[+-]?\d{6}/,Re=/\d\d?/,Se=/\d\d\d\d?/,Te=/\d\d\d\d\d\d?/,Ue=/\d{1,3}/,Ve=/\d{1,4}/,We=/[+-]?\d{1,6}/,Xe=/\d+/,Ye=/[+-]?\d+/,Ze=/Z|[+-]\d\d:?\d\d/gi,$e=/Z|[+-]\d\d(?::?\d\d)?/gi,_e=/[+-]?\d+(\.\d{1,3})?/,af=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,bf={},cf={},df=0,ef=1,ff=2,gf=3,hf=4,jf=5,kf=6,lf=7,mf=8;ye=Array.prototype.indexOf?Array.prototype.indexOf:function(a){var b;for(b=0;b<this.length;++b)if(this[b]===a)return b;return-1};var nf=ye;U("M",["MM",2],"Mo",function(){return this.month()+1}),U("MMM",0,0,function(a){return this.localeData().monthsShort(this,a)}),U("MMMM",0,0,function(a){return this.localeData().months(this,a)}),J("month","M"),M("month",8),Z("M",Re),Z("MM",Re,Ne),Z("MMM",function(a,b){return b.monthsShortRegex(a)}),Z("MMMM",function(a,b){return b.monthsRegex(a)}),ba(["M","MM"],function(a,b){b[ef]=u(a)-1}),ba(["MMM","MMMM"],function(a,b,c,d){var e=c._locale.monthsParse(a,d,c._strict);null!=e?b[ef]=e:n(c).invalidMonth=a});var of=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,pf="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),qf="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),rf=af,sf=af;U("Y",0,0,function(){var a=this.year();return a<=9999?""+a:"+"+a}),U(0,["YY",2],0,function(){return this.year()%100}),U(0,["YYYY",4],0,"year"),U(0,["YYYYY",5],0,"year"),U(0,["YYYYYY",6,!0],0,"year"),J("year","y"),M("year",1),Z("Y",Ye),Z("YY",Re,Ne),Z("YYYY",Ve,Pe),Z("YYYYY",We,Qe),Z("YYYYYY",We,Qe),ba(["YYYYY","YYYYYY"],df),ba("YYYY",function(b,c){c[df]=2===b.length?a.parseTwoDigitYear(b):u(b)}),ba("YY",function(b,c){c[df]=a.parseTwoDigitYear(b)}),ba("Y",function(a,b){b[df]=parseInt(a,10)}),a.parseTwoDigitYear=function(a){return u(a)+(u(a)>68?1900:2e3)};var tf=O("FullYear",!0);U("w",["ww",2],"wo","week"),U("W",["WW",2],"Wo","isoWeek"),J("week","w"),J("isoWeek","W"),M("week",5),M("isoWeek",5),Z("w",Re),Z("ww",Re,Ne),Z("W",Re),Z("WW",Re,Ne),ca(["w","ww","W","WW"],function(a,b,c,d){b[d.substr(0,1)]=u(a)});var uf={dow:0,doy:6};U("d",0,"do","day"),U("dd",0,0,function(a){return this.localeData().weekdaysMin(this,a)}),U("ddd",0,0,function(a){return this.localeData().weekdaysShort(this,a)}),U("dddd",0,0,function(a){return this.localeData().weekdays(this,a)}),U("e",0,0,"weekday"),U("E",0,0,"isoWeekday"),J("day","d"),J("weekday","e"),J("isoWeekday","E"),M("day",11),M("weekday",11),M("isoWeekday",11),Z("d",Re),Z("e",Re),Z("E",Re),Z("dd",function(a,b){return b.weekdaysMinRegex(a)}),Z("ddd",function(a,b){return b.weekdaysShortRegex(a)}),Z("dddd",function(a,b){return b.weekdaysRegex(a)}),ca(["dd","ddd","dddd"],function(a,b,c,d){var e=c._locale.weekdaysParse(a,d,c._strict);null!=e?b.d=e:n(c).invalidWeekday=a}),ca(["d","e","E"],function(a,b,c,d){b[d]=u(a)});var vf="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),wf="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),xf="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),yf=af,zf=af,Af=af;U("H",["HH",2],0,"hour"),U("h",["hh",2],0,Ra),U("k",["kk",2],0,Sa),U("hmm",0,0,function(){return""+Ra.apply(this)+T(this.minutes(),2)}),U("hmmss",0,0,function(){return""+Ra.apply(this)+T(this.minutes(),2)+T(this.seconds(),2)}),U("Hmm",0,0,function(){return""+this.hours()+T(this.minutes(),2)}),U("Hmmss",0,0,function(){return""+this.hours()+T(this.minutes(),2)+T(this.seconds(),2)}),Ta("a",!0),Ta("A",!1),J("hour","h"),M("hour",13),Z("a",Ua),Z("A",Ua),Z("H",Re),Z("h",Re),Z("k",Re),Z("HH",Re,Ne),Z("hh",Re,Ne),Z("kk",Re,Ne),Z("hmm",Se),Z("hmmss",Te),Z("Hmm",Se),Z("Hmmss",Te),ba(["H","HH"],gf),ba(["k","kk"],function(a,b,c){var d=u(a);b[gf]=24===d?0:d}),ba(["a","A"],function(a,b,c){c._isPm=c._locale.isPM(a),c._meridiem=a}),ba(["h","hh"],function(a,b,c){b[gf]=u(a),n(c).bigHour=!0}),ba("hmm",function(a,b,c){var d=a.length-2;b[gf]=u(a.substr(0,d)),b[hf]=u(a.substr(d)),n(c).bigHour=!0}),ba("hmmss",function(a,b,c){var d=a.length-4,e=a.length-2;b[gf]=u(a.substr(0,d)),b[hf]=u(a.substr(d,2)),b[jf]=u(a.substr(e)),n(c).bigHour=!0}),ba("Hmm",function(a,b,c){var d=a.length-2;b[gf]=u(a.substr(0,d)),b[hf]=u(a.substr(d))}),ba("Hmmss",function(a,b,c){var d=a.length-4,e=a.length-2;b[gf]=u(a.substr(0,d)),b[hf]=u(a.substr(d,2)),b[jf]=u(a.substr(e))});var Bf,Cf=/[ap]\.?m?\.?/i,Df=O("Hours",!0),Ef={calendar:Ae,longDateFormat:Be,invalidDate:Ce,ordinal:De,dayOfMonthOrdinalParse:Ee,relativeTime:Fe,months:pf,monthsShort:qf,week:uf,weekdays:vf,weekdaysMin:xf,weekdaysShort:wf,meridiemParse:Cf},Ff={},Gf={},Hf=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,If=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Jf=/Z|[+-]\d\d(?::?\d\d)?/,Kf=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Lf=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Mf=/^\/?Date\((\-?\d+)/i,Nf=/^((?:Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d?\d\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(?:\d\d)?\d\d\s)(\d\d:\d\d)(\:\d\d)?(\s(?:UT|GMT|[ECMP][SD]T|[A-IK-Za-ik-z]|[+-]\d{4}))$/;a.createFromInputFallback=x("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(a){a._d=new Date(a._i+(a._useUTC?" UTC":""))}),a.ISO_8601=function(){},a.RFC_2822=function(){};var Of=x("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var a=tb.apply(null,arguments);return this.isValid()&&a.isValid()?a<this?this:a:p()}),Pf=x("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var a=tb.apply(null,arguments);return this.isValid()&&a.isValid()?a>this?this:a:p()}),Qf=function(){return Date.now?Date.now():+new Date},Rf=["year","quarter","month","week","day","hour","minute","second","millisecond"];Db("Z",":"),Db("ZZ",""),Z("Z",$e),Z("ZZ",$e),ba(["Z","ZZ"],function(a,b,c){c._useUTC=!0,c._tzm=Eb($e,a)});var Sf=/([\+\-]|\d\d)/gi;a.updateOffset=function(){};var Tf=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Uf=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;Sb.fn=Ab.prototype,Sb.invalid=zb;var Vf=Wb(1,"add"),Wf=Wb(-1,"subtract");a.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",a.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Xf=x("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(a){return void 0===a?this.localeData():this.locale(a)});U(0,["gg",2],0,function(){return this.weekYear()%100}),U(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Dc("gggg","weekYear"),Dc("ggggg","weekYear"),Dc("GGGG","isoWeekYear"),Dc("GGGGG","isoWeekYear"),J("weekYear","gg"),J("isoWeekYear","GG"),M("weekYear",1),M("isoWeekYear",1),Z("G",Ye),Z("g",Ye),Z("GG",Re,Ne),Z("gg",Re,Ne),Z("GGGG",Ve,Pe),Z("gggg",Ve,Pe),Z("GGGGG",We,Qe),Z("ggggg",We,Qe),ca(["gggg","ggggg","GGGG","GGGGG"],function(a,b,c,d){b[d.substr(0,2)]=u(a)}),ca(["gg","GG"],function(b,c,d,e){c[e]=a.parseTwoDigitYear(b)}),U("Q",0,"Qo","quarter"),J("quarter","Q"),M("quarter",7),Z("Q",Me),ba("Q",function(a,b){b[ef]=3*(u(a)-1)}),U("D",["DD",2],"Do","date"),J("date","D"),M("date",9),Z("D",Re),Z("DD",Re,Ne),Z("Do",function(a,b){return a?b._dayOfMonthOrdinalParse||b._ordinalParse:b._dayOfMonthOrdinalParseLenient}),ba(["D","DD"],ff),ba("Do",function(a,b){b[ff]=u(a.match(Re)[0],10)});var Yf=O("Date",!0);U("DDD",["DDDD",3],"DDDo","dayOfYear"),J("dayOfYear","DDD"),M("dayOfYear",4),Z("DDD",Ue),Z("DDDD",Oe),ba(["DDD","DDDD"],function(a,b,c){c._dayOfYear=u(a)}),U("m",["mm",2],0,"minute"),J("minute","m"),M("minute",14),Z("m",Re),Z("mm",Re,Ne),ba(["m","mm"],hf);var Zf=O("Minutes",!1);U("s",["ss",2],0,"second"),J("second","s"),M("second",15),Z("s",Re),Z("ss",Re,Ne),ba(["s","ss"],jf);var $f=O("Seconds",!1);U("S",0,0,function(){return~~(this.millisecond()/100)}),U(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),U(0,["SSS",3],0,"millisecond"),U(0,["SSSS",4],0,function(){return 10*this.millisecond()}),U(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),U(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),U(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),U(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),U(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),J("millisecond","ms"),M("millisecond",16),Z("S",Ue,Me),Z("SS",Ue,Ne),Z("SSS",Ue,Oe);var _f;for(_f="SSSS";_f.length<=9;_f+="S")Z(_f,Xe);for(_f="S";_f.length<=9;_f+="S")ba(_f,Mc);var ag=O("Milliseconds",!1);U("z",0,0,"zoneAbbr"),U("zz",0,0,"zoneName");var bg=r.prototype;bg.add=Vf,bg.calendar=Zb,bg.clone=$b,bg.diff=fc,bg.endOf=sc,bg.format=kc,bg.from=lc,bg.fromNow=mc,bg.to=nc,bg.toNow=oc,bg.get=R,bg.invalidAt=Bc,bg.isAfter=_b,bg.isBefore=ac,bg.isBetween=bc,bg.isSame=cc,bg.isSameOrAfter=dc,bg.isSameOrBefore=ec,bg.isValid=zc,bg.lang=Xf,bg.locale=pc,bg.localeData=qc,bg.max=Pf,bg.min=Of,bg.parsingFlags=Ac,bg.set=S,bg.startOf=rc,bg.subtract=Wf,bg.toArray=wc,bg.toObject=xc,bg.toDate=vc,bg.toISOString=ic,bg.inspect=jc,bg.toJSON=yc,bg.toString=hc,bg.unix=uc,bg.valueOf=tc,bg.creationData=Cc,bg.year=tf,bg.isLeapYear=ra,bg.weekYear=Ec,bg.isoWeekYear=Fc,bg.quarter=bg.quarters=Kc,bg.month=ka,bg.daysInMonth=la,bg.week=bg.weeks=Ba,bg.isoWeek=bg.isoWeeks=Ca,bg.weeksInYear=Hc,bg.isoWeeksInYear=Gc,bg.date=Yf,bg.day=bg.days=Ka,bg.weekday=La,bg.isoWeekday=Ma,bg.dayOfYear=Lc,bg.hour=bg.hours=Df,bg.minute=bg.minutes=Zf,bg.second=bg.seconds=$f,bg.millisecond=bg.milliseconds=ag,bg.utcOffset=Hb,bg.utc=Jb,bg.local=Kb,bg.parseZone=Lb,bg.hasAlignedHourOffset=Mb,bg.isDST=Nb,bg.isLocal=Pb,bg.isUtcOffset=Qb,bg.isUtc=Rb,bg.isUTC=Rb,bg.zoneAbbr=Nc,bg.zoneName=Oc,bg.dates=x("dates accessor is deprecated. Use date instead.",Yf),bg.months=x("months accessor is deprecated. Use month instead",ka),bg.years=x("years accessor is deprecated. Use year instead",tf),bg.zone=x("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Ib),bg.isDSTShifted=x("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Ob);var cg=C.prototype;cg.calendar=D,cg.longDateFormat=E,cg.invalidDate=F,cg.ordinal=G,cg.preparse=Rc,cg.postformat=Rc,cg.relativeTime=H,cg.pastFuture=I,cg.set=A,cg.months=fa,cg.monthsShort=ga,cg.monthsParse=ia,cg.monthsRegex=na,cg.monthsShortRegex=ma,cg.week=ya,cg.firstDayOfYear=Aa,cg.firstDayOfWeek=za,cg.weekdays=Fa,cg.weekdaysMin=Ha,cg.weekdaysShort=Ga,cg.weekdaysParse=Ja,cg.weekdaysRegex=Na,cg.weekdaysShortRegex=Oa,cg.weekdaysMinRegex=Pa,cg.isPM=Va,cg.meridiem=Wa,$a("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(a){var b=a%10,c=1===u(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c}}),a.lang=x("moment.lang is deprecated. Use moment.locale instead.",$a),a.langData=x("moment.langData is deprecated. Use moment.localeData instead.",bb);var dg=Math.abs,eg=id("ms"),fg=id("s"),gg=id("m"),hg=id("h"),ig=id("d"),jg=id("w"),kg=id("M"),lg=id("y"),mg=kd("milliseconds"),ng=kd("seconds"),og=kd("minutes"),pg=kd("hours"),qg=kd("days"),rg=kd("months"),sg=kd("years"),tg=Math.round,ug={ss:44,s:45,m:45,h:22,d:26,M:11},vg=Math.abs,wg=Ab.prototype;wg.isValid=yb,wg.abs=$c,wg.add=ad,wg.subtract=bd,wg.as=gd,wg.asMilliseconds=eg,wg.asSeconds=fg,wg.asMinutes=gg,wg.asHours=hg,wg.asDays=ig,wg.asWeeks=jg,wg.asMonths=kg,wg.asYears=lg,wg.valueOf=hd,wg._bubble=dd,wg.get=jd,wg.milliseconds=mg,wg.seconds=ng,wg.minutes=og,wg.hours=pg,wg.days=qg,wg.weeks=ld,wg.months=rg,wg.years=sg,wg.humanize=qd,wg.toISOString=rd,wg.toString=rd,wg.toJSON=rd,wg.locale=pc,wg.localeData=qc,wg.toIsoString=x("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",rd),wg.lang=Xf,U("X",0,0,"unix"),U("x",0,0,"valueOf"),Z("x",Ye),Z("X",_e),ba("X",function(a,b,c){c._d=new Date(1e3*parseFloat(a,10))}),ba("x",function(a,b,c){c._d=new Date(u(a))}),
//! moment.js
//! version : 2.18.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
a.version="2.18.1",b(tb),a.fn=bg,a.min=vb,a.max=wb,a.now=Qf,a.utc=l,a.unix=Pc,a.months=Vc,a.isDate=h,a.locale=$a,a.invalid=p,a.duration=Sb,a.isMoment=s,a.weekdays=Xc,a.parseZone=Qc,a.localeData=bb,a.isDuration=Bb,a.monthsShort=Wc,a.weekdaysMin=Zc,a.defineLocale=_a,a.updateLocale=ab,a.locales=cb,a.weekdaysShort=Yc,a.normalizeUnits=K,a.relativeTimeRounding=od,a.relativeTimeThreshold=pd,a.calendarFormat=Yb,a.prototype=bg,
//! moment.js locale configuration
//! locale : Afrikaans [af]
//! author : Werner Mollentze : https://github.com/wernerm
a.defineLocale("af",{months:"Januarie_Februarie_Maart_April_Mei_Junie_Julie_Augustus_September_Oktober_November_Desember".split("_"),monthsShort:"Jan_Feb_Mrt_Apr_Mei_Jun_Jul_Aug_Sep_Okt_Nov_Des".split("_"),weekdays:"Sondag_Maandag_Dinsdag_Woensdag_Donderdag_Vrydag_Saterdag".split("_"),weekdaysShort:"Son_Maa_Din_Woe_Don_Vry_Sat".split("_"),weekdaysMin:"So_Ma_Di_Wo_Do_Vr_Sa".split("_"),meridiemParse:/vm|nm/i,isPM:function(a){return/^nm$/i.test(a)},meridiem:function(a,b,c){return a<12?c?"vm":"VM":c?"nm":"NM"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Vandag om] LT",nextDay:"[Mre om] LT",nextWeek:"dddd [om] LT",lastDay:"[Gister om] LT",lastWeek:"[Laas] dddd [om] LT",sameElse:"L"},relativeTime:{future:"oor %s",past:"%s gelede",s:"'n paar sekondes",m:"'n minuut",mm:"%d minute",h:"'n uur",hh:"%d ure",d:"'n dag",dd:"%d dae",M:"'n maand",MM:"%d maande",y:"'n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(a){return a+(1===a||8===a||a>=20?"ste":"de")},week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : Arabic (Algeria) [ar-dz]
//! author : Noureddine LOUAHEDJ : https://github.com/noureddineme
a.defineLocale("ar-dz",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:0,doy:4}}),
//! moment.js locale configuration
//! locale : Arabic (Kuwait) [ar-kw]
//! author : Nusret Parlak: https://github.com/nusretparlak
a.defineLocale("ar-kw",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:0,doy:12}});
//! moment.js locale configuration
//! locale : Arabic (Lybia) [ar-ly]
//! author : Ali Hmer: https://github.com/kikoanis
var xg={1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",0:"0"},yg=function(a){return 0===a?0:1===a?1:2===a?2:a%100>=3&&a%100<=10?3:a%100>=11?4:5},zg={s:["  "," ",["",""],"%d ","%d ","%d "],m:["  "," ",["",""],"%d ","%d ","%d "],h:["  "," ",["",""],"%d ","%d ","%d "],d:["  "," ",["",""],"%d ","%d ","%d "],M:["  "," ",["",""],"%d ","%d ","%d "],y:["  "," ",["",""],"%d ","%d ","%d "]},Ag=function(a){return function(b,c,d,e){var f=yg(b),g=zg[a][yg(b)];return 2===f&&(g=g[c?0:1]),g.replace(/%d/i,b)}},Bg=["","","","","","","","","","","",""];a.defineLocale("ar-ly",{months:Bg,monthsShort:Bg,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(a){return""===a},meridiem:function(a,b,c){return a<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:Ag("s"),m:Ag("m"),mm:Ag("m"),h:Ag("h"),hh:Ag("h"),d:Ag("d"),dd:Ag("d"),M:Ag("M"),MM:Ag("M"),y:Ag("y"),yy:Ag("y")},preparse:function(a){return a.replace(/\u200f/g,"").replace(//g,",")},postformat:function(a){return a.replace(/\d/g,function(a){return xg[a]}).replace(/,/g,"")},week:{dow:6,doy:12}}),
//! moment.js locale configuration
//! locale : Arabic (Morocco) [ar-ma]
//! author : ElFadili Yassine : https://github.com/ElFadiliY
//! author : Abdel Said : https://github.com/abdelsaid
a.defineLocale("ar-ma",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:6,doy:12}});
//! moment.js locale configuration
//! locale : Arabic (Saudi Arabia) [ar-sa]
//! author : Suhail Alkowaileet : https://github.com/xsoh
var Cg={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},Dg={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};a.defineLocale("ar-sa",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(a){return""===a},meridiem:function(a,b,c){return a<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(a){return a.replace(/[]/g,function(a){return Dg[a]}).replace(//g,",")},postformat:function(a){return a.replace(/\d/g,function(a){return Cg[a]}).replace(/,/g,"")},week:{dow:0,doy:6}}),
//! moment.js locale configuration
//! locale  :  Arabic (Tunisia) [ar-tn]
//! author : Nader Toukabri : https://github.com/naderio
a.defineLocale("ar-tn",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:1,doy:4}});
//! moment.js locale configuration
//! locale : Arabic [ar]
//! author : Abdel Said: https://github.com/abdelsaid
//! author : Ahmed Elkhatib
//! author : forabi https://github.com/forabi
var Eg={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},Fg={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},Gg=function(a){return 0===a?0:1===a?1:2===a?2:a%100>=3&&a%100<=10?3:a%100>=11?4:5},Hg={s:["  "," ",["",""],"%d ","%d ","%d "],m:["  "," ",["",""],"%d ","%d ","%d "],h:["  "," ",["",""],"%d ","%d ","%d "],d:["  "," ",["",""],"%d ","%d ","%d "],M:["  "," ",["",""],"%d ","%d ","%d "],y:["  "," ",["",""],"%d ","%d ","%d "]},Ig=function(a){return function(b,c,d,e){var f=Gg(b),g=Hg[a][Gg(b)];return 2===f&&(g=g[c?0:1]),g.replace(/%d/i,b)}},Jg=["  "," "," "," "," "," "," "," "," ","  ","  ","  "];a.defineLocale("ar",{months:Jg,monthsShort:Jg,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(a){return""===a},meridiem:function(a,b,c){return a<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:Ig("s"),m:Ig("m"),mm:Ig("m"),h:Ig("h"),hh:Ig("h"),d:Ig("d"),dd:Ig("d"),M:Ig("M"),MM:Ig("M"),y:Ig("y"),yy:Ig("y")},preparse:function(a){return a.replace(/\u200f/g,"").replace(/[]/g,function(a){return Fg[a]}).replace(//g,",")},postformat:function(a){return a.replace(/\d/g,function(a){return Eg[a]}).replace(/,/g,"")},week:{dow:6,doy:12}});
//! moment.js locale configuration
//! locale : Azerbaijani [az]
//! author : topchiyev : https://github.com/topchiyev
var Kg={1:"-inci",5:"-inci",8:"-inci",70:"-inci",80:"-inci",2:"-nci",7:"-nci",20:"-nci",50:"-nci",3:"-nc",4:"-nc",100:"-nc",6:"-nc",9:"-uncu",10:"-uncu",30:"-uncu",60:"-nc",90:"-nc"};a.defineLocale("az",{months:"yanvar_fevral_mart_aprel_may_iyun_iyul_avqust_sentyabr_oktyabr_noyabr_dekabr".split("_"),monthsShort:"yan_fev_mar_apr_may_iyn_iyl_avq_sen_okt_noy_dek".split("_"),weekdays:"Bazar_Bazar ertsi_rnb axam_rnb_Cm axam_Cm_nb".split("_"),weekdaysShort:"Baz_BzE_Ax_r_CAx_Cm_n".split("_"),weekdaysMin:"Bz_BE_A__CA_C_".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[bugn saat] LT",nextDay:"[sabah saat] LT",nextWeek:"[gln hft] dddd [saat] LT",lastDay:"[dnn] LT",lastWeek:"[ken hft] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s sonra",past:"%s vvl",s:"birne saniyy",m:"bir dqiq",mm:"%d dqiq",h:"bir saat",hh:"%d saat",d:"bir gn",dd:"%d gn",M:"bir ay",MM:"%d ay",y:"bir il",yy:"%d il"},meridiemParse:/gec|shr|gndz|axam/,isPM:function(a){return/^(gndz|axam)$/.test(a)},meridiem:function(a,b,c){return a<4?"gec":a<12?"shr":a<17?"gndz":"axam"},dayOfMonthOrdinalParse:/\d{1,2}-(nc|inci|nci|nc|nc|uncu)/,ordinal:function(a){if(0===a)return a+"-nc";var b=a%10,c=a%100-b,d=a>=100?100:null;return a+(Kg[b]||Kg[c]||Kg[d])},week:{dow:1,doy:7}}),a.defineLocale("be",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:{format:"______".split("_"),standalone:"______".split("_"),isFormat:/\[ ?[] ?(?:|)? ?\] ?dddd/},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",lastDay:"[ ] LT",nextWeek:function(){return"[] dddd [] LT"},lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return"[ ] dddd [] LT";case 1:case 2:case 4:return"[ ] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:td,mm:td,h:td,hh:td,d:"",dd:td,M:"",MM:td,y:"",yy:td},meridiemParse:/|||/,isPM:function(a){return/^(|)$/.test(a)},meridiem:function(a,b,c){return a<4?"":a<12?"":a<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(||)/,ordinal:function(a,b){switch(b){case"M":case"d":case"DDD":case"w":case"W":return a%10!==2&&a%10!==3||a%100===12||a%100===13?a+"-":a+"-";case"D":return a+"-";default:return a}},week:{dow:1,doy:7}}),
//! moment.js locale configuration
//! locale : Bulgarian [bg]
//! author : Krasen Borisov : https://github.com/kraz
a.defineLocale("bg",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[ ] dddd [] LT";case 1:case 2:case 4:case 5:return"[ ] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|||||)/,ordinal:function(a){var b=a%10,c=a%100;return 0===a?a+"-":0===c?a+"-":c>10&&c<20?a+"-":1===b?a+"-":2===b?a+"-":7===b||8===b?a+"-":a+"-"},week:{dow:1,doy:7}});
//! moment.js locale configuration
//! locale : Bengali [bn]
//! author : Kaushik Gandhi : https://github.com/kaushikgandhi
var Lg={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},Mg={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};a.defineLocale("bn",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(a){return a.replace(/[]/g,function(a){return Mg[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return Lg[a]})},meridiemParse:/||||/,meridiemHour:function(a,b){return 12===a&&(a=0),""===b&&a>=4||""===b&&a<5||""===b?a+12:a},meridiem:function(a,b,c){return a<4?"":a<10?"":a<17?"":a<20?"":""},week:{dow:0,doy:6}});
//! moment.js locale configuration
//! locale : Tibetan [bo]
//! author : Thupten N. Chakrishar : https://github.com/vajradog
var Ng={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},Og={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};a.defineLocale("bo",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[], LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(a){return a.replace(/[]/g,function(a){return Og[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return Ng[a]})},meridiemParse:/||||/,meridiemHour:function(a,b){return 12===a&&(a=0),""===b&&a>=4||""===b&&a<5||""===b?a+12:a},meridiem:function(a,b,c){return a<4?"":a<10?"":a<17?"":a<20?"":""},week:{dow:0,doy:6}}),a.defineLocale("br",{months:"Genver_C'hwevrer_Meurzh_Ebrel_Mae_Mezheven_Gouere_Eost_Gwengolo_Here_Du_Kerzu".split("_"),monthsShort:"Gen_C'hwe_Meu_Ebr_Mae_Eve_Gou_Eos_Gwe_Her_Du_Ker".split("_"),weekdays:"Sul_Lun_Meurzh_Merc'her_Yaou_Gwener_Sadorn".split("_"),weekdaysShort:"Sul_Lun_Meu_Mer_Yao_Gwe_Sad".split("_"),weekdaysMin:"Su_Lu_Me_Mer_Ya_Gw_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h[e]mm A",LTS:"h[e]mm:ss A",L:"DD/MM/YYYY",LL:"D [a viz] MMMM YYYY",LLL:"D [a viz] MMMM YYYY h[e]mm A",LLLL:"dddd, D [a viz] MMMM YYYY h[e]mm A"},calendar:{sameDay:"[Hiziv da] LT",nextDay:"[Warc'hoazh da] LT",nextWeek:"dddd [da] LT",lastDay:"[Dec'h da] LT",lastWeek:"dddd [paset da] LT",sameElse:"L"},relativeTime:{future:"a-benn %s",past:"%s 'zo",s:"un nebeud segondenno",m:"ur vunutenn",mm:ud,h:"un eur",hh:"%d eur",d:"un devezh",dd:ud,M:"ur miz",MM:ud,y:"ur bloaz",yy:vd},dayOfMonthOrdinalParse:/\d{1,2}(a|vet)/,ordinal:function(a){var b=1===a?"a":"vet";return a+b},week:{dow:1,doy:4}}),a.defineLocale("bs",{months:"januar_februar_mart_april_maj_juni_juli_august_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._aug._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[juer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prolu] dddd [u] LT";case 6:return"[prole] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[proli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",m:zd,mm:zd,h:zd,hh:zd,d:"dan",dd:zd,M:"mjesec",MM:zd,y:"godinu",yy:zd},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}}),
//! moment.js locale configuration
//! locale : Catalan [ca]
//! author : Juan G. Hurtado : https://github.com/juanghurtado
a.defineLocale("ca",{months:{standalone:"gener_febrer_mar_abril_maig_juny_juliol_agost_setembre_octubre_novembre_desembre".split("_"),format:"de gener_de febrer_de mar_d'abril_de maig_de juny_de juliol_d'agost_de setembre_d'octubre_de novembre_de desembre".split("_"),isFormat:/D[oD]?(\s)+MMMM/},monthsShort:"gen._febr._mar_abr._maig_juny_jul._ag._set._oct._nov._des.".split("_"),monthsParseExact:!0,weekdays:"diumenge_dilluns_dimarts_dimecres_dijous_divendres_dissabte".split("_"),weekdaysShort:"dg._dl._dt._dc._dj._dv._ds.".split("_"),weekdaysMin:"Dg_Dl_Dt_Dc_Dj_Dv_Ds".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"[el] D MMMM [de] YYYY",ll:"D MMM YYYY",LLL:"[el] D MMMM [de] YYYY [a les] H:mm",lll:"D MMM YYYY, H:mm",LLLL:"[el] dddd D MMMM [de] YYYY [a les] H:mm",llll:"ddd D MMM YYYY, H:mm"},calendar:{sameDay:function(){return"[avui a "+(1!==this.hours()?"les":"la")+"] LT"},nextDay:function(){return"[dem a "+(1!==this.hours()?"les":"la")+"] LT"},nextWeek:function(){return"dddd [a "+(1!==this.hours()?"les":"la")+"] LT"},lastDay:function(){return"[ahir a "+(1!==this.hours()?"les":"la")+"] LT"},lastWeek:function(){return"[el] dddd [passat a "+(1!==this.hours()?"les":"la")+"] LT"},sameElse:"L"},relativeTime:{future:"d'aqu %s",past:"fa %s",s:"uns segons",m:"un minut",mm:"%d minuts",h:"una hora",hh:"%d hores",d:"un dia",dd:"%d dies",M:"un mes",MM:"%d mesos",y:"un any",yy:"%d anys"},dayOfMonthOrdinalParse:/\d{1,2}(r|n|t||a)/,ordinal:function(a,b){var c=1===a?"r":2===a?"n":3===a?"r":4===a?"t":"";return"w"!==b&&"W"!==b||(c="a"),a+c},week:{dow:1,doy:4}});
//! moment.js locale configuration
//! locale : Czech [cs]
//! author : petrbela : https://github.com/petrbela
var Pg="leden_nor_bezen_duben_kvten_erven_ervenec_srpen_z_jen_listopad_prosinec".split("_"),Qg="led_no_be_dub_kv_vn_vc_srp_z_j_lis_pro".split("_");a.defineLocale("cs",{months:Pg,monthsShort:Qg,monthsParse:function(a,b){var c,d=[];for(c=0;c<12;c++)d[c]=new RegExp("^"+a[c]+"$|^"+b[c]+"$","i");return d}(Pg,Qg),shortMonthsParse:function(a){var b,c=[];for(b=0;b<12;b++)c[b]=new RegExp("^"+a[b]+"$","i");return c}(Qg),longMonthsParse:function(a){var b,c=[];for(b=0;b<12;b++)c[b]=new RegExp("^"+a[b]+"$","i");return c}(Pg),weekdays:"nedle_pondl_ter_steda_tvrtek_ptek_sobota".split("_"),weekdaysShort:"ne_po_t_st_t_p_so".split("_"),weekdaysMin:"ne_po_t_st_t_p_so".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm",l:"D. M. YYYY"},calendar:{sameDay:"[dnes v] LT",nextDay:"[ztra v] LT",nextWeek:function(){switch(this.day()){case 0:return"[v nedli v] LT";case 1:case 2:return"[v] dddd [v] LT";case 3:return"[ve stedu v] LT";case 4:return"[ve tvrtek v] LT";case 5:return"[v ptek v] LT";case 6:return"[v sobotu v] LT"}},lastDay:"[vera v] LT",lastWeek:function(){switch(this.day()){case 0:return"[minulou nedli v] LT";case 1:case 2:return"[minul] dddd [v] LT";case 3:return"[minulou stedu v] LT";case 4:case 5:return"[minul] dddd [v] LT";case 6:return"[minulou sobotu v] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"ped %s",s:Bd,m:Bd,mm:Bd,h:Bd,hh:Bd,d:Bd,dd:Bd,M:Bd,MM:Bd,y:Bd,yy:Bd},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : Chuvash [cv]
//! author : Anatoly Mironov : https://github.com/mirontoli
a.defineLocale("cv",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"YYYY [] MMMM [] D[-]",LLL:"YYYY [] MMMM [] D[-], HH:mm",LLLL:"dddd, YYYY [] MMMM [] D[-], HH:mm"},calendar:{sameDay:"[] LT []",nextDay:"[] LT []",lastDay:"[] LT []",nextWeek:"[] dddd LT []",lastWeek:"[] dddd LT []",sameElse:"L"},relativeTime:{future:function(a){var b=/$/i.exec(a)?"":/$/i.exec(a)?"":"";return a+b},past:"%s ",s:"- ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-/,ordinal:"%d-",week:{dow:1,doy:7}}),
//! moment.js locale configuration
//! locale : Welsh [cy]
//! author : Robert Allen : https://github.com/robgallen
//! author : https://github.com/ryangreaves
a.defineLocale("cy",{months:"Ionawr_Chwefror_Mawrth_Ebrill_Mai_Mehefin_Gorffennaf_Awst_Medi_Hydref_Tachwedd_Rhagfyr".split("_"),monthsShort:"Ion_Chwe_Maw_Ebr_Mai_Meh_Gor_Aws_Med_Hyd_Tach_Rhag".split("_"),weekdays:"Dydd Sul_Dydd Llun_Dydd Mawrth_Dydd Mercher_Dydd Iau_Dydd Gwener_Dydd Sadwrn".split("_"),weekdaysShort:"Sul_Llun_Maw_Mer_Iau_Gwe_Sad".split("_"),weekdaysMin:"Su_Ll_Ma_Me_Ia_Gw_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Heddiw am] LT",nextDay:"[Yfory am] LT",nextWeek:"dddd [am] LT",lastDay:"[Ddoe am] LT",lastWeek:"dddd [diwethaf am] LT",sameElse:"L"},relativeTime:{future:"mewn %s",past:"%s yn l",s:"ychydig eiliadau",m:"munud",mm:"%d munud",h:"awr",hh:"%d awr",d:"diwrnod",dd:"%d diwrnod",M:"mis",MM:"%d mis",y:"blwyddyn",yy:"%d flynedd"},dayOfMonthOrdinalParse:/\d{1,2}(fed|ain|af|il|ydd|ed|eg)/,ordinal:function(a){var b=a,c="",d=["","af","il","ydd","ydd","ed","ed","ed","fed","fed","fed","eg","fed","eg","eg","fed","eg","eg","fed","eg","fed"];return b>20?c=40===b||50===b||60===b||80===b||100===b?"fed":"ain":b>0&&(c=d[b]),a+c},week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : Danish [da]
//! author : Ulrik Nielsen : https://github.com/mrbase
a.defineLocale("da",{months:"januar_februar_marts_april_maj_juni_juli_august_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"sndag_mandag_tirsdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"sn_man_tir_ons_tor_fre_lr".split("_"),weekdaysMin:"s_ma_ti_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd [d.] D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[i dag kl.] LT",nextDay:"[i morgen kl.] LT",nextWeek:"p dddd [kl.] LT",lastDay:"[i gr kl.] LT",lastWeek:"[i] dddd[s kl.] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s siden",s:"f sekunder",m:"et minut",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dage",M:"en mned",MM:"%d mneder",y:"et r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),a.defineLocale("de-at",{months:"Jnner_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jn._Febr._Mrz._Apr._Mai_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",m:Cd,mm:"%d Minuten",h:Cd,hh:"%d Stunden",d:Cd,dd:Cd,M:Cd,MM:Cd,y:Cd,yy:Cd},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),a.defineLocale("de-ch",{months:"Januar_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Febr._Mrz_April_Mai_Juni_Juli_Aug._Sept._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH.mm",LLLL:"dddd, D. MMMM YYYY HH.mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",m:Dd,mm:"%d Minuten",h:Dd,hh:"%d Stunden",d:Dd,dd:Dd,M:Dd,MM:Dd,y:Dd,yy:Dd},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),a.defineLocale("de",{months:"Januar_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Febr._Mrz._Apr._Mai_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",m:Ed,mm:"%d Minuten",h:Ed,hh:"%d Stunden",d:Ed,dd:Ed,M:Ed,MM:Ed,y:Ed,yy:Ed},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});
//! moment.js locale configuration
//! locale : Maldivian [dv]
//! author : Jawish Hameed : https://github.com/jawish
var Rg=["","","","","","","","","","","",""],Sg=["","","","","","",""];a.defineLocale("dv",{months:Rg,monthsShort:Rg,weekdays:Sg,weekdaysShort:Sg,weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(a){return""===a},meridiem:function(a,b,c){return a<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd LT",lastDay:"[] LT",lastWeek:"[] dddd LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",m:"",mm:" %d",h:"",hh:" %d",d:"",dd:" %d",M:"",MM:" %d",y:"",yy:" %d"},preparse:function(a){return a.replace(//g,",")},postformat:function(a){return a.replace(/,/g,"")},week:{dow:7,doy:12}}),
//! moment.js locale configuration
//! locale : Greek [el]
//! author : Aggelos Karalias : https://github.com/mehiel
a.defineLocale("el",{monthsNominativeEl:"___________".split("_"),monthsGenitiveEl:"___________".split("_"),months:function(a,b){return a?/D/.test(b.substring(0,b.indexOf("MMMM")))?this._monthsGenitiveEl[a.month()]:this._monthsNominativeEl[a.month()]:this._monthsNominativeEl},monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),meridiem:function(a,b,c){return a>11?c?"":"":c?"":""},isPM:function(a){return""===(a+"").toLowerCase()[0]},meridiemParse:/[]\.??\.?/i,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendarEl:{sameDay:"[ {}] LT",nextDay:"[ {}] LT",nextWeek:"dddd [{}] LT",lastDay:"[ {}] LT",lastWeek:function(){switch(this.day()){case 6:return"[ ] dddd [{}] LT";default:return"[ ] dddd [{}] LT"}},sameElse:"L"},calendar:function(a,b){var c=this._calendarEl[a],d=b&&b.hours();return z(c)&&(c=c.apply(b)),c.replace("{}",d%12===1?"":"")},relativeTime:{future:" %s",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : English (Australia) [en-au]
//! author : Jared Morse : https://github.com/jarcoal
a.defineLocale("en-au",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(a){var b=a%10,c=1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c},week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : English (Canada) [en-ca]
//! author : Jonathan Abourbih : https://github.com/jonbca
a.defineLocale("en-ca",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"YYYY-MM-DD",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(a){var b=a%10,c=1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c}}),
//! moment.js locale configuration
//! locale : English (United Kingdom) [en-gb]
//! author : Chris Gedrim : https://github.com/chrisgedrim
a.defineLocale("en-gb",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(a){var b=a%10,c=1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c},week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : English (Ireland) [en-ie]
//! author : Chris Cartlidge : https://github.com/chriscartlidge
a.defineLocale("en-ie",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(a){var b=a%10,c=1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c},week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : English (New Zealand) [en-nz]
//! author : Luke McGregor : https://github.com/lukemcgregor
a.defineLocale("en-nz",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(a){var b=a%10,c=1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c},week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : Esperanto [eo]
//! author : Colin Dean : https://github.com/colindean
//! author : Mia Nordentoft Imperatori : https://github.com/miestasmia
//! comment : miestasmia corrected the translation by colindean
a.defineLocale("eo",{months:"januaro_februaro_marto_aprilo_majo_junio_julio_agusto_septembro_oktobro_novembro_decembro".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_ag_sep_okt_nov_dec".split("_"),weekdays:"dimano_lundo_mardo_merkredo_ado_vendredo_sabato".split("_"),weekdaysShort:"dim_lun_mard_merk_a_ven_sab".split("_"),weekdaysMin:"di_lu_ma_me_a_ve_sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D[-a de] MMMM, YYYY",LLL:"D[-a de] MMMM, YYYY HH:mm",LLLL:"dddd, [la] D[-a de] MMMM, YYYY HH:mm"},meridiemParse:/[ap]\.t\.m/i,isPM:function(a){return"p"===a.charAt(0).toLowerCase()},meridiem:function(a,b,c){return a>11?c?"p.t.m.":"P.T.M.":c?"a.t.m.":"A.T.M."},calendar:{sameDay:"[Hodia je] LT",nextDay:"[Morga je] LT",nextWeek:"dddd [je] LT",lastDay:"[Hiera je] LT",lastWeek:"[pasinta] dddd [je] LT",sameElse:"L"},relativeTime:{future:"post %s",past:"anta %s",s:"sekundoj",m:"minuto",mm:"%d minutoj",h:"horo",hh:"%d horoj",d:"tago",dd:"%d tagoj",M:"monato",MM:"%d monatoj",y:"jaro",yy:"%d jaroj"},dayOfMonthOrdinalParse:/\d{1,2}a/,ordinal:"%da",week:{dow:1,doy:7}});
//! moment.js locale configuration
//! locale : Spanish (Dominican Republic) [es-do]
var Tg="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),Ug="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_");a.defineLocale("es-do",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(a,b){return a?/-MMM-/.test(b)?Ug[a.month()]:Tg[a.month()]:Tg},monthsParseExact:!0,weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY h:mm A",LLLL:"dddd, D [de] MMMM [de] YYYY h:mm A"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}});
//! moment.js locale configuration
//! locale : Spanish [es]
//! author : Julio Napur : https://github.com/julionc
var Vg="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),Wg="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_");a.defineLocale("es",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(a,b){return a?/-MMM-/.test(b)?Wg[a.month()]:Vg[a.month()]:Vg},monthsParseExact:!0,weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}}),a.defineLocale("et",{months:"jaanuar_veebruar_mrts_aprill_mai_juuni_juuli_august_september_oktoober_november_detsember".split("_"),monthsShort:"jaan_veebr_mrts_apr_mai_juuni_juuli_aug_sept_okt_nov_dets".split("_"),weekdays:"phapev_esmaspev_teisipev_kolmapev_neljapev_reede_laupev".split("_"),weekdaysShort:"P_E_T_K_N_R_L".split("_"),weekdaysMin:"P_E_T_K_N_R_L".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[Tna,] LT",nextDay:"[Homme,] LT",nextWeek:"[Jrgmine] dddd LT",lastDay:"[Eile,] LT",lastWeek:"[Eelmine] dddd LT",sameElse:"L"},relativeTime:{future:"%s prast",past:"%s tagasi",s:Fd,m:Fd,mm:Fd,h:Fd,hh:Fd,d:Fd,dd:"%d peva",M:Fd,MM:Fd,y:Fd,yy:Fd},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : Basque [eu]
//! author : Eneko Illarramendi : https://github.com/eillarra
a.defineLocale("eu",{months:"urtarrila_otsaila_martxoa_apirila_maiatza_ekaina_uztaila_abuztua_iraila_urria_azaroa_abendua".split("_"),monthsShort:"urt._ots._mar._api._mai._eka._uzt._abu._ira._urr._aza._abe.".split("_"),monthsParseExact:!0,weekdays:"igandea_astelehena_asteartea_asteazkena_osteguna_ostirala_larunbata".split("_"),weekdaysShort:"ig._al._ar._az._og._ol._lr.".split("_"),weekdaysMin:"ig_al_ar_az_og_ol_lr".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY[ko] MMMM[ren] D[a]",LLL:"YYYY[ko] MMMM[ren] D[a] HH:mm",LLLL:"dddd, YYYY[ko] MMMM[ren] D[a] HH:mm",l:"YYYY-M-D",ll:"YYYY[ko] MMM D[a]",lll:"YYYY[ko] MMM D[a] HH:mm",llll:"ddd, YYYY[ko] MMM D[a] HH:mm"},calendar:{sameDay:"[gaur] LT[etan]",nextDay:"[bihar] LT[etan]",nextWeek:"dddd LT[etan]",lastDay:"[atzo] LT[etan]",lastWeek:"[aurreko] dddd LT[etan]",sameElse:"L"},relativeTime:{future:"%s barru",past:"duela %s",s:"segundo batzuk",m:"minutu bat",mm:"%d minutu",h:"ordu bat",hh:"%d ordu",d:"egun bat",dd:"%d egun",M:"hilabete bat",MM:"%d hilabete",y:"urte bat",yy:"%d urte"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}});
//! moment.js locale configuration
//! locale : Persian [fa]
//! author : Ebrahim Byagowi : https://github.com/ebraminio
var Xg={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},Yg={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};a.defineLocale("fa",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},meridiemParse:/  |  /,isPM:function(a){return/  /.test(a)},meridiem:function(a,b,c){return a<12?"  ":"  "},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] [] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(a){return a.replace(/[-]/g,function(a){return Yg[a]}).replace(//g,",")},postformat:function(a){return a.replace(/\d/g,function(a){return Xg[a]}).replace(/,/g,"")},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:6,doy:12}});
//! moment.js locale configuration
//! locale : Finnish [fi]
//! author : Tarmo Aidantausta : https://github.com/bleadof
var Zg="nolla yksi kaksi kolme nelj viisi kuusi seitsemn kahdeksan yhdeksn".split(" "),$g=["nolla","yhden","kahden","kolmen","neljn","viiden","kuuden",Zg[7],Zg[8],Zg[9]];a.defineLocale("fi",{months:"tammikuu_helmikuu_maaliskuu_huhtikuu_toukokuu_keskuu_heinkuu_elokuu_syyskuu_lokakuu_marraskuu_joulukuu".split("_"),monthsShort:"tammi_helmi_maalis_huhti_touko_kes_hein_elo_syys_loka_marras_joulu".split("_"),weekdays:"sunnuntai_maanantai_tiistai_keskiviikko_torstai_perjantai_lauantai".split("_"),weekdaysShort:"su_ma_ti_ke_to_pe_la".split("_"),weekdaysMin:"su_ma_ti_ke_to_pe_la".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"Do MMMM[ta] YYYY",LLL:"Do MMMM[ta] YYYY, [klo] HH.mm",LLLL:"dddd, Do MMMM[ta] YYYY, [klo] HH.mm",l:"D.M.YYYY",ll:"Do MMM YYYY",lll:"Do MMM YYYY, [klo] HH.mm",llll:"ddd, Do MMM YYYY, [klo] HH.mm"},calendar:{sameDay:"[tnn] [klo] LT",nextDay:"[huomenna] [klo] LT",nextWeek:"dddd [klo] LT",lastDay:"[eilen] [klo] LT",lastWeek:"[viime] dddd[na] [klo] LT",sameElse:"L"},relativeTime:{future:"%s pst",past:"%s sitten",s:Gd,m:Gd,mm:Gd,h:Gd,hh:Gd,d:Gd,dd:Gd,M:Gd,MM:Gd,y:Gd,yy:Gd},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : Faroese [fo]
//! author : Ragnar Johannesen : https://github.com/ragnar123
a.defineLocale("fo",{months:"januar_februar_mars_aprl_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sunnudagur_mnadagur_tsdagur_mikudagur_hsdagur_frggjadagur_leygardagur".split("_"),weekdaysShort:"sun_mn_ts_mik_hs_fr_ley".split("_"),weekdaysMin:"su_m_t_mi_h_fr_le".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D. MMMM, YYYY HH:mm"},calendar:{sameDay:"[ dag kl.] LT",nextDay:"[ morgin kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[ gjr kl.] LT",lastWeek:"[sstu] dddd [kl] LT",sameElse:"L"},relativeTime:{future:"um %s",past:"%s sani",s:"f sekund",m:"ein minutt",mm:"%d minuttir",h:"ein tmi",hh:"%d tmar",d:"ein dagur",dd:"%d dagar",M:"ein mnai",MM:"%d mnair",y:"eitt r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : French (Canada) [fr-ca]
//! author : Jonathan Abourbih : https://github.com/jonbca
a.defineLocale("fr-ca",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourdhui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|e)/,ordinal:function(a,b){switch(b){default:case"M":case"Q":case"D":case"DDD":case"d":return a+(1===a?"er":"e");case"w":case"W":return a+(1===a?"re":"e")}}}),
//! moment.js locale configuration
//! locale : French (Switzerland) [fr-ch]
//! author : Gaspard Bucher : https://github.com/gaspard
a.defineLocale("fr-ch",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourdhui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|e)/,ordinal:function(a,b){switch(b){default:case"M":case"Q":case"D":case"DDD":case"d":return a+(1===a?"er":"e");case"w":case"W":return a+(1===a?"re":"e")}},week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : French [fr]
//! author : John Fischer : https://github.com/jfroffice
a.defineLocale("fr",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourdhui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|)/,ordinal:function(a,b){switch(b){case"D":return a+(1===a?"er":"");default:case"M":case"Q":case"DDD":case"d":return a+(1===a?"er":"e");case"w":case"W":return a+(1===a?"re":"e")}},week:{dow:1,doy:4}});
//! moment.js locale configuration
//! locale : Frisian [fy]
//! author : Robin van der Vliet : https://github.com/robin0van0der0v
var _g="jan._feb._mrt._apr._mai_jun._jul._aug._sep._okt._nov._des.".split("_"),ah="jan_feb_mrt_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_");a.defineLocale("fy",{months:"jannewaris_febrewaris_maart_april_maaie_juny_july_augustus_septimber_oktober_novimber_desimber".split("_"),monthsShort:function(a,b){return a?/-MMM-/.test(b)?ah[a.month()]:_g[a.month()]:_g},monthsParseExact:!0,weekdays:"snein_moandei_tiisdei_woansdei_tongersdei_freed_sneon".split("_"),weekdaysShort:"si._mo._ti._wo._to._fr._so.".split("_"),weekdaysMin:"Si_Mo_Ti_Wo_To_Fr_So".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[hjoed om] LT",nextDay:"[moarn om] LT",nextWeek:"dddd [om] LT",lastDay:"[juster om] LT",lastWeek:"[frne] dddd [om] LT",sameElse:"L"},relativeTime:{future:"oer %s",past:"%s lyn",s:"in pear sekonden",m:"ien mint",mm:"%d minuten",h:"ien oere",hh:"%d oeren",d:"ien dei",dd:"%d dagen",M:"ien moanne",MM:"%d moannen",y:"ien jier",yy:"%d jierren"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(a){return a+(1===a||8===a||a>=20?"ste":"de")},week:{dow:1,doy:4}});
//! moment.js locale configuration
//! locale : Scottish Gaelic [gd]
//! author : Jon Ashdown : https://github.com/jonashdown
var bh=["Am Faoilleach","An Gearran","Am Mrt","An Giblean","An Citean","An t-gmhios","An t-Iuchar","An Lnastal","An t-Sultain","An Dmhair","An t-Samhain","An Dbhlachd"],ch=["Faoi","Gear","Mrt","Gibl","Cit","gmh","Iuch","Ln","Sult","Dmh","Samh","Dbh"],dh=["Didmhnaich","Diluain","Dimirt","Diciadain","Diardaoin","Dihaoine","Disathairne"],eh=["Did","Dil","Dim","Dic","Dia","Dih","Dis"],fh=["D","Lu","M","Ci","Ar","Ha","Sa"];a.defineLocale("gd",{months:bh,monthsShort:ch,monthsParseExact:!0,weekdays:dh,weekdaysShort:eh,weekdaysMin:fh,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[An-diugh aig] LT",nextDay:"[A-mireach aig] LT",nextWeek:"dddd [aig] LT",lastDay:"[An-d aig] LT",lastWeek:"dddd [seo chaidh] [aig] LT",sameElse:"L"},relativeTime:{future:"ann an %s",past:"bho chionn %s",s:"beagan diogan",m:"mionaid",mm:"%d mionaidean",h:"uair",hh:"%d uairean",d:"latha",dd:"%d latha",M:"mos",MM:"%d mosan",y:"bliadhna",yy:"%d bliadhna"},dayOfMonthOrdinalParse:/\d{1,2}(d|na|mh)/,ordinal:function(a){var b=1===a?"d":a%10===2?"na":"mh";return a+b},week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : Galician [gl]
//! author : Juan G. Hurtado : https://github.com/juanghurtado
a.defineLocale("gl",{months:"xaneiro_febreiro_marzo_abril_maio_xuo_xullo_agosto_setembro_outubro_novembro_decembro".split("_"),monthsShort:"xan._feb._mar._abr._mai._xu._xul._ago._set._out._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"domingo_luns_martes_mrcores_xoves_venres_sbado".split("_"),weekdaysShort:"dom._lun._mar._mr._xov._ven._sb.".split("_"),weekdaysMin:"do_lu_ma_m_xo_ve_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},calendar:{sameDay:function(){return"[hoxe "+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[ma "+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd ["+(1!==this.hours()?"s":"a")+"] LT"},lastDay:function(){return"[onte "+(1!==this.hours()?"":"a")+"] LT"},lastWeek:function(){return"[o] dddd [pasado "+(1!==this.hours()?"s":"a")+"] LT"},sameElse:"L"},relativeTime:{future:function(a){return 0===a.indexOf("un")?"n"+a:"en "+a},past:"hai %s",s:"uns segundos",m:"un minuto",mm:"%d minutos",h:"unha hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}}),a.defineLocale("gom-latn",{months:"Janer_Febrer_Mars_Abril_Mai_Jun_Julai_Agost_Setembr_Otubr_Novembr_Dezembr".split("_"),monthsShort:"Jan._Feb._Mars_Abr._Mai_Jun_Jul._Ago._Set._Otu._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Aitar_Somar_Mongllar_Budvar_Brestar_Sukrar_Son'var".split("_"),weekdaysShort:"Ait._Som._Mon._Bud._Bre._Suk._Son.".split("_"),weekdaysMin:"Ai_Sm_Mo_Bu_Br_Su_Sn".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"A h:mm [vazta]",LTS:"A h:mm:ss [vazta]",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY A h:mm [vazta]",LLLL:"dddd, MMMM[achea] Do, YYYY, A h:mm [vazta]",llll:"ddd, D MMM YYYY, A h:mm [vazta]"},calendar:{sameDay:"[Aiz] LT",nextDay:"[Faleam] LT",nextWeek:"[Ieta to] dddd[,] LT",lastDay:"[Kal] LT",lastWeek:"[Fatlo] dddd[,] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s adim",s:Id,m:Id,mm:Id,h:Id,hh:Id,d:Id,dd:Id,M:Id,MM:Id,y:Id,yy:Id},dayOfMonthOrdinalParse:/\d{1,2}(er)/,ordinal:function(a,b){switch(b){case"D":return a+"er";default:case"M":case"Q":case"DDD":case"d":case"w":case"W":return a}},week:{dow:1,doy:4},meridiemParse:/rati|sokalli|donparam|sanje/,meridiemHour:function(a,b){return 12===a&&(a=0),"rati"===b?a<4?a:a+12:"sokalli"===b?a:"donparam"===b?a>12?a:a+12:"sanje"===b?a+12:void 0},meridiem:function(a,b,c){return a<4?"rati":a<12?"sokalli":a<16?"donparam":a<20?"sanje":"rati"}}),
//! moment.js locale configuration
//! locale : Hebrew [he]
//! author : Tomer Cohen : https://github.com/tomer
//! author : Moshe Simantov : https://github.com/DevelopmentIL
//! author : Tal Ater : https://github.com/TalAter
a.defineLocale("he",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D []MMMM YYYY",LLL:"D []MMMM YYYY HH:mm",LLLL:"dddd, D []MMMM YYYY HH:mm",l:"D/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},calendar:{sameDay:"[ ]LT",nextDay:"[ ]LT",nextWeek:"dddd [] LT",lastDay:"[ ]LT",lastWeek:"[] dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",m:"",mm:"%d ",h:"",hh:function(a){return 2===a?"":a+" "},d:"",dd:function(a){return 2===a?"":a+" "},M:"",MM:function(a){return 2===a?"":a+" "},y:"",yy:function(a){return 2===a?"":a%10===0&&10!==a?a+" ":a+" "}},meridiemParse:/"|"| | | ||/i,isPM:function(a){return/^("| |)$/.test(a)},meridiem:function(a,b,c){return a<5?" ":a<10?"":a<12?c?'"':" ":a<18?c?'"':" ":""}});
//! moment.js locale configuration
//! locale : Hindi [hi]
//! author : Mayank Singhal : https://github.com/mayanksinghal
var gh={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},hh={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};a.defineLocale("hi",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(a){return a.replace(/[]/g,function(a){return hh[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return gh[a]})},meridiemParse:/|||/,meridiemHour:function(a,b){return 12===a&&(a=0),""===b?a<4?a:a+12:""===b?a:""===b?a>=10?a:a+12:""===b?a+12:void 0},meridiem:function(a,b,c){return a<4?"":a<10?"":a<17?"":a<20?"":""},week:{dow:0,doy:6}}),a.defineLocale("hr",{months:{format:"sijenja_veljae_oujka_travnja_svibnja_lipnja_srpnja_kolovoza_rujna_listopada_studenoga_prosinca".split("_"),standalone:"sijeanj_veljaa_oujak_travanj_svibanj_lipanj_srpanj_kolovoz_rujan_listopad_studeni_prosinac".split("_")},monthsShort:"sij._velj._ou._tra._svi._lip._srp._kol._ruj._lis._stu._pro.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[juer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prolu] dddd [u] LT";case 6:return"[prole] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[proli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",m:Jd,mm:Jd,h:Jd,hh:Jd,d:"dan",dd:Jd,M:"mjesec",MM:Jd,y:"godinu",yy:Jd},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}});
//! moment.js locale configuration
//! locale : Hungarian [hu]
//! author : Adam Brunner : https://github.com/adambrunner
var ih="vasrnap htfn kedden szerdn cstrtkn pnteken szombaton".split(" ");a.defineLocale("hu",{months:"janur_februr_mrcius_prilis_mjus_jnius_jlius_augusztus_szeptember_oktber_november_december".split("_"),monthsShort:"jan_feb_mrc_pr_mj_jn_jl_aug_szept_okt_nov_dec".split("_"),weekdays:"vasrnap_htf_kedd_szerda_cstrtk_pntek_szombat".split("_"),weekdaysShort:"vas_ht_kedd_sze_cst_pn_szo".split("_"),weekdaysMin:"v_h_k_sze_cs_p_szo".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY. MMMM D.",LLL:"YYYY. MMMM D. H:mm",LLLL:"YYYY. MMMM D., dddd H:mm"},meridiemParse:/de|du/i,isPM:function(a){return"u"===a.charAt(1).toLowerCase()},meridiem:function(a,b,c){return a<12?c===!0?"de":"DE":c===!0?"du":"DU"},calendar:{sameDay:"[ma] LT[-kor]",nextDay:"[holnap] LT[-kor]",nextWeek:function(){return Ld.call(this,!0)},lastDay:"[tegnap] LT[-kor]",lastWeek:function(){return Ld.call(this,!1)},sameElse:"L"},relativeTime:{future:"%s mlva",past:"%s",s:Kd,m:Kd,mm:Kd,h:Kd,hh:Kd,d:Kd,dd:Kd,M:Kd,MM:Kd,y:Kd,yy:Kd},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : Armenian [hy-am]
//! author : Armendarabyan : https://github.com/armendarabyan
a.defineLocale("hy-am",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",lastDay:"[] LT",nextWeek:function(){return"dddd [ ] LT"},lastWeek:function(){return"[] dddd [ ] LT"},sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},meridiemParse:/|||/,isPM:function(a){return/^(|)$/.test(a)},meridiem:function(a){return a<4?"":a<12?"":a<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}|\d{1,2}-(|)/,ordinal:function(a,b){switch(b){case"DDD":case"w":case"W":case"DDDo":return 1===a?a+"-":a+"-";default:return a}},week:{dow:1,doy:7}}),
//! moment.js locale configuration
//! locale : Indonesian [id]
//! author : Mohammad Satrio Utomo : https://github.com/tyok
//! reference: http://id.wikisource.org/wiki/Pedoman_Umum_Ejaan_Bahasa_Indonesia_yang_Disempurnakan
a.defineLocale("id",{months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_November_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Ags_Sep_Okt_Nov_Des".split("_"),weekdays:"Minggu_Senin_Selasa_Rabu_Kamis_Jumat_Sabtu".split("_"),weekdaysShort:"Min_Sen_Sel_Rab_Kam_Jum_Sab".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|siang|sore|malam/,meridiemHour:function(a,b){return 12===a&&(a=0),"pagi"===b?a:"siang"===b?a>=11?a:a+12:"sore"===b||"malam"===b?a+12:void 0},meridiem:function(a,b,c){return a<11?"pagi":a<15?"siang":a<19?"sore":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Besok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kemarin pukul] LT",lastWeek:"dddd [lalu pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lalu",s:"beberapa detik",m:"semenit",mm:"%d menit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}}),a.defineLocale("is",{months:"janar_febrar_mars_aprl_ma_jn_jl_gst_september_oktber_nvember_desember".split("_"),monthsShort:"jan_feb_mar_apr_ma_jn_jl_g_sep_okt_nv_des".split("_"),weekdays:"sunnudagur_mnudagur_rijudagur_mivikudagur_fimmtudagur_fstudagur_laugardagur".split("_"),weekdaysShort:"sun_mn_ri_mi_fim_fs_lau".split("_"),weekdaysMin:"Su_M_r_Mi_Fi_F_La".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] H:mm",LLLL:"dddd, D. MMMM YYYY [kl.] H:mm"},calendar:{sameDay:"[ dag kl.] LT",nextDay:"[ morgun kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[ gr kl.] LT",lastWeek:"[sasta] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"eftir %s",past:"fyrir %s san",s:Nd,m:Nd,mm:Nd,h:"klukkustund",hh:Nd,d:Nd,dd:Nd,M:Nd,MM:Nd,y:Nd,yy:Nd},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : Italian [it]
//! author : Lorenzo : https://github.com/aliem
//! author: Mattia Larentis: https://github.com/nostalgiaz
a.defineLocale("it",{months:"gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"),monthsShort:"gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),weekdays:"domenica_luned_marted_mercoled_gioved_venerd_sabato".split("_"),weekdaysShort:"dom_lun_mar_mer_gio_ven_sab".split("_"),weekdaysMin:"do_lu_ma_me_gi_ve_sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Oggi alle] LT",nextDay:"[Domani alle] LT",nextWeek:"dddd [alle] LT",lastDay:"[Ieri alle] LT",lastWeek:function(){switch(this.day()){case 0:return"[la scorsa] dddd [alle] LT";default:return"[lo scorso] dddd [alle] LT"}},sameElse:"L"},relativeTime:{future:function(a){return(/^[0-9].+$/.test(a)?"tra":"in")+" "+a},past:"%s fa",s:"alcuni secondi",m:"un minuto",mm:"%d minuti",h:"un'ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : Japanese [ja]
//! author : LI Long : https://github.com/baryon
a.defineLocale("ja",{months:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMD HH:mm dddd",l:"YYYY/MM/DD",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMD HH:mm dddd"},meridiemParse:/|/i,isPM:function(a){return""===a},meridiem:function(a,b,c){return a<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[]dddd LT",lastDay:"[] LT",lastWeek:"[]dddd LT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(a,b){switch(b){case"d":case"D":case"DDD":return a+"";default:return a}},relativeTime:{future:"%s",past:"%s",s:"",m:"1",mm:"%d",h:"1",hh:"%d",d:"1",dd:"%d",M:"1",MM:"%d",y:"1",yy:"%d"}}),
//! moment.js locale configuration
//! locale : Javanese [jv]
//! author : Rony Lantip : https://github.com/lantip
//! reference: http://jv.wikipedia.org/wiki/Basa_Jawa
a.defineLocale("jv",{months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_Nopember_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Ags_Sep_Okt_Nop_Des".split("_"),weekdays:"Minggu_Senen_Seloso_Rebu_Kemis_Jemuwah_Septu".split("_"),weekdaysShort:"Min_Sen_Sel_Reb_Kem_Jem_Sep".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sp".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/enjing|siyang|sonten|ndalu/,meridiemHour:function(a,b){return 12===a&&(a=0),"enjing"===b?a:"siyang"===b?a>=11?a:a+12:"sonten"===b||"ndalu"===b?a+12:void 0},meridiem:function(a,b,c){return a<11?"enjing":a<15?"siyang":a<19?"sonten":"ndalu"},calendar:{sameDay:"[Dinten puniko pukul] LT",nextDay:"[Mbenjang pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kala wingi pukul] LT",lastWeek:"dddd [kepengker pukul] LT",sameElse:"L"},relativeTime:{future:"wonten ing %s",past:"%s ingkang kepengker",s:"sawetawis detik",m:"setunggal menit",mm:"%d menit",h:"setunggal jam",hh:"%d jam",d:"sedinten",dd:"%d dinten",M:"sewulan",MM:"%d wulan",y:"setaun",yy:"%d taun"},week:{dow:1,doy:7}}),
//! moment.js locale configuration
//! locale : Georgian [ka]
//! author : Irakli Janiashvili : https://github.com/irakli-janiashvili
a.defineLocale("ka",{months:{standalone:"___________".split("_"),format:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:{standalone:"______".split("_"),format:"______".split("_"),isFormat:/(|)/},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[] LT[-]",nextDay:"[] LT[-]",lastDay:"[] LT[-]",nextWeek:"[] dddd LT[-]",lastWeek:"[] dddd LT-",sameElse:"L"},relativeTime:{future:function(a){return/(|||)/.test(a)?a.replace(/$/,""):a+""},past:function(a){return/(||||)/.test(a)?a.replace(/(|)$/," ")://.test(a)?a.replace(/$/," "):void 0},s:" ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/0|1-|-\d{1,2}|\d{1,2}-/,ordinal:function(a){return 0===a?a:1===a?a+"-":a<20||a<=100&&a%20===0||a%100===0?"-"+a:a+"-"},week:{dow:1,doy:7}});
//! moment.js locale configuration
//! locale : Kazakh [kk]
//! authors : Nurlan Rakhimzhanov : https://github.com/nurlan
var jh={0:"-",1:"-",2:"-",3:"-",4:"-",5:"-",6:"-",7:"-",8:"-",9:"-",10:"-",20:"-",30:"-",40:"-",50:"-",60:"-",70:"-",80:"-",90:"-",100:"-"};a.defineLocale("kk",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"[ ] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|)/,ordinal:function(a){var b=a%10,c=a>=100?100:null;return a+(jh[a]||jh[b]||jh[c])},week:{dow:1,doy:7}}),
//! moment.js locale configuration
//! locale : Cambodian [km]
//! author : Kruy Vanna : https://github.com/kruyvanna
a.defineLocale("km",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] [] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s",s:"",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:1,doy:4}});
//! moment.js locale configuration
//! locale : Kannada [kn]
//! author : Rajeev Naik : https://github.com/rajeevnaikte
var kh={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},lh={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};a.defineLocale("kn",{months:"___________".split("_"),monthsShort:"___________".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(a){return a.replace(/[]/g,function(a){return lh[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return kh[a]})},meridiemParse:/|||/,meridiemHour:function(a,b){return 12===a&&(a=0),""===b?a<4?a:a+12:""===b?a:""===b?a>=10?a:a+12:""===b?a+12:void 0},meridiem:function(a,b,c){return a<4?"":a<10?"":a<17?"":a<20?"":""},dayOfMonthOrdinalParse:/\d{1,2}()/,ordinal:function(a){return a+""},week:{dow:0,doy:6}}),
//! moment.js locale configuration
//! locale : Korean [ko]
//! author : Kyungwook, Park : https://github.com/kyungw00k
//! author : Jeeeyul Lee <jeeeyul@gmail.com>
a.defineLocale("ko",{months:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD",LL:"YYYY MMMM D",LLL:"YYYY MMMM D A h:mm",LLLL:"YYYY MMMM D dddd A h:mm",l:"YYYY.MM.DD",ll:"YYYY MMMM D",lll:"YYYY MMMM D A h:mm",llll:"YYYY MMMM D dddd A h:mm"},calendar:{sameDay:" LT",nextDay:" LT",nextWeek:"dddd LT",lastDay:" LT",lastWeek:" dddd LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d",m:"1",mm:"%d",h:" ",hh:"%d",d:"",dd:"%d",M:" ",MM:"%d",y:" ",yy:"%d"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",meridiemParse:/|/,isPM:function(a){return""===a},meridiem:function(a,b,c){return a<12?"":""}});
//! moment.js locale configuration
//! locale : Kyrgyz [ky]
//! author : Chyngyz Arystan uulu : https://github.com/chyngyz
var mh={0:"-",1:"-",2:"-",3:"-",4:"-",5:"-",6:"-",7:"-",8:"-",9:"-",10:"-",20:"-",30:"-",40:"-",50:"-",60:"-",70:"-",80:"-",90:"-",100:"-"};a.defineLocale("ky",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"[ ] dddd [] [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|||)/,ordinal:function(a){var b=a%10,c=a>=100?100:null;return a+(mh[a]||mh[b]||mh[c])},week:{dow:1,doy:7}}),a.defineLocale("lb",{months:"Januar_Februar_Merz_Abrll_Mee_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Febr._Mrz._Abr._Mee_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonndeg_Mindeg_Dnschdeg_Mttwoch_Donneschdeg_Freideg_Samschdeg".split("_"),weekdaysShort:"So._M._D._M._Do._Fr._Sa.".split("_"),weekdaysMin:"So_M_D_M_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm [Auer]",LTS:"H:mm:ss [Auer]",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm [Auer]",LLLL:"dddd, D. MMMM YYYY H:mm [Auer]"},calendar:{sameDay:"[Haut um] LT",sameElse:"L",nextDay:"[Muer um] LT",nextWeek:"dddd [um] LT",lastDay:"[Gschter um] LT",lastWeek:function(){switch(this.day()){case 2:case 4:return"[Leschten] dddd [um] LT";default:return"[Leschte] dddd [um] LT"}}},relativeTime:{future:Pd,past:Qd,s:"e puer Sekonnen",m:Od,mm:"%d Minutten",h:Od,hh:"%d Stonnen",d:Od,dd:"%d Deeg",M:Od,MM:"%d Mint",y:Od,yy:"%d Joer"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : Lao [lo]
//! author : Ryan Hart : https://github.com/ryanhart2
a.defineLocale("lo",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(a){return""===a},meridiem:function(a,b,c){return a<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[]dddd[] LT",lastDay:"[] LT",lastWeek:"[]dddd[] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s",s:"",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "},dayOfMonthOrdinalParse:/()\d{1,2}/,ordinal:function(a){return""+a}});
//! moment.js locale configuration
//! locale : Lithuanian [lt]
//! author : Mindaugas Mozras : https://github.com/mmozuras
var nh={m:"minut_minuts_minut",mm:"minuts_minui_minutes",h:"valanda_valandos_valand",hh:"valandos_valand_valandas",d:"diena_dienos_dien",dd:"dienos_dien_dienas",M:"mnuo_mnesio_mnes",MM:"mnesiai_mnesi_mnesius",y:"metai_met_metus",yy:"metai_met_metus"};a.defineLocale("lt",{months:{format:"sausio_vasario_kovo_balandio_gegus_birelio_liepos_rugpjio_rugsjo_spalio_lapkriio_gruodio".split("_"),standalone:"sausis_vasaris_kovas_balandis_gegu_birelis_liepa_rugpjtis_rugsjis_spalis_lapkritis_gruodis".split("_"),isFormat:/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?|MMMM?(\[[^\[\]]*\]|\s)+D[oD]?/},monthsShort:"sau_vas_kov_bal_geg_bir_lie_rgp_rgs_spa_lap_grd".split("_"),weekdays:{format:"sekmadien_pirmadien_antradien_treiadien_ketvirtadien_penktadien_etadien".split("_"),standalone:"sekmadienis_pirmadienis_antradienis_treiadienis_ketvirtadienis_penktadienis_etadienis".split("_"),isFormat:/dddd HH:mm/},weekdaysShort:"Sek_Pir_Ant_Tre_Ket_Pen_e".split("_"),weekdaysMin:"S_P_A_T_K_Pn_".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY [m.] MMMM D [d.]",LLL:"YYYY [m.] MMMM D [d.], HH:mm [val.]",LLLL:"YYYY [m.] MMMM D [d.], dddd, HH:mm [val.]",l:"YYYY-MM-DD",ll:"YYYY [m.] MMMM D [d.]",lll:"YYYY [m.] MMMM D [d.], HH:mm [val.]",llll:"YYYY [m.] MMMM D [d.], ddd, HH:mm [val.]"},calendar:{sameDay:"[iandien] LT",nextDay:"[Rytoj] LT",nextWeek:"dddd LT",lastDay:"[Vakar] LT",lastWeek:"[Prajus] dddd LT",sameElse:"L"},relativeTime:{future:"po %s",past:"prie %s",s:Sd,m:Td,mm:Wd,h:Td,hh:Wd,d:Td,dd:Wd,M:Td,MM:Wd,y:Td,yy:Wd},dayOfMonthOrdinalParse:/\d{1,2}-oji/,ordinal:function(a){return a+"-oji"},week:{dow:1,doy:4}});
//! moment.js locale configuration
//! locale : Latvian [lv]
//! author : Kristaps Karlsons : https://github.com/skakri
//! author : Jnis Elmeris : https://github.com/JanisE
var oh={m:"mintes_mintm_minte_mintes".split("_"),mm:"mintes_mintm_minte_mintes".split("_"),h:"stundas_stundm_stunda_stundas".split("_"),hh:"stundas_stundm_stunda_stundas".split("_"),d:"dienas_dienm_diena_dienas".split("_"),dd:"dienas_dienm_diena_dienas".split("_"),M:"mnea_mneiem_mnesis_mnei".split("_"),MM:"mnea_mneiem_mnesis_mnei".split("_"),y:"gada_gadiem_gads_gadi".split("_"),yy:"gada_gadiem_gads_gadi".split("_")};a.defineLocale("lv",{months:"janvris_februris_marts_aprlis_maijs_jnijs_jlijs_augusts_septembris_oktobris_novembris_decembris".split("_"),monthsShort:"jan_feb_mar_apr_mai_jn_jl_aug_sep_okt_nov_dec".split("_"),weekdays:"svtdiena_pirmdiena_otrdiena_trediena_ceturtdiena_piektdiena_sestdiena".split("_"),weekdaysShort:"Sv_P_O_T_C_Pk_S".split("_"),weekdaysMin:"Sv_P_O_T_C_Pk_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY.",LL:"YYYY. [gada] D. MMMM",LLL:"YYYY. [gada] D. MMMM, HH:mm",LLLL:"YYYY. [gada] D. MMMM, dddd, HH:mm"},calendar:{sameDay:"[odien pulksten] LT",nextDay:"[Rt pulksten] LT",nextWeek:"dddd [pulksten] LT",lastDay:"[Vakar pulksten] LT",lastWeek:"[Pagju] dddd [pulksten] LT",sameElse:"L"},relativeTime:{future:"pc %s",past:"pirms %s",s:$d,m:Zd,mm:Yd,h:Zd,hh:Yd,d:Zd,dd:Yd,M:Zd,MM:Yd,y:Zd,yy:Yd},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});
//! moment.js locale configuration
//! locale : Montenegrin [me]
//! author : Miodrag Nika <miodrag@restartit.me> : https://github.com/miodragnikac
var ph={words:{m:["jedan minut","jednog minuta"],mm:["minut","minuta","minuta"],h:["jedan sat","jednog sata"],hh:["sat","sata","sati"],dd:["dan","dana","dana"],MM:["mjesec","mjeseca","mjeseci"],yy:["godina","godine","godina"]},correctGrammaticalCase:function(a,b){return 1===a?b[0]:a>=2&&a<=4?b[1]:b[2]},translate:function(a,b,c){var d=ph.words[c];return 1===c.length?b?d[0]:d[1]:a+" "+ph.correctGrammaticalCase(a,d)}};a.defineLocale("me",{months:"januar_februar_mart_april_maj_jun_jul_avgust_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj_jun_jul_avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sjutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jue u] LT",lastWeek:function(){var a=["[prole] [nedjelje] [u] LT","[prolog] [ponedjeljka] [u] LT","[prolog] [utorka] [u] LT","[prole] [srijede] [u] LT","[prolog] [etvrtka] [u] LT","[prolog] [petka] [u] LT","[prole] [subote] [u] LT"];return a[this.day()]},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"nekoliko sekundi",m:ph.translate,mm:ph.translate,h:ph.translate,hh:ph.translate,d:"dan",dd:ph.translate,M:"mjesec",MM:ph.translate,y:"godinu",yy:ph.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}}),
//! moment.js locale configuration
//! locale : Maori [mi]
//! author : John Corrigan <robbiecloset@gmail.com> : https://github.com/johnideal
a.defineLocale("mi",{months:"Kohi-tte_Hui-tanguru_Pout-te-rangi_Paenga-whwh_Haratua_Pipiri_Hngoingoi_Here-turi-kk_Mahuru_Whiringa--nuku_Whiringa--rangi_Hakihea".split("_"),monthsShort:"Kohi_Hui_Pou_Pae_Hara_Pipi_Hngoi_Here_Mahu_Whi-nu_Whi-ra_Haki".split("_"),monthsRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsStrictRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsShortRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsShortStrictRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,2}/i,weekdays:"Rtapu_Mane_Trei_Wenerei_Tite_Paraire_Htarei".split("_"),weekdaysShort:"Ta_Ma_T_We_Ti_Pa_H".split("_"),weekdaysMin:"Ta_Ma_T_We_Ti_Pa_H".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [i] HH:mm",LLLL:"dddd, D MMMM YYYY [i] HH:mm"},calendar:{sameDay:"[i teie mahana, i] LT",nextDay:"[apopo i] LT",nextWeek:"dddd [i] LT",lastDay:"[inanahi i] LT",lastWeek:"dddd [whakamutunga i] LT",sameElse:"L"},relativeTime:{future:"i roto i %s",past:"%s i mua",s:"te hkona ruarua",m:"he meneti",mm:"%d meneti",h:"te haora",hh:"%d haora",d:"he ra",dd:"%d ra",M:"he marama",MM:"%d marama",y:"he tau",yy:"%d tau"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : Macedonian [mk]
//! author : Borislav Mickov : https://github.com/B0k0
a.defineLocale("mk",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"e_o_____a".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"[] dddd [] LT",lastDay:"[ ] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[] dddd [] LT";case 1:case 2:case 4:case 5:return"[] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|||||)/,ordinal:function(a){var b=a%10,c=a%100;return 0===a?a+"-":0===c?a+"-":c>10&&c<20?a+"-":1===b?a+"-":2===b?a+"-":7===b||8===b?a+"-":a+"-"},week:{dow:1,doy:7}}),
//! moment.js locale configuration
//! locale : Malayalam [ml]
//! author : Floyd Pink : https://github.com/floydpink
a.defineLocale("ml",{months:"___________".split("_"),monthsShort:"._._._.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm -",LTS:"A h:mm:ss -",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm -",LLLL:"dddd, D MMMM YYYY, A h:mm -"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},meridiemParse:/|| ||/i,meridiemHour:function(a,b){return 12===a&&(a=0),""===b&&a>=4||" "===b||""===b?a+12:a},meridiem:function(a,b,c){return a<4?"":a<12?"":a<17?" ":a<20?"":""}});
//! moment.js locale configuration
//! locale : Marathi [mr]
//! author : Harshad Kale : https://github.com/kalehv
//! author : Vivek Athalye : https://github.com/vnathalye
var qh={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},rh={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};a.defineLocale("mr",{months:"___________".split("_"),monthsShort:"._._._._._._._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s",s:_d,m:_d,mm:_d,h:_d,hh:_d,d:_d,dd:_d,M:_d,MM:_d,y:_d,yy:_d},preparse:function(a){return a.replace(/[]/g,function(a){return rh[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return qh[a]})},meridiemParse:/|||/,meridiemHour:function(a,b){return 12===a&&(a=0),""===b?a<4?a:a+12:""===b?a:""===b?a>=10?a:a+12:""===b?a+12:void 0},meridiem:function(a,b,c){return a<4?"":a<10?"":a<17?"":a<20?"":""},week:{dow:0,doy:6}}),
//! moment.js locale configuration
//! locale : Malay [ms-my]
//! note : DEPRECATED, the correct one is [ms]
//! author : Weldan Jamili : https://github.com/weldan
a.defineLocale("ms-my",{months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|tengahari|petang|malam/,meridiemHour:function(a,b){return 12===a&&(a=0),"pagi"===b?a:"tengahari"===b?a>=11?a:a+12:"petang"===b||"malam"===b?a+12:void 0},meridiem:function(a,b,c){return a<11?"pagi":a<15?"tengahari":a<19?"petang":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Esok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kelmarin pukul] LT",lastWeek:"dddd [lepas pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}}),
//! moment.js locale configuration
//! locale : Malay [ms]
//! author : Weldan Jamili : https://github.com/weldan
a.defineLocale("ms",{months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|tengahari|petang|malam/,meridiemHour:function(a,b){return 12===a&&(a=0),"pagi"===b?a:"tengahari"===b?a>=11?a:a+12:"petang"===b||"malam"===b?a+12:void 0},meridiem:function(a,b,c){return a<11?"pagi":a<15?"tengahari":a<19?"petang":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Esok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kelmarin pukul] LT",lastWeek:"dddd [lepas pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}});
//! moment.js locale configuration
//! locale : Burmese [my]
//! author : Squar team, mysquar.com
//! author : David Rossellat : https://github.com/gholadr
//! author : Tin Aung Lin : https://github.com/thanyawzinmin
var sh={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},th={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};a.defineLocale("my",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[.] LT []",nextDay:"[] LT []",nextWeek:"dddd LT []",lastDay:"[.] LT []",lastWeek:"[] dddd LT []",sameElse:"L"},relativeTime:{future:" %s ",past:" %s ",s:".",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(a){return a.replace(/[]/g,function(a){return th[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return sh[a]})},week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : Norwegian Bokml [nb]
//! authors : Espen Hovlandsdal : https://github.com/rexxars
//!           Sigurd Gartmann : https://github.com/sigurdga
a.defineLocale("nb",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan._feb._mars_april_mai_juni_juli_aug._sep._okt._nov._des.".split("_"),monthsParseExact:!0,weekdays:"sndag_mandag_tirsdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"s._ma._ti._on._to._fr._l.".split("_"),weekdaysMin:"s_ma_ti_on_to_fr_l".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] HH:mm",LLLL:"dddd D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[i dag kl.] LT",nextDay:"[i morgen kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[i gr kl.] LT",lastWeek:"[forrige] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s siden",s:"noen sekunder",m:"ett minutt",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dager",M:"en mned",MM:"%d mneder",y:"ett r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});
//! moment.js locale configuration
//! locale : Nepalese [ne]
//! author : suvash : https://github.com/suvash
var uh={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},vh={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};a.defineLocale("ne",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"._._._._._._.".split("_"),weekdaysMin:"._._._._._._.".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},preparse:function(a){return a.replace(/[]/g,function(a){return vh[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return uh[a]})},meridiemParse:/|||/,meridiemHour:function(a,b){return 12===a&&(a=0),""===b?a<4?a:a+12:""===b?a:""===b?a>=10?a:a+12:""===b?a+12:void 0},meridiem:function(a,b,c){return a<3?"":a<12?"":a<16?"":a<20?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[] dddd[,] LT",lastDay:"[] LT",lastWeek:"[] dddd[,] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},week:{dow:0,doy:6}});
//! moment.js locale configuration
//! locale : Dutch (Belgium) [nl-be]
//! author : Joris Rling : https://github.com/jorisroling
//! author : Jacob Middag : https://github.com/middagj
var wh="jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),xh="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),yh=[/^jan/i,/^feb/i,/^maart|mrt.?$/i,/^apr/i,/^mei$/i,/^jun[i.]?$/i,/^jul[i.]?$/i,/^aug/i,/^sep/i,/^okt/i,/^nov/i,/^dec/i],zh=/^(januari|februari|maart|april|mei|april|ju[nl]i|augustus|september|oktober|november|december|jan\.?|feb\.?|mrt\.?|apr\.?|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i;a.defineLocale("nl-be",{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(a,b){return a?/-MMM-/.test(b)?xh[a.month()]:wh[a.month()]:wh},monthsRegex:zh,monthsShortRegex:zh,monthsStrictRegex:/^(januari|februari|maart|mei|ju[nl]i|april|augustus|september|oktober|november|december)/i,monthsShortStrictRegex:/^(jan\.?|feb\.?|mrt\.?|apr\.?|mei|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i,monthsParse:yh,longMonthsParse:yh,shortMonthsParse:yh,weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"Zo_Ma_Di_Wo_Do_Vr_Za".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[vandaag om] LT",nextDay:"[morgen om] LT",nextWeek:"dddd [om] LT",lastDay:"[gisteren om] LT",lastWeek:"[afgelopen] dddd [om] LT",sameElse:"L"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",m:"n minuut",mm:"%d minuten",h:"n uur",hh:"%d uur",d:"n dag",dd:"%d dagen",M:"n maand",MM:"%d maanden",y:"n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(a){return a+(1===a||8===a||a>=20?"ste":"de")},week:{dow:1,doy:4}});
//! moment.js locale configuration
//! locale : Dutch [nl]
//! author : Joris Rling : https://github.com/jorisroling
//! author : Jacob Middag : https://github.com/middagj
var Ah="jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),Bh="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),Ch=[/^jan/i,/^feb/i,/^maart|mrt.?$/i,/^apr/i,/^mei$/i,/^jun[i.]?$/i,/^jul[i.]?$/i,/^aug/i,/^sep/i,/^okt/i,/^nov/i,/^dec/i],Dh=/^(januari|februari|maart|april|mei|april|ju[nl]i|augustus|september|oktober|november|december|jan\.?|feb\.?|mrt\.?|apr\.?|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i;a.defineLocale("nl",{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(a,b){return a?/-MMM-/.test(b)?Bh[a.month()]:Ah[a.month()]:Ah},monthsRegex:Dh,monthsShortRegex:Dh,monthsStrictRegex:/^(januari|februari|maart|mei|ju[nl]i|april|augustus|september|oktober|november|december)/i,monthsShortStrictRegex:/^(jan\.?|feb\.?|mrt\.?|apr\.?|mei|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i,monthsParse:Ch,longMonthsParse:Ch,shortMonthsParse:Ch,weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"Zo_Ma_Di_Wo_Do_Vr_Za".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[vandaag om] LT",nextDay:"[morgen om] LT",nextWeek:"dddd [om] LT",lastDay:"[gisteren om] LT",lastWeek:"[afgelopen] dddd [om] LT",sameElse:"L"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",m:"n minuut",mm:"%d minuten",h:"n uur",hh:"%d uur",d:"n dag",dd:"%d dagen",M:"n maand",MM:"%d maanden",y:"n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(a){return a+(1===a||8===a||a>=20?"ste":"de")},week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : Nynorsk [nn]
//! author : https://github.com/mechuwind
a.defineLocale("nn",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sundag_mndag_tysdag_onsdag_torsdag_fredag_laurdag".split("_"),weekdaysShort:"sun_mn_tys_ons_tor_fre_lau".split("_"),weekdaysMin:"su_m_ty_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] H:mm",LLLL:"dddd D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[I dag klokka] LT",nextDay:"[I morgon klokka] LT",nextWeek:"dddd [klokka] LT",lastDay:"[I gr klokka] LT",lastWeek:"[Fregande] dddd [klokka] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s sidan",s:"nokre sekund",m:"eit minutt",mm:"%d minutt",h:"ein time",hh:"%d timar",d:"ein dag",dd:"%d dagar",M:"ein mnad",MM:"%d mnader",y:"eit r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});
//! moment.js locale configuration
//! locale : Punjabi (India) [pa-in]
//! author : Harpreet Singh : https://github.com/harpreetkhalsagtbit
var Eh={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},Fh={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};a.defineLocale("pa-in",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(a){return a.replace(/[]/g,function(a){return Fh[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return Eh[a]})},meridiemParse:/|||/,meridiemHour:function(a,b){return 12===a&&(a=0),""===b?a<4?a:a+12:""===b?a:""===b?a>=10?a:a+12:""===b?a+12:void 0},meridiem:function(a,b,c){return a<4?"":a<10?"":a<17?"":a<20?"":""},week:{dow:0,doy:6}});
//! moment.js locale configuration
//! locale : Polish [pl]
//! author : Rafal Hirsz : https://github.com/evoL
var Gh="stycze_luty_marzec_kwiecie_maj_czerwiec_lipiec_sierpie_wrzesie_padziernik_listopad_grudzie".split("_"),Hh="stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_wrzenia_padziernika_listopada_grudnia".split("_");a.defineLocale("pl",{months:function(a,b){return a?""===b?"("+Hh[a.month()]+"|"+Gh[a.month()]+")":/D MMMM/.test(b)?Hh[a.month()]:Gh[a.month()]:Gh},monthsShort:"sty_lut_mar_kwi_maj_cze_lip_sie_wrz_pa_lis_gru".split("_"),weekdays:"niedziela_poniedziaek_wtorek_roda_czwartek_pitek_sobota".split("_"),weekdaysShort:"ndz_pon_wt_r_czw_pt_sob".split("_"),weekdaysMin:"Nd_Pn_Wt_r_Cz_Pt_So".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Dzi o] LT",nextDay:"[Jutro o] LT",nextWeek:"[W] dddd [o] LT",lastDay:"[Wczoraj o] LT",lastWeek:function(){switch(this.day()){case 0:return"[W zesz niedziel o] LT";case 3:return"[W zesz rod o] LT";case 6:return"[W zesz sobot o] LT";default:return"[W zeszy] dddd [o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"%s temu",s:"kilka sekund",m:be,mm:be,h:be,hh:be,d:"1 dzie",dd:"%d dni",M:"miesic",MM:be,y:"rok",yy:be},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : Portuguese (Brazil) [pt-br]
//! author : Caio Ribeiro Pereira : https://github.com/caio-ribeiro-pereira
a.defineLocale("pt-br",{months:"Janeiro_Fevereiro_Maro_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingo_Segunda-feira_Tera-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sbado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sb".split("_"),weekdaysMin:"Do_2_3_4_5_6_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY [s] HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY [s] HH:mm"},calendar:{sameDay:"[Hoje s] LT",nextDay:"[Amanh s] LT",nextWeek:"dddd [s] LT",lastDay:"[Ontem s] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[ltimo] dddd [s] LT":"[ltima] dddd [s] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"%s atrs",s:"poucos segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um ms",MM:"%d meses",y:"um ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d"}),
//! moment.js locale configuration
//! locale : Portuguese [pt]
//! author : Jefferson : https://github.com/jalex79
a.defineLocale("pt",{months:"Janeiro_Fevereiro_Maro_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingo_Segunda-Feira_Tera-Feira_Quarta-Feira_Quinta-Feira_Sexta-Feira_Sbado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sb".split("_"),weekdaysMin:"Do_2_3_4_5_6_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY HH:mm"},calendar:{sameDay:"[Hoje s] LT",nextDay:"[Amanh s] LT",nextWeek:"dddd [s] LT",lastDay:"[Ontem s] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[ltimo] dddd [s] LT":"[ltima] dddd [s] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"h %s",s:"segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um ms",MM:"%d meses",y:"um ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}}),a.defineLocale("ro",{months:"ianuarie_februarie_martie_aprilie_mai_iunie_iulie_august_septembrie_octombrie_noiembrie_decembrie".split("_"),monthsShort:"ian._febr._mart._apr._mai_iun._iul._aug._sept._oct._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"duminic_luni_mari_miercuri_joi_vineri_smbt".split("_"),weekdaysShort:"Dum_Lun_Mar_Mie_Joi_Vin_Sm".split("_"),weekdaysMin:"Du_Lu_Ma_Mi_Jo_Vi_S".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[azi la] LT",nextDay:"[mine la] LT",nextWeek:"dddd [la] LT",lastDay:"[ieri la] LT",lastWeek:"[fosta] dddd [la] LT",sameElse:"L"},relativeTime:{future:"peste %s",past:"%s n urm",s:"cteva secunde",m:"un minut",mm:ce,h:"o or",hh:ce,d:"o zi",dd:ce,M:"o lun",MM:ce,y:"un an",yy:ce},week:{dow:1,doy:7}});var Ih=[/^/i,/^/i,/^/i,/^/i,/^[]/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i];a.defineLocale("ru",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:{format:"._._._.____._._._._.".split("_"),standalone:"._.__.____._._._._.".split("_")},weekdays:{standalone:"______".split("_"),format:"______".split("_"),isFormat:/\[ ?[] ?(?:||)? ?\] ?dddd/},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),monthsParse:Ih,longMonthsParse:Ih,shortMonthsParse:Ih,monthsRegex:/^([]|\.?|[]|?\.?|?|\.?|[]|\.?|[]|[]|\.?|[]|\.?|?|\.?|[]|?\.?|[]|\.?|[]|?\.?|[]|\.?)/i,monthsShortRegex:/^([]|\.?|[]|?\.?|?|\.?|[]|\.?|[]|[]|\.?|[]|\.?|?|\.?|[]|?\.?|[]|\.?|[]|?\.?|[]|\.?)/i,monthsStrictRegex:/^([]|[]|?|[]|[]|[]|[]|?|[]|[]|[]|[])/i,monthsShortStrictRegex:/^(\.|?\.|[.]|\.|[]|[.]|[.]|\.|?\.|\.|?\.|\.)/i,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",lastDay:"[ ] LT",nextWeek:function(a){if(a.week()===this.week())return 2===this.day()?"[] dddd [] LT":"[] dddd [] LT";switch(this.day()){case 0:return"[ ] dddd [] LT";case 1:case 2:case 4:return"[ ] dddd [] LT";case 3:case 5:case 6:return"[ ] dddd [] LT"}},lastWeek:function(a){if(a.week()===this.week())return 2===this.day()?"[] dddd [] LT":"[] dddd [] LT";switch(this.day()){case 0:return"[ ] dddd [] LT";case 1:case 2:case 4:return"[ ] dddd [] LT";case 3:case 5:case 6:return"[ ] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:ee,mm:ee,h:"",hh:ee,d:"",dd:ee,M:"",MM:ee,y:"",yy:ee},meridiemParse:/|||/i,isPM:function(a){return/^(|)$/.test(a)},meridiem:function(a,b,c){return a<4?"":a<12?"":a<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(||)/,ordinal:function(a,b){switch(b){case"M":case"d":case"DDD":return a+"-";case"D":return a+"-";case"w":case"W":return a+"-";default:return a}},week:{dow:1,doy:7}});
//! moment.js locale configuration
//! locale : Sindhi [sd]
//! author : Narain Sagar : https://github.com/narainsagar
var Jh=["","","","","","","","","","","",""],Kh=["","","","","","",""];a.defineLocale("sd",{months:Jh,monthsShort:Jh,weekdays:Kh,weekdaysShort:Kh,weekdaysMin:Kh,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(a){return""===a},meridiem:function(a,b,c){return a<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd [  ] LT",lastDay:"[] LT",lastWeek:"[ ] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(a){return a.replace(//g,",")},postformat:function(a){return a.replace(/,/g,"")},week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : Northern Sami [se]
//! authors : Brd Rolstad Henriksen : https://github.com/karamell
a.defineLocale("se",{months:"oajagemnnu_guovvamnnu_njukamnnu_cuoomnnu_miessemnnu_geassemnnu_suoidnemnnu_borgemnnu_akamnnu_golggotmnnu_skbmamnnu_juovlamnnu".split("_"),monthsShort:"oj_guov_njuk_cuo_mies_geas_suoi_borg_ak_golg_skb_juov".split("_"),weekdays:"sotnabeaivi_vuossrga_maebrga_gaskavahkku_duorastat_bearjadat_lvvardat".split("_"),weekdaysShort:"sotn_vuos_ma_gask_duor_bear_lv".split("_"),weekdaysMin:"s_v_m_g_d_b_L".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"MMMM D. [b.] YYYY",LLL:"MMMM D. [b.] YYYY [ti.] HH:mm",LLLL:"dddd, MMMM D. [b.] YYYY [ti.] HH:mm"},calendar:{sameDay:"[otne ti] LT",nextDay:"[ihttin ti] LT",nextWeek:"dddd [ti] LT",lastDay:"[ikte ti] LT",lastWeek:"[ovddit] dddd [ti] LT",sameElse:"L"},relativeTime:{future:"%s geaes",past:"mait %s",s:"moadde sekunddat",m:"okta minuhta",mm:"%d minuhtat",h:"okta diimmu",hh:"%d diimmut",d:"okta beaivi",dd:"%d beaivvit",M:"okta mnnu",MM:"%d mnut",y:"okta jahki",yy:"%d jagit"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : Sinhalese [si]
//! author : Sampath Sitinamaluwa : https://github.com/sampathsris
a.defineLocale("si",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"a h:mm",LTS:"a h:mm:ss",L:"YYYY/MM/DD",LL:"YYYY MMMM D",LLL:"YYYY MMMM D, a h:mm",LLLL:"YYYY MMMM D [] dddd, a h:mm:ss"},calendar:{sameDay:"[] LT[]",nextDay:"[] LT[]",nextWeek:"dddd LT[]",lastDay:"[] LT[]",lastWeek:"[] dddd LT[]",sameElse:"L"},relativeTime:{future:"%s",past:"%s ",s:" ",m:"",mm:" %d",h:"",hh:" %d",d:"",dd:" %d",M:"",MM:" %d",y:"",yy:" %d"},dayOfMonthOrdinalParse:/\d{1,2} /,ordinal:function(a){return a+" "},meridiemParse:/ | |.|../,isPM:function(a){return".."===a||" "===a},meridiem:function(a,b,c){return a>11?c?"..":" ":c?"..":" "}});
//! moment.js locale configuration
//! locale : Slovak [sk]
//! author : Martin Minka : https://github.com/k2s
//! based on work of petrbela : https://github.com/petrbela
var Lh="janur_februr_marec_aprl_mj_jn_jl_august_september_oktber_november_december".split("_"),Mh="jan_feb_mar_apr_mj_jn_jl_aug_sep_okt_nov_dec".split("_");a.defineLocale("sk",{months:Lh,monthsShort:Mh,weekdays:"nedea_pondelok_utorok_streda_tvrtok_piatok_sobota".split("_"),weekdaysShort:"ne_po_ut_st_t_pi_so".split("_"),weekdaysMin:"ne_po_ut_st_t_pi_so".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm"},calendar:{sameDay:"[dnes o] LT",nextDay:"[zajtra o] LT",nextWeek:function(){switch(this.day()){case 0:return"[v nedeu o] LT";case 1:case 2:return"[v] dddd [o] LT";case 3:return"[v stredu o] LT";case 4:return"[vo tvrtok o] LT";case 5:return"[v piatok o] LT";case 6:return"[v sobotu o] LT"}},lastDay:"[vera o] LT",lastWeek:function(){switch(this.day()){case 0:return"[minul nedeu o] LT";case 1:case 2:return"[minul] dddd [o] LT";case 3:return"[minul stredu o] LT";case 4:case 5:return"[minul] dddd [o] LT";case 6:return"[minul sobotu o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"pred %s",s:ge,m:ge,mm:ge,h:ge,hh:ge,d:ge,dd:ge,M:ge,MM:ge,y:ge,yy:ge},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),a.defineLocale("sl",{months:"januar_februar_marec_april_maj_junij_julij_avgust_september_oktober_november_december".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedelja_ponedeljek_torek_sreda_etrtek_petek_sobota".split("_"),weekdaysShort:"ned._pon._tor._sre._et._pet._sob.".split("_"),weekdaysMin:"ne_po_to_sr_e_pe_so".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danes ob] LT",nextDay:"[jutri ob] LT",nextWeek:function(){switch(this.day()){case 0:return"[v] [nedeljo] [ob] LT";case 3:return"[v] [sredo] [ob] LT";case 6:return"[v] [soboto] [ob] LT";case 1:case 2:case 4:case 5:return"[v] dddd [ob] LT"}},lastDay:"[veraj ob] LT",lastWeek:function(){switch(this.day()){case 0:return"[prejnjo] [nedeljo] [ob] LT";case 3:return"[prejnjo] [sredo] [ob] LT";case 6:return"[prejnjo] [soboto] [ob] LT";case 1:case 2:case 4:case 5:return"[prejnji] dddd [ob] LT"}},sameElse:"L"},relativeTime:{future:"ez %s",past:"pred %s",s:he,m:he,mm:he,h:he,hh:he,d:he,dd:he,M:he,MM:he,y:he,yy:he},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}}),
//! moment.js locale configuration
//! locale : Albanian [sq]
//! author : Flakrim Ismani : https://github.com/flakerimi
//! author : Menelion Elensle : https://github.com/Oire
//! author : Oerd Cukalla : https://github.com/oerd
a.defineLocale("sq",{months:"Janar_Shkurt_Mars_Prill_Maj_Qershor_Korrik_Gusht_Shtator_Tetor_Nntor_Dhjetor".split("_"),monthsShort:"Jan_Shk_Mar_Pri_Maj_Qer_Kor_Gus_Sht_Tet_Nn_Dhj".split("_"),weekdays:"E Diel_E Hn_E Mart_E Mrkur_E Enjte_E Premte_E Shtun".split("_"),weekdaysShort:"Die_Hn_Mar_Mr_Enj_Pre_Sht".split("_"),weekdaysMin:"D_H_Ma_M_E_P_Sh".split("_"),weekdaysParseExact:!0,meridiemParse:/PD|MD/,isPM:function(a){return"M"===a.charAt(0)},meridiem:function(a,b,c){return a<12?"PD":"MD"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Sot n] LT",nextDay:"[Nesr n] LT",nextWeek:"dddd [n] LT",lastDay:"[Dje n] LT",lastWeek:"dddd [e kaluar n] LT",sameElse:"L"},relativeTime:{future:"n %s",past:"%s m par",s:"disa sekonda",m:"nj minut",mm:"%d minuta",h:"nj or",hh:"%d or",d:"nj dit",dd:"%d dit",M:"nj muaj",MM:"%d muaj",y:"nj vit",yy:"%d vite"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});
//! moment.js locale configuration
//! locale : Serbian Cyrillic [sr-cyrl]
//! author : Milan Janakovi<milanjanackovic@gmail.com> : https://github.com/milan-j
var Nh={words:{m:[" "," "],mm:["","",""],h:[" "," "],hh:["","",""],dd:["","",""],MM:["","",""],yy:["","",""]},correctGrammaticalCase:function(a,b){return 1===a?b[0]:a>=2&&a<=4?b[1]:b[2]},translate:function(a,b,c){var d=Nh.words[c];return 1===c.length?b?d[0]:d[1]:a+" "+Nh.correctGrammaticalCase(a,d)}};a.defineLocale("sr-cyrl",{months:"___________".split("_"),monthsShort:"._._._.____._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"._._._._._._.".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:function(){switch(this.day()){case 0:return"[] [] [] LT";case 3:return"[] [] [] LT";case 6:return"[] [] [] LT";case 1:case 2:case 4:case 5:return"[] dddd [] LT"}},lastDay:"[ ] LT",lastWeek:function(){var a=["[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT"];return a[this.day()]},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",m:Nh.translate,mm:Nh.translate,h:Nh.translate,hh:Nh.translate,d:"",dd:Nh.translate,M:"",MM:Nh.translate,y:"",yy:Nh.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}});
//! moment.js locale configuration
//! locale : Serbian [sr]
//! author : Milan Janakovi<milanjanackovic@gmail.com> : https://github.com/milan-j
var Oh={words:{m:["jedan minut","jedne minute"],mm:["minut","minute","minuta"],h:["jedan sat","jednog sata"],hh:["sat","sata","sati"],dd:["dan","dana","dana"],MM:["mesec","meseca","meseci"],yy:["godina","godine","godina"]},correctGrammaticalCase:function(a,b){return 1===a?b[0]:a>=2&&a<=4?b[1]:b[2]},translate:function(a,b,c){var d=Oh.words[c];return 1===c.length?b?d[0]:d[1]:a+" "+Oh.correctGrammaticalCase(a,d)}};a.defineLocale("sr",{months:"januar_februar_mart_april_maj_jun_jul_avgust_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj_jun_jul_avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedelja_ponedeljak_utorak_sreda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sre._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedelju] [u] LT";case 3:return"[u] [sredu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jue u] LT",lastWeek:function(){var a=["[prole] [nedelje] [u] LT","[prolog] [ponedeljka] [u] LT","[prolog] [utorka] [u] LT","[prole] [srede] [u] LT","[prolog] [etvrtka] [u] LT","[prolog] [petka] [u] LT","[prole] [subote] [u] LT"];return a[this.day()]},sameElse:"L"},relativeTime:{future:"za %s",past:"pre %s",s:"nekoliko sekundi",m:Oh.translate,mm:Oh.translate,h:Oh.translate,hh:Oh.translate,d:"dan",dd:Oh.translate,M:"mesec",MM:Oh.translate,y:"godinu",yy:Oh.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}}),
//! moment.js locale configuration
//! locale : siSwati [ss]
//! author : Nicolai Davies<mail@nicolai.io> : https://github.com/nicolaidavies
a.defineLocale("ss",{months:"Bhimbidvwane_Indlovana_Indlov'lenkhulu_Mabasa_Inkhwekhweti_Inhlaba_Kholwane_Ingci_Inyoni_Imphala_Lweti_Ingongoni".split("_"),monthsShort:"Bhi_Ina_Inu_Mab_Ink_Inh_Kho_Igc_Iny_Imp_Lwe_Igo".split("_"),weekdays:"Lisontfo_Umsombuluko_Lesibili_Lesitsatfu_Lesine_Lesihlanu_Umgcibelo".split("_"),weekdaysShort:"Lis_Umb_Lsb_Les_Lsi_Lsh_Umg".split("_"),weekdaysMin:"Li_Us_Lb_Lt_Ls_Lh_Ug".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Namuhla nga] LT",nextDay:"[Kusasa nga] LT",nextWeek:"dddd [nga] LT",lastDay:"[Itolo nga] LT",lastWeek:"dddd [leliphelile] [nga] LT",sameElse:"L"},relativeTime:{future:"nga %s",past:"wenteka nga %s",s:"emizuzwana lomcane",m:"umzuzu",mm:"%d emizuzu",h:"lihora",hh:"%d emahora",d:"lilanga",dd:"%d emalanga",M:"inyanga",MM:"%d tinyanga",y:"umnyaka",yy:"%d iminyaka"},meridiemParse:/ekuseni|emini|entsambama|ebusuku/,meridiem:function(a,b,c){return a<11?"ekuseni":a<15?"emini":a<19?"entsambama":"ebusuku"},meridiemHour:function(a,b){return 12===a&&(a=0),"ekuseni"===b?a:"emini"===b?a>=11?a:a+12:"entsambama"===b||"ebusuku"===b?0===a?0:a+12:void 0},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : Swedish [sv]
//! author : Jens Alm : https://github.com/ulmus
a.defineLocale("sv",{months:"januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"sndag_mndag_tisdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"sn_mn_tis_ons_tor_fre_lr".split("_"),weekdaysMin:"s_m_ti_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [kl.] HH:mm",LLLL:"dddd D MMMM YYYY [kl.] HH:mm",lll:"D MMM YYYY HH:mm",llll:"ddd D MMM YYYY HH:mm"},calendar:{sameDay:"[Idag] LT",nextDay:"[Imorgon] LT",lastDay:"[Igr] LT",nextWeek:"[P] dddd LT",lastWeek:"[I] dddd[s] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"fr %s sedan",s:"ngra sekunder",m:"en minut",mm:"%d minuter",h:"en timme",hh:"%d timmar",d:"en dag",dd:"%d dagar",M:"en mnad",MM:"%d mnader",y:"ett r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}(e|a)/,ordinal:function(a){var b=a%10,c=1===~~(a%100/10)?"e":1===b?"a":2===b?"a":"e";return a+c},week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : Swahili [sw]
//! author : Fahad Kassim : https://github.com/fadsel
a.defineLocale("sw",{months:"Januari_Februari_Machi_Aprili_Mei_Juni_Julai_Agosti_Septemba_Oktoba_Novemba_Desemba".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ago_Sep_Okt_Nov_Des".split("_"),weekdays:"Jumapili_Jumatatu_Jumanne_Jumatano_Alhamisi_Ijumaa_Jumamosi".split("_"),weekdaysShort:"Jpl_Jtat_Jnne_Jtan_Alh_Ijm_Jmos".split("_"),weekdaysMin:"J2_J3_J4_J5_Al_Ij_J1".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[leo saa] LT",nextDay:"[kesho saa] LT",nextWeek:"[wiki ijayo] dddd [saat] LT",lastDay:"[jana] LT",lastWeek:"[wiki iliyopita] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s baadaye",past:"tokea %s",s:"hivi punde",m:"dakika moja",mm:"dakika %d",h:"saa limoja",hh:"masaa %d",d:"siku moja",dd:"masiku %d",M:"mwezi mmoja",MM:"miezi %d",y:"mwaka mmoja",yy:"miaka %d"},week:{dow:1,doy:7}});
//! moment.js locale configuration
//! locale : Tamil [ta]
//! author : Arjunkumar Krishnamoorthy : https://github.com/tk120404
var Ph={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},Qh={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};a.defineLocale("ta",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, HH:mm",LLLL:"dddd, D MMMM YYYY, HH:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[ ] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",m:" ",mm:"%d ",h:"  ",hh:"%d  ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(a){return a+""},preparse:function(a){return a.replace(/[]/g,function(a){return Qh[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return Ph[a]})},meridiemParse:/|||||/,meridiem:function(a,b,c){return a<2?" ":a<6?" ":a<10?" ":a<14?" ":a<18?" ":a<22?" ":" "},meridiemHour:function(a,b){return 12===a&&(a=0),""===b?a<2?a:a+12:""===b||""===b?a:""===b&&a>=10?a:a+12},week:{dow:0,doy:6}}),
//! moment.js locale configuration
//! locale : Telugu [te]
//! author : Krishna Chaitanya Thota : https://github.com/kcthota
a.defineLocale("te",{months:"___________".split("_"),monthsShort:"._.__.____._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",meridiemParse:/|||/,meridiemHour:function(a,b){return 12===a&&(a=0),""===b?a<4?a:a+12:""===b?a:""===b?a>=10?a:a+12:""===b?a+12:void 0},meridiem:function(a,b,c){return a<4?"":a<10?"":a<17?"":a<20?"":""},week:{dow:0,doy:6}}),
//! moment.js locale configuration
//! locale : Tetun Dili (East Timor) [tet]
//! author : Joshua Brooks : https://github.com/joshbrooks
//! author : Onorio De J. Afonso : https://github.com/marobo
a.defineLocale("tet",{months:"Janeiru_Fevereiru_Marsu_Abril_Maiu_Juniu_Juliu_Augustu_Setembru_Outubru_Novembru_Dezembru".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Aug_Set_Out_Nov_Dez".split("_"),weekdays:"Domingu_Segunda_Tersa_Kuarta_Kinta_Sexta_Sabadu".split("_"),weekdaysShort:"Dom_Seg_Ters_Kua_Kint_Sext_Sab".split("_"),weekdaysMin:"Do_Seg_Te_Ku_Ki_Sex_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Ohin iha] LT",nextDay:"[Aban iha] LT",nextWeek:"dddd [iha] LT",lastDay:"[Horiseik iha] LT",lastWeek:"dddd [semana kotuk] [iha] LT",sameElse:"L"},relativeTime:{future:"iha %s",past:"%s liuba",s:"minutu balun",m:"minutu ida",mm:"minutus %d",h:"horas ida",hh:"horas %d",d:"loron ida",dd:"loron %d",M:"fulan ida",MM:"fulan %d",y:"tinan ida",yy:"tinan %d"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(a){var b=a%10,c=1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c},week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : Thai [th]
//! author : Kridsada Thanabulpong : https://github.com/sirn
a.defineLocale("th",{months:"___________".split("_"),monthsShort:".._.._.._.._.._.._.._.._.._.._.._..".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"._._._._._._.".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY  H:mm",LLLL:"dddd D MMMM YYYY  H:mm"},meridiemParse:/|/,isPM:function(a){return""===a},meridiem:function(a,b,c){return a<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd[ ] LT",lastDay:"[ ] LT",lastWeek:"[]dddd[ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s",s:"",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}}),
//! moment.js locale configuration
//! locale : Tagalog (Philippines) [tl-ph]
//! author : Dan Hagman : https://github.com/hagmandan
a.defineLocale("tl-ph",{months:"Enero_Pebrero_Marso_Abril_Mayo_Hunyo_Hulyo_Agosto_Setyembre_Oktubre_Nobyembre_Disyembre".split("_"),monthsShort:"Ene_Peb_Mar_Abr_May_Hun_Hul_Ago_Set_Okt_Nob_Dis".split("_"),weekdays:"Linggo_Lunes_Martes_Miyerkules_Huwebes_Biyernes_Sabado".split("_"),weekdaysShort:"Lin_Lun_Mar_Miy_Huw_Biy_Sab".split("_"),weekdaysMin:"Li_Lu_Ma_Mi_Hu_Bi_Sab".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"MM/D/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY HH:mm",LLLL:"dddd, MMMM DD, YYYY HH:mm"},calendar:{sameDay:"LT [ngayong araw]",nextDay:"[Bukas ng] LT",nextWeek:"LT [sa susunod na] dddd",lastDay:"LT [kahapon]",lastWeek:"LT [noong nakaraang] dddd",sameElse:"L"},relativeTime:{future:"sa loob ng %s",past:"%s ang nakalipas",s:"ilang segundo",m:"isang minuto",mm:"%d minuto",h:"isang oras",hh:"%d oras",d:"isang araw",dd:"%d araw",M:"isang buwan",MM:"%d buwan",y:"isang taon",yy:"%d taon"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(a){return a},week:{dow:1,doy:4}});
//! moment.js locale configuration
//! locale : Klingon [tlh]
//! author : Dominika Kruk : https://github.com/amaranthrose
var Rh="pagh_wa_cha_wej_loS_vagh_jav_Soch_chorgh_Hut".split("_");a.defineLocale("tlh",{months:"tera jar wa_tera jar cha_tera jar wej_tera jar loS_tera jar vagh_tera jar jav_tera jar Soch_tera jar chorgh_tera jar Hut_tera jar wamaH_tera jar wamaH wa_tera jar wamaH cha".split("_"),monthsShort:"jar wa_jar cha_jar wej_jar loS_jar vagh_jar jav_jar Soch_jar chorgh_jar Hut_jar wamaH_jar wamaH wa_jar wamaH cha".split("_"),monthsParseExact:!0,weekdays:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),weekdaysShort:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),weekdaysMin:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[DaHjaj] LT",nextDay:"[waleS] LT",nextWeek:"LLL",lastDay:"[waHu] LT",lastWeek:"LLL",sameElse:"L"},relativeTime:{future:ie,past:je,s:"puS lup",m:"wa tup",mm:ke,h:"wa rep",hh:ke,d:"wa jaj",dd:ke,M:"wa jar",MM:ke,y:"wa DIS",yy:ke},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});
//! moment.js locale configuration
//! locale : Turkish [tr]
//! authors : Erhan Gundogan : https://github.com/erhangundogan,
//!           Burak Yiit Kaya: https://github.com/BYK
var Sh={1:"'inci",5:"'inci",8:"'inci",70:"'inci",80:"'inci",2:"'nci",7:"'nci",20:"'nci",50:"'nci",3:"'nc",4:"'nc",100:"'nc",6:"'nc",9:"'uncu",10:"'uncu",30:"'uncu",60:"'nc",90:"'nc"};a.defineLocale("tr",{months:"Ocak_ubat_Mart_Nisan_Mays_Haziran_Temmuz_Austos_Eyll_Ekim_Kasm_Aralk".split("_"),monthsShort:"Oca_ub_Mar_Nis_May_Haz_Tem_Au_Eyl_Eki_Kas_Ara".split("_"),weekdays:"Pazar_Pazartesi_Sal_aramba_Perembe_Cuma_Cumartesi".split("_"),weekdaysShort:"Paz_Pts_Sal_ar_Per_Cum_Cts".split("_"),weekdaysMin:"Pz_Pt_Sa_a_Pe_Cu_Ct".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[bugn saat] LT",nextDay:"[yarn saat] LT",nextWeek:"[haftaya] dddd [saat] LT",lastDay:"[dn] LT",lastWeek:"[geen hafta] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s sonra",past:"%s nce",s:"birka saniye",m:"bir dakika",mm:"%d dakika",h:"bir saat",hh:"%d saat",d:"bir gn",dd:"%d gn",M:"bir ay",MM:"%d ay",y:"bir yl",yy:"%d yl"},dayOfMonthOrdinalParse:/\d{1,2}'(inci|nci|nc|nc|uncu|nc)/,ordinal:function(a){if(0===a)return a+"'nc";var b=a%10,c=a%100-b,d=a>=100?100:null;return a+(Sh[b]||Sh[c]||Sh[d])},week:{dow:1,doy:7}}),
//! moment.js locale configuration
//! locale : Talossan [tzl]
//! author : Robin van der Vliet : https://github.com/robin0van0der0v
//! author : Iust Canun
a.defineLocale("tzl",{months:"Januar_Fevraglh_Mar_Avru_Mai_Gn_Julia_Guscht_Setemvar_Listopts_Noemvar_Zecemvar".split("_"),monthsShort:"Jan_Fev_Mar_Avr_Mai_Gn_Jul_Gus_Set_Lis_Noe_Zec".split("_"),weekdays:"Sladi_Lnei_Maitzi_Mrcuri_Xhadi_Vineri_Sturi".split("_"),weekdaysShort:"Sl_Ln_Mai_Mr_Xh_Vi_St".split("_"),weekdaysMin:"S_L_Ma_M_Xh_Vi_S".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"D. MMMM [dallas] YYYY",LLL:"D. MMMM [dallas] YYYY HH.mm",LLLL:"dddd, [li] D. MMMM [dallas] YYYY HH.mm"},meridiemParse:/d\'o|d\'a/i,isPM:function(a){return"d'o"===a.toLowerCase()},meridiem:function(a,b,c){return a>11?c?"d'o":"D'O":c?"d'a":"D'A"},calendar:{sameDay:"[oxhi ] LT",nextDay:"[dem ] LT",nextWeek:"dddd [] LT",lastDay:"[ieiri ] LT",lastWeek:"[sr el] dddd [lasteu ] LT",sameElse:"L"},relativeTime:{future:"osprei %s",past:"ja%s",s:me,m:me,mm:me,h:me,hh:me,d:me,dd:me,M:me,MM:me,y:me,yy:me},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),
//! moment.js locale configuration
//! locale : Central Atlas Tamazight Latin [tzm-latn]
//! author : Abdel Said : https://github.com/abdelsaid
a.defineLocale("tzm-latn",{months:"innayr_brayr_mars_ibrir_mayyw_ywnyw_ywlywz_wt_wtanbir_ktwbr_nwwanbir_dwjnbir".split("_"),monthsShort:"innayr_brayr_mars_ibrir_mayyw_ywnyw_ywlywz_wt_wtanbir_ktwbr_nwwanbir_dwjnbir".split("_"),weekdays:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),weekdaysShort:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),weekdaysMin:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[asdkh g] LT",nextDay:"[aska g] LT",nextWeek:"dddd [g] LT",lastDay:"[assant g] LT",lastWeek:"dddd [g] LT",sameElse:"L"},relativeTime:{future:"dadkh s yan %s",past:"yan %s",s:"imik",m:"minu",mm:"%d minu",h:"saa",hh:"%d tassain",d:"ass",dd:"%d ossan",M:"ayowr",MM:"%d iyyirn",y:"asgas",yy:"%d isgasn"},week:{dow:6,doy:12}}),
//! moment.js locale configuration
//! locale : Central Atlas Tamazight [tzm]
//! author : Abdel Said : https://github.com/abdelsaid
a.defineLocale("tzm",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] LT",sameElse:"L"},relativeTime:{future:"   %s",past:" %s",s:"",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d o",M:"o",MM:"%d ",y:"",yy:"%d "},week:{dow:6,doy:12}}),a.defineLocale("uk",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:pe,weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:qe("[ "),nextDay:qe("[ "),lastDay:qe("[ "),nextWeek:qe("[] dddd ["),lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return qe("[] dddd [").call(this);case 1:case 2:case 4:return qe("[] dddd [").call(this)}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:oe,mm:oe,h:"",hh:oe,d:"",dd:oe,M:"",MM:oe,y:"",yy:oe},meridiemParse:/|||/,isPM:function(a){return/^(|)$/.test(a)},meridiem:function(a,b,c){return a<4?"":a<12?"":a<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(|)/,ordinal:function(a,b){switch(b){case"M":case"d":case"DDD":case"w":case"W":return a+"-";case"D":return a+"-";default:return a}},week:{dow:1,doy:7}});
//! moment.js locale configuration
//! locale : Urdu [ur]
//! author : Sawood Alam : https://github.com/ibnesayeed
//! author : Zack : https://github.com/ZackVision
var Th=["","","","","","","","","","","",""],Uh=["","","","","","",""];
//! moment.js locale configuration
//! locale : Uzbek Latin [uz-latn]
//! author : Rasulbek Mirzayev : github.com/Rasulbeeek
//! moment.js locale configuration
//! locale : Uzbek [uz]
//! author : Sardor Muminov : https://github.com/muminoff
//! moment.js locale configuration
//! locale : Vietnamese [vi]
//! author : Bang Nguyen : https://github.com/bangnk
//! moment.js locale configuration
//! locale : Pseudo [x-pseudo]
//! author : Andrew Hood : https://github.com/andrewhood125
//! moment.js locale configuration
//! locale : Yoruba Nigeria [yo]
//! author : Atolagbe Abisoye : https://github.com/andela-batolagbe
//! moment.js locale configuration
//! locale : Chinese (China) [zh-cn]
//! author : suupic : https://github.com/suupic
//! author : Zeno Zeng : https://github.com/zenozeng
//! moment.js locale configuration
//! locale : Chinese (Hong Kong) [zh-hk]
//! author : Ben : https://github.com/ben-lin
//! author : Chris Lam : https://github.com/hehachris
//! author : Konstantin : https://github.com/skfd
//! moment.js locale configuration
//! locale : Chinese (Taiwan) [zh-tw]
//! author : Ben : https://github.com/ben-lin
//! author : Chris Lam : https://github.com/hehachris
return a.defineLocale("ur",{months:Th,monthsShort:Th,weekdays:Uh,weekdaysShort:Uh,weekdaysMin:Uh,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(a){return""===a},meridiem:function(a,b,c){return a<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[  ] LT",lastWeek:"[] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(a){return a.replace(//g,",")},postformat:function(a){return a.replace(/,/g,"")},week:{dow:1,doy:4}}),a.defineLocale("uz-latn",{months:"Yanvar_Fevral_Mart_Aprel_May_Iyun_Iyul_Avgust_Sentabr_Oktabr_Noyabr_Dekabr".split("_"),monthsShort:"Yan_Fev_Mar_Apr_May_Iyun_Iyul_Avg_Sen_Okt_Noy_Dek".split("_"),weekdays:"Yakshanba_Dushanba_Seshanba_Chorshanba_Payshanba_Juma_Shanba".split("_"),weekdaysShort:"Yak_Dush_Sesh_Chor_Pay_Jum_Shan".split("_"),weekdaysMin:"Ya_Du_Se_Cho_Pa_Ju_Sha".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"D MMMM YYYY, dddd HH:mm"},calendar:{sameDay:"[Bugun soat] LT [da]",nextDay:"[Ertaga] LT [da]",nextWeek:"dddd [kuni soat] LT [da]",lastDay:"[Kecha soat] LT [da]",lastWeek:"[O'tgan] dddd [kuni soat] LT [da]",sameElse:"L"},relativeTime:{future:"Yaqin %s ichida",past:"Bir necha %s oldin",s:"soniya",m:"bir daqiqa",mm:"%d daqiqa",h:"bir soat",hh:"%d soat",d:"bir kun",dd:"%d kun",M:"bir oy",MM:"%d oy",y:"bir yil",yy:"%d yil"},week:{dow:1,doy:7}}),a.defineLocale("uz",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"D MMMM YYYY, dddd HH:mm"},calendar:{sameDay:"[ ] LT []",nextDay:"[] LT []",nextWeek:"dddd [ ] LT []",lastDay:"[ ] LT []",lastWeek:"[] dddd [ ] LT []",sameElse:"L"},relativeTime:{future:" %s ",past:"  %s ",s:"",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},week:{dow:1,doy:7}}),a.defineLocale("vi",{months:"thng 1_thng 2_thng 3_thng 4_thng 5_thng 6_thng 7_thng 8_thng 9_thng 10_thng 11_thng 12".split("_"),monthsShort:"Th01_Th02_Th03_Th04_Th05_Th06_Th07_Th08_Th09_Th10_Th11_Th12".split("_"),monthsParseExact:!0,weekdays:"ch nht_th hai_th ba_th t_th nm_th su_th by".split("_"),weekdaysShort:"CN_T2_T3_T4_T5_T6_T7".split("_"),weekdaysMin:"CN_T2_T3_T4_T5_T6_T7".split("_"),weekdaysParseExact:!0,meridiemParse:/sa|ch/i,isPM:function(a){return/^ch$/i.test(a)},meridiem:function(a,b,c){return a<12?c?"sa":"SA":c?"ch":"CH"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [nm] YYYY",LLL:"D MMMM [nm] YYYY HH:mm",LLLL:"dddd, D MMMM [nm] YYYY HH:mm",l:"DD/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},calendar:{sameDay:"[Hm nay lc] LT",nextDay:"[Ngy mai lc] LT",nextWeek:"dddd [tun ti lc] LT",lastDay:"[Hm qua lc] LT",lastWeek:"dddd [tun ri lc] LT",sameElse:"L"},relativeTime:{future:"%s ti",past:"%s trc",s:"vi giy",m:"mt pht",mm:"%d pht",h:"mt gi",hh:"%d gi",d:"mt ngy",dd:"%d ngy",M:"mt thng",MM:"%d thng",y:"mt nm",yy:"%d nm"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(a){return a},week:{dow:1,doy:4}}),a.defineLocale("x-pseudo",{months:"J~~r_F~br~r_~Mrc~h_p~rl_~M_~J~_Jl~_~gst~_Sp~tmb~r_~ctb~r_~vm~br_~Dc~mbr".split("_"),monthsShort:"J~_~Fb_~Mr_~pr_~M_~J_~Jl_~g_~Sp_~ct_~v_~Dc".split("_"),monthsParseExact:!0,weekdays:"S~d~_M~d~_T~sd~_Wd~sd~_T~hrs~d_~Frd~_S~tr~d".split("_"),weekdaysShort:"S~_~M_~T_~Wd_~Th_~Fr_~St".split("_"),weekdaysMin:"S~_M~_T_~W_T~h_Fr~_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[T~d~ t] LT",nextDay:"[T~m~rr~w t] LT",nextWeek:"dddd [t] LT",lastDay:"[~st~rd~ t] LT",lastWeek:"[L~st] dddd [t] LT",sameElse:"L"},relativeTime:{future:"~ %s",past:"%s ~g",s:" ~fw ~sc~ds",m:" ~m~t",mm:"%d m~~ts",h:"~ h~r",hh:"%d h~rs",d:" ~d",dd:"%d d~s",M:" ~m~th",MM:"%d m~t~hs",y:" ~r",yy:"%d ~rs"},dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(a){var b=a%10,c=1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c},week:{dow:1,doy:4}}),a.defineLocale("yo",{months:"Sr_Erele_rna_Igbe_Ebibi_Okudu_Agmo_Ogun_Owewe_wara_Belu_p".split("_"),monthsShort:"Sr_Erl_rn_Igb_Ebi_Oku_Ag_Ogu_Owe_wa_Bel_p".split("_"),weekdays:"Aiku_Aje_Isgun_jru_jb_ti_Abamta".split("_"),weekdaysShort:"Aik_Aje_Is_jr_jb_ti_Aba".split("_"),weekdaysMin:"Ai_Aj_Is_r_b_t_Ab".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Oni ni] LT",nextDay:"[la ni] LT",nextWeek:"dddd [s ton'b] [ni] LT",lastDay:"[Ana ni] LT",lastWeek:"dddd [s tol] [ni] LT",sameElse:"L"},relativeTime:{future:"ni %s",past:"%s kja",s:"isju aaya die",m:"isju kan",mm:"isju %d",h:"wakati kan",hh:"wakati %d",d:"j kan",dd:"j %d",M:"osu kan",MM:"osu %d",y:"dun kan",yy:"dun %d"},dayOfMonthOrdinalParse:/j\s\d{1,2}/,ordinal:"j %d",week:{dow:1,doy:4}}),a.defineLocale("zh-cn",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYYMMMD",LL:"YYYYMMMD",LLL:"YYYYMMMDAhmm",LLLL:"YYYYMMMDddddAhmm",l:"YYYYMMMD",ll:"YYYYMMMD",lll:"YYYYMMMD HH:mm",llll:"YYYYMMMDdddd HH:mm"},meridiemParse:/|||||/,meridiemHour:function(a,b){return 12===a&&(a=0),""===b||""===b||""===b?a:""===b||""===b?a+12:a>=11?a:a+12},meridiem:function(a,b,c){var d=100*a+b;return d<600?"":d<900?"":d<1130?"":d<1230?"":d<1800?"":""},calendar:{sameDay:"[]LT",nextDay:"[]LT",nextWeek:"[]ddddLT",lastDay:"[]LT",lastWeek:"[]ddddLT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(a,b){switch(b){case"d":case"D":case"DDD":return a+"";case"M":return a+"";case"w":case"W":return a+"";default:return a}},relativeTime:{future:"%s",past:"%s",s:"",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "},week:{dow:1,doy:4}}),a.defineLocale("zh-hk",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYYMMMD",LL:"YYYYMMMD",LLL:"YYYYMMMD HH:mm",LLLL:"YYYYMMMDdddd HH:mm",l:"YYYYMMMD",ll:"YYYYMMMD",lll:"YYYYMMMD HH:mm",llll:"YYYYMMMDdddd HH:mm"},meridiemParse:/|||||/,meridiemHour:function(a,b){return 12===a&&(a=0),""===b||""===b||""===b?a:""===b?a>=11?a:a+12:""===b||""===b?a+12:void 0},meridiem:function(a,b,c){var d=100*a+b;return d<600?"":d<900?"":d<1130?"":d<1230?"":d<1800?"":""},calendar:{sameDay:"[]LT",nextDay:"[]LT",nextWeek:"[]ddddLT",lastDay:"[]LT",lastWeek:"[]ddddLT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(a,b){switch(b){case"d":case"D":case"DDD":return a+"";case"M":return a+"";case"w":case"W":return a+"";default:return a}},relativeTime:{future:"%s",past:"%s",s:"",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}}),a.defineLocale("zh-tw",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYYMMMD",LL:"YYYYMMMD",LLL:"YYYYMMMD HH:mm",LLLL:"YYYYMMMDdddd HH:mm",l:"YYYYMMMD",ll:"YYYYMMMD",lll:"YYYYMMMD HH:mm",llll:"YYYYMMMDdddd HH:mm"},meridiemParse:/|||||/,meridiemHour:function(a,b){return 12===a&&(a=0),""===b||""===b||""===b?a:""===b?a>=11?a:a+12:""===b||""===b?a+12:void 0},meridiem:function(a,b,c){var d=100*a+b;return d<600?"":d<900?"":d<1130?"":d<1230?"":d<1800?"":""},calendar:{sameDay:"[]LT",nextDay:"[]LT",nextWeek:"[]ddddLT",lastDay:"[]LT",lastWeek:"[]ddddLT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(a,b){switch(b){case"d":case"D":case"DDD":return a+"";case"M":return a+"";case"w":case"W":return a+"";default:return a}},relativeTime:{future:"%s",past:"%s",s:"",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}}),a.locale("en"),a});
define('m_moment',['moment'], function (MOMENT) {
	MOMENT.locale(getLocale());

	function getLocale () {
		/*
			@discr
				know user language
			@input
				@required
				@optional
			@deps
			@return void
		*/
		var userLang = navigator.language || navigator.userLanguage; 
		return userLang;
	}
	MOMENT.prototype['getLocale'] = getLocale;

	function offsetDayBetweenTwoDays (iNtime1,iNtime2) {
    	return getDayNumberByTime(iNtime1) - getDayNumberByTime(iNtime2)
    }
	MOMENT.prototype['offsetDayBetweenTwoDays'] = offsetDayBetweenTwoDays;

    function isThisDay (iNtime) {
    	if ( typeof iNtime != 'number' ) iNtime = 0;
		var nowDayCode 		= getDayNumberByTime( getNowTime() );
		var thisDayCode 	= getDayNumberByTime(iNtime);
		if( nowDayCode == thisDayCode ) return true;
		return false;
	}
	MOMENT.prototype['isThisDay'] = isThisDay;



	function isThisWeek (iNtime) {
		var nowTime 		= getNowTime();
		var dayNumber 		= getDayNumberByTime (nowTime);
		var weekDay 		= getWeekDay (nowTime);

		var startDay 		= dayNumber - (weekDay-1);
		var endDay 			= dayNumber + (7-weekDay);
		thisDayNumber 		= getDayNumberByTime(iNtime);

		if( thisDayNumber >= startDay && thisDayNumber <= endDay) return true;

		return false;
	}
	MOMENT.prototype['isThisWeek'] = isThisWeek;

		function getWeekDay (iNtime) {
    		return MOMENT(iNtime).day();
		}
		MOMENT.prototype['getWeekDay'] = getWeekDay;

    function getLightTime (iNtime) {
    	if ( typeof iNtime != 'number' ) iNtime = 0;
    	if( isThisDay(iNtime) ) {
    		// if today 
    		return getTimeMiniText(iNtime);
    	} else if (isThisWeek(iNtime)){
    		// if this week
    		return getWeekDayText();
    	}else {
    		//if other
    		return getFullText(iNtime);
		}
	}
	MOMENT.prototype['getLightTime'] = getLightTime;

		function getDayNumberByTime (iNtime) {
    		var thisTime = new Date(iNtime);
			 return Math.floor(thisTime.getTime() / (1000*60*60*24));
		}
		MOMENT.prototype['getDayNumberByTime'] = getDayNumberByTime;

	    function getTimeMiniText (iNtime) {
	    	return MOMENT(iNtime).format('HH:mm');
		}
		MOMENT.prototype['getTimeMiniText'] = getTimeMiniText;

		function getFullText (iNtime) {
	    	return  MOMENT(iNtime).format('DD/MM/YYYY');
		}
		MOMENT.prototype['getFullText'] = getFullText;

		function getWeekDayText (iNtime) {
			return MOMENT(iNtime).format('dddd'); 
		}
		MOMENT.prototype['getWeekDayText'] = getWeekDayText;

	function getNowTime () {
		return MOMENT.now();
	}
	MOMENT.prototype['getNowTime'] = getNowTime;
	window.moment = MOMENT;
	return MOMENT;	
});
/*
 * jQuery appear plugin
 *
 * Copyright (c) 2012 Andrey Sidorov
 * licensed under MIT license.
 *
 * https://github.com/morr/jquery.appear/
 *
 * Version: 0.3.6
 */
(function($) {
  var selectors = [];
  var prefixForId = 'connectPluginAppearJs';
  var check_binded = false;
  var check_lock = false;
  var defaults = {
    interval: 250,
    force_process: false
  };
  var $window = $('body');

  var $prior_appeared = [];

  function appeared(selector) {
    return $(selector).filter(function() {
      return $(this).is(':appeared');
    });
  }

  function process() {
    check_lock = false;
    for ( var index = 0, selectorsLength = selectors.length; index < selectorsLength; index++ ) {
      var $appeared = appeared(selectors[index]);

      $appeared.trigger('appear', [$appeared]);

      if ($prior_appeared[index]) {
        var $disappeared = $prior_appeared[index].not($appeared);
        $disappeared.trigger('disappear', [$disappeared]);
      }
      $prior_appeared[index] = $appeared;
    }
  }

  function add_selector(selector) {
    selectors.push(selector);
    $prior_appeared.push();
  }

  // "appeared" custom filter
  $.expr[':'].appeared = function(element) {
    var $element = $(element);
    var haveParentWithPostionRelative = false;
    if ( !$element.is(':visible') ) {
      return false;
    }

    

    if($(element).attr('connect-appear-scroll-parent')) {
      $window = $(element).closest( $(element).attr('connect-appear-scroll-parent') );
      haveParentWithPostionRelative = true;
    }
 

    var window_left = $window.scrollLeft();
    var window_top  = $window.scrollTop();

    if (!haveParentWithPostionRelative) {
      var offset = $element.offset();
    } else {
      var offset = $element.position();
    }
    var left = offset.left;
    var top = offset.top;
    if (
        // top + $element.height() >= window_top                                          &&
        (top + $element.height() <= $window.height() &&   top + $element.height() >0)     &&

        top - ($element.data('appear-top-offset') || 0) <= window_top + $window.height()  &&
        left + $element.width() >= window_left                                            &&
        left - ($element.data('appear-left-offset') || 0) <= window_left + $window.width()
    ) {
      return true;
    } else {
      return false;
    }
  };

  $.fn.extend({
    // watching for element's appearance in browser viewport
    appearByEach : function (iNfunction,iNoptions) {
        var selector = this.selector || this;
        $(selector).each(function() {
          $(this).appear_once(iNfunction,iNoptions);
        });
    },
    appear_once: function (iNfunction,iNoptions) {
      var selector = this.selector || this;
      var filterPathToThisClass = $window;
      var blockForScroll = false;

      
      if($(selector).attr('connect-appear-my-parent')) {
        filterPathToThisClass = $(selector).closest( $(selector).attr('connect-appear-my-parent') );
      }
      if(filterPathToThisClass.length > 0 ) {
        //get scroll parent from  filter patch 
        $window =  $(selector).closest(filterPathToThisClass) .attr('connect-appear-scroll-parent');
      }

      if( $(selector).attr('connect-appear-scroll-parent') ) {
        //get scroll parent from  this element patch 
        $window = $(selector).closest( $(selector).attr('connect-appear-scroll-parent') );
        haveParentWithPostionRelative = true;
      }

      if ( typeof iNoptions == 'object') {

        if ( typeof iNoptions['scroll-parent'] == 'string' ) {
          $window = $(selector).closest( iNoptions['scroll-parent'] );
          filterPathToThisClass = $window;
        }
        else if ( typeof iNoptions['scroll-window'] == 'string' ) {
          $window = $( iNoptions['scroll-window'] );
          filterPathToThisClass = $window;
        }

        if ( typeof iNoptions['my-filter-parent'] == 'string')
          filterPathToThisClass = $(selector).closest( iNoptions['my-filter-parent'] );
        else if ( typeof iNoptions['my-filter-window'] == 'string')
          filterPathToThisClass = $( iNoptions['my-filter-window'] );
      }

      if ( $(selector).is(':appeared') ) {
          iNfunction(selector);

        if ( typeof iNoptions['checkForRemoveClass'] != 'function' || iNoptions['checkForRemoveClass'](selector) ) {
          $(selector).removeClass('connect-appear');
        }
        return $(selector);
      } else {
        if ( typeof iNoptions['checkForAddClass'] != 'function'   || iNoptions['checkForAddClass'](selector) ) {
          $(selector).addClass('connect-appear');
        }
      }

      var on_check = () => {


        var $fullPathToChild  = $(filterPathToThisClass).children('.connect-appear') ;
        var allLengh          = $fullPathToChild.length - 1;
        
        if ( typeof iNoptions['onScrollParent'] == 'function' ) {
          iNoptions['onScrollParent']($window);
        }
        
        if( allLengh < 0 || blockForScroll) return false;
        blockForScroll = true;

        $fullPathToChild.each (
          function (index) {
            if ( $(this).is(':appeared') ) {
              if ( typeof iNoptions['checkForRemoveClass'] != 'function' || iNoptions['checkForRemoveClass'](selector) ) {
              $(selector).removeClass('connect-appear');
              }
              iNfunction(this);
            }
            if (allLengh==index) {
              // if it is last element
              blockForScroll = false;
            }
          }
        );
        
      }
      $($window).unbind('scroll').off('resize').scroll( on_check ).resize( on_check );//unbind('scroll').off('resize').

      return $(selector);
    },

    scrollRight :  function (iNoffset) {
      var selector  = this.selector || this;
      if(typeof iNoffset != 'number') {
        return $(selector)[0].scrollWidth - $(selector)[0].clientWidth - $(selector).scrollLeft();
      } else {
        let scrollWidth = $('#leftBlockInViewWindow')[0].scrollWidth - $('#leftBlockInViewWindow')[0].clientWidth;
        $(selector).scrollLeft(scrollWidth - iNoffset);
        return selector;
      }
    },

    scrollBot :    function (iNoffset) {
      var selector  = this.selector || this;
      if(typeof iNoffset != 'number') {
        return $(selector)[0].scrollHeight - $(selector)[0].clientHeight - $(selector).scrollTop();
      } else {
        let scrollHeight = $('#leftBlockInViewWindow')[0].scrollHeight - $('#leftBlockInViewWindow')[0].clientHeight;
         $(selector).scrollTop(scrollHeight - iNoffset);
         return selector;
      }
    },

    appear: function(options) {
      

      var opts      = $.extend({}, defaults, options || {});
      var selector  = this.selector || this;


      if( $(selector).attr('connect-appear-scroll-parent') ) {
          $window = $(selector).closest( $(selector).attr('connect-appear-scroll-parent') );
      }

      

      if (!check_binded) {
        var on_check = function() {
          if (check_lock) {
            return;
          }
          check_lock = true;
          setTimeout(process, opts.interval);
        };

        $($window).scroll(on_check).resize(on_check);
        check_binded = true;
      }

      if (opts.force_process) {

        setTimeout(process, opts.interval);
      }
      add_selector(selector);
      return $(selector);
    }
  });

  $.extend({
    // force elements's appearance check
    force_appear: function() {
      if (check_binded) {
        process();
        return true;
      }
      return false;
    }
  });
})(
  function() {
    // if (typeof module !== 'undefined') {
    //   // Node
    //   return require('jquery');
    // } else {
      return jQuery;
    // }
  }()
);
define("jquery.appear", ["jquery"], (function (global) {
    return function () {
        var ret, fn;
        return ret || global.jQuery.fn.appear;
    };
}(this)));

define('v_app-chat',[ 'jquery', 'template7', 'v_app','dictionary','m_moment', 'jquery.appear'],function( $, Template7,V_APP ,DICTIONARY,MOMENT) {
	const _ = {};
	const CONST = {'name':'base','pageIndex':'index'};
	const templates = {};

	templates['app'] = `
		<div id="subViewInViewAndChatBlock">
		   <div id="menuWindowInSubView"></div>
		   <div id="viewWindow" class="appChiefWindow">
		      <div>
		         <div id="leftBlockInViewWindow"></div>
		      </div>
		   </div>
		</div>
	`;

	templates['chatContainer'] = `
		<div class='ChatViewInAppWindow' connect_chatid='{{chatId}}'>{{content}}</div>
	`;

	templates['chiefHeader_user'] = `
		    <div class="appBase_pIndexLeftBlockInChiefHeader" connect_chatid="{{chatId}}"  connect_uid="{{uid}}">
		       {{#if back}}
			   <div class="appBase_backButton"></div>
			   {{/if}}
			   <div class="appBase_iconChief">
			      <a href="#"><img src="{{icon}}" class="appBase_pIndexUserImg"></a>
			      {{#if servise}}
			      <div class="appBase_userTypeBlock"><a href="#" class="CML" cmlk="[dictionary-servise]">[dictionary-service]</a></div>
			      {{/if}}
			   </div>
			   <div class="appBase_infoBlock">
			      <div class="appBase_userNameBlock">
			         <a href="#" class="CML" cmlk="[dictionary-name]">{{name}}</a>
			      	 {{#if verified}}
			         <div class="appBase_iconUserVerified"></div>
			         {{/if}}
			      </div>
			      <div class="appBase_userStateBlock">
		        	<span class="appBase_userStateOnline CML" cmlk="[dictionary-servise]" {{#if online}}{{else}}style='display:none'{{/if}}>[dictionary-online]</span>

					
			        <span class="appBase_userStateOffline CML" {{#if online}}style='display:none'{{/if}}>{{offlineTime}}</span>
			        {{#if offlineTime}}{{/if}}
			      </div>
			      <div class="appBase_chiefHeaderThirdLine">
					
			        <div class="appBase_onlineEyeIcon"></div>
			        {{#if watchNow}}{{/if}}
			      </div>
			   </div>
			</div>
			<div class="appBase_pIndexRightBlockInChiefHeader"></div>
		`;

	templates['appTemplate'] = `
		<div class="aCpI_streamVideo">
		  <video class="aCpI_videoStreamElement" muted></video>
		  <div class="aCpI_videoStreamTimeCounter"></div>
		</div>
		<div class="chatBlockInViewBlock">
		   <div class="viewesFooterUnderWindow">
		      <div id="senderBlockInViewBlock">
		         <div class="boxInMessageSenderBlock">
		            <div class="counterInChatId"></div>
		            <div class="buttonChatToBottom"></div>
		         </div>
		         
		         <div class="effectsForCancelling _noneSelect">
		         	<div class="cancellingAudio effectsFlag"></div>
		         	<div class="cancellingVideo effectsFlag"></div>
		         </div>

		         <div class="cancelBtnInMsgSenderButton"></div>


		         <div class="timerInMsgSenderBlock">
		         	<div class='audioTimerInMsgSenderBlock'></div>
		         	<div class='videoTimerInMsgSenderBlock'></div>
		         	<span></span>
		         </div>
		         <div id="bottomViewInMsgBlock">
		            <ul class="rawBlockInBottomView">
		               <li class="LineInBottomViewRawBlock">1</li>
		               <li class="LineInBottomViewRawBlock">2</li>
		            </ul>
		         </div>
		         <div id="sendTextButtonInSenderBlock" class="sendMsgButtons _noneSelect"></div>
		         <div id="sendLiveAudioButtonInSenderBlock" class="sendMsgButtons _noneSelect"></div>
		         <div id="sendLiveVideoButtonInSenderBlock" class="sendMsgButtons hideHalfSendMsgButton _noneSelect"></div>
		         <div id="forTextInputInSenderBlock">
		            <textarea ></textarea>
		         </div>
		         <div class="connectButtonInMsgSenderBlock"></div>
		      </div>
		   </div>
		</div>
	`;
	_['templates'] = templates;


	// function showStreamVideoViewer () {
	// 	$('.aCpI_streamVideo').css('display','flex');
	// }
	// _['showStreamVideoViewer'] = showStreamVideoViewer;

	// function hideStreamVideoViewer () {
	// 	$('.aCpI_streamVideo').css('display','none');
	// }
	// _['hideStreamVideoViewer'] = hideStreamVideoViewer;


	// function setStreamVideoElement (iNstream) {
	// 	// $('.aCpI_videoStreamElement')[0].src = URL.createObjectURL(iNstream);
	// 	$('.aCpI_videoStreamElement')[0].srcObject = iNstream;
	// }
	// _['setStreamVideoElement'] = setStreamVideoElement;

	function getChatSenderBlock (iNdata) {
		/*
			@inputs
				@required
					iNdata
						@required
							name
							icon
							id
						@optional
							online -> bool
							back --> bool
							offlineTime -> int
							watchNow -> bool
		*/
		var temp = Template7.compile(templates['appTemplate']);
		return temp(iNdata);
	}
	_['getChatSenderBlock'] = getChatSenderBlock;

	function getAppHeaderForIndexPage (iNdata) {
		/*
			@inputs
				@required
					iNdata
						@required
							name
							icon
							id
							chatId
						@optional
							online -> bool
							back --> bool
							offlineTime -> int
							watchNow -> bool
		*/
		var temp = Template7.compile(templates['chiefHeader_user']);
		return DICTIONARY.withString(temp(iNdata));
	}

	function addUserHeaderInChief (iNdata,iNtype) {
		/*
			@inputs
				@required
					iNdata
						@required
							nameDictionaryCode OR name
							icon
							login
						@optional
							nameDictionaryCode OR name
							back -> bool
							online -> number
				@optional
					iNtype -> string 
						in [end,begin, after, before, change]
		*/
		if( typeof iNtype != 'string' ) iNtype = 'end';
		//add online/ofline status
		if( typeof iNdata['online'] != 'undefined' ) {
			var onlineTime = parseInt(iNdata['online'])||0;
			if( onlineTime == 0) {
				// de
				delete iNdata['online'];
			} else if ( onlineTime > 1 ){
				// set online status
				delete iNdata['online'];
				iNdata['offlineTime'] = DICTIONARY.withString('[dictionary-was] ' + MOMENT(onlineTime).calendar());
			}
		}
		var objForAddHeader = {'app':CONST['name'],page: CONST['pageIndex']};
			objForAddHeader['content'] = getAppHeaderForIndexPage (iNdata);
		V_APP.safeViewAppHeaderWithContent(objForAddHeader,iNtype);
	}

	_['addUserHeaderInChief'] = addUserHeaderInChief;

		function effChatViewScrollToBot () {
			V_APP.effScrollToButtom('#leftBlockInViewWindow',300);

    	}
    	_['effChatViewScrollToBot'] = effChatViewScrollToBot;


	function getApp (iNdata) {
		var temp = Template7.compile(templates['app']);
		return temp(iNdata);
	}
	_['getApp'] = getApp;

	// 
    function createChatContainer (iNchatId) {
        var viewParent = "#leftBlockInViewWindow ";
        $(viewParent).prepend ( getChatContainer({'chatId':iNchatId}) );
    }
    _['createChatContainer'] = createChatContainer;

    function hideChatContainers () {
        $("#leftBlockInViewWindow .ChatViewInAppWindow").hide();
    }
    _['hideChatContainers'] = hideChatContainers;

    function showChatContainerByChatId (iNchatId) {
        $("#leftBlockInViewWindow .ChatViewInAppWindow" + "[connect_chatid='"+iNchatId+"']" ).show();
    }
    _['showChatContainerByChatId'] = showChatContainerByChatId;

    function getCountsOfChatContainers (iNchatId) {
        var needView = "#leftBlockInViewWindow .ChatViewInAppWindow[connect_chatid='"+iNchatId+"']";
        return $(needView).length;
    }
    _['getCountsOfChatContainers'] = getCountsOfChatContainers;

    	function getChatContainer (iNdata) {
			/*
				@discr

				@inputs
					@required
					iNdata -> object
						chatId 		-> string
						@optional
							content -> string


			*/
			var temp = Template7.compile(templates['chatContainer']);
			return temp(iNdata);
    	}

	return _;
});
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define('progressbar',[],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.ProgressBar=a()}}(function(){var a;return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(b,c,d){(function(){var b=this||Function("return this")(),e=function(){"use strict";function e(){}function f(a,b){var c;for(c in a)Object.hasOwnProperty.call(a,c)&&b(c)}function g(a,b){return f(b,function(c){a[c]=b[c]}),a}function h(a,b){f(b,function(c){"undefined"==typeof a[c]&&(a[c]=b[c])})}function i(a,b,c,d,e,f,g){var h,i,k,l=a<f?0:(a-f)/e;for(h in b)b.hasOwnProperty(h)&&(i=g[h],k="function"==typeof i?i:o[i],b[h]=j(c[h],d[h],k,l));return b}function j(a,b,c,d){return a+(b-a)*c(d)}function k(a,b){var c=n.prototype.filter,d=a._filterArgs;f(c,function(e){"undefined"!=typeof c[e][b]&&c[e][b].apply(a,d)})}function l(a,b,c,d,e,f,g,h,j,l,m){v=b+c+d,w=Math.min(m||u(),v),x=w>=v,y=d-(v-w),a.isPlaying()&&(x?(j(g,a._attachment,y),a.stop(!0)):(a._scheduleId=l(a._timeoutHandler,s),k(a,"beforeTween"),w<b+c?i(1,e,f,g,1,1,h):i(w,e,f,g,d,b+c,h),k(a,"afterTween"),j(e,a._attachment,y)))}function m(a,b){var c={},d=typeof b;return"string"===d||"function"===d?f(a,function(a){c[a]=b}):f(a,function(a){c[a]||(c[a]=b[a]||q)}),c}function n(a,b){this._currentState=a||{},this._configured=!1,this._scheduleFunction=p,"undefined"!=typeof b&&this.setConfig(b)}var o,p,q="linear",r=500,s=1e3/60,t=Date.now?Date.now:function(){return+new Date},u="undefined"!=typeof SHIFTY_DEBUG_NOW?SHIFTY_DEBUG_NOW:t;p="undefined"!=typeof window?window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||window.mozCancelRequestAnimationFrame&&window.mozRequestAnimationFrame||setTimeout:setTimeout;var v,w,x,y;return n.prototype.tween=function(a){return this._isTweening?this:(void 0===a&&this._configured||this.setConfig(a),this._timestamp=u(),this._start(this.get(),this._attachment),this.resume())},n.prototype.setConfig=function(a){a=a||{},this._configured=!0,this._attachment=a.attachment,this._pausedAtTime=null,this._scheduleId=null,this._delay=a.delay||0,this._start=a.start||e,this._step=a.step||e,this._finish=a.finish||e,this._duration=a.duration||r,this._currentState=g({},a.from||this.get()),this._originalState=this.get(),this._targetState=g({},a.to||this.get());var b=this;this._timeoutHandler=function(){l(b,b._timestamp,b._delay,b._duration,b._currentState,b._originalState,b._targetState,b._easing,b._step,b._scheduleFunction)};var c=this._currentState,d=this._targetState;return h(d,c),this._easing=m(c,a.easing||q),this._filterArgs=[c,this._originalState,d,this._easing],k(this,"tweenCreated"),this},n.prototype.get=function(){return g({},this._currentState)},n.prototype.set=function(a){this._currentState=a},n.prototype.pause=function(){return this._pausedAtTime=u(),this._isPaused=!0,this},n.prototype.resume=function(){return this._isPaused&&(this._timestamp+=u()-this._pausedAtTime),this._isPaused=!1,this._isTweening=!0,this._timeoutHandler(),this},n.prototype.seek=function(a){a=Math.max(a,0);var b=u();return this._timestamp+a===0?this:(this._timestamp=b-a,this.isPlaying()||(this._isTweening=!0,this._isPaused=!1,l(this,this._timestamp,this._delay,this._duration,this._currentState,this._originalState,this._targetState,this._easing,this._step,this._scheduleFunction,b),this.pause()),this)},n.prototype.stop=function(a){return this._isTweening=!1,this._isPaused=!1,this._timeoutHandler=e,(b.cancelAnimationFrame||b.webkitCancelAnimationFrame||b.oCancelAnimationFrame||b.msCancelAnimationFrame||b.mozCancelRequestAnimationFrame||b.clearTimeout)(this._scheduleId),a&&(k(this,"beforeTween"),i(1,this._currentState,this._originalState,this._targetState,1,0,this._easing),k(this,"afterTween"),k(this,"afterTweenEnd"),this._finish.call(this,this._currentState,this._attachment)),this},n.prototype.isPlaying=function(){return this._isTweening&&!this._isPaused},n.prototype.setScheduleFunction=function(a){this._scheduleFunction=a},n.prototype.dispose=function(){var a;for(a in this)this.hasOwnProperty(a)&&delete this[a]},n.prototype.filter={},n.prototype.formula={linear:function(a){return a}},o=n.prototype.formula,g(n,{now:u,each:f,tweenProps:i,tweenProp:j,applyFilter:k,shallowCopy:g,defaults:h,composeEasingObject:m}),"function"==typeof SHIFTY_DEBUG_NOW&&(b.timeoutHandler=l),"object"==typeof d?c.exports=n:"function"==typeof a&&a.amd?a(function(){return n}):"undefined"==typeof b.Tweenable&&(b.Tweenable=n),n}();!function(){e.shallowCopy(e.prototype.formula,{easeInQuad:function(a){return Math.pow(a,2)},easeOutQuad:function(a){return-(Math.pow(a-1,2)-1)},easeInOutQuad:function(a){return(a/=.5)<1?.5*Math.pow(a,2):-.5*((a-=2)*a-2)},easeInCubic:function(a){return Math.pow(a,3)},easeOutCubic:function(a){return Math.pow(a-1,3)+1},easeInOutCubic:function(a){return(a/=.5)<1?.5*Math.pow(a,3):.5*(Math.pow(a-2,3)+2)},easeInQuart:function(a){return Math.pow(a,4)},easeOutQuart:function(a){return-(Math.pow(a-1,4)-1)},easeInOutQuart:function(a){return(a/=.5)<1?.5*Math.pow(a,4):-.5*((a-=2)*Math.pow(a,3)-2)},easeInQuint:function(a){return Math.pow(a,5)},easeOutQuint:function(a){return Math.pow(a-1,5)+1},easeInOutQuint:function(a){return(a/=.5)<1?.5*Math.pow(a,5):.5*(Math.pow(a-2,5)+2)},easeInSine:function(a){return-Math.cos(a*(Math.PI/2))+1},easeOutSine:function(a){return Math.sin(a*(Math.PI/2))},easeInOutSine:function(a){return-.5*(Math.cos(Math.PI*a)-1)},easeInExpo:function(a){return 0===a?0:Math.pow(2,10*(a-1))},easeOutExpo:function(a){return 1===a?1:-Math.pow(2,-10*a)+1},easeInOutExpo:function(a){return 0===a?0:1===a?1:(a/=.5)<1?.5*Math.pow(2,10*(a-1)):.5*(-Math.pow(2,-10*--a)+2)},easeInCirc:function(a){return-(Math.sqrt(1-a*a)-1)},easeOutCirc:function(a){return Math.sqrt(1-Math.pow(a-1,2))},easeInOutCirc:function(a){return(a/=.5)<1?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)},easeOutBounce:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},easeInBack:function(a){var b=1.70158;return a*a*((b+1)*a-b)},easeOutBack:function(a){var b=1.70158;return(a-=1)*a*((b+1)*a+b)+1},easeInOutBack:function(a){var b=1.70158;return(a/=.5)<1?.5*(a*a*(((b*=1.525)+1)*a-b)):.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},elastic:function(a){return-1*Math.pow(4,-8*a)*Math.sin((6*a-1)*(2*Math.PI)/2)+1},swingFromTo:function(a){var b=1.70158;return(a/=.5)<1?.5*(a*a*(((b*=1.525)+1)*a-b)):.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},swingFrom:function(a){var b=1.70158;return a*a*((b+1)*a-b)},swingTo:function(a){var b=1.70158;return(a-=1)*a*((b+1)*a+b)+1},bounce:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},bouncePast:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?2-(7.5625*(a-=1.5/2.75)*a+.75):a<2.5/2.75?2-(7.5625*(a-=2.25/2.75)*a+.9375):2-(7.5625*(a-=2.625/2.75)*a+.984375)},easeFromTo:function(a){return(a/=.5)<1?.5*Math.pow(a,4):-.5*((a-=2)*Math.pow(a,3)-2)},easeFrom:function(a){return Math.pow(a,4)},easeTo:function(a){return Math.pow(a,.25)}})}(),function(){function a(a,b,c,d,e,f){function g(a){return((n*a+o)*a+p)*a}function h(a){return((q*a+r)*a+s)*a}function i(a){return(3*n*a+2*o)*a+p}function j(a){return 1/(200*a)}function k(a,b){return h(m(a,b))}function l(a){return a>=0?a:0-a}function m(a,b){var c,d,e,f,h,j;for(e=a,j=0;j<8;j++){if(f=g(e)-a,l(f)<b)return e;if(h=i(e),l(h)<1e-6)break;e-=f/h}if(c=0,d=1,e=a,e<c)return c;if(e>d)return d;for(;c<d;){if(f=g(e),l(f-a)<b)return e;a>f?c=e:d=e,e=.5*(d-c)+c}return e}var n=0,o=0,p=0,q=0,r=0,s=0;return p=3*b,o=3*(d-b)-p,n=1-p-o,s=3*c,r=3*(e-c)-s,q=1-s-r,k(a,j(f))}function b(b,c,d,e){return function(f){return a(f,b,c,d,e,1)}}e.setBezierFunction=function(a,c,d,f,g){var h=b(c,d,f,g);return h.displayName=a,h.x1=c,h.y1=d,h.x2=f,h.y2=g,e.prototype.formula[a]=h},e.unsetBezierFunction=function(a){delete e.prototype.formula[a]}}(),function(){function a(a,b,c,d,f,g){return e.tweenProps(d,b,a,c,1,g,f)}var b=new e;b._filterArgs=[],e.interpolate=function(c,d,f,g,h){var i=e.shallowCopy({},c),j=h||0,k=e.composeEasingObject(c,g||"linear");b.set({});var l=b._filterArgs;l.length=0,l[0]=i,l[1]=c,l[2]=d,l[3]=k,e.applyFilter(b,"tweenCreated"),e.applyFilter(b,"beforeTween");var m=a(c,i,d,f,k,j);return e.applyFilter(b,"afterTween"),m}}(),function(a){function b(a,b){var c,d=[],e=a.length;for(c=0;c<e;c++)d.push("_"+b+"_"+c);return d}function c(a){var b=a.match(v);return b?(1===b.length||a.charAt(0).match(u))&&b.unshift(""):b=["",""],b.join(A)}function d(b){a.each(b,function(a){var c=b[a];"string"==typeof c&&c.match(z)&&(b[a]=e(c))})}function e(a){return i(z,a,f)}function f(a){var b=g(a);return"rgb("+b[0]+","+b[1]+","+b[2]+")"}function g(a){return a=a.replace(/#/,""),3===a.length&&(a=a.split(""),a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),B[0]=h(a.substr(0,2)),B[1]=h(a.substr(2,2)),B[2]=h(a.substr(4,2)),B}function h(a){return parseInt(a,16)}function i(a,b,c){var d=b.match(a),e=b.replace(a,A);if(d)for(var f,g=d.length,h=0;h<g;h++)f=d.shift(),e=e.replace(A,c(f));return e}function j(a){return i(x,a,k)}function k(a){for(var b=a.match(w),c=b.length,d=a.match(y)[0],e=0;e<c;e++)d+=parseInt(b[e],10)+",";return d=d.slice(0,-1)+")"}function l(d){var e={};return a.each(d,function(a){var f=d[a];if("string"==typeof f){var g=r(f);e[a]={formatString:c(f),chunkNames:b(g,a)}}}),e}function m(b,c){a.each(c,function(a){for(var d=b[a],e=r(d),f=e.length,g=0;g<f;g++)b[c[a].chunkNames[g]]=+e[g];delete b[a]})}function n(b,c){a.each(c,function(a){var d=b[a],e=o(b,c[a].chunkNames),f=p(e,c[a].chunkNames);d=q(c[a].formatString,f),b[a]=j(d)})}function o(a,b){for(var c,d={},e=b.length,f=0;f<e;f++)c=b[f],d[c]=a[c],delete a[c];return d}function p(a,b){C.length=0;for(var c=b.length,d=0;d<c;d++)C.push(a[b[d]]);return C}function q(a,b){for(var c=a,d=b.length,e=0;e<d;e++)c=c.replace(A,+b[e].toFixed(4));return c}function r(a){return a.match(w)}function s(b,c){a.each(c,function(a){var d,e=c[a],f=e.chunkNames,g=f.length,h=b[a];if("string"==typeof h){var i=h.split(" "),j=i[i.length-1];for(d=0;d<g;d++)b[f[d]]=i[d]||j}else for(d=0;d<g;d++)b[f[d]]=h;delete b[a]})}function t(b,c){a.each(c,function(a){var d=c[a],e=d.chunkNames,f=e.length,g=b[e[0]],h=typeof g;if("string"===h){for(var i="",j=0;j<f;j++)i+=" "+b[e[j]],delete b[e[j]];b[a]=i.substr(1)}else b[a]=g})}var u=/(\d|\-|\.)/,v=/([^\-0-9\.]+)/g,w=/[0-9.\-]+/g,x=new RegExp("rgb\\("+w.source+/,\s*/.source+w.source+/,\s*/.source+w.source+"\\)","g"),y=/^.*\(/,z=/#([0-9]|[a-f]){3,6}/gi,A="VAL",B=[],C=[];a.prototype.filter.token={tweenCreated:function(a,b,c,e){d(a),d(b),d(c),this._tokenData=l(a)},beforeTween:function(a,b,c,d){s(d,this._tokenData),m(a,this._tokenData),m(b,this._tokenData),m(c,this._tokenData)},afterTween:function(a,b,c,d){n(a,this._tokenData),n(b,this._tokenData),n(c,this._tokenData),t(d,this._tokenData)}}}(e)}).call(null)},{}],2:[function(a,b,c){var d=a("./shape"),e=a("./utils"),f=function(a,b){this._pathTemplate="M 50,50 m 0,-{radius} a {radius},{radius} 0 1 1 0,{2radius} a {radius},{radius} 0 1 1 0,-{2radius}",this.containerAspectRatio=1,d.apply(this,arguments)};f.prototype=new d,f.prototype.constructor=f,f.prototype._pathString=function(a){var b=a.strokeWidth;a.trailWidth&&a.trailWidth>a.strokeWidth&&(b=a.trailWidth);var c=50-b/2;return e.render(this._pathTemplate,{radius:c,"2radius":2*c})},f.prototype._trailString=function(a){return this._pathString(a)},b.exports=f},{"./shape":7,"./utils":9}],3:[function(a,b,c){var d=a("./shape"),e=a("./utils"),f=function(a,b){this._pathTemplate="M 0,{center} L 100,{center}",d.apply(this,arguments)};f.prototype=new d,f.prototype.constructor=f,f.prototype._initializeSvg=function(a,b){a.setAttribute("viewBox","0 0 100 "+b.strokeWidth),a.setAttribute("preserveAspectRatio","none")},f.prototype._pathString=function(a){return e.render(this._pathTemplate,{center:a.strokeWidth/2})},f.prototype._trailString=function(a){return this._pathString(a)},b.exports=f},{"./shape":7,"./utils":9}],4:[function(a,b,c){b.exports={Line:a("./line"),Circle:a("./circle"),SemiCircle:a("./semicircle"),Square:a("./square"),Path:a("./path"),Shape:a("./shape"),utils:a("./utils")}},{"./circle":2,"./line":3,"./path":5,"./semicircle":6,"./shape":7,"./square":8,"./utils":9}],5:[function(a,b,c){var d=a("shifty"),e=a("./utils"),f={easeIn:"easeInCubic",easeOut:"easeOutCubic",easeInOut:"easeInOutCubic"},g=function a(b,c){if(!(this instanceof a))throw new Error("Constructor was called without new keyword");c=e.extend({duration:800,easing:"linear",from:{},to:{},step:function(){}},c);var d;d=e.isString(b)?document.querySelector(b):b,this.path=d,this._opts=c,this._tweenable=null;var f=this.path.getTotalLength();this.path.style.strokeDasharray=f+" "+f,this.set(0)};g.prototype.value=function(){var a=this._getComputedDashOffset(),b=this.path.getTotalLength(),c=1-a/b;return parseFloat(c.toFixed(6),10)},g.prototype.set=function(a){this.stop(),this.path.style.strokeDashoffset=this._progressToOffset(a);var b=this._opts.step;if(e.isFunction(b)){var c=this._easing(this._opts.easing),d=this._calculateTo(a,c),f=this._opts.shape||this;b(d,f,this._opts.attachment)}},g.prototype.stop=function(){this._stopTween(),this.path.style.strokeDashoffset=this._getComputedDashOffset()},g.prototype.animate=function(a,b,c){b=b||{},e.isFunction(b)&&(c=b,b={});var f=e.extend({},b),g=e.extend({},this._opts);b=e.extend(g,b);var h=this._easing(b.easing),i=this._resolveFromAndTo(a,h,f);this.stop(),this.path.getBoundingClientRect();var j=this._getComputedDashOffset(),k=this._progressToOffset(a),l=this;this._tweenable=new d,this._tweenable.tween({from:e.extend({offset:j},i.from),to:e.extend({offset:k},i.to),duration:b.duration,easing:h,step:function(a){l.path.style.strokeDashoffset=a.offset;var c=b.shape||l;b.step(a,c,b.attachment)},finish:function(a){e.isFunction(c)&&c()}})},g.prototype._getComputedDashOffset=function(){var a=window.getComputedStyle(this.path,null);return parseFloat(a.getPropertyValue("stroke-dashoffset"),10)},g.prototype._progressToOffset=function(a){var b=this.path.getTotalLength();return b-a*b},g.prototype._resolveFromAndTo=function(a,b,c){return c.from&&c.to?{from:c.from,to:c.to}:{from:this._calculateFrom(b),to:this._calculateTo(a,b)}},g.prototype._calculateFrom=function(a){return d.interpolate(this._opts.from,this._opts.to,this.value(),a)},g.prototype._calculateTo=function(a,b){return d.interpolate(this._opts.from,this._opts.to,a,b)},g.prototype._stopTween=function(){null!==this._tweenable&&(this._tweenable.stop(),this._tweenable=null)},g.prototype._easing=function(a){return f.hasOwnProperty(a)?f[a]:a},b.exports=g},{"./utils":9,shifty:1}],6:[function(a,b,c){var d=a("./shape"),e=a("./circle"),f=a("./utils"),g=function(a,b){this._pathTemplate="M 50,50 m -{radius},0 a {radius},{radius} 0 1 1 {2radius},0",this.containerAspectRatio=2,d.apply(this,arguments)};g.prototype=new d,g.prototype.constructor=g,g.prototype._initializeSvg=function(a,b){a.setAttribute("viewBox","0 0 100 50")},g.prototype._initializeTextContainer=function(a,b,c){a.text.style&&(c.style.top="auto",c.style.bottom="0",a.text.alignToBottom?f.setStyle(c,"transform","translate(-50%, 0)"):f.setStyle(c,"transform","translate(-50%, 50%)"))},g.prototype._pathString=e.prototype._pathString,g.prototype._trailString=e.prototype._trailString,b.exports=g},{"./circle":2,"./shape":7,"./utils":9}],7:[function(a,b,c){var d=a("./path"),e=a("./utils"),f="Object is destroyed",g=function a(b,c){if(!(this instanceof a))throw new Error("Constructor was called without new keyword");if(0!==arguments.length){this._opts=e.extend({color:"#555",strokeWidth:1,trailColor:null,trailWidth:null,fill:null,text:{style:{color:null,position:"absolute",left:"50%",top:"50%",padding:0,margin:0,transform:{prefix:!0,value:"translate(-50%, -50%)"}},autoStyleContainer:!0,alignToBottom:!0,value:null,className:"progressbar-text"},svgStyle:{display:"block",width:"100%"},warnings:!1},c,!0),e.isObject(c)&&void 0!==c.svgStyle&&(this._opts.svgStyle=c.svgStyle),e.isObject(c)&&e.isObject(c.text)&&void 0!==c.text.style&&(this._opts.text.style=c.text.style);var f,g=this._createSvgView(this._opts);if(f=e.isString(b)?document.querySelector(b):b,!f)throw new Error("Container does not exist: "+b);this._container=f,this._container.appendChild(g.svg),this._opts.warnings&&this._warnContainerAspectRatio(this._container),this._opts.svgStyle&&e.setStyles(g.svg,this._opts.svgStyle),this.svg=g.svg,this.path=g.path,this.trail=g.trail,this.text=null;var h=e.extend({attachment:void 0,shape:this},this._opts);this._progressPath=new d(g.path,h),e.isObject(this._opts.text)&&null!==this._opts.text.value&&this.setText(this._opts.text.value)}};g.prototype.animate=function(a,b,c){if(null===this._progressPath)throw new Error(f);this._progressPath.animate(a,b,c)},g.prototype.stop=function(){if(null===this._progressPath)throw new Error(f);void 0!==this._progressPath&&this._progressPath.stop()},g.prototype.destroy=function(){if(null===this._progressPath)throw new Error(f);this.stop(),this.svg.parentNode.removeChild(this.svg),this.svg=null,this.path=null,this.trail=null,this._progressPath=null,null!==this.text&&(this.text.parentNode.removeChild(this.text),this.text=null)},g.prototype.set=function(a){if(null===this._progressPath)throw new Error(f);this._progressPath.set(a)},g.prototype.value=function(){if(null===this._progressPath)throw new Error(f);return void 0===this._progressPath?0:this._progressPath.value()},g.prototype.setText=function(a){if(null===this._progressPath)throw new Error(f);null===this.text&&(this.text=this._createTextContainer(this._opts,this._container),this._container.appendChild(this.text)),e.isObject(a)?(e.removeChildren(this.text),this.text.appendChild(a)):this.text.innerHTML=a},g.prototype._createSvgView=function(a){var b=document.createElementNS("http://www.w3.org/2000/svg","svg");this._initializeSvg(b,a);var c=null;(a.trailColor||a.trailWidth)&&(c=this._createTrail(a),b.appendChild(c));var d=this._createPath(a);return b.appendChild(d),{svg:b,path:d,trail:c}},g.prototype._initializeSvg=function(a,b){a.setAttribute("viewBox","0 0 100 100")},g.prototype._createPath=function(a){var b=this._pathString(a);return this._createPathElement(b,a)},g.prototype._createTrail=function(a){var b=this._trailString(a),c=e.extend({},a);return c.trailColor||(c.trailColor="#eee"),c.trailWidth||(c.trailWidth=c.strokeWidth),c.color=c.trailColor,c.strokeWidth=c.trailWidth,c.fill=null,this._createPathElement(b,c)},g.prototype._createPathElement=function(a,b){var c=document.createElementNS("http://www.w3.org/2000/svg","path");return c.setAttribute("d",a),c.setAttribute("stroke",b.color),c.setAttribute("stroke-width",b.strokeWidth),b.fill?c.setAttribute("fill",b.fill):c.setAttribute("fill-opacity","0"),c},g.prototype._createTextContainer=function(a,b){var c=document.createElement("div");c.className=a.text.className;var d=a.text.style;return d&&(a.text.autoStyleContainer&&(b.style.position="relative"),e.setStyles(c,d),d.color||(c.style.color=a.color)),this._initializeTextContainer(a,b,c),c},g.prototype._initializeTextContainer=function(a,b,c){},g.prototype._pathString=function(a){throw new Error("Override this function for each progress bar")},g.prototype._trailString=function(a){throw new Error("Override this function for each progress bar")},g.prototype._warnContainerAspectRatio=function(a){if(this.containerAspectRatio){var b=window.getComputedStyle(a,null),c=parseFloat(b.getPropertyValue("width"),10),d=parseFloat(b.getPropertyValue("height"),10);e.floatEquals(this.containerAspectRatio,c/d)||(console.warn("Incorrect aspect ratio of container","#"+a.id,"detected:",b.getPropertyValue("width")+"(width)","/",b.getPropertyValue("height")+"(height)","=",c/d),console.warn("Aspect ratio of should be",this.containerAspectRatio))}},b.exports=g},{"./path":5,"./utils":9}],8:[function(a,b,c){var d=a("./shape"),e=a("./utils"),f=function(a,b){this._pathTemplate="M 0,{halfOfStrokeWidth} L {width},{halfOfStrokeWidth} L {width},{width} L {halfOfStrokeWidth},{width} L {halfOfStrokeWidth},{strokeWidth}",this._trailTemplate="M {startMargin},{halfOfStrokeWidth} L {width},{halfOfStrokeWidth} L {width},{width} L {halfOfStrokeWidth},{width} L {halfOfStrokeWidth},{halfOfStrokeWidth}",d.apply(this,arguments)};f.prototype=new d,f.prototype.constructor=f,f.prototype._pathString=function(a){var b=100-a.strokeWidth/2;return e.render(this._pathTemplate,{width:b,strokeWidth:a.strokeWidth,halfOfStrokeWidth:a.strokeWidth/2})},f.prototype._trailString=function(a){var b=100-a.strokeWidth/2;return e.render(this._trailTemplate,{width:b,strokeWidth:a.strokeWidth,halfOfStrokeWidth:a.strokeWidth/2,startMargin:a.strokeWidth/2-a.trailWidth/2})},b.exports=f},{"./shape":7,"./utils":9}],9:[function(a,b,c){function d(a,b,c){a=a||{},b=b||{},c=c||!1;for(var e in b)if(b.hasOwnProperty(e)){var f=a[e],g=b[e];c&&l(f)&&l(g)?a[e]=d(f,g,c):a[e]=g}return a}function e(a,b){var c=a;for(var d in b)if(b.hasOwnProperty(d)){var e=b[d],f="\\{"+d+"\\}",g=new RegExp(f,"g");c=c.replace(g,e)}return c}function f(a,b,c){for(var d=a.style,e=0;e<p.length;++e){var f=p[e];d[f+h(b)]=c}d[b]=c}function g(a,b){m(b,function(b,c){null!==b&&void 0!==b&&(l(b)&&b.prefix===!0?f(a,c,b.value):a.style[c]=b)})}function h(a){return a.charAt(0).toUpperCase()+a.slice(1)}function i(a){return"string"==typeof a||a instanceof String}function j(a){return"function"==typeof a}function k(a){return"[object Array]"===Object.prototype.toString.call(a)}function l(a){if(k(a))return!1;var b=typeof a;return"object"===b&&!!a}function m(a,b){for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];b(d,c)}}function n(a,b){return Math.abs(a-b)<q}function o(a){for(;a.firstChild;)a.removeChild(a.firstChild)}var p="Webkit Moz O ms".split(" "),q=.001;b.exports={extend:d,render:e,setStyle:f,setStyles:g,capitalize:h,isString:i,isFunction:j,isObject:l,forEachObject:m,floatEquals:n,removeChildren:o}},{}]},{},[4])(4)});
//# sourceMappingURL=progressbar.min.js.map;
define('m_progressbar',['jquery', 'progressbar'],function($, PROGRESSBAR ) {
	console.log('PROGRESSBAR',PROGRESSBAR);
	window.ProgressBar = PROGRESSBAR;

	const _ 	= {};
	const CONST = {};

	function init (iNselector, iNprogress, iNdata) {
		var r 	= {};
		var bar;

		function start (iNselector, iNprogress, iNdata) {
			/*
				@inputs
					@required
						iNselector -> string
					@optional
						iNprogress 			-> float (from 0.0 to 1.0)
						iNdata 				-> object
							color 			-> string
							duration 		-> int
							#from: section
								colorFrom 	-> string
								widthFrom 	-> int
							#to: section
								colorTo 	-> string
								widthTo		-> int
							fontFamily 		-> int
							fontSize 		-> int
							easing 			-> int
							duration 		-> int
			*/
			var container 	= $(iNselector).get(0),
				color 		= iNdata['color']		|| '#000',
				duration 	= iNdata['duration']	|| 1000,
				colorFrom 	= iNdata['colorFrom']	|| '#aaa',
				widthFrom 	= iNdata['widthFrom']	|| 1,
				widthTo 	= iNdata['widthTo']		|| 4,
				colorTo 	= iNdata['colorTo']		|| '#000',
				fontSize 	= iNdata['fontSize']	|| '1rem',
				easing 		= iNdata['easing']		|| 'easeInOut',
				fontFamily  = iNdata['fontFamily']	|| '"Raleway", Helvetica, sans-serif',
				progress    = iNprogress;
			  bar = new PROGRESSBAR.Circle( container, {
			  color: 		color,
			  // This has to be the same size as the maximum width to 
			  // prevent clipping
			  strokeWidth: 	4,
			  trailWidth: 	1,
			  easing: 		easing,
			  duration: 	duration,
			  text: {
			    autoStyleContainer: false
			  },
			  from: 	{ color: colorFrom, width: widthFrom },
			  to: 		{ color: colorTo, width: widthTo },
			  // Set default step function for all animate calls
			  step: function(state, circle) {
			    circle.path.setAttribute('stroke', state.color);
			    circle.path.setAttribute('stroke-width', state.width);

			    var value = Math.round(circle.value() * 100);
			    if (value === 0) {
			      circle.setText('');
			    } else {
			      circle.setText(value);
			    }

			  }
			});
			bar.text.style.fontFamily 	= fontFamily;
			bar.text.style.fontSize 	= fontSize;

			to(progress);

			return r;
		}
		r['start'] = start;

		function to (iNprogress) {
			if( typeof iNprogress == 'number' )
				bar.animate(iNprogress);  // Number from 0.0 to 1.0
		}
		r['to'] = to;


		return start(iNselector, iNprogress, iNdata);
	}
	_['init'] = init;
	

	return _;
});
define(
	'v_message',['dictionary', 'm_progressbar','template7','v_app', 'm_moment','jquery',  'jquery.appear', 'jquery.countdown'],
	function ( DICTIONARY, M_PROGRESSBAR, Template7, V_APP, MOMENT, $) {
	const _ = {};
	const CONST = {};
	const templates = {};

  $.fn.extend({
		/* EXTENCION */
			'specialClick': function (iNdata) {
				  /*
				  	@inputs
				  		@optional
				  		iNdata -> object
				  			@optional
				  				enter -> function
			  					out -> function
			  					down -> function
			  					up -> function

				  */
			      var selector = this.selector || this;
			      var state = false;
			      var funcs = iNdata;
			      var initFuntions = () => {
			      	$(window).unbind('mouseup').mouseup( ()=>{
			            if ( typeof funcs.up == 'function')funcs.up(state);
			            $(window).unbind('mouseup');
			            $(this).unbind('mouseout');
			            $(this).unbind('mouseenter');

			        });
			        $(selector).mouseout( ()=>{
			          state = false;
			          if ( typeof funcs.out == 'function')funcs.out(state);
			        });
			        $(selector).mouseenter( ()=>{
			          state = true;
			          if ( typeof funcs.enter == 'function')funcs.enter(state);

			        });
			      }
			      $(selector).unbind('mousedown').mousedown( ()=>{
			      	state = true;
			        if ( typeof funcs.down == 'function')funcs.down(state);
			        initFuntions();
			      
			      }
		        );
			}
	    /* EXTENCION */
	});

  	// tagForTracking
  	// 	templates['tag_forTracking'] = `
  	// 		<div id='tagId{{tagId}}' class='tagForTracking'></div>
  	// 	`;
  	// 	function getTagForTracking () {
  	// 		let temp 		= Template7.compile(templates['tag_forTracking']);
			// let domElement 	=  temp(iNdata);
  	// 	} _.getTagForTracking = getTagForTracking;
	
	//@< chief msg container
		templates['msg_boxForMessage'] = `
			<div id='msgId{{msgId}}' class="messagesInChatView {{class}} {{#if hide}}hide{{/if}}{{#if appearClass}}connect-appear{{/if}} {{#if fromMe}}fromMeMessageInChatView{{/if}}{{#if toMe}}toMeMessageInChatView{{/if}} {{#if note}}noteMessage{{/if}}"  {{#if timeSent}}time-sent="{{timeSent}}"{{/if}}  {{#if timeRead}}time-read="{{timeRead}}"{{/if}} {{#if timeDelivered}}time-delivered="{{timeDelivered}}"{{/if}}  connect_msg="{{msgId}}" connect-appear-scroll-parent='#leftBlockInViewWindow' connect-appear-my-parent='.ChatViewInAppWindow'>
				{{boxContent}}
			</div>
		`;
		//@<SECTION common time
		  	templates['msg_commonTimeFromMeBlock'] = `
				<div class="lineInFromMeMessage">
			      <div class="lineInBoxInLine">
			         
				         <div class="topCircleInMessages" {{#if timeSentText}}{{else}}{{/if}}></div>
				         <div class="timeTopInMessages">{{timeSentText}}</div>
			         

			        <div class="botCircleInMessages" {{#if timeDeliveredText}}{{else}}style="display:none;"{{/if}}  {{#if timeDeliveredText}}title="{{timeDeliveredText}}"{{/if}}></div>
		         	<div class="timeBotInMessages" {{#if timeReadText}}{{else}}style="display:none;"{{/if}}>{{#if timeReadText}}{{timeReadText}}{{/if}}</div>

			      </div>
			   </div>
		  	`;
		  		function msg_getTemplateByNameCommonTimeFromMeBlock (iNdata) {
		  			/*
		    			@inputs
		    				iNdata -> object
		    					class
		    		*/
					let temp = Template7.compile(templates['msg_commonTimeFromMeBlock']);
					return temp(iNdata);
		  		}

			templates['msg_commonTimeToMeBlock'] = `
				<div class="lineInToMeMessage">
			   		<div class="lineInBoxInLine">
						 
						<div class="topCircleInMessages" {{#if timeSentText}}{{else}}style="display:none;"{{/if}}></div>
						<div class="timeTopInMessages" {{#if timeSentText}}{{else}}style="display:none;"{{/if}}>{{timeSentText}}</div>
				         
				        <div class="botCircleInMessages" {{#if timeDeliveredText}}{{else}}style="display:none;"{{/if}}  {{#if timeDeliveredText}}title="{{timeDeliveredText}}"{{/if}}></div>
			         	<div class="timeBotInMessages" {{#if timeReadText}}{{else}}style="display:none;"{{/if}}>{{#if timeReadText}}{{timeReadText}}{{/if}}</div>
				  	</div>
			  	</div>
		  	`;
		  		function msg_getTemplateByNameCommonTimeToMeBlock (iNdata) {
		  			/*
		    			@inputs
		    				iNdata -> object
		    					class
		    		*/
					let temp = Template7.compile(templates['msg_commonTimeToMeBlock']);
					return temp(iNdata);
		  		}
		  			
		  			function msg_updateDomCommonTimeBlock (iNchatId,iNmsgId,iNdata) {
							/*
								@inputs
									@required
										iNdata -> object
											timeSent 		-> int
											timeSentText 	-> string

											timeRead 		-> int
											timeReadText 	-> string

											timeDelivered 		-> int
											timeDeliveredText 	-> string
							*/
						console.log('msg_updateDomCommonTimeBlock iNchatId,iNmsgId,iNdata',iNchatId,iNmsgId,iNdata); 

		  				if ( iNdata['timeSentText'] && iNdata['timeSent'])
		  					msg_updateDomTimeSent (iNchatId,iNmsgId,iNdata);

		  				if ( iNdata['timeReadText'] && iNdata['timeRead'])
		  					msg_updateDomTimeRead (iNchatId,iNmsgId,iNdata);

		  				if ( iNdata['timeDeliveredText'] && iNdata['timeDelivered'])
		  					msg_updateDomTimeDelivered (iNchatId,iNmsgId,iNdata);
		  			}
						function msg_updateDomTimeSent (iNchatId,iNmsgId,iNdata) {
							/*
								@inputs
									@required
										iNdata -> object
											timeSent 		-> int
											timeSentText 	-> string
							*/
							console.log('msg_updateDomTimeSent iNchatId,iNmsgId,iNdata',iNchatId,iNmsgId,iNdata);
							let msgSelector 	= msg_getPathToDomForMsg(iNchatId,iNmsgId);
							console.log('msg_updateDomTimeSent msgSelector', msgSelector);
							// set timeSent -> update dom attr time
							$(msgSelector).attr('time-sent', iNdata['timeSent'] );
							// show dom el top circle
							$(msgSelector + ' .topCircleInMessages').show();
							// set new val -> show dom el top circle
							$(msgSelector + ' .timeTopInMessages').html( iNdata['timeSentText'] ).show();
						}
						function msg_updateDomTimeRead (iNchatId,iNmsgId,iNdata) {
							/*
								@inputs
									@required
										iNdata -> object
											timeRead 		-> int
											timeReadText 	-> string
							*/
							let msgSelector 	= msg_getPathToDomForMsg(iNchatId,iNmsgId);
							// set timeSent -> update dom attr time
							$(msgSelector).attr('time-read', iNdata['timeRead'] );
							// set new val -> show dom el top circle
							$(msgSelector + ' .timeBotInMessages').html( iNdata['timeReadText'] ).show();
						}
						function msg_updateDomTimeDelivered (iNchatId,iNmsgId,iNdata) {
							/*
								@inputs
									@required
										iNdata -> object
											timeDelivered 		-> int
											timeDeliveredText 	-> string
							*/
							let msgSelector 	= msg_getPathToDomForMsg(iNchatId,iNmsgId);
							// set timeSent -> update dom attr time
							$(msgSelector).attr('time-delivered', iNdata['timeDelivered'] );
							// set new attr title -> show dom el top circle
							$(msgSelector + ' .botCircleInMessages').attr('title', iNdata['timeDeliveredText'] ).show();
						}

			  		function msg_getDomAttrByNameChatId (iNel) {
				        var r = $(iNel).parent().attr('connect_chatid');
				        return r;
					}
					_['msg_getDomAttrByNameChatId'] = msg_getDomAttrByNameChatId;

					function msg_getDomAttrByNameMsgId (iNel) {
				        var r = $(iNel).attr('connect_msg');
				        return r;
					}
					_['msg_getDomAttrByNameMsgId'] = msg_getDomAttrByNameMsgId;

					function msg_getDomAttrByNameMessageTimeSent (iNel) {
						//time-sent
				        var r = parseInt($(iNel).attr('time-sent'));
				        if(typeof r != 'number' || !isFinite(r) ) r = 0;
				        return r;
					}
					_['msg_getDomAttrByNameMessageTimeSent'] = msg_getDomAttrByNameMessageTimeSent;

					function msg_getDomAttrByNameMessageTimeRead (iNel) {
						//time-read
				        var r = parseInt($(iNel).attr('time-read'));
				        if(typeof r != 'number' || !isFinite(r) ) r = 0;
				        return r;
					}
					_['msg_getDomAttrByNameMessageTimeRead'] = msg_getDomAttrByNameMessageTimeRead;

					function msg_getDomAttrByNameMessageTimeDelivered (iNel) {
						//time-delivered
				        var r = parseInt($(iNel).attr('time-delivered'));
				        if(typeof r != 'number' || !isFinite(r) ) r = 0;
				        return r;
					}
					_['msg_getDomAttrByNameMessageTimeDelivered'] = msg_getDomAttrByNameMessageTimeDelivered;
		//@SECTION> common time


		function msg_dellHideClassByMsgId (iNmsgId) {
			var id = '#msgId' + iNmsgId;
			$(id+'.messagesInChatView').removeClass('hide');
		} _.msg_dellHideClassByMsgId = msg_dellHideClassByMsgId;



		function msg_getTemplateByNameBoxForMsg (iNdata) {
    		/*
    			@inputs
    				iNdata -> object
    					class
    		*/
			let temp = Template7.compile(templates['msg_boxForMessage']);
			return temp(iNdata);
		}
    	_['msg_getTemplateByNameBoxForMsg'] = msg_getTemplateByNameBoxForMsg;

    	function msg_getPathToDomForMsg (  iNchatId, iNmsgId ) {
    		/*
    			@discr
    				get selector (path to dom message element)
    			@inputs
    				iNchatId -> string
    				iNmsgId -> string
    		*/
	        var iNneedView = msg_getPathToDomForChat(iNchatId);
	        var fullPath = iNneedView + " .messagesInChatView[connect_msg='"+iNmsgId+"']";
	        return fullPath;
		}
	    _['msg_getPathToDomForMsg'] = msg_getPathToDomForMsg;

    	function msg_getPathToDomForChat (  iNchatId ) {
    		/*
    			@discr
    				get selector (path to dom message element)
    			@inputs
    				iNchatId -> string
    				iNmsgId -> string
    		*/
	        var fullPath = "#leftBlockInViewWindow .ChatViewInAppWindow[connect_chatid='"+iNchatId+"']";
	        return fullPath;
		}
	    _['msg_getPathToDomForMsg'] = msg_getPathToDomForMsg;

	    function msg_getNameOfTypeByType (iNtype) {
	    	switch(iNtype) {
    			//@< text messages
    			case 1: 	// simpleText 
					return 'simpleText';
    			break;
    			//@> text messages

    			//@< live messages
	    			case 20: 	// liveAudio 
						return 'liveAudio';
	    			break;

	    			case 21: 	// liveVideo
						return 'liveVideo';
	    			break;
    			//@> live messages

				//@< file messages
    			//@< file messages

				//@< documents messages
    			//@< documents messages
    		}
    		return false;
	    } _.msg_getNameOfTypeByType = msg_getNameOfTypeByType;

	    function msg_replaceMsgByItsType ( iNtype, iNobjectForCreateMessage, iNmyUID, iNchatId ) {
	    	console.log('msg_replaceMsgByItsType' , iNtype, iNobjectForCreateMessage, iNmyUID, iNchatId);
    		switch(iNtype) {
    			//@< text messages
    			case 1: 	// simpleText 
					msgSimpleText_safeReplace( iNobjectForCreateMessage, iNmyUID, iNchatId  );
    			break;
    			//@> text messages

    			//@< live messages
	    			case 20: 	// liveAudio 
						msgLiveAudio_safeReplace( iNobjectForCreateMessage, iNmyUID, iNchatId  );
	    			break;

	    			case 21: 	// liveAudio
						msgLiveVideo_safeReplace( iNobjectForCreateMessage, iNmyUID, iNchatId  );
	    			break;
    			//@> live messages

				//@< file messages
    			//@< file messages

				//@< documents messages
    			//@< documents messages
    		}
		}
	    _['msg_replaceMsgByItsType'] = msg_replaceMsgByItsType;


	//@> chief msg container





	//@<SECTION  'msg simpleText' type = 1  ------------------------------------------------------------------------------------------------------------------------------------------------
		
		//@< msgSimpleText_center 
			templates['msgSimpleText_center'] = `
				<div class="centerMsgInChatView">{{content}}</div>
			`;
			function msgSimpleText_addCenter ( iNdata, iNchatId ) {
		        var iNneedView = msg_getPathToDomForChat(iNchatId);//"#leftBlockInViewWindow .ChatViewInAppWindow[connect_chatid='"+iNchatId+"']";
		        $( iNneedView ).append( msgSimpleText_getTemplateByNameCenter ( iNdata ) );
			}
			_['msgSimpleText_addCenter'] = msgSimpleText_addCenter;

				function msgSimpleText_getTemplateByNameCenter (iNdata) {
					/*
						@inputs
							@required
								iNdata
									@required
										content
									@optional
					*/
					var temp = Template7.compile(templates['msgSimpleText_center']);
					return temp(iNdata);
				}
				_['msgSimpleText_getTemplateByNameCenter'] = msgSimpleText_getTemplateByNameCenter;
		//@> msgSimpleText_center

		templates['msgSimpleText_from'] = `
		   {{commonTimeBlock}}
		   <div class="contentTextInFromMeMessage">{{content}}</div>
		`;

		templates['msgSimpleText_to'] = `
		   {{commonTimeBlock}}
		   <div class="contentTextInToMeMessage">{{content}}</div>
		`;

		function msgSimpleText_getMsg (iNdata,iNmyUid) {
			/*
				@discr

				@inputs
					iNdata -> object
						msgId 		-> string
						state 	    -> object
							sent      -> timestamp
							delivered -> timestamp
							time      -> timestamp
						timeRead 	-> string
						content 	-> string

						@optional
							type		-> string

			*/
			var el = {}, result;

			iNdata['class'] = 'msgTypeSimpleText';
			if ( iNdata.uid == iNmyUid ) {
				iNdata['fromMe'] 			= 1;
	            iNdata['commonTimeBlock'] 	= msg_getTemplateByNameCommonTimeFromMeBlock(iNdata);
	            iNdata['boxContent'] 		= msgSimpleText_getTemplateByNameFrom(iNdata);
			}
	        else {
	            iNdata['toMe'] 				= 1;
	            iNdata['commonTimeBlock'] 	= msg_getTemplateByNameCommonTimeToMeBlock(iNdata);
				iNdata['boxContent'] 		= msgSimpleText_getTemplateByNameTo(iNdata);
	        }
	        return msg_getTemplateByNameBoxForMsg(iNdata);
		}
	    _['msgSimpleText_getMsg'] = msgSimpleText_getMsg;

	    function msgSimpleText_updateContent (iNchatId, iNdata,iNmyUid) {
			/*
				@discr
				@inputs
					iNchatId -> string
					iNdata -> object
						msgId 		-> string
						content 	-> string
					iNmyUid -> string
			*/
			var msgPath = msg_getPathToDomForMsg(iNchatId,iNdata['msgId']);
			if ( iNdata.uid == iNmyUid )
				$(msgPath + ' .contentTextInFromMeMessage').html(iNdata['content']);
			else
				$(msgPath + ' .contentTextInToMeMessage').html(iNdata['content']);
		}

	    	

			function msgSimpleText_getTemplateByNameFrom (iNdata) {
				let temp = Template7.compile(templates['msgSimpleText_from']);
				return temp(iNdata);
			}
	    	_['msgSimpleText_getTemplateByNameFrom'] = msgSimpleText_getTemplateByNameFrom;

			function msgSimpleText_getTemplateByNameTo (iNdata) {
				let temp = Template7.compile(templates['msgSimpleText_to']);
				return temp(iNdata);
			}
	    	_['msgSimpleText_getTemplateByNameTo'] = msgSimpleText_getTemplateByNameTo;

	 	function msgSimpleText_createMsg ( iNdata, iNmyUid, iNchatId ) {
	        var iNneedView = msg_getPathToDomForChat(iNchatId);// "#leftBlockInViewWindow .ChatViewInAppWindow[connect_chatid='"+iNchatId+"']";
	        $( iNneedView ).append( msgSimpleText_getMsg ( iNdata, iNmyUid ) );
		}
	    _['msgSimpleText_createMsg'] = msgSimpleText_createMsg;


		function msgSimpleText_safeReplace ( iNdata, iNmyUid, iNchatId ) {
	        var thisIssetLength = msg_getLength(iNdata, iNchatId);
	        if (thisIssetLength > 0) {
	        	msgSimpleText_replace ( iNdata, iNmyUid, iNchatId );
	        }

		}
	    _['msgSimpleText_safeReplace'] = msgSimpleText_safeReplace;
	    
		    function msgSimpleText_replace ( iNdata, iNmyUid, iNchatId ) {

	        	// update common time
	        	msg_updateDomCommonTimeBlock (iNchatId,iNdata['msgId'],iNdata);

	        	// update content
	        	msgSimpleText_updateContent (iNchatId, iNdata, iNmyUid);
			}
		    _['msgSimpleText_replace'] = msgSimpleText_replace;
	//@>SECTION  'msg simpleText' type = 1  ------------------------------------------------------------------------------------------------------------------------------------------------

	

	//@<SECTION  'msg live audio' type = 20 ------------------------------------------------------------------------------------------------------------------------------------------------
		templates['msgLiveAudio_from'] = `
		   {{commonTimeBlock}}
		   <div class="aCpI_msgLiveAudio_contentAudioInFromMeMessage aCpI_msgLiveAudio_contentOfAudioMessage" onmousemove="aCpI_msgLiveAudio_onHover(event, this)" onmouseout="aCpI_msgLiveAudio_onMouseOut(this)" onclick="aCpI_msgLiveAudio_onClick(event,this)">
		      <div class="aCpI_msgLiveAudio_audioMsgPlayedBlock">
		         <div class="aCpI_msgLiveAudio_playedSpritesInAudioMsg"></div>
		      </div>
		      <div class="aCpI_msgLiveAudio_backgroundForAudioMsg aCpI_msgLiveAudio_backgroundForAudioMsgFromMe"></div>
		      <div class="aCpI_msgLiveAudio_backgroundForAudioMsgOnHover"></div>
		      <div class="aCpI_msgLiveAudio_blockInAudioMsg">
		         <div class="aCpI_msgLiveAudio_iconInAudioMessage"></div>
		         <div class="aCpI_msgLiveAudio_viewWhenUploadingLiveAudioMsg aCpI_fromMeMessage"></div>
		         <div class="aCpI_msgLiveAudio_viewWhenLoadingLiveAudioMsg"></div>
		         <div class="aCpI_msgLiveAudio_controllPlayInAudioMessage" onclick="aCpI_msgLiveAudio_playAudioOnClickBtnPlay(this,event)"></div>
		         <div class="aCpI_msgLiveAudio_controllPauseInAudioMessage" onclick="aCpI_msgLiveAudio_pauseAudioOnClickBtnPause(this,event)"></div>
		         <div class="aCpI_msgLiveAudio_hideAudioBlock">
		            <audio class="audioSrc flagAudioOrVideoElement" onplay="aCpI_msgLiveAudio_onEventPlay(this)" onpause="aCpI_msgLiveAudio_onEventPause(this)" preload="metadata" src="{{url}}" onloadeddata="aCpI_msgLiveAudio_onEventLoadedAudio(this)" ontimeupdate="aCpI_msgLiveAudio_onEventTimeUpdateForAuidioEl(this)"></audio>
		         </div>
		         <div class="aCpI_msgLiveAudio_timeNowInAudioMessage aCpI_msgLiveAudio_timeInAudioMsg"></div>
		         <div class="aCpI_msgLiveAudio_timeAllInAudioMessage aCpI_msgLiveAudio_timeInAudioMsg"></div>
		      </div>
		   </div>
		`;

		templates['msgLiveAudio_to'] = `
			{{commonTimeBlock}}
			<div class="aCpI_msgLiveAudio_contentAudioInToMeMessage aCpI_msgLiveAudio_contentOfAudioMessage" onmousemove="aCpI_msgLiveAudio_onHover(event, this)" onmouseout="aCpI_msgLiveAudio_onMouseOut(this)" onclick="aCpI_msgLiveAudio_onClick(event,this)">
		      <div class="aCpI_msgLiveAudio_audioMsgPlayedBlock">
		         <div class="aCpI_msgLiveAudio_playedSpritesInAudioMsg"></div>
		      </div>
		      <div class="aCpI_msgLiveAudio_backgroundForAudioMsg aCpI_msgLiveAudio_backgroundForAudioMsgToMe"></div>
		      <div class="aCpI_msgLiveAudio_backgroundForAudioMsgOnHover"></div>
		      <div class="aCpI_msgLiveAudio_blockInAudioMsg">
		         <div class="aCpI_msgLiveAudio_iconInAudioMessage"></div>
				 <div class="aCpI_msgLiveAudio_viewWhenUploadingLiveAudioMsg aCpI_toMeMessage"></div>
		         <div class="aCpI_msgLiveAudio_viewWhenLoadingLiveAudioMsg"></div>
		         <div class="aCpI_msgLiveAudio_controllPlayInAudioMessage" onclick="aCpI_msgLiveAudio_playAudioOnClickBtnPlay(this,event)"></div>
		         <div class="aCpI_msgLiveAudio_controllPauseInAudioMessage" onclick="aCpI_msgLiveAudio_pauseAudioOnClickBtnPause(this,event)"></div>
		         <div class="aCpI_msgLiveAudio_hideAudioBlock">
		            <audio class="audioSrc flagAudioOrVideoElement" onplay="aCpI_msgLiveAudio_onEventPlay(this)" onpause="aCpI_msgLiveAudio_onEventPause(this)" preload="metadata" src="{{url}}" onloadeddata="aCpI_msgLiveAudio_onEventLoadedAudio(this)" ontimeupdate="aCpI_msgLiveAudio_onEventTimeUpdateForAuidioEl(this)"></audio>
		         </div>
		         <div class="aCpI_msgLiveAudio_timeNowInAudioMessage aCpI_msgLiveAudio_timeInAudioMsg"></div>
		         <div class="aCpI_msgLiveAudio_timeAllInAudioMessage aCpI_msgLiveAudio_timeInAudioMsg"></div>
		      </div>
		    </div>
		`;

		function  msgLiveAudio_createMsg ( iNdata, iNmyUid, iNchatId ) {
	        var iNneedView = msg_getPathToDomForChat(iNchatId);

	        // add hide class if we has no url
	        if(iNdata['url'])iNdata['hide'] = 1;

	        $( iNneedView ).append( msgLiveAudio_getMsg ( iNdata, iNmyUid ) );
		}
	    _['msgLiveAudio_createMsg'] = msgLiveAudio_createMsg;

    		function msgLiveAudio_getMsg (iNdata,iNmyUid) {
				/*
					@discr

					@inputs
						iNdata -> object
							msgId 		-> string
							state 	    -> object
								sent      -> timestamp
								delivered -> timestamp
								time      -> timestamp
							timeRead 	-> string
							content 	-> string

							@optional
								type		-> string

				*/
				var el = {}, result;
				iNdata['class'] = 'msgTypeLiveAudio';
				if ( iNdata.uid == iNmyUid ) {
					iNdata['fromMe'] 			= 1;
		            iNdata['commonTimeBlock'] 	= msg_getTemplateByNameCommonTimeFromMeBlock(iNdata);
		            iNdata['boxContent'] 		= msgLiveAudio_getTemplateByNameFrom(iNdata);
				}
		        else {
		            iNdata['toMe'] 				= 1;
		            iNdata['commonTimeBlock'] 	= msg_getTemplateByNameCommonTimeToMeBlock(iNdata);
					iNdata['boxContent'] 		= msgLiveAudio_getTemplateByNameTo(iNdata);
		        }
		        return msg_getTemplateByNameBoxForMsg(iNdata);
			}
		    _['msgLiveAudio_getMsg'] = msgLiveAudio_getMsg;

		    function msgLiveAudio_updateContent (iNchatId, iNdata,iNmyUid) {
				/*
					@discr
					@inputs
						iNchatId -> string
						iNdata -> object
							msgId 		-> string
							content 	-> string
						iNmyUid -> string
				*/
				var msgPath = msg_getPathToDomForMsg(iNchatId,iNdata['msgId']);
				$(msgPath + ' .aCpI_msgLiveAudio_hideAudioBlock audio').attr('src', iNdata['content']);
			}

		    	function msgLiveAudio_getTemplateByNameFrom (iNdata) {
					let temp = Template7.compile(templates['msgLiveAudio_from']);
					return temp(iNdata);
				}
		    	_['msgLiveAudio_getTemplateByNameFrom'] = msgLiveAudio_getTemplateByNameFrom;

				function msgLiveAudio_getTemplateByNameTo (iNdata) {
					let temp = Template7.compile(templates['msgLiveAudio_to']);
					return temp(iNdata);
				}
		    	_['msgLiveAudio_getTemplateByNameTo'] = msgLiveAudio_getTemplateByNameTo;

    		function msgLiveAudio_safeReplace ( iNdata, iNmyUid, iNchatId ) {
		        var thisIssetLength = msg_getLength(iNdata, iNchatId);
		        console.log('msgLiveAudio_safeReplace thisIssetLength',thisIssetLength);
		        console.log('msgLiveAudio_safeReplace iNdata, iNmyUid, iNchatId',iNdata, iNmyUid, iNchatId);
		        if (thisIssetLength > 0) {
		        	// create message
		        	msgLiveAudio_replace ( iNdata, iNmyUid, iNchatId );
		        } else {
		        	msgLiveAudio_createMsg ( iNdata, iNmyUid, iNchatId );
		        }
			}
		    _['msgLiveAudio_safeReplace'] = msgLiveAudio_safeReplace;
		    
			    function msgLiveAudio_replace ( iNdata, iNmyUid, iNchatId ) {
			    	/*
			    		  src   

			    		     url -   
			    		   url  
			    	*/
		        	// update common time
		        	msg_updateDomCommonTimeBlock (iNchatId,iNdata['msgId'],iNdata);

		        	if ( iNdata['url'] ) {
		        		//if we has url we show 
		        		msg_dellHideClassByMsgId(iNdata['msgId'])

		        		//if we have not url => we add
		        		if ( !msgLiveAudio_getUrl(iNchatId, iNdata['msgId']) ) {
		        			msgLiveAudio_setUrl(iNchatId, iNdata['msgId'], iNdata['url'] );
		        		}
		        	}
				}
			    _['msgLiveAudio_replace'] = msgLiveAudio_replace;

			    	function msgLiveAudio_getUrl ( iNchatId, iNmsgId ) {
			        	var fullPath = msg_getPathToDomForMsg(iNchatId, iNmsgId);
			        	return $(fullPath + ' audio').attr('src');
			    	}

			    	function msgLiveAudio_setUrl ( iNchatId, iNmsgId, iNurl ) {
			        	var fullPath = msg_getPathToDomForMsg(iNchatId, iNmsgId);
			        	return $(fullPath + ' audio').attr('src',iNurl);
			    	}


		    function msgLiveAudio_showUploadBlock (iNchatId,iNmsgId) {
	    		let selector = msgLiveAudio_getPathToDomForUploadBlock(iNchatId,iNmsgId);
				$(selector).show();
		    }
		    _['msgLiveAudio_showUploadBlock'] = msgLiveAudio_showUploadBlock;

	    	function msgLiveAudio_hideUploadBlock (iNchatId,iNmsgId) {
	    		let selector = msgLiveAudio_getPathToDomForUploadBlock(iNchatId,iNmsgId);
				$(selector).hide();
		    }
		    _['msgLiveAudio_hideUploadBlock'] = msgLiveAudio_hideUploadBlock;

			    	function msgLiveAudio_getPathToDomForUploadBlock (iNchatId,iNmsgId) {
			    		let msgPath = msg_getPathToDomForMsg(iNchatId,iNmsgId);
						return msgPath + ' .aCpI_msgLiveAudio_viewWhenUploadingLiveAudioMsg';
				    }

		    function msgLiveAudio_clearUploadBlock (iNchatId,iNmsgId) {
	    		let selector = msgLiveAudio_getPathToDomForUploadBlock(iNchatId,iNmsgId);
				$(selector).html();
		    }
		    function msgLiveAudio_initLoader (iNchatId, iNmsgId) {
				/*
					@discr
					@inputs
						@required
						@optional

				*/
				msgLiveAudio_showUploadBlock(iNchatId, iNmsgId)
				
				let selector = msgLiveAudio_getPathToDomForUploadBlock(iNchatId, iNmsgId);

				msgLiveAudio_hideUploadBtn(iNchatId, iNmsgId);

		    	return M_PROGRESSBAR.init (selector, 0, 
		    		{
		    			'color' : '#000',
		    		}
	    		);
			}
		    _['msgLiveAudio_initLoader'] = msgLiveAudio_initLoader;

		    function msgLiveAudio_showUploadBtn (iNchatId, iNmsgId) {
				let path = msgLiveAudio_getPathToDomForUploadBlock (iNchatId,iNmsgId);

				msgLiveAudio_clearUploadBlock();

				msgLiveAudio_showUploadBlock();
				$(path).addClass('aCpI_msg_iconUpload');

		    }
		    _['msgLiveAudio_showUploadBtn'] = msgLiveAudio_showUploadBtn;

	    	function msgLiveAudio_hideUploadBtn (iNchatId,iNmsgId) {
				let path = msgLiveAudio_getPathToDomForUploadBlock (iNchatId,iNmsgId);
				$(path).removeClass('aCpI_msg_iconUpload');
		    }

		    function msgLiveAudio_setObserverForUploadBtn (iNchatId,iNmsgId,iNfunctionUploadFile) {
				let path = msgLiveAudio_getPathToDomForUploadBlock (iNchatId,iNmsgId);
				$(path).click(function () {
					if( $(this).hasClass('aCpI_msg_iconUpload') ) {
						// if this is a upload btn
						if(typeof(iNfunctionUploadFile) == 'function') iNfunctionUploadFile();
					}
				});
			}
		    _['msgLiveAudio_setObserverForUploadBtn'] = msgLiveAudio_setObserverForUploadBtn;
	//@SECTION> 'msg live audio' type = 20

	//@<SECTION 'msg live video' type = 21
		templates['msgLiveVideo_from'] = `
		   {{commonTimeBlock}}
		   <div class="aCpI_msgLiveVideo_contentLiveVideoInFromMeMessage">
		      <div class="aCpI_msgLiveVideo_videoMsgContent" onmouseenter="aCpI_msgLiveVideo_onEventMouseEnter(this)" onmouseleave="aCpI_msgLiveVideo_onEventMouseLeave(this)">
		      	 <div class="aCpI_msgLiveVideo_viewWhenUploadingVideoLiveMsg aCpI_fromMeMessage aCpI_msg_iconUpload"></div>
		      	 <div class='aCpI_msgLiveVideo_viewWhenLoadingVideoLiveMsg'></div>
		      	 <div class='aCpI_msgLiveVideo_msgNowVideoTime'></div>
		         <div class="aCpI_msgLiveVideo_backgroundPlayVideoOnHover aCpI_msgLiveVideo_backgroundVideoOnHover" onclick='aCpI_msgLiveVideo_onEventClickForBackground(this)'></div>
		         <!-- <div class="aCpI_msgLiveVideo_backgroundPauseVideoOnHover aCpI_msgLiveVideo_backgroundVideoOnHover"></div> -->
		         <video preload="metadata" ontimeupdate='aCpI_msgLiveVideo_onEventTimeUpdateVideo(this)' onloadeddata='aCpI_msgLiveVideo_onEventLoadedDataVideo(this)' onplay='aCpI_msgLiveVideo_onEventPlayVideo(this)' onpause='aCpI_msgLiveVideo_onEventPauseVideo(this)' src="{{url}}" class="liveVideoSrc"></video>
		      </div>
		   </div>
		`;

		templates['msgLiveVideo_to'] = `
		   {{commonTimeBlock}}
		   <div class="aCpI_msgLiveVideo_contentLiveVideoInToMeMessage">
		      <div class="aCpI_msgLiveVideo_videoMsgContent" onmouseenter="aCpI_msgLiveVideo_onEventMouseEnter(this)" onmouseleave="aCpI_msgLiveVideo_onEventMouseLeave(this)">
		      	 <div class="aCpI_msgLiveVideo_viewWhenUploadingVideoLiveMsg aCpI_toMeMessage aCpI_msg_iconUpload"></div>
		      	 <div class='aCpI_msgLiveVideo_viewWhenLoadingVideoLiveMsg'></div>
		      	 <div class='aCpI_msgLiveVideo_msgNowVideoTime'></div>
		         <div class="aCpI_msgLiveVideo_backgroundPlayVideoOnHover aCpI_msgLiveVideo_backgroundVideoOnHover" onclick='aCpI_msgLiveVideo_onEventClickForBackground(this)'></div>
		         <!-- <div class="aCpI_msgLiveVideo_backgroundPauseVideoOnHover aCpI_msgLiveVideo_backgroundVideoOnHover"></div> -->
		         <video preload="metadata" ontimeupdate='aCpI_msgLiveVideo_onEventTimeUpdateVideo(this)' onloadeddata='aCpI_msgLiveVideo_onEventLoadedDataVideo(this)' onplay='aCpI_msgLiveVideo_onEventPlayVideo(this)' onpause='aCpI_msgLiveVideo_onEventPauseVideo(this)' src="{{url}}" class="liveVideoSrc"></video>
		      </div>
		   </div>
		`;

		function  msgLiveVideo_createMsg ( iNdata, iNmyUid, iNchatId ) {
	        var iNneedView = msg_getPathToDomForChat(iNchatId);

	        // add hide class if we has no url
	        if(iNdata['url'])iNdata['hide'] = 1;

	        $( iNneedView ).append( msgLiveVideo_getMsg ( iNdata, iNmyUid ) );
		}
	    _['msgLiveVideo_createMsg'] = msgLiveVideo_createMsg;

    		function msgLiveVideo_getMsg (iNdata,iNmyUid) {
				/*
					@discr

					@inputs
						iNdata -> object
							msgId 		-> string
							state 	    -> object
								sent      -> timestamp
								delivered -> timestamp
								time      -> timestamp
							timeRead 	-> string
							content 	-> string

							@optional
								type		-> string

				*/
				var el = {}, result;
				iNdata['class'] = 'msgTypeLiveVideo';
				if ( iNdata.uid == iNmyUid ) {
					iNdata['fromMe'] 			= 1;
		            iNdata['commonTimeBlock'] 	= msg_getTemplateByNameCommonTimeFromMeBlock(iNdata);
		            iNdata['boxContent'] 		= msgLiveVideo_getTemplateByNameFrom(iNdata);
				}
		        else {
		            iNdata['toMe'] 				= 1;
		            iNdata['commonTimeBlock'] 	= msg_getTemplateByNameCommonTimeToMeBlock(iNdata);
					iNdata['boxContent'] 		= msgLiveVideo_getTemplateByNameTo(iNdata);
		        }
		        return msg_getTemplateByNameBoxForMsg(iNdata);
			}
		    _['msgLiveVideo_getMsg'] = msgLiveVideo_getMsg;

		    function msgLiveVideo_updateContent (iNchatId, iNdata,iNmyUid) {
				/*
					@discr
					@inputs
						iNchatId -> string
						iNdata -> object
							msgId 		-> string
							content 	-> string
						iNmyUid -> string
				*/
				var msgPath = msg_getPathToDomForMsg(iNchatId,iNdata['msgId']);
				$(msgPath + ' .aCpI_msgLiveVideo_videoMsgContent video').attr('src', iNdata['content']);
			}

		    	function msgLiveVideo_getTemplateByNameFrom (iNdata) {
					let temp = Template7.compile(templates['msgLiveVideo_from']);
					return temp(iNdata);
				}
		    	_['msgLiveVideo_getTemplateByNameFrom'] = msgLiveVideo_getTemplateByNameFrom;

				function msgLiveVideo_getTemplateByNameTo (iNdata) {
					let temp = Template7.compile(templates['msgLiveVideo_to']);
					return temp(iNdata);
				}
		    	_['msgLiveVideo_getTemplateByNameTo'] = msgLiveVideo_getTemplateByNameTo;

    		function msgLiveVideo_safeReplace ( iNdata, iNmyUid, iNchatId ) {
		        var thisIssetLength = msg_getLength(iNdata, iNchatId);
		        if (thisIssetLength > 0) {
		        	// create message
		        	msgLiveVideo_replace ( iNdata, iNmyUid, iNchatId );
		        } else {
		        	msgLiveVideo_createMsg ( iNdata, iNmyUid, iNchatId );
		        }
			}
		    _['msgLiveVideo_safeReplace'] = msgLiveVideo_safeReplace;
		    
			    function msgLiveVideo_replace ( iNdata, iNmyUid, iNchatId ) {
		        	// update common time
		        	msg_updateDomCommonTimeBlock (iNchatId, iNdata['msgId'], iNdata);


					console.log("msgLiveVideo_replace - iNdata['url']", iNdata['url'] );
		        	if ( iNdata['url'] ) {
						//if we has url we show 
						msg_dellHideClassByMsgId(iNdata['msgId'])

						//if we have not url => we add
						console.log("msgLiveVideo_replace - msgLiveVideo_getUrl(iNchatId, iNdata['msgId'])",msgLiveVideo_getUrl(iNchatId, iNdata['msgId']));
						if ( !msgLiveVideo_getUrl(iNchatId, iNdata['msgId']) ) {
							msgLiveVideo_setUrl(iNchatId, iNdata['msgId'], iNdata['url'] );
						}
					}

		        	// update content NOT NEED -> we never change src of video el
		        	// msgLivVideo_updateContent (iNchatId, iNdata, iNmyUid);
				}
			    _['msgLiveVideo_replace'] = msgLiveVideo_replace;

			    	function msgLiveVideo_getUrl (iNchatId, iNmsgId) {
			        	var fullPath = msg_getPathToDomForMsg(iNchatId, iNmsgId);
			        	return $(fullPath + ' video').attr('src');
			    	}
			    	function msgLiveVideo_setUrl (iNchatId, iNmsgId, iNurl) {
						var fullPath = msg_getPathToDomForMsg(iNchatId, iNmsgId);
						return $(fullPath + ' video').attr('src',iNurl);
					}


		    function msgLiveVideo_showUploadBlock (iNchatId,iNmsgId) {
	    		let selector = msgLiveVideo_getPathToDomForUploadBlock(iNchatId,iNmsgId);
				$(selector).show();
		    }
		    _['msgLiveVideo_showUploadBlock'] = msgLiveVideo_showUploadBlock;

	    	function msgLiveVideo_hideUploadBlock (iNchatId,iNmsgId) {
	    		let selector = msgLiveVideo_getPathToDomForUploadBlock(iNchatId,iNmsgId);
				$(selector).hide();
		    }
		    _['msgLiveVideo_hideUploadBlock'] = msgLiveVideo_hideUploadBlock;

			    	function msgLiveVideo_getPathToDomForUploadBlock (iNchatId,iNmsgId) {
			    		let msgPath = msg_getPathToDomForMsg(iNchatId,iNmsgId);
						return msgPath + ' .aCpI_msgLiveVideo_viewWhenUploadingVideoLiveMsg';
				    }

		    function msgLiveVideo_clearUploadBlock (iNchatId,iNmsgId) {
	    		let selector = msgLiveVideo_getPathToDomForUploadBlock(iNchatId,iNmsgId);
				$(selector).html();
		    }
		    function msgLiveVideo_initLoader (iNchatId, iNmsgId) {
				/*
					@discr
					@inputs
						@required
						@optional

				*/
				msgLiveVideo_showUploadBlock(iNchatId, iNmsgId)
				
				let selector = msgLiveVideo_getPathToDomForUploadBlock(iNchatId, iNmsgId);

				msgLiveVideo_hideUploadBtn(iNchatId, iNmsgId);

		    	return M_PROGRESSBAR.init (selector, 0, 
		    		{
		    			'color' : '#000',
		    		}
	    		);
			}
		    _['msgLiveVideo_initLoader'] = msgLiveVideo_initLoader;

		    function msgLiveVideo_showUploadBtn (iNchatId, iNmsgId) {
				let path = msgLiveVideo_getPathToDomForUploadBlock (iNchatId,iNmsgId);

				msgLiveVideo_clearUploadBlock();

				msgLiveVideo_showUploadBlock();
				$(path).addClass('aCpI_msg_iconUpload');

		    }
		    _['msgLiveVideo_showUploadBtn'] = msgLiveVideo_showUploadBtn;

	    	function msgLiveVideo_hideUploadBtn (iNchatId,iNmsgId) {
				let path = msgLiveVideo_getPathToDomForUploadBlock (iNchatId,iNmsgId);
				$(path).removeClass('aCpI_msg_iconUpload');
			}

			function msgLiveVideo_setObserverForUploadBtn (iNchatId,iNmsgId,iNfunctionUploadFile) {
				let path = msgLiveVideo_getPathToDomForUploadBlock (iNchatId,iNmsgId);
				$(path).click(function () {
					if( $(this).hasClass('aCpI_msg_iconUpload') ) {
						// if this is a upload btn
						if(typeof(iNfunctionUploadFile) == 'function') iNfunctionUploadFile();
					}
				});
			}
		    _['msgLiveVideo_setObserverForUploadBtn'] = msgLiveVideo_setObserverForUploadBtn;

		//@< controller 'record' msgLiveVideo 
			function msgLiveVideo_record_showStreamVideoViewer () {
				$('.aCpI_streamVideo').css('display','flex');
			}
			_['msgLiveVideo_record_showStreamVideoViewer'] = msgLiveVideo_record_showStreamVideoViewer;

			function msgLiveVideo_record_startStreamVideoCountdownTimer (iNcallbackFunction) {
				$('.aCpI_videoStreamTimeCounter').show();
				msgLiveVideo_record_clearStreamVideoCountdownTimer();
				$('.aCpI_videoStreamTimeCounter').countdown (
					{
						until: 5, // second
						description: '',
						onExpiry: function () { 
							$(this).hide();
							if(typeof iNcallbackFunction == 'function' ) iNcallbackFunction (); 
						}, 
						layout: '{sn}' // NOT 03 to 3
					}
				);

			}
			_['msgLiveVideo_record_startStreamVideoCountdownTimer'] = msgLiveVideo_record_startStreamVideoCountdownTimer;


			function msgLiveVideo_record_clearStreamVideoCountdownTimer (iNcallbackFunction) {
				$('.aCpI_videoStreamTimeCounter').countdown ( 'destroy' );

			}
			_['msgLiveVideo_record_clearStreamVideoCountdownTimer'] = msgLiveVideo_record_clearStreamVideoCountdownTimer;


			function msgLiveVideo_record_hideStreamVideoViewer () {
				$('.aCpI_streamVideo').css('display','none');
			}
			_['msgLiveVideo_record_hideStreamVideoViewer'] = msgLiveVideo_record_hideStreamVideoViewer;

			function msgLiveVideo_record_removeStreamVideoElement () {
				$('.aCpI_streamVideo > video').remove();
			}
			function msgLiveVideo_record_setStreamVideoElement (iNstream) {
				msgLiveVideo_record_removeStreamVideoElement();

				var video = document.createElement('video'),
					videosContainer = $('.aCpI_streamVideo').get(0);

	                video = msgLiveVideo_record_mergeProps(video, {
	                    // controls: true,
	                    class: 'aCpI_videoStreamElement',
	                    muted: true
	                });
	                video.srcObject = iNstream;
	                video.play();
	                videosContainer.appendChild(video);
			}
			_['msgLiveVideo_record_setStreamVideoElement'] = msgLiveVideo_record_setStreamVideoElement;

				
				//@< copy from res/js/recorder/mediaStreamRecorder/MediaStreamRecorder.js
					// Merge all other data-types except "function"
					function msgLiveVideo_record_mergeProps(mergein, mergeto) {
						// create video el
					    for (var t in mergeto) {
					        if (typeof mergeto[t] !== 'function') {
					            mergein[t] = mergeto[t];
					        }
					    }
					    return mergein;
					}
				//@> copy from res/js/recorder/mediaStreamRecorder/MediaStreamRecorder.js
		//@> controller 'record' msgLiveVideo ------------------------------------------------------------------------------------------------------------------------------------------------ 

	//@SECTION> 'msg live video' type = 21

	





	CONST['domPathToMsgCounter'] = '#senderBlockInViewBlock .counterInChatId';


	function plusNewMsgCounter (iNchatId,iNnumber) {
		/*
			@discr
				plus number (by default 1) from new msg counter block
			@inputs
				@required
					iNchatId -> string

		*/
		if(typeof iNnumber != 'number') iNnumber = 1;
		let msgCountNumber = getNewMsgCounter(iNchatId) + iNnumber;
		changeNewMsgCounter (iNchatId,msgCountNumber);
		return msgCountNumber;
	}
	_['plusNewMsgCounter'] = plusNewMsgCounter;

	function getNewMsgCounter (iNchatId) {
		/*
			@discr
				get number from new msg counter block
			@inputs
				@required
					iNchatId -> string

		*/
		let path = CONST['domPathToMsgCounter'];
		let intFrom = parseInt($(path).html())||0
		return intFrom;
	}
	_['getNewMsgCounter'] = getNewMsgCounter;

	function changeNewMsgCounter (iNchatId,iNnumber) {
		/*
			@discr
				change content in new msg counter block
			@inputs
				@required
					iNchatId -> string
					iNnumber -> int

		*/
		let path = CONST['domPathToMsgCounter'];
		$(path).attr('connect_chatid',iNchatId);
		$(path).html(iNnumber)
	}
	_['changeNewMsgCounter'] = changeNewMsgCounter;

	function showNewMsgCounter () {
		/*
			@discr
				show new msg counter block
			@inputs
				@required

		*/
		let path = CONST['domPathToMsgCounter'];
		$(path).fadeIn (500);
	}
	_['showNewMsgCounter'] 	= showNewMsgCounter;

	function hideNewMsgCounter () {
		/*
			@discr
				hide nem msg counter block
			@inputs
				@required

		*/
		let path = CONST['domPathToMsgCounter'];
		$(path).hide();
	}
	_['hideNewMsgCounter'] 	= hideNewMsgCounter;



	

	function msg_getLastMsg (iNdata) {
		/*
			@discr
				hide nem msg counter block
			@inputs
				@required
					iNdata
						lmsgType
						lmsgText
						lmsgTime
						lmsgUid

						chatId
						chatType

		*/
		var lmsgType 	= iNdata['lmsgType'],
			lmsgText 	= iNdata['lmsgText'],
			lmsgTime 	= iNdata['lmsgTime'],
			lmsgUid 	= iNdata['lmsgUid'],
			result;

		switch (lmsgType) {
			case 1: // simple text
				result =  lmsgText;
			break;

			case 20: // liveAudio
				result = DICTIONARY.withString('[dictionary-audio]');
			break;

			case 21: // liveVideo
				result = DICTIONARY.withString('[dictionary-video]');
			break;
		}
		return result;
	}
	_['msg_getLastMsg'] 	= msg_getLastMsg;

	function msg_getPathToDomForMessages (iNchatId) {
        return msg_getPathToDomForChat(iNchatId) + " .messagesInChatView";

    }
    _['msg_getPathToDomForMessages'] = msg_getPathToDomForMessages;

    function getMessagesDomObjectByChatId (iNchatId,iNextra) {
    	var msgPath = msg_getPathToDomForMessages(iNchatId);
    	if (typeof iNextra == 'string')  msgPath = msgPath + iNextra;
        return $( msgPath );
	}
    _['getMessagesDomObjectByChatId'] = getMessagesDomObjectByChatId;


    function msg_getDomElForChat (iNchatId) {
        return $( msg_getPathToDomForChat(iNchatId) );

    }
    _['msg_getDomElForChat'] = msg_getDomElForChat;

    function msg_getLength ( iNdata, iNchatId ) {
        // var iNneedView = msg_getPathToDomForChat(iNchatId);
        //"#leftBlockInViewWindow .ChatViewInAppWindow[connect_chatid='"+iNchatId+"']";
        var fullPath = msg_getPathToDomForMsg (iNchatId,iNdata['msgId']);//iNneedView + " .messagesInChatView[connect_msg='"+iNdata['msgId']+"']";
        return $( fullPath ).length;
	}
    _['msg_getLength'] = msg_getLength;

   



  	function initApp (iNdata) {
  		/*
  			@disct
  				active acrtions for click events (send button, keyup for flesh msg)
			@inputs
				@required
					iNdata
						simpleMsgText_onClickSendBtn -> function
						simpleMsgText_printing -> function

  		*/
  		if ( typeof iNdata['simpleMsgText_onClickSendBtn'] == 'function') {
  			// if value is empty
  			$('#sendTextButtonInSenderBlock').off();

  			$('#sendTextButtonInSenderBlock').click(function (e) {
  				var value =  $('#forTextInputInSenderBlock textarea').val();
  				if(value == '') return true;
			    iNdata['simpleMsgText_onClickSendBtn'](e);
			    $('#forTextInputInSenderBlock textarea').val('');
			    effChatViewScrollToBotSafe();
  			});

  			

  		}
  		$('.buttonChatToBottom').click( 
			function () {
				$('#leftBlockInViewWindow').scrollBot(0);
			} 
		);

		$("#forTextInputInSenderBlock textarea").keydown( function(e) { 
	    var code = e.which; // recommended to use e.which, it's normalized across browsers


	    
	    if (code==13) {
	    	e.preventDefault();
	    	$('#sendTextButtonInSenderBlock').trigger('click');
	    }
		}).keyup(function (e) {
			var code = e.which; // recommended to use e.which, it's normalized across browsers

			


		    if (code==13) {
		    	e.preventDefault();
		    } else {

		    	// hide/show live msg video&audio button / simple text send btn
		    	var lengthInSimpleMsgTextarea = getContentLengthFromMsgSenderBlock ();
				if( lengthInSimpleMsgTextarea > 0) {
			    	// view send simple text btn HIDE other
			    	smartShowLiveBtnTextMsg();

			    } else {
			    	// view live send button for msg video AND audio HIDE other
			    	smartShowLiveBtnsAudioVideoMsg();
			    }
			    // send flash message when printing simpe msg text
		    	iNdata['simpleMsgText_printing']();
		    }
		});

  		setJsHoverEffectsForCancelBtnForLiveMsgAtMsgSendBlock();
  	}
    _['initApp'] = initApp;



    //@< msg canceling buttons & effects
    	function setJsHoverEffectsForCancelBtnForLiveMsgAtMsgSendBlock () {
    		$('.cancelBtnInMsgSenderButton').hover(
    			function () {
    				$(this).addClass('hover');
    			},
    			function () {
    				$(this).removeClass('hover');
				}
			);
    	}

    	function smartShowCancelBlockForLiveMsgAtMsgSenderBlock (iNtype) {
    		hideEffCancelingAllAnimationsSendingAtMsgSenderBlock();

    		showEffCancelingBlockSendingForLiveMsgAtMsgSenderBlock();


    		if(iNtype == 'audio')
    			showEffCancelingAudioAnimationSendingForLiveMsgAtMsgSenderBlock();
    		else if (iNtype == 'video') 
    			showEffCancelingVideoAnimationSendingForLiveMsgAtMsgSenderBlock();
    		// hide after view
    		setTimeout(
			()=>{
    			if(iNtype == 'audio')
    				hideEffCancelingAudioAnimationSendingForLiveMsgAtMsgSenderBlock();
    			else if (iNtype == 'video') 
    				hideEffCancelingVideoAnimationSendingForLiveMsgAtMsgSenderBlock();
    		},750);
    	}






    	function showEffCancelingBlockSendingForLiveMsgAtMsgSenderBlock () {
    		$('.chatBlockInViewBlock .effectsForCancelling').show();
    	}
    	function hideEffCancelingBlockSendingForLiveMsgAtMsgSenderBlock () {
    		$('.chatBlockInViewBlock .effectsForCancelling').hide();
    	}
	    	function hideEffCancelingAllAnimationsSendingAtMsgSenderBlock () {
	    		$('.effectsForCancelling .effectsFlag').hide();
	    	}
	    	// audio
	    	function showEffCancelingAudioAnimationSendingForLiveMsgAtMsgSenderBlock () {
	    		$('.effectsForCancelling .cancellingAudio').show();
	    	}
	    	function hideEffCancelingAudioAnimationSendingForLiveMsgAtMsgSenderBlock () {
	    		$('.effectsForCancelling .cancellingAudio').hide();
	    	}
	    	// video
	    	function showEffCancelingVideoAnimationSendingForLiveMsgAtMsgSenderBlock () {
	    		$('.effectsForCancelling .cancellingVideo').show();
	    	}
	    	function hideEffCancelingVideoAnimationSendingForLiveMsgAtMsgSenderBlock () {
	    		$('.effectsForCancelling .cancellingVideo').hide();
	    	}

    	function showEffCancelSendingForLiveMsgAtMsgSenderBlock () {
    		$('.chatBlockInViewBlock .cancelBtnInMsgSenderButton').show();
    	}
    	function hideEffCancelSendingForLiveMsgAtMsgSenderBlock () {
    		$('.chatBlockInViewBlock .cancelBtnInMsgSenderButton').hide();
    	}
    //@> msg canceling buttons  & effects

    //@< msg send buttons
    	function onSpecialClickForSendLiveAudioOrVideo (iNeffectType,iNdata) {
    		/*
    			@discr
    				btn for send live audio and video effects
    			@inputs
    				iNeffectType -> string (audio|video)
    				iNdata -> object
    					onStart 	-> function
    					onDelete 	-> function
    					onSend 		-> function
    					onOff 		-> function
    					defaultState -> bool
    					onTimerTick -> function 
    						onTimerTick (iNperiod)
    							iNperiod - > array
    								iNperiod[6] -> seconds
    								iNperiod[5] -> minutes
			*/
    		var effType = iNeffectType;
    		var objForSpecialClick = {};
    			//@< active effects
    			var flagDefaultWork = true;
				if ( typeof iNdata['defaultState'] == 'boolean' ) {
    				flagDefaultWork = iNdata['defaultState'];
    			}
    			//@> active effects
    			// click
    			var startMsgRecoding = false;
    			var intervalId 		= null;
    			var deleteThisMsg 	= true;
    			var timerFromStartRecordingMessage = 0;

    			objForSpecialClick['down'] = () => {
				// we mouse btn down insed element
					if(!flagDefaultWork)  {
						if(typeof iNdata['onOff'] == 'function') iNdata['onOff']();
						return;
					}
    				startMsgRecoding = false;
    				deleteThisMsg = true;
    				intervalId = setTimeout(()=>{
    					startMsgRecoding = true;
    					// show timer
    					if(effType == 'audio') {
    						smartStartRecodingTimerAtMsgButton('audio',iNdata.onTimerTick);
						
	    					timerFromStartRecordingMessage = MOMENT().getNowTime(); //

		    				if(typeof iNdata['onStart'] == 'function') iNdata['onStart']();
    					} else if (effType == 'video') {

    						msgLiveVideo_record_startStreamVideoCountdownTimer (
    							() => {
    								smartStartRecodingTimerAtMsgButton('video',iNdata.onTimerTick);
    								timerFromStartRecordingMessage = MOMENT().getNowTime(); //
									if(typeof iNdata['onStartVideoRecord'] == 'function') iNdata['onStartVideoRecord']();
								}
							);
							if(typeof iNdata['onStart'] == 'function') iNdata['onStart']();
							return;
						}
    				},150);
    			}

    			$('.cancelBtnInMsgSenderButton').mouseup( () => {
    				if(!flagDefaultWork)  {
						if(typeof iNdata['onOff'] == 'function') iNdata['onOff']();
						return;
					}
    				deleteThisMsg = false;
    			});

    			objForSpecialClick['up'] = (state) => {
    				if(!flagDefaultWork)  {
						if(typeof iNdata['onOff'] == 'function') iNdata['onOff']();
						return;
					}
					clearTimeout (intervalId);
					msgLiveVideo_record_clearStreamVideoCountdownTimer ();
    				if(startMsgRecoding !== true) {
    					// if does not 150 ms since first click -> we swiftch buttons 
    					smartSwitchLiveAudioVideoMsgButtons();
    				} else {
    					var timeWhenMouseUp = MOMENT().getNowTime(); //
    					var passedTimeFromStartRecordToMouseUp = timeWhenMouseUp - timerFromStartRecordingMessage;
    					// stop timer
						stopRecordingTimer();

    					// we send msg if 
    					if (timerFromStartRecordingMessage != 0 && passedTimeFromStartRecordToMouseUp > 500 && deleteThisMsg) {
    						// we send message
	    					if(typeof iNdata['onSend'] == 'function') iNdata['onSend']();
    					}else {
						// we delete message

    						// show caceling audion effects
    						if(effType == 'audio') {
	    						smartShowCancelBlockForLiveMsgAtMsgSenderBlock(effType);
	    					} else if (effType == 'video') {
	    						smartShowCancelBlockForLiveMsgAtMsgSenderBlock(effType);
							}



	    					if(typeof iNdata['onDelete'] == 'function') iNdata['onDelete']();
    					}
    					smartHideTimerBlockAtMsgSendButton();
					}
    				
    			}
			if(effType == 'audio') {
    			$('#sendLiveAudioButtonInSenderBlock').specialClick(objForSpecialClick);
			} else if (effType == 'video') {
    			$('#sendLiveVideoButtonInSenderBlock').specialClick(objForSpecialClick);
			}

			var off = () => {
				flagDefaultWork = false;
			}

			var on = ()  => {
				flagDefaultWork = true;
			} 

			return {on:on, off:off};
    	}
    	_['onSpecialClickForSendLiveAudioOrVideo'] = onSpecialClickForSendLiveAudioOrVideo;
    		
    	function onceMouseDownForAudioLiveRecord (iNfunction) {
    		$('#sendLiveAudioButtonInSenderBlock').mousedown(iNfunction);
    	}
    	_['onceMouseDownForAudioLiveRecord'] = onceMouseDownForAudioLiveRecord;
    	
    	function onceMouseDownForVideoLiveRecord (iNfunction) {
    		$('#sendLiveVideoButtonInSenderBlock').mousedown(iNfunction);
    	}
    	_['onceMouseDownForVideoLiveRecord'] = onceMouseDownForVideoLiveRecord;


    	function smartSwitchLiveAudioVideoMsgButtons () {
    		if($('#sendLiveVideoButtonInSenderBlock').hasClass('hideHalfSendMsgButton')) {
    			showOnlyHalfLiveAudioMsgButton();
    		}else {
    			showOnlyHalfLiveVideoMsgButton();
    		}
    	}
    	function smartShowLiveBtnsAudioVideoMsg () {
    		hideLiveBtnTextMsg();
    		showLiveVideoMsgButton();
    		showLiveAudioMsgButton();
    		// showLiveAllIconAtMsgSenderBlock();
    	}
	    	function showLiveVideoMsgButton () {
	    		$('#sendLiveVideoButtonInSenderBlock').show();
	    	}
	    	function hideLiveVideoMsgButton () {
	    		$('#sendLiveVideoButtonInSenderBlock').hide();
	    	}
	    	function showOnlyHalfLiveVideoMsgButton () {
	    		removeClass_hideHalf();
	    		$('#sendLiveVideoButtonInSenderBlock').addClass('hideHalfSendMsgButton');
	    	}

	    	function showLiveAudioMsgButton () {
	    		$('#sendLiveAudioButtonInSenderBlock').show();
	    	}
	    	function hideLiveAudioMsgButton () {
	    		$('#sendLiveAudioButtonInSenderBlock').hide();
	    	}
	    	function showOnlyHalfLiveAudioMsgButton () {
	    		removeClass_hideHalf();
	    		$('#sendLiveAudioButtonInSenderBlock').addClass('hideHalfSendMsgButton');
	    	}
	    		function removeClass_hideHalf () {
		    		$('.sendMsgButtons').removeClass('hideHalfSendMsgButton');
		    	}
    		

    		function hideAllBtnMsgSender () {
    			$('.sendMsgButtons').hide();
    		}	
    	function smartShowLiveBtnTextMsg () {
    		hideAllBtnMsgSender();
    		// hideLiveVideoMsgButton();
    		// hideLiveAudioMsgButton();
    		showLiveBtnTextMsg();
    	}
	    	function showLiveBtnTextMsg () {
	    		$('#sendTextButtonInSenderBlock').show();
	    	}
	    	function hideLiveBtnTextMsg () {
	    		$('#sendTextButtonInSenderBlock').hide();
	    	}
    //@> msg send buttons

    //@< msg timer in sender buttons 
    	function smartStartRecodingTimerAtMsgButton (iNtype,oNtick) {
    		/*
    			@inputs
    				@required
    					iNtype -> string (audio|video) 
    					oNtick -> function
    						oNtick(periods)
    							periods -> array
    								periods[6]
    		*/
    		showTimerBlockAtMsgSendButton();
    		hideLiveAllIconAtMsgSenderBlock();

    		if(iNtype == 'audio')
    			showAudioLiveIconAtMsgSenderBlock();
    		else if(iNtype == 'video')
    			showVideoLiveIconAtMsgSenderBlock();

    		//cancel buttons&effect
    		showEffCancelSendingForLiveMsgAtMsgSenderBlock();
    		// stop previos time if it work
			stopRecordingTimer();
    		$('.timerInMsgSenderBlock span').countdown({since: 0, compact: true, format: 'MS', description: '', onTick: oNtick});
    	}

    	function stopRecordingTimer () {
    		$('.timerInMsgSenderBlock span').countdown('destroy');
		}




    	function smartHideTimerBlockAtMsgSendButton () {
    		//hide timer block
    		hideTimerBlockAtMsgSendButton();
    		// hide cacell button
    		hideEffCancelSendingForLiveMsgAtMsgSenderBlock();
    	}

    	function showTimerBlockAtMsgSendButton () {
    		$('.timerInMsgSenderBlock').show();
    	}
    	function hideTimerBlockAtMsgSendButton () {
    		// hide time
    		$('.timerInMsgSenderBlock').hide();
    		// hide cance btn
    		hideEffCancelSendingForLiveMsgAtMsgSenderBlock();
    	}

    		function hideLiveAllIconAtMsgSenderBlock  () {
	    		$('.timerInMsgSenderBlock div').hide();
	    	}
	    	function showLiveAllIconAtMsgSenderBlock  () {
	    		$('.timerInMsgSenderBlock div').show();
	    	}

	    	function showAudioLiveIconAtMsgSenderBlock  () {
	    		$('.audioTimerInMsgSenderBlock').show();
	    	}
	    	function hideAudioLiveIconAtMsgSenderBlock  () {
	    		$('.audioTimerInMsgSenderBlock').hide();
	    	}

	    	function showVideoLiveIconAtMsgSenderBlock  () {
	    		$('.videoTimerInMsgSenderBlock').show();
	    	}
	    	function hideVideoLiveIconAtMsgSenderBlock  () {
	    		$('.videoTimerInMsgSenderBlock').hide();
	    	}


    //@> msg timer in sender buttons 



    function getContentFromMsgSenderBlock () {
		return $('#forTextInputInSenderBlock textarea').val()
	}
	_['getContentFromMsgSenderBlock'] = getContentFromMsgSenderBlock;

	function getContentLengthFromMsgSenderBlock () {
		return $('#forTextInputInSenderBlock textarea').val().length;
	}
	_['getContentLengthFromMsgSenderBlock'] = getContentLengthFromMsgSenderBlock;



	function msgSimpleText_setObserverForViewMsgInVisualScrollByChatId (iNchatId, iNdata ) {
		let object = getMessagesDomObjectByChatId(iNchatId,'.toMeMessageInChatView');

		object.appearByEach(
			iNdata['success'],
			{
				'scroll-window'		:'#leftBlockInViewWindow',
				'my-filter-window'	: msg_getPathToDomForChat(iNchatId),
				'checkForAddClass'	: (iNobject) => {
					return !$(iNobject).attr('time-read');
				},
				'checkForRemoveClass'	: (iNobject) => {
					return $(iNobject).attr('time-read');
				},
				'onScrollParent'	: (iNobject) => {
					if( $(iNobject).scrollBot() > $(iNobject).height() / 2 ) {
					 	// show button if not button
						$('.buttonChatToBottom').show();
						if(typeof iNdata['onScrollParentTrue'] == 'function')  iNdata['onScrollParentTrue']();
					} else {
						// show button if not button
						$('.buttonChatToBottom').hide();
						if(typeof iNdata['onScrollParentFalse'] == 'function') iNdata['onScrollParentFalse'](iNchatId);
					}
				}
			}
		);//'.ChatViewInAppWindow'
	}
	_['msgSimpleText_setObserverForViewMsgInVisualScrollByChatId'] = msgSimpleText_setObserverForViewMsgInVisualScrollByChatId;



	//<CHAT VIEW DUPLICATE
		function effChatViewScrollToBotWithTimeOut (iNfunctionSuccess, iNfunctionError) {
			clearTimeout(window['connectVarMenuScrollInMenuView']);
			window['connectVarMenuScrollInMenuView'] = setTimeout(  () => {
			 	effChatViewScrollToBotSafe (iNfunctionSuccess,iNfunctionError);
			},10);
		}
		_['effChatViewScrollToBotWithTimeOut'] = effChatViewScrollToBotWithTimeOut;


		function effChatViewScrollToBotSafe (iNfunctionSuccess,iNfunctionError) {
			// if we don'see this chat block
			if( $('.ChatViewInAppWindow:visible').length < 1 ) return false;
			var scrollHeightSize =  $('#leftBlockInViewWindow').height() / 2 + 200
			if (  
				!( $('#leftBlockInViewWindow').scrollBot() >  scrollHeightSize  ) ||
				$('#leftBlockInViewWindow').scrollTop() == 0
			) {
				V_APP.delLoaderInAppView()
			 	// show button if not button
			 	V_APP.effScrollToButtom ('#leftBlockInViewWindow',0);
			 	if ( typeof iNfunctionSuccess == 'function' ) 	iNfunctionSuccess ();
			} else {
				if ( typeof iNfunctionError == 'function' ) 	iNfunctionError ();
			}
		}
		_['effChatViewScrollToBotSafe'] = effChatViewScrollToBotSafe;
	//<CHAT VIEW DUPLICATE













	///
	///
		//@< global
			function msg_pauseAllOtherPlayingAudioOrVideoEl () {
				$('.flagForSearchPlayingAudioOrVideo').each(
					function (i,thisEl)  {
						$(this).get(0).pause()
					}
				);
			}
			window.aCpI_msg_pauseAllOtherPlayingAudioOrVideoEl = msg_pauseAllOtherPlayingAudioOrVideoEl;
			_['msg_pauseAllOtherPlayingAudioOrVideoEl'] = msg_pauseAllOtherPlayingAudioOrVideoEl;
		//@> global

		//@< codeKey = appChatPageIndex - aCpI 'audioLiveMsg'
			function aCpI_msgLiveAudio_onEventLoadedAudio (iNthis) {

				// parent blockInAudioMsg
				let parentBlockInAudioMsg = $(iNthis).closest('.aCpI_msgLiveAudio_blockInAudioMsg');
				// hide loader
				parentBlockInAudioMsg.find('.aCpI_msgLiveAudio_viewWhenLoadingLiveAudioMsg').hide();
				// view play btn
				parentBlockInAudioMsg.find('.aCpI_msgLiveAudio_controllPlayInAudioMessage').show();

				// set now time
				aCpI_msgLiveAudio_setNowTextTimeForAudioNow (iNthis);

				// set duration
				aCpI_msgLiveAudio_setDurationTextTimeForAudioNow (iNthis);
			}
			window.aCpI_msgLiveAudio_onEventLoadedAudio = aCpI_msgLiveAudio_onEventLoadedAudio;

				function aCpI_msgLiveAudio_setNowTextTimeForAudioNow (iNthis) {
					var nowTextTime = moment( (iNthis.currentTime * 1000) || 0).format('mm:ss');
					$(iNthis).closest('.aCpI_msgLiveAudio_blockInAudioMsg').find('.aCpI_msgLiveAudio_timeNowInAudioMessage').html( nowTextTime );
				}
				function aCpI_msgLiveAudio_setDurationTextTimeForAudioNow (iNthis) {
					var durationTextTime = moment( (iNthis.duration * 1000) || 0 ).format('mm:ss');
					$(iNthis).closest('.aCpI_msgLiveAudio_blockInAudioMsg').find('.aCpI_msgLiveAudio_timeAllInAudioMessage').html( durationTextTime );
				}
				function aCpI_msgLiveAudio_setNowTextTimeForAudioNowBySecond (iNthis,iNsecond) {
					var nowTextTime = moment( (iNsecond * 1000) || 0 ).format('mm:ss');
					$(iNthis).closest('.aCpI_msgLiveAudio_blockInAudioMsg').find('.aCpI_msgLiveAudio_timeNowInAudioMessage').html( nowTextTime );
				}
			function aCpI_msgLiveAudio_onHover (iNevent, iNobject) { 
		  		/*
		  			@discr
		  				mouse move on audio msg for moving audio 
		  			@inputs
		  				@required
		  					iNevent -> object (event)
		  					iNobject -> object (this)
		  		*/
			    var e = iNevent;
			    var thisObject = iNobject;

			    // get mouse position by percent
			    var mousePositionObject = global_getMousePositionByEvent(iNevent,iNobject);
			    var XinnerPercent 	= mousePositionObject['xPercent'];

			    // set progress bar
				var element = $(iNobject).children('.aCpI_msgLiveAudio_backgroundForAudioMsgOnHover');
			    aCpI_msgLiveAudio_setProgressBar (element,XinnerPercent,0);

				// get children audio element
			    var audioEl = $(iNobject).find('.aCpI_msgLiveAudio_hideAudioBlock audio').get(0);

		  		// get audio secund position by pass persent mouse x positoin
			    var audioTime = aCpI_msgLiveAudio_getCurrentTimeByPrecent (audioEl, XinnerPercent);

			    // set second text when mouse moving
			    aCpI_msgLiveAudio_setNowTextTimeForAudioNowBySecond (audioEl,audioTime);
		  	}
			window.aCpI_msgLiveAudio_onHover = aCpI_msgLiveAudio_onHover;

		  	function aCpI_msgLiveAudio_onClick (iNevent, iNobject) {
		  		/*
		  			@discr
		  				click audio msg fir start play
		  			@inputs
		  				@required
		  					iNevent -> object (event)
		  					iNobject -> object (this)
		  		*/
		  		// get children btnPlay element
			    var playBtn = $(iNobject).find('.aCpI_msgLiveAudio_blockInAudioMsg .aCpI_msgLiveAudio_controllPlayInAudioMessage')

		  		// get mouse position
			    var mousePositionObject = global_getMousePositionByEvent(iNevent,iNobject);


		  		// get mouse x position percent
			    var XinnerPercent 		= mousePositionObject['xPercent'];

		  		// get children audio element
			    var audioEl = $(iNobject).find('.aCpI_msgLiveAudio_hideAudioBlock audio').get(0);

		  		// get audio secund position by pass persent mouse x positoin
			    var audioTime = aCpI_msgLiveAudio_getCurrentTimeByPrecent (audioEl, XinnerPercent);

			    // set children audio need secund for start
			    aCpI_msgLiveAudio_setCurrentTimeByAudioEl (audioEl,audioTime);

			    // play children audio
			    aCpI_msgLiveAudio_playAudioOnClickBtnPlay (playBtn,iNevent);
		  	}
			window.aCpI_msgLiveAudio_onClick = aCpI_msgLiveAudio_onClick;

		  	function global_getMousePositionByEvent (iNevent,iNobject) {
		  		/*
		  			@discr
		  				GLOBAL FUNCTION get mouse position by Event, This
		  			@inputs
		  				@required
		  					iNevent -> object (event)
		  					iNobject -> object (this)
		  		*/
				// position of element
			    var e 				= iNevent,
			     	thisObject = iNobject,
			    	resultObject	= {},
			    	pos 			= $(thisObject).offset(),
			    	width 			= $(thisObject).width(),
			    	height 			= $(thisObject).height();
			    var	elem_left 		= pos.left,
			    	elem_top 		= pos.top;
			    // position of cursor in this element
			    	resultObject['xPx']			= e.pageX - elem_left;
			    	resultObject['yPx'] 		= e.pageY - elem_top,
			    	resultObject['xPercent'] 	= resultObject['xPx']/width * 100,
			    	resultObject['yPercent'] 	= resultObject['yPx']/height * 100;

		    	return resultObject;
		  	}

		  	function aCpI_msgLiveAudio_onMouseOut (iNobject) {
		  		/*
		  			@discr
		  				when mouse out from audio msg element, set onHover progress bar
		  			@inputs
		  				@required
		  					iNevent -> object (event)
		  					iNobject -> object (this)
		  		*/
				var element = $(iNobject).children('.aCpI_msgLiveAudio_backgroundForAudioMsgOnHover');
			    aCpI_msgLiveAudio_setProgressBar (element,0,500);
			}
			window.aCpI_msgLiveAudio_onMouseOut = aCpI_msgLiveAudio_onMouseOut;

			function aCpI_msgLiveAudio_getCurrentTimeByPrecent (iNaudioEl, iNpercent) {
		  		/*
		  			@discr
		  				get current audio time by passed percent
		  			@inputs
		  				@required
		  					iNevent -> object (event)
		  					iNobject -> object (this)
		  		*/
				var element = iNaudioEl;
				var second = iNpercent * element.duration/100
				return second;
			}
			function aCpI_msgLiveAudio_setCurrentTimeByAudioEl (iNobject,iNcurentTime) {
				/*
		  			@discr
		  				set current time for audio element (iNobject)
		  			@inputs
		  				@required
		  					iNobject -> object (this)
		  					iNcurentTime -> int (second)
		  		*/
				if ( typeof(iNcurentTime) == 'number' && isFinite(iNcurentTime)) {
		  			iNobject.currentTime = iNcurentTime;
		  		}
			}

			function aCpI_msgLiveAudio_onEventTimeUpdateForAuidioEl (thisAudioEl) {
		  		/*
		  			@discr
		  				attach time update
		  			@inputs
		  				@required
		  					thisAudioEl -> object (domElement)
		  		*/
		  		var parent 					= $(thisAudioEl).closest('.aCpI_msgLiveAudio_blockInAudioMsg');
		  		var onHoverBackgrounEl 		= $(thisAudioEl).closest('.aCpI_msgLiveAudio_contentOfAudioMessage').find('.aCpI_msgLiveAudio_backgroundForAudioMsgOnHover');
		  		var thisBackgroundEl 		= $(thisAudioEl).closest('.aCpI_msgLiveAudio_contentOfAudioMessage').find('.aCpI_msgLiveAudio_backgroundForAudioMsg');

		  		var percent = thisAudioEl.currentTime / thisAudioEl.duration * 100;

			  	let cssWidthBackgroundEl = parseInt($(onHoverBackgrounEl).css('width'));
			  	if(cssWidthBackgroundEl == 0)
					aCpI_msgLiveAudio_setNowTextTimeForAudioNow (thisAudioEl);

				aCpI_msgLiveAudio_setDurationTextTimeForAudioNow (thisAudioEl);


		    	aCpI_msgLiveAudio_setProgressBar (thisBackgroundEl,percent)
		    	if(percent >= 100){
		    		setTimeout(()=>{
				    	aCpI_msgLiveAudio_setProgressBar (thisBackgroundEl,0)
				    	aCpI_msgLiveAudio_smartViewBtnPlayAudio(parent);
		    			
		    		},500);
		    	}
			} window.aCpI_msgLiveAudio_onEventTimeUpdateForAuidioEl = aCpI_msgLiveAudio_onEventTimeUpdateForAuidioEl;

		  	function aCpI_msgLiveAudio_playAudioOnClickBtnPlay (iNobject,iNevent) {
		  		/*
		  			@discr
		  				onClick action for audio msg play btn
		  			@inputs
		  				@required
		  					iNobject -> object (this)
		  					iNevent -> object (event)
		  		*/
		  		// stop parent callback for click event
		  		if (iNevent) {
			  		var e = iNevent;
			  		e.stopPropagation();
		  		}
		  		var thisPlayBtn = $(iNobject);
		  		var thisAudioEl = thisPlayBtn.nextAll('.aCpI_msgLiveAudio_hideAudioBlock').children('audio').get(0);

		  		thisAudioEl.play();
		  	} window.aCpI_msgLiveAudio_playAudioOnClickBtnPlay = aCpI_msgLiveAudio_playAudioOnClickBtnPlay;

					

					function aCpI_msgLiveAudio_addPlayingFlags (iNthis) {
						/*
				  			@discr
				  				add flag by addClass 'flagForSearchPlayingAudioOrVideo' && 'flagForSearchPlayingLiveAudio'
				  			@inputs
				  				@required
				  					iNthis -> object (this video el)
				  		*/
				  		$(iNthis)
				  			.addClass('flagForSearchPlayingAudioOrVideo')
				  			.addClass('flagForSearchPlayingLiveAudio');
					} _['msgLiveAudio_addPlayingFlags'] = aCpI_msgLiveAudio_addPlayingFlags;

		  	function aCpI_msgLiveAudio_pauseAudioOnClickBtnPause (iNobject,iNevent) {
		  		/*
		  			@discr
		  				onClick action for audio msg pause btn
		  			@inputs
		  				@required
		  					iNobject -> object (this)
		  					iNevent -> object (event)
		  		*/
		  		// stop parent callback for click event
		  		if (iNevent) {
			  		var e = iNevent;
			  		e.stopPropagation();
		  		}
		  		var thisPauseBtn = $(iNobject);
		  		var thisAudio = thisPauseBtn.nextAll('.aCpI_msgLiveAudio_hideAudioBlock').children('audio').get(0);

		  		thisAudio.pause();
		  	} window.aCpI_msgLiveAudio_pauseAudioOnClickBtnPause = aCpI_msgLiveAudio_pauseAudioOnClickBtnPause;
				
				function aCpI_msgLiveAudio_onEventPause (iNobject) {
					// del flag
					aCpI_msgLiveAudio_delPlayingFlags(iNobject);

						var parent = $(iNobject).closest('.aCpI_msgLiveAudio_blockInAudioMsg');
					aCpI_msgLiveAudio_smartViewBtnPlayAudio(parent)
				} window.aCpI_msgLiveAudio_onEventPause = aCpI_msgLiveAudio_onEventPause;

					function aCpI_msgLiveAudio_delPlayingFlags (iNthis) {
						/*
				  			@discr
				  				delete flag by removeClass 'flagForSearchPlayingAudioOrVideo' && 'flagForSearchPlayingLiveAudio'
				  			@inputs
				  				@required
				  					iNthis -> object (this video el)
				  		*/
			  			$(iNthis)
				  			.removeClass('flagForSearchPlayingAudioOrVideo')
				  			.removeClass('flagForSearchPlayingLiveAudio');
					}

		  	function aCpI_msgLiveAudio_setProgressBar (iNel,iNpercent,iNtime) {
		  		/*
		  			@discr
		  				set css width for progress bar element (iNel) 
		  			@inputs
		  				@required
		  					iNel -> object (this)
		  					iNpercent -> int ()
		  					iNtime -> int (@animations length ms) 
		  		*/
		  		var time = iNtime || 500;
			    let percent = iNpercent.toFixed(2)+'%';
					iNel.clearQueue().stop();
				if( iNtime == 0 )
					iNel.css('width',percent);
				else
				    iNel.animate(
				    	{
			    			'width':percent
			    		},
			    		time
					);
		  	}

			function aCpI_msgLiveAudio_smartViewBtnPauseAudio(iNparent) {
		  			$(iNparent).children('.aCpI_msgLiveAudio_controllPlayInAudioMessage').hide();
		  			$(iNparent).children('.aCpI_msgLiveAudio_controllPauseInAudioMessage').show();
			}
			_['msgLiveAudio_smartViewBtnPauseAudio'] = aCpI_msgLiveAudio_smartViewBtnPauseAudio;

			function aCpI_msgLiveAudio_smartViewBtnPlayAudio(iNparent) {
		  			$(iNparent).children('.aCpI_msgLiveAudio_controllPauseInAudioMessage').hide();
		  			$(iNparent).children('.aCpI_msgLiveAudio_controllPlayInAudioMessage').show();
			}
		//@> codeKey = appChatPageIndex - aCpI 'audioLiveMsg'

		//@< codeKey = appChatPageIndex - aCpI 'videoLiveMsg'
			function aCpI_msgLiveVideo_onEventMouseEnter (iNthis) {
				/*
		  			@discr
		  				for '.aCpI_msgLiveVideo_videoMsgContent' event mouser enter -> we show pause/play btn block
		  			@inputs
		  				@required
		  					iNthis -> object (this)
		  		*/
		  		$(iNthis).children('.aCpI_msgLiveVideo_backgroundVideoOnHover').show();
			} window.aCpI_msgLiveVideo_onEventMouseEnter = aCpI_msgLiveVideo_onEventMouseEnter;	

			function aCpI_msgLiveVideo_onEventMouseLeave (iNthis) {
				/*
		  			@discr
		  				for '.aCpI_msgLiveVideo_videoMsgContent' event mouser leave -> we hide pause/play btn block
		  			@inputs
		  				@required
		  					iNthis -> object (this)
		  		*/
		  		$(iNthis).children('.aCpI_msgLiveVideo_backgroundVideoOnHover').hide();
			} window.aCpI_msgLiveVideo_onEventMouseLeave = aCpI_msgLiveVideo_onEventMouseLeave;	

			

				
				function msgLiveVideo_addPlayingFlags (iNthis) {
					/*
			  			@discr
			  				add flag by addClass 'flagForSearchPlayingAudioOrVideo' && 'flagForSearchPlayingLiveVideo'
			  			@inputs
			  				@required
			  					iNthis -> object (this video el)
			  		*/
			  		$(iNthis)
			  			.addClass('flagForSearchPlayingAudioOrVideo')
			  			.addClass('flagForSearchPlayingLiveVideo');
				} _['msgLiveVideo_addPlayingFlags'] = msgLiveVideo_addPlayingFlags;

			function aCpI_msgLiveVideo_onEventPauseVideo (iNthis) {
				/*
		  			@discr
		  				for video '.liveVideoSrc' event onpause video -> we change btn play TO pause (adding class)
		  			@inputs
		  				@required
		  					iNthis -> object (this)
		  		*/
		  		let backElement = $(iNthis).closest('.aCpI_msgLiveVideo_videoMsgContent').find('.aCpI_msgLiveVideo_backgroundVideoOnHover');
		  		//del
		  		$(backElement)
		  			.removeClass('aCpI_msgLiveVideo_backgroundPauseVideoOnHover')
		  			.addClass('aCpI_msgLiveVideo_backgroundPlayVideoOnHover');


		  		// dell flag by removeClass 'flagForSearchPlayingAudioOrVideo' && 'flagForSearchPlayingLiveVideo'
		  		aCpI_msgLiveVideo_delPlayingFlags(iNthis);
			} window.aCpI_msgLiveVideo_onEventPauseVideo = aCpI_msgLiveVideo_onEventPauseVideo;	

				function aCpI_msgLiveVideo_delPlayingFlags (iNthis) {
					/*
			  			@discr
			  				delete flag by removeClass 'flagForSearchPlayingAudioOrVideo' && 'flagForSearchPlayingLiveVideo'
			  			@inputs
			  				@required
			  					iNthis -> object (this video el)
			  		*/
		  			$(iNthis)
			  			.removeClass('flagForSearchPlayingAudioOrVideo')
			  			.removeClass('flagForSearchPlayingLiveVideo');
				}

			function aCpI_msgLiveVideo_onEventLoadedDataVideo (iNthis) {
				/*
		  			@discr
		  				for video '.liveVideoSrc' event onpause video -> we change btn play TO pause (adding class)
		  			@inputs
		  				@required
		  					iNthis -> object (this)
		  		*/
		  		let loadingEl = $(iNthis).closest('.aCpI_msgLiveVideo_videoMsgContent').find('.aCpI_msgLiveVideo_viewWhenLoadingVideoLiveMsg').hide();
			} window.aCpI_msgLiveVideo_onEventLoadedDataVideo = aCpI_msgLiveVideo_onEventLoadedDataVideo;	

			function aCpI_msgLiveVideo_onEventTimeUpdateVideo (iNthis) {
				/*
		  			@discr
		  				for video '.liveVideoSrc' event onpause video -> we change btn play TO pause (adding class)
		  			@inputs
		  				@required
		  					iNthis -> object (this)
		  		*/

		  		// set current time for this video
		  		var currentTime 	= (iNthis.currentTime * 1000) || 0;
		  		var textCurrentTime = moment(currentTime).format('mm:ss');
		  		let parent = $(iNthis).closest('.aCpI_msgLiveVideo_videoMsgContent').find('.aCpI_msgLiveVideo_msgNowVideoTime').html(textCurrentTime);
			} window.aCpI_msgLiveVideo_onEventTimeUpdateVideo = aCpI_msgLiveVideo_onEventTimeUpdateVideo;	


			function aCpI_msgLiveVideo_onEventClickForBackground (iNthis) {
				/*
		  			@discr
		  				for video '.liveVideoSrc' event onpause video -> we change btn play TO pause (adding class)
		  			@inputs
		  				@required
		  					iNthis -> object (this)
		  		*/
		  		var isPauseBtn = $(iNthis).hasClass('aCpI_msgLiveVideo_backgroundPauseVideoOnHover');
		  		var videoEl = $(iNthis).next().get(0);
		  		if( isPauseBtn ) {
		  			// pause this video
		  			videoEl.pause()
		  		} else {
		  			// play this video
		  			videoEl.play()

		  		}
			} window.aCpI_msgLiveVideo_onEventClickForBackground = aCpI_msgLiveVideo_onEventClickForBackground;	

		//@> codeKey = appChatPageIndex - aCpI 'videoLiveMsg'

	return _;

});
/**!
 * MixItUp v3.1.12
 * A high-performance, dependency-free library for animated filtering, sorting and more
 * Build 99123294-5817-4da9-b352-e17eb8780170
 *
 * @copyright Copyright 2014-2017 KunkaLabs Limited.
 * @author    KunkaLabs Limited.
 * @link      https://www.kunkalabs.com/mixitup/
 *
 * @license   Commercial use requires a commercial license.
 *            https://www.kunkalabs.com/mixitup/licenses/
 *
 *            Non-commercial use permitted under same terms as CC BY-NC 3.0 license.
 *            http://creativecommons.org/licenses/by-nc/3.0/
 */
!function(t){"use strict";var e=null,n=null,a=null;!function(){var e=["webkit","moz","o","ms"],n=t.document.createElement("div"),a=-1;for(a=0;a<e.length&&!t.requestAnimationFrame;a++)t.requestAnimationFrame=t[e[a]+"RequestAnimationFrame"];"undefined"==typeof n.nextElementSibling&&Object.defineProperty(t.Element.prototype,"nextElementSibling",{get:function(){for(var t=this.nextSibling;t;){if(1===t.nodeType)return t;t=t.nextSibling}return null}}),function(t){t.matches=t.matches||t.machesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector||function(t){return Array.prototype.indexOf.call(this.parentElement.querySelectorAll(t),this)>-1}}(t.Element.prototype),Object.keys||(Object.keys=function(){var t=Object.prototype.hasOwnProperty,e=!1,n=[],a=-1;return e=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],a=n.length,function(i){var o=[],r="",s=-1;if("object"!=typeof i&&("function"!=typeof i||null===i))throw new TypeError("Object.keys called on non-object");for(r in i)t.call(i,r)&&o.push(r);if(e)for(s=0;s<a;s++)t.call(i,n[s])&&o.push(n[s]);return o}}()),Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),"function"!=typeof Object.create&&(Object.create=function(t){var e=function(){};return function(n,a){if(n!==Object(n)&&null!==n)throw TypeError("Argument must be an object, or null");e.prototype=n||{};var i=new e;return e.prototype=null,a!==t&&Object.defineProperties(i,a),null===n&&(i.__proto__=null),i}}()),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var e,n,a,i;if(null===this)throw new TypeError;if(a=Object(this),i=a.length>>>0,0===i)return-1;if(e=0,arguments.length>1&&(e=Number(arguments[1]),e!==e?e=0:0!==e&&e!==1/0&&e!==-(1/0)&&(e=(e>0||-1)*Math.floor(Math.abs(e)))),e>=i)return-1;for(n=e>=0?e:Math.max(i-Math.abs(e),0);n<i;n++)if(n in a&&a[n]===t)return n;return-1}),Function.prototype.bind||(Function.prototype.bind=function(t){var e,n,a,i;if("function"!=typeof this)throw new TypeError;return e=Array.prototype.slice.call(arguments,1),n=this,a=function(){},i=function(){return n.apply(this instanceof a?this:t,e.concat(Array.prototype.slice.call(arguments)))},this.prototype&&(a.prototype=this.prototype),i.prototype=new a,i}),t.Element.prototype.dispatchEvent||(t.Element.prototype.dispatchEvent=function(t){try{return this.fireEvent("on"+t.type,t)}catch(e){}})}(),e=function(a,i,o){var r=null,s=!1,l=null,c=null,u=null,f=null,h=[],d="",m=[],g=-1;if(u=o||t.document,(s=arguments[3])&&(s="boolean"==typeof s),"string"==typeof a)m=u.querySelectorAll(a);else if(a&&"object"==typeof a&&n.isElement(a,u))m=[a];else{if(!a||"object"!=typeof a||!a.length)throw new Error(e.messages.errorFactoryInvalidContainer());m=a}if(m.length<1)throw new Error(e.messages.errorFactoryContainerNotFound());for(g=0;(r=m[g])&&(!(g>0)||s);g++)r.id?d=r.id:(d="MixItUp"+n.randomHex(),r.id=d),e.instances[d]instanceof e.Mixer?(l=e.instances[d],(!i||i&&i.debug&&i.debug.showWarnings!==!1)&&console.warn(e.messages.warningFactoryPreexistingInstance())):(l=new e.Mixer,l.attach(r,u,d,i),e.instances[d]=l),c=new e.Facade(l),i&&i.debug&&i.debug.enable?h.push(l):h.push(c);return f=s?new e.Collection(h):h[0]},e.use=function(t){e.Base.prototype.callActions.call(e,"beforeUse",arguments),"function"==typeof t&&"mixitup-extension"===t.TYPE?"undefined"==typeof e.extensions[t.NAME]&&(t(e),e.extensions[t.NAME]=t):t.fn&&t.fn.jquery&&(e.libraries.$=t,e.registerJqPlugin(t)),e.Base.prototype.callActions.call(e,"afterUse",arguments)},e.registerJqPlugin=function(t){t.fn.mixItUp=function(){var t=arguments[0],n=arguments[1],a=Array.prototype.slice.call(arguments,1),i=[],o=[];return o=this.each(function(){var o=null,r=null;t&&"string"==typeof t?(o=e.instances[this.id],r=o[t].apply(o,a),"undefined"!=typeof r&&null!==r&&"function"!=typeof r.then&&i.push(r)):e(this,n)}),i.length?i.length>1?i:i[0]:o}},e.instances={},e.extensions={},e.libraries={},n={hasClass:function(t,e){return!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))},addClass:function(t,e){this.hasClass(t,e)||(t.className+=t.className?" "+e:e)},removeClass:function(t,e){if(this.hasClass(t,e)){var n=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(n," ").trim()}},extend:function(t,e,n,a){var i=[],o="",r=-1;n=n||!1,a=a||!1;try{if(Array.isArray(e))for(r=0;r<e.length;r++)i.push(r);else e&&(i=Object.keys(e));for(r=0;r<i.length;r++)o=i[r],!n||"object"!=typeof e[o]||this.isElement(e[o])?t[o]=e[o]:Array.isArray(e[o])?(t[o]||(t[o]=[]),this.extend(t[o],e[o],n,a)):(t[o]||(t[o]={}),this.extend(t[o],e[o],n,a))}catch(s){if(!a)throw s;this.handleExtendError(s,t)}return t},handleExtendError:function(t,n){var a=/property "?(\w*)"?[,:] object/i,i=null,o="",r="",s="",l="",c="",u=-1,f=-1;if(t instanceof TypeError&&(i=a.exec(t.message))){o=i[1];for(c in n){for(f=0;f<o.length&&o.charAt(f)===c.charAt(f);)f++;f>u&&(u=f,l=c)}throw u>1&&(s=e.messages.errorConfigInvalidPropertySuggestion({probableMatch:l})),r=e.messages.errorConfigInvalidProperty({erroneous:o,suggestion:s}),new TypeError(r)}throw t},template:function(t){for(var e=/\${([\w]*)}/g,n={},a=null;a=e.exec(t);)n[a[1]]=new RegExp("\\${"+a[1]+"}","g");return function(e){var a="",i=t;e=e||{};for(a in n)i=i.replace(n[a],"undefined"!=typeof e[a]?e[a]:"");return i}},on:function(e,n,a,i){e&&(e.addEventListener?e.addEventListener(n,a,i):e.attachEvent&&(e["e"+n+a]=a,e[n+a]=function(){e["e"+n+a](t.event)},e.attachEvent("on"+n,e[n+a])))},off:function(t,e,n){t&&(t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent&&(t.detachEvent("on"+e,t[e+n]),t[e+n]=null))},getCustomEvent:function(e,n,a){var i=null;return a=a||t.document,"function"==typeof t.CustomEvent?i=new t.CustomEvent(e,{detail:n,bubbles:!0,cancelable:!0}):"function"==typeof a.createEvent?(i=a.createEvent("CustomEvent"),i.initCustomEvent(e,!0,!0,n)):(i=a.createEventObject(),i.type=e,i.returnValue=!1,i.cancelBubble=!1,i.detail=n),i},getOriginalEvent:function(t){return t.touches&&t.touches.length?t.touches[0]:t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t},index:function(t,e){for(var n=0;null!==(t=t.previousElementSibling);)e&&!t.matches(e)||++n;return n},camelCase:function(t){return t.toLowerCase().replace(/([_-][a-z])/g,function(t){return t.toUpperCase().replace(/[_-]/,"")})},pascalCase:function(t){return(t=this.camelCase(t)).charAt(0).toUpperCase()+t.slice(1)},dashCase:function(t){return t.replace(/([A-Z])/g,"-$1").replace(/^-/,"").toLowerCase()},isElement:function(e,n){return n=n||t.document,!!(t.HTMLElement&&e instanceof t.HTMLElement)||(!!(n.defaultView&&n.defaultView.HTMLElement&&e instanceof n.defaultView.HTMLElement)||null!==e&&1===e.nodeType&&"string"==typeof e.nodeName)},createElement:function(e,n){var a=null,i=null;for(n=n||t.document,a=n.createDocumentFragment(),i=n.createElement("div"),i.innerHTML=e;i.firstChild;)a.appendChild(i.firstChild);return a},removeWhitespace:function(t){for(var e;t&&"#text"===t.nodeName;)e=t,t=t.previousSibling,e.parentElement&&e.parentElement.removeChild(e)},isEqualArray:function(t,e){var n=t.length;if(n!==e.length)return!1;for(;n--;)if(t[n]!==e[n])return!1;return!0},deepEquals:function(t,e){var n;if("object"==typeof t&&t&&"object"==typeof e&&e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(n in t)if(!e.hasOwnProperty(n)||!this.deepEquals(t[n],e[n]))return!1}else if(t!==e)return!1;return!0},arrayShuffle:function(t){for(var e=t.slice(),n=e.length,a=n,i=-1,o=[];a--;)i=~~(Math.random()*n),o=e[a],e[a]=e[i],e[i]=o;return e},arrayFromList:function(t){var e,n;try{return Array.prototype.slice.call(t)}catch(a){for(e=[],n=0;n<t.length;n++)e.push(t[n]);return e}},debounce:function(t,e,n){var a;return function(){var i=this,o=arguments,r=n&&!a,s=null;s=function(){a=null,n||t.apply(i,o)},clearTimeout(a),a=setTimeout(s,e),r&&t.apply(i,o)}},position:function(t){for(var e=0,n=0,a=t;t;)e-=t.scrollLeft,n-=t.scrollTop,t===a&&(e+=t.offsetLeft,n+=t.offsetTop,a=t.offsetParent),t=t.parentElement;return{x:e,y:n}},getHypotenuse:function(t,e){var n=t.x-e.x,a=t.y-e.y;return n=n<0?n*-1:n,a=a<0?a*-1:a,Math.sqrt(Math.pow(n,2)+Math.pow(a,2))},getIntersectionRatio:function(t,e){var n=t.width*t.height,a=-1,i=-1,o=-1,r=-1;return a=Math.max(0,Math.min(t.left+t.width,e.left+e.width)-Math.max(t.left,e.left)),i=Math.max(0,Math.min(t.top+t.height,e.top+e.height)-Math.max(t.top,e.top)),o=i*a,r=o/n},closestParent:function(e,n,a,i){var o=e.parentNode;if(i=i||t.document,a&&e.matches(n))return e;for(;o&&o!=i.body;){if(o.matches&&o.matches(n))return o;if(!o.parentNode)return null;o=o.parentNode}return null},children:function(e,n,a){var i=[],o="";return a=a||t.doc,e&&(e.id||(o="Temp"+this.randomHexKey(),e.id=o),i=a.querySelectorAll("#"+e.id+" > "+n),o&&e.removeAttribute("id")),i},clean:function(t){var e=[],n=-1;for(n=0;n<t.length;n++)""!==t[n]&&e.push(t[n]);return e},defer:function(n){var a=null,i=null,o=null;return i=new this.Deferred,e.features.has.promises?i.promise=new Promise(function(t,e){i.resolve=t,i.reject=e}):(o=t.jQuery||n.$)&&"function"==typeof o.Deferred?(a=o.Deferred(),i.promise=a.promise(),i.resolve=a.resolve,i.reject=a.reject):t.console&&console.warn(e.messages.warningNoPromiseImplementation()),i},all:function(n,a){var i=null;return e.features.has.promises?Promise.all(n):(i=t.jQuery||a.$)&&"function"==typeof i.when?i.when.apply(i,n).done(function(){return arguments}):(t.console&&console.warn(e.messages.warningNoPromiseImplementation()),[])},getPrefix:function(t,e,a){var i=-1,o="";if(n.dashCase(e)in t.style)return"";for(i=0;o=a[i];i++)if(o+e in t.style)return o.toLowerCase();return"unsupported"},randomHex:function(){return("00000"+(16777216*Math.random()<<0).toString(16)).substr(-6).toUpperCase()},getDocumentState:function(e){return e="object"==typeof e.body?e:t.document,{scrollTop:t.pageYOffset,scrollLeft:t.pageXOffset,docHeight:e.documentElement.scrollHeight,docWidth:e.documentElement.scrollWidth,viewportHeight:e.documentElement.clientHeight,viewportWidth:e.documentElement.clientWidth}},bind:function(t,e){return function(){return e.apply(t,arguments)}},isVisible:function(e){var n=null;return!!e.offsetParent||(n=t.getComputedStyle(e),"fixed"===n.position&&"hidden"!==n.visibility&&"0"!==n.opacity)},seal:function(t){"function"==typeof Object.seal&&Object.seal(t)},freeze:function(t){"function"==typeof Object.freeze&&Object.freeze(t)},compareVersions:function(t,e){var n=t.split("."),a=e.split("."),i=-1,o=-1,r=-1;for(r=0;r<n.length;r++){if(i=parseInt(n[r].replace(/[^\d.]/g,"")),o=parseInt(a[r].replace(/[^\d.]/g,"")||0),o<i)return!1;if(o>i)return!0}return!0},Deferred:function(){this.promise=null,this.resolve=null,this.reject=null,this.id=n.randomHex()},isEmptyObject:function(t){var e="";if("function"==typeof Object.keys)return 0===Object.keys(t).length;for(e in t)if(t.hasOwnProperty(e))return!1;return!0},getClassname:function(t,e,n){var a="";return a+=t.block,a.length&&(a+=t.delineatorElement),a+=t["element"+this.pascalCase(e)],n?(a.length&&(a+=t.delineatorModifier),a+=n):a},getProperty:function(t,e){var n=e.split("."),a=null,i="",o=0;if(!e)return t;for(a=function(t){return t?t[i]:null};o<n.length;)i=n[o],t=a(t),o++;return"undefined"!=typeof t?t:null}},e.h=n,e.Base=function(){},e.Base.prototype={constructor:e.Base,callActions:function(t,e){var a=this,i=a.constructor.actions[t],o="";if(i&&!n.isEmptyObject(i))for(o in i)i[o].apply(a,e)},callFilters:function(t,e,a){var i=this,o=i.constructor.filters[t],r=e,s="";if(!o||n.isEmptyObject(o))return r;a=a||[];for(s in o)a=n.arrayFromList(a),a.unshift(r),r=o[s].apply(i,a);return r}},e.BaseStatic=function(){this.actions={},this.filters={},this.extend=function(t){n.extend(this.prototype,t)},this.registerAction=function(t,e,n){(this.actions[t]=this.actions[t]||{})[e]=n},this.registerFilter=function(t,e,n){(this.filters[t]=this.filters[t]||{})[e]=n}},e.Features=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.boxSizingPrefix="",this.transformPrefix="",this.transitionPrefix="",this.boxSizingPrefix="",this.transformProp="",this.transformRule="",this.transitionProp="",this.perspectiveProp="",this.perspectiveOriginProp="",this.has=new e.Has,this.canary=null,this.BOX_SIZING_PROP="boxSizing",this.TRANSITION_PROP="transition",this.TRANSFORM_PROP="transform",this.PERSPECTIVE_PROP="perspective",this.PERSPECTIVE_ORIGIN_PROP="perspectiveOrigin",this.VENDORS=["Webkit","moz","O","ms"],this.TWEENABLE=["opacity","width","height","marginRight","marginBottom","x","y","scale","translateX","translateY","translateZ","rotateX","rotateY","rotateZ"],this.callActions("afterConstruct")},e.BaseStatic.call(e.Features),e.Features.prototype=Object.create(e.Base.prototype),n.extend(e.Features.prototype,{constructor:e.Features,init:function(){var t=this;t.callActions("beforeInit",arguments),t.canary=document.createElement("div"),t.setPrefixes(),t.runTests(),t.callActions("beforeInit",arguments)},runTests:function(){var e=this;e.callActions("beforeRunTests",arguments),e.has.promises="function"==typeof t.Promise,e.has.transitions="unsupported"!==e.transitionPrefix,e.callActions("afterRunTests",arguments),n.freeze(e.has)},setPrefixes:function(){var t=this;t.callActions("beforeSetPrefixes",arguments),t.transitionPrefix=n.getPrefix(t.canary,"Transition",t.VENDORS),t.transformPrefix=n.getPrefix(t.canary,"Transform",t.VENDORS),t.boxSizingPrefix=n.getPrefix(t.canary,"BoxSizing",t.VENDORS),t.boxSizingProp=t.boxSizingPrefix?t.boxSizingPrefix+n.pascalCase(t.BOX_SIZING_PROP):t.BOX_SIZING_PROP,t.transitionProp=t.transitionPrefix?t.transitionPrefix+n.pascalCase(t.TRANSITION_PROP):t.TRANSITION_PROP,t.transformProp=t.transformPrefix?t.transformPrefix+n.pascalCase(t.TRANSFORM_PROP):t.TRANSFORM_PROP,t.transformRule=t.transformPrefix?"-"+t.transformPrefix+"-"+t.TRANSFORM_PROP:t.TRANSFORM_PROP,t.perspectiveProp=t.transformPrefix?t.transformPrefix+n.pascalCase(t.PERSPECTIVE_PROP):t.PERSPECTIVE_PROP,t.perspectiveOriginProp=t.transformPrefix?t.transformPrefix+n.pascalCase(t.PERSPECTIVE_ORIGIN_PROP):t.PERSPECTIVE_ORIGIN_PROP,t.callActions("afterSetPrefixes",arguments)}}),e.Has=function(){this.transitions=!1,this.promises=!1,n.seal(this)},e.features=new e.Features,e.features.init(),e.ConfigAnimation=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.enable=!0,this.effects="fade scale",this.effectsIn="",this.effectsOut="",this.duration=600,this.easing="ease",this.applyPerspective=!0,this.perspectiveDistance="3000px",this.perspectiveOrigin="50% 50%",this.queue=!0,this.queueLimit=3,this.animateResizeContainer=!0,this.animateResizeTargets=!1,this.staggerSequence=null,this.reverseOut=!1,this.nudge=!0,this.clampHeight=!0,this.clampWidth=!0,this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.ConfigAnimation),e.ConfigAnimation.prototype=Object.create(e.Base.prototype),e.ConfigAnimation.prototype.constructor=e.ConfigAnimation,e.ConfigBehavior=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.liveSort=!1,this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.ConfigBehavior),e.ConfigBehavior.prototype=Object.create(e.Base.prototype),e.ConfigBehavior.prototype.constructor=e.ConfigBehavior,e.ConfigCallbacks=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.onMixStart=null,this.onMixBusy=null,this.onMixEnd=null,this.onMixFail=null,this.onMixClick=null,this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.ConfigCallbacks),e.ConfigCallbacks.prototype=Object.create(e.Base.prototype),e.ConfigCallbacks.prototype.constructor=e.ConfigCallbacks,e.ConfigControls=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.enable=!0,this.live=!1,this.scope="global",this.toggleLogic="or",this.toggleDefault="all",this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.ConfigControls),e.ConfigControls.prototype=Object.create(e.Base.prototype),e.ConfigControls.prototype.constructor=e.ConfigControls,e.ConfigClassNames=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.block="mixitup",this.elementContainer="container",this.elementFilter="control",this.elementSort="control",this.elementMultimix="control",this.elementToggle="control",this.modifierActive="active",this.modifierDisabled="disabled",this.modifierFailed="failed",this.delineatorElement="-",this.delineatorModifier="-",this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.ConfigClassNames),e.ConfigClassNames.prototype=Object.create(e.Base.prototype),e.ConfigClassNames.prototype.constructor=e.ConfigClassNames,e.ConfigData=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.uidKey="",this.dirtyCheck=!1,this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.ConfigData),e.ConfigData.prototype=Object.create(e.Base.prototype),e.ConfigData.prototype.constructor=e.ConfigData,e.ConfigDebug=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.enable=!1,this.showWarnings=!0,this.fauxAsync=!1,this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.ConfigDebug),e.ConfigDebug.prototype=Object.create(e.Base.prototype),e.ConfigDebug.prototype.constructor=e.ConfigDebug,e.ConfigLayout=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.allowNestedTargets=!0,this.containerClassName="",this.siblingBefore=null,this.siblingAfter=null,this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.ConfigLayout),e.ConfigLayout.prototype=Object.create(e.Base.prototype),e.ConfigLayout.prototype.constructor=e.ConfigLayout,e.ConfigLoad=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.filter="all",this.sort="default:asc",this.dataset=null,this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.ConfigLoad),e.ConfigLoad.prototype=Object.create(e.Base.prototype),e.ConfigLoad.prototype.constructor=e.ConfigLoad,e.ConfigSelectors=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.target=".mix",this.control="",this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.ConfigSelectors),e.ConfigSelectors.prototype=Object.create(e.Base.prototype),e.ConfigSelectors.prototype.constructor=e.ConfigSelectors,e.ConfigRender=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.target=null,this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.ConfigRender),e.ConfigRender.prototype=Object.create(e.Base.prototype),e.ConfigRender.prototype.constructor=e.ConfigRender,e.ConfigTemplates=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.ConfigTemplates),e.ConfigTemplates.prototype=Object.create(e.Base.prototype),e.ConfigTemplates.prototype.constructor=e.ConfigTemplates,e.Config=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.animation=new e.ConfigAnimation,this.behavior=new e.ConfigBehavior,this.callbacks=new e.ConfigCallbacks,this.controls=new e.ConfigControls,this.classNames=new e.ConfigClassNames,this.data=new e.ConfigData,this.debug=new e.ConfigDebug,this.layout=new e.ConfigLayout,this.load=new e.ConfigLoad,this.selectors=new e.ConfigSelectors,this.render=new e.ConfigRender,this.templates=new e.ConfigTemplates,this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.Config),e.Config.prototype=Object.create(e.Base.prototype),e.Config.prototype.constructor=e.Config,e.MixerDom=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.document=null,this.body=null,this.container=null,this.parent=null,this.targets=[],this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.MixerDom),e.MixerDom.prototype=Object.create(e.Base.prototype),e.MixerDom.prototype.constructor=e.MixerDom,e.UiClassNames=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.base="",this.active="",this.disabled="",this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.UiClassNames),e.UiClassNames.prototype=Object.create(e.Base.prototype),e.UiClassNames.prototype.constructor=e.UiClassNames,e.CommandDataset=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.dataset=null,this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.CommandDataset),e.CommandDataset.prototype=Object.create(e.Base.prototype),e.CommandDataset.prototype.constructor=e.CommandDataset,e.CommandMultimix=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.filter=null,this.sort=null,this.insert=null,this.remove=null,this.changeLayout=null,this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.CommandMultimix),e.CommandMultimix.prototype=Object.create(e.Base.prototype),e.CommandMultimix.prototype.constructor=e.CommandMultimix,e.CommandFilter=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.selector="",this.collection=null,this.action="show",this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.CommandFilter),e.CommandFilter.prototype=Object.create(e.Base.prototype),e.CommandFilter.prototype.constructor=e.CommandFilter,e.CommandSort=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.sortString="",this.attribute="",this.order="asc",this.collection=null,this.next=null,this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.CommandSort),e.CommandSort.prototype=Object.create(e.Base.prototype),e.CommandSort.prototype.constructor=e.CommandSort,e.CommandInsert=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.index=0,this.collection=[],this.position="before",this.sibling=null,this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.CommandInsert),e.CommandInsert.prototype=Object.create(e.Base.prototype),e.CommandInsert.prototype.constructor=e.CommandInsert,e.CommandRemove=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.targets=[],this.collection=[],this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.CommandRemove),e.CommandRemove.prototype=Object.create(e.Base.prototype),e.CommandRemove.prototype.constructor=e.CommandRemove,e.CommandChangeLayout=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.containerClassName="",this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.CommandChangeLayout),e.CommandChangeLayout.prototype=Object.create(e.Base.prototype),e.CommandChangeLayout.prototype.constructor=e.CommandChangeLayout,e.ControlDefinition=function(t,a,i,o){e.Base.call(this),this.callActions("beforeConstruct"),this.type=t,this.selector=a,this.live=i||!1,this.parent=o||"",this.callActions("afterConstruct"),n.freeze(this),n.seal(this)},e.BaseStatic.call(e.ControlDefinition),e.ControlDefinition.prototype=Object.create(e.Base.prototype),e.ControlDefinition.prototype.constructor=e.ControlDefinition,e.controlDefinitions=[],e.controlDefinitions.push(new e.ControlDefinition("multimix","[data-filter][data-sort]")),e.controlDefinitions.push(new e.ControlDefinition("filter","[data-filter]")),e.controlDefinitions.push(new e.ControlDefinition("sort","[data-sort]")),e.controlDefinitions.push(new e.ControlDefinition("toggle","[data-toggle]")),e.Control=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.el=null,this.selector="",this.bound=[],this.pending=-1,this.type="",this.status="inactive",this.filter="",this.sort="",this.canDisable=!1,this.handler=null,this.classNames=new e.UiClassNames,this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.Control),e.Control.prototype=Object.create(e.Base.prototype),n.extend(e.Control.prototype,{constructor:e.Control,init:function(t,n,a){var i=this;if(this.callActions("beforeInit",arguments),i.el=t,i.type=n,i.selector=a,i.selector)i.status="live";else switch(i.canDisable="boolean"==typeof i.el.disable,i.type){case"filter":i.filter=i.el.getAttribute("data-filter");break;case"toggle":i.filter=i.el.getAttribute("data-toggle");break;case"sort":i.sort=i.el.getAttribute("data-sort");break;case"multimix":i.filter=i.el.getAttribute("data-filter"),i.sort=i.el.getAttribute("data-sort")}i.bindClick(),e.controls.push(i),this.callActions("afterInit",arguments)},isBound:function(t){var e=this,n=!1;return this.callActions("beforeIsBound",arguments),n=e.bound.indexOf(t)>-1,e.callFilters("afterIsBound",n,arguments)},addBinding:function(t){var e=this;this.callActions("beforeAddBinding",arguments),e.isBound()||e.bound.push(t),this.callActions("afterAddBinding",arguments)},removeBinding:function(t){var n=this,a=-1;this.callActions("beforeRemoveBinding",arguments),(a=n.bound.indexOf(t))>-1&&n.bound.splice(a,1),n.bound.length<1&&(n.unbindClick(),a=e.controls.indexOf(n),e.controls.splice(a,1),"active"===n.status&&n.renderStatus(n.el,"inactive")),this.callActions("afterRemoveBinding",arguments)},bindClick:function(){var t=this;this.callActions("beforeBindClick",arguments),t.handler=function(e){t.handleClick(e)},n.on(t.el,"click",t.handler),this.callActions("afterBindClick",arguments)},unbindClick:function(){var t=this;this.callActions("beforeUnbindClick",arguments),n.off(t.el,"click",t.handler),t.handler=null,this.callActions("afterUnbindClick",arguments)},handleClick:function(t){var a=this,i=null,o=null,r=!1,s=void 0,l={},c=null,u=[],f=-1;if(this.callActions("beforeHandleClick",arguments),this.pending=0,o=a.bound[0],i=a.selector?n.closestParent(t.target,o.config.selectors.control+a.selector,!0,o.dom.document):a.el,!i)return void a.callActions("afterHandleClick",arguments);switch(a.type){case"filter":l.filter=a.filter||i.getAttribute("data-filter");break;case"sort":l.sort=a.sort||i.getAttribute("data-sort");break;case"multimix":l.filter=a.filter||i.getAttribute("data-filter"),l.sort=a.sort||i.getAttribute("data-sort");break;case"toggle":l.filter=a.filter||i.getAttribute("data-toggle"),r="live"===a.status?n.hasClass(i,a.classNames.active):"active"===a.status}for(f=0;f<a.bound.length;f++)c=new e.CommandMultimix,n.extend(c,l),u.push(c);for(u=a.callFilters("commandsHandleClick",u,arguments),a.pending=a.bound.length,f=0;o=a.bound[f];f++)l=u[f],l&&(o.lastClicked||(o.lastClicked=i),e.events.fire("mixClick",o.dom.container,{state:o.state,instance:o,originalEvent:t,control:o.lastClicked},o.dom.document),"function"==typeof o.config.callbacks.onMixClick&&(s=o.config.callbacks.onMixClick.call(o.lastClicked,o.state,t,o),s===!1)||("toggle"===a.type?r?o.toggleOff(l.filter):o.toggleOn(l.filter):o.multimix(l)));this.callActions("afterHandleClick",arguments)},update:function(t,n){var a=this,i=new e.CommandMultimix;a.callActions("beforeUpdate",arguments),a.pending--,a.pending=Math.max(0,a.pending),a.pending>0||("live"===a.status?a.updateLive(t,n):(i.sort=a.sort,i.filter=a.filter,a.callFilters("actionsUpdate",i,arguments),a.parseStatusChange(a.el,t,i,n)),a.callActions("afterUpdate",arguments))},updateLive:function(t,n){var a=this,i=null,o=null,r=null,s=-1;if(a.callActions("beforeUpdateLive",arguments),a.el){for(i=a.el.querySelectorAll(a.selector),s=0;r=i[s];s++){switch(o=new e.CommandMultimix,a.type){case"filter":o.filter=r.getAttribute("data-filter");break;case"sort":o.sort=r.getAttribute("data-sort");break;case"multimix":o.filter=r.getAttribute("data-filter"),o.sort=r.getAttribute("data-sort");break;case"toggle":o.filter=r.getAttribute("data-toggle")}o=a.callFilters("actionsUpdateLive",o,arguments),a.parseStatusChange(r,t,o,n)}a.callActions("afterUpdateLive",arguments)}},parseStatusChange:function(t,e,n,a){var i=this,o="",r="",s=-1;switch(i.callActions("beforeParseStatusChange",arguments),i.type){case"filter":e.filter===n.filter?i.renderStatus(t,"active"):i.renderStatus(t,"inactive");break;case"multimix":e.sort===n.sort&&e.filter===n.filter?i.renderStatus(t,"active"):i.renderStatus(t,"inactive");break;case"sort":e.sort.match(/:asc/g)&&(o=e.sort.replace(/:asc/g,"")),e.sort===n.sort||o===n.sort?i.renderStatus(t,"active"):i.renderStatus(t,"inactive");break;case"toggle":for(a.length<1&&i.renderStatus(t,"inactive"),e.filter===n.filter&&i.renderStatus(t,"active"),s=0;s<a.length;s++){if(r=a[s],r===n.filter){i.renderStatus(t,"active");break}i.renderStatus(t,"inactive")}}i.callActions("afterParseStatusChange",arguments)},renderStatus:function(t,e){var a=this;switch(a.callActions("beforeRenderStatus",arguments),e){case"active":n.addClass(t,a.classNames.active),n.removeClass(t,a.classNames.disabled),a.canDisable&&(a.el.disabled=!1);break;case"inactive":n.removeClass(t,a.classNames.active),n.removeClass(t,a.classNames.disabled),a.canDisable&&(a.el.disabled=!1);break;case"disabled":a.canDisable&&(a.el.disabled=!0),n.addClass(t,a.classNames.disabled),n.removeClass(t,a.classNames.active)}"live"!==a.status&&(a.status=e),a.callActions("afterRenderStatus",arguments)}}),e.controls=[],e.StyleData=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.x=0,this.y=0,this.top=0,this.right=0,this.bottom=0,this.left=0,this.width=0,this.height=0,this.marginRight=0,this.marginBottom=0,this.opacity=0,this.scale=new e.TransformData,this.translateX=new e.TransformData,this.translateY=new e.TransformData,this.translateZ=new e.TransformData,this.rotateX=new e.TransformData,this.rotateY=new e.TransformData,this.rotateZ=new e.TransformData,this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.StyleData),e.StyleData.prototype=Object.create(e.Base.prototype),e.StyleData.prototype.constructor=e.StyleData,e.TransformData=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.value=0,this.unit="",this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.TransformData),e.TransformData.prototype=Object.create(e.Base.prototype),e.TransformData.prototype.constructor=e.TransformData,e.TransformDefaults=function(){e.StyleData.apply(this),this.callActions("beforeConstruct"),this.scale.value=.01,this.scale.unit="",this.translateX.value=20,this.translateX.unit="px",this.translateY.value=20,this.translateY.unit="px",this.translateZ.value=20,this.translateZ.unit="px",this.rotateX.value=90,this.rotateX.unit="deg",this.rotateY.value=90,this.rotateY.unit="deg",this.rotateX.value=90,this.rotateX.unit="deg",this.rotateZ.value=180,this.rotateZ.unit="deg",this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.TransformDefaults),e.TransformDefaults.prototype=Object.create(e.StyleData.prototype),e.TransformDefaults.prototype.constructor=e.TransformDefaults,e.transformDefaults=new e.TransformDefaults,e.EventDetail=function(){this.state=null,this.futureState=null,this.instance=null,this.originalEvent=null},e.Events=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.mixStart=null,this.mixBusy=null,this.mixEnd=null,this.mixFail=null,this.mixClick=null,this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.Events),e.Events.prototype=Object.create(e.Base.prototype),e.Events.prototype.constructor=e.Events,e.Events.prototype.fire=function(t,a,i,o){var r=this,s=null,l=new e.EventDetail;if(r.callActions("beforeFire",arguments),"undefined"==typeof r[t])throw new Error('Event type "'+t+'" not found.');l.state=new e.State,n.extend(l.state,i.state),i.futureState&&(l.futureState=new e.State,n.extend(l.futureState,i.futureState)),l.instance=i.instance,i.originalEvent&&(l.originalEvent=i.originalEvent),s=n.getCustomEvent(t,l,o),r.callFilters("eventFire",s,arguments),a.dispatchEvent(s)},e.events=new e.Events,e.QueueItem=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.args=[],this.instruction=null,this.triggerElement=null,this.deferred=null,this.isToggling=!1,this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.QueueItem),e.QueueItem.prototype=Object.create(e.Base.prototype),e.QueueItem.prototype.constructor=e.QueueItem,e.Mixer=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.config=new e.Config,
this.id="",this.isBusy=!1,this.isToggling=!1,this.incPadding=!0,this.controls=[],this.targets=[],this.origOrder=[],this.cache={},this.toggleArray=[],this.targetsMoved=0,this.targetsImmovable=0,this.targetsBound=0,this.targetsDone=0,this.staggerDuration=0,this.effectsIn=null,this.effectsOut=null,this.transformIn=[],this.transformOut=[],this.queue=[],this.state=null,this.lastOperation=null,this.lastClicked=null,this.userCallback=null,this.userDeferred=null,this.dom=new e.MixerDom,this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.Mixer),e.Mixer.prototype=Object.create(e.Base.prototype),n.extend(e.Mixer.prototype,{constructor:e.Mixer,attach:function(a,i,o,r){var s=this,l=null,c=-1;for(s.callActions("beforeAttach",arguments),s.id=o,r&&n.extend(s.config,r,!0,!0),s.sanitizeConfig(),s.cacheDom(a,i),s.config.layout.containerClassName&&n.addClass(s.dom.container,s.config.layout.containerClassName),e.features.has.transitions||(s.config.animation.enable=!1),"undefined"==typeof t.console&&(s.config.debug.showWarnings=!1),s.config.data.uidKey&&(s.config.controls.enable=!1),s.indexTargets(),s.state=s.getInitialState(),c=0;l=s.lastOperation.toHide[c];c++)l.hide();s.config.controls.enable&&(s.initControls(),s.updateControls({filter:s.state.activeFilter,sort:s.state.activeSort}),s.buildToggleArray(null,s.state)),s.parseEffects(),s.callActions("afterAttach",arguments)},sanitizeConfig:function(){var t=this;t.callActions("beforeSanitizeConfig",arguments),t.config.controls.scope=t.config.controls.scope.toLowerCase().trim(),t.config.controls.toggleLogic=t.config.controls.toggleLogic.toLowerCase().trim(),t.config.controls.toggleDefault=t.config.controls.toggleDefault.toLowerCase().trim(),t.config.animation.effects=t.config.animation.effects.trim(),t.callActions("afterSanitizeConfig",arguments)},getInitialState:function(){var t=this,n=new e.State,a=new e.Operation;if(t.callActions("beforeGetInitialState",arguments),n.activeContainerClassName=t.config.layout.containerClassName,t.config.load.dataset){if(!t.config.data.uidKey||"string"!=typeof t.config.data.uidKey)throw new TypeError(e.messages.errorConfigDataUidKeyNotSet());a.startDataset=a.newDataset=n.activeDataset=t.config.load.dataset.slice(),a.startContainerClassName=a.newContainerClassName=n.activeContainerClassName,a.show=t.targets.slice(),n=t.callFilters("stateGetInitialState",n,arguments)}else n.activeFilter=t.parseFilterArgs([t.config.load.filter]).command,n.activeSort=t.parseSortArgs([t.config.load.sort]).command,n.totalTargets=t.targets.length,n=t.callFilters("stateGetInitialState",n,arguments),n.activeSort.collection||n.activeSort.attribute||"random"===n.activeSort.order||"desc"===n.activeSort.order?(a.newSort=n.activeSort,t.sortOperation(a),t.printSort(!1,a),t.targets=a.newOrder):a.startOrder=a.newOrder=t.targets,a.startFilter=a.newFilter=n.activeFilter,a.startSort=a.newSort=n.activeSort,a.startContainerClassName=a.newContainerClassName=n.activeContainerClassName,"all"===a.newFilter.selector?a.newFilter.selector=t.config.selectors.target:"none"===a.newFilter.selector&&(a.newFilter.selector="");return a=t.callFilters("operationGetInitialState",a,[n]),t.lastOperation=a,a.newFilter&&t.filterOperation(a),n=t.buildState(a)},cacheDom:function(t,e){var n=this;n.callActions("beforeCacheDom",arguments),n.dom.document=e,n.dom.body=n.dom.document.querySelector("body"),n.dom.container=t,n.dom.parent=t,n.callActions("afterCacheDom",arguments)},indexTargets:function(){var t=this,a=null,i=null,o=null,r=-1;if(t.callActions("beforeIndexTargets",arguments),t.dom.targets=t.config.layout.allowNestedTargets?t.dom.container.querySelectorAll(t.config.selectors.target):n.children(t.dom.container,t.config.selectors.target,t.dom.document),t.dom.targets=n.arrayFromList(t.dom.targets),t.targets=[],(o=t.config.load.dataset)&&o.length!==t.dom.targets.length)throw new Error(e.messages.errorDatasetPrerenderedMismatch());if(t.dom.targets.length){for(r=0;i=t.dom.targets[r];r++)a=new e.Target,a.init(i,t,o?o[r]:void 0),a.isInDom=!0,t.targets.push(a);t.dom.parent=t.dom.targets[0].parentElement===t.dom.container?t.dom.container:t.dom.targets[0].parentElement}t.origOrder=t.targets,t.callActions("afterIndexTargets",arguments)},initControls:function(){var t=this,n="",a=null,i=null,o=null,r=null,s=null,l=-1,c=-1;switch(t.callActions("beforeInitControls",arguments),t.config.controls.scope){case"local":o=t.dom.container;break;case"global":o=t.dom.document;break;default:throw new Error(e.messages.errorConfigInvalidControlsScope())}for(l=0;n=e.controlDefinitions[l];l++)if(t.config.controls.live||n.live){if(n.parent){if(r=t.dom[n.parent],!r||r.length<0)continue;"number"!=typeof r.length&&(r=[r])}else r=[o];for(c=0;i=r[c];c++)s=t.getControl(i,n.type,n.selector),t.controls.push(s)}else for(a=o.querySelectorAll(t.config.selectors.control+n.selector),c=0;i=a[c];c++)s=t.getControl(i,n.type,""),s&&t.controls.push(s);t.callActions("afterInitControls",arguments)},getControl:function(t,a,i){var o=this,r=null,s=-1;if(o.callActions("beforeGetControl",arguments),!i)for(s=0;r=e.controls[s];s++){if(r.el===t&&r.isBound(o))return o.callFilters("controlGetControl",null,arguments);if(r.el===t&&r.type===a&&r.selector===i)return r.addBinding(o),o.callFilters("controlGetControl",r,arguments)}return r=new e.Control,r.init(t,a,i),r.classNames.base=n.getClassname(o.config.classNames,a),r.classNames.active=n.getClassname(o.config.classNames,a,o.config.classNames.modifierActive),r.classNames.disabled=n.getClassname(o.config.classNames,a,o.config.classNames.modifierDisabled),r.addBinding(o),o.callFilters("controlGetControl",r,arguments)},getToggleSelector:function(){var t=this,e="or"===t.config.controls.toggleLogic?", ":"",a="";return t.callActions("beforeGetToggleSelector",arguments),t.toggleArray=n.clean(t.toggleArray),a=t.toggleArray.join(e),""===a&&(a=t.config.controls.toggleDefault),t.callFilters("selectorGetToggleSelector",a,arguments)},buildToggleArray:function(t,e){var a=this,i="";if(a.callActions("beforeBuildToggleArray",arguments),t&&t.filter)i=t.filter.selector.replace(/\s/g,"");else{if(!e)return;i=e.activeFilter.selector.replace(/\s/g,"")}i!==a.config.selectors.target&&"all"!==i||(i=""),"or"===a.config.controls.toggleLogic?a.toggleArray=i.split(","):a.toggleArray=a.splitCompoundSelector(i),a.toggleArray=n.clean(a.toggleArray),a.callActions("afterBuildToggleArray",arguments)},splitCompoundSelector:function(t){var e=t.split(/([\.\[])/g),n=[],a="",i=-1;for(""===e[0]&&e.shift(),i=0;i<e.length;i++)i%2===0&&(a=""),a+=e[i],i%2!==0&&n.push(a);return n},updateControls:function(t){var a=this,i=null,o=new e.CommandMultimix,r=-1;for(a.callActions("beforeUpdateControls",arguments),t.filter?o.filter=t.filter.selector:o.filter=a.state.activeFilter.selector,t.sort?o.sort=a.buildSortString(t.sort):o.sort=a.buildSortString(a.state.activeSort),o.filter===a.config.selectors.target&&(o.filter="all"),""===o.filter&&(o.filter="none"),n.freeze(o),r=0;i=a.controls[r];r++)i.update(o,a.toggleArray);a.callActions("afterUpdateControls",arguments)},buildSortString:function(t){var e=this,n="";return n+=t.sortString,t.next&&(n+=" "+e.buildSortString(t.next)),n},insertTargets:function(t,a){var i=this,o=null,r=-1,s=null,l=null,c=null,u=-1;if(i.callActions("beforeInsertTargets",arguments),"undefined"==typeof t.index&&(t.index=0),o=i.getNextSibling(t.index,t.sibling,t.position),s=i.dom.document.createDocumentFragment(),r=o?n.index(o,i.config.selectors.target):i.targets.length,t.collection){for(u=0;c=t.collection[u];u++){if(i.dom.targets.indexOf(c)>-1)throw new Error(e.messages.errorInsertPreexistingElement());c.style.display="none",s.appendChild(c),s.appendChild(i.dom.document.createTextNode(" ")),n.isElement(c,i.dom.document)&&c.matches(i.config.selectors.target)&&(l=new e.Target,l.init(c,i),l.isInDom=!0,i.targets.splice(r,0,l),r++)}i.dom.parent.insertBefore(s,o)}a.startOrder=i.origOrder=i.targets,i.callActions("afterInsertTargets",arguments)},getNextSibling:function(t,e,n){var a=this,i=null;return t=Math.max(t,0),e&&"before"===n?i=e:e&&"after"===n?i=e.nextElementSibling||null:a.targets.length>0&&"undefined"!=typeof t?i=t<a.targets.length||!a.targets.length?a.targets[t].dom.el:a.targets[a.targets.length-1].dom.el.nextElementSibling:0===a.targets.length&&a.dom.parent.children.length>0&&(a.config.layout.siblingAfter?i=a.config.layout.siblingAfter:a.config.layout.siblingBefore?i=a.config.layout.siblingBefore.nextElementSibling:a.dom.parent.children[0]),a.callFilters("elementGetNextSibling",i,arguments)},filterOperation:function(t){var e=this,n=!1,a=-1,i="",o=null,r=-1;for(e.callActions("beforeFilterOperation",arguments),i=t.newFilter.action,r=0;o=t.newOrder[r];r++)n=t.newFilter.collection?t.newFilter.collection.indexOf(o.dom.el)>-1:""!==t.newFilter.selector&&o.dom.el.matches(t.newFilter.selector),e.evaluateHideShow(n,o,i,t);if(t.toRemove.length)for(r=0;o=t.show[r];r++)t.toRemove.indexOf(o)>-1&&(t.show.splice(r,1),(a=t.toShow.indexOf(o))>-1&&t.toShow.splice(a,1),t.toHide.push(o),t.hide.push(o),r--);t.matching=t.show.slice(),0===t.show.length&&""!==t.newFilter.selector&&0!==e.targets.length&&(t.hasFailed=!0),e.callActions("afterFilterOperation",arguments)},evaluateHideShow:function(t,e,n,a){var i=this;i.callActions("beforeEvaluateHideShow",arguments),t===!0&&"show"===n||t===!1&&"hide"===n?(a.show.push(e),!e.isShown&&a.toShow.push(e)):(a.hide.push(e),e.isShown&&a.toHide.push(e)),i.callActions("afterEvaluateHideShow",arguments)},sortOperation:function(t){var e=this;e.callActions("beforeSortOperation",arguments),t.startOrder=e.targets,t.newSort.collection?t.newOrder=t.newSort.collection:"random"===t.newSort.order?t.newOrder=n.arrayShuffle(t.startOrder):""===t.newSort.attribute?(t.newOrder=e.origOrder.slice(),"desc"===t.newSort.order&&t.newOrder.reverse()):(t.newOrder=t.startOrder.slice(),t.newOrder.sort(function(n,a){return e.compare(n,a,t.newSort)})),n.isEqualArray(t.newOrder,t.startOrder)&&(t.willSort=!1),e.callActions("afterSortOperation",arguments)},compare:function(t,e,n){var a=this,i=n.order,o=a.getAttributeValue(t,n.attribute),r=a.getAttributeValue(e,n.attribute);return isNaN(1*o)||isNaN(1*r)?(o=o.toLowerCase(),r=r.toLowerCase()):(o=1*o,r=1*r),o<r?"asc"===i?-1:1:o>r?"asc"===i?1:-1:o===r&&n.next?a.compare(t,e,n.next):0},getAttributeValue:function(t,n){var a=this,i="";return i=t.dom.el.getAttribute("data-"+n),null===i&&a.config.debug.showWarnings&&console.warn(e.messages.warningInconsistentSortingAttributes({attribute:"data-"+n})),a.callFilters("valueGetAttributeValue",i||0,arguments)},printSort:function(e,a){var i=this,o=e?a.newOrder:a.startOrder,r=e?a.startOrder:a.newOrder,s=o.length?o[o.length-1].dom.el.nextElementSibling:null,l=t.document.createDocumentFragment(),c=null,u=null,f=null,h=-1;for(i.callActions("beforePrintSort",arguments),h=0;u=o[h];h++)f=u.dom.el,"absolute"!==f.style.position&&(n.removeWhitespace(f.previousSibling),f.parentElement.removeChild(f));for(c=s?s.previousSibling:i.dom.parent.lastChild,c&&"#text"===c.nodeName&&n.removeWhitespace(c),h=0;u=r[h];h++)f=u.dom.el,n.isElement(l.lastChild)&&l.appendChild(t.document.createTextNode(" ")),l.appendChild(f);i.dom.parent.firstChild&&i.dom.parent.firstChild!==s&&l.insertBefore(t.document.createTextNode(" "),l.childNodes[0]),s?(l.appendChild(t.document.createTextNode(" ")),i.dom.parent.insertBefore(l,s)):i.dom.parent.appendChild(l),i.callActions("afterPrintSort",arguments)},parseSortString:function(t,a){var i=this,o=t.split(" "),r=a,s=[],l=-1;for(l=0;l<o.length;l++){switch(s=o[l].split(":"),r.sortString=o[l],r.attribute=n.dashCase(s[0]),r.order=s[1]||"asc",r.attribute){case"default":r.attribute="";break;case"random":r.attribute="",r.order="random"}if(!r.attribute||"random"===r.order)break;l<o.length-1&&(r.next=new e.CommandSort,n.freeze(r),r=r.next)}return i.callFilters("commandsParseSort",a,arguments)},parseEffects:function(){var t=this,n="",a=t.config.animation.effectsIn||t.config.animation.effects,i=t.config.animation.effectsOut||t.config.animation.effects;t.callActions("beforeParseEffects",arguments),t.effectsIn=new e.StyleData,t.effectsOut=new e.StyleData,t.transformIn=[],t.transformOut=[],t.effectsIn.opacity=t.effectsOut.opacity=1,t.parseEffect("fade",a,t.effectsIn,t.transformIn),t.parseEffect("fade",i,t.effectsOut,t.transformOut,!0);for(n in e.transformDefaults)e.transformDefaults[n]instanceof e.TransformData&&(t.parseEffect(n,a,t.effectsIn,t.transformIn),t.parseEffect(n,i,t.effectsOut,t.transformOut,!0));t.parseEffect("stagger",a,t.effectsIn,t.transformIn),t.parseEffect("stagger",i,t.effectsOut,t.transformOut,!0),t.callActions("afterParseEffects",arguments)},parseEffect:function(t,n,a,i,o){var r=this,s=/\(([^)]+)\)/,l=-1,c="",u=[],f="",h=["%","px","em","rem","vh","vw","deg"],d="",m=-1;if(r.callActions("beforeParseEffect",arguments),"string"!=typeof n)throw new TypeError(e.messages.errorConfigInvalidAnimationEffects());if(n.indexOf(t)<0)return void("stagger"===t&&(r.staggerDuration=0));switch(l=n.indexOf(t+"("),l>-1&&(c=n.substring(l),u=s.exec(c),f=u[1]),t){case"fade":a.opacity=f?parseFloat(f):0;break;case"stagger":r.staggerDuration=f?parseFloat(f):100;break;default:if(o&&r.config.animation.reverseOut&&"scale"!==t?a[t].value=(f?parseFloat(f):e.transformDefaults[t].value)*-1:a[t].value=f?parseFloat(f):e.transformDefaults[t].value,f){for(m=0;d=h[m];m++)if(f.indexOf(d)>-1){a[t].unit=d;break}}else a[t].unit=e.transformDefaults[t].unit;i.push(t+"("+a[t].value+a[t].unit+")")}r.callActions("afterParseEffect",arguments)},buildState:function(t){var n=this,a=new e.State,i=null,o=-1;for(n.callActions("beforeBuildState",arguments),o=0;i=n.targets[o];o++)(!t.toRemove.length||t.toRemove.indexOf(i)<0)&&a.targets.push(i.dom.el);for(o=0;i=t.matching[o];o++)a.matching.push(i.dom.el);for(o=0;i=t.show[o];o++)a.show.push(i.dom.el);for(o=0;i=t.hide[o];o++)(!t.toRemove.length||t.toRemove.indexOf(i)<0)&&a.hide.push(i.dom.el);return a.id=n.id,a.container=n.dom.container,a.activeFilter=t.newFilter,a.activeSort=t.newSort,a.activeDataset=t.newDataset,a.activeContainerClassName=t.newContainerClassName,a.hasFailed=t.hasFailed,a.totalTargets=n.targets.length,a.totalShow=t.show.length,a.totalHide=t.hide.length,a.totalMatching=t.matching.length,a.triggerElement=t.triggerElement,n.callFilters("stateBuildState",a,arguments)},goMix:function(a,i){var o=this,r=null;return o.callActions("beforeGoMix",arguments),o.config.animation.duration&&o.config.animation.effects&&n.isVisible(o.dom.container)||(a=!1),i.toShow.length||i.toHide.length||i.willSort||i.willChangeLayout||(a=!1),i.startState.show.length||i.show.length||(a=!1),e.events.fire("mixStart",o.dom.container,{state:i.startState,futureState:i.newState,instance:o},o.dom.document),"function"==typeof o.config.callbacks.onMixStart&&o.config.callbacks.onMixStart.call(o.dom.container,i.startState,i.newState,o),n.removeClass(o.dom.container,n.getClassname(o.config.classNames,"container",o.config.classNames.modifierFailed)),r=o.userDeferred?o.userDeferred:o.userDeferred=n.defer(e.libraries),o.isBusy=!0,a&&e.features.has.transitions?(t.pageYOffset!==i.docState.scrollTop&&t.scrollTo(i.docState.scrollLeft,i.docState.scrollTop),o.config.animation.applyPerspective&&(o.dom.parent.style[e.features.perspectiveProp]=o.config.animation.perspectiveDistance,o.dom.parent.style[e.features.perspectiveOriginProp]=o.config.animation.perspectiveOrigin),o.config.animation.animateResizeContainer&&i.startHeight!==i.newHeight&&i.viewportDeltaY!==i.startHeight-i.newHeight&&(o.dom.parent.style.height=i.startHeight+"px"),o.config.animation.animateResizeContainer&&i.startWidth!==i.newWidth&&i.viewportDeltaX!==i.startWidth-i.newWidth&&(o.dom.parent.style.width=i.startWidth+"px"),i.startHeight===i.newHeight&&(o.dom.parent.style.height=i.startHeight+"px"),i.startWidth===i.newWidth&&(o.dom.parent.style.width=i.startWidth+"px"),i.startHeight===i.newHeight&&i.startWidth===i.newWidth&&(o.dom.parent.style.overflow="hidden"),requestAnimationFrame(function(){o.moveTargets(i)}),o.callFilters("promiseGoMix",r.promise,arguments)):(o.config.debug.fauxAsync?setTimeout(function(){o.cleanUp(i)},o.config.animation.duration):o.cleanUp(i),o.callFilters("promiseGoMix",r.promise,arguments))},getStartMixData:function(n){var a=this,i=t.getComputedStyle(a.dom.parent),o=a.dom.parent.getBoundingClientRect(),r=null,s={},l=-1,c=i[e.features.boxSizingProp];for(a.incPadding="border-box"===c,a.callActions("beforeGetStartMixData",arguments),l=0;r=n.show[l];l++)s=r.getPosData(),n.showPosData[l]={startPosData:s};for(l=0;r=n.toHide[l];l++)s=r.getPosData(),n.toHidePosData[l]={startPosData:s};n.startX=o.left,n.startY=o.top,n.startHeight=a.incPadding?o.height:o.height-parseFloat(i.paddingTop)-parseFloat(i.paddingBottom)-parseFloat(i.borderTop)-parseFloat(i.borderBottom),n.startWidth=a.incPadding?o.width:o.width-parseFloat(i.paddingLeft)-parseFloat(i.paddingRight)-parseFloat(i.borderLeft)-parseFloat(i.borderRight),a.callActions("afterGetStartMixData",arguments)},setInter:function(t){var e=this,a=null,i=-1;for(e.callActions("beforeSetInter",arguments),e.config.animation.clampHeight&&(e.dom.parent.style.height=t.startHeight+"px",e.dom.parent.style.overflow="hidden"),e.config.animation.clampWidth&&(e.dom.parent.style.width=t.startWidth+"px",e.dom.parent.style.overflow="hidden"),i=0;a=t.toShow[i];i++)a.show();t.willChangeLayout&&(n.removeClass(e.dom.container,t.startContainerClassName),n.addClass(e.dom.container,t.newContainerClassName)),e.callActions("afterSetInter",arguments)},getInterMixData:function(t){var e=this,n=null,a=-1;for(e.callActions("beforeGetInterMixData",arguments),a=0;n=t.show[a];a++)t.showPosData[a].interPosData=n.getPosData();for(a=0;n=t.toHide[a];a++)t.toHidePosData[a].interPosData=n.getPosData();e.callActions("afterGetInterMixData",arguments)},setFinal:function(t){var e=this,n=null,a=-1;for(e.callActions("beforeSetFinal",arguments),t.willSort&&e.printSort(!1,t),a=0;n=t.toHide[a];a++)n.hide();e.callActions("afterSetFinal",arguments)},getFinalMixData:function(e){var a=this,i=null,o=null,r=null,s=-1;for(a.callActions("beforeGetFinalMixData",arguments),s=0;r=e.show[s];s++)e.showPosData[s].finalPosData=r.getPosData();for(s=0;r=e.toHide[s];s++)e.toHidePosData[s].finalPosData=r.getPosData();for((a.config.animation.clampHeight||a.config.animation.clampWidth)&&(a.dom.parent.style.height=a.dom.parent.style.width=a.dom.parent.style.overflow=""),a.incPadding||(i=t.getComputedStyle(a.dom.parent)),o=a.dom.parent.getBoundingClientRect(),e.newX=o.left,e.newY=o.top,e.newHeight=a.incPadding?o.height:o.height-parseFloat(i.paddingTop)-parseFloat(i.paddingBottom)-parseFloat(i.borderTop)-parseFloat(i.borderBottom),e.newWidth=a.incPadding?o.width:o.width-parseFloat(i.paddingLeft)-parseFloat(i.paddingRight)-parseFloat(i.borderLeft)-parseFloat(i.borderRight),e.viewportDeltaX=e.docState.viewportWidth-this.dom.document.documentElement.clientWidth,e.viewportDeltaY=e.docState.viewportHeight-this.dom.document.documentElement.clientHeight,e.willSort&&a.printSort(!0,e),s=0;r=e.toShow[s];s++)r.hide();for(s=0;r=e.toHide[s];s++)r.show();e.willChangeLayout&&(n.removeClass(a.dom.container,e.newContainerClassName),n.addClass(a.dom.container,a.config.layout.containerClassName)),a.callActions("afterGetFinalMixData",arguments)},getTweenData:function(t){var n=this,a=null,i=null,o=Object.getOwnPropertyNames(n.effectsIn),r="",s=null,l=-1,c=-1,u=-1,f=-1;for(n.callActions("beforeGetTweenData",arguments),u=0;a=t.show[u];u++)for(i=t.showPosData[u],i.posIn=new e.StyleData,i.posOut=new e.StyleData,i.tweenData=new e.StyleData,a.isShown?(i.posIn.x=i.startPosData.x-i.interPosData.x,i.posIn.y=i.startPosData.y-i.interPosData.y):i.posIn.x=i.posIn.y=0,i.posOut.x=i.finalPosData.x-i.interPosData.x,i.posOut.y=i.finalPosData.y-i.interPosData.y,i.posIn.opacity=a.isShown?1:n.effectsIn.opacity,i.posOut.opacity=1,i.tweenData.opacity=i.posOut.opacity-i.posIn.opacity,a.isShown||n.config.animation.nudge||(i.posIn.x=i.posOut.x,i.posIn.y=i.posOut.y),i.tweenData.x=i.posOut.x-i.posIn.x,i.tweenData.y=i.posOut.y-i.posIn.y,n.config.animation.animateResizeTargets&&(i.posIn.width=i.startPosData.width,i.posIn.height=i.startPosData.height,l=(i.startPosData.width||i.finalPosData.width)-i.interPosData.width,i.posIn.marginRight=i.startPosData.marginRight-l,c=(i.startPosData.height||i.finalPosData.height)-i.interPosData.height,i.posIn.marginBottom=i.startPosData.marginBottom-c,i.posOut.width=i.finalPosData.width,i.posOut.height=i.finalPosData.height,l=(i.finalPosData.width||i.startPosData.width)-i.interPosData.width,i.posOut.marginRight=i.finalPosData.marginRight-l,c=(i.finalPosData.height||i.startPosData.height)-i.interPosData.height,i.posOut.marginBottom=i.finalPosData.marginBottom-c,i.tweenData.width=i.posOut.width-i.posIn.width,i.tweenData.height=i.posOut.height-i.posIn.height,i.tweenData.marginRight=i.posOut.marginRight-i.posIn.marginRight,i.tweenData.marginBottom=i.posOut.marginBottom-i.posIn.marginBottom),f=0;r=o[f];f++)s=n.effectsIn[r],s instanceof e.TransformData&&s.value&&(i.posIn[r].value=s.value,i.posOut[r].value=0,i.tweenData[r].value=i.posOut[r].value-i.posIn[r].value,i.posIn[r].unit=i.posOut[r].unit=i.tweenData[r].unit=s.unit);for(u=0;a=t.toHide[u];u++)for(i=t.toHidePosData[u],i.posIn=new e.StyleData,i.posOut=new e.StyleData,i.tweenData=new e.StyleData,i.posIn.x=a.isShown?i.startPosData.x-i.interPosData.x:0,i.posIn.y=a.isShown?i.startPosData.y-i.interPosData.y:0,i.posOut.x=n.config.animation.nudge?0:i.posIn.x,i.posOut.y=n.config.animation.nudge?0:i.posIn.y,i.tweenData.x=i.posOut.x-i.posIn.x,i.tweenData.y=i.posOut.y-i.posIn.y,n.config.animation.animateResizeTargets&&(i.posIn.width=i.startPosData.width,i.posIn.height=i.startPosData.height,l=i.startPosData.width-i.interPosData.width,i.posIn.marginRight=i.startPosData.marginRight-l,c=i.startPosData.height-i.interPosData.height,i.posIn.marginBottom=i.startPosData.marginBottom-c),i.posIn.opacity=1,i.posOut.opacity=n.effectsOut.opacity,i.tweenData.opacity=i.posOut.opacity-i.posIn.opacity,f=0;r=o[f];f++)s=n.effectsOut[r],s instanceof e.TransformData&&s.value&&(i.posIn[r].value=0,i.posOut[r].value=s.value,i.tweenData[r].value=i.posOut[r].value-i.posIn[r].value,i.posIn[r].unit=i.posOut[r].unit=i.tweenData[r].unit=s.unit);n.callActions("afterGetTweenData",arguments)},moveTargets:function(t){var a=this,i=null,o=null,r=null,s="",l=!1,c=-1,u=-1,f=a.checkProgress.bind(a);for(a.callActions("beforeMoveTargets",arguments),u=0;i=t.show[u];u++)o=new e.IMoveData,r=t.showPosData[u],s=i.isShown?"none":"show",l=a.willTransition(s,t.hasEffect,r.posIn,r.posOut),l&&c++,i.show(),o.posIn=r.posIn,o.posOut=r.posOut,o.statusChange=s,o.staggerIndex=c,o.operation=t,o.callback=l?f:null,i.move(o);for(u=0;i=t.toHide[u];u++)r=t.toHidePosData[u],o=new e.IMoveData,s="hide",l=a.willTransition(s,r.posIn,r.posOut),o.posIn=r.posIn,o.posOut=r.posOut,o.statusChange=s,o.staggerIndex=u,o.operation=t,o.callback=l?f:null,i.move(o);a.config.animation.animateResizeContainer&&(a.dom.parent.style[e.features.transitionProp]="height "+a.config.animation.duration+"ms ease, width "+a.config.animation.duration+"ms ease ",requestAnimationFrame(function(){t.startHeight!==t.newHeight&&t.viewportDeltaY!==t.startHeight-t.newHeight&&(a.dom.parent.style.height=t.newHeight+"px"),t.startWidth!==t.newWidth&&t.viewportDeltaX!==t.startWidth-t.newWidth&&(a.dom.parent.style.width=t.newWidth+"px")})),t.willChangeLayout&&(n.removeClass(a.dom.container,a.config.layout.ContainerClassName),n.addClass(a.dom.container,t.newContainerClassName)),a.callActions("afterMoveTargets",arguments)},hasEffect:function(){var t=this,e=["scale","translateX","translateY","translateZ","rotateX","rotateY","rotateZ"],n="",a=null,i=!1,o=-1,r=-1;if(1!==t.effectsIn.opacity)return t.callFilters("resultHasEffect",!0,arguments);for(r=0;n=e[r];r++)if(a=t.effectsIn[n],o="undefined"!==a.value?a.value:a,0!==o){i=!0;break}return t.callFilters("resultHasEffect",i,arguments)},willTransition:function(t,e,a,i){var o=this,r=!1;return r=!!n.isVisible(o.dom.container)&&(!!("none"!==t&&e||a.x!==i.x||a.y!==i.y)||!!o.config.animation.animateResizeTargets&&(a.width!==i.width||a.height!==i.height||a.marginRight!==i.marginRight||a.marginTop!==i.marginTop)),o.callFilters("resultWillTransition",r,arguments)},checkProgress:function(t){var e=this;e.targetsDone++,e.targetsBound===e.targetsDone&&e.cleanUp(t)},cleanUp:function(t){var a=this,i=null,o=null,r=null,s=null,l=-1;for(a.callActions("beforeCleanUp",arguments),a.targetsMoved=a.targetsImmovable=a.targetsBound=a.targetsDone=0,l=0;i=t.show[l];l++)i.cleanUp(),i.show();for(l=0;i=t.toHide[l];l++)i.cleanUp(),i.hide();if(t.willSort&&a.printSort(!1,t),a.dom.parent.style[e.features.transitionProp]=a.dom.parent.style.height=a.dom.parent.style.width=a.dom.parent.style.overflow=a.dom.parent.style[e.features.perspectiveProp]=a.dom.parent.style[e.features.perspectiveOriginProp]="",t.willChangeLayout&&(n.removeClass(a.dom.container,t.startContainerClassName),n.addClass(a.dom.container,t.newContainerClassName)),t.toRemove.length){for(l=0;i=a.targets[l];l++)t.toRemove.indexOf(i)>-1&&((o=i.dom.el.previousSibling)&&"#text"===o.nodeName&&(r=i.dom.el.nextSibling)&&"#text"===r.nodeName&&n.removeWhitespace(o),t.willSort||a.dom.parent.removeChild(i.dom.el),a.targets.splice(l,1),i.isInDom=!1,l--);a.origOrder=a.targets}t.willSort&&(a.targets=t.newOrder),a.state=t.newState,a.lastOperation=t,a.dom.targets=a.state.targets,e.events.fire("mixEnd",a.dom.container,{state:a.state,instance:a},a.dom.document),"function"==typeof a.config.callbacks.onMixEnd&&a.config.callbacks.onMixEnd.call(a.dom.container,a.state,a),t.hasFailed&&(e.events.fire("mixFail",a.dom.container,{state:a.state,instance:a},a.dom.document),"function"==typeof a.config.callbacks.onMixFail&&a.config.callbacks.onMixFail.call(a.dom.container,a.state,a),n.addClass(a.dom.container,n.getClassname(a.config.classNames,"container",a.config.classNames.modifierFailed))),"function"==typeof a.userCallback&&a.userCallback.call(a.dom.container,a.state,a),"function"==typeof a.userDeferred.resolve&&a.userDeferred.resolve(a.state),a.userCallback=null,a.userDeferred=null,a.lastClicked=null,a.isToggling=!1,a.isBusy=!1,a.queue.length&&(a.callActions("beforeReadQueueCleanUp",arguments),s=a.queue.shift(),a.userDeferred=s.deferred,a.isToggling=s.isToggling,a.lastClicked=s.triggerElement,s.instruction.command instanceof e.CommandMultimix?a.multimix.apply(a,s.args):a.dataset.apply(a,s.args)),a.callActions("afterCleanUp",arguments)},parseMultimixArgs:function(t){var a=this,i=new e.UserInstruction,o=null,r=-1;for(i.animate=a.config.animation.enable,i.command=new e.CommandMultimix,r=0;r<t.length;r++)o=t[r],null!==o&&("object"==typeof o?n.extend(i.command,o):"boolean"==typeof o?i.animate=o:"function"==typeof o&&(i.callback=o));return!i.command.insert||i.command.insert instanceof e.CommandInsert||(i.command.insert=a.parseInsertArgs([i.command.insert]).command),!i.command.remove||i.command.remove instanceof e.CommandRemove||(i.command.remove=a.parseRemoveArgs([i.command.remove]).command),!i.command.filter||i.command.filter instanceof e.CommandFilter||(i.command.filter=a.parseFilterArgs([i.command.filter]).command),!i.command.sort||i.command.sort instanceof e.CommandSort||(i.command.sort=a.parseSortArgs([i.command.sort]).command),!i.command.changeLayout||i.command.changeLayout instanceof e.CommandChangeLayout||(i.command.changeLayout=a.parseChangeLayoutArgs([i.command.changeLayout]).command),i=a.callFilters("instructionParseMultimixArgs",i,arguments),n.freeze(i),i},parseFilterArgs:function(t){var a=this,i=new e.UserInstruction,o=null,r=-1;for(i.animate=a.config.animation.enable,i.command=new e.CommandFilter,r=0;r<t.length;r++)o=t[r],"string"==typeof o?i.command.selector=o:null===o?i.command.collection=[]:"object"==typeof o&&n.isElement(o,a.dom.document)?i.command.collection=[o]:"object"==typeof o&&"undefined"!=typeof o.length?i.command.collection=n.arrayFromList(o):"object"==typeof o?n.extend(i.command,o):"boolean"==typeof o?i.animate=o:"function"==typeof o&&(i.callback=o);if(i.command.selector&&i.command.collection)throw new Error(e.messages.errorFilterInvalidArguments());return i=a.callFilters("instructionParseFilterArgs",i,arguments),n.freeze(i),i},parseSortArgs:function(t){var a=this,i=new e.UserInstruction,o=null,r="",s=-1;for(i.animate=a.config.animation.enable,i.command=new e.CommandSort,s=0;s<t.length;s++)if(o=t[s],null!==o)switch(typeof o){case"string":r=o;break;case"object":o.length&&(i.command.collection=n.arrayFromList(o));break;case"boolean":i.animate=o;break;case"function":i.callback=o}return r&&(i.command=a.parseSortString(r,i.command)),i=a.callFilters("instructionParseSortArgs",i,arguments),n.freeze(i),i},parseInsertArgs:function(t){var a=this,i=new e.UserInstruction,o=null,r=-1;for(i.animate=a.config.animation.enable,i.command=new e.CommandInsert,r=0;r<t.length;r++)o=t[r],null!==o&&("number"==typeof o?i.command.index=o:"string"==typeof o&&["before","after"].indexOf(o)>-1?i.command.position=o:"string"==typeof o?i.command.collection=n.arrayFromList(n.createElement(o).childNodes):"object"==typeof o&&n.isElement(o,a.dom.document)?i.command.collection.length?i.command.sibling=o:i.command.collection=[o]:"object"==typeof o&&o.length?i.command.collection.length?i.command.sibling=o[0]:i.command.collection=o:"object"==typeof o&&o.childNodes&&o.childNodes.length?i.command.collection.length?i.command.sibling=o.childNodes[0]:i.command.collection=n.arrayFromList(o.childNodes):"object"==typeof o?n.extend(i.command,o):"boolean"==typeof o?i.animate=o:"function"==typeof o&&(i.callback=o));if(i.command.index&&i.command.sibling)throw new Error(e.messages.errorInsertInvalidArguments());return!i.command.collection.length&&a.config.debug.showWarnings&&console.warn(e.messages.warningInsertNoElements()),i=a.callFilters("instructionParseInsertArgs",i,arguments),n.freeze(i),i},parseRemoveArgs:function(t){var a=this,i=new e.UserInstruction,o=null,r=null,s=-1;for(i.animate=a.config.animation.enable,i.command=new e.CommandRemove,s=0;s<t.length;s++)if(r=t[s],null!==r)switch(typeof r){case"number":a.targets[r]&&(i.command.targets[0]=a.targets[r]);break;case"string":i.command.collection=n.arrayFromList(a.dom.parent.querySelectorAll(r));break;case"object":r&&r.length?i.command.collection=r:n.isElement(r,a.dom.document)?i.command.collection=[r]:n.extend(i.command,r);break;case"boolean":i.animate=r;break;case"function":i.callback=r}if(i.command.collection.length)for(s=0;o=a.targets[s];s++)i.command.collection.indexOf(o.dom.el)>-1&&i.command.targets.push(o);return!i.command.targets.length&&a.config.debug.showWarnings&&console.warn(e.messages.warningRemoveNoElements()),n.freeze(i),i},parseDatasetArgs:function(t){var a=this,i=new e.UserInstruction,o=null,r=-1;for(i.animate=a.config.animation.enable,i.command=new e.CommandDataset,r=0;r<t.length;r++)if(o=t[r],null!==o)switch(typeof o){case"object":Array.isArray(o)||"number"==typeof o.length?i.command.dataset=o:n.extend(i.command,o);break;case"boolean":i.animate=o;break;case"function":i.callback=o}return n.freeze(i),i},parseChangeLayoutArgs:function(t){var a=this,i=new e.UserInstruction,o=null,r=-1;for(i.animate=a.config.animation.enable,i.command=new e.CommandChangeLayout,r=0;r<t.length;r++)if(o=t[r],null!==o)switch(typeof o){case"string":i.command.containerClassName=o;break;case"object":n.extend(i.command,o);break;case"boolean":i.animate=o;break;case"function":i.callback=o}return n.freeze(i),i},queueMix:function(t){var a=this,i=null,o="";return a.callActions("beforeQueueMix",arguments),i=n.defer(e.libraries),a.config.animation.queue&&a.queue.length<a.config.animation.queueLimit?(t.deferred=i,a.queue.push(t),a.config.controls.enable&&(a.isToggling?(a.buildToggleArray(t.instruction.command),o=a.getToggleSelector(),a.updateControls({filter:{selector:o}})):a.updateControls(t.instruction.command))):(a.config.debug.showWarnings&&console.warn(e.messages.warningMultimixInstanceQueueFull()),i.resolve(a.state),e.events.fire("mixBusy",a.dom.container,{state:a.state,
instance:a},a.dom.document),"function"==typeof a.config.callbacks.onMixBusy&&a.config.callbacks.onMixBusy.call(a.dom.container,a.state,a)),a.callFilters("promiseQueueMix",i.promise,arguments)},getDataOperation:function(t){var a=this,i=new e.Operation,o=[];if(i=a.callFilters("operationUnmappedGetDataOperation",i,arguments),a.dom.targets.length&&!(o=a.state.activeDataset||[]).length)throw new Error(e.messages.errorDatasetNotSet());return i.id=n.randomHex(),i.startState=a.state,i.startDataset=o,i.newDataset=t.slice(),a.diffDatasets(i),i.startOrder=a.targets,i.newOrder=i.show,a.config.animation.enable&&(a.getStartMixData(i),a.setInter(i),i.docState=n.getDocumentState(a.dom.document),a.getInterMixData(i),a.setFinal(i),a.getFinalMixData(i),a.parseEffects(),i.hasEffect=a.hasEffect(),a.getTweenData(i)),a.targets=i.show.slice(),i.newState=a.buildState(i),Array.prototype.push.apply(a.targets,i.toRemove),i=a.callFilters("operationMappedGetDataOperation",i,arguments)},diffDatasets:function(t){var a=this,i=[],o=[],r=[],s=null,l=null,c=null,u=null,f=null,h={},d="",m=-1;for(a.callActions("beforeDiffDatasets",arguments),m=0;s=t.newDataset[m];m++){if("undefined"==typeof(d=s[a.config.data.uidKey])||d.toString().length<1)throw new TypeError(e.messages.errorDatasetInvalidUidKey({uidKey:a.config.data.uidKey}));if(h[d])throw new Error(e.messages.errorDatasetDuplicateUid({uid:d}));h[d]=!0,(l=a.cache[d])instanceof e.Target?(a.config.data.dirtyCheck&&!n.deepEquals(s,l.data)&&(c=l.render(s),l.data=s,c!==l.dom.el&&(l.isInDom&&(l.unbindEvents(),a.dom.parent.replaceChild(c,l.dom.el)),l.isShown||(c.style.display="none"),l.dom.el=c,l.isInDom&&l.bindEvents())),c=l.dom.el):(l=new e.Target,l.init(null,a,s),l.hide()),l.isInDom?(f=l.dom.el.nextElementSibling,o.push(d),u&&(u.lastElementChild&&u.appendChild(a.dom.document.createTextNode(" ")),a.insertDatasetFrag(u,l.dom.el,a.targets.indexOf(l),r),u=null)):(u||(u=a.dom.document.createDocumentFragment()),u.lastElementChild&&u.appendChild(a.dom.document.createTextNode(" ")),u.appendChild(l.dom.el),l.isInDom=!0,l.unbindEvents(),l.bindEvents(),l.hide(),t.toShow.push(l),r.push(l)),t.show.push(l)}for(u&&(f=f||a.config.layout.siblingAfter,f&&u.appendChild(a.dom.document.createTextNode(" ")),a.insertDatasetFrag(u,f,a.dom.targets.length,r)),m=0;s=t.startDataset[m];m++)d=s[a.config.data.uidKey],l=a.cache[d],t.show.indexOf(l)<0?(t.hide.push(l),t.toHide.push(l),t.toRemove.push(l)):i.push(d);n.isEqualArray(i,o)||(t.willSort=!0),a.callActions("afterDiffDatasets",arguments)},insertDatasetFrag:function(t,e,n,a){var i=this;for(i.dom.parent.insertBefore(t,e);a.length;)i.targets.splice(n,0,a.shift()),n++},willSort:function(t,e){var n=this,a=!1;return a=!!(n.config.behavior.liveSort||"random"===t.order||t.attribute!==e.attribute||t.order!==e.order||t.collection!==e.collection||null===t.next&&e.next||t.next&&null===e.next)||!(!t.next||!e.next)&&n.willSort(t.next,e.next),n.callFilters("resultWillSort",a,arguments)},show:function(){var t=this;return t.filter("all")},hide:function(){var t=this;return t.filter("none")},isMixing:function(){var t=this;return t.isBusy},filter:function(){var t=this,e=t.parseFilterArgs(arguments);return t.multimix({filter:e.command},e.animate,e.callback)},toggleOn:function(){var t=this,e=t.parseFilterArgs(arguments),n=e.command.selector,a="";return t.isToggling=!0,t.toggleArray.indexOf(n)<0&&t.toggleArray.push(n),a=t.getToggleSelector(),t.multimix({filter:a},e.animate,e.callback)},toggleOff:function(){var t=this,e=t.parseFilterArgs(arguments),n=e.command.selector,a="";return t.isToggling=!0,t.toggleArray.splice(t.toggleArray.indexOf(n),1),a=t.getToggleSelector(),t.multimix({filter:a},e.animate,e.callback)},sort:function(){var t=this,e=t.parseSortArgs(arguments);return t.multimix({sort:e.command},e.animate,e.callback)},changeLayout:function(){var t=this,e=t.parseChangeLayoutArgs(arguments);return t.multimix({changeLayout:e.command},e.animate,e.callback)},dataset:function(){var t=this,n=t.parseDatasetArgs(arguments),a=null,i=null,o=!1;return t.callActions("beforeDataset",arguments),t.isBusy?(i=new e.QueueItem,i.args=arguments,i.instruction=n,t.queueMix(i)):(n.callback&&(t.userCallback=n.callback),o=n.animate^t.config.animation.enable?n.animate:t.config.animation.enable,a=t.getDataOperation(n.command.dataset),t.goMix(o,a))},multimix:function(){var t=this,n=null,a=!1,i=null,o=t.parseMultimixArgs(arguments);return t.callActions("beforeMultimix",arguments),t.isBusy?(i=new e.QueueItem,i.args=arguments,i.instruction=o,i.triggerElement=t.lastClicked,i.isToggling=t.isToggling,t.queueMix(i)):(n=t.getOperation(o.command),t.config.controls.enable&&(o.command.filter&&!t.isToggling&&(t.toggleArray.length=0,t.buildToggleArray(n.command)),t.queue.length<1&&t.updateControls(n.command)),o.callback&&(t.userCallback=o.callback),a=o.animate^t.config.animation.enable?o.animate:t.config.animation.enable,t.callFilters("operationMultimix",n,arguments),t.goMix(a,n))},getOperation:function(t){var a=this,i=t.sort,o=t.filter,r=t.changeLayout,s=t.remove,l=t.insert,c=new e.Operation;return c=a.callFilters("operationUnmappedGetOperation",c,arguments),c.id=n.randomHex(),c.command=t,c.startState=a.state,c.triggerElement=a.lastClicked,a.isBusy?(a.config.debug.showWarnings&&console.warn(e.messages.warningGetOperationInstanceBusy()),null):(l&&a.insertTargets(l,c),s&&(c.toRemove=s.targets),c.startSort=c.newSort=c.startState.activeSort,c.startOrder=c.newOrder=a.targets,i&&(c.startSort=c.startState.activeSort,c.newSort=i,c.willSort=a.willSort(i,c.startState.activeSort),c.willSort&&a.sortOperation(c)),c.startFilter=c.startState.activeFilter,o?c.newFilter=o:c.newFilter=n.extend(new e.CommandFilter,c.startFilter),"all"===c.newFilter.selector?c.newFilter.selector=a.config.selectors.target:"none"===c.newFilter.selector&&(c.newFilter.selector=""),a.filterOperation(c),c.startContainerClassName=c.startState.activeContainerClassName,r?(c.newContainerClassName=r.containerClassName,c.newContainerClassName!==c.startContainerClassName&&(c.willChangeLayout=!0)):c.newContainerClassName=c.startContainerClassName,a.config.animation.enable&&(a.getStartMixData(c),a.setInter(c),c.docState=n.getDocumentState(a.dom.document),a.getInterMixData(c),a.setFinal(c),a.getFinalMixData(c),a.parseEffects(),c.hasEffect=a.hasEffect(),a.getTweenData(c)),c.willSort&&(a.targets=c.newOrder),c.newState=a.buildState(c),a.callFilters("operationMappedGetOperation",c,arguments))},tween:function(t,e){var n=null,a=null,i=-1,o=-1;for(e=Math.min(e,1),e=Math.max(e,0),o=0;n=t.show[o];o++)a=t.showPosData[o],n.applyTween(a,e);for(o=0;n=t.hide[o];o++)n.isShown&&n.hide(),(i=t.toHide.indexOf(n))>-1&&(a=t.toHidePosData[i],n.isShown||n.show(),n.applyTween(a,e))},insert:function(){var t=this,e=t.parseInsertArgs(arguments);return t.multimix({insert:e.command},e.animate,e.callback)},insertBefore:function(){var t=this,e=t.parseInsertArgs(arguments);return t.insert(e.command.collection,"before",e.command.sibling,e.animate,e.callback)},insertAfter:function(){var t=this,e=t.parseInsertArgs(arguments);return t.insert(e.command.collection,"after",e.command.sibling,e.animate,e.callback)},prepend:function(){var t=this,e=t.parseInsertArgs(arguments);return t.insert(0,e.command.collection,e.animate,e.callback)},append:function(){var t=this,e=t.parseInsertArgs(arguments);return t.insert(t.state.totalTargets,e.command.collection,e.animate,e.callback)},remove:function(){var t=this,e=t.parseRemoveArgs(arguments);return t.multimix({remove:e.command},e.animate,e.callback)},getConfig:function(t){var e=this,a=null;return a=t?n.getProperty(e.config,t):e.config,e.callFilters("valueGetConfig",a,arguments)},configure:function(t){var e=this;e.callActions("beforeConfigure",arguments),n.extend(e.config,t,!0,!0),e.callActions("afterConfigure",arguments)},getState:function(){var t=this,a=null;return a=new e.State,n.extend(a,t.state),n.freeze(a),t.callFilters("stateGetState",a,arguments)},forceRefresh:function(){var t=this;t.indexTargets()},destroy:function(t){var n=this,a=null,i=null,o=0;for(n.callActions("beforeDestroy",arguments),o=0;a=n.controls[o];o++)a.removeBinding(n);for(o=0;i=n.targets[o];o++)t&&i.show(),i.unbindEvents();n.dom.container.id.match(/^MixItUp/)&&n.dom.container.removeAttribute("id"),delete e.instances[n.id],n.callActions("afterDestroy",arguments)}}),e.IMoveData=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.posIn=null,this.posOut=null,this.operation=null,this.callback=null,this.statusChange="",this.duration=-1,this.staggerIndex=-1,this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.IMoveData),e.IMoveData.prototype=Object.create(e.Base.prototype),e.IMoveData.prototype.constructor=e.IMoveData,e.TargetDom=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.el=null,this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.TargetDom),e.TargetDom.prototype=Object.create(e.Base.prototype),e.TargetDom.prototype.constructor=e.TargetDom,e.Target=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.id="",this.sortString="",this.mixer=null,this.callback=null,this.isShown=!1,this.isBound=!1,this.isExcluded=!1,this.isInDom=!1,this.handler=null,this.operation=null,this.data=null,this.dom=new e.TargetDom,this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.Target),e.Target.prototype=Object.create(e.Base.prototype),n.extend(e.Target.prototype,{constructor:e.Target,init:function(t,n,a){var i=this,o="";if(i.callActions("beforeInit",arguments),i.mixer=n,t||(t=i.render(a)),i.cacheDom(t),i.bindEvents(),"none"!==i.dom.el.style.display&&(i.isShown=!0),a&&n.config.data.uidKey){if("undefined"==typeof(o=a[n.config.data.uidKey])||o.toString().length<1)throw new TypeError(e.messages.errorDatasetInvalidUidKey({uidKey:n.config.data.uidKey}));i.id=o,i.data=a,n.cache[o]=i}i.callActions("afterInit",arguments)},render:function(t){var a=this,i=null,o=null,r=null,s="";if(a.callActions("beforeRender",arguments),i=a.callFilters("renderRender",a.mixer.config.render.target,arguments),"function"!=typeof i)throw new TypeError(e.messages.errorDatasetRendererNotSet());return s=i(t),s&&"object"==typeof s&&n.isElement(s)?o=s:"string"==typeof s&&(r=document.createElement("div"),r.innerHTML=s,o=r.firstElementChild),a.callFilters("elRender",o,arguments)},cacheDom:function(t){var e=this;e.callActions("beforeCacheDom",arguments),e.dom.el=t,e.callActions("afterCacheDom",arguments)},getSortString:function(t){var e=this,n=e.dom.el.getAttribute("data-"+t)||"";e.callActions("beforeGetSortString",arguments),n=isNaN(1*n)?n.toLowerCase():1*n,e.sortString=n,e.callActions("afterGetSortString",arguments)},show:function(){var t=this;t.callActions("beforeShow",arguments),t.isShown||(t.dom.el.style.display="",t.isShown=!0),t.callActions("afterShow",arguments)},hide:function(){var t=this;t.callActions("beforeHide",arguments),t.isShown&&(t.dom.el.style.display="none",t.isShown=!1),t.callActions("afterHide",arguments)},move:function(t){var e=this;e.callActions("beforeMove",arguments),e.isExcluded||e.mixer.targetsMoved++,e.applyStylesIn(t),requestAnimationFrame(function(){e.applyStylesOut(t)}),e.callActions("afterMove",arguments)},applyTween:function(t,n){var a=this,i="",o=null,r=t.posIn,s=[],l=new e.StyleData,c=-1;for(a.callActions("beforeApplyTween",arguments),l.x=r.x,l.y=r.y,0===n?a.hide():a.isShown||a.show(),c=0;i=e.features.TWEENABLE[c];c++)if(o=t.tweenData[i],"x"===i){if(!o)continue;l.x=r.x+o*n}else if("y"===i){if(!o)continue;l.y=r.y+o*n}else if(o instanceof e.TransformData){if(!o.value)continue;l[i].value=r[i].value+o.value*n,l[i].unit=o.unit,s.push(i+"("+l[i].value+o.unit+")")}else{if(!o)continue;l[i]=r[i]+o*n,a.dom.el.style[i]=l[i]}(l.x||l.y)&&s.unshift("translate("+l.x+"px, "+l.y+"px)"),s.length&&(a.dom.el.style[e.features.transformProp]=s.join(" ")),a.callActions("afterApplyTween",arguments)},applyStylesIn:function(t){var n=this,a=t.posIn,i=1!==n.mixer.effectsIn.opacity,o=[];n.callActions("beforeApplyStylesIn",arguments),o.push("translate("+a.x+"px, "+a.y+"px)"),n.mixer.config.animation.animateResizeTargets&&("show"!==t.statusChange&&(n.dom.el.style.width=a.width+"px",n.dom.el.style.height=a.height+"px"),n.dom.el.style.marginRight=a.marginRight+"px",n.dom.el.style.marginBottom=a.marginBottom+"px"),i&&(n.dom.el.style.opacity=a.opacity),"show"===t.statusChange&&(o=o.concat(n.mixer.transformIn)),n.dom.el.style[e.features.transformProp]=o.join(" "),n.callActions("afterApplyStylesIn",arguments)},applyStylesOut:function(t){var n=this,a=[],i=[],o=n.mixer.config.animation.animateResizeTargets,r="undefined"!=typeof n.mixer.effectsIn.opacity;if(n.callActions("beforeApplyStylesOut",arguments),a.push(n.writeTransitionRule(e.features.transformRule,t.staggerIndex)),"none"!==t.statusChange&&a.push(n.writeTransitionRule("opacity",t.staggerIndex,t.duration)),o&&(a.push(n.writeTransitionRule("width",t.staggerIndex,t.duration)),a.push(n.writeTransitionRule("height",t.staggerIndex,t.duration)),a.push(n.writeTransitionRule("margin",t.staggerIndex,t.duration))),!t.callback)return n.mixer.targetsImmovable++,void(n.mixer.targetsMoved===n.mixer.targetsImmovable&&n.mixer.cleanUp(t.operation));switch(n.operation=t.operation,n.callback=t.callback,!n.isExcluded&&n.mixer.targetsBound++,n.isBound=!0,n.applyTransition(a),o&&t.posOut.width>0&&t.posOut.height>0&&(n.dom.el.style.width=t.posOut.width+"px",n.dom.el.style.height=t.posOut.height+"px",n.dom.el.style.marginRight=t.posOut.marginRight+"px",n.dom.el.style.marginBottom=t.posOut.marginBottom+"px"),n.mixer.config.animation.nudge||"hide"!==t.statusChange||i.push("translate("+t.posOut.x+"px, "+t.posOut.y+"px)"),t.statusChange){case"hide":r&&(n.dom.el.style.opacity=n.mixer.effectsOut.opacity),i=i.concat(n.mixer.transformOut);break;case"show":r&&(n.dom.el.style.opacity=1)}(n.mixer.config.animation.nudge||!n.mixer.config.animation.nudge&&"hide"!==t.statusChange)&&i.push("translate("+t.posOut.x+"px, "+t.posOut.y+"px)"),n.dom.el.style[e.features.transformProp]=i.join(" "),n.callActions("afterApplyStylesOut",arguments)},writeTransitionRule:function(t,e,n){var a=this,i=a.getDelay(e),o="";return o=t+" "+(n>0?n:a.mixer.config.animation.duration)+"ms "+i+"ms "+("opacity"===t?"linear":a.mixer.config.animation.easing),a.callFilters("ruleWriteTransitionRule",o,arguments)},getDelay:function(t){var e=this,n=-1;return"function"==typeof e.mixer.config.animation.staggerSequence&&(t=e.mixer.config.animation.staggerSequence.call(e,t,e.state)),n=e.mixer.staggerDuration?t*e.mixer.staggerDuration:0,e.callFilters("delayGetDelay",n,arguments)},applyTransition:function(t){var n=this,a=t.join(", ");n.callActions("beforeApplyTransition",arguments),n.dom.el.style[e.features.transitionProp]=a,n.callActions("afterApplyTransition",arguments)},handleTransitionEnd:function(t){var e=this,n=t.propertyName,a=e.mixer.config.animation.animateResizeTargets;e.callActions("beforeHandleTransitionEnd",arguments),e.isBound&&t.target.matches(e.mixer.config.selectors.target)&&(n.indexOf("transform")>-1||n.indexOf("opacity")>-1||a&&n.indexOf("height")>-1||a&&n.indexOf("width")>-1||a&&n.indexOf("margin")>-1)&&(e.callback.call(e,e.operation),e.isBound=!1,e.callback=null,e.operation=null),e.callActions("afterHandleTransitionEnd",arguments)},eventBus:function(t){var e=this;switch(e.callActions("beforeEventBus",arguments),t.type){case"webkitTransitionEnd":case"transitionend":e.handleTransitionEnd(t)}e.callActions("afterEventBus",arguments)},unbindEvents:function(){var t=this;t.callActions("beforeUnbindEvents",arguments),n.off(t.dom.el,"webkitTransitionEnd",t.handler),n.off(t.dom.el,"transitionend",t.handler),t.callActions("afterUnbindEvents",arguments)},bindEvents:function(){var t=this,a="";t.callActions("beforeBindEvents",arguments),a="webkit"===e.features.transitionPrefix?"webkitTransitionEnd":"transitionend",t.handler=function(e){return t.eventBus(e)},n.on(t.dom.el,a,t.handler),t.callActions("afterBindEvents",arguments)},getPosData:function(n){var a=this,i={},o=null,r=new e.StyleData;return a.callActions("beforeGetPosData",arguments),r.x=a.dom.el.offsetLeft,r.y=a.dom.el.offsetTop,(a.mixer.config.animation.animateResizeTargets||n)&&(o=a.dom.el.getBoundingClientRect(),r.top=o.top,r.right=o.right,r.bottom=o.bottom,r.left=o.left,r.width=o.width,r.height=o.height),a.mixer.config.animation.animateResizeTargets&&(i=t.getComputedStyle(a.dom.el),r.marginBottom=parseFloat(i.marginBottom),r.marginRight=parseFloat(i.marginRight)),a.callFilters("posDataGetPosData",r,arguments)},cleanUp:function(){var t=this;t.callActions("beforeCleanUp",arguments),t.dom.el.style[e.features.transformProp]="",t.dom.el.style[e.features.transitionProp]="",t.dom.el.style.opacity="",t.mixer.config.animation.animateResizeTargets&&(t.dom.el.style.width="",t.dom.el.style.height="",t.dom.el.style.marginRight="",t.dom.el.style.marginBottom=""),t.callActions("afterCleanUp",arguments)}}),e.Collection=function(t){var e=null,a=-1;for(this.callActions("beforeConstruct"),a=0;e=t[a];a++)this[a]=e;this.length=t.length,this.callActions("afterConstruct"),n.freeze(this)},e.BaseStatic.call(e.Collection),e.Collection.prototype=Object.create(e.Base.prototype),n.extend(e.Collection.prototype,{constructor:e.Collection,mixitup:function(t){var a=this,i=null,o=Array.prototype.slice.call(arguments),r=[],s=-1;for(this.callActions("beforeMixitup"),o.shift(),s=0;i=a[s];s++)r.push(i[t].apply(i,o));return a.callFilters("promiseMixitup",n.all(r,e.libraries),arguments)}}),e.Operation=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.id="",this.args=[],this.command=null,this.showPosData=[],this.toHidePosData=[],this.startState=null,this.newState=null,this.docState=null,this.willSort=!1,this.willChangeLayout=!1,this.hasEffect=!1,this.hasFailed=!1,this.triggerElement=null,this.show=[],this.hide=[],this.matching=[],this.toShow=[],this.toHide=[],this.toMove=[],this.toRemove=[],this.startOrder=[],this.newOrder=[],this.startSort=null,this.newSort=null,this.startFilter=null,this.newFilter=null,this.startDataset=null,this.newDataset=null,this.viewportDeltaX=0,this.viewportDeltaY=0,this.startX=0,this.startY=0,this.startHeight=0,this.startWidth=0,this.newX=0,this.newY=0,this.newHeight=0,this.newWidth=0,this.startContainerClassName="",this.startDisplay="",this.newContainerClassName="",this.newDisplay="",this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.Operation),e.Operation.prototype=Object.create(e.Base.prototype),e.Operation.prototype.constructor=e.Operation,e.State=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.id="",this.activeFilter=null,this.activeSort=null,this.activeContainerClassName="",this.container=null,this.targets=[],this.hide=[],this.show=[],this.matching=[],this.totalTargets=-1,this.totalShow=-1,this.totalHide=-1,this.totalMatching=-1,this.hasFailed=!1,this.triggerElement=null,this.activeDataset=null,this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.State),e.State.prototype=Object.create(e.Base.prototype),e.State.prototype.constructor=e.State,e.UserInstruction=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.command={},this.animate=!1,this.callback=null,this.callActions("afterConstruct"),n.seal(this)},e.BaseStatic.call(e.UserInstruction),e.UserInstruction.prototype=Object.create(e.Base.prototype),e.UserInstruction.prototype.constructor=e.UserInstruction,e.Messages=function(){e.Base.call(this),this.callActions("beforeConstruct"),this.ERROR_FACTORY_INVALID_CONTAINER="[MixItUp] An invalid selector or element reference was passed to the mixitup factory function",this.ERROR_FACTORY_CONTAINER_NOT_FOUND="[MixItUp] The provided selector yielded no container element",this.ERROR_CONFIG_INVALID_ANIMATION_EFFECTS="[MixItUp] Invalid value for `animation.effects`",this.ERROR_CONFIG_INVALID_CONTROLS_SCOPE="[MixItUp] Invalid value for `controls.scope`",this.ERROR_CONFIG_INVALID_PROPERTY='[MixitUp] Invalid configuration object property "${erroneous}"${suggestion}',this.ERROR_CONFIG_INVALID_PROPERTY_SUGGESTION='. Did you mean "${probableMatch}"?',this.ERROR_CONFIG_DATA_UID_KEY_NOT_SET="[MixItUp] To use the dataset API, a UID key must be specified using `data.uidKey`",this.ERROR_DATASET_INVALID_UID_KEY='[MixItUp] The specified UID key "${uidKey}" is not present on one or more dataset items',this.ERROR_DATASET_DUPLICATE_UID='[MixItUp] The UID "${uid}" was found on two or more dataset items. UIDs must be unique.',this.ERROR_INSERT_INVALID_ARGUMENTS="[MixItUp] Please provider either an index or a sibling and position to insert, not both",this.ERROR_INSERT_PREEXISTING_ELEMENT="[MixItUp] An element to be inserted already exists in the container",this.ERROR_FILTER_INVALID_ARGUMENTS="[MixItUp] Please provide either a selector or collection `.filter()`, not both",this.ERROR_DATASET_NOT_SET="[MixItUp] To use the dataset API with pre-rendered targets, a starting dataset must be set using `load.dataset`",this.ERROR_DATASET_PRERENDERED_MISMATCH="[MixItUp] `load.dataset` does not match pre-rendered targets",this.ERROR_DATASET_RENDERER_NOT_SET="[MixItUp] To insert an element via the dataset API, a target renderer function must be provided to `render.target`",this.WARNING_FACTORY_PREEXISTING_INSTANCE="[MixItUp] WARNING: This element already has an active MixItUp instance. The provided configuration object will be ignored. If you wish to perform additional methods on this instance, please create a reference.",this.WARNING_INSERT_NO_ELEMENTS="[MixItUp] WARNING: No valid elements were passed to `.insert()`",this.WARNING_REMOVE_NO_ELEMENTS="[MixItUp] WARNING: No valid elements were passed to `.remove()`",this.WARNING_MULTIMIX_INSTANCE_QUEUE_FULL="[MixItUp] WARNING: An operation was requested but the MixItUp instance was busy. The operation was rejected because the queue is full or queuing is disabled.",this.WARNING_GET_OPERATION_INSTANCE_BUSY="[MixItUp] WARNING: Operations can be be created while the MixItUp instance is busy.",this.WARNING_NO_PROMISE_IMPLEMENTATION="[MixItUp] WARNING: No Promise implementations could be found. If you wish to use promises with MixItUp please install an ES6 Promise polyfill.",this.WARNING_INCONSISTENT_SORTING_ATTRIBUTES='[MixItUp] WARNING: The requested sorting data attribute "${attribute}" was not present on one or more target elements which may product unexpected sort output',this.callActions("afterConstruct"),this.compileTemplates(),n.seal(this)},e.BaseStatic.call(e.Messages),e.Messages.prototype=Object.create(e.Base.prototype),e.Messages.prototype.constructor=e.Messages,e.Messages.prototype.compileTemplates=function(){var t="",e="";for(t in this)"string"==typeof(e=this[t])&&(this[n.camelCase(t)]=n.template(e))},e.messages=new e.Messages,e.Facade=function(t){e.Base.call(this),this.callActions("beforeConstruct",arguments),this.configure=t.configure.bind(t),this.show=t.show.bind(t),this.hide=t.hide.bind(t),this.filter=t.filter.bind(t),this.toggleOn=t.toggleOn.bind(t),this.toggleOff=t.toggleOff.bind(t),this.sort=t.sort.bind(t),this.changeLayout=t.changeLayout.bind(t),this.multimix=t.multimix.bind(t),this.multiMix=t.multimix.bind(t),this.dataset=t.dataset.bind(t),this.tween=t.tween.bind(t),this.insert=t.insert.bind(t),this.insertBefore=t.insertBefore.bind(t),this.insertAfter=t.insertAfter.bind(t),this.prepend=t.prepend.bind(t),this.append=t.append.bind(t),this.remove=t.remove.bind(t),this.destroy=t.destroy.bind(t),this.forceRefresh=t.forceRefresh.bind(t),this.isMixing=t.isMixing.bind(t),this.getOperation=t.getOperation.bind(t),this.getConfig=t.getConfig.bind(t),this.getState=t.getState.bind(t),this.callActions("afterConstruct",arguments),n.freeze(this),n.seal(this)},e.BaseStatic.call(e.Facade),e.Facade.prototype=Object.create(e.Base.prototype),e.Facade.prototype.constructor=e.Facade,"object"==typeof exports&&"object"==typeof module?module.exports=e:"function"==typeof define&&define.amd?define('mixitup',[],function(){return e}):"undefined"!=typeof t.mixitup&&"function"==typeof t.mixitup||(t.mixitup=t.mixItUp=e),(a=t.$||t.jQuery)&&a.fn.jquery&&e.registerJqPlugin(a),e.BaseStatic.call(e.constructor),e.NAME="mixitup",e.CORE_VERSION="3.1.12"}(window);
/*
 * textillate.js
 * http://jschr.github.com/textillate
 * MIT licensed
 *
 * Copyright (C) 2012-2013 Jordan Schroter
 */

(function ($) {
  "use strict";

  function isInEffect (effect) {
    return /In/.test(effect) || $.inArray(effect, $.fn.textillate.defaults.inEffects) >= 0;
  };

  function isOutEffect (effect) {
    return /Out/.test(effect) || $.inArray(effect, $.fn.textillate.defaults.outEffects) >= 0;
  };


  function stringToBoolean(str) {
    if (str !== "true" && str !== "false") return str;
    return (str === "true");
  };

  // custom get data api method
  function getData (node) {
    var attrs = node.attributes || []
      , data = {};

    if (!attrs.length) return data;

    $.each(attrs, function (i, attr) {
      var nodeName = attr.nodeName.replace(/delayscale/, 'delayScale');
      if (/^data-in-*/.test(nodeName)) {
        data.in = data.in || {};
        data.in[nodeName.replace(/data-in-/, '')] = stringToBoolean(attr.nodeValue);
      } else if (/^data-out-*/.test(nodeName)) {
        data.out = data.out || {};
        data.out[nodeName.replace(/data-out-/, '')] =stringToBoolean(attr.nodeValue);
      } else if (/^data-*/.test(nodeName)) {
        data[nodeName.replace(/data-/, '')] = stringToBoolean(attr.nodeValue);
      }
    })

    return data;
  }

  function shuffle (o) {
      for (var j, x, i = o.length; i; j = parseInt(Math.random() * i), x = o[--i], o[i] = o[j], o[j] = x);
      return o;
  }

  function animate ($t, effect, cb) {
    $t.addClass('animated ' + effect)
      .css('visibility', 'visible')
      .show();

    $t.one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function () {
        $t.removeClass('animated ' + effect);
        cb && cb();
    });
  }

  function animateTokens ($tokens, options, cb) {
    var that = this
      , count = $tokens.length;

    if (!count) {
      cb && cb();
      return;
    }

    if (options.shuffle) $tokens = shuffle($tokens);
    if (options.reverse) $tokens = $tokens.toArray().reverse();

    $.each($tokens, function (i, t) {
      var $token = $(t);

      function complete () {
        if (isInEffect(options.effect)) {
          $token.css('visibility', 'visible');
        } else if (isOutEffect(options.effect)) {
          $token.css('visibility', 'hidden');
        }
        count -= 1;
        if (!count && cb) cb();
      }

      var delay = options.sync ? options.delay : options.delay * i * options.delayScale;

      $token.text() ?
        setTimeout(function () { animate($token, options.effect, complete) }, delay) :
        complete();
    });
  };

  var Textillate = function (element, options) {
    var base = this
      , $element = $(element);

    base.init = function () {
      base.$texts = $element.find(options.selector);

      if (!base.$texts.length) {
        base.$texts = $('<ul class="texts"><li>' + $element.html() + '</li></ul>');
        $element.html(base.$texts);
      }

      base.$texts.hide();

      base.$current = $('<span>')
        .html(base.$texts.find(':first-child').html())
        .prependTo($element);

      if (isInEffect(options.in.effect)) {
        base.$current.css('visibility', 'hidden');
      } else if (isOutEffect(options.out.effect)) {
        base.$current.css('visibility', 'visible');
      }

      base.setOptions(options);

      base.timeoutRun = null;

      setTimeout(function () {
        base.options.autoStart && base.start();
      }, base.options.initialDelay)
    };

    base.setOptions = function (options) {
      base.options = options;
    };

    base.triggerEvent = function (name) {
      var e = $.Event(name + '.tlt');
      $element.trigger(e, base);
      return e;
    };

    base.in = function (index, cb) {
      index = index || 0;

      var $elem = base.$texts.find(':nth-child(' + ((index||0) + 1) + ')')
        , options = $.extend(true, {}, base.options, $elem.length ? getData($elem[0]) : {})
        , $tokens;

      $elem.addClass('current');

      base.triggerEvent('inAnimationBegin');
      $element.attr('data-active', $elem.data('id'));

      base.$current
        .html($elem.html())
        .lettering('words');

      // split words to individual characters if token type is set to 'char'
      if (base.options.type == "char") {
        base.$current.find('[class^="word"]')
            .css({
              'display': 'inline-block',
              // fix for poor ios performance
              '-webkit-transform': 'translate3d(0,0,0)',
              '-moz-transform': 'translate3d(0,0,0)',
              '-o-transform': 'translate3d(0,0,0)',
              'transform': 'translate3d(0,0,0)'
            })
            .each(function () { $(this).lettering() });
      }

      $tokens = base.$current
        .find('[class^="' + base.options.type + '"]')
        .css('display', 'inline-block');

      if (isInEffect(options.in.effect)) {
        $tokens.css('visibility', 'hidden');
      } else if (isOutEffect(options.in.effect)) {
        $tokens.css('visibility', 'visible');
      }

      base.currentIndex = index;

      animateTokens($tokens, options.in, function () {
        base.triggerEvent('inAnimationEnd');
        if (options.in.callback) options.in.callback();
        if (cb) cb(base);
      });
    };

    base.out = function (cb) {
      var $elem = base.$texts.find(':nth-child(' + ((base.currentIndex||0) + 1) + ')')
        , $tokens = base.$current.find('[class^="' + base.options.type + '"]')
        , options = $.extend(true, {}, base.options, $elem.length ? getData($elem[0]) : {})

      base.triggerEvent('outAnimationBegin');

      animateTokens($tokens, options.out, function () {
        $elem.removeClass('current');
        base.triggerEvent('outAnimationEnd');
        $element.removeAttr('data-active');
        if (options.out.callback) options.out.callback();
        if (cb) cb(base);
      });
    };

    base.start = function (index) {
      setTimeout(function () {
        base.triggerEvent('start');

        (function run (index) {
          base.in(index, function () {
            var length = base.$texts.children().length;

            index += 1;

            if (!base.options.loop && index >= length) {
              if (base.options.callback) base.options.callback();
              base.triggerEvent('end');
            } else {
              index = index % length;

              base.timeoutRun = setTimeout(function () {
                base.out(function () {
                  run(index)
                });
              }, base.options.minDisplayTime);
            }
          });
        }(index || 0));
      }, base.options.initialDelay);
    };

    base.stop = function () {
      if (base.timeoutRun) {
        clearInterval(base.timeoutRun);
        base.timeoutRun = null;
      }
    };

    base.init();
  }

  $.fn.textillate = function (settings, args) {
    return this.each(function () {
      var $this = $(this)
        , data = $this.data('textillate')
        , options = $.extend(true, {}, $.fn.textillate.defaults, getData(this), typeof settings == 'object' && settings);

      if (!data) {
        $this.data('textillate', (data = new Textillate(this, options)));
      } else if (typeof settings == 'string') {
        data[settings].apply(data, [].concat(args));
      } else {
        data.setOptions.call(data, options);
      }
    })
  };

  $.fn.textillate.defaults = {
    selector: '.texts',
    loop: false,
    minDisplayTime: 2000,
    initialDelay: 0,
    in: {
      effect: 'fadeInLeftBig',
      delayScale: 1.5,
      delay: 50,
      sync: false,
      reverse: false,
      shuffle: false,
      callback: function () {}
    },
    out: {
      effect: 'hinge',
      delayScale: 1.5,
      delay: 50,
      sync: false,
      reverse: false,
      shuffle: false,
      callback: function () {}
    },
    autoStart: true,
    inEffects: [],
    outEffects: [ 'hinge' ],
    callback: function () {},
    type: 'char'
  };

}(jQuery));
define("jquery.textillate", ["jquery"], (function (global) {
    return function () {
        var ret, fn;
        return ret || global.jQuery.fn.textillate;
    };
}(this)));

/*global jQuery */
/*!	
* Lettering.JS 0.6.1
*
* Copyright 2010, Dave Rupert http://daverupert.com
* Released under the WTFPL license 
* http://sam.zoy.org/wtfpl/
*
* Thanks to Paul Irish - http://paulirish.com - for the feedback.
*
* Date: Mon Sep 20 17:14:00 2010 -0600
*/
(function($){
	function injector(t, splitter, klass, after) {
		var a = t.text().split(splitter), inject = '';
		if (a.length) {
			$(a).each(function(i, item) {
				inject += '<span class="'+klass+(i+1)+'">'+item+'</span>'+after;
			});	
			t.empty().append(inject);
		}
	}
	
	var methods = {
		init : function() {

			return this.each(function() {
				injector($(this), '', 'char', '');
			});

		},

		words : function() {

			return this.each(function() {
				injector($(this), ' ', 'word', ' ');
			});

		},
		
		lines : function() {

			return this.each(function() {
				var r = "eefec303079ad17405c889e092e105b0";
				// Because it's hard to split a <br/> tag consistently across browsers,
				// (*ahem* IE *ahem*), we replaces all <br/> instances with an md5 hash 
				// (of the word "split").  If you're trying to use this plugin on that 
				// md5 hash string, it will fail because you're being ridiculous.
				injector($(this).children("br").replaceWith(r).end(), r, 'line', '');
			});

		}
	};

	$.fn.lettering = function( method ) {
		// Method calling logic
		if ( method && methods[method] ) {
			return methods[ method ].apply( this, [].slice.call( arguments, 1 ));
		} else if ( method === 'letters' || ! method ) {
			return methods.init.apply( this, [].slice.call( arguments, 0 ) ); // always pass an array
		}
		$.error( 'Method ' +  method + ' does not exist on jQuery.lettering' );
		return this;
	};

})(jQuery);
define("jquery.lettering", ["jquery"], (function (global) {
    return function () {
        var ret, fn;
        return ret || global.jQuery.fn.lettering;
    };
}(this)));

define(
	'v_category',['sweetalert2','m_user', 'm_app','v_message','v_view','jquery','mixitup','dictionary','m_moment','jquery.textillate','jquery.lettering'], 
	function(swal, USER,  M_APP,V_MESSAGE, V_VIEW, $, mixitup, DICTIONARY , MOMENT ) 
{//'m_view','m_app'
				
	const _ = {};
	const templates = {}; _['templates'] = templates;
	templates['UserMenuChildN'] = `
  	<li menuid='{{id}}' menuparent='{{parent}}' {{a}} appName='{{app}}' pageName='{{page}}' class='appUserMenu {{#if children}}flagMenuHasChildren{{/if}}  flagSubMenu {{#if thisSubMenu}}flagMenuLevelN{{else}}flagMenuLevel2{{/if}}{{#if parentBox}} {{join parentBox delimiter=" "}}{{/if}}' >
      <a href="{{data}}" class='{{classForATeg}}' {{attrForATeg}} >{{name}}</a>
      {{#if children}}
    		<div class="userMenuParentButton"></div>
      {{/if}}
    </li>
  `;
  	templates['UserMenuChildOne'] = `
  	<li menuid='{{id}}' class='appUserMenu {{#if sub}}flagMenuHasChildren{{/if}} flagMenuLevel1' appName='{{app}}' pageName='{{page}}'>
        <a href="{{data}}" class='menuLink flagMenuLevel1 {{classForATeg}}' {{attrForATeg}}>{{name}}</a>
		{{#if sub}}
			<div class="userMenuParentButton"></div>
			<ul class="subMenusForUid">
				 {{sub}}
			</ul>
		{{/if}}
	</li>
    `;
    templates['UserMenuContainer'] = `
     {{#each categories}}
		  	<div class="menuListForUsers">
		  		<div class="appMenusForUsers"  app-name="{{@key}}">
					<div class="appNameInMenuList app-{{@key}}">
					  <span class='CML'>[app-{{@key}}]</span>
					</div>
          
					{{#if sub}}
					  <ul class="menusForUid">
							{{sub}}
						  </ul>
					{{/if}}
					</div>
		  	</div>
	  	{{/each}}
    `;
    templates['UserList'] = `
		<div class="mix usersBlockInMenusBlock {{appsForFilter}} {{class}}" connect_uid="{{userId}}" {{#if userHasMenu}}connect_userHasMenu = '1' {{/if}} connect_chatid="{{chatId}}" data-lastmsgtime="{{lmsgTime}}" data-sortable="1" data-position-of-chat='{{chatPosition}}' connect_userType='{{userType}}' connect_chatType='{{chatType}}' connect_userLogin='{{login}}'>
			<div class='chatDataInUsersBlock'>
				<div class="iconBlockInUserBlock">
			      <div class="iconInUserBlock">
			      	<img class="lazy" data-original="{{icon}}" src="{{icon}}">
			      </div>
			      	
			      	{{#js_compare "this.userType == 2"}}
			      		<div class="typeInUserBlock typeBusiness">[dictionary-business]</div>
			      	{{/js_compare}}

			      	{{#js_compare "this.userType == 3"}}
			      		<div class="typeInUserBlock typeService">[dictionary-service]</div>
			      	{{/js_compare}}
			    </div>

		   		<div class="firstLineInUserBlock">
			      <div class="usersNameInUserBlock">
			         <div class="userNameInChatList">{{chatName}}</div>
			      </div>
			      <div class="toCallBlockInUserNameBlock">
			         <div class="btnToVoiceCallInFirstLine"></div>
			         <div class="btnToVideoCallInFirstLine"></div>
			      </div>
			    </div>

			    <div class="secondLineInUserBlock">
			      <div class="leftBlockInSecondLine">
			         <div class="aCpAll_msgSimpleText_flashBlock aCpAll_flashBLocks">
			            <div class="aCpAll_msgSimpleText_flashIcon aCpAll_flashBLocks_icon"></div>
			            <div class="valueInLiveBlocks">
			               <span class="aCpAll_msgSimpleText_animateContainer">
			                  <span style="visibility: visible;"></span>
			                  <ul class="texts" style="display: none;">
			                     <li></li>
			                  </ul>
			               </span>
			            </div>
			         </div>
			         <div class="aCpAll_msgLiveAudio_flashBlock aCpAll_flashBLocks">
			            <div class="aCpAll_msgLiveAudio_flashIcon aCpAll_flashBLocks_icon"></div>
			            <div class="valueInLiveBlocks">
			               <span class="aCpAll_msgLiveAudio_animateContainer">
			                  <span style="visibility: visible;"></span>
			                  <ul class="texts" style="display: none;">
			                     <li></li>
			                  </ul>
			               </span>
			            </div>
			         </div>
			         <div class="aCpAll_msgLiveVideo_flashBlock aCpAll_flashBLocks">
			            <div class="aCpAll_msgLiveVideo_flashIcon aCpAll_flashBLocks_icon"></div>
			            <div class="valueInLiveBlocks">
			               <span class="aCpAll_msgLiveVideo_animateContainer">
			                  <span style="visibility: visible;"></span>
			                  <ul class="texts" style="display: none;">
			                     <li></li>
			                  </ul>
			               </span>
			            </div>
			         </div>

			      </div>
			      <div class="rightBlockInSecondLine"> <span class="newMsgInSecondLine"></span> </div>
			    </div>

			    <div class="thirdLineInUserBlock">
			      <div class="leftBlockInThirdLine">
			         <div class="lastMessageInThirdLine">{{lmsgText}}</div>
			      </div>
			      <div class="rightBlockInThirdLine">
			         <div class="timelastMsgInThirdLine">{{lmsgText}}</div>
			      </div>
			    </div>

			</div>  
			<div class='menusInUsersBlock'></div> 
		</div>
	`;
	const vars = {}; _['vars'] = vars;
	vars['pathToChatList'] 				= '.usersBlockContainerInMenusBlock .app[app-name="base"] .view[view-name="index"] .scrolBlockForChat';
	vars['pathForFlashMsgSimpleText'] 	= '.valueInLiveBlocks .aCpAll_msgSimpleText_animateContainer';
	vars['pathForFlashMsgLiveVideo'] 	= '.valueInLiveBlocks .aCpAll_msgLiveVideo_animateContainer';
	vars['pathForFlashMsgLiveAudio'] 	= '.valueInLiveBlocks .aCpAll_msgLiveAudio_animateContainer';
	vars['pathForEffectsLastMsg'] 		= '.lastMessageInThirdLine';
	const output = {}; _['output'] = output;






	function chat_initGlobalFilter (iNfilter) {
		/*
			@discr
				init global filter for chat sort
			@inputs
				@optional
					iNfilter -> string

		*/
		let filter = iNfilter||'ramman';
		chat_setGlobalFilter(filter);
	} _['chat_initGlobalFilter'] = chat_initGlobalFilter;

	function chat_getGlobalFilter () {
		/*
			@discr
				get global filter for chat sort
			@inputs
				@required

		*/
		var filter = window['connect_globalFilterForUserSort'];
		switch (filter) {
			case 'market':
				return '.' + filter;
			break; 
			case 'sharepay':
				return '.' + filter;
			break; 
			case 'onepay':
				return '.' + filter;
			break; 
			case 'edocument':
				return '.' + filter;
			break; 
			default:
				return 'all';
			break; 
		}
	} _['chat_getGlobalFilter'] = chat_getGlobalFilter;

	function chat_setGlobalFilter (iNfilter) {
		/*
			@discr
				set global filter for chat sort
			@inputs
				@optional
					iNfilter -> string

		*/
		switch (iNfilter) {
			case 'sharepay':
			break; 
			case 'market':
			break; 
			case 'onepay':
			break; 
			case 'edocument':
			break; 
			default:
				iNfilter = 'all';
			break; 
		}
		window['connect_globalFilterForUserSort'] = iNfilter;
	} _['chat_setGlobalFilter'] = chat_setGlobalFilter;
	

	function chat_offSelectEffects () {
		/*
			@discr
				del select effects from all chats
			@inputs
				@required

		*/
		$('.chatDataInUsersBlock').removeClass('selected');
	} _.chat_offSelectEffects = chat_offSelectEffects;

	function chat_addSelectEffectsByChatId (iNchatId) {
		/*
			@discr
				set select effects for this chat
			@inputs
				@required
					iNchatId -> string

		*/
		let pathToThisChat = getPathToChatByChatId(iNchatId);
		$(pathToThisChat).find('.chatDataInUsersBlock').addClass('selected');

	} _.chat_addSelectEffectsByChatId = chat_addSelectEffectsByChatId;

	function chat_setSelectOnlyThisChat (iNchatId) {
		/*
			@discr
				set select effects ONLY for this chat 
			@inputs
				@required
					iNchatId -> string

		*/
		chat_offSelectEffects();
		chat_addSelectEffectsByUserId(iNchatId);

	} _.chat_setSelectOnlyThisChat = chat_setSelectOnlyThisChat;

	function chat_addSelectEffectsByUserId (iNchatId) {
		/*
			@discr
				add select effects by chatId
			@inputs
				@required
					iNchatId -> string

		*/
		let pathToThisChat = getPathToChatByUserId(iNchatId);
		$(pathToThisChat).find('.chatDataInUsersBlock').addClass('selected');

	} _.chat_addSelectEffectsByUserId = chat_addSelectEffectsByUserId;
	
	function chat_hideAllChats () {
		/*
			@discr
				show all chats
			@inputs
				@required
		*/
		let mixer = output['sortMixitUpObject'];
		if(typeof mixer == 'object') mixer.filter("none");

	} _['chat_hideAllChats'] = chat_hideAllChats;

	function chat_showAllChats () {
		/*
			@discr
				show all chats
			@inputs
				@required
		*/
		// $('.mix.usersBlockInMenusBlock').show();
		let mixer = output['sortMixitUpObject'];
		if(typeof mixer == 'object') mixer.filter("all");
	} _['chat_showAllChats'] = chat_showAllChats;

	function chat_showChatByUserId (iNuserId) {
		/*
			@discr
				show chat by his userId
			@inputs
				@required
					iNuserId -> string
		*/

		let mixer = output['sortMixitUpObject'];
		if(typeof mixer == 'object') mixer.filter("[connect_uid='"+iNuserId+"']");
	} _['chat_showChatByUserId'] = chat_showChatByUserId;


	function chat_showChatByChatId (iNchatId) {
		/*
			@discr
				show chat by his chatId
			@inputs
				@required
					iNchatId -> string
		*/

		let mixer = output['sortMixitUpObject'];
		if(typeof mixer == 'object') mixer.filter("[connect_chatid='"+iNchatId+"']");
	} _['chat_showChatByChatId'] = chat_showChatByChatId;


	function chat_hideUserMenus () {
		/*
			@discr
				hide all chat menus
			@inputs
				@required
		*/
		var selector = '#menusBlock .menusInUsersBlock';
		$(selector).hide();
	}
	_['chat_hideUserMenus'] = chat_hideUserMenus;

	function chat_showOnlyThisChatMenu (iNuserId) {
		/*
			@discr
				show only this chat menu by chatId
			@inputs
				@required
					iNchatId -> string
		*/

		// hide all menus
		chat_hideUserMenus();

		//show this chat menu
		chat_showChatMenuByUserId(iNuserId);

	} _['chat_showOnlyThisChatMenu'] = chat_showOnlyThisChatMenu;

	function chat_showChatMenuByUserId (iNchatId) {
		/*
			@discr
				show chat menu by chatId
			@inputs
				@required
					iNchatId -> string

		*/
		var pathToThisChat = getPathToChatByUserId(iNchatId);
		$(pathToThisChat + ' .menusInUsersBlock').show();
	} _['chat_showChatMenuByUserId'] = chat_showChatMenuByUserId;


	function addOnClickActionForChatList (iNchatId) {
		/*
			@discr
				add action for open chat by click to this chat
			@inputs
				@required
					iNchatId -> string

		*/
		var pathToThisChat = getPathToChatByChatId(iNchatId);
		console.log('addOnClickActionForChatList - iNchatId, pathToThisChat',iNchatId, pathToThisChat);

		// selected thi chat -> we remove selected class from all
		chat_setSelectOnlyThisChat(iNchatId);


		//prepare object
		var obj = {};
			var chatId 		= iNchatId;//$(pathToThisChat).attr('connect_chatid');
				obj['chatId'] 	= chatId;
				obj['userType'] = $(pathToThisChat).attr('connect_userType');
				obj['chatType'] = $(pathToThisChat).attr('connect_chatType');
				obj['login'] 	= $(pathToThisChat).attr('connect_userlogin');
				obj['uid'] 		= $(pathToThisChat).attr('connect_uid');
				obj['chatIcon'] = getChatIcon(chatId);
				obj['chatName'] = getChatName(chatId);


		//resort this chat (up this to top)
		// chatPosition_annihilateForSort ();
		// chatPosition_setByChatIdForSort (iNchatId,1); 
		// startEffSortChats ();

		// check has menu
		var attrHasMenu = $(pathToThisChat).attr('connect_userhasmenu');
		console.log('addOnClickActionForChatList - attrHasMenu',attrHasMenu);
		console.log('addOnClickActionForChatList - $(pathToThisChat)',pathToThisChat, $(pathToThisChat));
		if(attrHasMenu){
			// if this chat hasmenu -> open app 'chat' page 'index'
			var dataForOpenApp = 'uid='+obj['login']+'&login='+USER.getMyLogin();

        	// convert to link for open app -> we add need classes
        	var selector = pathToThisChat + ' .iconInUserBlock img, ' + pathToThisChat + ' .userNameInChatList',
        		objForCreateLink = {
        			'appName' 	: 'base',
        			'pageName' 	: 'one',
        			'data' 		: dataForOpenApp
        		};
			console.log('addOnClickActionForChatList 0 - selector', selector);
			console.log('addOnClickActionForChatList 0 - objForCreateLink', objForCreateLink);
        	M_APP.view.convertDomElementToAppLink (selector,objForCreateLink);
		} else {
			// if this has not menu -> open app 'chat' page 'index'
			var dataForOpenApp = 'chatName='+obj['chatName']+'&chatId='+obj['chatId']+'&chatIcon='+obj['chatIcon']+'&userLogin='+obj['login']+'&uid='+obj['uid']+'&chatType=' + obj['chatType'];

        	//< safe add online
            	let thisOnline 			= $(pathToThisChat).attr('connect_online');
            	if (typeof thisOnline == 'string' && thisOnline.length > 0) {
        			dataForOpenApp += '&online='+thisOnline
            	}
        	//> safe add online

        	// convert to link for open app -> we add need classes
        	var selector = pathToThisChat + ' .iconInUserBlock img, ' + pathToThisChat + ' .userNameInChatList',
        		objForCreateLink = {
        			'appName' 	: 'chat',
        			'pageName' 	: 'index',
        			'data' 		: dataForOpenApp
        		};
        	M_APP.view.convertDomElementToAppLink (selector,objForCreateLink);
		}
	}
	_['addOnClickActionForChatList'] = addOnClickActionForChatList;

	

	function addUserMenuChildN (iNmenu,iNdataBlockN) {
	   	var newData = getUserMenuChildN(iNmenu);
     	iNdataBlockN.push(newData);
	  	if(typeof iNmenu.children == 'object' && Array.isArray(iNmenu.children) && iNmenu.children.length > 0) {
			for(var menu3SubKey in iNmenu.children) {
		  		iNmenu.children[menu3SubKey]['thisSubMenu'] = 1;
		    	iNmenu.children[menu3SubKey]['parent'] = iNmenu.id;
          
	          if(typeof(iNmenu['parentBox']) == 'object') 
	          	iNmenu.children[menu3SubKey]['parentBox'] = iNmenu['parentBox'].concat([ 'UMP' + iNmenu.id ]);
	          else 
	    		iNmenu.children[menu3SubKey]['parentBox'] = ['UMP' + iNmenu.id];
	          
	            addUserMenuChildN(iNmenu.children[menu3SubKey],iNdataBlockN);
           
         
		    }
	  	}
	}
	_['addUserMenuChildN'] = addUserMenuChildN;

		function getUserMenuChildN (iNdata) {
	    	var temp = Template7.compile(templates['UserMenuChildN']);
	    	return temp(iNdata);
		}

	function addUserMenuChildOne (iNmenu,iNdataBlock2) {
  		var dataBlockN = [];
	  	if(typeof iNmenu.children == 'object' && Array.isArray(iNmenu.children) &&  iNmenu.children.length > 0) {
	  		var childrenMenu2 = iNmenu.children;
	    	for(var menu3Key in childrenMenu2) {
      			childrenMenu2[menu3Key]['parent'] = iNmenu.id;
      			childrenMenu2[menu3Key]['parentBox'] = ['UMP'+iNmenu.id];
	      		addUserMenuChildN(childrenMenu2[menu3Key],dataBlockN);
	    	}
    		iNmenu['sub'] = dataBlockN.join(' ');
	  	}
    	iNdataBlock2.push(getUserMenuChildOne(iNmenu));
	}
	_['addUserMenuChildOne'] = addUserMenuChildOne;

		function getUserMenuChildOne (iNdata) {
	    	var temp = Template7.compile(templates['UserMenuChildOne']);
    		return temp(iNdata);
		}
	

	function addMenuByCategoryList (iNcategory,iNuid) {
		var content = getUserMenuContainerByCats(iNcategory);
		addMenuByContentAndUid(content,iNuid);
		// active actiond for click events by href
		activeActionsForMenuEvents();
	}
	_['addMenuByCategoryList'] = addMenuByCategoryList;

		function activeActionsForMenuEvents () {
	    	$('.appUserMenu.flagMenuLevel1 > a, .appUserMenu.flagMenuLevel1 > div.userMenuParentButton').click(clickToMenuFirstLevel);
	    	$('.appUserMenu.flagMenuLevel2 > a, .appUserMenu.flagMenuLevel2 > div.userMenuParentButton').click(clickToMenuSecondLevel);
	    	$('.appUserMenu.flagMenuLevelN > a, .appUserMenu.flagMenuLevelN > div.userMenuParentButton').click(clickToMenuLevelN);

    		//desable app open by link -> we need off other actions then view error 
	    	$('.appUserMenu.flagMenuLevel1 > a.viewError, .appUserMenu.flagMenuLevel2 > a.viewError, .appUserMenu.flagMenuLevelN > a.viewError').off('click');
	    	$('.appUserMenu.flagMenuLevel1 > a.viewError, .appUserMenu.flagMenuLevel2 > a.viewError, .appUserMenu.flagMenuLevelN > a.viewError').click(clickToMenuForViewError);
	    }
		_['activeActionsForMenuEvents'] = activeActionsForMenuEvents;

			function clickToMenuForViewError (e) {
				e.preventDefault();
				var errorCode = $(this).attr('errorText');
				swal(
				  DICTIONARY.withString('[error-value]') + '!',
				  DICTIONARY.withString(errorCode),
				  'error'
				)
			}

			function clickToMenuFirstLevel (e) {
				e.preventDefault();
				var thisMenuId = $(this).parent().attr('menuid');

				// delete menuButtons and flagMenuNoOffset
				removeMenuButtonAndFlag();
				//hide all submenus of 2level
				$('li.appUserMenu.flagMenuLevelN').hide(150);

				$('ul.subMenusForUid').hide(250);
				if ( $(this).parent().hasClass('flagMenuHasChildren') ) {
					// menu has children
					$(this).parent().children('ul.subMenusForUid').show(350).children('li.flagMenuLevel2[menuparent="'+thisMenuId+'"]').show();
					
				}

				const hrefData = $(this).attr('href');
				if ($(this).is('a') && hrefData) {
					// open app
					const appName = $(this).parent().attr('appName');
					const pageName = $(this).parent().attr('pageName');
	        		M_APP.getGlobalVar('engine').passToApp({'app':appName,'page':pageName,'data':hrefData});
				}
			}
			_['clickToMenuFirstLevel'] = clickToMenuFirstLevel;

			function clickToMenuSecondLevel (e) {
				e.preventDefault();
				var thisMenuId = $(this).parent().attr('menuid');
				var thisParentMenuId = $(this).parent().attr('menuparent');

				// delete menuButtons and flagMenuNoOffset
				removeMenuButtonAndFlag();



				$('li.appUserMenu.flagMenuLevelN').hide(250);
				if ( $(this).parent().hasClass('flagMenuHasChildren') ) {
					//add menu button with actions
					addBackMenuButtonWithActions(thisParentMenuId,this);
					// menu has children
					$(this).closest('ul.subMenusForUid').children('li.appUserMenu.flagMenuLevelN[menuparent="'+thisMenuId+'"]').show(350);
				}
				var hrefData = $(this).attr('href');
				if ($(this).is('a') && hrefData) {
					// open app
					var appName 	= $(this).parent().attr('appName');
					var pageName 	= $(this).parent().attr('pageName');
	        		M_APP.getGlobalVar('engine').passToApp({'app':appName,'page':pageName,'data':hrefData});
				}
			}
			_['clickToMenuFirstLevel'] = clickToMenuFirstLevel;

			function clickToMenuLevelN (e) {
				e.preventDefault();
				var thisMenuId = $(this).parent().attr('menuid');
				var thisParentMenuId = $(this).parent().attr('menuparent');
				//hide all sub menus
				$('li.appUserMenu.flagMenuLevelN, li.appUserMenu.flagMenuLevel2').hide(150);
				// delete menuButtons and flagMenuNoOffset
				removeMenuButtonAndFlag();
				if ( $(this).parent().hasClass('flagMenuHasChildren') ) {
					//remove offset margin left
					$(this).parent().addClass('flagMenuNoOffset');
					//add menu button with actions
					addBackMenuButtonWithActions(thisParentMenuId,this);
					$(this).parent().show(150);
					$(this).closest('ul.subMenusForUid').children('li.appUserMenu.flagMenuLevelN[menuparent="'+thisMenuId+'"]').show(250);
				}
				var hrefData = $(this).attr('href');
				if ($(this).is('a') && hrefData) {
					// open app
					var appName 	= $(this).parent().attr('appName');
					var pageName 	= $(this).parent().attr('pageName');
	        		M_APP.getGlobalVar('engine').passToApp({'app':appName,'page':pageName,'data':hrefData});
				}
			}
				function removeMenuButtonAndFlag () {
					$('.userMenuBackButton').remove();
					$('li.appUserMenu.flagMenuLevelN').removeClass('flagMenuNoOffset');
				}
				function addBackMenuButtonWithActions (iNparentMenuId,thisObject) {
					//this parent el li object show
					$(thisObject).parent().show();
					//add menu button with parent id
					$(thisObject).parent().prepend("<div class='userMenuBackButton' menuparent='"+iNparentMenuId+"'></div>");
					// add colback
					$('.userMenuBackButton[menuparent="'+iNparentMenuId+'"]').click(clickToMenuBackButton);
				}
				function clickToMenuBackButton (e) {
					e.preventDefault();
					var parentId = $(this).attr('menuparent');
					var parentPath = 'li.appUserMenu[menuid="'+parentId+'"]';
					$(parentPath + ' > div.userMenuParentButton').trigger('click');
				}

	function addMenuByContentAndUid (iNcontent,iNuserId) {
		var path = ".usersBlockInMenusBlock[connect_uid='"+iNuserId+"'] .menusInUsersBlock";
		V_VIEW.d_addDataToViewEl(path,iNcontent,'change');
	}
	_['addMenuByContentAndUid'] = addMenuByContentAndUid;

	function getUserMenuContainerByCats (iNmenu) {
	  	var data = iNmenu.categories;
	  	var updatedCategories = {};
	  	var updatedMenu = {'categories':updatedCategories};
	  	// ser order 
	  	var orderList = ['chat','market','dock','sharepay','onepay','page']; // chat menu program create

    	for(var iKey in orderList) {
    		var appKey = orderList[iKey];
    		if(!data[appKey])continue;
    		updatedCategories[appKey] = data[appKey];
    		var dataBlock2 = [];
	    	for(var mKey in updatedCategories[appKey]){
    			var thisMenu =  updatedCategories[appKey][mKey];
				addUserMenuChildOne(thisMenu,dataBlock2);
			}
   			updatedCategories[appKey]['sub'] = dataBlock2.join(' ');
	    }
	  	return getUserMenuContainerFromTemplate(updatedMenu).replace(/[  \n\t\r]+/g,' ');
	}
	_['getUserMenuContainerByCats'] = getUserMenuContainerByCats;
  
		function getUserMenuContainerFromTemplate (iNdata) {
	    	var temp = Template7.compile(templates['UserMenuContainer']);
	    	return temp(iNdata);
		}
		// _['getUserMenuContainerFromTemplate'] = getUserMenuContainerFromTemplate;



	function createChatListIfNotExist (iNdata,iNfunction) {
		/*
			@inputs
				@required
					iNdata -> object
						@required
							chatId
							userId
							icon (icon_big,icon_min)
							chatName
							login
							userType
							chatType
							chatPosition
						@optional
							userHasMenu -> boolean
							printing
							lastMsgTimeText
							lastMsgTime
		*/
		if(typeof iNdata != 'object') iNdata = {};

		var chatType = iNdata.chatType ? parseInt(iNdata.chatType) : 2;
		console.log('createChatListIfNotExist - chatType, iNdata', chatType, iNdata);
		if( chatType == 1 ) {
			// if private chat
			var chatSelector = getPathToChatByUserId (iNdata['userId']);
		} else {
			// if group chat
			var chatSelector = getPathToChatByChatId (iNdata['chatId']);

		}

		console.log('createChatListIfNotExist - chatSelector',chatSelector)
		console.log('createChatListIfNotExist - $(chatSelector).length',$(chatSelector).length);
		console.log('createChatListIfNotExist - $(chatSelector)',$(chatSelector));
		if($(chatSelector).length < 1) {
			console.log('createChatListIfNotExist - create',$(chatSelector));
			createChatList(iNdata,iNfunction);
		}

		// create if not exist
	} _.createChatListIfNotExist = createChatListIfNotExist;

	function createPrivateChatListIfNotExist (iNdata) {
		/*
			@inputs
				@required
					iNdata -> object
						@required
							chatId
							userId
							icon (icon_big,icon_min)
							chatName
							login
							userType
							chatType
							chatPosition
						@optional
							userHasMenu -> boolean
							printing
							lastMsgTimeText
							lastMsgTime
		*/
		if(typeof iNdata != 'object') iNdata = {};
		let chatSelector = getPathToChatByUserId(iNdata['userId']);
		// create if not exist
		if($(chatSelector).length < 1) createChatList(iNdata);

	} _.createPrivateChatListIfNotExist = createPrivateChatListIfNotExist;

	function createChatList (iNdata, iNfunction) {
		/*
			@inputs
				@required
					iNdata -> object
						chatId
						userId
						icon_big
						icon_min
						chatName
						printing
						lastMsgTimeText
						lastMsgTime
		*/
		if(typeof iNdata['chatPosition'] != 'number') iNdata['chatPosition'] = 999;
		var content = DICTIONARY.withString ( getUserListTemplate ( iNdata ) );
		let mixer = output['sortMixitUpObject'];

        console.log('createChatList mixer', mixer , $(content));
		mixer.insert($(content)).then(function(state) {
	        console.log('createChatList - totalShow',state.totalShow);
	        if(typeof iNfunction == 'function') iNfunction();
	    });
		// $(vars['pathToChatList']).prepend( content );
	}
	_['createChatList'] = createChatList;

	function removeChatListByUserId (iNuserId, iNfunction) {
		/*
			@inputs
				@required
					iNuserId -> string
		*/
		var selectorForDel = getPathToChatByUserId (iNuserId);
		let mixer = output['sortMixitUpObject'];

        console.log('removeChatListByUserId mixer');
		mixer.remove(selectorForDel).then(function(state) {
	        console.log('removeChatListByUserId - totalShow',state.totalShow);
	        if(typeof iNfunction == 'function') iNfunction();
	    });
		// $(vars['pathToChatList']).prepend( content );
	}
	_['removeChatListByUserId'] = removeChatListByUserId;

	


		function getUserListTemplate (iNdata) {
	    	var temp = Template7.compile(templates['UserList']);
	    	return temp(iNdata);
		}
	function setEffectsForChatList (iNchatId) {
		/*
			@discr
				set base effect for last msg and live block in chat list container
			@inputs
				@required
					iNchatId -> string
		*/
		flash_msgSimpleText_init( iNchatId );
		flash_msgLiveAudio_init( iNchatId );
		flash_msgLiveVideo_init( iNchatId );
		startEffLastMsgByChatId( iNchatId );
	}
	_['setEffectsForChatList'] = setEffectsForChatList;

	function safeAddChatList (iNdata) {
        /*
        	@discr
            	safe create chat list el if it did not isset
			
			@inputs
				@required
					iNdata -> object
						chatId
						userId
						icon_big
						icon_min
						chatName
						printing
						lastMsgTimeText
						lastMsgTime

						type
            @return 
            	string: coung of chat list element
        */
        var lengthChatList = findChatBlock(iNdata['chatId']);
        if(lengthChatList < 1) {
        	createChatList(iNdata);
        	// add effect for last msg and live flash messages
        	setEffectsForChatList(iNdata['chatId']);
        }
       
    }
	_['safeAddChatList'] = safeAddChatList;
	//chat
		function getPathToDomChatHeader (iNchatId) {
			return '.appBase_pIndexLeftBlockInChiefHeader[connect_chatid="'+iNchatId+'"]';
		}
		_['getPathToDomChatHeader'] = getPathToDomChatHeader;
	//chat
		function findChatBlock (iNchatId) {
			return $( getPathToChatByChatId(iNchatId) ).length;
		}
		_['findChatBlock'] = findChatBlock;

			function getPathToChatByChatId (iNchatId) {
				return '.usersBlockInMenusBlock[connect_chatid="'+iNchatId+'"]';//[chatType="2"]
			}
			_['getPathToChatByChatId'] = getPathToChatByChatId;

			function getPathToChatByUserId (iNuserId) {
				return '.usersBlockInMenusBlock[connect_uid="'+iNuserId+'"]';
			}
			_['getPathToChatByUserId'] = getPathToChatByUserId;

		function getChatIdByUid (iNuid) {
			return $('.usersBlockInMenusBlock[connect_uid="'+iNuid+'"]').attr('connect_chatid');;
		}
		_['getChatIdByUid'] = getChatIdByUid;

		function effHideChatLists () {
			$('.usersBlockInMenusBlock').hide();
		}
		_['effHideChatLists'] = effHideChatLists;

		function effShowChatList (iNchatId) {
			$('.usersBlockInMenusBlock[connect_chatid="'+iNchatId+'"]').show();
		}
		_['effShowChatList'] = effShowChatList;

			function getChatIcon (iNchatId) {
				var pathToIcon = getPathToChatByChatId(iNchatId) + ' .iconBlockInUserBlock img';
				return $(pathToIcon).attr('src');
			}
			_['getChatIcon'] = getChatIcon;

			function getChatName (iNchatId) {
				var pathToIcon = getPathToChatByChatId(iNchatId) + ' .userNameInChatList';
				return $(pathToIcon).text();
			}
			_['getChatName'] = getChatName;

			function getUserLoginFromPrivateChat (iNchatId) {
				var pathTo = getPathToChatByChatId(iNchatId);
				return $(pathToIcon).attr('connect_userLogin');
			}
			_['getUserLoginFromPrivateChat'] = getUserLoginFromPrivateChat;

			function getUserTypeFromPrivateChat (iNchatId) {
				var pathTo = getPathToChatByChatId(iNchatId);
				return $(pathToIcon).attr('connect_userType');
			}
			_['getUserTypeFromPrivateChat'] = getUserTypeFromPrivateChat;

	//effects
		function initSort () {
		    /*
		    	@discr
		        	create object for sort chats block
		        @inputs
					@required
					@optional
		    */
			 if(typeof(output['sortMixitUpObject']) != 'undefined') output['sortMixitUpObject'].destroy();

		    output['sortMixitUpObject'] = mixitup (
		    	vars['pathToChatList'],
		    	{
		    		load: {
		    			'sort' : 'position-of-chat:asc lastmsgtime:desc',
		    		}
		    	}
	    	);
		} _['initSort'] = initSort;

		function startEffSortChats (iNdata) {
		    /*
		    	@discr
		        	sort chats block
		        @inputs
					@required
					@optional
						iNdata -> object
							filter
							sort
		    */

		    if(typeof(output['sortMixitUpObject']) != 'undefined') {
		    	var mixer = output['sortMixitUpObject'],block = {};
		    	if( typeof(iNdata) != 'object' ) iNdata = {};
		    		var sort, sortdefault, filter;
				    if( typeof(iNdata.filter) == 'string' )      
				    	filter 		=  iNdata.filter;
				    else {
				    	filter 		=  chat_getGlobalFilter();
				    }

				    if( typeof(iNdata.sort)  == 'string' )       
				    	sort 		=  iNdata.sort;
				    else {
				    	sort 		=  'position-of-chat:asc lastmsgtime:desc';
				    	sortdefault 		= 'sortable position-of-chat:asc lastmsgtime:desc';
					    mixer.sort(sortdefault);
				    	mixer.sort(sort);
				    }

			    	mixer.filter(filter);
			}
		}
		_['startEffSortChats'] = startEffSortChats;

		function chatPosition_annihilateForSort () {
			/*
				@discr 
					annihilate chat position for sort
				@inputs : Void

			*/
			$('.mix.usersBlockInMenusBlock').attr('data-position-of-chat',999);
		} _.chatPosition_annihilateForSort = chatPosition_annihilateForSort;

		function chatPosition_setByChatIdForSort (iNchatId,iNnumber) {
			/*
				@discr 
					set chat position for sort
				@inputs
					@required
						iNchatId -> string
					@optoinal
						iNnumber -> number

			*/
			if (typeof iNnumber != 'number') iNnumber = 1;
			$(getPathToChatByChatId(iNchatId)).attr('data-position-of-chat',iNnumber);
		} _.chatPosition_setByChatIdForSort = chatPosition_setByChatIdForSort;

		function chatPosition_setByUserIdForSort (iNchatId,iNnumber) {
			/*
				@discr 
					set chat position for sort
				@inputs
					@required
						iNchatId -> string
					@optoinal
						iNnumber -> number

			*/
			if (typeof iNnumber != 'number') iNnumber = 1;
			$(getPathToChatByUserId(iNchatId)).attr('data-position-of-chat',iNnumber);
		} _.chatPosition_setByUserIdForSort = chatPosition_setByUserIdForSort;

		function flash_msgSimpleText_init (iNchatId) {
		    /*
		    	@discr
		        	sort chats block
		        @inputs
					@required
					@optional
						iNdata -> object
							filter
							sort
		    */
            var chatObject = getPathToChatByChatId(iNchatId);
	    	$(chatObject +' '+ vars['pathForFlashMsgSimpleText']).textillate({ autoStart:false, in: {effect: 'wobble',delay:10 } });
		}
		_['flash_msgSimpleText_init'] = flash_msgSimpleText_init;

		function flash_msgLiveAudio_init (iNchatId) {
		    /*
		    	@discr
		        	sort chats block
		        @inputs
					@required
					@optional
						iNdata -> object
							filter
							sort
		    */
            var chatObject = getPathToChatByChatId(iNchatId);
	    	$(chatObject +' '+ vars['pathForFlashMsgLiveAudio']).textillate({ autoStart:false, in: {effect: 'wobble',delay:10 } });
		}
		_['flash_msgLiveAudio_init'] = flash_msgLiveAudio_init;

		function flash_msgLiveVideo_init (iNchatId) {
		    /*
		    	@discr
		        	sort chats block
		        @inputs
					@required
					@optional
						iNdata -> object
							filter
							sort
		    */
            var chatObject = getPathToChatByChatId(iNchatId);
	    	$(chatObject +' '+ vars['pathForFlashMsgLiveVideo']).textillate({ autoStart:false, in: {effect: 'wobble',delay:10 } });
		}
		_['flash_msgLiveVideo_init'] = flash_msgLiveVideo_init;

		function startEffLastMsgByChatId (iNchatId) {
		    /*
		    	@discr
		        	sort chats block
		        @inputs
					@required
					@optional
						iNdata -> object
							filter
							sort
		    */
            var chatObject = getPathToChatByChatId(iNchatId);
			$(chatObject +' '+ vars['pathForEffectsLastMsg']).textillate({ autoStart:false, in: {effect: 'fadeInLeftBig',delay:30 }, out: {effect: 'fadeOutRightBig', delay:15, callback: function () { $(chatObject + ' .lastMessageInThirdLine').textillate('start');} }, minDisplayTime:150 }).textillate('start');
		}
		_['startEffLastMsgByChatId'] = startEffLastMsgByChatId;

		function startEffHideLiveInChatsList (iNchatId,iNtime) {
		    /*
		    	@discr
		        	hide live msg block after iNtime ms
		        @inputs
					@required
					@optional
						iNdata -> object
							filter
							sort
		    */
		    if( typeof(iNtime) != 'number' ) iNtime = 2500; 
		    if( typeof(output['objectTimeoutForHideLiveInChatsList']) != 'undefined') clearTimeout(output['objectTimeoutForHideLiveInChatsList'])
		    output['objectTimeoutForHideLiveInChatsList'] = setTimeout(function () {
            	var chatObject = getPathToChatByChatId(iNchatId);
		        $(chatObject + ' .aCpAll_flashBLocks').hide();
		    }, iNtime);
		}
		_['startEffHideLiveInChatsList'] = startEffHideLiveInChatsList;


		function domChangeCountMessages (iNchatId,iNnumber) {
            /*
                change new msg count by $newMsg variable
                1 - iNchatId (String)
                    defined chat object
                2 - iNnumber (int)
                @depends
                    getPathToChatByChatId
            */
            var chatObject = getPathToChatByChatId(iNchatId);
            $(chatObject + ' .newMsgInSecondLine').html(iNnumber);
		}
		_['domChangeCountMessages'] = domChangeCountMessages;

			function domSafeShowNewMsgCountInChatBlock (iNchatId,iNnumber) {
                /*
                    show block what show new msg count in chatBLock
                    1 - chatObject (String)
                        defined chat object
                */
				domChangeNewMsgCountInChatBlock(iNchatId,iNnumber);
				domShowNewMsgCountInChatBlock(iNchatId);
			}
			_['domSafeShowNewMsgCountInChatBlock'] = domSafeShowNewMsgCountInChatBlock;

			function domChangeNewMsgCountInChatBlock (iNchatId,iNnumber) {
                /*
                    show block what show new msg count in chatBLock
                    1 - chatObject (String)
                        defined chat object
                */
                var chatObject = getPathToChatByChatId(iNchatId);
                $(chatObject + ' .newMsgInSecondLine').html(iNnumber);
            }
			_['domChangeNewMsgCountInChatBlock'] = domChangeNewMsgCountInChatBlock;

            function domShowNewMsgCountInChatBlock (iNchatId) {
                /*
                    show block what show new msg count in chatBLock
                    1 - chatObject (String)
                        defined chat object
                */
                var chatObject = getPathToChatByChatId(iNchatId);
                $(chatObject + ' .newMsgInSecondLine').css('display','inline-block');
            }
			_['domShowNewMsgCountInChatBlock'] = domShowNewMsgCountInChatBlock;

            function domHideNewMsgCountInChatBlock (iNchatId) {
                /*
                    hide block what show new msg count in chatBLock
                    1 - chatObject (String)
                        defined chat object
                    @depends
                        domClearNewMsgCountInChatBloc()
                */
                var chatObject = getPathToChatByChatId(iNchatId);
                $(chatObject + ' .newMsgInSecondLine').hide();
            }
			_['domHideNewMsgCountInChatBlock'] = domHideNewMsgCountInChatBlock;

		function domChangeDidOnlineChatHeader (iNchatId) {
            /*
            	@discr
                	change chat-header did show
            	@inputs
	                iNchatId -> stirng
            */
            var chatObject = getPathToDomChatHeader(iNchatId);
            $(chatObject + ' .appBase_userStateOffline').hide();
            $(chatObject + ' .appBase_userStateOnline').fadeIn(500);
        }
		_['domChangeDidOnlineChatHeader'] = domChangeDidOnlineChatHeader;

		function domChangeDidOfflineChatHeader (iNchatId,iNtime) {
            /*
            	@discr
                	change chat-header did show
            	@inputs
	                iNchatId -> stirng
            */
            var chatObject = getPathToDomChatHeader(iNchatId);
            $(chatObject + ' .appBase_userStateOffline').fadeIn().html( DICTIONARY.withString('[dictionary-was] ' + MOMENT(iNtime).calendar()) );
            $(chatObject + ' .appBase_userStateOnline').hide(500);
        }
		_['domChangeDidOfflineChatHeader'] = domChangeDidOfflineChatHeader;

		function domChangeAddUserOnlineFlag (iNchatId) {
            /*
            	@discr
                	add css .flagUserOnline class 
            	@inputs
	                iNchatId -> stirng
            */
            var chatObject = getPathToChatByChatId(iNchatId) + ' .chatDataInUsersBlock';
            $(chatObject).addClass('flagUserOnline');
            $(chatObject).attr('connect_online',1);
        }
		_['domChangeAddUserOnlineFlag'] = domChangeAddUserOnlineFlag;

		function domChangeRemoveUserOnlineFlag (iNchatId,iNtime) {
            /*
            	@discr
                	add css .flagUserOnline class 
            	@inputs
	                iNchatId -> stirng
            */
            var chatObject = getPathToChatByChatId(iNchatId) + ' .chatDataInUsersBlock';
            $(chatObject).removeClass('flagUserOnline');
            $(chatObject).attr('connect_online',iNtime);
        }
		_['domChangeRemoveUserOnlineFlag'] = domChangeRemoveUserOnlineFlag;

        function domChangeIconInChatBlock (iNchatId,icon) {
            /*
                change icon in ChatBlock by ChatBlockId and icon
                1 - chatObject (String)
                    defined chat object
                2 - icon (String)
                    new icon src
            */
            var chatObject = getPathToChatByChatId(iNchatId);
            $(chatObject+" .iconInUserBlock img").attr('src',icon);
        }
		_['domChangeIconInChatBlock'] = domChangeIconInChatBlock;

        function domChangeChatNameInChatBlock (iNchatId,chatName) {
            /*
                change chatName in ChatBlock by ChatBlockId and chatName
                1 - chatObject (String)
                    defined chat object
                2 - chatName (String)
                    new user Name

            */
            var chatObject = getPathToChatByChatId(iNchatId);
            $(chatObject+" .userNameInChatList").text(chatName);
        }
		_['domChangeChatNameInChatBlock'] = domChangeChatNameInChatBlock;


        function domChangeLoginInChatBlock (iNchatId,userLogin) {
            /*
                change chatName in ChatBlock by ChatBlockId and chatName
                1 - chatObject (String)
                    defined chat object
                2 - chatName (String)
                    new user Name

            */
            var chatObject = getPathToChatByChatId(iNchatId);
            $(chatObject).attr('cLogin',userLogin);
        }
		_['domChangeLoginInChatBlock'] = domChangeLoginInChatBlock;

        function domChangeLastMsgTextAndTimeInChatBlock(iNchatId,iNdata){
            /*
                change last message data in Chat Block
                1 - chatObject (String)
                    defined chat object
                2 - iNdata (Object)
                    lmsgText (String)
                    lmsgTime (String)
            */
            var chatObject = getPathToChatByChatId(iNchatId);
            var lastMsgText = V_MESSAGE.msg_getLastMsg (iNdata);
            if($(chatObject + ' .lastMessageInThirdLine .current').text() != lastMsgText) {
                var NowTime = getTodayTime( iNdata.lmsgTime );
                $(chatObject + ' .lastMessageInThirdLine').find('.texts li:first').text(lastMsgText);
                $(chatObject + ' .lastMessageInThirdLine').textillate( 'out' );
                $(chatObject + " .timelastMsgInThirdLine").text( NowTime );
                $(chatObject).attr('data-lastmsgtime', iNdata.lmsgTime );
                startEffSortChats();
            }
        }
		_['domChangeLastMsgTextAndTimeInChatBlock'] = domChangeLastMsgTextAndTimeInChatBlock;


		function getTodayTime (iNtime) {
		    return new Date(iNtime).getHours() + ':' + new Date(iNtime).getMinutes();
		}  
		_['getTodayTime'] = getTodayTime;


		function flash_hideAllFlashBlocks (iNchatId) {
			// body...
            var chatObject = getPathToChatByChatId(iNchatId);
			$(chatObject + ' .aCpAll_flashBLocks').hide();
		}

        function flash_msgSimpleText_activeFlashEffect (iNchatId, iNdata) {
            /*
                invoke chat animation printing simple text
                1 - chatObject
                    defined chat object
                2 - iNdata with liveData and liveStatus

            */

            var chatObject = getPathToChatByChatId(iNchatId);
            var currentValue = $(chatObject + ' .aCpAll_msgSimpleText_animateContainer .current').text();
            if(currentValue != iNdata.liveData){

            	flash_hideAllFlashBlocks(iNchatId);

                if(iNdata.liveType == 1) {
                    // 
                    $(chatObject + ' .aCpAll_msgSimpleText_flashBlock').show();
                    // $(chatObject + ' .aCpAll_msgSimpleText_flashIcon').show();
                }else{
                    // del this later
                }
                $(chatObject + ' .aCpAll_msgSimpleText_animateContainer').find('.texts li:first').text(iNdata.liveData);
                $(chatObject + ' .aCpAll_msgSimpleText_animateContainer').textillate('start');
            }
        }
		_['flash_msgSimpleText_activeFlashEffect'] = flash_msgSimpleText_activeFlashEffect;


		function flash_msgLiveAudio_activeFlashEffect (iNchatId, iNdata) {
            /*
                invoke chat animation printing simple text
                1 - chatObject
                    defined chat object
                2 - iNdata with liveData and liveStatus

            */

            var chatObject = getPathToChatByChatId(iNchatId);
            var currentValue = $(chatObject + ' .aCpAll_msgLiveAudio_animateContainer .current').text();
            if(currentValue != iNdata.liveData){
	            flash_hideAllFlashBlocks(iNchatId);
                if(iNdata.liveType == 20){
                    // 
                    $(chatObject + ' .aCpAll_msgLiveAudio_flashBlock').show();
                    $(chatObject + ' .aCpAll_msgLiveAudio_flashIcon').show();
                }else{
                    // del this later
                }
                $(chatObject + ' .aCpAll_msgLiveAudio_animateContainer').find('.texts li:first').text(iNdata.liveData);
                $(chatObject + ' .aCpAll_msgLiveAudio_animateContainer').textillate('start');
            }
        }
		_['flash_msgLiveAudio_activeFlashEffect'] = flash_msgLiveAudio_activeFlashEffect;

		function flash_msgLiveVideo_activeFlashEffect (iNchatId, iNdata) {
            /*
                invoke chat animation printing simple text
                1 - chatObject
                    defined chat object
                2 - iNdata with liveData and liveStatus

            */
            
            var chatObject = getPathToChatByChatId(iNchatId);
            var currentValue = $(chatObject + ' .aCpAll_msgLiveVideo_animateContainer .current').text();
            if(currentValue != iNdata.liveData){
	            flash_hideAllFlashBlocks(iNchatId);

                if(iNdata.liveType == 21) {
                    // 
                    $(chatObject + ' .aCpAll_msgLiveVideo_flashBlock').show();
                    $(chatObject + ' .aCpAll_msgLiveVideo_flashIcon').show();
                }else{
                    // del this later
                }
                $(chatObject + ' .aCpAll_msgLiveVideo_animateContainer').find('.texts li:first').text(iNdata.liveData);
                $(chatObject + ' .aCpAll_msgLiveVideo_animateContainer').textillate('start');
            }
        }
		_['flash_msgLiveVideo_activeFlashEffect'] = flash_msgLiveVideo_activeFlashEffect;

		function domAddVerificateStatusToChatBlock (chatObject) {
            /*
                add verificate status to chatBlock
                1 - chatObject (String)
                    defined chat object
            */
            $(chatObject + ' .usersNameInUserBlock').append("<span class=\"isVerificateinUserBlock\"></span>");
        } _['domAddVerificateStatusToChatBlock'] = domAddVerificateStatusToChatBlock;
	//> effects


	function onClickCategoryForCreateChat (iNsuccessFunc, iNerrorFunc) {
        /*
            @inputs
                @required
        */
        var iNsuccessFunc = iNsuccessFunc;
        var iNerrorFunc = iNerrorFunc;
        (
        	()=>{
	        	$('.viewCategoryPrompt').click( 
	        		(event) =>  {
			            var thisUserId          = $(event.target).attr('categoryUserId'),
			                thisUserLogin       = $(event.target).attr('categoryUserLogin');

			            if( thisUserId && thisUserLogin ) {
			                // SUCCESS we has login and uid for create chat
			                showPromptQuestionForCreateChat ( iNsuccessFunc, iNerrorFunc, thisUserId , thisUserLogin);
			            } else {
			                // ERROR we has NOT  login and uid
			                if (typeof iNerrorFunc == 'function') iNerrorFunc ();

			            }
	        		}
	        	);
	        }
        )()
        
    } _['onClickCategoryForCreateChat'] = onClickCategoryForCreateChat;


    function showPromptQuestionForCreateChat ( iNsuccessFunc, iNerrorFunc, iNuid, iNulogin) {
        (()=>{

        	swal({
	          title: '    ?',
	          text: "   !",
	          type: 'warning',
	          showCancelButton: true,
	          confirmButtonColor: '#3085d6',
	          cancelButtonColor: '#d33',
	          confirmButtonText: ',  !',
	          cancelButtonText: ', !',
	          confirmButtonClass: 'btn btn-success',
	          cancelButtonClass: 'btn btn-danger',
	          buttonsStyling: false
	        }).then(
		        (result) => {
		          if (result.value) {
		            if (typeof iNsuccessFunc == 'function') iNsuccessFunc(iNuid,iNulogin);
		            // result.dismiss can be 'cancel', 'overlay',
		            // 'close', and 'timer'
		          } else if (result.dismiss === 'cancel') {
		            if (typeof iNerrorFunc == 'function') iNerrorFunc(iNuid,iNulogin);
		          }
		        }
	        )
        })()
        
    } // _['showPromptQuestionForCreateChat'] = showPromptQuestionForCreateChat;

	return _;
});
define('m_category',['jquery','v_category','m_view','m_app','m_user','dictionary','sweetalert2', 'url'], function ( $, VIEW, M_VIEW, M_APP,USER, DICTIONARY, SWAL, URL) {
	const _        = {'view':VIEW};
	const CONST    = {};



	function getObjectForUpdateChatBlock  (chatBlock) {
        var changeObject = {};
            if( typeof(chatBlock.msg) != 'undefined' ) {
                if( typeof(chatBlock.msg.content) == 'string' ) 	changeObject.lmsgText 	= chatBlock.msg.content;
                if( typeof(chatBlock.msg.time) != 'undefined' )     changeObject.lmsgTime 	= chatBlock.msg.time;
                if( typeof(chatBlock.msg.type) != 'undefined' )     changeObject.lmsgType 	= chatBlock.msg.type;
                if( typeof(chatBlock.msg.uid) != 'undefined'  )     changeObject.lmsgUid 	= chatBlock.msg.uid;
            }
            if( typeof(chatBlock.live) != 'undefined' ) {
                if( typeof(chatBlock.live.status) 	!= 'undefined' )  	changeObject.liveStatus = chatBlock.live.status;
                if( typeof(chatBlock.live.type) 	!= 'undefined' )    changeObject.liveType = chatBlock.live.type;
                if( typeof(chatBlock.live.data) 	!= 'undefined' )    changeObject.liveData = chatBlock.live.data;
                if( typeof(chatBlock.live.uid) 		!= 'undefined' )     changeObject.liveUser = chatBlock.live.uid;
            }
        return changeObject;
    }
    _['getObjectForUpdateChatBlock'] = getObjectForUpdateChatBlock;


    function userForPrivateChat(iNchatId,iNuser){
	    var prefix ='pchat_user_';
	    if(typeof(iNuser) != 'undefined')
	        return M_APP.save(prefix+iNchatId,iNuser);
	    else
	        return M_APP.get(prefix+iNchatId);
	}
    _['userForPrivateChat'] = userForPrivateChat;

    function getChatIconByType (iNchaType,iNobject) {
        /*
            @inputs
                iNchatType -> number
                iNobject
                    uid -> string
                    chatId -> string
        */
        var chatType = iNchaType, result;
        if (chatType == 1) {
            // private chat

            result =  URL.getUserIconByUid(iNobject['userId']);

        } else if(chatType == 2) {
            // group chat
            result = URL.getChatIconByChatId(iNobject['chatId']);
        }
        console.log('getChatIconByType - chatType, result', chatType, result );
        return result;
    } _.getChatIconByType = getChatIconByType;

    function safeUpdateChatBlock (iNdata,chatType) {
        /*
           	@inputs
	           	iNdata
	                @required
	                    chatId || uuid 
	                    userName
	                    lmsgText
	                    lmsgTime
	                @optional
	                    uuid
	                    newMsgCount
	                    chatType (default 1 private)
					@depends
	                    findChatBlock - for find chatId object
        */
        var uuid, chatId=iNdata.chatId,userName;
        var  DomBloc, lmsg_text, lmsg_time, countNewMessages, newMsgBlock, verificate;

        var chatLength = VIEW.findChatBlock(chatId);
                console.log('safeUpdateChatBlock - iNdata', iNdata );
        if (  chatLength < 1 ) {
        		//CHANGE STATIC PARAMS
                // chatType = 'private';
                uuid = userForPrivateChat(chatId);
        		var objForCreateChat = iNdata;
        			objForCreateChat['userId'] 		= uuid;
        			objForCreateChat['chatType'] 	= chatType;

                // get chat icon
                var chatIcon    = getChatIconByType(chatType,objForCreateChat); objForCreateChat['icon'] = chatIcon;

                // create chat
                VIEW.createChatList (objForCreateChat, () => {
                    // after add chat

                    // set animation effect (eg. scroll )
                    VIEW.setEffectsForChatList(chatId);
                    // add on click for this chat event
                    console.log('safeUpdateChatBlock - objForCreateChat',objForCreateChat);
                    VIEW.addOnClickActionForChatList ( objForCreateChat['chatId']);

                });
		} 
        domChangeChatBlock (chatId,iNdata);
    }
    _['safeUpdateChatBlock'] = safeUpdateChatBlock;

    function createPrivateChat () {
        /*
           	@inputs
	           	iNdata
	                @required
	                    chatId || uuid 
	                    userName
	                    lmsgText
	                    lmsgTime
	                @optional
	                    uuid
	                    newMsgCount
	                    chatType (default 1 private)
					@depends
	                    findChatBlock - for find chatId object
        */

    }
    _['createPrivateChat'] = createPrivateChat;
   
	function domChangeChatBlock (iNchatId,iNdata) {
	    /*
	        change icon,userName,(lmsgText and lmsgTime),new msgCoung in ChatBlock by ChatBlockId and otherNeedData
	        1 - iNchatId (String)
	            defined chat id
	        2 - iNdata
	            new icon src
	    */
	    // increase new msg count by $newMsgCount if it isset
	        if(  typeof(iNdata.newMsgCount) != 'undefined' )	VIEW.domPlusCountMessages(iNchatId,iNdata.newMsgCount);
	    // change userName if userName isset
	        if(  typeof(iNdata.chatName) != 'undefined' ) 		
        		VIEW.domChangeChatNameInChatBlock(iNchatId,iNdata.chatName); 
	        else {
		   		// change userPhone if userName isset
		        if(  typeof(iNdata.userPhone) != 'undefined' ) 		VIEW.domChangeChatNameInChatBlock(iNchatId,iNdata.userPhone);

	        }

	    // chat last msg text and last msg time if isset lmsgText
	        if(  typeof(iNdata.lmsgText) != 'undefined' ) 		{
	        	VIEW.domChangeLastMsgTextAndTimeInChatBlock(iNchatId,iNdata);
        	}
	    // chat last msg text and last msg time if isset lmsgText
	        if(  typeof(iNdata.login) != 'undefined' ) 			VIEW.domChangeLoginInChatBlock(iNchatId,iNdata);
	    // change icon if it isset
	        if(  typeof(iNdata.icon) != 'undefined' ) 			VIEW.domChangeIconInChatBlock(iNchatId,iNdata.icon);
	    //addVirificateStatusToBlock
	        if( typeof(iNdata.verificate) != 'undefined' && iNdata.verificate == 1) VIEW.domAddVerificateStatusToChatBlock(iNchatId);

        // change user state 
    		if(  typeof(iNdata.userOnline) != 'undefined' ) {
    			if( iNdata.userOnline == 1) {
    				// set user online
    				VIEW.domChangeAddUserOnlineFlag(iNchatId);
    				VIEW.domChangeDidOnlineChatHeader(iNchatId);

    			} else {
    				// set user offline
    				VIEW.domChangeRemoveUserOnlineFlag(iNchatId,iNdata.userOnline);
    				VIEW.domChangeDidOfflineChatHeader(iNchatId,iNdata.userOnline);

    			}
    		}
        
	    if( typeof(iNdata.liveData) != 'undefined' &&  typeof(iNdata.liveType) != 'undefined' &&  typeof(iNdata.liveUser) != 'undefined' && USER.getMyId() != iNdata.liveUser) {
	        flash_startEffectByDataFromDb (iNchatId,iNdata);
	        VIEW.startEffHideLiveInChatsList(iNchatId);
	    }
	}
    _['domChangeChatBlock'] = domChangeChatBlock;



    function flash_startEffectByDataFromDb (iNchatId,iNdata) {
    	/*
    		@inputs
    			iNchatId -> string
    			iNdata -> object
	    			liveData
	    			liveType
	    			liveUser
	    			liveTime
    	*/
    	switch(iNdata.liveType) {
            case 1: // simple text chat
            	iNdata.liveData = DICTIONARY.withString("[dictionary-symbols]")+ " - "  + iNdata.liveData;
				VIEW.flash_msgSimpleText_activeFlashEffect(iNchatId,iNdata);
            break;
            case 20: // live audio
            	iNdata.liveData = DICTIONARY.withString("[dictionary-seconds]")+ " - " + iNdata.liveData;
				VIEW.flash_msgLiveAudio_activeFlashEffect(iNchatId,iNdata);
            break;
            case 21: // live video
            	iNdata.liveData = DICTIONARY.withString("[dictionary-seconds]")+ " - " + iNdata.liveData;
				VIEW.flash_msgLiveVideo_activeFlashEffect(iNchatId,iNdata);
            break;
        }
    }

   
    function addChatBlockToCategory (iNuserData,iNchatId,iNuserId) {
        // chatType does not work - CHANGE
        var href = "chatId="+iNchatId+"&userId="+iNuserId+"&chatType=1&back=1"
        var objForCreateChat = {
           'app'            : 'chat', 
           'code'           : 'chiefChat',
           'page'           : 'index',
           'name'           : DICTIONARY.withString('[app-chat]'),
           'id'             : iNchatId,
           'data'           : href,
           'classForATeg'   : 'privateChatBtn',//
        };
        iNuserData['categories']['chat'] = {};
        iNuserData['categories']['chat'][iNchatId] = objForCreateChat;
        return true;

    }
    _['addChatBlockToCategory'] = addChatBlockToCategory;

    function addDisabledChatBlockToCategory (iNuserData,iNuserId,iNuserLogin) {
        // chatType does not work - CHANGE
        if ( USER.getMyId() ) {
            // if we are auth user -> we created link for create chat
            var objForCreateChat = {
               'app'            : 'chat', 
               'code'           : 'chiefChat',
               'page'           : 'index',
               'name'           : DICTIONARY.withString('[app-chat]'),
               'id'             : iNuserId,
               'classForATeg'   : 'viewCategoryPrompt',//
               'attrForATeg'    : `categoryUserId='${iNuserId}' categoryUserLogin='${iNuserLogin}'`,
            };
        } else {
            // if we are NON authed user -> we created link for view error
            var objForCreateChat = {
               'app'            : 'chat', 
               'code'           : 'chiefChat',
               'page'           : 'index',
               'name'           : DICTIONARY.withString('[app-chat]'),
               'id'             : iNuserId,
               'classForATeg'   : 'viewError',
               'attrForATeg'    : "errorText='[phrase-needSignForChat]'",

            };
        }
        
        iNuserData['categories']['chat'] = {};
        iNuserData['categories']['chat'][iNuserId] = objForCreateChat;
        return true;
    }
    _['addDisabledChatBlockToCategory'] = addDisabledChatBlockToCategory;
    
    

	return _;
});
define('m_storage',['m_firebase'],function( FIREBASE ) {
	const _ = {};
	const CONST = {};


	// set firebase framework
    const STORAGE = FIREBASE.storage().ref();

    function getDownloadURL (iNpatch, iNfunction) {
    	STORAGE.child(iNpatch).getDownloadURL().then(function(url) {
		  // `url` is the download URL for 'images/stars.jpg'
		  iNfunction(null,url);
		 
		}).catch(function(error) {
		  // Handle any errors
		  iNfunction(error,null);
		});
    } _.getDownloadURL = getDownloadURL;

	function upload ( iNdata , iNfunctions) { 
		/*
			@examplae
				upload (
					{
						'file' 				: file
						'pathForSaveFile'	: 'public/v3.webm'
						'mimeType' 			: 'video/webm'
					}
					,
					{
						
					}
				)
			@discr
				for uploadfile
			@inputs
				iNdata -> object
					file
					pathForSaveFile
					mimeType -> tring
				iNfunctions -> object
					onProgress (progress : int)
					onError ( error : object )
					onSuccess (downloadURL: string)
		*/

		var metadataForPassToStorage = {},
			mimeType;

		var file = iNdata['file'];
		var pathForSaveFile = iNdata['pathForSaveFile'];

		if ( typeof iNdata['mimeType'] == 'string' ) {
			mimeType = iNdata['mimeType'];
			metadataForPassToStorage = {
				  contentType: mimeType
	        }
		} 
		 	
		var uploadTask = STORAGE.child(pathForSaveFile).put( file , metadataForPassToStorage );//metadata
				uploadTask.on(
					firebase.storage.TaskEvent.STATE_CHANGED, // or 'state_changed'
					function(snapshot) {
						// Get task progress, including the number of bytes uploaded and the total number of bytes to be uploaded
						var progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;


						console.log('storage.js upload - Upload is ' + progress + '% done');
						if (typeof iNfunctions['onProgress'] == 'function') iNfunctions['onProgress'](progress);
					}, 
					function(error) {
					  // A full list of error codes is available at
					  // https://firebase.google.com/docs/storage/web/handle-errors

					  if (typeof iNfunctions['onError'] == 'function') iNfunctions['onError'](error);
					  console.log('storage.js upload - uploadTask error',error);
					  // switch (error.code) {
					  //   case 'storage/unauthorized':
					  //     // User doesn't have permission to access the object
					  //   break;

					  //   case 'storage/canceled':
					  //     // User canceled the upload
					  //   break;


					  //   case 'storage/unknown':
					  //     // Unknown error occurred, inspect error.serverResponse
					  //   break;
					  // }
					}, 
					function() {
					  	// Upload completed successfully, now we can get the download URL
					  	var downloadURL = uploadTask.snapshot.downloadURL;
						if (typeof iNfunctions['onSuccess'] == 'function') iNfunctions['onSuccess'](downloadURL);
					}
				);
		
	}
	_['upload'] = upload;

	function uploadBlob (iNblob, iNdata , iNfunctions) {
		iNdata['file'] = iNblob;
		upload (iNdata , iNfunctions);
	}
	_['uploadBlob'] = uploadBlob;

	return _;
});


// Last time updated: 2017-08-31 4:03:22 AM UTC

// __________________________
// MediaStreamRecorder v1.3.4

// Open-Sourced: https://github.com/streamproc/MediaStreamRecorder

// --------------------------------------------------
// Muaz Khan     - www.MuazKhan.com
// MIT License   - www.WebRTC-Experiment.com/licence
// --------------------------------------------------

// ______________________
// MediaStreamRecorder.js

function MediaStreamRecorder(mediaStream) {
    if (!mediaStream) {
        throw 'MediaStream is mandatory.';
    }

    // void start(optional long timeSlice)
    // timestamp to fire "ondataavailable"
    this.start = function(timeSlice) {
        var Recorder;

        if (typeof MediaRecorder !== 'undefined') {
            Recorder = MediaRecorderWrapper;
        } else if (IsChrome || IsOpera || IsEdge) {
            if (this.mimeType.indexOf('video') !== -1) {
                Recorder = WhammyRecorder;
            } else if (this.mimeType.indexOf('audio') !== -1) {
                Recorder = StereoAudioRecorder;
            }
        }

        // video recorder (in GIF format)
        if (this.mimeType === 'image/gif') {
            Recorder = GifRecorder;
        }

        // audio/wav is supported only via StereoAudioRecorder
        // audio/pcm (int16) is supported only via StereoAudioRecorder
        if (this.mimeType === 'audio/wav' || this.mimeType === 'audio/pcm') {
            Recorder = StereoAudioRecorder;
        }

        // allows forcing StereoAudioRecorder.js on Edge/Firefox
        if (this.recorderType) {
            Recorder = this.recorderType;
        }

        mediaRecorder = new Recorder(mediaStream);
        mediaRecorder.blobs = [];

        var self = this;
        mediaRecorder.ondataavailable = function(data) {
            mediaRecorder.blobs.push(data);
            self.ondataavailable(data);
        };
        mediaRecorder.onstop = this.onstop;
        mediaRecorder.onStartedDrawingNonBlankFrames = this.onStartedDrawingNonBlankFrames;

        // Merge all data-types except "function"
        mediaRecorder = mergeProps(mediaRecorder, this);

        mediaRecorder.start(timeSlice);
    };

    this.onStartedDrawingNonBlankFrames = function() {};
    this.clearOldRecordedFrames = function() {
        if (!mediaRecorder) {
            return;
        }

        mediaRecorder.clearOldRecordedFrames();
    };

    this.stop = function() {
        if (mediaRecorder) {
            mediaRecorder.stop();
        }
    };

    this.ondataavailable = function(blob) {
        if (this.disableLogs) return;
        console.log('ondataavailable..', blob);
    };

    this.onstop = function(error) {
        console.warn('stopped..', error);
    };

    this.save = function(file, fileName) {
        if (!file) {
            if (!mediaRecorder) {
                return;
            }

            ConcatenateBlobs(mediaRecorder.blobs, mediaRecorder.blobs[0].type, function(concatenatedBlob) {
                invokeSaveAsDialog(concatenatedBlob);
            });
            return;
        }
        invokeSaveAsDialog(file, fileName);
    };
    
    this.get = function( iNfunction ) {
        setTimeout(
            () => {
                var thisType;
                if (!mediaRecorder) {
                    return;
                }

                try {
                    thisType = mediaRecorder.blobs[0].type;
                }catch (e) {
                    thisType = false;
                }
                if ( thisType )
                    ConcatenateBlobs(mediaRecorder.blobs, thisType, (concatenatedBlob) => {
                        console.log('this.get concatenatedBlob', concatenatedBlob );
                        if( typeof (iNfunction) == 'function' ) iNfunction(false, concatenatedBlob);
                    });
                return;
            return;
            },
            1000
         );
       
        // }
        // invokeSaveAsDialog(file, fileName);
    };

    this.pause = function() {
        if (!mediaRecorder) {
            return;
        }
        mediaRecorder.pause();

        if (this.disableLogs) return;
        console.log('Paused recording.', this.mimeType || mediaRecorder.mimeType);
    };

    this.resume = function() {
        if (!mediaRecorder) {
            return;
        }
        mediaRecorder.resume();

        if (this.disableLogs) return;
        console.log('Resumed recording.', this.mimeType || mediaRecorder.mimeType);
    };

    // StereoAudioRecorder || WhammyRecorder || MediaRecorderWrapper || GifRecorder
    this.recorderType = null;

    // video/webm or audio/webm or audio/ogg or audio/wav
    this.mimeType = 'video/webm';

    // logs are enabled by default
    this.disableLogs = false;

    // Reference to "MediaRecorder.js"
    var mediaRecorder;
}

// ______________________
// MultiStreamRecorder.js

function MultiStreamRecorder(arrayOfMediaStreams, options) {
    arrayOfMediaStreams = arrayOfMediaStreams || [];

    if (arrayOfMediaStreams instanceof MediaStream) {
        arrayOfMediaStreams = [arrayOfMediaStreams];
    }

    var self = this;

    var mixer;
    var mediaRecorder;

    options = options || {
        mimeType: 'video/webm',
        video: {
            width: 360,
            height: 240
        }
    };

    if (!options.frameInterval) {
        options.frameInterval = 10;
    }

    if (!options.video) {
        options.video = {};
    }

    if (!options.video.width) {
        options.video.width = 360;
    }

    if (!options.video.height) {
        options.video.height = 240;
    }

    this.start = function(timeSlice) {
        // github/muaz-khan/MultiStreamsMixer
        mixer = new MultiStreamsMixer(arrayOfMediaStreams);

        if (getVideoTracks().length) {
            mixer.frameInterval = options.frameInterval || 10;
            mixer.width = options.video.width || 360;
            mixer.height = options.video.height || 240;
            mixer.startDrawingFrames();
        }

        if (typeof self.previewStream === 'function') {
            self.previewStream(mixer.getMixedStream());
        }

        // record using MediaRecorder API
        mediaRecorder = new MediaStreamRecorder(mixer.getMixedStream());

        for (var prop in self) {
            if (typeof self[prop] !== 'function') {
                mediaRecorder[prop] = self[prop];
            }
        }

        mediaRecorder.ondataavailable = function(blob) {
            self.ondataavailable(blob);
        };

        mediaRecorder.onstop = self.onstop;

        mediaRecorder.start(timeSlice);
    };

    function getVideoTracks() {
        var tracks = [];
        arrayOfMediaStreams.forEach(function(stream) {
            stream.getVideoTracks().forEach(function(track) {
                tracks.push(track);
            });
        });
        return tracks;
    }

    this.stop = function(callback) {
        if (!mediaRecorder) {
            return;
        }

        mediaRecorder.stop(function(blob) {
            callback(blob);
        });
    };

    this.pause = function() {
        if (mediaRecorder) {
            mediaRecorder.pause();
        }
    };

    this.resume = function() {
        if (mediaRecorder) {
            mediaRecorder.resume();
        }
    };

    this.clearRecordedData = function() {
        if (mediaRecorder) {
            mediaRecorder.clearRecordedData();
            mediaRecorder = null;
        }

        if (mixer) {
            mixer.releaseStreams();
            mixer = null;
        }
    };

    this.addStreams = this.addStream = function(streams) {
        if (!streams) {
            throw 'First parameter is required.';
        }

        if (!(streams instanceof Array)) {
            streams = [streams];
        }

        arrayOfMediaStreams.concat(streams);

        if (!mediaRecorder || !mixer) {
            return;
        }

        mixer.appendStreams(streams);
    };

    this.resetVideoStreams = function(streams) {
        if (!mixer) {
            return;
        }

        if (streams && !(streams instanceof Array)) {
            streams = [streams];
        }

        mixer.resetVideoStreams(streams);
    };

    this.ondataavailable = function(blob) {
        if (self.disableLogs) {
            return;
        }

        console.log('ondataavailable', blob);
    };

    this.onstop = function() {};

    // for debugging
    this.name = 'MultiStreamRecorder';
    this.toString = function() {
        return this.name;
    };
}

if (typeof MediaStreamRecorder !== 'undefined') {
    MediaStreamRecorder.MultiStreamRecorder = MultiStreamRecorder;
}

// Last time updated: 2017-08-31 2:56:12 AM UTC

// ________________________
// MultiStreamsMixer v1.0.2

// Open-Sourced: https://github.com/muaz-khan/MultiStreamsMixer

// --------------------------------------------------
// Muaz Khan     - www.MuazKhan.com
// MIT License   - www.WebRTC-Experiment.com/licence
// --------------------------------------------------

function MultiStreamsMixer(arrayOfMediaStreams) {

    // requires: chrome://flags/#enable-experimental-web-platform-features

    var videos = [];
    var isStopDrawingFrames = false;

    var canvas = document.createElement('canvas');
    var context = canvas.getContext('2d');
    canvas.style = 'opacity:0;position:absolute;z-index:-1;top: -100000000;left:-1000000000; margin-top:-1000000000;margin-left:-1000000000;';
    (document.body || document.documentElement).appendChild(canvas);

    this.disableLogs = false;
    this.frameInterval = 10;

    this.width = 360;
    this.height = 240;

    // use gain node to prevent echo
    this.useGainNode = true;

    var self = this;

    // _____________________________
    // Cross-Browser-Declarations.js

    // WebAudio API representer
    var AudioContext = window.AudioContext;

    if (typeof AudioContext === 'undefined') {
        if (typeof webkitAudioContext !== 'undefined') {
            /*global AudioContext:true */
            AudioContext = webkitAudioContext;
        }

        if (typeof mozAudioContext !== 'undefined') {
            /*global AudioContext:true */
            AudioContext = mozAudioContext;
        }
    }

    /*jshint -W079 */
    var URL = window.URL;

    if (typeof URL === 'undefined' && typeof webkitURL !== 'undefined') {
        /*global URL:true */
        URL = webkitURL;
    }

    if (typeof navigator !== 'undefined' && typeof navigator.getUserMedia === 'undefined') { // maybe window.navigator?
        if (typeof navigator.webkitGetUserMedia !== 'undefined') {
            navigator.getUserMedia = navigator.webkitGetUserMedia;
        }

        if (typeof navigator.mozGetUserMedia !== 'undefined') {
            navigator.getUserMedia = navigator.mozGetUserMedia;
        }
    }

    var MediaStream = window.MediaStream;

    if (typeof MediaStream === 'undefined' && typeof webkitMediaStream !== 'undefined') {
        MediaStream = webkitMediaStream;
    }

    /*global MediaStream:true */
    if (typeof MediaStream !== 'undefined') {
        if (!('getVideoTracks' in MediaStream.prototype)) {
            MediaStream.prototype.getVideoTracks = function() {
                if (!this.getTracks) {
                    return [];
                }

                var tracks = [];
                this.getTracks.forEach(function(track) {
                    if (track.kind.toString().indexOf('video') !== -1) {
                        tracks.push(track);
                    }
                });
                return tracks;
            };

            MediaStream.prototype.getAudioTracks = function() {
                if (!this.getTracks) {
                    return [];
                }

                var tracks = [];
                this.getTracks.forEach(function(track) {
                    if (track.kind.toString().indexOf('audio') !== -1) {
                        tracks.push(track);
                    }
                });
                return tracks;
            };
        }

        // override "stop" method for all browsers
        if (typeof MediaStream.prototype.stop === 'undefined') {
            MediaStream.prototype.stop = function() {
                this.getTracks().forEach(function(track) {
                    track.stop();
                });
            };
        }
    }

    var Storage = {};

    if (typeof AudioContext !== 'undefined') {
        Storage.AudioContext = AudioContext;
    } else if (typeof webkitAudioContext !== 'undefined') {
        Storage.AudioContext = webkitAudioContext;
    }

    this.startDrawingFrames = function() {
        drawVideosToCanvas();
    };

    function drawVideosToCanvas() {
        if (isStopDrawingFrames) {
            return;
        }

        var videosLength = videos.length;

        var fullcanvas = false;
        var remaining = [];
        videos.forEach(function(video) {
            if (!video.stream) {
                video.stream = {};
            }

            if (video.stream.fullcanvas) {
                fullcanvas = video;
            } else {
                remaining.push(video);
            }
        });

        if (fullcanvas) {
            canvas.width = fullcanvas.stream.width;
            canvas.height = fullcanvas.stream.height;
        } else if (remaining.length) {
            canvas.width = videosLength > 1 ? remaining[0].width * 2 : remaining[0].width;
            canvas.height = videosLength > 2 ? remaining[0].height * 2 : remaining[0].height;
        } else {
            canvas.width = self.width || 360;
            canvas.height = self.height || 240;
        }

        if (fullcanvas && fullcanvas instanceof HTMLVideoElement) {
            drawImage(fullcanvas);
        }

        remaining.forEach(function(video, idx) {
            drawImage(video, idx);
        });

        setTimeout(drawVideosToCanvas, self.frameInterval);
    }

    function drawImage(video, idx) {
        if (isStopDrawingFrames) {
            return;
        }

        var x = 0;
        var y = 0;
        var width = video.width;
        var height = video.height;

        if (idx === 1) {
            x = video.width;
        }

        if (idx === 2) {
            y = video.height;
        }

        if (idx === 3) {
            x = video.width;
            y = video.height;
        }

        if (typeof video.stream.left !== 'undefined') {
            x = video.stream.left;
        }

        if (typeof video.stream.top !== 'undefined') {
            y = video.stream.top;
        }

        if (typeof video.stream.width !== 'undefined') {
            width = video.stream.width;
        }

        if (typeof video.stream.height !== 'undefined') {
            height = video.stream.height;
        }

        context.drawImage(video, x, y, width, height);

        if (typeof video.stream.onRender === 'function') {
            video.stream.onRender(context, x, y, width, height, idx);
        }
    }

    function getMixedStream() {
        isStopDrawingFrames = false;
        var mixedVideoStream = getMixedVideoStream();

        var mixedAudioStream = getMixedAudioStream();
        if (mixedAudioStream) {
            mixedAudioStream.getAudioTracks().forEach(function(track) {
                mixedVideoStream.addTrack(track);
            });
        }

        var fullcanvas;
        arrayOfMediaStreams.forEach(function(stream) {
            if (stream.fullcanvas) {
                fullcanvas = true;
            }
        });

        return mixedVideoStream;
    }

    function getMixedVideoStream() {
        resetVideoStreams();

        var capturedStream;

        if ('captureStream' in canvas) {
            capturedStream = canvas.captureStream();
        } else if ('mozCaptureStream' in canvas) {
            capturedStream = canvas.mozCaptureStream();
        } else if (!self.disableLogs) {
            console.error('Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features');
        }

        var videoStream = new MediaStream();

        capturedStream.getVideoTracks().forEach(function(track) {
            videoStream.addTrack(track);
        });

        canvas.stream = videoStream;

        return videoStream;
    }

    function getMixedAudioStream() {
        // via: @pehrsons
        if (!Storage.AudioContextConstructor) {
            Storage.AudioContextConstructor = new Storage.AudioContext();
        }

        self.audioContext = Storage.AudioContextConstructor;

        self.audioSources = [];

        if (self.useGainNode === true) {
            self.gainNode = self.audioContext.createGain();
            self.gainNode.connect(self.audioContext.destination);
            self.gainNode.gain.value = 0; // don't hear self
        }

        var audioTracksLength = 0;
        arrayOfMediaStreams.forEach(function(stream) {
            if (!stream.getAudioTracks().length) {
                return;
            }

            audioTracksLength++;

            var audioSource = self.audioContext.createMediaStreamSource(stream);

            if (self.useGainNode === true) {
                audioSource.connect(self.gainNode);
            }

            self.audioSources.push(audioSource);
        });

        if (!audioTracksLength) {
            return;
        }

        self.audioDestination = self.audioContext.createMediaStreamDestination();
        self.audioSources.forEach(function(audioSource) {
            audioSource.connect(self.audioDestination);
        });
        return self.audioDestination.stream;
    }

    function getVideo(stream) {
        var video = document.createElement('video');

        if ('srcObject' in video) {
            video.srcObject = stream;
        } else {
            video.src = URL.createObjectURL(stream);
        }

        video.muted = true;
        video.volume = 0;

        video.width = stream.width || self.width || 360;
        video.height = stream.height || self.height || 240;

        video.play();

        return video;
    }

    this.appendStreams = function(streams) {
        if (!streams) {
            throw 'First parameter is required.';
        }

        if (!(streams instanceof Array)) {
            streams = [streams];
        }

        arrayOfMediaStreams.concat(streams);

        streams.forEach(function(stream) {
            if (stream.getVideoTracks().length) {
                var video = getVideo(stream);
                video.stream = stream;
                videos.push(video);
            }

            if (stream.getAudioTracks().length && self.audioContext) {
                var audioSource = self.audioContext.createMediaStreamSource(stream);
                audioSource.connect(self.audioDestination);
                self.audioSources.push(audioSource);
            }
        });
    };

    this.releaseStreams = function() {
        videos = [];
        isStopDrawingFrames = true;

        if (self.gainNode) {
            self.gainNode.disconnect();
            self.gainNode = null;
        }

        if (self.audioSources.length) {
            self.audioSources.forEach(function(source) {
                source.disconnect();
            });
            self.audioSources = [];
        }

        if (self.audioDestination) {
            self.audioDestination.disconnect();
            self.audioDestination = null;
        }

        self.audioContext = null;

        context.clearRect(0, 0, canvas.width, canvas.height);

        if (canvas.stream) {
            canvas.stream.stop();
            canvas.stream = null;
        }
    };

    this.resetVideoStreams = function(streams) {
        if (streams && !(streams instanceof Array)) {
            streams = [streams];
        }

        resetVideoStreams(streams);
    };

    function resetVideoStreams(streams) {
        videos = [];
        streams = streams || arrayOfMediaStreams;

        // via: @adrian-ber
        streams.forEach(function(stream) {
            if (!stream.getVideoTracks().length) {
                return;
            }

            var video = getVideo(stream);
            video.stream = stream;
            videos.push(video);
        });
    }

    // for debugging
    this.name = 'MultiStreamsMixer';
    this.toString = function() {
        return this.name;
    };

    this.getMixedStream = getMixedStream;

}

// _____________________________
// Cross-Browser-Declarations.js

var browserFakeUserAgent = 'Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45';

(function(that) {
    if (typeof window !== 'undefined') {
        return;
    }

    if (typeof window === 'undefined' && typeof global !== 'undefined') {
        global.navigator = {
            userAgent: browserFakeUserAgent,
            getUserMedia: function() {}
        };

        /*global window:true */
        that.window = global;
    } else if (typeof window === 'undefined') {
        // window = this;
    }

    if (typeof document === 'undefined') {
        /*global document:true */
        that.document = {};

        document.createElement = document.captureStream = document.mozCaptureStream = function() {
            return {};
        };
    }

    if (typeof location === 'undefined') {
        /*global location:true */
        that.location = {
            protocol: 'file:',
            href: '',
            hash: ''
        };
    }

    if (typeof screen === 'undefined') {
        /*global screen:true */
        that.screen = {
            width: 0,
            height: 0
        };
    }
})(typeof global !== 'undefined' ? global : window);

// WebAudio API representer
var AudioContext = window.AudioContext;

if (typeof AudioContext === 'undefined') {
    if (typeof webkitAudioContext !== 'undefined') {
        /*global AudioContext:true */
        AudioContext = webkitAudioContext;
    }

    if (typeof mozAudioContext !== 'undefined') {
        /*global AudioContext:true */
        AudioContext = mozAudioContext;
    }
}

if (typeof window === 'undefined') {
    /*jshint -W020 */
    window = {};
}

// WebAudio API representer
var AudioContext = window.AudioContext;

if (typeof AudioContext === 'undefined') {
    if (typeof webkitAudioContext !== 'undefined') {
        /*global AudioContext:true */
        AudioContext = webkitAudioContext;
    }

    if (typeof mozAudioContext !== 'undefined') {
        /*global AudioContext:true */
        AudioContext = mozAudioContext;
    }
}

/*jshint -W079 */
var URL = window.URL;

if (typeof URL === 'undefined' && typeof webkitURL !== 'undefined') {
    /*global URL:true */
    URL = webkitURL;
}

if (typeof navigator !== 'undefined') {
    if (typeof navigator.webkitGetUserMedia !== 'undefined') {
        navigator.getUserMedia = navigator.webkitGetUserMedia;
    }

    if (typeof navigator.mozGetUserMedia !== 'undefined') {
        navigator.getUserMedia = navigator.mozGetUserMedia;
    }
} else {
    navigator = {
        getUserMedia: function() {},
        userAgent: browserFakeUserAgent
    };
}

var IsEdge = navigator.userAgent.indexOf('Edge') !== -1 && (!!navigator.msSaveBlob || !!navigator.msSaveOrOpenBlob);

var IsOpera = false;
if (typeof opera !== 'undefined' && navigator.userAgent && navigator.userAgent.indexOf('OPR/') !== -1) {
    IsOpera = true;
}
var IsChrome = !IsEdge && !IsEdge && !!navigator.webkitGetUserMedia;

var MediaStream = window.MediaStream;

if (typeof MediaStream === 'undefined' && typeof webkitMediaStream !== 'undefined') {
    MediaStream = webkitMediaStream;
}

/*global MediaStream:true */
if (typeof MediaStream !== 'undefined') {
    if (!('getVideoTracks' in MediaStream.prototype)) {
        MediaStream.prototype.getVideoTracks = function() {
            if (!this.getTracks) {
                return [];
            }

            var tracks = [];
            this.getTracks.forEach(function(track) {
                if (track.kind.toString().indexOf('video') !== -1) {
                    tracks.push(track);
                }
            });
            return tracks;
        };

        MediaStream.prototype.getAudioTracks = function() {
            if (!this.getTracks) {
                return [];
            }

            var tracks = [];
            this.getTracks.forEach(function(track) {
                if (track.kind.toString().indexOf('audio') !== -1) {
                    tracks.push(track);
                }
            });
            return tracks;
        };
    }

    if (!('stop' in MediaStream.prototype)) {
        MediaStream.prototype.stop = function() {
            this.getAudioTracks().forEach(function(track) {
                if (!!track.stop) {
                    track.stop();
                }
            });

            this.getVideoTracks().forEach(function(track) {
                if (!!track.stop) {
                    track.stop();
                }
            });
        };
    }
}

if (typeof location !== 'undefined') {
    if (location.href.indexOf('file:') === 0) {
        console.error('Please load this HTML file on HTTP or HTTPS.');
    }
}

// Merge all other data-types except "function"

function mergeProps(mergein, mergeto) {
    for (var t in mergeto) {
        if (typeof mergeto[t] !== 'function') {
            mergein[t] = mergeto[t];
        }
    }
    return mergein;
}

// "dropFirstFrame" has been added by Graham Roth
// https://github.com/gsroth

function dropFirstFrame(arr) {
    arr.shift();
    return arr;
}

/**
 * @param {Blob} file - File or Blob object. This parameter is required.
 * @param {string} fileName - Optional file name e.g. "Recorded-Video.webm"
 * @example
 * invokeSaveAsDialog(blob or file, [optional] fileName);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */
function invokeSaveAsDialog(file, fileName) {
    if (!file) {
        throw 'Blob object is required.';
    }

    if (!file.type) {
        try {
            file.type = 'video/webm';
        } catch (e) {}
    }

    var fileExtension = (file.type || 'video/webm').split('/')[1];

    if (fileName && fileName.indexOf('.') !== -1) {
        var splitted = fileName.split('.');
        fileName = splitted[0];
        fileExtension = splitted[1];
    }

    var fileFullName = (fileName || (Math.round(Math.random() * 9999999999) + 888888888)) + '.' + fileExtension;

    if (typeof navigator.msSaveOrOpenBlob !== 'undefined') {
        return navigator.msSaveOrOpenBlob(file, fileFullName);
    } else if (typeof navigator.msSaveBlob !== 'undefined') {
        return navigator.msSaveBlob(file, fileFullName);
    }

    var hyperlink = document.createElement('a');
    hyperlink.href = URL.createObjectURL(file);
    hyperlink.target = '_blank';
    hyperlink.download = fileFullName;

    if (!!navigator.mozGetUserMedia) {
        hyperlink.onclick = function() {
            (document.body || document.documentElement).removeChild(hyperlink);
        };
        (document.body || document.documentElement).appendChild(hyperlink);
    }

    var evt = new MouseEvent('click', {
        view: window,
        bubbles: true,
        cancelable: true
    });

    hyperlink.dispatchEvent(evt);

    if (!navigator.mozGetUserMedia) {
        URL.revokeObjectURL(hyperlink.href);
    }
}

function bytesToSize(bytes) {
    var k = 1000;
    var sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];
    if (bytes === 0) {
        return '0 Bytes';
    }
    var i = parseInt(Math.floor(Math.log(bytes) / Math.log(k)), 10);
    return (bytes / Math.pow(k, i)).toPrecision(3) + ' ' + sizes[i];
}

// ______________ (used to handle stuff like http://goo.gl/xmE5eg) issue #129
// ObjectStore.js
var ObjectStore = {
    AudioContext: AudioContext
};

function isMediaRecorderCompatible() {
    var isOpera = !!window.opera || navigator.userAgent.indexOf(' OPR/') >= 0;
    var isChrome = !!window.chrome && !isOpera;
    var isFirefox = typeof window.InstallTrigger !== 'undefined';

    if (isFirefox) {
        return true;
    }

    if (!isChrome) {
        return false;
    }

    var nVer = navigator.appVersion;
    var nAgt = navigator.userAgent;
    var fullVersion = '' + parseFloat(navigator.appVersion);
    var majorVersion = parseInt(navigator.appVersion, 10);
    var nameOffset, verOffset, ix;

    if (isChrome) {
        verOffset = nAgt.indexOf('Chrome');
        fullVersion = nAgt.substring(verOffset + 7);
    }

    // trim the fullVersion string at semicolon/space if present
    if ((ix = fullVersion.indexOf(';')) !== -1) {
        fullVersion = fullVersion.substring(0, ix);
    }

    if ((ix = fullVersion.indexOf(' ')) !== -1) {
        fullVersion = fullVersion.substring(0, ix);
    }

    majorVersion = parseInt('' + fullVersion, 10);

    if (isNaN(majorVersion)) {
        fullVersion = '' + parseFloat(navigator.appVersion);
        majorVersion = parseInt(navigator.appVersion, 10);
    }

    return majorVersion >= 49;
}

// ==================
// MediaRecorder.js

/**
 * Implementation of https://dvcs.w3.org/hg/dap/raw-file/default/media-stream-capture/MediaRecorder.html
 * The MediaRecorder accepts a mediaStream as input source passed from UA. When recorder starts,
 * a MediaEncoder will be created and accept the mediaStream as input source.
 * Encoder will get the raw data by track data changes, encode it by selected MIME Type, then store the encoded in EncodedBufferCache object.
 * The encoded data will be extracted on every timeslice passed from Start function call or by RequestData function.
 * Thread model:
 * When the recorder starts, it creates a "Media Encoder" thread to read data from MediaEncoder object and store buffer in EncodedBufferCache object.
 * Also extract the encoded data and create blobs on every timeslice passed from start function or RequestData function called by UA.
 */

function MediaRecorderWrapper(mediaStream) {
    var self = this;

    /**
     * This method records MediaStream.
     * @method
     * @memberof MediaStreamRecorder
     * @example
     * recorder.start(5000);
     */
    this.start = function(timeSlice, __disableLogs) {
        this.timeSlice = timeSlice || 5000;

        if (!self.mimeType) {
            self.mimeType = 'video/webm';
        }

        if (self.mimeType.indexOf('audio') !== -1) {
            if (mediaStream.getVideoTracks().length && mediaStream.getAudioTracks().length) {
                var stream;
                if (!!navigator.mozGetUserMedia) {
                    stream = new MediaStream();
                    stream.addTrack(mediaStream.getAudioTracks()[0]);
                } else {
                    // webkitMediaStream
                    stream = new MediaStream(mediaStream.getAudioTracks());
                }
                mediaStream = stream;
            }
        }

        if (self.mimeType.indexOf('audio') !== -1) {
            self.mimeType = IsChrome ? 'audio/webm' : 'audio/ogg';
        }

        self.dontFireOnDataAvailableEvent = false;

        var recorderHints = {
            mimeType: self.mimeType
        };

        if (!self.disableLogs && !__disableLogs) {
            console.log('Passing following params over MediaRecorder API.', recorderHints);
        }

        if (mediaRecorder) {
            // mandatory to make sure Firefox doesn't fails to record streams 3-4 times without reloading the page.
            mediaRecorder = null;
        }

        if (IsChrome && !isMediaRecorderCompatible()) {
            // to support video-only recording on stable
            recorderHints = 'video/vp8';
        }

        // http://dxr.mozilla.org/mozilla-central/source/content/media/MediaRecorder.cpp
        // https://wiki.mozilla.org/Gecko:MediaRecorder
        // https://dvcs.w3.org/hg/dap/raw-file/default/media-stream-capture/MediaRecorder.html

        // starting a recording session; which will initiate "Reading Thread"
        // "Reading Thread" are used to prevent main-thread blocking scenarios
        try {
            mediaRecorder = new MediaRecorder(mediaStream, recorderHints);
        } catch (e) {
            // if someone passed NON_supported mimeType
            // or if Firefox on Android
            mediaRecorder = new MediaRecorder(mediaStream);
        }

        if ('canRecordMimeType' in mediaRecorder && mediaRecorder.canRecordMimeType(self.mimeType) === false) {
            if (!self.disableLogs) {
                console.warn('MediaRecorder API seems unable to record mimeType:', self.mimeType);
            }
        }

        // i.e. stop recording when <video> is paused by the user; and auto restart recording 
        // when video is resumed. E.g. yourStream.getVideoTracks()[0].muted = true; // it will auto-stop recording.
        if (self.ignoreMutedMedia === true) {
            mediaRecorder.ignoreMutedMedia = true;
        }

        var firedOnDataAvailableOnce = false;

        // Dispatching OnDataAvailable Handler
        mediaRecorder.ondataavailable = function(e) {
            // how to fix FF-corrupt-webm issues?
            // should we leave this?          e.data.size < 26800
            if (!e.data || !e.data.size || e.data.size < 26800 || firedOnDataAvailableOnce) {
                return;
            }

            firedOnDataAvailableOnce = true;

            var blob = self.getNativeBlob ? e.data : new Blob([e.data], {
                type: self.mimeType || 'video/webm'
            });

            self.ondataavailable(blob);

            // self.dontFireOnDataAvailableEvent = true;

            if (!!mediaRecorder && mediaRecorder.state === 'recording') {
                mediaRecorder.stop();
            }
            mediaRecorder = null;

            if (self.dontFireOnDataAvailableEvent) {
                return;
            }

            // record next interval
            self.start(timeSlice, '__disableLogs');
        };

        mediaRecorder.onerror = function(error) {
            if (!self.disableLogs) {
                if (error.name === 'InvalidState') {
                    console.error('The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.');
                } else if (error.name === 'OutOfMemory') {
                    console.error('The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.');
                } else if (error.name === 'IllegalStreamModification') {
                    console.error('A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.');
                } else if (error.name === 'OtherRecordingError') {
                    console.error('Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.');
                } else if (error.name === 'GenericError') {
                    console.error('The UA cannot provide the codec or recording option that has been requested.', error);
                } else {
                    console.error('MediaRecorder Error', error);
                }
            }

            // When the stream is "ended" set recording to 'inactive' 
            // and stop gathering data. Callers should not rely on 
            // exactness of the timeSlice value, especially 
            // if the timeSlice value is small. Callers should 
            // consider timeSlice as a minimum value

            if (!!mediaRecorder && mediaRecorder.state !== 'inactive' && mediaRecorder.state !== 'stopped') {
                mediaRecorder.stop();
            }
        };

        // void start(optional long mTimeSlice)
        // The interval of passing encoded data from EncodedBufferCache to onDataAvailable
        // handler. "mTimeSlice < 0" means Session object does not push encoded data to
        // onDataAvailable, instead, it passive wait the client side pull encoded data
        // by calling requestData API.
        try {
            mediaRecorder.start(3.6e+6);
        } catch (e) {
            mediaRecorder = null;
        }

        setTimeout(function() {
            if (!mediaRecorder) {
                return;
            }

            if (mediaRecorder.state === 'recording') {
                // "stop" method auto invokes "requestData"!
                mediaRecorder.requestData();
                // mediaRecorder.stop();
            }
        }, timeSlice);

        // Start recording. If timeSlice has been provided, mediaRecorder will
        // raise a dataavailable event containing the Blob of collected data on every timeSlice milliseconds.
        // If timeSlice isn't provided, UA should call the RequestData to obtain the Blob data, also set the mTimeSlice to zero.
    };

    /**
     * This method stops recording MediaStream.
     * @param {function} callback - Callback function, that is used to pass recorded blob back to the callee.
     * @method
     * @memberof MediaStreamRecorder
     * @example
     * recorder.stop(function(blob) {
     *     video.src = URL.createObjectURL(blob);
     * });
     */
    this.stop = function(callback) {
        if (!mediaRecorder) {
            return;
        }

        // mediaRecorder.state === 'recording' means that media recorder is associated with "session"
        // mediaRecorder.state === 'stopped' means that media recorder is detached from the "session" ... in this case; "session" will also be deleted.

        if (mediaRecorder.state === 'recording') {
            // "stop" method auto invokes "requestData"!
            mediaRecorder.requestData();

            setTimeout(function() {
                self.dontFireOnDataAvailableEvent = true;
                if (!!mediaRecorder && mediaRecorder.state === 'recording') {
                    mediaRecorder.stop();
                }
                mediaRecorder = null;
                self.onstop();
            }, 2000);
        }
    };

    /**
     * This method pauses the recording process.
     * @method
     * @memberof MediaStreamRecorder
     * @example
     * recorder.pause();
     */
    this.pause = function() {
        if (!mediaRecorder) {
            return;
        }

        if (mediaRecorder.state === 'recording') {
            mediaRecorder.pause();
        }

        this.dontFireOnDataAvailableEvent = true;
    };

    /**
     * The recorded blobs are passed over this event.
     * @event
     * @memberof MediaStreamRecorder
     * @example
     * recorder.ondataavailable = function(data) {};
     */
    this.ondataavailable = function(blob) {
        console.log('recorded-blob', blob);
    };

    /**
     * This method resumes the recording process.
     * @method
     * @memberof MediaStreamRecorder
     * @example
     * recorder.resume();
     */
    this.resume = function() {
        if (this.dontFireOnDataAvailableEvent) {
            this.dontFireOnDataAvailableEvent = false;

            var disableLogs = self.disableLogs;
            self.disableLogs = true;
            this.start(this.timeslice || 5000);
            self.disableLogs = disableLogs;
            return;
        }

        if (!mediaRecorder) {
            return;
        }

        if (mediaRecorder.state === 'paused') {
            mediaRecorder.resume();
        }
    };

    /**
     * This method resets currently recorded data.
     * @method
     * @memberof MediaStreamRecorder
     * @example
     * recorder.clearRecordedData();
     */
    this.clearRecordedData = function() {
        if (!mediaRecorder) {
            return;
        }

        this.pause();

        this.dontFireOnDataAvailableEvent = true;
        this.stop();
    };

    this.onstop = function() {};

    // Reference to "MediaRecorder" object
    var mediaRecorder;

    function isMediaStreamActive() {
        if ('active' in mediaStream) {
            if (!mediaStream.active) {
                return false;
            }
        } else if ('ended' in mediaStream) { // old hack
            if (mediaStream.ended) {
                return false;
            }
        }
        return true;
    }

    // this method checks if media stream is stopped
    // or any track is ended.
    (function looper() {
        if (!mediaRecorder) {
            return;
        }

        if (isMediaStreamActive() === false) {
            self.stop();
            return;
        }

        setTimeout(looper, 1000); // check every second
    })();
}

if (typeof MediaStreamRecorder !== 'undefined') {
    MediaStreamRecorder.MediaRecorderWrapper = MediaRecorderWrapper;
}

// ======================
// StereoAudioRecorder.js

function StereoAudioRecorder(mediaStream) {
    // void start(optional long timeSlice)
    // timestamp to fire "ondataavailable"
    this.start = function(timeSlice) {
        timeSlice = timeSlice || 1000;

        mediaRecorder = new StereoAudioRecorderHelper(mediaStream, this);

        mediaRecorder.record();

        timeout = setInterval(function() {
            mediaRecorder.requestData();
        }, timeSlice);
    };

    this.stop = function() {
        if (mediaRecorder) {
            mediaRecorder.stop();
            clearTimeout(timeout);
            this.onstop();
        }
    };

    this.pause = function() {
        if (!mediaRecorder) {
            return;
        }

        mediaRecorder.pause();
    };

    this.resume = function() {
        if (!mediaRecorder) {
            return;
        }

        mediaRecorder.resume();
    };

    this.ondataavailable = function() {};
    this.onstop = function() {};

    // Reference to "StereoAudioRecorder" object
    var mediaRecorder;
    var timeout;
}

if (typeof MediaStreamRecorder !== 'undefined') {
    MediaStreamRecorder.StereoAudioRecorder = StereoAudioRecorder;
}

// ============================
// StereoAudioRecorderHelper.js

// source code from: http://typedarray.org/wp-content/projects/WebAudioRecorder/script.js

function StereoAudioRecorderHelper(mediaStream, root) {

    // variables    
    var deviceSampleRate = 44100; // range: 22050 to 96000

    if (!ObjectStore.AudioContextConstructor) {
        ObjectStore.AudioContextConstructor = new ObjectStore.AudioContext();
    }

    // check device sample rate
    deviceSampleRate = ObjectStore.AudioContextConstructor.sampleRate;

    var leftchannel = [];
    var rightchannel = [];
    var scriptprocessornode;
    var recording = false;
    var recordingLength = 0;
    var volume;
    var audioInput;
    var sampleRate = root.sampleRate || deviceSampleRate;

    var mimeType = root.mimeType || 'audio/wav';
    var isPCM = mimeType.indexOf('audio/pcm') > -1;

    var context;

    var numChannels = root.audioChannels || 2;

    this.record = function() {
        recording = true;
        // reset the buffers for the new recording
        leftchannel.length = rightchannel.length = 0;
        recordingLength = 0;
    };

    this.requestData = function() {
        if (isPaused) {
            return;
        }

        if (recordingLength === 0) {
            requestDataInvoked = false;
            return;
        }

        requestDataInvoked = true;
        // clone stuff
        var internalLeftChannel = leftchannel.slice(0);
        var internalRightChannel = rightchannel.slice(0);
        var internalRecordingLength = recordingLength;

        // reset the buffers for the new recording
        leftchannel.length = rightchannel.length = [];
        recordingLength = 0;
        requestDataInvoked = false;

        // we flat the left and right channels down
        var leftBuffer = mergeBuffers(internalLeftChannel, internalRecordingLength);

        var interleaved = leftBuffer;

        // we interleave both channels together
        if (numChannels === 2) {
            var rightBuffer = mergeBuffers(internalRightChannel, internalRecordingLength); // bug fixed via #70,#71
            interleaved = interleave(leftBuffer, rightBuffer);
        }

        if (isPCM) {
            // our final binary blob
            var blob = new Blob([convertoFloat32ToInt16(interleaved)], {
                type: 'audio/pcm'
            });

            console.debug('audio recorded blob size:', bytesToSize(blob.size));
            root.ondataavailable(blob);
            return;
        }

        // we create our wav file
        var buffer = new ArrayBuffer(44 + interleaved.length * 2);
        var view = new DataView(buffer);

        // RIFF chunk descriptor
        writeUTFBytes(view, 0, 'RIFF');

        // -8 (via #97)
        view.setUint32(4, 44 + interleaved.length * 2 - 8, true);

        writeUTFBytes(view, 8, 'WAVE');
        // FMT sub-chunk
        writeUTFBytes(view, 12, 'fmt ');
        view.setUint32(16, 16, true);
        view.setUint16(20, 1, true);
        // stereo (2 channels)
        view.setUint16(22, numChannels, true);
        view.setUint32(24, sampleRate, true);
        view.setUint32(28, sampleRate * numChannels * 2, true); // numChannels * 2 (via #71)
        view.setUint16(32, numChannels * 2, true);
        view.setUint16(34, 16, true);
        // data sub-chunk
        writeUTFBytes(view, 36, 'data');
        view.setUint32(40, interleaved.length * 2, true);

        // write the PCM samples
        var lng = interleaved.length;
        var index = 44;
        var volume = 1;
        for (var i = 0; i < lng; i++) {
            view.setInt16(index, interleaved[i] * (0x7FFF * volume), true);
            index += 2;
        }

        // our final binary blob
        var blob = new Blob([view], {
            type: 'audio/wav'
        });

        console.debug('audio recorded blob size:', bytesToSize(blob.size));

        root.ondataavailable(blob);
    };

    this.stop = function() {
        // we stop recording
        recording = false;
        this.requestData();

        audioInput.disconnect();
        this.onstop();
    };

    function interleave(leftChannel, rightChannel) {
        var length = leftChannel.length + rightChannel.length;
        var result = new Float32Array(length);

        var inputIndex = 0;

        for (var index = 0; index < length;) {
            result[index++] = leftChannel[inputIndex];
            result[index++] = rightChannel[inputIndex];
            inputIndex++;
        }
        return result;
    }

    function mergeBuffers(channelBuffer, recordingLength) {
        var result = new Float32Array(recordingLength);
        var offset = 0;
        var lng = channelBuffer.length;
        for (var i = 0; i < lng; i++) {
            var buffer = channelBuffer[i];
            result.set(buffer, offset);
            offset += buffer.length;
        }
        return result;
    }

    function writeUTFBytes(view, offset, string) {
        var lng = string.length;
        for (var i = 0; i < lng; i++) {
            view.setUint8(offset + i, string.charCodeAt(i));
        }
    }

    function convertoFloat32ToInt16(buffer) {
        var l = buffer.length;
        var buf = new Int16Array(l)

        while (l--) {
            buf[l] = buffer[l] * 0xFFFF; //convert to 16 bit
        }
        return buf.buffer
    }

    // creates the audio context
    var context = ObjectStore.AudioContextConstructor;

    // creates a gain node
    ObjectStore.VolumeGainNode = context.createGain();

    var volume = ObjectStore.VolumeGainNode;

    // creates an audio node from the microphone incoming stream
    ObjectStore.AudioInput = context.createMediaStreamSource(mediaStream);

    // creates an audio node from the microphone incoming stream
    var audioInput = ObjectStore.AudioInput;

    // connect the stream to the gain node
    audioInput.connect(volume);

    /* From the spec: This value controls how frequently the audioprocess event is
    dispatched and how many sample-frames need to be processed each call.
    Lower values for buffer size will result in a lower (better) latency.
    Higher values will be necessary to avoid audio breakup and glitches 
    Legal values are 256, 512, 1024, 2048, 4096, 8192, and 16384.*/
    var bufferSize = root.bufferSize || 2048;
    if (root.bufferSize === 0) {
        bufferSize = 0;
    }

    if (context.createJavaScriptNode) {
        scriptprocessornode = context.createJavaScriptNode(bufferSize, numChannels, numChannels);
    } else if (context.createScriptProcessor) {
        scriptprocessornode = context.createScriptProcessor(bufferSize, numChannels, numChannels);
    } else {
        throw 'WebAudio API has no support on this browser.';
    }

    bufferSize = scriptprocessornode.bufferSize;

    console.debug('using audio buffer-size:', bufferSize);

    var requestDataInvoked = false;

    // sometimes "scriptprocessornode" disconnects from he destination-node
    // and there is no exception thrown in this case.
    // and obviously no further "ondataavailable" events will be emitted.
    // below global-scope variable is added to debug such unexpected but "rare" cases.
    window.scriptprocessornode = scriptprocessornode;

    if (numChannels === 1) {
        console.debug('All right-channels are skipped.');
    }

    var isPaused = false;

    this.pause = function() {
        isPaused = true;
    };

    this.resume = function() {
        isPaused = false;
    };

    this.onstop = function() {};

    // http://webaudio.github.io/web-audio-api/#the-scriptprocessornode-interface
    scriptprocessornode.onaudioprocess = function(e) {
        if (!recording || requestDataInvoked || isPaused) {
            return;
        }

        var left = e.inputBuffer.getChannelData(0);
        leftchannel.push(new Float32Array(left));

        if (numChannels === 2) {
            var right = e.inputBuffer.getChannelData(1);
            rightchannel.push(new Float32Array(right));
        }
        recordingLength += bufferSize;
    };

    volume.connect(scriptprocessornode);
    scriptprocessornode.connect(context.destination);
}

if (typeof MediaStreamRecorder !== 'undefined') {
    MediaStreamRecorder.StereoAudioRecorderHelper = StereoAudioRecorderHelper;
}

// ===================
// WhammyRecorder.js

function WhammyRecorder(mediaStream) {
    // void start(optional long timeSlice)
    // timestamp to fire "ondataavailable"
    this.start = function(timeSlice) {
        timeSlice = timeSlice || 1000;

        mediaRecorder = new WhammyRecorderHelper(mediaStream, this);

        for (var prop in this) {
            if (typeof this[prop] !== 'function') {
                mediaRecorder[prop] = this[prop];
            }
        }

        mediaRecorder.record();

        timeout = setInterval(function() {
            mediaRecorder.requestData();
        }, timeSlice);
    };

    this.stop = function() {
        if (mediaRecorder) {
            mediaRecorder.stop();
            clearTimeout(timeout);
            this.onstop();
        }
    };

    this.onstop = function() {};

    this.clearOldRecordedFrames = function() {
        if (mediaRecorder) {
            mediaRecorder.clearOldRecordedFrames();
        }
    };

    this.pause = function() {
        if (!mediaRecorder) {
            return;
        }

        mediaRecorder.pause();
    };

    this.resume = function() {
        if (!mediaRecorder) {
            return;
        }

        mediaRecorder.resume();
    };

    this.ondataavailable = function() {};

    // Reference to "WhammyRecorder" object
    var mediaRecorder;
    var timeout;
}

if (typeof MediaStreamRecorder !== 'undefined') {
    MediaStreamRecorder.WhammyRecorder = WhammyRecorder;
}

// ==========================
// WhammyRecorderHelper.js

function WhammyRecorderHelper(mediaStream, root) {
    this.record = function(timeSlice) {
        if (!this.width) {
            this.width = 320;
        }
        if (!this.height) {
            this.height = 240;
        }

        if (this.video && this.video instanceof HTMLVideoElement) {
            if (!this.width) {
                this.width = video.videoWidth || video.clientWidth || 320;
            }
            if (!this.height) {
                this.height = video.videoHeight || video.clientHeight || 240;
            }
        }

        if (!this.video) {
            this.video = {
                width: this.width,
                height: this.height
            };
        }

        if (!this.canvas || !this.canvas.width || !this.canvas.height) {
            this.canvas = {
                width: this.width,
                height: this.height
            };
        }

        canvas.width = this.canvas.width;
        canvas.height = this.canvas.height;

        // setting defaults
        if (this.video && this.video instanceof HTMLVideoElement) {
            this.isHTMLObject = true;
            video = this.video.cloneNode();
        } else {
            video = document.createElement('video');
            video.src = URL.createObjectURL(mediaStream);

            video.width = this.video.width;
            video.height = this.video.height;
        }

        video.muted = true;
        video.play();

        lastTime = new Date().getTime();
        whammy = new Whammy.Video(root.speed, root.quality);

        console.log('canvas resolutions', canvas.width, '*', canvas.height);
        console.log('video width/height', video.width || canvas.width, '*', video.height || canvas.height);

        drawFrames();
    };

    this.clearOldRecordedFrames = function() {
        whammy.frames = [];
    };

    var requestDataInvoked = false;
    this.requestData = function() {
        if (isPaused) {
            return;
        }

        if (!whammy.frames.length) {
            requestDataInvoked = false;
            return;
        }

        requestDataInvoked = true;
        // clone stuff
        var internalFrames = whammy.frames.slice(0);

        // reset the frames for the new recording

        whammy.frames = dropBlackFrames(internalFrames, -1);

        whammy.compile(function(whammyBlob) {
            root.ondataavailable(whammyBlob);
            console.debug('video recorded blob size:', bytesToSize(whammyBlob.size));
        });

        whammy.frames = [];

        requestDataInvoked = false;
    };

    var isOnStartedDrawingNonBlankFramesInvoked = false;

    function drawFrames() {
        if (isPaused) {
            lastTime = new Date().getTime();
            setTimeout(drawFrames, 500);
            return;
        }

        if (isStopDrawing) {
            return;
        }

        if (requestDataInvoked) {
            return setTimeout(drawFrames, 100);
        }

        var duration = new Date().getTime() - lastTime;
        if (!duration) {
            return drawFrames();
        }

        // via webrtc-experiment#206, by Jack i.e. @Seymourr
        lastTime = new Date().getTime();

        if (!self.isHTMLObject && video.paused) {
            video.play(); // Android
        }

        context.drawImage(video, 0, 0, canvas.width, canvas.height);

        if (!isStopDrawing) {
            whammy.frames.push({
                duration: duration,
                image: canvas.toDataURL('image/webp')
            });
        }

        if (!isOnStartedDrawingNonBlankFramesInvoked && !isBlankFrame(whammy.frames[whammy.frames.length - 1])) {
            isOnStartedDrawingNonBlankFramesInvoked = true;
            root.onStartedDrawingNonBlankFrames();
        }

        setTimeout(drawFrames, 10);
    }

    var isStopDrawing = false;

    this.stop = function() {
        isStopDrawing = true;
        this.requestData();
        this.onstop();
    };

    var canvas = document.createElement('canvas');
    var context = canvas.getContext('2d');

    var video;
    var lastTime;
    var whammy;

    var self = this;

    function isBlankFrame(frame, _pixTolerance, _frameTolerance) {
        var localCanvas = document.createElement('canvas');
        localCanvas.width = canvas.width;
        localCanvas.height = canvas.height;
        var context2d = localCanvas.getContext('2d');

        var sampleColor = {
            r: 0,
            g: 0,
            b: 0
        };
        var maxColorDifference = Math.sqrt(
            Math.pow(255, 2) +
            Math.pow(255, 2) +
            Math.pow(255, 2)
        );
        var pixTolerance = _pixTolerance && _pixTolerance >= 0 && _pixTolerance <= 1 ? _pixTolerance : 0;
        var frameTolerance = _frameTolerance && _frameTolerance >= 0 && _frameTolerance <= 1 ? _frameTolerance : 0;

        var matchPixCount, endPixCheck, maxPixCount;

        var image = new Image();
        image.src = frame.image;
        context2d.drawImage(image, 0, 0, canvas.width, canvas.height);
        var imageData = context2d.getImageData(0, 0, canvas.width, canvas.height);
        matchPixCount = 0;
        endPixCheck = imageData.data.length;
        maxPixCount = imageData.data.length / 4;

        for (var pix = 0; pix < endPixCheck; pix += 4) {
            var currentColor = {
                r: imageData.data[pix],
                g: imageData.data[pix + 1],
                b: imageData.data[pix + 2]
            };
            var colorDifference = Math.sqrt(
                Math.pow(currentColor.r - sampleColor.r, 2) +
                Math.pow(currentColor.g - sampleColor.g, 2) +
                Math.pow(currentColor.b - sampleColor.b, 2)
            );
            // difference in color it is difference in color vectors (r1,g1,b1) <=> (r2,g2,b2)
            if (colorDifference <= maxColorDifference * pixTolerance) {
                matchPixCount++;
            }
        }

        if (maxPixCount - matchPixCount <= maxPixCount * frameTolerance) {
            return false;
        } else {
            return true;
        }
    }

    function dropBlackFrames(_frames, _framesToCheck, _pixTolerance, _frameTolerance) {
        var localCanvas = document.createElement('canvas');
        localCanvas.width = canvas.width;
        localCanvas.height = canvas.height;
        var context2d = localCanvas.getContext('2d');
        var resultFrames = [];

        var checkUntilNotBlack = _framesToCheck === -1;
        var endCheckFrame = (_framesToCheck && _framesToCheck > 0 && _framesToCheck <= _frames.length) ?
            _framesToCheck : _frames.length;
        var sampleColor = {
            r: 0,
            g: 0,
            b: 0
        };
        var maxColorDifference = Math.sqrt(
            Math.pow(255, 2) +
            Math.pow(255, 2) +
            Math.pow(255, 2)
        );
        var pixTolerance = _pixTolerance && _pixTolerance >= 0 && _pixTolerance <= 1 ? _pixTolerance : 0;
        var frameTolerance = _frameTolerance && _frameTolerance >= 0 && _frameTolerance <= 1 ? _frameTolerance : 0;
        var doNotCheckNext = false;

        for (var f = 0; f < endCheckFrame; f++) {
            var matchPixCount, endPixCheck, maxPixCount;

            if (!doNotCheckNext) {
                var image = new Image();
                image.src = _frames[f].image;
                context2d.drawImage(image, 0, 0, canvas.width, canvas.height);
                var imageData = context2d.getImageData(0, 0, canvas.width, canvas.height);
                matchPixCount = 0;
                endPixCheck = imageData.data.length;
                maxPixCount = imageData.data.length / 4;

                for (var pix = 0; pix < endPixCheck; pix += 4) {
                    var currentColor = {
                        r: imageData.data[pix],
                        g: imageData.data[pix + 1],
                        b: imageData.data[pix + 2]
                    };
                    var colorDifference = Math.sqrt(
                        Math.pow(currentColor.r - sampleColor.r, 2) +
                        Math.pow(currentColor.g - sampleColor.g, 2) +
                        Math.pow(currentColor.b - sampleColor.b, 2)
                    );
                    // difference in color it is difference in color vectors (r1,g1,b1) <=> (r2,g2,b2)
                    if (colorDifference <= maxColorDifference * pixTolerance) {
                        matchPixCount++;
                    }
                }
            }

            if (!doNotCheckNext && maxPixCount - matchPixCount <= maxPixCount * frameTolerance) {
                // console.log('removed black frame : ' + f + ' ; frame duration ' + _frames[f].duration);
            } else {
                // console.log('frame is passed : ' + f);
                if (checkUntilNotBlack) {
                    doNotCheckNext = true;
                }
                resultFrames.push(_frames[f]);
            }
        }

        resultFrames = resultFrames.concat(_frames.slice(endCheckFrame));

        if (resultFrames.length <= 0) {
            // at least one last frame should be available for next manipulation
            // if total duration of all frames will be < 1000 than ffmpeg doesn't work well...
            resultFrames.push(_frames[_frames.length - 1]);
        }

        return resultFrames;
    }

    var isPaused = false;

    this.pause = function() {
        isPaused = true;
    };

    this.resume = function() {
        isPaused = false;
    };

    this.onstop = function() {};
}

if (typeof MediaStreamRecorder !== 'undefined') {
    MediaStreamRecorder.WhammyRecorderHelper = WhammyRecorderHelper;
}

// --------------
// GifRecorder.js

function GifRecorder(mediaStream) {
    if (typeof GIFEncoder === 'undefined') {
        throw 'Please link: https://cdn.webrtc-experiment.com/gif-recorder.js';
    }

    // void start(optional long timeSlice)
    // timestamp to fire "ondataavailable"
    this.start = function(timeSlice) {
        timeSlice = timeSlice || 1000;

        var imageWidth = this.videoWidth || 320;
        var imageHeight = this.videoHeight || 240;

        canvas.width = video.width = imageWidth;
        canvas.height = video.height = imageHeight;

        // external library to record as GIF images
        gifEncoder = new GIFEncoder();

        // void setRepeat(int iter)
        // Sets the number of times the set of GIF frames should be played.
        // Default is 1; 0 means play indefinitely.
        gifEncoder.setRepeat(0);

        // void setFrameRate(Number fps)
        // Sets frame rate in frames per second.
        // Equivalent to setDelay(1000/fps).
        // Using "setDelay" instead of "setFrameRate"
        gifEncoder.setDelay(this.frameRate || this.speed || 200);

        // void setQuality(int quality)
        // Sets quality of color quantization (conversion of images to the
        // maximum 256 colors allowed by the GIF specification).
        // Lower values (minimum = 1) produce better colors,
        // but slow processing significantly. 10 is the default,
        // and produces good color mapping at reasonable speeds.
        // Values greater than 20 do not yield significant improvements in speed.
        gifEncoder.setQuality(this.quality || 1);

        // Boolean start()
        // This writes the GIF Header and returns false if it fails.
        gifEncoder.start();

        startTime = Date.now();

        function drawVideoFrame(time) {
            if (isPaused) {
                setTimeout(drawVideoFrame, 500, time);
                return;
            }

            lastAnimationFrame = requestAnimationFrame(drawVideoFrame);

            if (typeof lastFrameTime === undefined) {
                lastFrameTime = time;
            }

            // ~10 fps
            if (time - lastFrameTime < 90) {
                return;
            }

            if (video.paused) {
                video.play(); // Android
            }

            context.drawImage(video, 0, 0, imageWidth, imageHeight);

            gifEncoder.addFrame(context);

            // console.log('Recording...' + Math.round((Date.now() - startTime) / 1000) + 's');
            // console.log("fps: ", 1000 / (time - lastFrameTime));

            lastFrameTime = time;
        }

        lastAnimationFrame = requestAnimationFrame(drawVideoFrame);

        timeout = setTimeout(doneRecording, timeSlice);
    };

    function doneRecording() {
        endTime = Date.now();

        var gifBlob = new Blob([new Uint8Array(gifEncoder.stream().bin)], {
            type: 'image/gif'
        });
        self.ondataavailable(gifBlob);

        // todo: find a way to clear old recorded blobs
        gifEncoder.stream().bin = [];
    }

    this.stop = function() {
        if (lastAnimationFrame) {
            cancelAnimationFrame(lastAnimationFrame);
            clearTimeout(timeout);
            doneRecording();
            this.onstop();
        }
    };

    this.onstop = function() {};

    var isPaused = false;

    this.pause = function() {
        isPaused = true;
    };

    this.resume = function() {
        isPaused = false;
    };

    this.ondataavailable = function() {};
    this.onstop = function() {};

    // Reference to itself
    var self = this;

    var canvas = document.createElement('canvas');
    var context = canvas.getContext('2d');

    var video = document.createElement('video');
    video.muted = true;
    video.autoplay = true;
    video.src = URL.createObjectURL(mediaStream);
    video.play();

    var lastAnimationFrame = null;
    var startTime, endTime, lastFrameTime;

    var gifEncoder;
    var timeout;
}

if (typeof MediaStreamRecorder !== 'undefined') {
    MediaStreamRecorder.GifRecorder = GifRecorder;
}

// https://github.com/antimatter15/whammy/blob/master/LICENSE
// _________
// Whammy.js

// todo: Firefox now supports webp for webm containers!
// their MediaRecorder implementation works well!
// should we provide an option to record via Whammy.js or MediaRecorder API is a better solution?

/**
 * Whammy is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It is written by {@link https://github.com/antimatter15|antimatter15}
 * @summary A real time javascript webm encoder based on a canvas hack.
 * @typedef Whammy
 * @class
 * @example
 * var recorder = new Whammy().Video(15);
 * recorder.add(context || canvas || dataURL);
 * var output = recorder.compile();
 */

var Whammy = (function() {
    // a more abstract-ish API

    function WhammyVideo(duration, quality) {
        this.frames = [];
        if (!duration) {
            duration = 1;
        }
        this.duration = 1000 / duration;
        this.quality = quality || 0.8;
    }

    /**
     * Pass Canvas or Context or image/webp(string) to {@link Whammy} encoder.
     * @method
     * @memberof Whammy
     * @example
     * recorder = new Whammy().Video(0.8, 100);
     * recorder.add(canvas || context || 'image/webp');
     * @param {string} frame - Canvas || Context || image/webp
     * @param {number} duration - Stick a duration (in milliseconds)
     */
    WhammyVideo.prototype.add = function(frame, duration) {
        if ('canvas' in frame) { //CanvasRenderingContext2D
            frame = frame.canvas;
        }

        if ('toDataURL' in frame) {
            frame = frame.toDataURL('image/webp', this.quality);
        }

        if (!(/^data:image\/webp;base64,/ig).test(frame)) {
            throw 'Input must be formatted properly as a base64 encoded DataURI of type image/webp';
        }
        this.frames.push({
            image: frame,
            duration: duration || this.duration
        });
    };

    function processInWebWorker(_function) {
        var blob = URL.createObjectURL(new Blob([_function.toString(),
            'this.onmessage =  function (e) {' + _function.name + '(e.data);}'
        ], {
            type: 'application/javascript'
        }));

        var worker = new Worker(blob);
        URL.revokeObjectURL(blob);
        return worker;
    }

    function whammyInWebWorker(frames) {
        function ArrayToWebM(frames) {
            var info = checkFrames(frames);
            if (!info) {
                return [];
            }

            var clusterMaxDuration = 30000;

            var EBML = [{
                'id': 0x1a45dfa3, // EBML
                'data': [{
                    'data': 1,
                    'id': 0x4286 // EBMLVersion
                }, {
                    'data': 1,
                    'id': 0x42f7 // EBMLReadVersion
                }, {
                    'data': 4,
                    'id': 0x42f2 // EBMLMaxIDLength
                }, {
                    'data': 8,
                    'id': 0x42f3 // EBMLMaxSizeLength
                }, {
                    'data': 'webm',
                    'id': 0x4282 // DocType
                }, {
                    'data': 2,
                    'id': 0x4287 // DocTypeVersion
                }, {
                    'data': 2,
                    'id': 0x4285 // DocTypeReadVersion
                }]
            }, {
                'id': 0x18538067, // Segment
                'data': [{
                    'id': 0x1549a966, // Info
                    'data': [{
                        'data': 1e6, //do things in millisecs (num of nanosecs for duration scale)
                        'id': 0x2ad7b1 // TimecodeScale
                    }, {
                        'data': 'whammy',
                        'id': 0x4d80 // MuxingApp
                    }, {
                        'data': 'whammy',
                        'id': 0x5741 // WritingApp
                    }, {
                        'data': doubleToString(info.duration),
                        'id': 0x4489 // Duration
                    }]
                }, {
                    'id': 0x1654ae6b, // Tracks
                    'data': [{
                        'id': 0xae, // TrackEntry
                        'data': [{
                            'data': 1,
                            'id': 0xd7 // TrackNumber
                        }, {
                            'data': 1,
                            'id': 0x73c5 // TrackUID
                        }, {
                            'data': 0,
                            'id': 0x9c // FlagLacing
                        }, {
                            'data': 'und',
                            'id': 0x22b59c // Language
                        }, {
                            'data': 'V_VP8',
                            'id': 0x86 // CodecID
                        }, {
                            'data': 'VP8',
                            'id': 0x258688 // CodecName
                        }, {
                            'data': 1,
                            'id': 0x83 // TrackType
                        }, {
                            'id': 0xe0, // Video
                            'data': [{
                                'data': info.width,
                                'id': 0xb0 // PixelWidth
                            }, {
                                'data': info.height,
                                'id': 0xba // PixelHeight
                            }]
                        }]
                    }]
                }]
            }];

            //Generate clusters (max duration)
            var frameNumber = 0;
            var clusterTimecode = 0;
            while (frameNumber < frames.length) {

                var clusterFrames = [];
                var clusterDuration = 0;
                do {
                    clusterFrames.push(frames[frameNumber]);
                    clusterDuration += frames[frameNumber].duration;
                    frameNumber++;
                } while (frameNumber < frames.length && clusterDuration < clusterMaxDuration);

                var clusterCounter = 0;
                var cluster = {
                    'id': 0x1f43b675, // Cluster
                    'data': getClusterData(clusterTimecode, clusterCounter, clusterFrames)
                }; //Add cluster to segment
                EBML[1].data.push(cluster);
                clusterTimecode += clusterDuration;
            }

            return generateEBML(EBML);
        }

        function getClusterData(clusterTimecode, clusterCounter, clusterFrames) {
            return [{
                'data': clusterTimecode,
                'id': 0xe7 // Timecode
            }].concat(clusterFrames.map(function(webp) {
                var block = makeSimpleBlock({
                    discardable: 0,
                    frame: webp.data.slice(4),
                    invisible: 0,
                    keyframe: 1,
                    lacing: 0,
                    trackNum: 1,
                    timecode: Math.round(clusterCounter)
                });
                clusterCounter += webp.duration;
                return {
                    data: block,
                    id: 0xa3
                };
            }));
        }

        // sums the lengths of all the frames and gets the duration

        function checkFrames(frames) {
            if (!frames[0]) {
                postMessage({
                    error: 'Something went wrong. Maybe WebP format is not supported in the current browser.'
                });
                return;
            }

            var width = frames[0].width,
                height = frames[0].height,
                duration = frames[0].duration;

            for (var i = 1; i < frames.length; i++) {
                duration += frames[i].duration;
            }
            return {
                duration: duration,
                width: width,
                height: height
            };
        }

        function numToBuffer(num) {
            var parts = [];
            while (num > 0) {
                parts.push(num & 0xff);
                num = num >> 8;
            }
            return new Uint8Array(parts.reverse());
        }

        function strToBuffer(str) {
            return new Uint8Array(str.split('').map(function(e) {
                return e.charCodeAt(0);
            }));
        }

        function bitsToBuffer(bits) {
            var data = [];
            var pad = (bits.length % 8) ? (new Array(1 + 8 - (bits.length % 8))).join('0') : '';
            bits = pad + bits;
            for (var i = 0; i < bits.length; i += 8) {
                data.push(parseInt(bits.substr(i, 8), 2));
            }
            return new Uint8Array(data);
        }

        function generateEBML(json) {
            var ebml = [];
            for (var i = 0; i < json.length; i++) {
                var data = json[i].data;

                if (typeof data === 'object') {
                    data = generateEBML(data);
                }

                if (typeof data === 'number') {
                    data = bitsToBuffer(data.toString(2));
                }

                if (typeof data === 'string') {
                    data = strToBuffer(data);
                }

                var len = data.size || data.byteLength || data.length;
                var zeroes = Math.ceil(Math.ceil(Math.log(len) / Math.log(2)) / 8);
                var sizeToString = len.toString(2);
                var padded = (new Array((zeroes * 7 + 7 + 1) - sizeToString.length)).join('0') + sizeToString;
                var size = (new Array(zeroes)).join('0') + '1' + padded;

                ebml.push(numToBuffer(json[i].id));
                ebml.push(bitsToBuffer(size));
                ebml.push(data);
            }

            return new Blob(ebml, {
                type: 'video/webm'
            });
        }

        function toBinStrOld(bits) {
            var data = '';
            var pad = (bits.length % 8) ? (new Array(1 + 8 - (bits.length % 8))).join('0') : '';
            bits = pad + bits;
            for (var i = 0; i < bits.length; i += 8) {
                data += String.fromCharCode(parseInt(bits.substr(i, 8), 2));
            }
            return data;
        }

        function makeSimpleBlock(data) {
            var flags = 0;

            if (data.keyframe) {
                flags |= 128;
            }

            if (data.invisible) {
                flags |= 8;
            }

            if (data.lacing) {
                flags |= (data.lacing << 1);
            }

            if (data.discardable) {
                flags |= 1;
            }

            if (data.trackNum > 127) {
                throw 'TrackNumber > 127 not supported';
            }

            var out = [data.trackNum | 0x80, data.timecode >> 8, data.timecode & 0xff, flags].map(function(e) {
                return String.fromCharCode(e);
            }).join('') + data.frame;

            return out;
        }

        function parseWebP(riff) {
            var VP8 = riff.RIFF[0].WEBP[0];

            var frameStart = VP8.indexOf('\x9d\x01\x2a'); // A VP8 keyframe starts with the 0x9d012a header
            for (var i = 0, c = []; i < 4; i++) {
                c[i] = VP8.charCodeAt(frameStart + 3 + i);
            }

            var width, height, tmp;

            //the code below is literally copied verbatim from the bitstream spec
            tmp = (c[1] << 8) | c[0];
            width = tmp & 0x3FFF;
            tmp = (c[3] << 8) | c[2];
            height = tmp & 0x3FFF;
            return {
                width: width,
                height: height,
                data: VP8,
                riff: riff
            };
        }

        function getStrLength(string, offset) {
            return parseInt(string.substr(offset + 4, 4).split('').map(function(i) {
                var unpadded = i.charCodeAt(0).toString(2);
                return (new Array(8 - unpadded.length + 1)).join('0') + unpadded;
            }).join(''), 2);
        }

        function parseRIFF(string) {
            var offset = 0;
            var chunks = {};

            while (offset < string.length) {
                var id = string.substr(offset, 4);
                var len = getStrLength(string, offset);
                var data = string.substr(offset + 4 + 4, len);
                offset += 4 + 4 + len;
                chunks[id] = chunks[id] || [];

                if (id === 'RIFF' || id === 'LIST') {
                    chunks[id].push(parseRIFF(data));
                } else {
                    chunks[id].push(data);
                }
            }
            return chunks;
        }

        function doubleToString(num) {
            return [].slice.call(
                new Uint8Array((new Float64Array([num])).buffer), 0).map(function(e) {
                return String.fromCharCode(e);
            }).reverse().join('');
        }

        var webm = new ArrayToWebM(frames.map(function(frame) {
            var webp = parseWebP(parseRIFF(atob(frame.image.slice(23))));
            webp.duration = frame.duration;
            return webp;
        }));

        postMessage(webm);
    }

    /**
     * Encodes frames in WebM container. It uses WebWorkinvoke to invoke 'ArrayToWebM' method.
     * @param {function} callback - Callback function, that is used to pass recorded blob back to the callee.
     * @method
     * @memberof Whammy
     * @example
     * recorder = new Whammy().Video(0.8, 100);
     * recorder.compile(function(blob) {
     *    // blob.size - blob.type
     * });
     */
    WhammyVideo.prototype.compile = function(callback) {
        var webWorker = processInWebWorker(whammyInWebWorker);

        webWorker.onmessage = function(event) {
            if (event.data.error) {
                console.error(event.data.error);
                return;
            }
            callback(event.data);
        };

        webWorker.postMessage(this.frames);
    };

    return {
        /**
         * A more abstract-ish API.
         * @method
         * @memberof Whammy
         * @example
         * recorder = new Whammy().Video(0.8, 100);
         * @param {?number} speed - 0.8
         * @param {?number} quality - 100
         */
        Video: WhammyVideo
    };
})();

if (typeof MediaStreamRecorder !== 'undefined') {
    MediaStreamRecorder.Whammy = Whammy;
}

// Last time updated at Nov 18, 2014, 08:32:23

// Latest file can be found here: https://cdn.webrtc-experiment.com/ConcatenateBlobs.js

// Muaz Khan    - www.MuazKhan.com
// MIT License  - www.WebRTC-Experiment.com/licence
// Source Code  - https://github.com/muaz-khan/ConcatenateBlobs
// Demo         - https://www.WebRTC-Experiment.com/ConcatenateBlobs/

// ___________________
// ConcatenateBlobs.js

// Simply pass array of blobs.
// This javascript library will concatenate all blobs in single "Blob" object.

(function() {
    window.ConcatenateBlobs = function(blobs, type, callback) {
        var buffers = [];

        var index = 0;

        function readAsArrayBuffer() {
            if (!blobs[index]) {
                return concatenateBuffers();
            }
            var reader = new FileReader();
            reader.onload = function(event) {
                buffers.push(event.target.result);
                index++;
                readAsArrayBuffer();
            };
            reader.readAsArrayBuffer(blobs[index]);
        }

        readAsArrayBuffer();

        function concatenateBuffers() {
            var byteLength = 0;
            buffers.forEach(function(buffer) {
                byteLength += buffer.byteLength;
            });

            var tmp = new Uint16Array(byteLength);
            var lastOffset = 0;
            buffers.forEach(function(buffer) {
                // BYTES_PER_ELEMENT == 2 for Uint16Array
                var reusableByteLength = buffer.byteLength;
                if (reusableByteLength % 2 != 0) {
                    buffer = buffer.slice(0, reusableByteLength - 1)
                }
                tmp.set(new Uint16Array(buffer), lastOffset);
                lastOffset += reusableByteLength;
            });

            var blob = new Blob([tmp.buffer], {
                type: type
            });

            callback(blob);
        }
    };
})();

// https://github.com/streamproc/MediaStreamRecorder/issues/42
if (typeof module !== 'undefined' /* && !!module.exports*/ ) {
    module.exports = MediaStreamRecorder;
}

if (typeof define === 'function' && define.amd) {
    define('MediaStreamRecorder', [], function() {
        return MediaStreamRecorder;
    });
}
;
define("mediaStreamRecorder", (function (global) {
    return function () {
        var ret, fn;
        return ret || global.mediaStreamRecorder;
    };
}(this)));

(function(window) {
  // internal: same as jQuery.extend(true, args...)
  var extend = function() {
    var target = arguments[0],
        sources = [].slice.call(arguments, 1);
    for (var i = 0; i < sources.length; ++i) {
      var src = sources[i];
      for (key in src) {
        var val = src[key];
        target[key] = typeof val === "object"
          ? extend(typeof target[key] === "object" ? target[key] : {}, val)
          : val;
      }
    }
    return target;
  };

  var WORKER_FILE = {
    wav: "WebAudioRecorderWav.js",
    ogg: "WebAudioRecorderOgg.js",
    mp3: "WebAudioRecorderMp3.js"
  };

  // default configs
  var CONFIGS = {
    workerDir: "/",     // worker scripts dir (end with /)
    numChannels: 2,     // number of channels
    encoding: "wav",    // encoding (can be changed at runtime)

    // runtime options
    options: {
      timeLimit: 300,           // recording time limit (sec)
      encodeAfterRecord: false, // process encoding after recording
      progressInterval: 1000,   // encoding progress report interval (millisec)
      bufferSize: undefined,    // buffer size (use browser default)

      // encoding-specific options
      wav: {
        mimeType: "audio/wav"
      },
      ogg: {
        mimeType: "audio/ogg",
        quality: 0.5            // (VBR only): quality = [-0.1 .. 1]
      },
      mp3: {
        mimeType: "audio/mpeg",
        bitRate: 160            // (CBR only): bit rate = [64 .. 320]
      }
    }
  };

  // constructor
  var WebAudioRecorder = function(sourceNode, configs) {
    extend(this, CONFIGS, configs || {});
    this.context = sourceNode.context;
    if (this.context.createScriptProcessor == null)
      this.context.createScriptProcessor = this.context.createJavaScriptNode;
    this.input = this.context.createGain();
    sourceNode.connect(this.input);
    this.buffer = [];
    this.initWorker();
  };

  // instance methods
  extend(WebAudioRecorder.prototype, {
    isRecording: function() { return this.processor != null; },

    setEncoding: function(encoding) {
      if (this.isRecording())
        this.error("setEncoding: cannot set encoding during recording");
      else if (this.encoding !== encoding) {
        this.encoding = encoding;
        this.initWorker();
      }
    },

    setOptions: function(options) {
      if (this.isRecording())
        this.error("setOptions: cannot set options during recording");
      else {
        extend(this.options, options);
        this.worker.postMessage({ command: "options", options: this.options });
      }
    },

    startRecording: function() {
      if (this.isRecording())
        this.error("startRecording: previous recording is running");
      else {
        var numChannels = this.numChannels,
            buffer = this.buffer,
            worker = this.worker;
        this.processor = this.context.createScriptProcessor(
                                this.options.bufferSize,
                                this.numChannels, this.numChannels);
        this.input.connect(this.processor);
        this.processor.connect(this.context.destination);
        this.processor.onaudioprocess = function(event) {
          for (var ch = 0; ch < numChannels; ++ch)
            buffer[ch] = event.inputBuffer.getChannelData(ch);
          worker.postMessage({ command: "record", buffer: buffer });
        };
        this.worker.postMessage({
          command: "start",
          bufferSize: this.processor.bufferSize
        });
        this.startTime = Date.now();
      }
    },

    recordingTime: function() {
      return this.isRecording() ? (Date.now() - this.startTime) * 0.001 : null;
    },

    cancelRecording: function() {
      if (this.isRecording()) {
        this.input.disconnect();
        this.processor.disconnect();
        delete this.processor;
        this.worker.postMessage({ command: "cancel" });
      } else
        this.error("cancelRecording: no recording is running");
    },

    finishRecording: function() {
      if (this.isRecording()) {
        this.input.disconnect();
        this.processor.disconnect();
        delete this.processor;
        this.worker.postMessage({ command: "finish" });
      } else
        this.error("finishRecording: no recording is running");
    },

    cancelEncoding: function() {
      if (this.options.encodeAfterRecord)
        if (this.isRecording())
          this.error("cancelEncoding: recording is not finished");
        else {
          this.onEncodingCanceled(this);
          this.initWorker();
        }
      else
        this.error("cancelEncoding: invalid method call");
    },

    initWorker: function() {
      if (this.worker != null)
        this.worker.terminate();
      this.onEncoderLoading(this, this.encoding);
      this.worker = new Worker(this.workerDir + WORKER_FILE[this.encoding]);
      var _this = this;
      this.worker.onmessage = function(event) {
        var data = event.data;
        switch (data.command) {
          case "loaded":
            _this.onEncoderLoaded(_this, _this.encoding);
            break;
          case "timeout":
            _this.onTimeout(_this);
            break;
          case "progress":
            _this.onEncodingProgress(_this, data.progress);
            break;
          case "complete":
            _this.onComplete(_this, data.blob);
            break;
          case "error":
            _this.error(data.message);
        }
      };
      this.worker.postMessage({
        command: "init",
        config: {
          sampleRate: this.context.sampleRate,
          numChannels: this.numChannels
        },
        options: this.options
      });
    },

    error: function(message) {
      this.onError(this, "WebAudioRecorder.js:" + message);
    },

    // event handlers
    onEncoderLoading: function(recorder, encoding) {},
    onEncoderLoaded: function(recorder, encoding) {},
    onTimeout: function(recorder) { recorder.finishRecording(); },
    onEncodingProgress: function (recorder, progress) {},
    onEncodingCanceled: function(recorder) {},
    onComplete: function(recorder, blob) {
      recorder.onError(recorder, "WebAudioRecorder.js: You must override .onComplete event");
    },
    onError: function(recorder, message) { console.log(message); }
  });

  window.WebAudioRecorder = WebAudioRecorder;
  return WebAudioRecorder;
})(window);

define("WebAudioRecorder", (function (global) {
    return function () {
        var ret, fn;
        return ret || global.WebAudioRecorder;
    };
}(this)));

! function(e, t) {
    "object" == typeof exports && "object" == typeof module ? module.exports = t() : "function" == typeof define && define.amd ? define('Recorder',[], t) : "object" == typeof exports ? exports.Recorder = t() : e.Recorder = t()
}(this, function() {
    return function(e) {
        function t(o) {
            if (n[o]) return n[o].exports;
            var i = n[o] = {
                i: o,
                l: !1,
                exports: {}
            };
            return e[o].call(i.exports, i, i.exports, t), i.l = !0, i.exports
        }
        var n = {};
        return t.m = e, t.c = n, t.d = function(e, n, o) {
            t.o(e, n) || Object.defineProperty(e, n, {
                configurable: !1,
                enumerable: !0,
                get: o
            })
        }, t.n = function(e) {
            var n = e && e.__esModule ? function() {
                return e.default
            } : function() {
                return e
            };
            return t.d(n, "a", n), n
        }, t.o = function(e, t) {
            return Object.prototype.hasOwnProperty.call(e, t)
        }, t.p = "", t(t.s = 0)
    }([function(e, t, n) {
        "use strict";
        (function(t) {

            //@MZ< 
        		var flagClearedStream = false;
        	//@MZ>

            var n = function(e) {
                var o = this,
                    i = t.AudioContext || t.webkitAudioContext;


                if (!n.isRecordingSupported()) throw new Error("Recording is not supported in this browser");
                this.state = "inactive", this.eventTarget = t.document.createDocumentFragment(), this.audioContext = new i, this.monitorNode = this.audioContext.createGain(), this.config = Object.assign({
                    bufferLength: 4096,
                    command: "init",
                    encoderApplication: 2049,
                    encoderFrameSize: 20,
                    encoderPath: "encoderWorker.min.js",
                    encoderSampleRate: 48e3,
                    leaveStreamOpen: !1,
                    maxBuffersPerPage: 40,
                    monitorGain: 0,
                    numberOfChannels: 1,
                    originalSampleRate: this.audioContext.sampleRate,
                    resampleQuality: 3,
                    mediaTrackConstraints: !0,
                    streamPages: !1,
                    wavBitDepth: 16,
                    wavSampleRate: this.audioContext.sampleRate
                }, e), this.setMonitorGain(this.config.monitorGain), this.scriptProcessorNode = this.audioContext.createScriptProcessor(this.config.bufferLength, this.config.numberOfChannels, this.config.numberOfChannels), this.scriptProcessorNode.onaudioprocess = function(e) {
                    o.encodeBuffers(e.inputBuffer)
                }

                //@MZ< 
	                var functionOnEventStart,
	                	functionOnEventResume,
	                	functionOnEventStop,
	                	functionOnEventDataAvailable,
	                	functionOnEventSave;


	                this.eventTarget.addEventListener('start', () => {
		            	if(typeof this.functionOnEventStart == 'function'){
		            		this.functionOnEventStart();
		            	}
					});

					this.eventTarget.addEventListener('resume', () => {
		            	if(typeof this.functionOnEventResume == 'function'){
		            		this.functionOnEventResume();
		            	}
					});


					this.eventTarget.addEventListener('stop', () => {
		            	if(typeof this.functionOnEventStop == 'function'){
		            		this.functionOnEventStop();
		            	}
					});

					this.eventTarget.addEventListener('dataAvailable', (e) => {
		            	if(typeof this.functionOnEventDataAvailable == 'function'){
		            		this.functionOnEventDataAvailable(e);
		            	}
		            	if( !flagClearedStream && typeof this.functionOnEventSave == 'function') {
		            		this.functionOnEventSave(e)
		            	}
					});
	            //@MZ>

            };


            

            n.isRecordingSupported = function() {
                var e = t.AudioContext || t.webkitAudioContext,
                    n = t.navigator && (t.navigator.getUserMedia || t.navigator.mediaDevices && t.navigator.mediaDevices.getUserMedia);
                return e && n
            }, 
            n.prototype.addEventListener = function(e, t, n) {
                this.eventTarget.addEventListener(e, t, n)
            },
            //@< 
             	n.prototype.init = function(iNfunction) {
	                this.eventTarget.addEventListener('start', () => {
		            	if(typeof this.functionOnEventStart == 'function'){
		            		this.functionOnEventStart();
		            	}
		            });
	            },
	            n.prototype.onStart = function(iNfunction) {
	                this.functionOnEventStart = iNfunction;
	            },
	            n.prototype.onStop = function(iNfunction) {
	                this.functionOnEventStop = iNfunction;
	            }, 
	            n.prototype.onResume = function(iNfunction) {
	                this.functionOnEventResume = iNfunction;
	            }, 
	            n.prototype.onPause = function(iNfunction) {
	                this.functionOnEventPause = iNfunction;
	            }, 
	            n.prototype.onStreamError = function(iNfunction) {
	                this.eventTarget.addEventListener('streamError', iNfunction)
	            }, 
	            n.prototype.onStreamReady = function(iNfunction) {
	                this.eventTarget.addEventListener('streamReady', iNfunction)
	            }, 
	            n.prototype.onDataAvailable = function(iNfunction) {
	                this.functionOnEventDataAvailable = iNfunction;
	            },
	            n.prototype.onSave = function(iNfunction) {
	                this.functionOnEventSave = iNfunction;
	            },
	            n.prototype.delete = function() {
	            	flagClearedStream = true;
	            	this.stop();
	            },
	            n.prototype.save = function() {
	            	flagClearedStream = false;
	            	this.stop();
	            },
           //@>
            n.prototype.clearStream = function() {
            	//@MZ set value -> we clear this stream
                this.stream && (this.stream.getTracks ? this.stream.getTracks().forEach(function(e) {
                    e.stop()
                }) : this.stream.stop(), delete this.stream)
            }, n.prototype.encodeBuffers = function(e) {
                if ("recording" === this.state) {
                    for (var t = [], n = 0; n < e.numberOfChannels; n++) t[n] = e.getChannelData(n);
                    this.encoder.postMessage({
                        command: "encode",
                        buffers: t
                    })
                }
            }, n.prototype.initStream = function(iNfunctions) {
            	if ( typeof iNfunctions != 'object' ) iNfunctions = {}; 
                var e = this,
                    n = function (n)  {
                    	//@MZ set value -> we clear this stream
                    	flagClearedStream = false;

                        e.stream = n, e.sourceNode = e.audioContext.createMediaStreamSource(n), e.sourceNode.connect(e.scriptProcessorNode), e.sourceNode.connect(e.monitorNode), e.eventTarget.dispatchEvent(new t.Event("streamReady")), n;
                    	
                    	if( typeof iNfunctions['onSuccess'] == 'function' ) iNfunctions['onSuccess']();
                    	return e.stream;
                    },
                    o = function (n) {
                    	if(typeof iNfunctions['onError'] == 'function') iNfunctions['onError']();
                        throw e.eventTarget.dispatchEvent(new t.ErrorEvent("streamError", {
                            error: n
                        })), n
                    },
                    i = {
                        audio: this.config.mediaTrackConstraints
                    };
                return this.stream ? (this.eventTarget.dispatchEvent(new t.Event("streamReady")), t.Promise.resolve(this.stream)) : t.navigator.mediaDevices && t.navigator.mediaDevices.getUserMedia ? t.navigator.mediaDevices.getUserMedia(i).then(n, o) : t.navigator.getUserMedia ? new t.Promise(function(e, n) {
                    t.navigator.getUserMedia(i, e, n)
                }).then(n, o) : void 0
            }, n.prototype.pause = function() {
                "recording" === this.state && (this.state = "paused", this.eventTarget.dispatchEvent(new t.Event("pause")))
            }, n.prototype.removeEventListener = function(e, t, n) {
                this.eventTarget.removeEventListener(e, t, n)
            }, n.prototype.resume = function() {
                "paused" === this.state && (this.state = "recording", this.eventTarget.dispatchEvent(new t.Event("resume")))
            }, n.prototype.setMonitorGain = function(e) {
                this.monitorNode.gain.value = e
            }, n.prototype.start = function() {
                if ("inactive" === this.state && this.stream) {
                    var e = this;
                    this.encoder = new t.Worker(this.config.encoderPath), this.config.streamPages ? this.encoder.addEventListener("message", function(t) {
                        e.streamPage(t.data)
                    }) : (this.recordedPages = [], this.totalLength = 0, this.encoder.addEventListener("message", function(t) {
                        e.storePage(t.data)
                    })), this.encodeBuffers = function() {
                        delete this.encodeBuffers
                    }, this.state = "recording", this.monitorNode.connect(this.audioContext.destination), this.scriptProcessorNode.connect(this.audioContext.destination), this.eventTarget.dispatchEvent(new t.Event("start")), this.encoder.postMessage(this.config)
                }
            }, n.prototype.stop = function() {
                "inactive" !== this.state && (this.state = "inactive", this.monitorNode.disconnect(), this.scriptProcessorNode.disconnect(), this.config.leaveStreamOpen || this.clearStream(), this.encoder.postMessage({
                    command: "done"
                }))
            }, n.prototype.storePage = function(e) {
                if (null === e) {
                    for (var n = new Uint8Array(this.totalLength), o = 0, i = 0; i < this.recordedPages.length; i++) n.set(this.recordedPages[i], o), o += this.recordedPages[i].length;
                    this.eventTarget.dispatchEvent(new t.CustomEvent("dataAvailable", {
                        detail: n
                    })), this.recordedPages = [], this.eventTarget.dispatchEvent(new t.Event("stop"))
                } else this.recordedPages.push(e), this.totalLength += e.length
            }, n.prototype.streamPage = function(e) {
                null === e ? this.eventTarget.dispatchEvent(new t.Event("stop")) : this.eventTarget.dispatchEvent(new t.CustomEvent("dataAvailable", {
                    detail: e
                }))
            }, e.exports = n
        }).call(t, n(1))
    }, function(e, t) {
        var n;
        n = function() {
            return this
        }();
        try {
            n = n || Function("return this")() || (0, eval)("this")
        } catch (e) {
            "object" == typeof window && (n = window)
        }
        e.exports = n
    }])
});
define('m_record',['jquery', 'mediaStreamRecorder','WebAudioRecorder', 'Recorder' ],function(  $, RECORDER,WebAudioRecorder, Recorder ) {
	console.log('Recorder init ',Recorder)
	const _ = {'library': RECORDER};
	const CONST = {};

	function video (iNdata) {
		/*
			@discr
				for record audion
			@inputs
				iNdata -> object
					onSuccess -> function
					onError -> function
		*/
		//
		getPermissionForLiveVideoRecord (
			// success function
			(stream) => {
				var dataInner = {};
				 var mediaRecorder = new MediaStreamRecorder(stream);
				 // mediaRecorder.mimeType = 'audio/wav'; // check this line for audio/wav
				 mediaRecorder.mimeType = 'video/webm';
				 // mediaRecorder.canvas = {
				 //    width: 320,
				 //    height: 320
				 // };
				 // mediaRecorder.videoWidth  = 320;
				 // mediaRecorder.videoHeight = 320;
				 console.log('getPermissionForLiveVideoRecord stream',stream);
				 // mediaRecorder.recorderType = MediaRecorderWrapper;
				 // console.log('MediaRecorderWrapper',MediaRecorderWrapper)
				 console.log('video',mediaRecorder)

				 mediaRecorder.ondataavailable =  function (blob) {
			        // POST/PUT "Blob" using FormData/XHR2
			        console.log('video.ondataavailable blob ',blob);
			        // var blobURL = URL.createObjectURL(blob);
			        if(typeof dataInner['getGlob'] == 'function') dataInner['getGlob'](blob,mediaRecorder);
			        // mediaRecorder.save(blob,'1.ogg');
			     };
			     if( typeof iNdata['onSuccess']  == 'function' ) iNdata['onSuccess']( stream, mediaRecorder , dataInner);
		    	 // mediaRecorder.start();
			}, 
			// error funciton
			(e) => {
			     if(typeof iNdata['onError']  == 'function') iNdata['onError'](e);
				
			}
		);
	}
	_['video'] = video;


	function stopRecordingByStream (iNstream) {
		var tracks = iNstream.getTracks();
		for(var iKey in tracks) {
			console.log('stopRecordingByStream tracks[iKey]',tracks[iKey]);
			tracks[iKey].stop();
		}
	}
	_['stopRecordingByStream'] = stopRecordingByStream;


	function audioOld (iNdata) {
		/*
			@discr
				for record audion
			@inputs
				iNdata -> object
					onSuccess -> function
					onError -> function
		*/
		//
		getPermissionForAudioRecord (
			// success function
			(stream) => {
				var dataInner = {};
				 var mediaRecorder = new MediaStreamRecorder(stream);
				 // mediaRecorder.mimeType = 'audio/wav'; // check this line for audio/wav
				 mediaRecorder.mimeType = 'audio/ogg';
				 // mediaRecorder.recorderType = MediaRecorderWrapper;
				 // console.log('MediaRecorderWrapper',MediaRecorderWrapper)
				 console.log('mediaRecorder',mediaRecorder)

				 mediaRecorder.ondataavailable =  function (blob) {
			        // POST/PUT "Blob" using FormData/XHR2
			        console.log('mediaRecorder.ondataavailable blob ',blob);
			        // var blobURL = URL.createObjectURL(blob);
			        if(typeof dataInner['getGlob'] == 'function') dataInner['getGlob'](blob,mediaRecorder);
			        // mediaRecorder.save(blob,'1.ogg');
			     };
			     if( typeof iNdata['onSuccess']  == 'function' ) iNdata['onSuccess']( stream, mediaRecorder , dataInner);
		    	 // mediaRecorder.start();
			}, 
			// error funciton
			(e) => {
			     if(typeof iNdata['onError']  == 'function') iNdata['onError'](e);
				
			}
		);
	}
	_['audioOld'] = audioOld;


	function audio2 (iNdata) {
		/*
			@discr
				for record audion
			@inputs
				iNdata -> object
					onSuccess -> function
					onError -> function
		*/
		//
		getPermissionForAudioRecord (
			// success function
			(stream) => {
				var dataInner = {};
				var configs = {
					'encoding' : 'ogg',
					'workerDir' : 'res/js/recorder/webAudioRecorder/lib/',
					'numChannels': 2 // Default 2
				};
				// var sourseNOde = 
				var audioCtx = new AudioContext();
				var source = audioCtx.createMediaStreamSource(stream);
				var webRecorder = new WebAudioRecorder(source, configs);
				webRecorder.setOptions({
					// 'encodeAfterRecord' : true,
					'timeLimit' : 600, // recording time limit (second) (default = 300)
					'ogg': {
						'quality': -0.1,
						'mimeType' : 'audio/ogg; codecs=opus',
						// webRecorder.onComplete blob  Blob {size: 386598, type: "audio/ogg"} sound.duration 9.798820861678005 - 1.0
						// webRecorder.onComplete blob  Blob {size: 136878, type: "audio/ogg"} sound.duration 9.798820861678005 - 0.5
						// webRecorder.onComplete blob  Blob {size: 96909, type: "audio/ogg"} sound.duration 9.798820861678005 - 0.2
						// webRecorder.onComplete blob  Blob {size: 49576, type: "audio/ogg"} sound.duration 10.518662131519275 - -0.1
					}
				})

				webRecorder.onEncoderLoaded = function(recorder, encoding) { 	console.log('webRecorder.onEncoderLoaded - recorder, encoding',recorder, encoding); }
				webRecorder.onEncodingCanceled = function(recorder, encoding) { console.log('webRecorder.onEncodingCanceled - recorder, encoding',recorder, encoding); }
				webRecorder.onEncodingProgress = function(recorder, progress) { console.log('webRecorder.onEncodingProgress - recorder, progress',recorder, progress); }
				webRecorder.onEncoderLoading = function(recorder, encoding) { 	console.log('webRecorder.onEncoderLoading - recorder, encoding',recorder, encoding); }


				webRecorder.onError =  function (recorder, blob) {
				};
				webRecorder.onComplete =   (recorder, blob) =>{
			        // POST/PUT "Blob" using FormData/XHR2
			        // var blobURL = URL.createObjectURL(blob);
			        if(typeof dataInner['getGlob'] == 'function') dataInner['getGlob'](false,blob);
			        // mediaRecorder.save(blob,'1.ogg');
			    };

			    setTimeout (
					() => {
						if( typeof iNdata['onSuccess']  == 'function' ) iNdata['onSuccess']( stream, recorder);
					},
					500
				);
			    if( typeof iNdata['onSuccess']  == 'function' ) iNdata['onSuccess']( stream, webRecorder , dataInner);
		    	 // mediaRecorder.start();
			}, 
			// error funciton
			(e) => {
			     if(typeof iNdata['onError']  == 'function') iNdata['onError'](e);
				
			}
		);
	}
	_['audio2'] = audio2;



	function liveAudioRecord (iNdata) {
		/*
			@discr
				for record audion
			@inputs
				iNdata -> object
					onSuccess 		-> function
					onError 		-> function
					onDataAvailable -> function
		*/
		//
		getPermissionForAudioRecord (
			// success function
			(stream) => {
				 var recorder = new Recorder({
			        // monitorGain: parseInt(monitorGain.value, 10),
			        // numberOfChannels: parseInt(numberOfChannels.value, 10),
			        // bitRate: parseInt(bitRate.value,10),
			        // encoderSampleRate: parseInt(encoderSampleRate.value,10),

			        // leaveStreamOpen : true,
			        encoderSampleRate : 16000,
			        resampleQuality: 0,
			        encoderPath: "res/js/recorder/OggOpusRecorder/dist/encoderWorker.min.js", ///Users/zurab/ /ConnectWeb/ConnectWebAndDesctop/res/js/recorder/OggOpusRecorder/src/encoderWorker.js
			      });

				 recorder.onStart ( 
				 	() => {
				 		// console.log('recorder.onStart');
				 	}
				 );
				 recorder.onStop ( 
				 	() => {
				 		// console.log('recorder.onStop');
				 	}
				 );
				 recorder.onPause ( 
				 	() => {
				 		// console.log('recorder.onPause');
				 	}
				 );
				 recorder.onSave (
					(e) => {
			        	var blob = new Blob( [e.detail], { type: 'audio/ogg' } );
			        	if ( typeof iNdata['onDataAvailable'] == 'function' ) iNdata['onDataAvailable'](false,blob);

					}
				 );

				 // recorder.delete();
				 
		    	 recorder.initStream(
					{
						onSuccess : () => {
							if( typeof iNdata['onSuccess']  == 'function' ) iNdata['onSuccess']( stream, recorder );

						}
					}
				 );
			}, 
			// error funciton
			(e) => {
			     if(typeof iNdata['onError']  == 'function') iNdata['onError'](e);
				
			}
		);
	}
	_['liveAudioRecord'] = liveAudioRecord;

	function getUserMedia (iNmediaConstraints, iNMediaSuccess, iNMediaError) {
		navigator.getUserMedia(iNmediaConstraints, iNMediaSuccess, iNMediaError);
	}
	_['getUserMedia'] = getUserMedia;

	function getPermissionForAudioRecord (onSuccess, onError) {
		//prepared options for start audio
		var audioMediaConstraints = {
		    audio: true
		};
		navigator.getUserMedia(audioMediaConstraints, onSuccess, onError);
	}
	_['getPermissionForAudioRecord'] = getPermissionForAudioRecord;

	function getPermissionForVideoRecord (onSuccess, onError) {
		//prepared options for start audio
		var audioMediaConstraints = {
		    video: true,
		};
		navigator.getUserMedia(audioMediaConstraints, onSuccess, onError);
	}
	_['getPermissionForVideoRecord'] = getPermissionForVideoRecord;

	function getPermissionForLiveVideoRecord (onSuccess, onError) {
		//prepared options for start audio
		var constrainedWidth = 200,
			constrainedHeight = 200;
		 var video_constraints = {
		    "mandatory": {
		       maxHeight: constrainedHeight + 120,
		       maxWidth: constrainedWidth + 120,
		      "minWidth": constrainedWidth,
		      "minHeight": constrainedHeight,
		      // "minFrameRate": "30"
		    },
		    "optional": []
		  }
		// var vid_constraints = {
		//     mandatory: {
		//         maxHeight: 320,
		//         maxWidth: 320
		//     },
		//     width: { min: 240, ideal: 320, max: 380 },
  		//     height: { min: 240, ideal: 320, max: 380 },
		// }
		var audioMediaConstraints = {
		    video: video_constraints,
		    audio: true
		};
		navigator.getUserMedia(audioMediaConstraints, onSuccess, onError);
	}
	_['getPermissionForLiveVideoRecord'] = getPermissionForLiveVideoRecord;

	return _;
});
/*! algoliasearch 3.24.6 |  2014, 2015 Algolia SAS | github.com/algolia/algoliasearch-client-js */
!function(e){var t;"undefined"!=typeof window?t=window:"undefined"!=typeof self&&(t=self),t.ALGOLIA_MIGRATION_LAYER=e()}(function(){return function e(t,n,r){function o(s,a){if(!n[s]){if(!t[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(i)return i(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return o(n?n:e)},l,l.exports,e,t,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){function r(e,t){for(var n in t)e.setAttribute(n,t[n])}function o(e,t){e.onload=function(){this.onerror=this.onload=null,t(null,e)},e.onerror=function(){this.onerror=this.onload=null,t(new Error("Failed to load "+this.src),e)}}function i(e,t){e.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||(this.onreadystatechange=null,t(null,e))}}t.exports=function(e,t,n){var s=document.head||document.getElementsByTagName("head")[0],a=document.createElement("script");"function"==typeof t&&(n=t,t={}),t=t||{},n=n||function(){},a.type=t.type||"text/javascript",a.charset=t.charset||"utf8",a.async=!("async"in t)||!!t.async,a.src=e,t.attrs&&r(a,t.attrs),t.text&&(a.text=""+t.text);var c="onload"in a?o:i;c(a,n),a.onload||o(a,n),s.appendChild(a)}},{}],2:[function(e,t,n){"use strict";function r(e){for(var t=new RegExp("cdn\\.jsdelivr\\.net/algoliasearch/latest/"+e.replace(".","\\.")+"(?:\\.min)?\\.js$"),n=document.getElementsByTagName("script"),r=!1,o=0,i=n.length;o<i;o++)if(n[o].src&&t.test(n[o].src)){r=!0;break}return r}t.exports=r},{}],3:[function(e,t,n){"use strict";function r(t){var n=e(1),r="//cdn.jsdelivr.net/algoliasearch/2/"+t+".min.js",i="-- AlgoliaSearch `latest` warning --\nWarning, you are using the `latest` version string from jsDelivr to load the AlgoliaSearch library.\nUsing `latest` is no more recommended, you should load //cdn.jsdelivr.net/algoliasearch/2/algoliasearch.min.js\n\nAlso, we updated the AlgoliaSearch JavaScript client to V3. If you want to upgrade,\nplease read our migration guide at https://github.com/algolia/algoliasearch-client-js/wiki/Migration-guide-from-2.x.x-to-3.x.x\n-- /AlgoliaSearch  `latest` warning --";window.console&&(window.console.warn?window.console.warn(i):window.console.log&&window.console.log(i));try{document.write("<script>window.ALGOLIA_SUPPORTS_DOCWRITE = true</script>"),window.ALGOLIA_SUPPORTS_DOCWRITE===!0?(document.write('<script src="'+r+'"></script>'),o("document.write")()):n(r,o("DOMElement"))}catch(s){n(r,o("DOMElement"))}}function o(e){return function(){var t="AlgoliaSearch: loaded V2 script using "+e;window.console&&window.console.log&&window.console.log(t)}}t.exports=r},{1:1}],4:[function(e,t,n){"use strict";function r(){var e="-- AlgoliaSearch V2 => V3 error --\nYou are trying to use a new version of the AlgoliaSearch JavaScript client with an old notation.\nPlease read our migration guide at https://github.com/algolia/algoliasearch-client-js/wiki/Migration-guide-from-2.x.x-to-3.x.x\n-- /AlgoliaSearch V2 => V3 error --";window.AlgoliaSearch=function(){throw new Error(e)},window.AlgoliaSearchHelper=function(){throw new Error(e)},window.AlgoliaExplainResults=function(){throw new Error(e)}}t.exports=r},{}],5:[function(e,t,n){"use strict";function r(t){var n=e(2),r=e(3),o=e(4);n(t)?r(t):o()}r("algoliasearch")},{2:2,3:3,4:4}]},{},[5])(5)}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define('algolia',[],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.algoliasearch=e()}}(function(){var e;return function t(e,n,r){function o(s,a){if(!n[s]){if(!e[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(i)return i(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[s]={exports:{}};e[s][0].call(l.exports,function(t){var n=e[s][1][t];return o(n?n:t)},l,l.exports,t,e,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){(function(r){function o(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function i(e){var t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+n.humanize(this.diff),t){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))}),e.splice(i,0,r)}}function s(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(e){try{null==e?n.storage.removeItem("debug"):n.storage.debug=e}catch(t){}}function c(){var e;try{e=n.storage.debug}catch(t){}return!e&&"undefined"!=typeof r&&"env"in r&&(e=r.env.DEBUG),e}function u(){try{return window.localStorage}catch(e){}}n=t.exports=e(2),n.log=s,n.formatArgs=i,n.save=a,n.load=c,n.useColors=o,n.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:u(),n.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],n.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},n.enable(c())}).call(this,e(12))},{12:12,2:2}],2:[function(e,t,n){function r(e){var t,r=0;for(t in e)r=(r<<5)-r+e.charCodeAt(t),r|=0;return n.colors[Math.abs(r)%n.colors.length]}function o(e){function t(){if(t.enabled){var e=t,r=+new Date,o=r-(u||r);e.diff=o,e.prev=u,e.curr=r,u=r;for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];i[0]=n.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var a=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,function(t,r){if("%%"===t)return t;a++;var o=n.formatters[r];if("function"==typeof o){var s=i[a];t=o.call(e,s),i.splice(a,1),a--}return t}),n.formatArgs.call(e,i);var c=t.log||n.log||console.log.bind(console);c.apply(e,i)}}return t.namespace=e,t.enabled=n.enabled(e),t.useColors=n.useColors(),t.color=r(e),"function"==typeof n.init&&n.init(t),t}function i(e){n.save(e),n.names=[],n.skips=[];for(var t=("string"==typeof e?e:"").split(/[\s,]+/),r=t.length,o=0;o<r;o++)t[o]&&(e=t[o].replace(/\*/g,".*?"),"-"===e[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")))}function s(){n.enable("")}function a(e){var t,r;for(t=0,r=n.skips.length;t<r;t++)if(n.skips[t].test(e))return!1;for(t=0,r=n.names.length;t<r;t++)if(n.names[t].test(e))return!0;return!1}function c(e){return e instanceof Error?e.stack||e.message:e}n=t.exports=o.debug=o["default"]=o,n.coerce=c,n.disable=s,n.enable=i,n.enabled=a,n.humanize=e(9),n.names=[],n.skips=[],n.formatters={};var u},{9:9}],3:[function(t,n,r){(function(o,i){!function(t,o){"object"==typeof r&&"undefined"!=typeof n?n.exports=o():"function"==typeof e&&e.amd?e(o):t.ES6Promise=o()}(this,function(){"use strict";function e(e){return"function"==typeof e||"object"==typeof e&&null!==e}function n(e){return"function"==typeof e}function r(e){X=e}function s(e){W=e}function a(){return function(){return o.nextTick(d)}}function c(){return"undefined"!=typeof V?function(){V(d)}:p()}function u(){var e=0,t=new Z(d),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function l(){var e=new MessageChannel;return e.port1.onmessage=d,function(){return e.port2.postMessage(0)}}function p(){var e=setTimeout;return function(){return e(d,1)}}function d(){for(var e=0;e<G;e+=2){var t=ne[e],n=ne[e+1];t(n),ne[e]=void 0,ne[e+1]=void 0}G=0}function h(){try{var e=t,n=e("vertx");return V=n.runOnLoop||n.runOnContext,c()}catch(r){return p()}}function f(e,t){var n=arguments,r=this,o=new this.constructor(m);void 0===o[oe]&&C(o);var i=r._state;return i?!function(){var e=n[i-1];W(function(){return P(i,o,e,r._result)})}():I(r,o,e,t),o}function y(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(m);return R(n,e),n}function m(){}function v(){return new TypeError("You cannot resolve a promise with itself")}function g(){return new TypeError("A promises callback cannot return that same promise.")}function b(e){try{return e.then}catch(t){return ce.error=t,ce}}function w(e,t,n,r){try{e.call(t,n,r)}catch(o){return o}}function _(e,t,n){W(function(e){var r=!1,o=w(n,t,function(n){r||(r=!0,t!==n?R(e,n):S(e,n))},function(t){r||(r=!0,A(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&o&&(r=!0,A(e,o))},e)}function x(e,t){t._state===se?S(e,t._result):t._state===ae?A(e,t._result):I(t,void 0,function(t){return R(e,t)},function(t){return A(e,t)})}function T(e,t,r){t.constructor===e.constructor&&r===f&&t.constructor.resolve===y?x(e,t):r===ce?(A(e,ce.error),ce.error=null):void 0===r?S(e,t):n(r)?_(e,t,r):S(e,t)}function R(t,n){t===n?A(t,v()):e(n)?T(t,n,b(n)):S(t,n)}function j(e){e._onerror&&e._onerror(e._result),k(e)}function S(e,t){e._state===ie&&(e._result=t,e._state=se,0!==e._subscribers.length&&W(k,e))}function A(e,t){e._state===ie&&(e._state=ae,e._result=t,W(j,e))}function I(e,t,n,r){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+se]=n,o[i+ae]=r,0===i&&e._state&&W(k,e)}function k(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,o=void 0,i=e._result,s=0;s<t.length;s+=3)r=t[s],o=t[s+n],r?P(n,r,o,i):o(i);e._subscribers.length=0}}function O(){this.error=null}function E(e,t){try{return e(t)}catch(n){return ue.error=n,ue}}function P(e,t,r,o){var i=n(r),s=void 0,a=void 0,c=void 0,u=void 0;if(i){if(s=E(r,o),s===ue?(u=!0,a=s.error,s.error=null):c=!0,t===s)return void A(t,g())}else s=o,c=!0;t._state!==ie||(i&&c?R(t,s):u?A(t,a):e===se?S(t,s):e===ae&&A(t,s))}function U(e,t){try{t(function(t){R(e,t)},function(t){A(e,t)})}catch(n){A(e,n)}}function q(){return le++}function C(e){e[oe]=le++,e._state=void 0,e._result=void 0,e._subscribers=[]}function N(e,t){this._instanceConstructor=e,this.promise=new e(m),this.promise[oe]||C(this.promise),$(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?S(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&S(this.promise,this._result))):A(this.promise,D())}function D(){return new Error("Array Methods must be provided an Array")}function L(e){return new N(this,e).promise}function K(e){var t=this;return new t($(e)?function(n,r){for(var o=e.length,i=0;i<o;i++)t.resolve(e[i]).then(n,r)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function H(e){var t=this,n=new t(m);return A(n,e),n}function M(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function J(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function F(e){this[oe]=q(),this._result=this._state=void 0,this._subscribers=[],m!==e&&("function"!=typeof e&&M(),this instanceof F?U(this,e):J())}function B(){var e=void 0;if("undefined"!=typeof i)e=i;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=e.Promise;if(n){var r=null;try{r=Object.prototype.toString.call(n.resolve())}catch(t){}if("[object Promise]"===r&&!n.cast)return}e.Promise=F}var Q=void 0;Q=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var $=Q,G=0,V=void 0,X=void 0,W=function(e,t){ne[G]=e,ne[G+1]=t,G+=2,2===G&&(X?X(d):re())},Y="undefined"!=typeof window?window:void 0,z=Y||{},Z=z.MutationObserver||z.WebKitMutationObserver,ee="undefined"==typeof self&&"undefined"!=typeof o&&"[object process]"==={}.toString.call(o),te="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ne=new Array(1e3),re=void 0;re=ee?a():Z?u():te?l():void 0===Y&&"function"==typeof t?h():p();var oe=Math.random().toString(36).substring(16),ie=void 0,se=1,ae=2,ce=new O,ue=new O,le=0;return N.prototype._enumerate=function(){for(var e=this.length,t=this._input,n=0;this._state===ie&&n<e;n++)this._eachEntry(t[n],n)},N.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===y){var o=b(e);if(o===f&&e._state!==ie)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(n===F){var i=new n(m);T(i,e,o),this._willSettleAt(i,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},N.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===ie&&(this._remaining--,e===ae?A(r,n):this._result[t]=n),0===this._remaining&&S(r,this._result)},N.prototype._willSettleAt=function(e,t){var n=this;I(e,void 0,function(e){return n._settledAt(se,t,e)},function(e){return n._settledAt(ae,t,e)})},F.all=L,F.race=K,F.resolve=y,F.reject=H,F._setScheduler=r,F._setAsap=s,F._asap=W,F.prototype={constructor:F,then:f,"catch":function(e){return this.then(null,e)}},F.polyfill=B,F.Promise=F,F})}).call(this,t(12),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{12:12}],4:[function(e,t,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(e){return"function"==typeof e}function i(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!i(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,i,c,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(n=this._events[e],a(n))return!1;if(o(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),n.apply(this,i)}else if(s(n))for(i=Array.prototype.slice.call(arguments,1),u=n.slice(),r=u.length,c=0;c<r;c++)u[c].apply(this,i);return!0},r.prototype.addListener=function(e,t){var n;if(!o(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,o(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned&&(n=a(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!o(t))throw TypeError("listener must be a function");var r=!1;return n.listener=t,this.on(e,n),this},r.prototype.removeListener=function(e,t){var n,r,i,a;if(!o(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],i=n.length,r=-1,n===t||o(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(n)){for(a=i;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){r=a;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],o(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?o(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(o(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},{}],5:[function(e,t,n){var r=Object.prototype.hasOwnProperty,o=Object.prototype.toString;t.exports=function(e,t,n){if("[object Function]"!==o.call(t))throw new TypeError("iterator must be a function");var i=e.length;if(i===+i)for(var s=0;s<i;s++)t.call(n,e[s],s,e);else for(var a in e)r.call(e,a)&&t.call(n,e[a],a,e)}},{}],6:[function(e,t,n){(function(e){var n;n="undefined"!=typeof window?window:"undefined"!=typeof e?e:"undefined"!=typeof self?self:{},t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],7:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],8:[function(e,t,n){var r={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},{}],9:[function(e,t,n){function r(e){if(e=String(e),!(e.length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]),r=(t[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return n*p;case"days":case"day":case"d":return n*l;case"hours":case"hour":case"hrs":case"hr":case"h":return n*u;case"minutes":case"minute":case"mins":case"min":case"m":return n*c;case"seconds":case"second":case"secs":case"sec":case"s":return n*a;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function o(e){return e>=l?Math.round(e/l)+"d":e>=u?Math.round(e/u)+"h":e>=c?Math.round(e/c)+"m":e>=a?Math.round(e/a)+"s":e+"ms"}function i(e){return s(e,l,"day")||s(e,u,"hour")||s(e,c,"minute")||s(e,a,"second")||e+" ms"}function s(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var a=1e3,c=60*a,u=60*c,l=24*u,p=365.25*l;t.exports=function(e,t){t=t||{};var n=typeof e;if("string"===n&&e.length>0)return r(e);if("number"===n&&isNaN(e)===!1)return t["long"]?i(e):o(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},{}],10:[function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,o=Object.prototype.toString,i=Array.prototype.slice,s=e(11),a=Object.prototype.propertyIsEnumerable,c=!a.call({toString:null},"toString"),u=a.call(function(){},"prototype"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],p=function(e){var t=e.constructor;return t&&t.prototype===e},d={$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},h=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!d["$"+e]&&r.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{p(window[e])}catch(t){return!0}}catch(t){return!0}return!1}(),f=function(e){if("undefined"==typeof window||!h)return p(e);try{return p(e)}catch(t){return!1}},y=function(e){var t=null!==e&&"object"==typeof e,n="[object Function]"===o.call(e),i=s(e),a=t&&"[object String]"===o.call(e),p=[];if(!t&&!n&&!i)throw new TypeError("Object.keys called on a non-object");var d=u&&n;if(a&&e.length>0&&!r.call(e,0))for(var h=0;h<e.length;++h)p.push(String(h));if(i&&e.length>0)for(var y=0;y<e.length;++y)p.push(String(y));else for(var m in e)d&&"prototype"===m||!r.call(e,m)||p.push(String(m));if(c)for(var v=f(e),g=0;g<l.length;++g)v&&"constructor"===l[g]||!r.call(e,l[g])||p.push(l[g]);return p};y.shim=function(){if(Object.keys){var e=function(){return 2===(Object.keys(arguments)||"").length}(1,2);if(!e){var t=Object.keys;Object.keys=function(e){return t(s(e)?i.call(e):e)}}}else Object.keys=y;return Object.keys||y},t.exports=y},{11:11}],11:[function(e,t,n){"use strict";var r=Object.prototype.toString;t.exports=function(e){var t=r.call(e),n="[object Arguments]"===t;return n||(n="[object Array]"!==t&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===r.call(e.callee)),n}},{}],12:[function(e,t,n){function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(p===setTimeout)return setTimeout(e,0);if((p===r||!p)&&setTimeout)return p=setTimeout,setTimeout(e,0);try{return p(e,0)}catch(t){try{return p.call(null,e,0)}catch(t){return p.call(this,e,0)}}}function s(e){if(d===clearTimeout)return clearTimeout(e);if((d===o||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(e);try{return d(e)}catch(t){try{return d.call(null,e)}catch(t){return d.call(this,e)}}}function a(){m&&f&&(m=!1,f.length?y=f.concat(y):v=-1,y.length&&c())}function c(){if(!m){var e=i(a);m=!0;for(var t=y.length;t;){for(f=y,y=[];++v<t;)f&&f[v].run();v=-1,t=y.length}f=null,m=!1,s(e)}}function u(e,t){this.fun=e,this.array=t}function l(){}var p,d,h=t.exports={};!function(){try{p="function"==typeof setTimeout?setTimeout:r}catch(e){p=r}try{d="function"==typeof clearTimeout?clearTimeout:o}catch(e){d=o}}();var f,y=[],m=!1,v=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];y.push(new u(e,t)),1!==y.length||m||i(c)},u.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=l,h.addListener=l,h.once=l,h.off=l,h.removeListener=l,h.removeAllListeners=l,h.emit=l,h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},{}],13:[function(e,t,n){"use strict";function r(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var o=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,n,a){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?r(s(e),function(s){var a=encodeURIComponent(o(s))+n;return i(e[s])?r(e[s],function(e){return a+encodeURIComponent(o(e))}).join(t):a+encodeURIComponent(o(e[s]))}).join(t):a?encodeURIComponent(o(a))+n+encodeURIComponent(o(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},s=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},{}],14:[function(e,t,n){function r(){c.apply(this,arguments)}function o(){var e="Not implemented in this environment.\nIf you feel this is a mistake, write to support@algolia.com";throw new l.AlgoliaSearchError(e)}t.exports=r;var i=e(16),s=e(26),a=e(27),c=e(15),u=e(7),l=e(28);u(r,c),r.prototype.deleteIndex=function(e,t){return this._jsonRequest({method:"DELETE",url:"/1/indexes/"+encodeURIComponent(e),hostType:"write",callback:t})},r.prototype.moveIndex=function(e,t,n){var r={operation:"move",destination:t};return this._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(e)+"/operation",body:r,hostType:"write",callback:n})},r.prototype.copyIndex=function(e,t,n,r){var o={operation:"copy",destination:t},i=r;if("function"==typeof n)i=n;else{if(!(Array.isArray(n)&&n.length>0))throw new Error("the scope given to `copyIndex` was not an array with settings, synonyms or rules");o.scope=n}return this._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(e)+"/operation",body:o,hostType:"write",callback:i})},r.prototype.getLogs=function(t,n,r){var o=e(25),i={};return"object"==typeof t?(i=o(t),r=n):0===arguments.length||"function"==typeof t?r=t:1===arguments.length||"function"==typeof n?(r=n,i.offset=t):(i.offset=t,i.length=n),void 0===i.offset&&(i.offset=0),void 0===i.length&&(i.length=10),this._jsonRequest({method:"GET",url:"/1/logs?"+this._getSearchParams(i,""),hostType:"read",callback:r})},r.prototype.listIndexes=function(e,t){var n="";return void 0===e||"function"==typeof e?t=e:n="?page="+e,this._jsonRequest({method:"GET",url:"/1/indexes"+n,hostType:"read",callback:t})},r.prototype.initIndex=function(e){return new i(this,e)},r.prototype.listUserKeys=s(function(e){return this.listApiKeys(e)},a("client.listUserKeys()","client.listApiKeys()")),r.prototype.listApiKeys=function(e){return this._jsonRequest({method:"GET",url:"/1/keys",hostType:"read",callback:e})},r.prototype.getUserKeyACL=s(function(e,t){return this.getApiKey(e,t)},a("client.getUserKeyACL()","client.getApiKey()")),r.prototype.getApiKey=function(e,t){return this._jsonRequest({method:"GET",url:"/1/keys/"+e,hostType:"read",callback:t})},r.prototype.deleteUserKey=s(function(e,t){return this.deleteApiKey(e,t)},a("client.deleteUserKey()","client.deleteApiKey()")),r.prototype.deleteApiKey=function(e,t){return this._jsonRequest({method:"DELETE",url:"/1/keys/"+e,hostType:"write",callback:t})},r.prototype.addUserKey=s(function(e,t,n){return this.addApiKey(e,t,n)},a("client.addUserKey()","client.addApiKey()")),r.prototype.addApiKey=function(t,n,r){var o=e(8),i="Usage: client.addApiKey(arrayOfAcls[, params, callback])";if(!o(t))throw new Error(i);1!==arguments.length&&"function"!=typeof n||(r=n,n=null);var s={acl:t};return n&&(s.validity=n.validity,s.maxQueriesPerIPPerHour=n.maxQueriesPerIPPerHour,s.maxHitsPerQuery=n.maxHitsPerQuery,s.indexes=n.indexes,s.description=n.description,n.queryParameters&&(s.queryParameters=this._getSearchParams(n.queryParameters,"")),s.referers=n.referers),this._jsonRequest({method:"POST",url:"/1/keys",body:s,hostType:"write",callback:r})},r.prototype.addUserKeyWithValidity=s(function(e,t,n){return this.addApiKey(e,t,n)},a("client.addUserKeyWithValidity()","client.addApiKey()")),r.prototype.updateUserKey=s(function(e,t,n,r){return this.updateApiKey(e,t,n,r)},a("client.updateUserKey()","client.updateApiKey()")),r.prototype.updateApiKey=function(t,n,r,o){var i=e(8),s="Usage: client.updateApiKey(key, arrayOfAcls[, params, callback])";if(!i(n))throw new Error(s);2!==arguments.length&&"function"!=typeof r||(o=r,r=null);var a={acl:n};return r&&(a.validity=r.validity,a.maxQueriesPerIPPerHour=r.maxQueriesPerIPPerHour,a.maxHitsPerQuery=r.maxHitsPerQuery,a.indexes=r.indexes,a.description=r.description,r.queryParameters&&(a.queryParameters=this._getSearchParams(r.queryParameters,"")),a.referers=r.referers),this._jsonRequest({method:"PUT",url:"/1/keys/"+t,body:a,hostType:"write",callback:o})},r.prototype.startQueriesBatch=s(function(){this._batch=[]},a("client.startQueriesBatch()","client.search()")),r.prototype.addQueryInBatch=s(function(e,t,n){this._batch.push({indexName:e,query:t,params:n})},a("client.addQueryInBatch()","client.search()")),r.prototype.sendQueriesBatch=s(function(e){return this.search(this._batch,e)},a("client.sendQueriesBatch()","client.search()")),r.prototype.batch=function(t,n){var r=e(8),o="Usage: client.batch(operations[, callback])";if(!r(t))throw new Error(o);return this._jsonRequest({method:"POST",url:"/1/indexes/*/batch",body:{requests:t},hostType:"write",callback:n})},r.prototype.destroy=o,r.prototype.enableRateLimitForward=o,r.prototype.disableRateLimitForward=o,r.prototype.useSecuredAPIKey=o,r.prototype.disableSecuredAPIKey=o,r.prototype.generateSecuredApiKey=o},{15:15,16:16,25:25,26:26,27:27,28:28,7:7,8:8}],15:[function(e,t,n){(function(n){function r(t,n,r){var i=e(1)("algoliasearch"),s=e(25),a=e(8),u=e(30),l="Usage: algoliasearch(applicationID, apiKey, opts)";if(r._allowEmptyCredentials!==!0&&!t)throw new c.AlgoliaSearchError("Please provide an application ID. "+l);if(r._allowEmptyCredentials!==!0&&!n)throw new c.AlgoliaSearchError("Please provide an API key. "+l);this.applicationID=t,this.apiKey=n,this.hosts={read:[],write:[]},r=r||{};var p=r.protocol||"https:";if(this._timeouts=r.timeouts||{connect:1e3,read:2e3,write:3e4},r.timeout&&(this._timeouts.connect=this._timeouts.read=this._timeouts.write=r.timeout),/:$/.test(p)||(p+=":"),"http:"!==r.protocol&&"https:"!==r.protocol)throw new c.AlgoliaSearchError("protocol must be `http:` or `https:` (was `"+r.protocol+"`)");if(this._checkAppIdData(),r.hosts)a(r.hosts)?(this.hosts.read=s(r.hosts),this.hosts.write=s(r.hosts)):(this.hosts.read=s(r.hosts.read),this.hosts.write=s(r.hosts.write));else{var d=u(this._shuffleResult,function(e){return t+"-"+e+".algolianet.com"});this.hosts.read=[this.applicationID+"-dsn.algolia.net"].concat(d),this.hosts.write=[this.applicationID+".algolia.net"].concat(d)}this.hosts.read=u(this.hosts.read,o(p)),this.hosts.write=u(this.hosts.write,o(p)),this.extraHeaders={},this.cache=r._cache||{},this._ua=r._ua,this._useCache=!(void 0!==r._useCache&&!r._cache)||r._useCache,this._useFallback=void 0===r.useFallback||r.useFallback,this._setTimeout=r._setTimeout,i("init done, %j",this)}function o(e){return function(t){return e+"//"+t.toLowerCase()}}function i(e){if(void 0===Array.prototype.toJSON)return JSON.stringify(e);var t=Array.prototype.toJSON;delete Array.prototype.toJSON;var n=JSON.stringify(e);return Array.prototype.toJSON=t,n}function s(e){for(var t,n,r=e.length;0!==r;)n=Math.floor(Math.random()*r),r-=1,t=e[r],e[r]=e[n],e[n]=t;return e}function a(e){var t={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r;r="x-algolia-api-key"===n||"x-algolia-application-id"===n?"**hidden for security purposes**":e[n],t[n]=r}return t}t.exports=r;var c=e(28),u=e(29),l=e(18),p=e(34),d=500,h=n.env.RESET_APP_DATA_TIMER&&parseInt(n.env.RESET_APP_DATA_TIMER,10)||12e4;r.prototype.initIndex=function(e){return new l(this,e)},r.prototype.setExtraHeader=function(e,t){this.extraHeaders[e.toLowerCase()]=t},r.prototype.getExtraHeader=function(e){return this.extraHeaders[e.toLowerCase()]},r.prototype.unsetExtraHeader=function(e){delete this.extraHeaders[e.toLowerCase()]},r.prototype.addAlgoliaAgent=function(e){this._ua.indexOf(";"+e)===-1&&(this._ua+=";"+e)},r.prototype._jsonRequest=function(t){function n(e,u){function d(e){var t=e&&e.body&&e.body.message&&e.body.status||e.statusCode||e&&e.body&&200;s("received response: statusCode: %s, computed statusCode: %d, headers: %j",e.statusCode,t,e.headers);var n=2===Math.floor(t/100),i=new Date;if(v.push({currentHost:T,headers:a(o),content:r||null,contentLength:void 0!==r?r.length:null,method:u.method,timeouts:u.timeouts,url:u.url,startTime:x,endTime:i,duration:i-x,statusCode:t}),
n)return h._useCache&&p&&(p[_]=e.responseText),e.body;var l=4!==Math.floor(t/100);if(l)return f+=1,b();s("unrecoverable error");var d=new c.AlgoliaSearchError(e.body&&e.body.message,{debugData:v,statusCode:t});return h._promise.reject(d)}function g(e){s("error: %s, stack: %s",e.message,e.stack);var n=new Date;return v.push({currentHost:T,headers:a(o),content:r||null,contentLength:void 0!==r?r.length:null,method:u.method,timeouts:u.timeouts,url:u.url,startTime:x,endTime:n,duration:n-x}),e instanceof c.AlgoliaSearchError||(e=new c.Unknown(e&&e.message,e)),f+=1,e instanceof c.Unknown||e instanceof c.UnparsableJSON||f>=h.hosts[t.hostType].length&&(y||!m)?(e.debugData=v,h._promise.reject(e)):e instanceof c.RequestTimeout?w():b()}function b(){return s("retrying request"),h._incrementHostIndex(t.hostType),n(e,u)}function w(){return s("retrying request with higher timeout"),h._incrementHostIndex(t.hostType),h._incrementTimeoutMultipler(),u.timeouts=h._getTimeoutsForRequest(t.hostType),n(e,u)}h._checkAppIdData();var _,x=new Date;if(h._useCache&&(_=t.url),h._useCache&&r&&(_+="_body_"+u.body),h._useCache&&p&&void 0!==p[_])return s("serving response from cache"),h._promise.resolve(JSON.parse(p[_]));if(f>=h.hosts[t.hostType].length)return!m||y?(s("could not get any response"),h._promise.reject(new c.AlgoliaSearchError("Cannot connect to the AlgoliaSearch API. Send an email to support@algolia.com to report and resolve the issue. Application id was: "+h.applicationID,{debugData:v}))):(s("switching to fallback"),f=0,u.method=t.fallback.method,u.url=t.fallback.url,u.jsonBody=t.fallback.body,u.jsonBody&&(u.body=i(u.jsonBody)),o=h._computeRequestHeaders(l),u.timeouts=h._getTimeoutsForRequest(t.hostType),h._setHostIndexByType(0,t.hostType),y=!0,n(h._request.fallback,u));var T=h._getHostByType(t.hostType),R=T+u.url,j={body:u.body,jsonBody:u.jsonBody,method:u.method,headers:o,timeouts:u.timeouts,debug:s};return s("method: %s, url: %s, headers: %j, timeouts: %d",j.method,R,j.headers,j.timeouts),e===h._request.fallback&&s("using fallback"),e.call(h,R,j).then(d,g)}this._checkAppIdData();var r,o,s=e(1)("algoliasearch:"+t.url),l=t.additionalUA||"",p=t.cache,h=this,f=0,y=!1,m=h._useFallback&&h._request.fallback&&t.fallback;this.apiKey.length>d&&void 0!==t.body&&(void 0!==t.body.params||void 0!==t.body.requests)?(t.body.apiKey=this.apiKey,o=this._computeRequestHeaders(l,!1)):o=this._computeRequestHeaders(l),void 0!==t.body&&(r=i(t.body)),s("request start");var v=[],g=n(h._request,{url:t.url,method:t.method,body:r,jsonBody:t.body,timeouts:h._getTimeoutsForRequest(t.hostType)});return"function"!=typeof t.callback?g:void g.then(function(e){u(function(){t.callback(null,e)},h._setTimeout||setTimeout)},function(e){u(function(){t.callback(e)},h._setTimeout||setTimeout)})},r.prototype._getSearchParams=function(e,t){if(void 0===e||null===e)return t;for(var n in e)null!==n&&void 0!==e[n]&&e.hasOwnProperty(n)&&(t+=""===t?"":"&",t+=n+"="+encodeURIComponent("[object Array]"===Object.prototype.toString.call(e[n])?i(e[n]):e[n]));return t},r.prototype._computeRequestHeaders=function(t,n){var r=e(5),o=t?this._ua+";"+t:this._ua,i={"x-algolia-agent":o,"x-algolia-application-id":this.applicationID};return n!==!1&&(i["x-algolia-api-key"]=this.apiKey),this.userToken&&(i["x-algolia-usertoken"]=this.userToken),this.securityTags&&(i["x-algolia-tagfilters"]=this.securityTags),r(this.extraHeaders,function(e,t){i[t]=e}),i},r.prototype.search=function(t,n,r){var o=e(8),i=e(30),s="Usage: client.search(arrayOfQueries[, callback])";if(!o(t))throw new Error(s);"function"==typeof n?(r=n,n={}):void 0===n&&(n={});var a=this,c={requests:i(t,function(e){var t="";return void 0!==e.query&&(t+="query="+encodeURIComponent(e.query)),{indexName:e.indexName,params:a._getSearchParams(e.params,t)}})},u=i(c.requests,function(e,t){return t+"="+encodeURIComponent("/1/indexes/"+encodeURIComponent(e.indexName)+"?"+e.params)}).join("&"),l="/1/indexes/*/queries";return void 0!==n.strategy&&(l+="?strategy="+n.strategy),this._jsonRequest({cache:this.cache,method:"POST",url:l,body:c,hostType:"read",fallback:{method:"GET",url:"/1/indexes/*",body:{params:u}},callback:r})},r.prototype.setSecurityTags=function(e){if("[object Array]"===Object.prototype.toString.call(e)){for(var t=[],n=0;n<e.length;++n)if("[object Array]"===Object.prototype.toString.call(e[n])){for(var r=[],o=0;o<e[n].length;++o)r.push(e[n][o]);t.push("("+r.join(",")+")")}else t.push(e[n]);e=t.join(",")}this.securityTags=e},r.prototype.setUserToken=function(e){this.userToken=e},r.prototype.clearCache=function(){this.cache={}},r.prototype.setRequestTimeout=function(e){e&&(this._timeouts.connect=this._timeouts.read=this._timeouts.write=e)},r.prototype.setTimeouts=function(e){this._timeouts=e},r.prototype.getTimeouts=function(){return this._timeouts},r.prototype._getAppIdData=function(){var e=p.get(this.applicationID);return null!==e&&this._cacheAppIdData(e),e},r.prototype._setAppIdData=function(e){return e.lastChange=(new Date).getTime(),this._cacheAppIdData(e),p.set(this.applicationID,e)},r.prototype._checkAppIdData=function(){var e=this._getAppIdData(),t=(new Date).getTime();return null===e||t-e.lastChange>h?this._resetInitialAppIdData(e):e},r.prototype._resetInitialAppIdData=function(e){var t=e||{};return t.hostIndexes={read:0,write:0},t.timeoutMultiplier=1,t.shuffleResult=t.shuffleResult||s([1,2,3]),this._setAppIdData(t)},r.prototype._cacheAppIdData=function(e){this._hostIndexes=e.hostIndexes,this._timeoutMultiplier=e.timeoutMultiplier,this._shuffleResult=e.shuffleResult},r.prototype._partialAppIdDataUpdate=function(t){var n=e(5),r=this._getAppIdData();return n(t,function(e,t){r[t]=e}),this._setAppIdData(r)},r.prototype._getHostByType=function(e){return this.hosts[e][this._getHostIndexByType(e)]},r.prototype._getTimeoutMultiplier=function(){return this._timeoutMultiplier},r.prototype._getHostIndexByType=function(e){return this._hostIndexes[e]},r.prototype._setHostIndexByType=function(t,n){var r=e(25),o=r(this._hostIndexes);return o[n]=t,this._partialAppIdDataUpdate({hostIndexes:o}),t},r.prototype._incrementHostIndex=function(e){return this._setHostIndexByType((this._getHostIndexByType(e)+1)%this.hosts[e].length,e)},r.prototype._incrementTimeoutMultipler=function(){var e=Math.max(this._timeoutMultiplier+1,4);return this._partialAppIdDataUpdate({timeoutMultiplier:e})},r.prototype._getTimeoutsForRequest=function(e){return{connect:this._timeouts.connect*this._timeoutMultiplier,complete:this._timeouts[e]*this._timeoutMultiplier}}}).call(this,e(12))},{1:1,12:12,18:18,25:25,28:28,29:29,30:30,34:34,5:5,8:8}],16:[function(e,t,n){function r(){s.apply(this,arguments)}function o(e,t,n){function r(n,o){var i={page:n||0,hitsPerPage:t||100},s=o||[];return e(i).then(function(e){var t=e.hits,n=e.nbHits,o=t.map(function(e){return delete e._highlightResult,e}),a=s.concat(o);return a.length<n?r(i.page+1,a):a})}return r().then(function(e){return"function"==typeof n&&n(e),e})}var i=e(7),s=e(18),a=e(26),c=e(27),u=e(29),l=e(28),p=a(function(){},c("forwardToSlaves","forwardToReplicas"));t.exports=r,i(r,s),r.prototype.addObject=function(e,t,n){var r=this;return 1!==arguments.length&&"function"!=typeof t||(n=t,t=void 0),this.as._jsonRequest({method:void 0!==t?"PUT":"POST",url:"/1/indexes/"+encodeURIComponent(r.indexName)+(void 0!==t?"/"+encodeURIComponent(t):""),body:e,hostType:"write",callback:n})},r.prototype.addObjects=function(t,n){var r=e(8),o="Usage: index.addObjects(arrayOfObjects[, callback])";if(!r(t))throw new Error(o);for(var i=this,s={requests:[]},a=0;a<t.length;++a){var c={action:"addObject",body:t[a]};s.requests.push(c)}return this.as._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(i.indexName)+"/batch",body:s,hostType:"write",callback:n})},r.prototype.partialUpdateObject=function(e,t,n){1!==arguments.length&&"function"!=typeof t||(n=t,t=void 0);var r=this,o="/1/indexes/"+encodeURIComponent(r.indexName)+"/"+encodeURIComponent(e.objectID)+"/partial";return t===!1&&(o+="?createIfNotExists=false"),this.as._jsonRequest({method:"POST",url:o,body:e,hostType:"write",callback:n})},r.prototype.partialUpdateObjects=function(t,n,r){1!==arguments.length&&"function"!=typeof n||(r=n,n=!0);var o=e(8),i="Usage: index.partialUpdateObjects(arrayOfObjects[, callback])";if(!o(t))throw new Error(i);for(var s=this,a={requests:[]},c=0;c<t.length;++c){var u={action:n===!0?"partialUpdateObject":"partialUpdateObjectNoCreate",objectID:t[c].objectID,body:t[c]};a.requests.push(u)}return this.as._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(s.indexName)+"/batch",body:a,hostType:"write",callback:r})},r.prototype.saveObject=function(e,t){var n=this;return this.as._jsonRequest({method:"PUT",url:"/1/indexes/"+encodeURIComponent(n.indexName)+"/"+encodeURIComponent(e.objectID),body:e,hostType:"write",callback:t})},r.prototype.saveObjects=function(t,n){var r=e(8),o="Usage: index.saveObjects(arrayOfObjects[, callback])";if(!r(t))throw new Error(o);for(var i=this,s={requests:[]},a=0;a<t.length;++a){var c={action:"updateObject",objectID:t[a].objectID,body:t[a]};s.requests.push(c)}return this.as._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(i.indexName)+"/batch",body:s,hostType:"write",callback:n})},r.prototype.deleteObject=function(e,t){if("function"==typeof e||"string"!=typeof e&&"number"!=typeof e){var n=new l.AlgoliaSearchError("Cannot delete an object without an objectID");return t=e,"function"==typeof t?t(n):this.as._promise.reject(n)}var r=this;return this.as._jsonRequest({method:"DELETE",url:"/1/indexes/"+encodeURIComponent(r.indexName)+"/"+encodeURIComponent(e),hostType:"write",callback:t})},r.prototype.deleteObjects=function(t,n){var r=e(8),o=e(30),i="Usage: index.deleteObjects(arrayOfObjectIDs[, callback])";if(!r(t))throw new Error(i);var s=this,a={requests:o(t,function(e){return{action:"deleteObject",objectID:e,body:{objectID:e}}})};return this.as._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(s.indexName)+"/batch",body:a,hostType:"write",callback:n})},r.prototype.deleteByQuery=a(function(t,n,r){function o(e){if(0===e.nbHits)return e;var t=p(e.hits,function(e){return e.objectID});return d.deleteObjects(t).then(i).then(s)}function i(e){return d.waitTask(e.taskID)}function s(){return d.deleteByQuery(t,n)}function a(){u(function(){r(null)},h._setTimeout||setTimeout)}function c(e){u(function(){r(e)},h._setTimeout||setTimeout)}var l=e(25),p=e(30),d=this,h=d.as;1===arguments.length||"function"==typeof n?(r=n,n={}):n=l(n),n.attributesToRetrieve="objectID",n.hitsPerPage=1e3,n.distinct=!1,this.clearCache();var f=this.search(t,n).then(o);return r?void f.then(a,c):f},c("index.deleteByQuery()","index.deleteBy()")),r.prototype.deleteBy=function(e,t){var n=this;return this.as._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(n.indexName)+"/deleteByQuery",body:{params:n.as._getSearchParams(e,"")},hostType:"write",callback:t})},r.prototype.browseAll=function(t,n){function r(e){if(!a._stopped){var t;t=void 0!==e?{cursor:e}:{params:l},c._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(u.indexName)+"/browse",hostType:"read",body:t,callback:o})}}function o(e,t){if(!a._stopped)return e?void a._error(e):(a._result(t),void 0===t.cursor?void a._end():void r(t.cursor))}"object"==typeof t&&(n=t,t=void 0);var i=e(31),s=e(17),a=new s,c=this.as,u=this,l=c._getSearchParams(i({},n||{},{query:t}),"");return r(),a},r.prototype.ttAdapter=a(function(e){var t=this;return function(n,r,o){var i;i="function"==typeof o?o:r,t.search(n,e,function(e,t){return e?void i(e):void i(t.hits)})}},"ttAdapter is not necessary anymore and will be removed in the next version,\nhave a look at autocomplete.js (https://github.com/algolia/autocomplete.js)"),r.prototype.waitTask=function(e,t){function n(){return l._jsonRequest({method:"GET",hostType:"read",url:"/1/indexes/"+encodeURIComponent(c.indexName)+"/task/"+e}).then(function(e){a++;var t=i*a*a;return t>s&&(t=s),"published"!==e.status?l._promise.delay(t).then(n):e})}function r(e){u(function(){t(null,e)},l._setTimeout||setTimeout)}function o(e){u(function(){t(e)},l._setTimeout||setTimeout)}var i=100,s=5e3,a=0,c=this,l=c.as,p=n();return t?void p.then(r,o):p},r.prototype.clearIndex=function(e){var t=this;return this.as._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(t.indexName)+"/clear",hostType:"write",callback:e})},r.prototype.getSettings=function(e){var t=this;return this.as._jsonRequest({method:"GET",url:"/1/indexes/"+encodeURIComponent(t.indexName)+"/settings?getVersion=2",hostType:"read",callback:e})},r.prototype.searchSynonyms=function(e,t){return"function"==typeof e?(t=e,e={}):void 0===e&&(e={}),this.as._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(this.indexName)+"/synonyms/search",body:e,hostType:"read",callback:t})},r.prototype.exportSynonyms=function(e,t){return o(this.searchSynonyms,e,t)},r.prototype.saveSynonym=function(e,t,n){"function"==typeof t?(n=t,t={}):void 0===t&&(t={}),void 0!==t.forwardToSlaves&&p();var r=t.forwardToSlaves||t.forwardToReplicas?"true":"false";return this.as._jsonRequest({method:"PUT",url:"/1/indexes/"+encodeURIComponent(this.indexName)+"/synonyms/"+encodeURIComponent(e.objectID)+"?forwardToReplicas="+r,body:e,hostType:"write",callback:n})},r.prototype.getSynonym=function(e,t){return this.as._jsonRequest({method:"GET",url:"/1/indexes/"+encodeURIComponent(this.indexName)+"/synonyms/"+encodeURIComponent(e),hostType:"read",callback:t})},r.prototype.deleteSynonym=function(e,t,n){"function"==typeof t?(n=t,t={}):void 0===t&&(t={}),void 0!==t.forwardToSlaves&&p();var r=t.forwardToSlaves||t.forwardToReplicas?"true":"false";return this.as._jsonRequest({method:"DELETE",url:"/1/indexes/"+encodeURIComponent(this.indexName)+"/synonyms/"+encodeURIComponent(e)+"?forwardToReplicas="+r,hostType:"write",callback:n})},r.prototype.clearSynonyms=function(e,t){"function"==typeof e?(t=e,e={}):void 0===e&&(e={}),void 0!==e.forwardToSlaves&&p();var n=e.forwardToSlaves||e.forwardToReplicas?"true":"false";return this.as._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(this.indexName)+"/synonyms/clear?forwardToReplicas="+n,hostType:"write",callback:t})},r.prototype.batchSynonyms=function(e,t,n){"function"==typeof t?(n=t,t={}):void 0===t&&(t={}),void 0!==t.forwardToSlaves&&p();var r=t.forwardToSlaves||t.forwardToReplicas?"true":"false";return this.as._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(this.indexName)+"/synonyms/batch?forwardToReplicas="+r+"&replaceExistingSynonyms="+(t.replaceExistingSynonyms?"true":"false"),hostType:"write",body:e,callback:n})},r.prototype.searchRules=function(e,t){return"function"==typeof e?(t=e,e={}):void 0===e&&(e={}),this.as._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(this.indexName)+"/rules/search",body:e,hostType:"read",callback:t})},r.prototype.exportRules=function(e,t){return o(this.searchRules,e,t)},r.prototype.saveRule=function(e,t,n){"function"==typeof t?(n=t,t={}):void 0===t&&(t={});var r=t.forwardToReplicas===!0?"true":"false";return this.as._jsonRequest({method:"PUT",url:"/1/indexes/"+encodeURIComponent(this.indexName)+"/rules/"+encodeURIComponent(e.objectID)+"?forwardToReplicas="+r,body:e,hostType:"write",callback:n})},r.prototype.getRule=function(e,t){return this.as._jsonRequest({method:"GET",url:"/1/indexes/"+encodeURIComponent(this.indexName)+"/rules/"+encodeURIComponent(e),hostType:"read",callback:t})},r.prototype.deleteRule=function(e,t,n){"function"==typeof t?(n=t,t={}):void 0===t&&(t={});var r=t.forwardToReplicas===!0?"true":"false";return this.as._jsonRequest({method:"DELETE",url:"/1/indexes/"+encodeURIComponent(this.indexName)+"/rules/"+encodeURIComponent(e)+"?forwardToReplicas="+r,hostType:"write",callback:n})},r.prototype.clearRules=function(e,t){"function"==typeof e?(t=e,e={}):void 0===e&&(e={});var n=e.forwardToReplicas===!0?"true":"false";return this.as._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(this.indexName)+"/rules/clear?forwardToReplicas="+n,hostType:"write",callback:t})},r.prototype.batchRules=function(e,t,n){"function"==typeof t?(n=t,t={}):void 0===t&&(t={});var r=t.forwardToReplicas===!0?"true":"false";return this.as._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(this.indexName)+"/rules/batch?forwardToReplicas="+r+"&clearExistingRules="+(t.clearExistingRules===!0?"true":"false"),hostType:"write",body:e,callback:n})},r.prototype.setSettings=function(e,t,n){1!==arguments.length&&"function"!=typeof t||(n=t,t={}),void 0!==t.forwardToSlaves&&p();var r=t.forwardToSlaves||t.forwardToReplicas?"true":"false",o=this;return this.as._jsonRequest({method:"PUT",url:"/1/indexes/"+encodeURIComponent(o.indexName)+"/settings?forwardToReplicas="+r,hostType:"write",body:e,callback:n})},r.prototype.listUserKeys=a(function(e){return this.listApiKeys(e)},c("index.listUserKeys()","index.listApiKeys()")),r.prototype.listApiKeys=function(e){var t=this;return this.as._jsonRequest({method:"GET",url:"/1/indexes/"+encodeURIComponent(t.indexName)+"/keys",hostType:"read",callback:e})},r.prototype.getUserKeyACL=a(function(e,t){return this.getApiKey(e,t)},c("index.getUserKeyACL()","index.getApiKey()")),r.prototype.getApiKey=function(e,t){var n=this;return this.as._jsonRequest({method:"GET",url:"/1/indexes/"+encodeURIComponent(n.indexName)+"/keys/"+e,hostType:"read",callback:t})},r.prototype.deleteUserKey=a(function(e,t){return this.deleteApiKey(e,t)},c("index.deleteUserKey()","index.deleteApiKey()")),r.prototype.deleteApiKey=function(e,t){var n=this;return this.as._jsonRequest({method:"DELETE",url:"/1/indexes/"+encodeURIComponent(n.indexName)+"/keys/"+e,hostType:"write",callback:t})},r.prototype.addUserKey=a(function(e,t,n){return this.addApiKey(e,t,n)},c("index.addUserKey()","index.addApiKey()")),r.prototype.addApiKey=function(t,n,r){var o=e(8),i="Usage: index.addApiKey(arrayOfAcls[, params, callback])";if(!o(t))throw new Error(i);1!==arguments.length&&"function"!=typeof n||(r=n,n=null);var s={acl:t};return n&&(s.validity=n.validity,s.maxQueriesPerIPPerHour=n.maxQueriesPerIPPerHour,s.maxHitsPerQuery=n.maxHitsPerQuery,s.description=n.description,n.queryParameters&&(s.queryParameters=this.as._getSearchParams(n.queryParameters,"")),s.referers=n.referers),this.as._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(this.indexName)+"/keys",body:s,hostType:"write",callback:r})},r.prototype.addUserKeyWithValidity=a(function(e,t,n){return this.addApiKey(e,t,n)},c("index.addUserKeyWithValidity()","index.addApiKey()")),r.prototype.updateUserKey=a(function(e,t,n,r){return this.updateApiKey(e,t,n,r)},c("index.updateUserKey()","index.updateApiKey()")),r.prototype.updateApiKey=function(t,n,r,o){var i=e(8),s="Usage: index.updateApiKey(key, arrayOfAcls[, params, callback])";if(!i(n))throw new Error(s);2!==arguments.length&&"function"!=typeof r||(o=r,r=null);var a={acl:n};return r&&(a.validity=r.validity,a.maxQueriesPerIPPerHour=r.maxQueriesPerIPPerHour,a.maxHitsPerQuery=r.maxHitsPerQuery,a.description=r.description,r.queryParameters&&(a.queryParameters=this.as._getSearchParams(r.queryParameters,"")),a.referers=r.referers),this.as._jsonRequest({method:"PUT",url:"/1/indexes/"+encodeURIComponent(this.indexName)+"/keys/"+t,body:a,hostType:"write",callback:o})}},{17:17,18:18,25:25,26:26,27:27,28:28,29:29,30:30,31:31,7:7,8:8}],17:[function(e,t,n){"use strict";function r(){}t.exports=r;var o=e(7),i=e(4).EventEmitter;o(r,i),r.prototype.stop=function(){this._stopped=!0,this._clean()},r.prototype._end=function(){this.emit("end"),this._clean()},r.prototype._error=function(e){this.emit("error",e),this._clean()},r.prototype._result=function(e){this.emit("result",e)},r.prototype._clean=function(){this.removeAllListeners("stop"),this.removeAllListeners("end"),this.removeAllListeners("error"),this.removeAllListeners("result")}},{4:4,7:7}],18:[function(e,t,n){function r(e,t){this.indexName=t,this.as=e,this.typeAheadArgs=null,this.typeAheadValueOption=null,this.cache={}}var o=e(24),i=e(26),s=e(27);t.exports=r,r.prototype.clearCache=function(){this.cache={}},r.prototype.search=o("query"),r.prototype.similarSearch=o("similarQuery"),r.prototype.browse=function(t,n,r){var o,i,s=e(31),a=this;0===arguments.length||1===arguments.length&&"function"==typeof arguments[0]?(o=0,r=arguments[0],t=void 0):"number"==typeof arguments[0]?(o=arguments[0],"number"==typeof arguments[1]?i=arguments[1]:"function"==typeof arguments[1]&&(r=arguments[1],i=void 0),t=void 0,n=void 0):"object"==typeof arguments[0]?("function"==typeof arguments[1]&&(r=arguments[1]),n=arguments[0],t=void 0):"string"==typeof arguments[0]&&"function"==typeof arguments[1]&&(r=arguments[1],n=void 0),n=s({},n||{},{page:o,hitsPerPage:i,query:t});var c=this.as._getSearchParams(n,"");return this.as._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(a.indexName)+"/browse",body:{params:c},hostType:"read",callback:r})},r.prototype.browseFrom=function(e,t){return this.as._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(this.indexName)+"/browse",body:{cursor:e},hostType:"read",callback:t})},r.prototype.searchForFacetValues=function(t,n){var r=e(25),o=e(32),i="Usage: index.searchForFacetValues({facetName, facetQuery, ...params}[, callback])";if(void 0===t.facetName||void 0===t.facetQuery)throw new Error(i);var s=t.facetName,a=o(r(t),function(e){return"facetName"===e}),c=this.as._getSearchParams(a,"");return this.as._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(this.indexName)+"/facets/"+encodeURIComponent(s)+"/query",hostType:"read",body:{params:c},callback:n})},r.prototype.searchFacet=i(function(e,t){return this.searchForFacetValues(e,t)},s("index.searchFacet(params[, callback])","index.searchForFacetValues(params[, callback])")),r.prototype._search=function(e,t,n,r){return this.as._jsonRequest({cache:this.cache,method:"POST",url:t||"/1/indexes/"+encodeURIComponent(this.indexName)+"/query",body:{params:e},hostType:"read",fallback:{method:"GET",url:"/1/indexes/"+encodeURIComponent(this.indexName),body:{params:e}},callback:n,additionalUA:r})},r.prototype.getObject=function(e,t,n){var r=this;1!==arguments.length&&"function"!=typeof t||(n=t,t=void 0);var o="";if(void 0!==t){o="?attributes=";for(var i=0;i<t.length;++i)0!==i&&(o+=","),o+=t[i]}return this.as._jsonRequest({method:"GET",url:"/1/indexes/"+encodeURIComponent(r.indexName)+"/"+encodeURIComponent(e)+o,hostType:"read",callback:n})},r.prototype.getObjects=function(t,n,r){var o=e(8),i=e(30),s="Usage: index.getObjects(arrayOfObjectIDs[, callback])";if(!o(t))throw new Error(s);var a=this;1!==arguments.length&&"function"!=typeof n||(r=n,n=void 0);var c={requests:i(t,function(e){var t={indexName:a.indexName,objectID:e};return n&&(t.attributesToRetrieve=n.join(",")),t})};return this.as._jsonRequest({method:"POST",url:"/1/indexes/*/objects",hostType:"read",body:c,callback:r})},r.prototype.as=null,r.prototype.indexName=null,r.prototype.typeAheadArgs=null,r.prototype.typeAheadValueOption=null},{24:24,25:25,26:26,27:27,30:30,31:31,32:32,8:8}],19:[function(e,t,n){"use strict";var r=e(14),o=e(20);t.exports=o(r)},{14:14,20:20}],20:[function(e,t,n){(function(n){"use strict";var r=e(6),o=r.Promise||e(3).Promise;t.exports=function(t,i){function s(t,n,r){var o=e(25),i=e(21);return r=o(r||{}),void 0===r.protocol&&(r.protocol=i()),r._ua=r._ua||s.ua,new a(t,n,r)}function a(){t.apply(this,arguments)}var c=e(7),u=e(28),l=e(22),p=e(23),d=e(33);i=i||"","debug"===n.env.NODE_ENV&&e(1).enable("algoliasearch*"),s.version=e(35),s.ua="Algolia for vanilla JavaScript "+i+s.version,s.initPlaces=d(s),r.__algolia={debug:e(1),algoliasearch:s};var h={hasXMLHttpRequest:"XMLHttpRequest"in r,hasXDomainRequest:"XDomainRequest"in r};return h.hasXMLHttpRequest&&(h.cors="withCredentials"in new XMLHttpRequest),c(a,t),a.prototype._request=function(e,t){return new o(function(n,r){function o(){if(!f){clearTimeout(d);var e;try{e={body:JSON.parse(m.responseText),responseText:m.responseText,statusCode:m.status,headers:m.getAllResponseHeaders&&m.getAllResponseHeaders()||{}}}catch(t){e=new u.UnparsableJSON({more:m.responseText})}e instanceof u.UnparsableJSON?r(e):n(e)}}function i(e){f||(clearTimeout(d),r(new u.Network({more:e})))}function s(){f=!0,m.abort(),r(new u.RequestTimeout)}function a(){v=!0,clearTimeout(d),d=setTimeout(s,t.timeouts.complete)}function c(){v||a()}function p(){!v&&m.readyState>1&&a()}if(!h.cors&&!h.hasXDomainRequest)return void r(new u.Network("CORS not supported"));e=l(e,t.headers);var d,f,y=t.body,m=h.cors?new XMLHttpRequest:new XDomainRequest,v=!1;d=setTimeout(s,t.timeouts.connect),m.onprogress=c,"onreadystatechange"in m&&(m.onreadystatechange=p),m.onload=o,m.onerror=i,m instanceof XMLHttpRequest?m.open(t.method,e,!0):m.open(t.method,e),h.cors&&(y&&("POST"===t.method?m.setRequestHeader("content-type","application/x-www-form-urlencoded"):m.setRequestHeader("content-type","application/json")),m.setRequestHeader("accept","application/json")),m.send(y)})},a.prototype._request.fallback=function(e,t){return e=l(e,t.headers),new o(function(n,r){p(e,t,function(e,t){return e?void r(e):void n(t)})})},a.prototype._promise={reject:function(e){return o.reject(e)},resolve:function(e){return o.resolve(e)},delay:function(e){return new o(function(t){setTimeout(t,e)})}},s}}).call(this,e(12))},{1:1,12:12,21:21,22:22,23:23,25:25,28:28,3:3,33:33,35:35,6:6,7:7}],21:[function(e,t,n){"use strict";function r(){var e=window.document.location.protocol;return"http:"!==e&&"https:"!==e&&(e="http:"),e}t.exports=r},{}],22:[function(e,t,n){"use strict";function r(e,t){return e+=/\?/.test(e)?"&":"?",e+o(t)}t.exports=r;var o=e(13)},{13:13}],23:[function(e,t,n){"use strict";function r(e,t,n){function r(){t.debug("JSONP: success"),m||d||(m=!0,p||(t.debug("JSONP: Fail. Script loaded but did not call the callback"),a(),n(new o.JSONPScriptFail)))}function s(){"loaded"!==this.readyState&&"complete"!==this.readyState||r()}function a(){clearTimeout(v),f.onload=null,f.onreadystatechange=null,f.onerror=null,h.removeChild(f)}function c(){try{delete window[y],delete window[y+"_loaded"]}catch(e){window[y]=window[y+"_loaded"]=void 0}}function u(){t.debug("JSONP: Script timeout"),d=!0,a(),n(new o.RequestTimeout)}function l(){t.debug("JSONP: Script error"),m||d||(a(),n(new o.JSONPScriptError))}if("GET"!==t.method)return void n(new Error("Method "+t.method+" "+e+" is not supported by JSONP."));t.debug("JSONP: start");var p=!1,d=!1;i+=1;var h=document.getElementsByTagName("head")[0],f=document.createElement("script"),y="algoliaJSONP_"+i,m=!1;window[y]=function(e){return c(),d?void t.debug("JSONP: Late answer, ignoring"):(p=!0,a(),void n(null,{body:e}))},e+="&callback="+y,t.jsonBody&&t.jsonBody.params&&(e+="&"+t.jsonBody.params);var v=setTimeout(u,t.timeouts.complete);f.onreadystatechange=s,f.onload=r,f.onerror=l,f.async=!0,f.defer=!0,f.src=e,h.appendChild(f)}t.exports=r;var o=e(28),i=0},{28:28}],24:[function(e,t,n){function r(e,t){return function(n,r,i){if("function"==typeof n&&"object"==typeof r||"object"==typeof i)throw new o.AlgoliaSearchError("index.search usage is index.search(query, params, cb)");0===arguments.length||"function"==typeof n?(i=n,n=""):1!==arguments.length&&"function"!=typeof r||(i=r,r=void 0),"object"==typeof n&&null!==n?(r=n,n=void 0):void 0!==n&&null!==n||(n="");var s="";void 0!==n&&(s+=e+"="+encodeURIComponent(n));var a;return void 0!==r&&(r.additionalUA&&(a=r.additionalUA,delete r.additionalUA),s=this.as._getSearchParams(r,s)),this._search(s,t,i,a)}}t.exports=r;var o=e(28)},{28:28}],25:[function(e,t,n){t.exports=function(e){return JSON.parse(JSON.stringify(e))}},{}],26:[function(e,t,n){t.exports=function(e,t){function n(){return r||(console.warn(t),r=!0),e.apply(this,arguments)}var r=!1;return n}},{}],27:[function(e,t,n){t.exports=function(e,t){var n=e.toLowerCase().replace(/[\.\(\)]/g,"");return"algoliasearch: `"+e+"` was replaced by `"+t+"`. Please see https://github.com/algolia/algoliasearch-client-javascript/wiki/Deprecated#"+n}},{}],28:[function(e,t,n){"use strict";function r(t,n){var r=e(5),o=this;"function"==typeof Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):o.stack=(new Error).stack||"Cannot get a stacktrace, browser is too old",this.name="AlgoliaSearchError",this.message=t||"Unknown error",n&&r(n,function(e,t){o[t]=e})}function o(e,t){function n(){var n=Array.prototype.slice.call(arguments,0);"string"!=typeof n[0]&&n.unshift(t),r.apply(this,n),this.name="AlgoliaSearch"+e+"Error"}return i(n,r),n}var i=e(7);i(r,Error),t.exports={AlgoliaSearchError:r,UnparsableJSON:o("UnparsableJSON","Could not parse the incoming response as JSON, see err.more for details"),RequestTimeout:o("RequestTimeout","Request timedout before getting a response"),Network:o("Network","Network issue, see err.more for details"),JSONPScriptFail:o("JSONPScriptFail","<script> was loaded but did not call our provided callback"),JSONPScriptError:o("JSONPScriptError","<script> unable to load due to an `error` event on it"),Unknown:o("Unknown","Unknown error occured")}},{5:5,7:7}],29:[function(e,t,n){t.exports=function(e,t){t(e,0)}},{}],30:[function(e,t,n){var r=e(5);t.exports=function(e,t){var n=[];return r(e,function(r,o){n.push(t(r,o,e))}),n}},{5:5}],31:[function(e,t,n){var r=e(5);t.exports=function o(e){var t=Array.prototype.slice.call(arguments);return r(t,function(t){for(var n in t)t.hasOwnProperty(n)&&("object"==typeof e[n]&&"object"==typeof t[n]?e[n]=o({},e[n],t[n]):void 0!==t[n]&&(e[n]=t[n]))}),e}},{5:5}],32:[function(e,t,n){t.exports=function(t,n){var r=e(10),o=e(5),i={};return o(r(t),function(e){n(e)!==!0&&(i[e]=t[e])}),i}},{10:10,5:5}],33:[function(e,t,n){function r(t){return function(n,r,i){var s=e(25);i=i&&s(i)||{},i.hosts=i.hosts||["places-dsn.algolia.net","places-1.algolianet.com","places-2.algolianet.com","places-3.algolianet.com"],0!==arguments.length&&"object"!=typeof n&&void 0!==n||(n="",r="",i._allowEmptyCredentials=!0);var a=t(n,r,i),c=a.initIndex("places");return c.search=o("query","/1/places/query"),c.getObject=function(e,t){return this.as._jsonRequest({method:"GET",url:"/1/places/"+encodeURIComponent(e),hostType:"read",callback:t})},c}}t.exports=r;var o=e(24)},{24:24,25:25}],34:[function(e,t,n){(function(n){function r(e,t){return c("localStorage failed with",t),s(),a=l,a.get(e)}function o(e,t){return 1===arguments.length?a.get(e):a.set(e,t)}function i(){try{return"localStorage"in n&&null!==n.localStorage&&(n.localStorage[u]||n.localStorage.setItem(u,JSON.stringify({})),!0)}catch(e){return!1}}function s(){try{n.localStorage.removeItem(u)}catch(e){}}var a,c=e(1)("algoliasearch:src/hostIndexState.js"),u="algoliasearch-client-js",l={state:{},set:function(e,t){return this.state[e]=t,this.state[e]},get:function(e){return this.state[e]||null}},p={set:function(e,t){l.set(e,t);try{var o=JSON.parse(n.localStorage[u]);return o[e]=t,n.localStorage[u]=JSON.stringify(o),o[e]}catch(i){return r(e,i)}},get:function(e){try{return JSON.parse(n.localStorage[u])[e]||null}catch(t){return r(e,t)}}};a=i()?p:l,t.exports={get:o,set:o,supportsLocalStorage:i}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1}],35:[function(e,t,n){"use strict";t.exports="3.24.6"},{}]},{},[19])(19)});
define('m_database',['m_firebase', 'algolia'],function( FIREBASE, ALGOLIA ) {
    const _ = {};
    const CONST = {};

    //@< algolia
        var algoliaClient = ALGOLIA('OKSL1FNILG', 'c6cadc6f629b4daf66c5b78e4a9ab343');
        _['algolia'] = algoliaClient;
        // var index = client.initIndex('YourIndex');
    //@> algolia

    // set firebase realtime db framework 
    const Datebase      = FIREBASE.database;
    const Datebase2     = FIREBASE.firestore;
    const fstore        = _;
          window.fstore = fstore;
    window.db2 = Datebase2;


    function getBatchFirestoreDb (iNdb) {
        return iNdb.batch();
    }
    _['getBatchFirestoreDb'] = getBatchFirestoreDb;

    function runBatchFirestoreDb (iNfirestoreBatch, iNfunctions) {
        if(typeof iNfunctions != 'object') iNfunctions = {};
          // Commit the batch
          iNfirestoreBatch.commit().then(function () {
              if(typeof iNfunctions['onSuccess'] == 'function') iNfunctions['onSuccess'] ();
          });
    }
    _['runBatchFirestoreDb'] = runBatchFirestoreDb;

    function getFirestoreDb () {
        return Datebase2();
    }
    _['getFirestoreDb'] = getFirestoreDb;


    function updateRealtimeDb ( iNcollection, iNpath, iNdata ) {
            /*
                @disrc
                    start sendidng flesh msg to firebase db
                @inputs
                    @required
                        iNdata -> object
                            type
                            data
            */
            var baseKey = iNcollection + '/' + iNpath;
            var updateArray = {};
                updateArray[baseKey] = iNdata;
            Datebase().ref().update(updateArray);
    }
    _['updateRealtimeDb'] = updateRealtimeDb;

        function updateFirestoreDb ( iNcollection, iNpath, iNdata, iNfunctions) {
            /*
                @disrc
                    start sendidng flesh msg to firebase db
                @inputs
                    @required
                        iNdata -> object
                            type
                            data
                    @optional
                        iNfunctions -> function
                            onSuccess -> function
                            onError -> function
            */
            if(typeof iNfunctions != 'object') iNfunctions = {};

            var baseKey = iNcollection + '/' + iNpath;

            var docRef = Datebase2().doc(baseKey);
            console.log("updateFirestoreDb baseKey ", baseKey);
            console.log("updateFirestoreDb iNdata ", iNdata);
            // Update the timestamp field with the value from the server
            var updateTimestamp = docRef.update(iNdata).then(function(docRef) {
                console.log("updateFirestoreDb Document written with ID: ", docRef.id);
                if(typeof iNfunctions['onSuccess'] == 'function' ) iNfunctions['onSuccess'](docRef);
            })
            .catch(function(error) {
                console.log(" updateFirestoreDb error", error);
                if(typeof iNfunctions['onError'] == 'function' ) iNfunctions['onError']();
            });
        }
        _['updateFirestoreDb'] = updateFirestoreDb;

        function safeUpdateFirestoreDb ( iNcollection, iNpath, iNdata, iNfunctions , iNdb) {
            /*
                @disrc
                    safe update firestore db
                @inputs
                    @required
                        iNcollection -> string
                        iNpath -> string
                        iNdata -> object
                            type
                            data
                    @optional
                        iNfunctions -> function
                            onSuccess -> function
                            onError -> function
            */
            if(typeof iNfunctions != 'object') iNfunctions = {};

            var baseKey = iNcollection + '/' + iNpath, docRef;

            if ( typeof iNdb != 'undefined')
                docRef = iNdb.doc(baseKey);
            else
                docRef = Datebase2().doc(baseKey);

            console.log('safeUpdateFirestoreDb baseKey, iNdata',baseKey, iNdata);
            // Update the timestamp field with the value from the server
            var updateTimestamp = docRef.set(iNdata,{ merge : true }).then(function(docRef) {
                console.log('safeUpdateFirestoreDb SUCCESS baseKey, docRef',baseKey, docRef);
                if(typeof iNfunctions['onSuccess'] == 'function' ) iNfunctions['onSuccess'](docRef);
            })
            .catch(function(error) {
                console.log('safeUpdateFirestoreDb EROR baseKey, error',baseKey, error);
                if(typeof iNfunctions['onError'] == 'function' ) iNfunctions['onError']();
            });
        }
        _['safeUpdateFirestoreDb'] = safeUpdateFirestoreDb;


    function addRealtimeDb ( iNcollection, iNpath, iNdata ) {
            /*
                @disrc
                    start sendidng flesh msg to firebase db
                @inputs
                    @required
                        iNdata -> object
                            type
                            data
            */
            var baseKey = iNcollection + '/' + iNpath;
            Datebase().ref(baseKey).set(iNdata);
    }
    _['addRealtimeDb'] = addRealtimeDb;

    function addFirestoreDb ( iNcollection, iNpath, iNdata , iNfunctions) {
            /*
                @disrc
                @inputs
                    @required
                        iNdata -> object
                            type
                            data
                    @optional
                        iNfunctions -> function
                            onSuccess -> function
                            onError -> function
            */
            if(typeof iNfunctions != 'object') iNfunctions = {}
            var baseKey = iNcollection + '/' + iNpath,
                ref,
                typeAdd;


            var lengthBaseKey = baseKey.split('/').length;
            console.log('addFirestoreDb baseKey,lengthBaseKey',baseKey,lengthBaseKey );
            if(lengthBaseKey  % 2 == 0) {
                ref = Datebase2().doc(baseKey);
                typeAdd = 'set';
            } else {
                ref = Datebase2().collection(baseKey);
                typeAdd = 'add';
            }


            console.log("addFirestoreDb typeAdd ", typeAdd);
            console.log("addFirestoreDb iNdata ", iNdata);
            return ref[typeAdd](iNdata).then(function(docRef) {
                console.log("addFirestoreDb Document written with ID: ", docRef);
                if(typeof iNfunctions['onSuccess'] == 'function' ) iNfunctions['onSuccess']();
            })
            .catch(function(error) {
                console.log("addFirestoreDb  error", error);
                if(typeof iNfunctions['onError'] == 'function' ) iNfunctions['onError']();
            });
    }
    _['addFirestoreDb'] = addFirestoreDb;


    function getSeverVarTimestamp () {
        return FIREBASE.database.ServerValue.TIMESTAMP ;
    }
    _['getSeverVarTimestamp'] = getSeverVarTimestamp;

    function getFirestoreSeverVarTimestamp () {
        return FIREBASE.firestore.FieldValue.serverTimestamp();
    }
    _['getFirestoreSeverVarTimestamp'] = getFirestoreSeverVarTimestamp;


    function isFirestoreLocalMutation (doc) {
        console.log('isFirestoreLocalMutation doc',doc);
        return doc.et.hasLocalMutations;
    }
    _['isFirestoreLocalMutation'] = isFirestoreLocalMutation;



    function generateIdForRealtimeDbByFullPathToDb (iNcollection,iNpath) {
      var path = iNcollection + '/' + iNpath;
      var generateIdForRealtimeDbByFullPathToDb = Datebase().ref().child(path).push().key;
      return generateIdForRealtimeDbByFullPathToDb;
    }
    _['generateIdForRealtimeDbByFullPathToDb'] = generateIdForRealtimeDbByFullPathToDb;


    function generateIdForFirestoreByFullPathToDb (iNcollection,iNpath) {
      var path = iNcollection + '/' + iNpath;

      console.log('generateIdForFirestoreByFullPathToDb path', path);
      var generateIdForRealtimeDbByFullPathToDb = Datebase2().collection(path).doc();
      return generateIdForRealtimeDbByFullPathToDb.id;
    }
    _['generateIdForFirestoreByFullPathToDb'] = generateIdForFirestoreByFullPathToDb;

    function getDataFromRealtimeDb (iNcollection, iNpath, iNdata) {
        /*
            @inputs
                @required
                    iNcollection    -> string
                    iNpath          -> string
                @optional
                    iNdata -> object
                        limitToLast -> number
                        order       -> array
                        type        -> string
                            all (Default)
                            child_added
                            child_removed
                            child_changed
                            child_moved
                        functionOnSuccess
        */
        if( typeof iNdata != 'object') iNdata = {};
        var path    = iNcollection + '/' + iNpath;
        var ref     = Datebase().ref(path);
        var type    = iNdata['type']||'all';
        var functionOnSuccess   = iNdata['functionOnSuccess']||function(){};
        var functionOnError     = iNdata['functionOnError']||function(){};
        
        if( typeof iNdata['order'] != 'undefined' ) {
            var order = iNdata['order'];
            if ( !Array.isArray(order)  ) order = [order];
            for (var iKey in order ) {
                ref.orderByChild( order[iKey] );
            }
        }

        if( typeof iNdata['limitToLast'] == 'number' ) {
            var limit = iNdata['limitToLast'];
            ref.limitToLast( limit );
        }

        switch (type) {
            case "all": 
                ref.on('value',functionOnSuccess,functionOnError)
            break;
            case "child_added": 
                ref.on('child_added',functionOnSuccess,functionOnError)
            break;
            case "child_removed": 
                ref.on('child_removed',functionOnSuccess,functionOnError)
            break;
            case "child_moved": 
                ref.on('child_moved',functionOnSuccess,functionOnError)
            break;
        }

    }
    _['getDataFromRealtimeDb'] = getDataFromRealtimeDb;

    function getDataFromFirestoreDb (iNcollection,iNpath, iNdata) {
        /*
            @inputs
                @required
                    iNcollection    -> string
                    iNpath          -> string
                @optional
                    iNdata -> object
                        limitToLast -> number
                        order       -> array

                        functionOnGetEmpty 
                        functionOnGetData

        */
         var path    = iNcollection, ref, where, type, counterForTypeDoc = 0;
            if(typeof(iNpath) == 'string' &&  iNpath.length > 0) 
                path = path + '/' +  iNpath;

            if(path.split('/').length % 2 == 0) {
                // its document
                    ref = Datebase2().doc(path);
                    type = 'document';
            } else {
                // its collection
                    ref = Datebase2().collection(path);
                    type = 'collection';
            }
                
        console.log('getRealtimeDataFromFirestoreDb path',path);

        iNdata['where'] = iNdata['where'] || [];

        //@<ORDER
            if( typeof iNdata['order'] != 'undefined' || typeof iNdata['orderByAsc'] != 'undefined') {
                var order = iNdata['order']||iNdata['orderByAsc'];
                if ( !Array.isArray(order)  ) order = [order];
                for (var iKey in order ) {
                    ref = ref.orderBy( order[iKey] );
                }
            }

            if( typeof iNdata['orderByDesc'] != 'undefined' ) {
                var order = iNdata['orderByDesc'];
                if ( !Array.isArray(order)  ) order = [order];
                for (var iKey in order ) {
                    ref = ref.orderBy ( order[iKey] , "desc" );
                }
            }
        //@ORDER>

        //@<WHERE
            console.log( 'whereEquilTo', typeof iNdata['whereEquilTo'] , Array.isArray( iNdata['whereEquilTo'] ) );
            if( typeof iNdata['whereEquilTo'] == 'object' && Array.isArray(iNdata['whereEquilTo']) ) {   // ==
                    where = iNdata['whereEquilTo'];
                    console.log('whereEquilTo', where);
                    for(var iKey in where) {
                        let key     = Object.keys( where[iKey] )[0],
                            value   = where[iKey][key];
                        iNdata['where'].push(
                            {
                                'key'   : key,
                                'value' : value,
                                'mark'  : '==',
                            }
                        );
                    }
                    console.log('whereEquilTo where',iNdata['where']);
            }
            if( typeof iNdata['whereMore'] == 'object' ) {      // ==
                    where = iNdata['whereMore'];
                    for(var iKey in where) {
                        let key     = Object.keys( where[iKey] )[0],
                            value   = where[iKey][key];
                        iNdata['where'].push(
                            {
                                'key'   : key,
                                'value' : value,
                                'mark'  : ">"
                            }
                        );
                    }
            }
            if( typeof iNdata['whereMoreOrEquil'] == 'object' ) { // ==
                    where = iNdata['whereMoreOrEquil'];
                    for(var iKey in where) {
                        let key     = Object.keys( where[iKey] )[0],
                            value   = where[iKey][key];
                        iNdata['where'].push(
                            {
                                'key'   : key,
                                'value' : value,
                                'mark'  : ">="
                            }
                        );
                    }
            }

            if( typeof iNdata['whereLess'] == 'object' ) { // ==
                    where = iNdata['whereLess'];
                    for(var iKey in where) {
                        iNdata['where'].push(
                            {
                                'key'   : iKey,
                                'value' : where[iKey],
                                'mark'  : "<"
                            }
                        );
                    }
            }
            if( typeof iNdata['whereLessOrEquil'] == 'object' ) { // ==
                    where = iNdata['whereLessOrEquil'];
                    for(var iKey in where) {
                        iNdata['where'].push(
                            {
                                'key'   : iKey,
                                'value' : where[iKey],
                                'mark'  : "<="
                            }
                        );
                    }
            }

            //add all
            if( typeof iNdata['where'] == 'object' ) {
                var where = iNdata['where'];
                    console.log("getRealtimeDataFromFirestoreDb where", JSON.stringify(where) );

                for(var iKey in where) {
                    var thisWhere = where[iKey];
                    console.log("getRealtimeDataFromFirestoreDb iNdata['where']",thisWhere['key'], thisWhere['mark'], thisWhere['value'])
                    ref = ref.where(thisWhere['key'], thisWhere['mark'], thisWhere['value'])
                }
            }
        //@WHERE>

        //@<LIMIT
            if( typeof iNdata['limit'] == 'number' ) {
                var limit = iNdata['limit'];
                ref = ref.limit( limit );
            }
                //
                if( typeof iNdata['limitToLast'] == 'number' ) {
                    var limit = iNdata['limitToLast'];
                    ref = ref.orderBy("time", "desc")
                    ref = ref.limit( limit );
                }
                //
                if( typeof iNdata['limitToFirst'] == 'number' ) {
                    var limit = iNdata['limitToFirst'];
                    ref = ref.orderBy("time", "asc")
                    ref = ref.limit( limit );
                }
        //@LIMIT>

        ref.get( 
        (doc) => {
            if(type == 'collection') {
                    // if collection
                    if ( !doc.empty ) {
                        if(typeof iNdata['functionOnGetData'] == 'function') iNdata['functionOnGet'](doc,type);
                    } else {
                        if(typeof iNdata['functionOnGetEmpty'] == 'function') iNdata['functionOnGetEmpty'](type);
                    }
            } else {
                if (doc.exists) {
                    if(typeof iNdata['functionOnGetData'] == 'function') iNdata['functionOnGet']([doc],type);
                } else {
                    if(typeof iNdata['functionOnGetEmpty'] == 'function') iNdata['functionOnGetEmpty'](type);
                }
            }
        });
    }
    _['getDataFromFirestoreDb'] = getDataFromFirestoreDb;
    function getRealtimeDataFromFirestoreDb (iNcollection,iNpath, iNdata) {
        /*
            @inputs
                @required
                    iNcollection    -> string
                    iNpath          -> string
                @optional
                    iNdata -> object
                        limitToLast -> number
                        order       -> array
                        functionOnSuccess
                        functionOnError
                        functionOnDelete
                        functionOnAdd

                        functionOnChange
                        functionOnChangeFromLocal 
                        functionOnChangeFromServer

                        functionOnOther

        */
        var path    = iNcollection, ref, where, type, counterForTypeDoc = 0;
            if(typeof(iNpath) == 'string' &&  iNpath.length > 0) 
                path = path + '/' +  iNpath;

            if(path.split('/').length % 2 == 0) {
                // its document
                    ref = Datebase2().doc(path);
                    type = 'document';
            } else {
                // its collection
                    ref = Datebase2().collection(path);
                    type = 'collection';
            }
                
        console.log('getRealtimeDataFromFirestoreDb path',path);

        iNdata['where'] = iNdata['where'] || [];

        //@<ORDER
            if( typeof iNdata['order'] != 'undefined' || typeof iNdata['orderByAsc'] != 'undefined') {
                var order = iNdata['order']||iNdata['orderByAsc'];
                if ( !Array.isArray(order)  ) order = [order];
                for (var iKey in order ) {
                    ref = ref.orderBy( order[iKey] );
                }
            }

            if( typeof iNdata['orderByDesc'] != 'undefined' ) {
                var order = iNdata['orderByDesc'];
                if ( !Array.isArray(order)  ) order = [order];
                for (var iKey in order ) {
                    ref = ref.orderBy ( order[iKey] , "desc" );
                }
            }
        //@ORDER>

        //@<WHERE
            console.log( 'whereEquilTo', typeof iNdata['whereEquilTo'] , Array.isArray( iNdata['whereEquilTo'] ) );
            if( typeof iNdata['whereEquilTo'] == 'object' && Array.isArray(iNdata['whereEquilTo']) ) {   // ==
                    where = iNdata['whereEquilTo'];
                    console.log('whereEquilTo', where);
                    for(var iKey in where) {
                        let key     = Object.keys( where[iKey] )[0],
                            value   = where[iKey][key];
                        iNdata['where'].push(
                            {
                                'key'   : key,
                                'value' : value,
                                'mark'  : '==',
                            }
                        );
                    }
                    console.log('whereEquilTo where',iNdata['where']);
            }
            if( typeof iNdata['whereMore'] == 'object' ) {      // ==
                    where = iNdata['whereMore'];
                    for(var iKey in where) {
                        let key     = Object.keys( where[iKey] )[0],
                            value   = where[iKey][key];
                        iNdata['where'].push(
                            {
                                'key'   : key,
                                'value' : value,
                                'mark'  : ">"
                            }
                        );
                    }
            }
            if( typeof iNdata['whereMoreOrEquil'] == 'object' ) { // ==
                    where = iNdata['whereMoreOrEquil'];
                    for(var iKey in where) {
                        let key     = Object.keys( where[iKey] )[0],
                            value   = where[iKey][key];
                        iNdata['where'].push(
                            {
                                'key'   : key,
                                'value' : value,
                                'mark'  : ">="
                            }
                        );
                    }
            }

            if( typeof iNdata['whereLess'] == 'object' ) { // ==
                    where = iNdata['whereLess'];
                    for(var iKey in where) {
                        iNdata['where'].push(
                            {
                                'key'   : iKey,
                                'value' : where[iKey],
                                'mark'  : "<"
                            }
                        );
                    }
            }
            if( typeof iNdata['whereLessOrEquil'] == 'object' ) { // ==
                    where = iNdata['whereLessOrEquil'];
                    for(var iKey in where) {
                        iNdata['where'].push(
                            {
                                'key'   : iKey,
                                'value' : where[iKey],
                                'mark'  : "<="
                            }
                        );
                    }
            }

            //add all
            if( typeof iNdata['where'] == 'object' ) {
                var where = iNdata['where'];
                    console.log("getRealtimeDataFromFirestoreDb where", JSON.stringify(where) );

                for(var iKey in where) {
                    var thisWhere = where[iKey];
                    console.log("getRealtimeDataFromFirestoreDb iNdata['where']",thisWhere['key'], thisWhere['mark'], thisWhere['value'])
                    ref = ref.where(thisWhere['key'], thisWhere['mark'], thisWhere['value'])
                }
            }
        //@WHERE>

        //@<LIMIT
            if( typeof iNdata['limit'] == 'number' ) {
                var limit = iNdata['limit'];
                ref = ref.limit( limit );
            }
                //
                if( typeof iNdata['limitToLast'] == 'number' ) {
                    var limit = iNdata['limitToLast'];
                    ref = ref.orderBy("time", "desc")
                    ref = ref.limit( limit );
                }
                //
                if( typeof iNdata['limitToFirst'] == 'number' ) {
                    var limit = iNdata['limitToFirst'];
                    ref = ref.orderBy("time", "asc")
                    ref = ref.limit( limit );
                }
        //@LIMIT>

        ref.onSnapshot( 
        (snapshot) => {
            if(type == 'collection') {
                    if ( snapshot.docChanges.length > 0 )
                        snapshot.docChanges.forEach( function (change) {
                            if (change.type === "added") {
                                if(typeof iNdata['functionOnAdd'] == 'function')
                                    iNdata['functionOnAdd'](change.doc);
                            }
                            if (change.type === "modified") {

                                if(typeof iNdata['functionOnChange'] == 'function')
                                    iNdata['functionOnChange'](change.doc);

                                if(isFirestoreLocalMutation(change.doc)) {
                                    if(typeof iNdata['functionOnChangeFromLocal'] == 'function')
                                        iNdata['functionOnChangeFromLocal'](change.doc);

                                } else { 
                                    if(typeof iNdata['functionOnChangeFromServer'] == 'function')
                                        iNdata['functionOnChangeFromServer'](change.doc);

                                }
                            }
                            if (change.type === "removed") {
                                if(typeof iNdata['functionOnDelete'] == 'function')
                                    iNdata['functionOnDelete'](change.doc);
                            }
                        });
                    else {
                        if(typeof iNdata['functionOnOther'] == 'function')
                            iNdata['functionOnOther'](snapshot);
                    } 
            } else {
                var doc = snapshot;
                if (doc.exists)  {
                    var source = doc.metadata.hasPendingWrites ? "Local" : "Server";

                    if (counterForTypeDoc < 1) {
                        // if firt get add from db
                        if(typeof iNdata['functionOnAdd'] == 'function') iNdata['functionOnAdd']( doc );
                        if (source == 'Local') {
                            // if local add functionOnChangeFromLocal
                            if(typeof iNdata['functionOnAddFromLocal'] == 'function') iNdata['functionOnAddFromLocal']( doc );
                        } else {
                            // if server add functionOnAddFromServer
                            if(typeof iNdata['functionOnAddFromServer'] == 'function') iNdata['functionOnAddFromServer']( doc );
                        }
                    } else {
                        // if we get change 
                        if(typeof iNdata['functionOnChange'] == 'function') iNdata['functionOnChange']( doc );
                        if (source == 'Local') {
                            // if local add functionOnChangeFromLocal
                            if(typeof iNdata['functionOnChangeFromLocal'] == 'function') iNdata['functionOnChangeFromLocal']( doc );
                        } else {
                            // if server add functionOnAddFromServer
                            if(typeof iNdata['functionOnChangeFromServer'] == 'function') iNdata['functionOnChangeFromServer']( doc );
                        }
                    }
                    // increase counter -> we would to recognize difference change and add
                    counterForTypeDoc++;
                }
            }
        });
    }
    _['getRealtimeDataFromFirestoreDb'] = getRealtimeDataFromFirestoreDb;

    function getData (iNcollection, iNpath, iNdata) {
        /*
            @inputs
                @required
                    iNcollection    -> string
                    iNpath          -> string
                @optional
                    iNdata -> object
                        limitToLast -> number
                        order       -> array
                        type        -> string
                            all
                            child_added
                            child_removed
                            child_changed
                            child_moved
                        functionOnSuccess
        */
        if( typeof iNdata != 'object') iNdata = {};
        var path    = iNcollection + '/' + iNpath;
        var ref     = Datebase().ref(path);
        var type    = iNdata['type']||'all';
        var functionOnSuccess   = iNdata['functionOnSuccess']||function(){};
        var functionOnError     = iNdata['functionOnError']||function(){};
        
        if( typeof iNdata['order'] != 'undefined' ) {
            var order = iNdata['order'];
            if ( !Array.isArray(order)  ) order = [order];
            for (var iKey in order ) {
                ref.orderByChild( order[iKey] );
            }
        }

        if( typeof iNdata['limitToLast'] == 'number' ) {
            var limit = iNdata['limitToLast'];
            ref.limitToLast( limit );
        }

        switch (type) {
            case "all": 
                ref.once('value',functionOnSuccess,functionOnError)
            break;
            case "child_added": 
                ref.once('child_added',functionOnSuccess,functionOnError)
            break;
            case "child_removed": 
                ref.once('child_removed',functionOnSuccess,functionOnError)
            break;
            case "child_moved": 
                ref.once('child_moved',functionOnSuccess,functionOnError)
            break;
        }

    }
    _['getData'] = getData;

    return _;
});
define('log',['m_firebase'],function( FIREBASE ) {
  const CONST = {};
  const _ = {};


// window.logState = 0;

function on (){
  window.logState = 1
}
_['on'] = on;

function off () {
  window.logState = 0
}
_['off'] = off;

function checkAccessForLog () {
  if (window.logState) {
    return true;
  }
  return false
}
_['checkAccessForLog'] = checkAccessForLog;


function print (v1,v2,v3,v4,v5,v6,v7,v8) {
  if(!checkAccessForLog()) return false;

  if( typeof v8 != 'undefined' ) {
    console.log(v1,v2,v3,v4,v5,v6,v7,v8);
  } else if (typeof v7 != 'undefined') {
    console.log(v1,v2,v3,v4,v5,v6,v7);
  } else if (typeof v6 != 'undefined') {
    console.log(v1,v2,v3,v4,v5,v6);
  } else if (typeof v5 != 'undefined') {
    console.log(v1,v2,v3,v4,v5);
  } else if (typeof v4 != 'undefined') {
    console.log(v1,v2,v3,v4);
  } else if (typeof v3 != 'undefined') {
    console.log(v1,v2,v3);
  } else if (typeof v2 != 'undefined') {
    console.log(v1,v2);
  } else if (typeof v1 != 'undefined') {
    console.log(v1);
  } else {
    return false;
  }
  return true;
}
_['print'] = print;

function printObject (v1,v2,v3,v4,v5,v6,v7,v8) {

  v1 = JSON.stringify(v1);
  v2 = JSON.stringify(v2);
  v3 = JSON.stringify(v3);
  v4 = JSON.stringify(v4);
  v5 = JSON.stringify(v5);
  v6 = JSON.stringify(v6);
  v7 = JSON.stringify(v7);
  v8 = JSON.stringify(v8);
  return print (v1,v2,v3,v4,v5,v6,v7,v8);
}
_['printObject'] = printObject;


// window.LOG = _;
return _;
});
define(
    'm_message',['jquery', 'v_message', 'm_moment', 'm_user', 'm_app', 'm_category', 'm_storage', 'm_record', 'm_progressbar', 'm_database', 'log', 'url'],
    function($, VIEW, MOMENT, USER, M_APP, M_CATEGORY, M_STORAGE, M_RECORD, M_PROGRESSBAR, M_DATABASE, LOG, M_URL) {
        const _ = {
            'view': VIEW
        };
        const CONST = {
            'var_prefixNewMessageCount': 'connectNewMsgCountInChat-'
        };
        //@< copied functions from app-chat module
        function msg_getCurrentChatId() {
            return M_APP.get('connectThisOpenChatId');
        }
        //@> copied functions from app-chat module
        function annihilateNewMsgCounterFDB(iNchatId) {
            var chatId = iNchatId; //msg_getCurrentChatId();
            var myUID = USER.getMyId();
            let collection = 'chats',
                pathToDb =  chatId + '/member/' + myUID + '/newMsg';
            M_DATABASE.addRealtimeDb ( collection, pathToDb, 0 )
        }

        function safeHideMessagesCountByChatId(iNchatId) {
            var msgCountFromLocaleStorage = getMyNewMessagesCountByChatId(iNchatId);
            if (msgCountFromLocaleStorage > 0) {
                // send query for firebase db for annihilate newMsgCount in chats/$chatId/member/#myUid/newMsgCount
                setMyNewMessagesCountByChatId(iNchatId, 0);
                annihilateNewMsgCounterFDB(iNchatId);
            }
            VIEW.changeNewMsgCounter(iNchatId, 0);
            VIEW.hideNewMsgCounter();
            M_CATEGORY.view.domHideNewMsgCountInChatBlock(iNchatId);
        }


        function safeViewMessagesCountByChatId(iNchatId) {
            VIEW.plusNewMsgCounter(iNchatId, 1);

            let numberNewMsgFromDom = VIEW.getNewMsgCounter(iNchatId);
            M_CATEGORY.view.domChangeNewMsgCountInChatBlock(iNchatId, numberNewMsgFromDom);


            M_CATEGORY.view.domShowNewMsgCountInChatBlock(iNchatId);
            VIEW.showNewMsgCounter();
        }



        function getMyNewMessagesCountByChatId(iNchatId) {
            return parseInt(M_APP.get(CONST['var_prefixNewMessageCount'] + iNchatId)) || 0;
        }
        _['getMyNewMessagesCountByChatId'] = getMyNewMessagesCountByChatId;

        function plusMyNewMessagesCountByChatId(iNchatId) {
            let number = getMyNewMessagesCountByChatId(iNchatId) + 1;
            setMyNewMessagesCountByChatId(iNchatId, number);
        }
        _['plusMyNewMessagesCountByChatId'] = plusMyNewMessagesCountByChatId;

        function setMyNewMessagesCountByChatId(iNchatId, iNnumber) {
            let path = CONST['var_prefixNewMessageCount'] + iNchatId;
            M_APP.save(path, iNnumber);
        }
        _['setMyNewMessagesCountByChatId'] = setMyNewMessagesCountByChatId;



        function synchronizeWithMessageDb(iNchatId, iNobject) {
            /*
                    @inputs
                        @required
                            iNchatId -> string
                        @optional
                            iNobject -> object
                                functionOnChildChanged
                                functionOnChildAdded
                                functionOnChild
                */
            if (typeof iNobject != 'object') iNobject = {};
            M_APP.view.createLoaderInAppView();

            getMessagesFromDb(iNchatId, 'child_added', iNobject);

            // setTimeout(
            //     () => {
            //         let chatId = iNchatId;
            //         getMessagesFromDb(chatId, 'child_changed', iNobject);
            //     },
            //     5000
            // );
        }
        _['synchronizeWithMessageDb'] = synchronizeWithMessageDb;

        function getMessagesFromDb (iNchatId, iNtype, iNobject) {
            /*
                    @inputs
                        @required
                            iNchatId -> string
                            iNtype -> string
                                child_changed || child_added
                        @optional
                            iNobject -> object
                                functionOnChildChanged
                                functionOnChildAdded
                                functionOnChild
                */

            if (typeof iNobject != 'object') iNobject = {};
            LOG.on();

            var iNobject = {
                'limitToFirst' : 40,
                'functionOnAdd':    (messagesData) => {
                    console.log('getMessagesFromDb functionOnAdd',messagesData);
                    callbackAddOrChangeMessageForDb(messagesData, iNchatId, 'child_added', iNobject);
                },//(d) => { console.log('getRealtimeDataFromFirestoreDb functionOnAdd',d);  },
                'functionOnChangeFromServer': (messagesData) => {
                    console.log('getMessagesFromDb functionOnChange',messagesData);
                    callbackAddOrChangeMessageForDb(messagesData, iNchatId, 'child_changed', iNobject);
                },
                'functionOnOther' : () => { 
                    // callbackAddOrChangeMessageForDb({}, iNchatId, 'child_added', iNobject);
                    console.log('functionOnOther')
                    // view chat
                    VIEW.effChatViewScrollToBotWithTimeOut(
                        () => {
                            
                        },
                        () => {
                            
                        }
                    );


                }
            };

            M_DATABASE.getRealtimeDataFromFirestoreDb('chats', iNchatId +'/messages' , iNobject);
        }

        function callbackAddOrChangeMessageForDb(iNdataFromFB, iNchatId, iNtype, iNobject) {
            /*
                @inputs
                    @required
                        iNdataFromFB (result from firebase db)
                        iNchatId -> string
                        iNtype -> string 
                            child_changed || child_added
                        iNobject -> object
                            @optional
                                functionOnChildChanged
                                functionOnChildAdded
            */


            var messagesData = iNdataFromFB;
            var myUID = USER.getMyId();
            var fullData = messagesData.data()||{};//messagesData.val()
            LOG.print('callbackAddOrChangeMessageForDb fullData',fullData);

            var objectForCreateMessage = fullData['info'];
            var msgType = fullData['type'];
            objectForCreateMessage['msgId'] = messagesData.id;//messagesData.key;
            LOG.print('callbackAddOrChangeMessageForDb objectForCreateMessage',objectForCreateMessage);

            // add for simple msg text spy for set read state when we watch this msg
            if (objectForCreateMessage['uid'] != myUID && objectForCreateMessage['type'] == 1) {
                let myStateRead = msgFromMe_getReadTime(fullData, myUID);
                if (myStateRead == 0) {
                    objectForCreateMessage['appearClass'] = true;
                }
            }

            if (typeof iNobject['functionOnChild'] == 'function') iNobject['functionOnChild'](iNchatId);

            getTimeTextForAllMessages(objectForCreateMessage, fullData, iNchatId, myUID);

            if (iNtype == 'child_changed') {
                // replace message in chat container

                if (typeof iNobject['functionOnChildChanged'] == 'function') iNobject['functionOnChildAdded'](iNchatId);

                // VIEW.msgSimpleText_safeReplace( objectForCreateMessage, myUID, iNchatId  );

                VIEW.msg_replaceMsgByItsType(msgType, objectForCreateMessage, myUID, iNchatId)

            } else {
                if (typeof iNobject['functionOnChildAdded'] == 'function') iNobject['functionOnChildAdded'](iNchatId);
                msgSimpleText_safeCreateCenterMessageByPassedTime(objectForCreateMessage, fullData, iNchatId, myUID);


                // create message
                msg_createMsgByItsType ( msgType, fullData, iNchatId, objectForCreateMessage['msgId'] );

                // VIEW.msg_createMsgByItsType(msgType, objectForCreateMessage, myUID, iNchatId)
                // VIEW.msgSimpleText_createMsg ( objectForCreateMessage, myUID, iNchatId );

                VIEW.effChatViewScrollToBotWithTimeOut(
                    () => {
                        if (msg_getCurrentChatId() == iNchatId)
                            safeHideMessagesCountByChatId(iNchatId);
                    },
                    () => {
                        if (msg_getCurrentChatId() == iNchatId)
                            if (objectForCreateMessage['uid'] != myUID)
                                safeViewMessagesCountByChatId(iNchatId);
                    }
                );

                msg_setObserverForAppearMessageInVisualScrollByChatId(iNchatId,msgType);
            } // ser observer for income non read message to me
        }

        function msg_createMsgByItsType (msgType, iNmsgObject, iNchatId, iNmsgId ) {
            // body...
            console.log('msg_createMsgByItsType - msgType, iNmsgObject, iNchatId, iNmsgId',msgType, iNmsgObject, iNchatId, iNmsgId);
            var myUID = USER.getMyId();
            switch (msgType) {
                //@< text messages
                case 1:     // simpleText 
                    msgType = VIEW.msg_getNameOfTypeByType(1);
                    VIEW.msgSimpleText_createMsg( iNmsgObject['info'], myUID, iNchatId );
                break;
                //@> text messages

                //@< live messages
                    case 20:    // liveAudio 
                        msgType = VIEW.msg_getNameOfTypeByType(20);
                        // msgLiveAudio_createMsg( iNobjectForCreateMessage, myUID, iNchatId );
                        if (iNmsgObject['uid'] == myUID) {
                            // if msg from me
                            msgLiveAudio_createFromMe (iNchatId, iNmsgId,  iNmsgObject )
                        } else {
                            // if msg to me
                            msgLiveAudio_createToMe  (iNchatId, iNmsgId,  iNmsgObject );
                        }
                    break;

                    case 21:    // liveVideo
                        msgType = VIEW.msg_getNameOfTypeByType(21);
                        // msgLiveVideo_createMsg( iNobjectForCreateMessage, myUID, iNchatId );
                        // VIEW.msgLiveVideo_safeReplace( iNmsgObject['info'], myUID, iNchatId  );
                        if (iNmsgObject['uid'] == myUID) {
                            // if msg from me
                            msgLiveVideo_createFromMe (iNchatId, iNmsgId,  iNmsgObject )
                        } else {
                            // if msg to me
                            msgLiveVideo_createToMe  (iNchatId, iNmsgId,  iNmsgObject );
                        }
                    break;
                //@> live messages

                //@< file messages
                //@< file messages

                //@< documents messages
                //@< documents messages
            }
        }

        function msg_setObserverForAppearMessageInVisualScrollByChatId(iNchatId, iNMsgType) {
            /*
                @discr
                    set read state when some messages watch in for user
                @inputs
                    @required
                        iNchatId    -> string
                        iNMsgType   -> int
            */
            if(iNMsgType == 1)
                msgSimpleText_setObserverForAppearMessageInVisualScrollByChatId(iNchatId);
        }

        function msgSimpleText_setObserverForAppearMessageInVisualScrollByChatId(iNchatId) {
            let thisSuccessFunction = (iNel) => {
                let element = iNel;
                const chatId = iNchatId;
                //       counter 
                setTimeout(() => {
                    let thisElement = element;
                    var myUID = USER.getMyId();
                    let msgId = VIEW.msg_getDomAttrByNameMsgId(thisElement);
                    msg_setReadState(msgId, chatId, myUID);
                }, 1200);
            };
            VIEW.msgSimpleText_setObserverForViewMsgInVisualScrollByChatId(iNchatId, {
                'success': thisSuccessFunction,
                'onScrollParentFalse': safeHideMessagesCountByChatId
            });
        }
        _['msgSimpleText_setObserverForAppearMessageInVisualScrollByChatId'] = msgSimpleText_setObserverForAppearMessageInVisualScrollByChatId;

        function msgSimpleText_safeCreateCenterMessageByPassedTime(iNobject, iNfullBlock, iNchatId, iNmyUid) {
            if (iNfullBlock.time > 0) {
                msgSimpleText_createCenterDateText(iNchatId, iNfullBlock.time);
            }

        }

        function msgLiveAudio_createFromMe (iNchatId, iNmsgId,  iNmsgObject ) {
            /*
                @discr
                    create liveAudio (from me) message with get M_URL 
                @inputs
                    @required
                        iNchatId    -> string
                        iNmsgId     -> string
                        iNmsgObject -> object
            */
            var msgType     = VIEW.msg_getNameOfTypeByType(iNmsgObject.type),
                thisUserId  = iNmsgObject.uid,
                src         = iNmsgObject.info.src,
                myUID       = USER.getMyId(),
                path = `chats/${iNchatId}/${thisUserId}/${msgType}/${iNmsgId}/${src}`,
                msgForCreateObject  = iNmsgObject['info'];

                // create msg live auio for fix position
                VIEW.msgLiveAudio_safeReplace( msgForCreateObject, myUID, iNchatId  );

            console.log( 'msgLiveAudio_createFromMe - iNchatId, iNmsgId,  iNmsgObject',iNchatId, iNmsgId,  iNmsgObject );
            console.log( 'msgLiveAudio_createFromMe - myUID, src,  thisUserId', myUID, src,  thisUserId );
            console.log( 'msgLiveAudio_createFromMe - msgType, path', msgType, path );
            M_STORAGE.getDownloadURL (path, 
                (errUrl, dataUrl) => {
                    console.log( 'msgLiveAudio_createFromMe - dataUrl', dataUrl );
                    console.log( 'msgLiveAudio_createFromMe - errUrl', errUrl );
                    if (errUrl) {
                        // ERROR we can not get url

                        return;
                    }
                    var url                 = dataUrl;

                    msgForCreateObject['url'] = url;
                    // create msg live auio
                    VIEW.msgLiveAudio_safeReplace( msgForCreateObject, myUID, iNchatId  );

                }
            );
        } _.msgLiveAudio_createFromMe = msgLiveAudio_createFromMe;

        function msgLiveAudio_createToMe (iNchatId, iNmsgId,  iNmsgObject) {
            /*
                @discr
                    create liveAudio (to me) message with get M_URL 
                @inputs
                    @required
                        iNchatId    -> string
                        iNmsgId     -> string
                        iNmsgObject -> object
            */
            var myUID               = USER.getMyId(),
                path                = M_URL.db.api.getUrl.forChat,
                msgForCreateObject  = iNmsgObject['info'];

            // create msg live auio for fix position
            VIEW.msgLiveAudio_safeReplace( msgForCreateObject, myUID, iNchatId  );

            console.log( 'msgLiveAudio_createToMe   - path'     , path  );
            console.log( 'msgLiveAudio_createToMe   - myUID'    , myUID );
            console.log( 'msgLiveAudio_createToMe   - iNmsgObject'     , iNmsgObject  );
            $.getJSON (
                path,
                {
                    'token'     : USER.getMyToken(),
                    'chatId'    : iNchatId,
                    'msgId'     : iNmsgId,
                    'uid'       : myUID,
                },
                (dataFromServer) => {
                    console.log( 'msgLiveAudio_createToMe - dataFromServer', dataFromServer );
                    if(typeof dataFromServer != 'object' || dataFromServer.status != 1) {
                        // ERROR we can not get M_URL
                        return;
                    }
                    var url = dataFromServer.link;
                    console.log( 'msgLiveAudio_createToMe - url', url );
                    console.log( 'msgLiveAudio_createToMe - msgForCreateObject', msgForCreateObject );
                    //attach this url to this object    
                    msgForCreateObject['url'] = url;
                    // create msg live auio
                    VIEW.msgLiveAudio_safeReplace( msgForCreateObject, myUID, iNchatId  );

                } 
            );
        } _.msgLiveAudio_createToMe = msgLiveAudio_createToMe;

        function msgLiveAudio_safeSetReadState () {
            var msgSelectorText = msg_getPathToDomForMsg (  iNchatId, iNmsgId );
                    var myUID = USER.getMyId();
            msg_getDomAttrByNameMessageTimeSent (msgSelectorText);


                    let thisElement = element;
                    var myUID = USER.getMyId();
                    var chatId = msg_getCurrentChatId();
                    let msgId = VIEW.msg_getDomAttrByNameMsgId(thisElement);
                    msg_setReadState(msgId, chatId, myUID);
        }


        function getTimeTextForAllMessages(iNobject, iNfullBlock, iNchatId, iNmyUid) {
            // for firestore db get timestamp

            // get time stamp (if message only send from me we get know time -> we get now time)
            iNfullBlock.time =  ( ( iNfullBlock.time ) ? iNfullBlock.time.getTime() : new Date().getTime() );
            if (iNfullBlock.time > 0) {
                // create time text for sent messages for add to dom by template
                iNobject.timeSentText   = MOMENT().getTimeMiniText( iNfullBlock.time );
                iNobject.timeSent       = iNfullBlock.time;
            }
            if (iNobject['uid'] != iNmyUid) {
                // this is message to me (i've not create it) -> we get for
                getTimeForToMeMessages(iNobject, iNfullBlock, iNchatId, iNmyUid)
            } else {
                // this is message from me
                getTimeForFromMeMessages(iNobject)
            }
        }

        function getTimeForToMeMessages ( iNobject, iNfullBlock, iNchatId, iNmyUid ) {
            /*
                @inputs
                    @required
                        iNobject    -> object
                        iNfullBlock -> object
                        iNchatId    -> string
                        iNmyUid     -> string
            */
            //get status by timestamp read,delivered,sent
            var myState = msgFromMe_getTimesOfState(iNfullBlock, iNmyUid);
            console.log ( 'getTimeForToMeMessages myState',       myState     );
            console.log ( 'getTimeForToMeMessages iNfullBlock',   iNfullBlock );
            console.log ( 'getTimeForToMeMessages iNmyUid',       iNmyUid     );
            if ( typeof myState == 'object' ) {
                var states = myState;
                console.log('timestamp states',states);
                if ( typeof states.read == 'object'  && states.read) { // states.read > 0
                    console.log('timestamp states.read',states.read);
                    // states.read = states.read.getTime(); // for firestore

                    iNobject.timeReadText = MOMENT().getTimeMiniText(states.read.getTime());
                    iNobject.timeRead = states.read.getTime();
                }
                if ( typeof states.delivered == 'object'  && states.delivered  ) { // states.delivered > 0
                    // states.delivered = states.delivered.getTime(); // for firestore


                    iNobject.timeDeliveredText = MOMENT().getTimeMiniText(states.delivered.getTime());
                    iNobject.timeDelivered = states.delivered.getTime();
                } else {
                    setTimeout(() => {
                        let thisObj = iNobject;
                        console.log('getTimeForToMeMessages msg_setDeliveredState',thisObj['msgId'], iNchatId, iNmyUid);
                        // delay for stock
                        msg_setDeliveredState(thisObj['msgId'], iNchatId, iNmyUid);
                    }, 1000);
                }
            }
        }

        function getTimeForFromMeMessages(iNobject) {
            //get status by timestamp read,delivered,sent
            if (typeof iNobject.state == 'object') {
                var states = iNobject.state;
                if (states.read && typeof states.read == 'object' && states.read.getTime() > 0) {
                    iNobject.timeReadText = MOMENT().getTimeMiniText(states.read.getTime());
                    iNobject.timeRead = states.read.getTime();
                }
                if ( states.delivered && typeof states.delivered == 'object' && states.delivered.getTime() > 0 ) {
                    iNobject.timeDeliveredText = MOMENT().getTimeMiniText(states.delivered.getTime());
                    iNobject.timeDelivered = states.delivered.getTime();
                }
            }
        }


        function getMySateStatusFromMsg(iNobject, myUID) {
            var thisStateObject = msgFromMe_getTimesOfState(iNobject, myUID);
            if (typeof thisStateObject['status'] == 'number')
                return thisStateObject['status'];
            return 0;
        }

        function msgFromMe_getReadTime(iNobject, myUID) {
            var thisStateObject = msgFromMe_getTimesOfState(iNobject, myUID);
            console.log('msgFromMe_getReadTime thisStateObject',thisStateObject);
            if (typeof thisStateObject['read'] == 'object' && thisStateObject['read'] != null && typeof thisStateObject['read'].getTime == 'function')
                return thisStateObject['read'].getTime();
            return 0;
        }

        function getMyStateDeliveredFromMsg(iNobject, myUID) {
            var thisStateObject = msgFromMe_getTimesOfState(iNobject, myUID);
            if (typeof thisStateObject['delivered'] == 'object' && thisStateObject['delivered'] != null && thisStateObject['delivered'] == 'function')
                return thisStateObject['delivered'].getTime();
            return 0;
        }

        function msgFromMe_getTimesOfState(iNobject, myUID) {
            if (typeof iNobject == 'object')
                if (typeof iNobject['member'] == 'object')
                    if (typeof iNobject['member'][myUID] == 'object')
                        if (typeof iNobject['member'][myUID]['state'] == 'object')
                            return iNobject['member'][myUID]['state'];
            return {};//false
        }

        function msgSimpleText_flashSending (iNchatId) {
            /*
                @disrc
                    start sendidng flesh msg to firebase db
                @inputs
                    @required
                        iNdata -> object
                            type
                            data
            */
            objForSendToDb = {
                'data': VIEW.getContentLengthFromMsgSenderBlock(),
                'type': 1
            };
            msg_flashSending(objForSendToDb,iNchatId)
        }
        _['msgSimpleText_flashSending'] = msgSimpleText_flashSending;

            function msg_flashSending (iNdata, iNchatId) {
            /*
                @disrc
                    start sendidng flesh msg to firebase db
                @inputs
                    @required
                        iNdata -> object
                            type
                            data
            */
            var chatId = iNchatId||msg_getCurrentChatId();
            var myUID = USER.getMyId();
            var objForSendToDb = {
                'data'  : iNdata['data'],
                'uid'   : iNdata['uid']||myUID,
                'time'  : M_DATABASE.getSeverVarTimestamp(),
                'type'  : iNdata['type']
            }

            let objForSafeUpdate = {
                'info' : {
                    'live' : objForSendToDb
                }
            };
            M_DATABASE.safeUpdateFirestoreDb ( 'chats', chatId, objForSafeUpdate );

        }
        _['msg_flashSending'] = msg_flashSending;

        function msg_setReadState(iNmsgId, iNchatId, myUID) {


            // var firestoreKey = 'member.' + myUID + '.state' + '.read';
            // var fsUpdateObg = {};
            //     fsUpdateObg[firestoreKey] = M_DATABASE.getFirestoreSeverVarTimestamp();
            // M_DATABASE.updateFirestoreDb ( 'chats' , iNchatId + '/messages/' + iNmsgId, fsUpdateObg);

            // let objForSafeUpdate = { 'member' : {} };
            //     objForSafeUpdate [ 'member' ][ myUID ] = {
            //         'state' : {
            //             'read' : M_DATABASE.getFirestoreSeverVarTimestamp()
            //         }
            //     }
            // M_DATABASE.safeUpdateFirestoreDb ( 'chats', iNchatId + '/messages/'+iNmsgId, objForSafeUpdate );
            msg_stateAddToQueue ('read',myUID , iNchatId, iNmsgId);
        }


        function msg_stateAddToQueue (iNstateKey,iNmyUid , iNchatId, iNmsgId) {
            // body...
            if(
                typeof iNstateKey   != 'string'   ||
                typeof iNmyUid      != 'string'   ||
                typeof iNchatId     != 'string'   ||
                typeof iNmsgId      != 'string'
            ) return true;

            if(typeof window['connecVar_storageForMsgState'] != 'object')
                window['connecVar_storageForMsgState'] = {};

            if(typeof window['connecVar_storageForMsgState'][iNchatId] != 'object')
                window['connecVar_storageForMsgState'][iNchatId] = {};

            if(typeof window['connecVar_storageForMsgState'][iNchatId][iNmsgId] != 'object')
                window['connecVar_storageForMsgState'][iNchatId][iNmsgId]  = { };

            if(typeof window['connecVar_storageForMsgState'][iNchatId][iNmsgId]['member'] != 'object')
                window['connecVar_storageForMsgState'][iNchatId][iNmsgId]['member']  = {};


            if(typeof window['connecVar_storageForMsgState'][iNchatId][iNmsgId]['member'][iNmyUid] != 'object')
                window['connecVar_storageForMsgState'][iNchatId][iNmsgId]['member'][iNmyUid]  = { 'state':{} };

            window['connecVar_storageForMsgState'][iNchatId][iNmsgId]['member'][iNmyUid]['state'][iNstateKey] = M_DATABASE.getFirestoreSeverVarTimestamp()

            // start to add state
            msg_stateSendToDb (iNchatId, iNmsgId, iNmyUid);
        }
        _['msg_stateAddToQueue'] = msg_stateAddToQueue;

        function msg_stateSendToDb (iNchatId, iNmsgId, iNmyUid) {
            // get timeout id
            var timeoutId = window['connecVar_timeoutId_storageForMsgState'];
            // clear timeout id
            clearTimeout(window['connecVar_timeoutId_storageForMsgState']);

            window['connecVar_timeoutId_storageForMsgState'] = setTimeout (
                function () {
                    var connecVar_storageForMsgState = window['connecVar_storageForMsgState'];
                    var dataForCheck, dateForAddLength, dataForUpdate;
                    const firestoreDb       = M_DATABASE.getFirestoreDb();
                    const firestoreBatch    = M_DATABASE.getBatchFirestoreDb (firestoreDb );
                    
                    for (var chatId in connecVar_storageForMsgState) {
                        try {
                            // for check for prepare operations
                            dataForCheck        = window['connecVar_storageForMsgState'][iNchatId][iNmsgId]['member'][iNmyUid]['state'];
                            // for add to Queue
                            dataForUpdate       = window['connecVar_storageForMsgState'][iNchatId][iNmsgId];
                            // get length for last check for update to msg in db
                            dateForAddLength    = Object.keys(dataForCheck).length;
                            if ( dateForAddLength > 0 ) {

                                console.log('add to batch', 'chats', iNchatId + '/messages/' + iNmsgId, dataForUpdate);
                                // add to queqe
                                M_DATABASE.safeUpdateFirestoreDb ( 'chats', iNchatId + '/messages/' + iNmsgId, dataForUpdate, {} , firestoreDb)
                            }
                        } catch (e) {
                            continue;
                        }
                    }

                    console.log('start batch operations');
                    //run batch (start write operations)
                    M_DATABASE.runBatchFirestoreDb (
                        firestoreBatch,
                        {
                            'onSuccess' : () => { console.log('msg_stateSendToDb added to db',window['connecVar_storageForMsgState']); window['connecVar_storageForMsgState'] = {}; }
                        }
                    );
                }, 250
            );

            // clear timeout id

            
        }

        function msg_setDeliveredState (iNmsgId, iNchatId, myUID) {

            // let collection = 'messages',
            //     pathToDb = iNchatId + '/' + iNmsgId + '/member/' + myUID + '/state' + '/delivered';
            // M_DATABASE.addRealtimeDb ( collection, pathToDb, M_DATABASE.getSeverVarTimestamp() )


            // var firestoreKey = 'member.' + myUID + '.state' + '.delivered';
            // var fsUpdateObg = {};
            //     fsUpdateObg[firestoreKey] = M_DATABASE.getFirestoreSeverVarTimestamp();
            // M_DATABASE.updateFirestoreDb ( 'chats' , iNchatId + '/messages/' + iNmsgId, fsUpdateObg);
            ///// M_DATABASE.addFirestoreDb( collection, pathToDb, M_DATABASE.getFirestoreSeverVarTimestamp() )


            // let objForSafeUpdate = {
            //     'member' : {}
            // };
            //     objForSafeUpdate [ 'member' ][ myUID ] = {
            //         'state' : {
            //             'delivered' : M_DATABASE.getFirestoreSeverVarTimestamp()
            //         }
            //     }
            // M_DATABASE.safeUpdateFirestoreDb ( 'chats', iNchatId + '/messages/'+iNmsgId, objForSafeUpdate );


            msg_stateAddToQueue ('delivered',myUID , iNchatId, iNmsgId);
        }

        function msg_addToDb (iNdata, iNchatId, iNmsgId) {
            /*
        @discr
            send msg to firebase realtime db
        @inputs
            @required
                1 - iNdata
                    @required
                        content
                    @optional
                        src
                        block
                        fire
                        group
                        type

                        msgId
                2 - iNchatId
        @return
            result form Firebse update

      */
            //default message type
            iNdata.type = iNdata.type || 1;


            // get my user id
            let myUid = USER.getMyId();//FIREBASE.auth().currentUser.uid;
            // get right object for add to msg db
            let objForSentToDb = prepareObjectForSentToMsgBase(iNdata, myUid);

            let collection  = 'messages', pathToDb, msgId;

                msgId       = iNmsgId || msg_generateMsgIdByChatId(iNchatId);
                collection  = 'chats';

            pathToDb = iNchatId + '/messages/' + msgId;
            M_DATABASE.addFirestoreDb ( collection, pathToDb, objForSentToDb );


        }
        _['msg_addToDb'] = msg_addToDb;

        function msg_generateMsgIdByChatId(iNchatId) {
            let collection = 'chats';
            // return M_DATABASE.generateIdForRealtimeDbByFullPathToDb(collection, iNchatId);
            let patch = iNchatId + '/' + 'messages';
            return M_DATABASE.generateIdForFirestoreByFullPathToDb(collection, patch);
        }

        function prepareObjectForSentToMsgBase(iNdata, iNmyUid) {
            /*
                @discr
                    return object for base
                @inputs
                @required
                    1 - iNdata
                        @required
                            content
                        @optional
                            src
                            block
                            fire
                            group
                            type
                    2 - iNmyUid
            */
            var timeStamp = M_DATABASE.getFirestoreSeverVarTimestamp(); // getSeverVarTimestamp();
            var objForSentToDb = {
                'info': {
                    'options': {
                        'base': {}
                    },
                    'state': {
                        'sent': timeStamp
                    },
                    'content': iNdata['content'],
                },
                'time': timeStamp,
                'status': 1,
                'type': iNdata.type,
                'uid': iNmyUid
            };

            if (typeof(iNdata.type) != 'undefined') objForSentToDb['info']['type'] = iNdata.type; // default text key
            if (typeof(iNdata.src) == 'string') objForSentToDb['info']['src'] = iNdata.src; // source for messages with files



            if (typeof(iNdata.block) == 'undefined') objForSentToDb['info']['options']['base']['block'] = 0; // default block disable
            if (typeof(iNdata.fire) == 'undefined') objForSentToDb['info']['options']['base']['fire'] = 0; // default fire disable
            if (typeof(iNdata.group) == 'undefined') objForSentToDb['info']['options']['base']['group'] = 0; // default group dissable
            if (typeof(iNmyUid) != 'undefined') {
                objForSentToDb['uid'] = iNmyUid; // default group dissable
                objForSentToDb['info']['uid'] = iNmyUid;
            }
            return objForSentToDb;
        }

        function updateChatLastMsgObject (iNobject, iNchatId) {
            /*
                @discr
                    update last msg block in chat db for show in list menus for all users 
                @inputs
                    @required
                        iNobject
                            info
                                content
                                typw
                            uid
            */
            var timeStamp = M_DATABASE.getSeverVarTimestamp();
            // var updates = {};
            var lastMessage = {
                content: iNobject['info']['content'],
                time: timeStamp,
                type: iNobject['info']['type'],
                uid: iNobject['uid']
            };
            // updates['/chats/info/' + iNchatId + '/msg'] = lastMessage;
            // return FIREBASE.database().ref().update(updates);

            let collection = 'chats',
                pathToDb =  'info/' + iNchatId + '/msg';
            return M_DATABASE.addRealtimeDb ( collection, pathToDb, lastMessage );
        }

        function msgSimpleText_createCenterDateText (iNchatId, iNtime) {
            var lastMsgTimeText = getLastMsgTimeByChatId(iNchatId);
            var lastMsgTime = parseInt(lastMsgTimeText);
            var isThisDay = MOMENT().isThisDay(iNtime);
            var nowTime = MOMENT().getNowTime();
            if ((typeof lastMsgTime != 'number' || lastMsgTime < 1) || (MOMENT().getDayNumberByTime(lastMsgTime) != MOMENT().getDayNumberByTime(iNtime))) {
                // if first && if is not this day || or new date && if is not this day 
                setLastMsgTimeByChatId(iNchatId, iNtime);
                var objForChat = {};

                if (isThisDay) {
                    //change set today from dictionary
                    objForChat['content'] = MOMENT().getWeekDayText(iNtime);
                } else if (MOMENT().isThisWeek(iNtime)) {
                    objForChat['content'] = MOMENT().getWeekDayText(iNtime);
                } else {
                    objForChat['content'] = MOMENT().getFullText(iNtime);
                }
                VIEW.msgSimpleText_addCenter(objForChat, iNchatId);
            }
        }

        function setLastMsgTimeByChatId(iNchatId, iNtime) {
            return M_APP.save('connectLastMsgChatId_' + iNchatId, iNtime);
        }
        _['setLastMsgTimeByChatId'] = setLastMsgTimeByChatId;


        function getLastMsgTimeByChatId(iNchatId) {
            return M_APP.get('connectLastMsgChatId_' + iNchatId);
        }
        // _['getLastMsgTimeByChatId'] = getLastMsgTimeByChatId;

        //onClick events
        function simpleMsgText_onClickSendBtn (e) {
            var chatId = msg_getCurrentChatId();
            var data = {
                'content': VIEW.getContentFromMsgSenderBlock()
            };
            M_APP.playSound('https://cdn.ramman.net/audio/effects/sendMessage.mp3'); //CHANGE do Const
            msg_addToDb(data, chatId);
        }
        _['simpleMsgText_onClickSendBtn'] = simpleMsgText_onClickSendBtn;
        //

    //
        function getDownloadUrl (argument) {
            // body...
        }
    //

    //@<SECTION 'msg live video' type = 21
        function msgLiveVideo_createFromMe (iNchatId, iNmsgId,  iNmsgObject ) {
            /*
                @discr
                    create liveAudio (from me) message with get M_URL 
                @inputs
                    @required
                        iNchatId    -> string
                        iNmsgId     -> string
                        iNmsgObject -> object
            */
            var msgType             = VIEW.msg_getNameOfTypeByType(iNmsgObject.type),
                thisUserId          = iNmsgObject.uid,
                src                 = iNmsgObject.info.src,
                myUID               = USER.getMyId(),
                path                = `chats/${iNchatId}/${thisUserId}/${msgType}/${iNmsgId}/${src}`,
                msgForCreateObject  = iNmsgObject['info'];

            // create msg live auio for fix position
                VIEW.msgLiveVideo_safeReplace( msgForCreateObject, myUID, iNchatId  );

            console.log( 'msgLiveVideo_createFromMe - iNchatId, iNmsgId,  iNmsgObject',iNchatId, iNmsgId,  iNmsgObject );
            console.log( 'msgLiveVideo_createFromMe - myUID, src,  thisUserId', myUID, src,  thisUserId );
            console.log( 'msgLiveVideo_createFromMe - msgType, path', msgType, path );
            M_STORAGE.getDownloadURL (path, 
                (errUrl, dataUrl) => {
                    console.log( 'msgLiveVideo_createFromMe - dataUrl', dataUrl );
                    console.log( 'msgLiveVideo_createFromMe - errUrl', errUrl );
                    if (errUrl) {
                        // ERROR we can not get url

                        return;
                    }
                    var url                 = dataUrl;

                    msgForCreateObject['url'] = url;
                    // create msg live auio
                    VIEW.msgLiveVideo_safeReplace( msgForCreateObject, myUID, iNchatId  );

                }
            );
        } _.msgLiveVideo_createFromMe = msgLiveVideo_createFromMe;

        function msgLiveVideo_createToMe (iNchatId, iNmsgId,  iNmsgObject) {
            /*
                @discr
                    create liveVideo (to me) message with get M_URL 
                @inputs
                    @required
                        iNchatId    -> string
                        iNmsgId     -> string
                        iNmsgObject -> object
            */
            var myUID               = USER.getMyId(),
                path                = M_URL.db.api.getUrl.forChat,
                msgForCreateObject  = iNmsgObject['info'];

            // create msg live auio for fix position
                VIEW.msgLiveVideo_safeReplace( msgForCreateObject, myUID, iNchatId  );

            console.log( 'msgLiveVideo_createToMe   - path'     , path  );
            console.log( 'msgLiveVideo_createToMe   - myUID'    , myUID );
            console.log( 'msgLiveVideo_createToMe   - iNmsgObject'     , iNmsgObject  );
            $.getJSON (
                path,
                {
                    'token'     : USER.getMyToken(),
                    'chatId'    : iNchatId,
                    'msgId'     : iNmsgId,
                    'uid'       : myUID,
                },
                (dataFromServer) => {
                    console.log( 'msgLiveVideo_createToMe - dataFromServer', dataFromServer );
                    if(typeof dataFromServer != 'object' || dataFromServer.status != 1) {
                        // ERROR we can not get M_URL
                        return;
                    }
                    var url = dataFromServer.link;
                    console.log( 'msgLiveVideo_createToMe - url', url );
                    console.log( 'msgLiveVideo_createToMe - msgForCreateObject', msgForCreateObject );
                    //attach this url to this object    
                    msgForCreateObject['url'] = url;
                    // create msg live auio
                    VIEW.msgLiveVideo_safeReplace( msgForCreateObject, myUID, iNchatId  );

                } 
            );
        } _.msgLiveVideo_createToMe = msgLiveVideo_createToMe;

        function msgLiveVideo_onEventPlayVideo (iNthis) {
            /*
                @discr
                    for video '.liveVideoSrc' event onplay video -> we change btn pause TO play (adding class)
                      
                @inputs
                    @required
                        iNthis -> object (this)
            */
            // pause all other now playing video and audio 
            VIEW.msg_pauseAllOtherPlayingAudioOrVideoEl();

            // safe set read state
            msgLiveVideo_safeSetReadState(iNthis);

            let backElement = $(iNthis).closest('.aCpI_msgLiveVideo_videoMsgContent').find('.aCpI_msgLiveVideo_backgroundVideoOnHover');
            // delete
            $(backElement).removeClass('aCpI_msgLiveVideo_backgroundPlayVideoOnHover').addClass('aCpI_msgLiveVideo_backgroundPauseVideoOnHover')

            // add flag by addClass 'flagForSearchPlayingAudioOrVideo' && 'flagForSearchPlayingLiveVideo'
            VIEW.msgLiveVideo_addPlayingFlags (iNthis);
        }
        window.aCpI_msgLiveVideo_onEventPlayVideo = msgLiveVideo_onEventPlayVideo; 

        function msgLiveVideo_safeSetReadState (iNobject) {
            //@< add read state for to me message if it need
                var msgParentBlock = $(iNobject).closest('.msgTypeLiveVideo');
                if( msgParentBlock.hasClass('toMeMessageInChatView') && VIEW.msg_getDomAttrByNameMessageTimeRead(msgParentBlock) < 1 ) {
                    // 
                    var chatId  = msg_getCurrentChatId();
                    var myUID   = USER.getMyId();
                    let msgId   = VIEW.msg_getDomAttrByNameMsgId(msgParentBlock);
                    msg_setReadState(msgId, chatId, myUID);
                }
            //@> add read state for to me message if it need
        }

        function msgLiveVideo_flashSending (iNsecond,iNchatId) {
            /*
                @disrc
                    start sendidng flesh msg to firebase db
                @inputs
                    @required
                        iNdata -> object
                            type
                            data
            */
            objForSendToDb = {
                'data': iNsecond,
                'type': 21
            };
            msg_flashSending(objForSendToDb,iNchatId)
        }
        _['msgLiveVideo_flashSending'] = msgLiveVideo_flashSending;

        function msgLiveVideo_getDownloadUrl () {
            let path = ''
        }
            function msgLiveVideo_getUploadUrl (iNuid,iN) {
                let path = ''
            }

        function msgLiveVideo_createMsgFromMe (iNsrc, iNmyUid, iNchatId, iNmsgId) {
            var iNdata = {};
            iNdata['url']       = iNsrc;
            iNdata['content']   = '';
            iNdata['uid']       = iNmyUid;
            iNdata['msgId']     = iNmsgId;
            // create message element
            VIEW.msgLiveVideo_createMsg(iNdata, iNmyUid, iNchatId);
            // scroll to bot
            VIEW.effChatViewScrollToBotWithTimeOut();
        }

        function msgLiveVideo_sendMsgFromMe (iNsrc, iNchatId, iNmsgId) {
            var iNdata      = {
                'src'       : iNsrc ,
                'content'   : ''    ,
                'type'      : 21
            };
            // add to database
            msg_addToDb(iNdata, iNchatId, iNmsgId)
        }
        //

        //@< COTROLLER msgLiveVideo
        function controller_msgLiveVideo_record_sendVideoToStorage(iNerror, iNblob, iNdata) {
            var blobUrl = URL.createObjectURL(iNblob),
                iNmyUid = USER.getMyId(),
                iNchatId = msg_getCurrentChatId(iNchatId),
                iNmsgId = msg_generateMsgIdByChatId(iNchatId);

            // create message without load to db
            msgLiveVideo_createMsgFromMe(blobUrl, iNmyUid, iNchatId, iNmsgId);


            // upload audio file
            var functionUploadBlob = () => {
                // init loader
                var progressBar     = VIEW.msgLiveVideo_initLoader(iNchatId, iNmsgId);
                var file = '1.webm';
                var pathForSaveFile = 'chats/'+iNchatId+'/'+iNmyUid+'/liveVideo/'+iNmsgId+'/' + file;
                M_STORAGE.uploadBlob(
                    iNblob, {
                        'pathForSaveFile': pathForSaveFile,
                        'mimeType': 'video/webm'
                    }, {
                        'onSuccess': (iNdownloadURL) => {
                            // hide uploader block
                            VIEW.msgLiveVideo_hideUploadBlock(iNchatId, iNmsgId);

                            // send message to uplload
                            msgLiveVideo_sendMsgFromMe(file, iNchatId, iNmsgId);
                        },
                        'onProgress': (iNprogress) => {
                            let progress = iNprogress / 100;

                            // set progres for uploading progress bar
                            progressBar.to(progress);
                        },
                        'onError': (iNerror) => {
                            // hide progress bar -> we need show progress bar
                            console.log('msgLiveVideo_showUploadBtn iNerror');
                            VIEW.msgLiveVideo_showUploadBtn(iNchatId, iNmsgId);
                        },
                    }
                );
            }

            VIEW.msgLiveVideo_setObserverForUploadBtn (iNchatId,iNmsgId,
                () => {
                    console.log('msgLiveVideo_setObserverForUploadBtn start');
                    functionUploadBlob();
                }
            );

            functionUploadBlob();
        }

        function controller_msgLiveVideo_record_run() {
            var flagPermissionForLiveVideoRecord = false,
                flagBoolStartedLoaded = false,
                mediationObjectLiveVideoRecorderObject,
                mediationObjectLiveVideoStreamObject;

            var specialClickObject = VIEW.onSpecialClickForSendLiveAudioOrVideo(
                'video', {
                    // defaultState : false,
                    'onTimerTick': (iNperiods) => {
                        var hours = iNperiods[4],mins = iNperiods[5],sec = iNperiods[6];
                        var allSeconds = (hours*3600) + (mins*60) + sec;
                        msgLiveVideo_flashSending(allSeconds);
                        console.log('tick audioLiveAudio');
                    },
                    'onStartVideoRecord': () => {
                        // when timer finished (we give time for browser to get stream from camera)
                        if (flagPermissionForLiveVideoRecord == true) {
                            // set flag true -> we stared recording
                            flagBoolStartedLoaded = true;
                            // start recording
                            mediationObjectLiveVideoRecorderObject.start(600000);
                        } else {
                            // set flag false -> we don't stared recording
                            flagBoolStartedLoaded = false;
                        }

                    },
                    'onStart': () => {
                        // when mouse up from btn for live recording
                        M_RECORD.video({
                            'onSuccess': (stream, recorderObject, mediationObjectForPassToVideoRecord) => {
                                console.log('specialClickObject video mediationObjectLiveVideoRecorderObject ', mediationObjectLiveVideoRecorderObject);
                                if (typeof mediationObjectLiveVideoRecorderObject != 'undefined') {
                                    // stop recording object (delete tracks from stream)
                                    M_RECORD.stopRecordingByStream(mediationObjectLiveVideoStreamObject);
                                    // stop recording stream
                                    mediationObjectLiveVideoRecorderObject.stop();
                                    // delete stream
                                    mediationObjectLiveVideoStreamObject.stop();
                                }
                                // set stream for global access in function
                                mediationObjectLiveVideoStreamObject = stream;
                                // set recorder for global access in function
                                mediationObjectLiveVideoRecorderObject = recorderObject;
                                // we get perimision for browser -> set true
                                flagPermissionForLiveVideoRecord = true;
                                // set for view element (video tag) our stream as src
                                VIEW.msgLiveVideo_record_setStreamVideoElement(mediationObjectLiveVideoStreamObject);
                                // show stream view box
                                VIEW.msgLiveVideo_record_showStreamVideoViewer();

                                // active special click object
                                // specialClickObject.on();
                            },
                            'onError': (e) => {
                                // deactive special click object
                                // specialClickObject.off();

                                // we don't get perimision for browser -> set false
                                flagPermissionForLiveVideoRecord = false;
                            }
                        })


                    },
                    'onDelete': () => {
                        // when mouse up from outside btn || from cancel btn 

                        // hide stream recorder view
                        VIEW.msgLiveVideo_record_hideStreamVideoViewer();
                        // stop recording object (delete tracks from stream)
                        M_RECORD.stopRecordingByStream(mediationObjectLiveVideoStreamObject);
                        // stop recording stream
                        mediationObjectLiveVideoRecorderObject.stop();
                        // delete stream
                        mediationObjectLiveVideoStreamObject.stop();

                        // annihilate loading because we send
                        flagBoolStartedLoaded = false;

                    },
                    'onSend': () => {
                        // when mouse up from inside btn for live recording

                        // is recording started
                        if (flagBoolStartedLoaded == true) {
                            // hide stream recorder view
                            VIEW.msgLiveVideo_record_hideStreamVideoViewer();
                            // stop recording stream
                            mediationObjectLiveVideoRecorderObject.stop();
                            // upload video to storage
                            mediationObjectLiveVideoRecorderObject.get(controller_msgLiveVideo_record_sendVideoToStorage);
                            // stop recording object (delete tracks from stream)
                            M_RECORD.stopRecordingByStream(mediationObjectLiveVideoStreamObject);
                            // delete stream
                            mediationObjectLiveVideoStreamObject.stop();
                        }
                        // annihilate loading because we send
                        flagBoolStartedLoaded = false;
                    },

                }
            );
        }
        _['controller_msgLiveVideo_record_run'] = controller_msgLiveVideo_record_run;
        //@> COTROLLER record_msgLiveVideo 
    //@SECTION> 'msg live video' type = 21

    //@<SECTION 'msg live audio' type = 20

        function msgLiveAudio_onEventPlay (iNobject) {
            //@GLOBAL pause all other audio & video is now playin
            VIEW.msg_pauseAllOtherPlayingAudioOrVideoEl();

            // add playing flags
            VIEW.msgLiveAudio_addPlayingFlags(iNobject);

            // safe set read state
            msgLiveAudio_safeSetReadState (iNobject);

            // view pause brn & hide play btn
            var parent = $(iNobject).closest('.aCpI_msgLiveAudio_blockInAudioMsg');
            VIEW.msgLiveAudio_smartViewBtnPauseAudio(parent);
        }
        window.aCpI_msgLiveAudio_onEventPlay = msgLiveAudio_onEventPlay;

        function msgLiveAudio_safeSetReadState (iNobject) {
            //@< add read state for to me message if it need
                var msgParentBlock = $(iNobject).closest('.msgTypeLiveAudio');

                if( msgParentBlock.hasClass('toMeMessageInChatView') && VIEW.msg_getDomAttrByNameMessageTimeRead(msgParentBlock) < 1 ) {
                    // 
                    var chatId  = msg_getCurrentChatId();
                    var myUID   = USER.getMyId();
                    let msgId   = VIEW.msg_getDomAttrByNameMsgId(msgParentBlock);
                    msg_setReadState(msgId, chatId, myUID);
                }
            //@> add read state for to me message if it need
        }

        function msgLiveAudio_createMsgFromMe ( iNsrc, iNmyUid, iNchatId, iNmsgId ) {
            var iNdata = {};
            iNdata['url']       = iNsrc;
            iNdata['uid']       = iNmyUid;
            iNdata['content']   = '';
            iNdata['msgId']     = iNmsgId;
            // create message element
            VIEW.msgLiveAudio_createMsg(iNdata, iNmyUid, iNchatId);
            // scroll to bot
            VIEW.effChatViewScrollToBotWithTimeOut();
        }

        function msgLiveAudio_flashSending (iNsecond,iNchatId) {
            /*
                @disrc
                    start sendidng flesh msg to firebase db
                @inputs
                    @required
                        iNdata -> object
                            type
                            data
            */
            objForSendToDb = {
                'data': iNsecond,
                'type': 20
            };
            msg_flashSending(objForSendToDb,iNchatId)
        } _['msgLiveAudio_flashSending'] = msgLiveAudio_flashSending;

        function msgLiveAudio_sendMsgFromMe (iNsrc, iNchatId, iNmsgId) {
            var iNdata      = {
                'src'       : iNsrc,
                'content'   : '',
                'type'      : 20
            };
            // add to database
            msg_addToDb(iNdata, iNchatId, iNmsgId)
        }
        //

        //@< COTROLLER msgLiveAudio record
        function controller_msgLiveAudio_record_sendAudioToStorage(iNerror, iNblob, iNdata) {
            var blobUrl     = URL.createObjectURL(iNblob),
                iNmyUid     = USER.getMyId(),
                iNchatId    = msg_getCurrentChatId(iNchatId),
                iNmsgId     = msg_generateMsgIdByChatId(iNchatId);

            // create message without load to db
            msgLiveAudio_createMsgFromMe(blobUrl, iNmyUid, iNchatId, iNmsgId);


             // upload audio file
            var functionUploadBlob = () => {
                // init loader
                var progressBar = VIEW.msgLiveAudio_initLoader(iNchatId, iNmsgId);
                var file = '1.ogg';
                var pathForSaveFile = 'chats/'+iNchatId+'/'+iNmyUid+'/liveAudio/'+iNmsgId+'/' + file;
                M_STORAGE.uploadBlob (
                    iNblob, {
                        'pathForSaveFile': pathForSaveFile,
                        'mimeType': 'audio/ogg; codecs=opus'
                    }, {
                        'onSuccess': (iNdownloadURL) => {
                            // hide uploader block
                            VIEW.msgLiveAudio_hideUploadBlock(iNchatId, iNmsgId);

                            // send message to uplload
                            msgLiveAudio_sendMsgFromMe(file, iNchatId, iNmsgId);
                        },
                        'onProgress': (iNprogress) => {
                            let progress = iNprogress / 100;

                            // set progres for uploading progress bar
                            progressBar.to(progress);
                        },
                        'onError': (iNerror) => {
                            // hide progress bar -> we need show progress bar
                            VIEW.msgLiveAudio_showUploadBtn(iNchatId, iNmsgId);
                        },
                    }
                );
            }

            VIEW.msgLiveAudio_setObserverForUploadBtn (iNchatId,iNmsgId,
                () => {
                    console.log('msgLiveAudio_setObserverForUploadBtn start');
                    functionUploadBlob();
                }
            );

            functionUploadBlob();
        }

        function controller_msgLiveAudio_record_run() {
            var permissionForLiveAudioRecord = false;
            var mediationObjectLiveAudioRecorderObject;
            var mediationObjectLiveAudioStreamObject;

            var specialClickObject = VIEW.onSpecialClickForSendLiveAudioOrVideo(
                'audio', {
                    // defaultState : false,
                    'onTimerTick': (iNperiods) => {
                        var hours = iNperiods[4],mins = iNperiods[5],sec = iNperiods[6];
                        var allSeconds = (hours*3600) + (mins*60) + sec;
                        msgLiveAudio_flashSending(allSeconds);
                        console.log('tick audioLiveMsg');
                    },
                    'onStart': () => {
                        // when mouse up from btn for live recording
                        // if ( permissionForLiveAudioRecord == false ) {
                        M_RECORD.liveAudioRecord({
                            'onSuccess': (stream, recorderObject) => {
                                if (typeof mediationObjectLiveAudioStreamObject != 'undefined') {
                                    M_RECORD.stopRecordingByStream(mediationObjectLiveAudioStreamObject);
                                    mediationObjectLiveAudioRecorderObject.delete();
                                    mediationObjectLiveAudioStreamObject.stop();
                                }
                                // set stream
                                mediationObjectLiveAudioStreamObject = stream;
                                // set record object
                                mediationObjectLiveAudioRecorderObject = recorderObject;
                                permissionForLiveAudioRecord = true;

                                if (permissionForLiveAudioRecord == true)
                                    mediationObjectLiveAudioRecorderObject.start();


                                // active special click object
                                // specialClickObject.on();

                            },
                            'onError': (e) => {
                                // deactive special click object
                                // specialClickObject.off();
                                permissionForLiveAudioRecord = false;
                            },
                            'onDataAvailable': (error, blob) => {

                                controller_msgLiveAudio_record_sendAudioToStorage(error, blob);
                            }
                        });

                    },
                    'onDelete': () => {
                        // when mouse up from outside btn || from cancel btn 
                        console.log('onDelete permissionForLiveAudioRecord', permissionForLiveAudioRecord);
                        if (permissionForLiveAudioRecord == true) {
                            M_RECORD.stopRecordingByStream(mediationObjectLiveAudioStreamObject);
                            mediationObjectLiveAudioRecorderObject.delete();
                            mediationObjectLiveAudioStreamObject.stop();

                            // mediationObjectLiveAudioRecorderObject.initStream();
                        }

                    },
                    'onSend': () => {
                        // when mouse up from inside btn for live recording
                        if (permissionForLiveAudioRecord == true) {
                            mediationObjectLiveAudioRecorderObject.save();
                            M_RECORD.stopRecordingByStream(mediationObjectLiveAudioStreamObject);

                            mediationObjectLiveAudioStreamObject.stop();
                        }
                    },

                }
            );
        }
        _['controller_msgLiveAudio_record_run'] = controller_msgLiveAudio_record_run;

        //@> COTROLLER msgLiveVideo

    //@SECTION> 'msg live audio' type = 20



        //<CHAT MODEL DUPLICATE
        function msg_getCurrentChatId() {
            return M_APP.get('connectThisOpenChatId');
        }
        //>CHAT MODEL DUPLICATE

        return _;
    }
);
define('m_app-chat',['v_app-chat', 'm_app','m_view','m_message','m_user','m_firebase','m_record','m_category'],function( VIEW, M_APP, M_VIEW, M_MESSAGE, USER, FIREBASE, M_RECORD, M_CATEGORY) {
	//@< init
		// init from app view templates
	  const _ = {};
	  const CONST = {};
	  const name = 'chat'; _['name'] = name;
	  const pages = {};
	    
	  _['options'] = {
	  	// 'attr' : {
	  	// 	'id' : 'leftBlockInViewWindow'
	  	// }
	  }



	   var STORAGE = FIREBASE.storage().ref();

	  var thisPageName; 

	 




	function pageIndex_getChatByUid () {

	}
	function pageIndex_sendMsg () {

	}
	
//@<CONTROLLER VIEW or NO defined chat (chat view now status)
	CONST['chatViewPrefix'] = 'connectPrefixChatViewStatus-';

	function runController_thisChatWatching (iNchatId) {
		// onDisconectSetChatOffline(iNchatId);
		// safeSetChatViewOnline(iNchatId);
	}
	function runController_thisChatWatchingWhenChatDownloadMessage (iNchatId) {
		// safeSetChatViewOnline(iNchatId);
	}

	function safeSetChatViewOnline (iNchatId) {
		// let chatStatus = getChatViewStatus(iNchatId);
		// if(chatStatus != 1) {
		// 	setChatViewOnline(iNchatId);
		// 	return true;
		// }
		// return false;
	}
		function setChatViewOnline (iNchatId) {
			// setChatViewStatus(iNchatId,1);

			// let uid = USER.getMyId();
			// let path = "chats/"+iNchatId+"/member/"+uid+"/online";
			// let updateArray = {};
			// 	updateArray[path] = 1

	  //   	FIREBASE.database().ref().update(updateArray);

		}

	function safeSetChatViewOffline (iNchatId) {
		// let chatStatus = getChatViewStatus(iNchatId);
		// if(chatStatus != 0) {
		// 	setChatViewOffline(iNchatId);
		// 	return true;
		// }
		// return false;
	}
		function setChatViewOffline (iNchatId) {
			// setChatViewStatus(iNchatId,0);

			// let uid = USER.getMyId();
			// let path = "chats/"+iNchatId+"/member/"+uid+"/online";
			// let updateArray = {};
			// 	updateArray[path] = FIREBASE.database.ServerValue.TIMESTAMP;
	  //   	FIREBASE.database().ref().update(updateArray);
		}
			function setChatViewStatus (iNchatId,iNstatus) {
				// let varPath = CONST['chatViewPrefix'] + iNchatId;
				// M_APP.save(varPath,iNstatus);
			}
			function getChatViewStatus (iNchatId) {
				// let varPath = CONST['chatViewPrefix'] + iNchatId;
				// return parseInt(M_APP.get(varPath))||0;
			}

	function onDisconectSetChatOffline (iNchatId) {
		// let uid = USER.getMyId();
		// let path = "chats/"+iNchatId+"/member/"+uid+"/online";
		// let chatTime = FIREBASE.database.ServerValue.TIMESTAMP;
		// let ref = FIREBASE.database().ref(path);
		// ref.on(
		// 	'value',
		// 	(iNdata) => {
		// 		if(iNdata.val() != 1 && getCurrentChatId() == iNchatId) {
		// 			setChatViewOnline (iNchatId);
		// 		}
		// 		ref.onDisconnect().set(chatTime);
		// 	}
		// );
	}
//@>CONTROLLER VIEW or NO defined chat (chat view now status)










	function pageIndex_openChatByChatId (iNobject) {
		/*
			@inputs
				@required
					iNobject -> object
						chatId
						userId
						chatName


						userLogin


						chatIcon

						userLogin
						online
						servise
						chatType

		*/

		console.log('pageIndex_openChatByChatId start - iNobject',iNobject);

		iNobject['chatIcon'] 	= iNobject['chatIcon'];//https://cdn.ramman.net/images/icons/apps/app_sharepay.png';
		iNobject['chatName']	= iNobject['chatName'];//'SharePay';
		iNobject['login']	 	= iNobject['userLogin'];// 'sharepay';
		iNobject['servise'] 	= (iNobject['userType'] == 2)?true:false;//true;

		var chatId  = iNobject['chatId'];
		var uid 	= iNobject['uid'];
		var login 	= iNobject['login'];
		var servise = iNobject['servise'];
		var stateOnline 	= iNobject['online'];
		var chatName  = iNobject['chatName'];

		// get chatIcon
		var chatType 	= iNobject['chatIcon']||1;
		var chatIcon  	= M_CATEGORY.getChatIconByType(chatType,iNobject);


		// setPreviusChat 
			let previusChat = getCurrentChatId();
			if ( previusChat != chatId ) {
				// if last chat != this chat
				// we close this chat
				safeSetChatViewOffline(previusChat);

			}

		// set actions when connection will be disconected
        setCurrentChatId(iNobject['chatId']);
        // controller for wathching i view now this chat or no
		// runController_thisChatWatching (chatId); -> disable

        



        setCurrentChatUserId(iNobject['uid']);
        setCurrentChatType('private');

        // 'https://cdn.ramman.net/images/icons/apps/app_sharepay.png'
        // chatId, userId, userName, userIcon, userLogin, online, servise
        VIEW.addUserHeaderInChief({'chatId':chatId, 'uid':uid, 'name': chatName,'icon': chatIcon,'login':login,'online':stateOnline,'servise':servise});



		M_MESSAGE.setLastMsgTimeByChatId(chatId,0);
		console.log('pageIndex_openChatByChatId VIEW.getCountsOfChatContainers(chatId)', VIEW.getCountsOfChatContainers(chatId));
		console.log('pageIndex_openChatByChatId chatId', chatId);
        if ( VIEW.getCountsOfChatContainers(chatId) == 0 ) {
            // need chat isset open it
            VIEW.createChatContainer(chatId);
        	M_MESSAGE.synchronizeWithMessageDb(chatId
        		, 
        		{
	        		'functionOnChild' : (iN2ChatId) => {
	        			runController_thisChatWatchingWhenChatDownloadMessage(iN2ChatId);
	        		}
        		}
        	);
        }
        VIEW.hideChatContainers();
        VIEW.showChatContainerByChatId(chatId);
        VIEW.effChatViewScrollToBot();
        // M_MESSAGE.setObserverForAppearMessageInVisualScrollByChatId(chatId);
    } _.pageIndex_openChatByChatId = pageIndex_openChatByChatId;

    
	//    

	function setCurrentChatId (iNchatId) {
            return M_APP.save('connectThisOpenChatId',iNchatId);
    }
    function getCurrentChatId () {
        return M_APP.get('connectThisOpenChatId');
    }

    function setCurrentChatType (iNchatId) {
            return M_APP.save('connectThisOpenChatType',iNchatId);
    }
    function getCurrentChatType () {
        return M_APP.get('connectThisOpenChatType');
    }

    function setCurrentChatUserId (iNchatId) {
            return M_APP.save('connectThisOpenChatUserId',iNchatId);
    }
    function getCurrentChatUserId () {
        return M_APP.get('connectThisOpenChatUserId');
    }

    
	

	return _;
});
define( 'c_app-chat',['m_app-chat', 'v_app-chat', 'm_view', 'm_message', 'm_app'], function ( MODEL, VIEW, M_VIEW, M_MESSAGE, M_APP) {

	console.log('c_app-chat - MODEL',MODEL);
	console.log('c_app-chat - VIEW',VIEW);
  // init result const
  const _ = {};
	  const name = 'chat'; _['name'] = name;
	  const pages = {};

  // 
  _['options'] = {}

  
  var thisPageName;
   //< init pages const
		    //@< page 'index'
		    	thisPageName = 'index';
		        pages[thisPageName]  = {'attr':{'id' : 'leftBlockInViewWindow'},'menus':{}};
		          pages[thisPageName]['functions'] = {
		            // 'isPage'  : function () {    return true;},
		            'getTemplate' : function (iNdata) {

		            },
		            'onOut'  : function () {   return true;},
		            // 'onView'  : function () {
		            //   addPageToFullWindow({'id':'sign','uid':'@system'});
		            //   // V_APP_PAGE.addFullWindowByTemplate({'content':'Hellow World!!!'}); 
		            //   return true;
		            // },
		            // 'onHide'  : function () { return true;},
		            // 'setPage' : function () {return true;},
		            'onInit' 		: function () {
		            	
		            	console.log("M_APP.getAppFromStoryLog('base')",M_APP.getAppFromStoryLog('base'));
		            	if( !M_APP.getAppFromStoryLog('base') ) {
		            		console.log("getAppFromStoryLog",'loa');
		            		// if app base not open yet -> we load
	        				M_APP.getGlobalVar('engine').passToApp( {'app':'base','page':'index'} );
		            	}


		            	M_MESSAGE.view.initApp( { 
		            		// for send simpleTextMessage when click
		            		'simpleMsgText_onClickSendBtn' : M_MESSAGE.simpleMsgText_onClickSendBtn , 
		            		// for send flash data for simpleTextMessage
		            		'simpleMsgText_printing' : M_MESSAGE.msgSimpleText_flashSending } 
	            		);


		            	//
		            	M_MESSAGE.controller_msgLiveVideo_record_run ();
		            	M_MESSAGE.controller_msgLiveAudio_record_run ();

		            	return true;
		            },
		            'onAppear' 		: function (d1,d2) {
		            	console.log('app chat page index onAppear - d1,d2',d1,d2);
		            	MODEL.pageIndex_openChatByChatId(d1);
 						return true;
 					},
		            'onDisappear' 	: function () { return true;},
		          };
		    //@> page 'index'

		    //@< page 'createPrivateChat'
		    	thisPageName = 'createPrivateChat';
		        pages[thisPageName]  = {'attr':{'id' : 'leftBlockInViewWindow'},'menus':{}};
		          pages[thisPageName]['functions'] = {
		            // 'isPage'  : function () {    return true;},
		            'getTemplate' : function (iNdata) {

		            },
		            'onOut'  : function () {   return true;},
		            // 'onView'  : function () {
		            //   addPageToFullWindow({'id':'sign','uid':'@system'});
		            //   // V_APP_PAGE.addFullWindowByTemplate({'content':'Hellow World!!!'}); 
		            //   return true;
		            // },
		            // 'onHide'  : function () { return true;},
		            // 'setPage' : function () {return true;},
		            'onInit' 		: function () {
		            	
	        			M_APP.getGlobalVar('engine').passToApp( {'app':'base','page':'index','data':''} );
		            	M_MESSAGE.view.initApp( { 
		            		// for send simpleTextMessage when click
		            		'simpleMsgText_onClickSendBtn' : M_MESSAGE.simpleMsgText_onClickSendBtn , 
		            		// for send flash data for simpleTextMessage
		            		'simpleMsgText_printing' : M_MESSAGE.msgSimpleText_flashSending } 
	            		);


		            	//
		            	M_MESSAGE.controller_msgLiveVideo_record_run ();
		            	M_MESSAGE.controller_msgLiveAudio_record_run ();

		            	return true;
		            },
		            'onAppear' 		: function (d1,d2) {
		            	// M_MESSAGE.view.startAppearObserver();
		            	MODEL.pageIndex_openChatByChatId(d1);
 						return true;
 					},
		            'onDisappear' 	: function () { return true;},
		          };
		    //@> page 'createPrivateChat'

	  //> init pages const
	_['pages'] = pages; 

	//@<<< APP BLOCK
		//@override
		function getTemplate (iNdata) {
			iNdata['other'] = VIEW.getChatSenderBlock();
		}
		_['getTemplate'] = getTemplate; 

		//@required
		function onInit () {

		}
		_['onInit'] = onInit; 
		
			//@optional	
			function onIn () {

			}
			_['onIn'] = onIn; 
				//@required
				function onAppear () {
					M_VIEW.view.closeLoader();

				}
				_['onAppear'] = onAppear; 
				//@required
				function onDisappear () {
					// here must be page disapear functions
					/*
						  pages  
						     page +getPageName +setPageName
						  pages[openedPageName][onDisapear] 

					*/

				}
			_['onDisappear'] = onDisappear; 

			//@optional	
			function onOut () {
				// here must be page onOut functions

			}
			_['onOut'] = onOut; 
		//@required
		function onDeinit () {

		}
		_['onDeinit'] = onDeinit; 
	//@>>> APP BLOCK



  return  _;
});
define('v_app-base',['jquery','m_user','template7','v_view','v_app'],function($,USER,Template7,V_VIEW,V_APP) {
	const _ = {};
	const CONST = {'name':'base','pageIndex':'index'};
	const templates = {};
		templates['appHeaderForIndexPage'] = `
			<div class="appBase_userListHeaderContainer">
			   	{{#if back}}
			   		<div class="appBase_backButton"></div>
			   	{{/if}}
			   	<div class="appBase_userIcon"><a href="#"><img src="{{icon}}"></a></div>
			   	<div class="UserNameInMenusBlock">
					<div class="appBase_ListHeader_dName">
					 <a href="{{href}}" class="CML" {{#if nameDictionaryCode}}cmlk="{{nameDictionaryCode}}"{{/if}}>{{name}}</a>
					</div>
					{{if login}}<div class="appBase_ListHeader_login">@{{login}}</div>{{/if}}
			   </div>
			</div>
			<div class="appBase_listHeaderButtonsBlock">
				<div class="appBase_buttonOptions"></div>
				<div class="appBase_buttonToHome connect_system_href" 		code_href="toHome"></div>
				{{#if myLogin}}
					<div class="appBase_buttonSignOut connect_system_href" 	code_href="signOut"></div>
				{{else}}
					<div class="appBase_buttonSignIn connect_system_href" 	code_href="signIn"></div>
				{{/if}}
			</div>
			<div class="ChoosePlaceInMenusBlock"></div>
		`;
	    
	  //https://cdn.ramman.net/images/icons/users/noPhoto.png
	_['templates'] = templates;

	function getListHeaderForIndexPage (iNdata) {
		/*
			@inputs
				@required
					iNdata
						@required
							nameDictionaryCode OR name
							icon
							login
						@optional
							nameDictionaryCode OR name
							back -> bool
							href -> string
		*/
		var temp = Template7.compile(templates['appHeaderForIndexPage']);
		return temp(iNdata);
	}

	

	function getAppContent (iNdata) {
		return `
		<div class="view " view-name="index">
		  	<div class="scrolBlockForChat" style="" id="MixItUp81681F"></div>
		</div>
		`;
	}
	_['getAppContent'] = getAppContent; 

	function addUserHeaderInList (iNdata,iNtype) {
		/*
			@inputs
				@required
					iNdata
						@required
							nameDictionaryCode OR name
							icon
							login
						@optional
							nameDictionaryCode OR name
							back -> bool
				@optional
					iNtype -> string 
						in [end,begin, after, before, change]
		*/
		if( typeof iNtype != 'string' ) iNtype = 'end';


		// if i am anonym user del him and del back btn
		var myLogin = USER.getMyLogin();
		if( !myLogin ) {
			delete iNdata['myLogin'];
			// delete back btn
			delete iNdata['back'];
		} else {
			iNdata['myLogin'] = myLogin;
		}

		var objForAddHeader = {'app':CONST['name'],'page': CONST['pageIndex']};
		// add user flag
		objForAddHeader['content'] = getListHeaderForIndexPage (iNdata);


		V_APP.safeViewMenuHeaderWithContent(objForAddHeader,iNtype);
	}
	_['addUserHeaderInList'] = addUserHeaderInList;


	function getRealChatIdByUid (iNuid) {
		// body...
		var path 		= ".usersBlockContainerInMenusBlock .scrolBlockForChat .mix.usersBlockInMenusBlock[connect_uid='"+iNuid+"']";
		var el 			= $(path);
		var chatId 		= el.attr('connect_chatid');
		var userLogin 	= el.attr('connect_userlogin');
		if ( el && userLogin != chatId ) {
			// 
			return chatId;
		}
		return false;
	}
	_['getRealChatIdByUid'] = getRealChatIdByUid;
	




	return _;
});
/*!
 * autocomplete.js 0.29.0
 * https://github.com/algolia/autocomplete.js
 * Copyright 2017 Algolia, Inc. and other contributors; Licensed MIT
 */
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){"use strict";a.exports=c(1)},function(a,b,c){"use strict";var d=c(2),e=c(3);d.element=e;var f=c(4);f.isArray=e.isArray,f.isFunction=e.isFunction,f.isObject=e.isPlainObject,f.bind=e.proxy,f.each=function(a,b){function c(a,c){return b(c,a)}e.each(a,c)},f.map=e.map,f.mixin=e.extend,f.Event=e.Event;var g,h,i,j=c(5),k=c(6);g=e.fn.autocomplete,h="aaAutocomplete",i={initialize:function(a,b){function c(){var c,d=e(this),f=new k({el:d});c=new j({input:d,eventBus:f,dropdownMenuContainer:a.dropdownMenuContainer,hint:void 0===a.hint||!!a.hint,minLength:a.minLength,autoselect:a.autoselect,autoselectOnBlur:a.autoselectOnBlur,openOnFocus:a.openOnFocus,templates:a.templates,debug:a.debug,cssClasses:a.cssClasses,datasets:b,keyboardShortcuts:a.keyboardShortcuts,appendTo:a.appendTo,autoWidth:a.autoWidth}),d.data(h,c)}return b=f.isArray(b)?b:[].slice.call(arguments,1),a=a||{},this.each(c)},open:function(){function a(){var a,b=e(this);(a=b.data(h))&&a.open()}return this.each(a)},close:function(){function a(){var a,b=e(this);(a=b.data(h))&&a.close()}return this.each(a)},val:function(a){function b(){var b,c=e(this);(b=c.data(h))&&b.setVal(a)}return arguments.length?this.each(b):function(a){var b,c;return(b=a.data(h))&&(c=b.getVal()),c}(this.first())},destroy:function(){function a(){var a,b=e(this);(a=b.data(h))&&(a.destroy(),b.removeData(h))}return this.each(a)}},e.fn.autocomplete=function(a){var b;return i[a]&&"initialize"!==a?(b=this.filter(function(){return!!e(this).data(h)}),i[a].apply(b,[].slice.call(arguments,1))):i.initialize.apply(this,arguments)},e.fn.autocomplete.noConflict=function(){return e.fn.autocomplete=g,this},e.fn.autocomplete.sources=j.sources,e.fn.autocomplete.escapeHighlightedString=f.escapeHighlightedString,a.exports=e.fn.autocomplete},function(a,b){"use strict";a.exports={element:null}},function(a,b){a.exports=jQuery},function(a,b,c){"use strict";function d(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var e=c(2);a.exports={isArray:null,isFunction:null,isObject:null,bind:null,each:null,map:null,mixin:null,isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},escapeRegExChars:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isNumber:function(a){return"number"==typeof a},toStr:function(a){return void 0===a||null===a?"":a+""},cloneDeep:function(a){var b=this.mixin({},a),c=this;return this.each(b,function(a,d){a&&(c.isArray(a)?b[d]=[].concat(a):c.isObject(a)&&(b[d]=c.cloneDeep(a)))}),b},error:function(a){throw new Error(a)},every:function(a,b){var c=!0;return a?(this.each(a,function(d,e){if(!(c=b.call(null,d,e,a)))return!1}),!!c):c},any:function(a,b){var c=!1;return a?(this.each(a,function(d,e){if(b.call(null,d,e,a))return c=!0,!1}),c):c},getUniqueId:function(){var a=0;return function(){return a++}}(),templatify:function(a){if(this.isFunction(a))return a;var b=e.element(a);return"SCRIPT"===b.prop("tagName")?function(){return b.text()}:function(){return String(a)}},defer:function(a){setTimeout(a,0)},noop:function(){},formatPrefix:function(a,b){return b?"":a+"-"},className:function(a,b,c){return(c?"":".")+a+b},escapeHighlightedString:function(a,b,c){b=b||"<em>";var e=document.createElement("div");e.appendChild(document.createTextNode(b)),c=c||"</em>";var f=document.createElement("div");f.appendChild(document.createTextNode(c));var g=document.createElement("div");return g.appendChild(document.createTextNode(a)),g.innerHTML.replace(RegExp(d(e.innerHTML),"g"),b).replace(RegExp(d(f.innerHTML),"g"),c)}}},function(a,b,c){"use strict";function d(a){var b,c;if(a=a||{},a.input||i.error("missing input"),this.isActivated=!1,this.debug=!!a.debug,this.autoselect=!!a.autoselect,this.autoselectOnBlur=!!a.autoselectOnBlur,this.openOnFocus=!!a.openOnFocus,this.minLength=i.isNumber(a.minLength)?a.minLength:1,this.autoWidth=void 0===a.autoWidth||!!a.autoWidth,a.hint=!!a.hint,a.hint&&a.appendTo)throw new Error("[autocomplete.js] hint and appendTo options can't be used at the same time");this.css=a.css=i.mixin({},o,a.appendTo?o.appendTo:{}),this.cssClasses=a.cssClasses=i.mixin({},o.defaultClasses,a.cssClasses||{}),this.cssClasses.prefix=a.cssClasses.formattedPrefix=i.formatPrefix(this.cssClasses.prefix,this.cssClasses.noPrefix),this.listboxId=a.listboxId=[this.cssClasses.root,"listbox",i.getUniqueId()].join("-");var f=e(a);this.$node=f.wrapper;var g=this.$input=f.input;b=f.menu,c=f.hint,a.dropdownMenuContainer&&j.element(a.dropdownMenuContainer).css("position","relative").append(b.css("top","0")),g.on("blur.aa",function(a){var c=document.activeElement;i.isMsie()&&(b[0]===c||b[0].contains(c))&&(a.preventDefault(),a.stopImmediatePropagation(),i.defer(function(){g.focus()}))}),b.on("mousedown.aa",function(a){a.preventDefault()}),this.eventBus=a.eventBus||new k({el:g}),this.dropdown=new d.Dropdown({appendTo:a.appendTo,wrapper:this.$node,menu:b,datasets:a.datasets,templates:a.templates,cssClasses:a.cssClasses,minLength:this.minLength}).onSync("suggestionClicked",this._onSuggestionClicked,this).onSync("cursorMoved",this._onCursorMoved,this).onSync("cursorRemoved",this._onCursorRemoved,this).onSync("opened",this._onOpened,this).onSync("closed",this._onClosed,this).onSync("shown",this._onShown,this).onSync("empty",this._onEmpty,this).onSync("redrawn",this._onRedrawn,this).onAsync("datasetRendered",this._onDatasetRendered,this),this.input=new d.Input({input:g,hint:c}).onSync("focused",this._onFocused,this).onSync("blurred",this._onBlurred,this).onSync("enterKeyed",this._onEnterKeyed,this).onSync("tabKeyed",this._onTabKeyed,this).onSync("escKeyed",this._onEscKeyed,this).onSync("upKeyed",this._onUpKeyed,this).onSync("downKeyed",this._onDownKeyed,this).onSync("leftKeyed",this._onLeftKeyed,this).onSync("rightKeyed",this._onRightKeyed,this).onSync("queryChanged",this._onQueryChanged,this).onSync("whitespaceChanged",this._onWhitespaceChanged,this),this._bindKeyboardShortcuts(a),this._setLanguageDirection()}function e(a){var b,c,d,e;b=j.element(a.input),c=j.element(n.wrapper.replace("%ROOT%",a.cssClasses.root)).css(a.css.wrapper),a.appendTo||"block"!==b.css("display")||"table"!==b.parent().css("display")||c.css("display","table-cell");var g=n.dropdown.replace("%PREFIX%",a.cssClasses.prefix).replace("%DROPDOWN_MENU%",a.cssClasses.dropdownMenu);d=j.element(g).css(a.css.dropdown).attr({role:"listbox",id:a.listboxId}),a.templates&&a.templates.dropdownMenu&&d.html(i.templatify(a.templates.dropdownMenu)()),e=b.clone().css(a.css.hint).css(f(b)),e.val("").addClass(i.className(a.cssClasses.prefix,a.cssClasses.hint,!0)).removeAttr("id name placeholder required").prop("readonly",!0).attr({"aria-hidden":"true",autocomplete:"off",spellcheck:"false",tabindex:-1}),e.removeData&&e.removeData(),b.data(h,{"aria-autocomplete":b.attr("aria-autocomplete"),"aria-expanded":b.attr("aria-expanded"),"aria-owns":b.attr("aria-owns"),autocomplete:b.attr("autocomplete"),dir:b.attr("dir"),role:b.attr("role"),spellcheck:b.attr("spellcheck"),style:b.attr("style"),type:b.attr("type")}),b.addClass(i.className(a.cssClasses.prefix,a.cssClasses.input,!0)).attr({autocomplete:"off",spellcheck:!1,role:"combobox","aria-autocomplete":a.datasets&&a.datasets[0]&&a.datasets[0].displayKey?"both":"list","aria-expanded":"false","aria-label":a.ariaLabel,"aria-owns":a.listboxId}).css(a.hint?a.css.input:a.css.inputWithNoHint);try{b.attr("dir")||b.attr("dir","auto")}catch(a){}return c=a.appendTo?c.appendTo(j.element(a.appendTo).eq(0)).eq(0):b.wrap(c).parent(),c.prepend(a.hint?e:null).append(d),{wrapper:c,input:b,hint:e,menu:d}}function f(a){return{backgroundAttachment:a.css("background-attachment"),backgroundClip:a.css("background-clip"),backgroundColor:a.css("background-color"),backgroundImage:a.css("background-image"),backgroundOrigin:a.css("background-origin"),backgroundPosition:a.css("background-position"),backgroundRepeat:a.css("background-repeat"),backgroundSize:a.css("background-size")}}function g(a,b){var c=a.find(i.className(b.prefix,b.input));i.each(c.data(h),function(a,b){void 0===a?c.removeAttr(b):c.attr(b,a)}),c.detach().removeClass(i.className(b.prefix,b.input,!0)).insertAfter(a),c.removeData&&c.removeData(h),a.remove()}var h="aaAttrs",i=c(4),j=c(2),k=c(6),l=c(7),m=c(16),n=c(18),o=c(19);i.mixin(d.prototype,{_bindKeyboardShortcuts:function(a){if(a.keyboardShortcuts){var b=this.$input,c=[];i.each(a.keyboardShortcuts,function(a){"string"==typeof a&&(a=a.toUpperCase().charCodeAt(0)),c.push(a)}),j.element(document).keydown(function(a){var d=a.target||a.srcElement,e=d.tagName;if(!d.isContentEditable&&"INPUT"!==e&&"SELECT"!==e&&"TEXTAREA"!==e){var f=a.which||a.keyCode;c.indexOf(f)!==-1&&(b.focus(),a.stopPropagation(),a.preventDefault())}})}},_onSuggestionClicked:function(a,b){var c;(c=this.dropdown.getDatumForSuggestion(b))&&this._select(c)},_onCursorMoved:function(a,b){var c=this.dropdown.getDatumForCursor(),d=this.dropdown.getCurrentCursor().attr("id");this.input.setActiveDescendant(d),c&&(b&&this.input.setInputValue(c.value,!0),this.eventBus.trigger("cursorchanged",c.raw,c.datasetName))},_onCursorRemoved:function(){this.input.resetInputValue(),this._updateHint(),this.eventBus.trigger("cursorremoved")},_onDatasetRendered:function(){this._updateHint(),this.eventBus.trigger("updated")},_onOpened:function(){this._updateHint(),this.input.expand(),this.eventBus.trigger("opened")},_onEmpty:function(){this.eventBus.trigger("empty")},_onRedrawn:function(){this.$node.css("top","0px"),this.$node.css("left","0px");var a=this.$input[0].getBoundingClientRect();this.autoWidth&&this.$node.css("width",a.width+"px");var b=this.$node[0].getBoundingClientRect(),c=a.bottom-b.top;this.$node.css("top",c+"px");var d=a.left-b.left;this.$node.css("left",d+"px"),this.eventBus.trigger("redrawn")},_onShown:function(){this.eventBus.trigger("shown"),this.autoselect&&this.dropdown.cursorTopSuggestion()},_onClosed:function(){this.input.clearHint(),this.input.removeActiveDescendant(),this.input.collapse(),this.eventBus.trigger("closed")},_onFocused:function(){if(this.isActivated=!0,this.openOnFocus){var a=this.input.getQuery();a.length>=this.minLength?this.dropdown.update(a):this.dropdown.empty(),this.dropdown.open()}},_onBlurred:function(){var a,b;a=this.dropdown.getDatumForCursor(),b=this.dropdown.getDatumForTopSuggestion(),this.debug||(this.autoselectOnBlur&&a?this._select(a):this.autoselectOnBlur&&b?this._select(b):(this.isActivated=!1,this.dropdown.empty(),this.dropdown.close()))},_onEnterKeyed:function(a,b){var c,d;c=this.dropdown.getDatumForCursor(),d=this.dropdown.getDatumForTopSuggestion(),c?(this._select(c),b.preventDefault()):this.autoselect&&d&&(this._select(d),b.preventDefault())},_onTabKeyed:function(a,b){var c;(c=this.dropdown.getDatumForCursor())?(this._select(c),b.preventDefault()):this._autocomplete(!0)},_onEscKeyed:function(){this.dropdown.close(),this.input.resetInputValue()},_onUpKeyed:function(){var a=this.input.getQuery();this.dropdown.isEmpty&&a.length>=this.minLength?this.dropdown.update(a):this.dropdown.moveCursorUp(),this.dropdown.open()},_onDownKeyed:function(){var a=this.input.getQuery();this.dropdown.isEmpty&&a.length>=this.minLength?this.dropdown.update(a):this.dropdown.moveCursorDown(),this.dropdown.open()},_onLeftKeyed:function(){"rtl"===this.dir&&this._autocomplete()},_onRightKeyed:function(){"ltr"===this.dir&&this._autocomplete()},_onQueryChanged:function(a,b){this.input.clearHintIfInvalid(),b.length>=this.minLength?this.dropdown.update(b):this.dropdown.empty(),this.dropdown.open(),this._setLanguageDirection()},_onWhitespaceChanged:function(){this._updateHint(),this.dropdown.open()},_setLanguageDirection:function(){var a=this.input.getLanguageDirection();this.dir!==a&&(this.dir=a,this.$node.css("direction",a),this.dropdown.setLanguageDirection(a))},_updateHint:function(){var a,b,c,d,e,f;a=this.dropdown.getDatumForTopSuggestion(),a&&this.dropdown.isVisible()&&!this.input.hasOverflow()?(b=this.input.getInputValue(),c=l.normalizeQuery(b),d=i.escapeRegExChars(c),e=new RegExp("^(?:"+d+")(.+$)","i"),f=e.exec(a.value),f?this.input.setHint(b+f[1]):this.input.clearHint()):this.input.clearHint()},_autocomplete:function(a){var b,c,d,e;b=this.input.getHint(),c=this.input.getQuery(),d=a||this.input.isCursorAtEnd(),b&&c!==b&&d&&(e=this.dropdown.getDatumForTopSuggestion(),e&&this.input.setInputValue(e.value),this.eventBus.trigger("autocompleted",e.raw,e.datasetName))},_select:function(a){void 0!==a.value&&this.input.setQuery(a.value),this.input.setInputValue(a.value,!0),this._setLanguageDirection(),this.eventBus.trigger("selected",a.raw,a.datasetName).isDefaultPrevented()===!1&&(this.dropdown.close(),i.defer(i.bind(this.dropdown.empty,this.dropdown)))},open:function(){if(!this.isActivated){var a=this.input.getInputValue();a.length>=this.minLength?this.dropdown.update(a):this.dropdown.empty()}this.dropdown.open()},close:function(){this.dropdown.close()},setVal:function(a){a=i.toStr(a),this.isActivated?this.input.setInputValue(a):(this.input.setQuery(a),this.input.setInputValue(a,!0)),this._setLanguageDirection()},getVal:function(){return this.input.getQuery()},destroy:function(){this.input.destroy(),this.dropdown.destroy(),g(this.$node,this.cssClasses),this.$node=null},getWrapper:function(){return this.dropdown.$container[0]}}),d.Dropdown=m,d.Input=l,d.sources=c(20),a.exports=d},function(a,b,c){"use strict";function d(a){a&&a.el||e.error("EventBus initialized without el"),this.$el=f.element(a.el)}var e=c(4),f=c(2);e.mixin(d.prototype,{trigger:function(a){var b=[].slice.call(arguments,1),c=e.Event("autocomplete:"+a);return this.$el.trigger(c,b),c}}),a.exports=d},function(a,b,c){"use strict";function d(a){var b,c,d,f,g=this;a=a||{},a.input||i.error("input is missing"),b=i.bind(this._onBlur,this),c=i.bind(this._onFocus,this),d=i.bind(this._onKeydown,this),f=i.bind(this._onInput,this),this.$hint=j.element(a.hint),this.$input=j.element(a.input).on("blur.aa",b).on("focus.aa",c).on("keydown.aa",d),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=i.noop),i.isMsie()?this.$input.on("keydown.aa keypress.aa cut.aa paste.aa",function(a){h[a.which||a.keyCode]||i.defer(i.bind(g._onInput,g,a))}):this.$input.on("input.aa",f),this.query=this.$input.val(),this.$overflowHelper=e(this.$input)}function e(a){return j.element('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:a.css("font-family"),fontSize:a.css("font-size"),fontStyle:a.css("font-style"),fontVariant:a.css("font-variant"),fontWeight:a.css("font-weight"),wordSpacing:a.css("word-spacing"),letterSpacing:a.css("letter-spacing"),textIndent:a.css("text-indent"),textRendering:a.css("text-rendering"),textTransform:a.css("text-transform")}).insertAfter(a)}function f(a,b){return d.normalizeQuery(a)===d.normalizeQuery(b)}function g(a){return a.altKey||a.ctrlKey||a.metaKey||a.shiftKey}var h;h={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"};var i=c(4),j=c(2),k=c(8);d.normalizeQuery=function(a){return(a||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ")},i.mixin(d.prototype,k,{_onBlur:function(){this.resetInputValue(),this.$input.removeAttr("aria-activedescendant"),this.trigger("blurred")},_onFocus:function(){this.trigger("focused")},_onKeydown:function(a){var b=h[a.which||a.keyCode];this._managePreventDefault(b,a),b&&this._shouldTrigger(b,a)&&this.trigger(b+"Keyed",a)},_onInput:function(){this._checkInputValue()},_managePreventDefault:function(a,b){var c,d,e;switch(a){case"tab":d=this.getHint(),e=this.getInputValue(),c=d&&d!==e&&!g(b);break;case"up":case"down":c=!g(b);break;default:c=!1}c&&b.preventDefault()},_shouldTrigger:function(a,b){var c;switch(a){case"tab":c=!g(b);break;default:c=!0}return c},_checkInputValue:function(){var a,b,c;a=this.getInputValue(),b=f(a,this.query),c=!(!b||!this.query)&&this.query.length!==a.length,this.query=a,b?c&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query)},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getQuery:function(){return this.query},setQuery:function(a){this.query=a},getInputValue:function(){return this.$input.val()},setInputValue:function(a,b){void 0===a&&(a=this.query),this.$input.val(a),b?this.clearHint():this._checkInputValue()},expand:function(){this.$input.attr("aria-expanded","true")},collapse:function(){this.$input.attr("aria-expanded","false")},setActiveDescendant:function(a){this.$input.attr("aria-activedescendant",a)},removeActiveDescendant:function(){this.$input.removeAttr("aria-activedescendant")},resetInputValue:function(){this.setInputValue(this.query,!0)},getHint:function(){return this.$hint.val()},setHint:function(a){this.$hint.val(a)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var a,b,c,d;a=this.getInputValue(),b=this.getHint(),c=a!==b&&0===b.indexOf(a),(d=""!==a&&c&&!this.hasOverflow())||this.clearHint()},getLanguageDirection:function(){return(this.$input.css("direction")||"ltr").toLowerCase()},hasOverflow:function(){var a=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=a},isCursorAtEnd:function(){var a,b,c;return a=this.$input.val().length,b=this.$input[0].selectionStart,i.isNumber(b)?b===a:!document.selection||(c=document.selection.createRange(),c.moveStart("character",-a),a===c.text.length)},destroy:function(){this.$hint.off(".aa"),this.$input.off(".aa"),this.$hint=this.$input=this.$overflowHelper=null}}),a.exports=d},function(a,b,c){"use strict";function d(a,b,c,d){var e;if(!c)return this;for(b=b.split(l),c=d?j(c,d):c,this._callbacks=this._callbacks||{};e=b.shift();)this._callbacks[e]=this._callbacks[e]||{sync:[],async:[]},this._callbacks[e][a].push(c);return this}function e(a,b,c){return d.call(this,"async",a,b,c)}function f(a,b,c){return d.call(this,"sync",a,b,c)}function g(a){var b;if(!this._callbacks)return this;for(a=a.split(l);b=a.shift();)delete this._callbacks[b];return this}function h(a){var b,c,d,e,f;if(!this._callbacks)return this;for(a=a.split(l),d=[].slice.call(arguments,1);(b=a.shift())&&(c=this._callbacks[b]);)e=i(c.sync,this,[b].concat(d)),f=i(c.async,this,[b].concat(d)),e()&&k(f);return this}function i(a,b,c){function d(){for(var d,e=0,f=a.length;!d&&e<f;e+=1)d=a[e].apply(b,c)===!1;return!d}return d}function j(a,b){return a.bind?a.bind(b):function(){a.apply(b,[].slice.call(arguments,0))}}var k=c(9),l=/\s+/;a.exports={onSync:f,onAsync:e,off:g,trigger:h}},function(a,b,c){"use strict";function d(){h&&i&&(h=!1,i.length?m=i.concat(m):l=-1,m.length&&e())}function e(){if(!h){n=!1,h=!0;for(var a=m.length,b=setTimeout(d);a;){for(i=m,m=[];i&&++l<a;)i[l].run();l=-1,a=m.length}i=null,l=-1,h=!1,clearTimeout(b)}}function f(a,b){this.fun=a,this.array=b}function g(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];m.push(new f(a,b)),n||h||(n=!0,j())}for(var h,i,j,k=[c(10),c(12),c(13),c(14),c(15)],l=-1,m=[],n=!1,o=-1,p=k.length;++o<p;)if(k[o]&&k[o].test&&k[o].test()){j=k[o].install(e);break}f.prototype.run=function(){var a=this.fun,b=this.array;switch(b.length){case 0:return a();case 1:return a(b[0]);case 2:return a(b[0],b[1]);case 3:return a(b[0],b[1],b[2]);default:return a.apply(null,b)}},a.exports=g},function(a,b,c){(function(a){"use strict";b.test=function(){return void 0!==a&&!a.browser},b.install=function(b){return function(){a.nextTick(b)}}}).call(b,c(11))},function(a,b){function c(){throw new Error("setTimeout has not been defined")}function d(){throw new Error("clearTimeout has not been defined")}function e(a){if(k===setTimeout)return setTimeout(a,0);if((k===c||!k)&&setTimeout)return k=setTimeout,setTimeout(a,0);try{return k(a,0)}catch(b){try{return k.call(null,a,0)}catch(b){return k.call(this,a,0)}}}function f(a){if(l===clearTimeout)return clearTimeout(a);if((l===d||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(a);try{return l(a)}catch(b){try{return l.call(null,a)}catch(b){return l.call(this,a)}}}function g(){p&&n&&(p=!1,n.length?o=n.concat(o):q=-1,o.length&&h())}function h(){if(!p){var a=e(g);p=!0;for(var b=o.length;b;){for(n=o,o=[];++q<b;)n&&n[q].run();q=-1,b=o.length}n=null,p=!1,f(a)}}function i(a,b){this.fun=a,this.array=b}function j(){}var k,l,m=a.exports={};!function(){try{k="function"==typeof setTimeout?setTimeout:c}catch(a){k=c}try{l="function"==typeof clearTimeout?clearTimeout:d}catch(a){l=d}}();var n,o=[],p=!1,q=-1;m.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];o.push(new i(a,b)),1!==o.length||p||e(h)},i.prototype.run=function(){this.fun.apply(null,this.array)},m.title="browser",m.browser=!0,m.env={},m.argv=[],m.version="",m.versions={},m.on=j,m.addListener=j,m.once=j,m.off=j,m.removeListener=j,m.removeAllListeners=j,m.emit=j,m.binding=function(a){throw new Error("process.binding is not supported")},m.cwd=function(){return"/"},m.chdir=function(a){throw new Error("process.chdir is not supported")},m.umask=function(){return 0}},function(a,b){(function(a){"use strict";var c=a.MutationObserver||a.WebKitMutationObserver;b.test=function(){return c},b.install=function(b){var d=0,e=new c(b),f=a.document.createTextNode("");return e.observe(f,{characterData:!0}),function(){f.data=d=++d%2}}}).call(b,function(){return this}())},function(a,b){(function(a){"use strict";b.test=function(){return!a.setImmediate&&void 0!==a.MessageChannel},b.install=function(b){var c=new a.MessageChannel;return c.port1.onmessage=b,function(){c.port2.postMessage(0)}}}).call(b,function(){return this}())},function(a,b){(function(a){"use strict";b.test=function(){return"document"in a&&"onreadystatechange"in a.document.createElement("script")},b.install=function(b){return function(){var c=a.document.createElement("script");return c.onreadystatechange=function(){b(),c.onreadystatechange=null,c.parentNode.removeChild(c),c=null},a.document.documentElement.appendChild(c),b}}}).call(b,function(){return this}())},function(a,b){"use strict";b.test=function(){return!0},b.install=function(a){return function(){setTimeout(a,0)}}},function(a,b,c){"use strict";function d(a){var b,c,d,h=this;a=a||{},a.menu||f.error("menu is required"),f.isArray(a.datasets)||f.isObject(a.datasets)||f.error("1 or more datasets required"),a.datasets||f.error("datasets is required"),this.isOpen=!1,this.isEmpty=!0,this.minLength=a.minLength||0,this.templates={},this.appendTo=a.appendTo||!1,this.css=f.mixin({},j,a.appendTo?j.appendTo:{}),this.cssClasses=a.cssClasses=f.mixin({},j.defaultClasses,a.cssClasses||{}),this.cssClasses.prefix=a.cssClasses.formattedPrefix||f.formatPrefix(this.cssClasses.prefix,this.cssClasses.noPrefix),b=f.bind(this._onSuggestionClick,this),c=f.bind(this._onSuggestionMouseEnter,this),d=f.bind(this._onSuggestionMouseLeave,this);var i=f.className(this.cssClasses.prefix,this.cssClasses.suggestion);this.$menu=g.element(a.menu).on("mouseenter.aa",i,c).on("mouseleave.aa",i,d).on("click.aa",i,b),this.$container=a.appendTo?a.wrapper:this.$menu,a.templates&&a.templates.header&&(this.templates.header=f.templatify(a.templates.header),this.$menu.prepend(this.templates.header())),a.templates&&a.templates.empty&&(this.templates.empty=f.templatify(a.templates.empty),this.$empty=g.element('<div class="'+f.className(this.cssClasses.prefix,this.cssClasses.empty,!0)+'"></div>'),this.$menu.append(this.$empty),this.$empty.hide()),this.datasets=f.map(a.datasets,function(b){return e(h.$menu,b,a.cssClasses)}),f.each(this.datasets,function(a){var b=a.getRoot();b&&0===b.parent().length&&h.$menu.append(b),a.onSync("rendered",h._onRendered,h)}),a.templates&&a.templates.footer&&(this.templates.footer=f.templatify(a.templates.footer),this.$menu.append(this.templates.footer()));var k=this;g.element(window).resize(function(){k._redraw()})}function e(a,b,c){return new d.Dataset(f.mixin({$menu:a,cssClasses:c},b))}var f=c(4),g=c(2),h=c(8),i=c(17),j=c(19);f.mixin(d.prototype,h,{_onSuggestionClick:function(a){this.trigger("suggestionClicked",g.element(a.currentTarget))},_onSuggestionMouseEnter:function(a){var b=g.element(a.currentTarget);if(!b.hasClass(f.className(this.cssClasses.prefix,this.cssClasses.cursor,!0))){this._removeCursor();var c=this;setTimeout(function(){c._setCursor(b,!1)},0)}},_onSuggestionMouseLeave:function(a){if(a.relatedTarget){if(g.element(a.relatedTarget).closest("."+f.className(this.cssClasses.prefix,this.cssClasses.cursor,!0)).length>0)return}this._removeCursor(),this.trigger("cursorRemoved")},_onRendered:function(a,b){function c(a){return a.isEmpty()}function d(a){return a.templates&&a.templates.empty}if(this.isEmpty=f.every(this.datasets,c),this.isEmpty)if(b.length>=this.minLength&&this.trigger("empty"),this.$empty)if(b.length<this.minLength)this._hide();else{var e=this.templates.empty({query:this.datasets[0]&&this.datasets[0].query});this.$empty.html(e),this.$empty.show(),this._show()}else f.any(this.datasets,d)?b.length<this.minLength?this._hide():this._show():this._hide();else this.isOpen&&(this.$empty&&(this.$empty.empty(),this.$empty.hide()),b.length>=this.minLength?this._show():this._hide());this.trigger("datasetRendered")},_hide:function(){this.$container.hide()},_show:function(){this.$container.css("display","block"),this._redraw(),this.trigger("shown")},_redraw:function(){this.isOpen&&this.appendTo&&this.trigger("redrawn")},_getSuggestions:function(){return this.$menu.find(f.className(this.cssClasses.prefix,this.cssClasses.suggestion))},_getCursor:function(){return this.$menu.find(f.className(this.cssClasses.prefix,this.cssClasses.cursor)).first()},_setCursor:function(a,b){a.first().addClass(f.className(this.cssClasses.prefix,this.cssClasses.cursor,!0)).attr("aria-selected","true"),this.trigger("cursorMoved",b)},_removeCursor:function(){this._getCursor().removeClass(f.className(this.cssClasses.prefix,this.cssClasses.cursor,!0)).removeAttr("aria-selected")},_moveCursor:function(a){var b,c,d,e;if(this.isOpen){if(c=this._getCursor(),b=this._getSuggestions(),this._removeCursor(),d=b.index(c)+a,(d=(d+1)%(b.length+1)-1)===-1)return void this.trigger("cursorRemoved");d<-1&&(d=b.length-1),this._setCursor(e=b.eq(d),!0),this._ensureVisible(e)}},_ensureVisible:function(a){var b,c,d,e;b=a.position().top,c=b+a.height()+parseInt(a.css("margin-top"),10)+parseInt(a.css("margin-bottom"),10),d=this.$menu.scrollTop(),e=this.$menu.height()+parseInt(this.$menu.css("padding-top"),10)+parseInt(this.$menu.css("padding-bottom"),10),b<0?this.$menu.scrollTop(d+b):e<c&&this.$menu.scrollTop(d+(c-e))},close:function(){this.isOpen&&(this.isOpen=!1,this._removeCursor(),this._hide(),this.trigger("closed"))},open:function(){this.isOpen||(this.isOpen=!0,this.isEmpty||this._show(),this.trigger("opened"))},setLanguageDirection:function(a){this.$menu.css("ltr"===a?this.css.ltr:this.css.rtl)},moveCursorUp:function(){this._moveCursor(-1)},moveCursorDown:function(){this._moveCursor(1)},getDatumForSuggestion:function(a){var b=null;return a.length&&(b={raw:i.extractDatum(a),value:i.extractValue(a),datasetName:i.extractDatasetName(a)}),b},getCurrentCursor:function(){return this._getCursor().first()},getDatumForCursor:function(){return this.getDatumForSuggestion(this._getCursor().first())},getDatumForTopSuggestion:function(){return this.getDatumForSuggestion(this._getSuggestions().first())},cursorTopSuggestion:function(){this._setCursor(this._getSuggestions().first(),!1)},update:function(a){function b(b){b.update(a)}f.each(this.datasets,b)},empty:function(){function a(a){a.clear()}f.each(this.datasets,a),this.isEmpty=!0},isVisible:function(){return this.isOpen&&!this.isEmpty},destroy:function(){function a(a){a.destroy()}this.$menu.off(".aa"),this.$menu=null,f.each(this.datasets,a)}}),d.Dataset=i,a.exports=d},function(a,b,c){"use strict";function d(a){a=a||{},a.templates=a.templates||{},a.source||k.error("missing source"),a.name&&!g(a.name)&&k.error("invalid dataset name: "+a.name),this.query=null,this._isEmpty=!0,this.highlight=!!a.highlight,this.name=void 0===a.name||null===a.name?k.getUniqueId():a.name,this.source=a.source,this.displayFn=e(a.display||a.displayKey),this.templates=f(a.templates,this.displayFn),this.css=k.mixin({},n,a.appendTo?n.appendTo:{}),this.cssClasses=a.cssClasses=k.mixin({},n.defaultClasses,a.cssClasses||{}),this.cssClasses.prefix=a.cssClasses.formattedPrefix||k.formatPrefix(this.cssClasses.prefix,this.cssClasses.noPrefix);var b=k.className(this.cssClasses.prefix,this.cssClasses.dataset);this.$el=a.$menu&&a.$menu.find(b+"-"+this.name).length>0?l.element(a.$menu.find(b+"-"+this.name)[0]):l.element(m.dataset.replace("%CLASS%",this.name).replace("%PREFIX%",this.cssClasses.prefix).replace("%DATASET%",this.cssClasses.dataset)),this.$menu=a.$menu,this.clearCachedSuggestions()}function e(a){function b(b){return b[a]}return a=a||"value",k.isFunction(a)?a:b}function f(a,b){function c(a){return"<p>"+b(a)+"</p>"}return{empty:a.empty&&k.templatify(a.empty),header:a.header&&k.templatify(a.header),footer:a.footer&&k.templatify(a.footer),suggestion:a.suggestion||c}}function g(a){return/^[_a-zA-Z0-9-]+$/.test(a)}var h="aaDataset",i="aaValue",j="aaDatum",k=c(4),l=c(2),m=c(18),n=c(19),o=c(8);d.extractDatasetName=function(a){return l.element(a).data(h)},d.extractValue=function(a){return l.element(a).data(i)},d.extractDatum=function(a){var b=l.element(a).data(j);return"string"==typeof b&&(b=JSON.parse(b)),b},k.mixin(d.prototype,o,{_render:function(a,b){function c(){var b=[].slice.call(arguments,0);return b=[{query:a,isEmpty:!0}].concat(b),n.templates.empty.apply(this,b)}function d(){function a(a){var b,c=m.suggestion.replace("%PREFIX%",f.cssClasses.prefix).replace("%SUGGESTION%",f.cssClasses.suggestion);return b=l.element(c).attr({role:"option",id:["option",Math.floor(1e8*Math.random())].join("-")}).append(n.templates.suggestion.apply(this,[a].concat(e))),b.data(h,n.name),b.data(i,n.displayFn(a)||void 0),b.data(j,JSON.stringify(a)),b.children().each(function(){l.element(this).css(f.css.suggestionChild)}),b}var c,d,e=[].slice.call(arguments,0),f=this,g=m.suggestions.replace("%PREFIX%",this.cssClasses.prefix).replace("%SUGGESTIONS%",this.cssClasses.suggestions);return c=l.element(g).css(this.css.suggestions),d=k.map(b,a),c.append.apply(c,d),c}function e(){var b=[].slice.call(arguments,0);return b=[{query:a,isEmpty:!g}].concat(b),n.templates.header.apply(this,b)}function f(){var b=[].slice.call(arguments,0);return b=[{query:a,isEmpty:!g}].concat(b),n.templates.footer.apply(this,b)}if(this.$el){var g,n=this,o=[].slice.call(arguments,2);this.$el.empty(),g=b&&b.length,this._isEmpty=!g,!g&&this.templates.empty?this.$el.html(c.apply(this,o)).prepend(n.templates.header?e.apply(this,o):null).append(n.templates.footer?f.apply(this,o):null):g&&this.$el.html(d.apply(this,o)).prepend(n.templates.header?e.apply(this,o):null).append(n.templates.footer?f.apply(this,o):null),this.$menu&&this.$menu.addClass(this.cssClasses.prefix+(g?"with":"without")+"-"+this.name).removeClass(this.cssClasses.prefix+(g?"without":"with")+"-"+this.name),this.trigger("rendered",a)}},getRoot:function(){return this.$el},update:function(a){function b(b){if(!this.canceled&&a===this.query){var c=[].slice.call(arguments,1);this.cacheSuggestions(a,b,c),this._render.apply(this,[a,b].concat(c))}}this.query=a,this.canceled=!1,this.shouldFetchFromCache(a)?b.apply(this,[this.cachedSuggestions].concat(this.cachedRenderExtraArgs)):this.source(a,b.bind(this))},cacheSuggestions:function(a,b,c){this.cachedQuery=a,this.cachedSuggestions=b,this.cachedRenderExtraArgs=c},shouldFetchFromCache:function(a){return this.cachedQuery===a&&this.cachedSuggestions&&this.cachedSuggestions.length},clearCachedSuggestions:function(){delete this.cachedQuery,delete this.cachedSuggestions,
delete this.cachedRenderExtraArgs},cancel:function(){this.canceled=!0},clear:function(){this.cancel(),this.$el.empty(),this.trigger("rendered","")},isEmpty:function(){return this._isEmpty},destroy:function(){this.clearCachedSuggestions(),this.$el=null}}),a.exports=d},function(a,b){"use strict";a.exports={wrapper:'<span class="%ROOT%"></span>',dropdown:'<span class="%PREFIX%%DROPDOWN_MENU%"></span>',dataset:'<div class="%PREFIX%%DATASET%-%CLASS%"></div>',suggestions:'<span class="%PREFIX%%SUGGESTIONS%"></span>',suggestion:'<div class="%PREFIX%%SUGGESTION%"></div>'}},function(a,b,c){"use strict";var d=c(4),e={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},dropdown:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},suggestions:{display:"block"},suggestion:{whiteSpace:"nowrap",cursor:"pointer"},suggestionChild:{whiteSpace:"normal"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:"0"},defaultClasses:{root:"algolia-autocomplete",prefix:"aa",noPrefix:!1,dropdownMenu:"dropdown-menu",input:"input",hint:"hint",suggestions:"suggestions",suggestion:"suggestion",cursor:"cursor",dataset:"dataset",empty:"empty"},appendTo:{wrapper:{position:"absolute",zIndex:"100",display:"none"},input:{},inputWithNoHint:{},dropdown:{display:"block"}}};d.isMsie()&&d.mixin(e.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),d.isMsie()&&d.isMsie()<=7&&d.mixin(e.input,{marginTop:"-1px"}),a.exports=e},function(a,b,c){"use strict";a.exports={hits:c(21),popularIn:c(24)}},function(a,b,c){"use strict";var d=c(4),e=c(22),f=c(23);a.exports=function(a,b){function c(c,e){a.search(c,b,function(a,b){if(a)return void d.error(a.message);e(b.hits,b)})}var g=f(a.as._ua);return g&&g[0]>=3&&g[1]>20&&(b=b||{},b.additionalUA="autocomplete.js "+e),c}},function(a,b){a.exports="0.29.0"},function(a,b){"use strict";a.exports=function(a){var b=a.match(/Algolia for vanilla JavaScript (\d+\.)(\d+\.)(\d+)/);if(b)return[b[1],b[2],b[3]]}},function(a,b,c){"use strict";var d=c(4),e=c(22),f=c(23);a.exports=function(a,b,c,g){function h(h,i){a.search(h,b,function(a,h){if(a)return void d.error(a.message);if(h.hits.length>0){var l=h.hits[0],m=d.mixin({hitsPerPage:0},c);delete m.source,delete m.index;var n=f(k.as._ua);return n&&n[0]>=3&&n[1]>20&&(b.additionalUA="autocomplete.js "+e),void k.search(j(l),m,function(a,b){if(a)return void d.error(a.message);var c=[];if(g.includeAll){var e=g.allTitle||"All departments";c.push(d.mixin({facet:{value:e,count:b.nbHits}},d.cloneDeep(l)))}d.each(b.facets,function(a,b){d.each(a,function(a,e){c.push(d.mixin({facet:{facet:b,value:e,count:a}},d.cloneDeep(l)))})});for(var f=1;f<h.hits.length;++f)c.push(h.hits[f]);i(c,h)})}i([])})}var i=f(a.as._ua);if(i&&i[0]>=3&&i[1]>20&&(b=b||{},b.additionalUA="autocomplete.js "+e),!c.source)return d.error("Missing 'source' key");var j=d.isFunction(c.source)?c.source:function(a){return a[c.source]};if(!c.index)return d.error("Missing 'index' key");var k=c.index;return g=g||{},h}}]);
define("jquery.autocomplete", ["jquery"], (function (global) {
    return function () {
        var ret, fn;
        return ret || global.jQuery.fn.autocomplete;
    };
}(this)));

define( 
  'm_app-base',[
    'jquery','m_firebase','m_category','m_app','m_view', 'm_user','dictionary','v_app-base','m_routing', 'm_database', 'url', 'sweetalert2',
    'jquery.autocomplete'
  ] , 
  function ($ , FIREBASE , M_CATEGORY , M_APP , M_VIEW,USER, DICTIONARY, VIEW , ROUTING, M_DATABASE,URL,SWEETALERT) {

  const _ = {};
  const CONST = {};
  

  //CHANGE move to view
  function initForAutocompleteForSearch () {
    var index = M_DATABASE.algolia.initIndex('connect-search');
    $('.searchInputInSearchBlock').autocomplete({ hint: false }, [
      {
        source: $.fn.autocomplete.sources.hits(index, { hitsPerPage: 25 }),
        displayKey: 'name',
        templates: {
          suggestion: function(suggestion) {
            var type  = DICTIONARY.withString ('[dictionary-' + suggestion._highlightResult.type.value + ']');
            return `
              <div class="autocompleteIconBlock">
                 <img src="https://cdn.ramman.net/images/icons/apps/app_onepay.png">
              </div>
              <div class="autocompleteTextBlock">
                 <div class="autocompleteOptionName">${suggestion._highlightResult.name.value}</div>
                 <div class="autocompleteOptionType">${type}</div>
              </div>
              <div class="autocompleteLoginBlock">${suggestion._highlightResult.login.value}</div>
            `;
          }
        }
      }
    ]).on('autocomplete:selected', function(event, suggestion, dataset) {
      console.log(suggestion, dataset);
    });
  } _.initForAutocompleteForSearch = initForAutocompleteForSearch;


  function addStandartHeaderForListView () {
    if ( USER.getMyId() ) {
      VIEW.addUserHeaderInList ( {
        'icon' : USER.getMyIcon(),
        'name' : USER.getMyDisplayName(),
        'login': USER.getMyLogin(),
      },'change');
    } else {
      // add header for non auth user
      VIEW.addUserHeaderInList ( 
        {
          'icon' : USER.getIconNonePhoto(),//URL.db.userNonePhoto,
          'name' : DICTIONARY.withString('[system-signIn]/[system-signUp]'),
        },
        'change'
      );

    }
  } _.addStandartHeaderForListView = addStandartHeaderForListView;


  function addHeaderWithBackBtnInListView (iNicon,iNname,iNlogin) {
    VIEW.addUserHeaderInList({
      'icon'  : iNicon,//USER.getMyIcon()
      'name'  : iNname,//USER.getMyDisplayName()
      'login' : iNlogin,//USER.getMyLogin()
      'back'  : true,
    },'change');

    // attach for back btn this func by click for  open index page 
    $('.appBase_backButton').click(
      function(){
        M_APP.getGlobalVar('engine').passToApp({'app':'base','page':'index','data':'back=1'});
      }
    );
  } _.addHeaderWithBackBtnInListView = addHeaderWithBackBtnInListView;


  function openPage (iNuid,iNid) {
    /*
      @discr
        open page by iNuid and iNid
      @inputs
        iNuid -> string
        iNid  -> string
      @return
      @algoritm
        1 - get page object from server
        2 - safe add js and css
        3 - view page fullwindow
    */
  }

  function getPage (iNdata,iNfunction) {
    /*
      @example
        getPage ({'uid':'@system','id':'sign'}, function (_) { console.log('_',_)})
      @discr
        get page by iNuid and iNid from server
      @inputs
        iNuid -> string
        iNid  -> string
      @return
      @algoritm
        1 - get page object from server 
    */
    $.get (
      URL.db.api.page.get, 
      iNdata, 
      function (_) {
        iNfunction(_);
      },
      'json'
    );
  }

    function processingData (iNdata,iNid) {
      /*
        @example
          add scrips and styles vire
        @discr
          get page by iNuid and iNid from server
        @inputs
          iNuid -> string
          iNid  -> string
        @return
        @algoritm
          1 - get page object from server 
      */
      var c = 'pageId' + iNid;
      if(typeof iNdata == 'object') {
        var obj = iNdata;
        if ( typeof obj['css']  == 'object' && obj['css'].length > 0 ) {
          // add css
          for ( var i in obj['css'] ) {
            m_app.d_loadCSS(obj['css'][i],c);
          }
        }
        if ( typeof obj['js']   == 'object' && obj['js'].length > 0 ) {
          // add js
          for ( var i in obj['js'] ) {
            m_app.d_loadJS(obj['js'][i],c);
          }
        }
      }
    }


    CONST['url_getUser']    = 'https://ramman.net/api/user';



    function chat_openChatWithCreateIfNotExist (iNobjectForCreateChat) {
      // body...
      var objForCreateChat = iNobjectForCreateChat;

      // created chat
      M_CATEGORY.view.createChatListIfNotExist(objForCreateChat);

      // set select effects for this chat
      M_CATEGORY.view.chat_setSelectOnlyThisChat(objForCreateChat['chatId'],1); 

      //resort this chat (up this to top)
      M_CATEGORY.view.chatPosition_annihilateForSort ();
      M_CATEGORY.view.chatPosition_setByChatIdForSort (objForCreateChat['chatId'],1); 
      // M_CATEGORY.view.startEffSortChats ();

      // show only this chat
      if(!iNobjectForCreateChat['filter']) M_CATEGORY.view.chat_showChatByChatId(objForCreateChat['chatId']);
      // add on click for this chat event
      M_CATEGORY.view.addOnClickActionForChatList ( objForCreateChat['chatId']);
    } _.chat_openChatWithCreateIfNotExist = chat_openChatWithCreateIfNotExist;


    /*< USER INFO */



      function request_getUserMenuByLogin (iNlogin, iNfunction) {

        M_VIEW.view.closeLoaderByTimeout(5000, '#menusBlock','forMenuListKey', 'indexCodeOfLoader' ); 

        const objectForAjax = {};
              objectForAjax['userId']     = USER.getMyId();
              objectForAjax['token']      = USER.getMyToken();
              objectForAjax['uid']        = iNlogin;
        getByGetRequest_userInfo(objectForAjax,
          (resultOfAjax) => {



            var icon          = URL.getUserIconByUid(resultOfAjax['user']['uid']),//'https://gstorage.ramman.net/users/'+resultOfAjax['user']['uid']+'/public/icons/1.jpg', //https://cdn.ramman.net/images/icons/apps/app_sharepay.png',
                userName      = resultOfAjax['user']['name'],
                userLogin     = resultOfAjax['user']['login'],
                userId        = resultOfAjax['user']['uid'],
                chatType      = 1; // private chat
            
            // add header with back btn for this list app
            addHeaderWithBackBtnInListView (icon,userName,userLogin);

           // if we does not signed
            var objForCreateChat = {};
              // get chatId if we has chat with this user
              objForCreateChat['chatId']      = resultOfAjax['chat']||userLogin; //because we dont have chat
              objForCreateChat['userId']      = userId;
              // objForCreateChat['userHasMenu'] = 1;
              objForCreateChat['login']       = userLogin;//resultOfAjax['user']['login'];
              objForCreateChat['icon']        = icon;//'https://cdn.ramman.net/images/icons/apps/app_sharepay.png';
              objForCreateChat['chatName']    = userName;//resultOfAjax['user']['name'];
              objForCreateChat['chatType']    = chatType;//resultOfAjax['user']['name'];

              // check for has menu
              if(typeof resultOfAjax['categories'] == 'object') {
                // if this user has categories we add userHasMenuFlag
                objForCreateChat['userHasMenu']    = 1;
              }

              // created chat
              M_CATEGORY.view.createChatListIfNotExist(objForCreateChat);

              // set select effects for this chat
              M_CATEGORY.view.chat_setSelectOnlyThisChat(objForCreateChat['userId'],1); 

              //resort this chat (up this to top)
              M_CATEGORY.view.chatPosition_annihilateForSort ();
              M_CATEGORY.view.chatPosition_setByUserIdForSort (objForCreateChat['userId'],1); 
              M_CATEGORY.view.startEffSortChats ();

              // show only this chat
              console.log('request_getUserMenuByLogin chat_showChatByUserId - objForCreateChat',objForCreateChat['userId'], objForCreateChat);
              M_CATEGORY.view.chat_showChatByUserId(objForCreateChat['userId']);

              // add user menu  
              addServiceMenu (objForCreateChat,resultOfAjax);

              // show this chat menu
              M_CATEGORY.view.chat_showOnlyThisChatMenu(objForCreateChat['userId']);

              // M_VIEW.view.closeLoaderByTimeout(2500, '#menusBlock','forMenuListKey', 'indexCodeOfLoader' ); 
              M_VIEW.view.closeLoader ('#menusBlock','forMenuListKey', 'indexCodeOfLoader' ); 


              if(typeof iNfunction == 'function') iNfunction();
          }
        );
      } _.request_getUserMenuByLogin = request_getUserMenuByLogin;

        function getByGetRequest_userInfo (iNdata,iNfunction) {
          /*
            @example
              request_getUserMenuByLogin({'uid': '769b72df-6e67-465c-9334-b1a8bfb95a1a2' ,'userId': 'bac255e1-6a59-4181-bfb9-61139e38630e' , 'token' : '1bf92fd8-fe97-44bc-a223-9b7af3019392'},(result) => {console.log(result);})
            @discr
              get categories, chatId of UID
            @inputs
              @required
                iNuid -> string
                  uid    -> string
                  userId -> string (my)
                  token   -> string (my)
            @return
            @algoritm
              1 - get page object from server 
          */
          var url = getUrl_userInfo(iNdata['uid']); delete iNdata['uid'];
          $.get (
            url, 
            iNdata,
            function (iNcontent) {
              iNfunction(iNcontent);
            },
            'json'
          );
        };
          function getUrl_userInfo (iNuid) {
            var type = 'info';
            return CONST['url_getUser'] +'/' + iNuid +'/' + type;
          }
    /*> USER INFO */

    /*< CHAT */

      CONST['url_createChat'] = URL.db.api.chat.create;// 'https://ramman.net/api/chat';
      function createPrivateChat (iNuid,/*iNuserData,*/ iNsuccessFunction, iNerrorFunction) {
        const objectForAjax = {};
              objectForAjax['uid']     = USER.getMyId();
              objectForAjax['token']   = USER.getMyToken();
              objectForAjax['userUrl'] = iNuid;
        getByGetRequest_ChatDataBySafeCreate(objectForAjax,
          (resultOfAjax) => {
            if (typeof resultOfAjax == 'object' && resultOfAjax['status'] == 1 ) {
              // SUCCESS we  created chat
              if(typeof iNsuccessFunction == 'function') iNsuccessFunction(resultOfAjax);
            } else {
              // ERROR we cannpt create chats
              if(typeof iNerrorFunction == 'function') iNerrorFunction(resultOfAjax);
            }
          }
        );
      }

        function getByGetRequest_ChatDataBySafeCreate (iNdata,iNfunction) {
          /*
            @example
              request_getUserMenuByLogin({'uid': '769b72df-6e67-465c-9334-b1a8bfb95a1a2' ,'userId': 'bac255e1-6a59-4181-bfb9-61139e38630e' , 'token' : '1bf92fd8-fe97-44bc-a223-9b7af3019392'},(result) => {console.log(result);})
            @discr
              get categories, chatId of UID
            @inputs
              @required
                iNuid -> string
                  uid    -> string
                  userId -> string (my)
                  token   -> string (my)
            @return
            @algoritm
              1 - get page object from server 
          */
          var url = getUrl_createChat(iNdata['userUrl']); delete iNdata['userUrl'];
          $.get (
            url, 
            iNdata,
            function (iNcontent) {
              iNfunction(iNcontent);
            },
            'json'
          );
        };
          function getUrl_createChat (iNuid) {
            var type = 'createPrivateChat';
            return CONST['url_createChat'] +'/' + iNuid +'/' + type;
          }

       
        function viewThisChatFromFDB (iNchat,iNuserData) {
            //LATER DEL
            console.log('viewThisChatFromFDB iNchat,iNuserData',iNchat,iNuserData);
            const objForCreatChat = {};
            objForCreatChat['chatId']   = iNchat || ('noneChat_'+iNuserData['user']['uid']);
            objForCreatChat['userId']   = iNuserData['user']['uid'];
            objForCreatChat['userLogin']   = iNuserData['user']['login'];
            objForCreatChat['chatName'] = iNuserData['user']['name'];
            objForCreatChat['icon_min'] = iNuserData['user']['icon'];
            // if(iNchat) {
              console.log('viewThisChatFromFDB objForCreatChat',objForCreatChat);
              M_CATEGORY.userForPrivateChat(objForCreatChat['chatId'],objForCreatChat['userId']);

              // M_CATEGORY.view.safeAddChatList(objForCreatChat);
              // attach link with chat db
              safeAttachLiveLinkToChatElement(objForCreatChat['chatId'], 
                () => {
                  console.log('safeAttachLiveLinkToChatElement callbackobjForCreatChat - objForCreatChat',objForCreatChat );
                  console.log('safeAttachLiveLinkToChatElement callbackobjForCreatChat -  iNuserData',iNuserData);
                  // add service category
                  addServiceMenu (objForCreatChat,iNuserData);

                }
              );
            // hide all chat list
            M_CATEGORY.view.effHideChatLists();
            // show this chat list
            M_CATEGORY.view.effShowChatList(objForCreatChat['chatId']);
        }




          function addServiceMenu ( objForCreatChat, iNuserData ) {
              M_VIEW.view.closeLoaderByTimeout(2500, '#menusBlock','forMenuListKey', 'indexCodeOfLoader' ); 
            // add chat if we has chat
            var chatId = M_CATEGORY.view.getChatIdByUid(objForCreatChat['userId']) || objForCreatChat['chatId'];//  objForCreatChat['chatId']||VIEW.getRealChatIdByUid(objForCreatChat['userId']);


            console.log('addServiceMenu objForCreatChat - ',objForCreatChat);
            console.log('addServiceMenu chatId - ',chatId);
            if ( chatId && objForCreatChat['userId'] != chatId) {
              // we has chatId
              M_CATEGORY.addChatBlockToCategory (iNuserData,chatId,objForCreatChat['userId']);

            } else {

              // we has not chatId -> we disable chat btn link
              M_CATEGORY.addDisabledChatBlockToCategory (iNuserData,objForCreatChat['userId'],objForCreatChat['login']);

            }

            // add menu to user chat (creating menu in dom)
            M_CATEGORY.view.addMenuByCategoryList ( iNuserData, objForCreatChat['userId'] );
            
            // attach onclick to 'chat' menu for create chat if it need
            M_CATEGORY.view.onClickCategoryForCreateChat (
              (userId, userLogin) => {
                // SUCCESS -> will do requiest for create chat
                // show loader
                M_APP.view.showLoader
                createPrivateChat (
                  userId,
                  ( iNchatObject ) => {
                    console.log ( 'request_getUserMenuByLogin userLogin', userLogin );
                    // we created chat -> we update menu && we open chat

                    M_CATEGORY.view.removeChatListByUserId(
                      userId,
                      () => {
                        // get menu -> show menu
                        request_getUserMenuByLogin ( userLogin , 
                          () => {
                            // open chat after reload menu
                            var chatLinkSelector = M_CATEGORY.view.getPathToChatByUserId(userId);
                            // trigger click for chat btn for view chat
                            $(chatLinkSelector + ' .privateChatBtn').trigger('click');
                          }
                        );
                      }
                    );



                    //


                  }  , 
                  () => {
                    // we CANNOT created chat

                  }
                )
                console.log('category success');

              },
              (userId, userLogin) => {
                // ERROR
                console.log('category error');

              }
            );

            // translated all menu dictionary
            DICTIONARY.start('.menuListForUsers');

          }

        
    /*> CHAT */

  function pageOne_addChatByChatId() {


  }
  function pageOne_addMenuByUserId () {

  }
  function pageOne_showPage () {
    /*
    */
    M_CATEGORY.view.effHideChatLists();
    M_CATEGORY.view.effShowChatList(chatId);
  }



  function getAllMyChats () {
    /*
        ovbserver for user chats list
        @depends
            domSortChatsBlock() - for create sort or check
    */

    // start effects for chats
    M_CATEGORY.view.startEffSortChats();
    // get my user id
    var myUid       = M_APP.get('uid');

    // get data from DB
    M_DATABASE.getRealtimeDataFromFirestoreDb (
          'users',
          myUid + '/members',
          {
            'functionOnOther' : () => {

            },
            
            'functionOnChangeFromServer' : (memberData) => {
            
            },
            
            'functionOnAdd' : (memberData) => {
              //cloase loader after 2.5 second
              M_VIEW.view.closeLoaderByTimeout(2500, '#menusBlock','forMenuListKey', 'indexCodeOfLoader' ); 

              var memberBlock   = memberData.data();
              var chatId        = memberData.id;
              console.log('userForPrivateChat chatId',chatId);
              console.log('userForPrivateChat memberBlock',memberBlock);
              var user2         = memberBlock['with'];
              console.log('userForPrivateChat user2 with - ',user2);
              M_CATEGORY.userForPrivateChat(chatId,user2);
                   
              safeAttachLiveLinkToChatElement(chatId);
            }
          }
    );
  }
  _['getAllMyChats'] = getAllMyChats;




  //@< copy funcitons from message.js model
    CONST['var_prefixNewMessageCount'] = 'connectNewMsgCountInChat-';

    function setMyNewMessagesCountByChatId (iNchatId,iNnumber) {
      let path = CONST['var_prefixNewMessageCount']+iNchatId;
      M_APP.save(path,iNnumber);
    }
    _['setMyNewMessagesCountByChatId'] = setMyNewMessagesCountByChatId;
  //@> copy funcitons from message.js model

  function startNewMsgCounter (iNdata, iNchatId,iNmyUid) {

    let number = 
(typeof iNdata == 'object') ? ( (typeof iNdata['member'] == 'object') ? ( (typeof iNdata['member'][iNmyUid] == 'object' ) ? iNdata['member'][iNmyUid]['newMsg']||0 : 0) : 0  ) : 0;
    ////// let number =  iNdata['member'][iNmyUid]['newMsg']||0;
    
    // save in local storage in db
    if(number == 0) return false; 
    setMyNewMessagesCountByChatId(iNchatId,number);
    M_CATEGORY.view.domSafeShowNewMsgCountInChatBlock( iNchatId, number );
  }


  function offAllLinkWithChatDbByChatId () {
    // body...
  }

  function safeAttachLiveLinkToChatElement (iNchatId,iNfunction) {
      // of all link with chat db
      offAllLinkWithChatDbByChatId(iNchatId);
      //check chat list for exist
      var  chatId           = iNchatId,
           myUid            = USER.getMyId();

       M_DATABASE.getRealtimeDataFromFirestoreDb (
          'chats',
          chatId,
          {
            'functionOnOther' : () => {

            },
            'functionOnChangeFromServer' : (chatData) => {
                    var chatId           = chatData.id;
                    var chatKey          = 'info'; //chatData.id;
                    var chatDataValue    = chatData.data();
                    console.log('safeAttachLiveLinkToChatElement functionOnChangeFromServer - chatId, chatDataValue',chatId, chatDataValue);
                    var chatObject      = {}; 
                      chatObject[chatKey] = chatDataValue.info;
                      var chatBlock     = chatDataValue.info;
                      var chatType      = chatDataValue.type;
                      var changeObject  = M_CATEGORY.getObjectForUpdateChatBlock ( chatObject );
                            changeObject['chatType'] = chatType;
                            changeObject['chatId']   = chatId;
                      // change chat
                      M_CATEGORY.safeUpdateChatBlock(changeObject,chatType);

            },
            'functionOnAdd' : (chatData) => {
                    //cloase loader after 2.5 second
                    M_VIEW.view.closeLoaderByTimeout(2500, '#menusBlock','forMenuListKey', 'indexCodeOfLoader' ); 

                   var  chatId    = chatData.id,
                        chatBlock = chatData.data(),
                        chatType  = chatBlock.type;

                    console.log('safeAttachLiveLinkToChatElement functionOnAdd - chatId, chatBlock',chatId, chatBlock);

                   //@< creating chat
                      if (chatType == 1) {
                          //create "private" chat
                          safeUpdatePrivateChatBlockFromUserDb( chatId, chatBlock.info, chatType , iNfunction); // changeObject
                      } else if (chatType == 2) {
                          //create "common" chat
                          safeUpdateCommonChatBlockFromUserDb ( chatId, chatBlock.info, chatType , iNfunction);
                      }
                  //@> creating chat
                  startNewMsgCounter(chatBlock,chatId,myUid);
            }
          }
       );
  }


  function safeUpdateCommonChatBlockFromUserDb (iNchatId,iNobject,iNchatType) {
    /*
        @discr
          create common chat 
        @inputs
          iNdata
              @required
                  iNchatId
                  iNobject
                      chatId || uuid 
                      userName
                      lmsgText
                      lmsgTime
                    @optional
                        uuid
                        newMsgCount
                        chatType (default 1 private)
                  iNchatType
          @depends
            findChatBlock - for find chatId object
    */
    var changeObject = {};
    var changeObject = M_CATEGORY.getObjectForUpdateChatBlock ( iNobject );

    changeObject['chatType'] = iNchatType;
    changeObject['chatId']   = iNchatId;

    if ( typeof iNobject != 'object' )          iNobject = {};
    if ( typeof iNobject['chat'] != 'object' )  iNobject['chat'] = {};

    if ( typeof iNobject['chat']['icon'] == 'string' ) 
        changeObject['icon'] = iNobject['chat']['icon'] ;

    if ( typeof iNobject['chat']['name'] == 'string' ) 
        changeObject['chatName'] = iNobject['chat']['name'] ;
    
    M_CATEGORY.safeUpdateChatBlock(changeObject);
  }


  function checkUserForHasMenuForMe (iNoptions) {
    /*
      @discr
        check user for has menu
      @inputs
        @optional
          iNoptions -> object
            @enum
              hasMenuForAuth -> number
              hasMenuForNoneAuth -> number
              hasMenuForAll -> number
    */
    if(typeof iNoptions == 'object') {
      // check menu for all
      if( typeof iNoptions.hasMenuForAll == 'number' && iNoptions.hasMenuForAll > 0) {
        return true;
      } else {
        // check menu for authUser (@) or nonAuth (-) or anonym (?)
        if( USER.getMyId() ) {
          // if we authed user
          if( typeof iNoptions.hasMenuForAuth == 'number' && iNoptions.hasMenuForAuth > 0) return true;
        } else {
          // if we non authed user
          if( typeof iNoptions.hasMenuForNoneAuth == 'number' && iNoptions.hasMenuForNoneAuth > 0) return true;

        }

      }
    }
    return false;
  }

  function safeUpdatePrivateChatBlockFromUserDb (iNchatId,iNobject,iNchatType,iNsuccessFunction) {
      /*
          @inputs
            iNdata
                @required
                    iNchatId
                    iNobject from chat firebase db
                        chatId || uuid 
                        userName
                        lmsgText
                        lmsgTime
                      @optional
                          uuid
                          newMsgCount
                          chatType (default 1 private)
                    iNchatType
            @depends
              findChatBlock - for find chatId object
      */

      var user2       = M_CATEGORY.userForPrivateChat(iNchatId);

      var usersRef    = firebase.database().ref( 'users/' + user2 );

      console.log('safeUpdatePrivateChatBlockFromUserDb - user2', user2);
      console.log('safeUpdatePrivateChatBlockFromUserDb - path', 'users/'+user2);
      console.log('safeUpdatePrivateChatBlockFromUserDb - iNchatId,iNobject,iNchatType',iNchatId,iNobject,iNchatType);

      function functWhenGet (usersData) {
          /*
            @inputs
              @required

          */
          var objForCreate  = {};
          var user2id       = usersData.id;
          var user2Object   = usersData.data();

          var chatId = iNchatId; // M_CATEGORY.view.getChatIdByUid(user2id);

          var chatName    = user2Object.info.data.name;
          var login       = user2Object.info.data.login;
          var user2Phone  = user2Object.info.data.phone;
          var user2Icon   = user2Object.info.data.icon;
          var userType    = user2Object.info.data.type;
          var userOnline  = user2Object.info.live.online;

          
          // create object for create chat
          var objForCreateChat = {}; // objForCreate;
              objForCreateChat['uuid']      = user2id,
              objForCreateChat['chatId']    = chatId,
              objForCreateChat['chatName']  = chatName,
              objForCreateChat['userPhone'] = user2Phone,
              objForCreateChat['icon']      = user2Icon,
              objForCreateChat['login']     = login;
              // user type (business (2) or user(1) or app of system (3) )
              objForCreateChat['userType']    = userType;
              objForCreateChat['userOnline']  = userOnline;

          // add user options
          if(typeof user2Object.info.options == 'object') {
            // check has menu
            var userHasMenu = checkUserForHasMenuForMe(user2Object.info.options);
            if(userHasMenu) {
              // add
              objForCreateChat['userHasMenu'] = 1;
            }
          } else {
            user2Object.info.options = {};
          }
          // add app for filter by side buttons
          if (typeof user2Object.info.options.apps == 'object') {
            // add user apps for filter
            objForCreateChat['appsForFilter'] = user2Object.info.options.apps.join(' ');
          }


          console.log('safeUpdatePrivateChatBlockFromUserDb objForCreateChat',objForCreateChat);
          delete objForCreateChat.liveData;
          M_CATEGORY.safeUpdateChatBlock (objForCreateChat,iNchatType);
          //getContatct 
          activeContactChangeInChatBlock(user2Phone);

          // safe invoke once iNsuccessFunction just one
          if (typeof iNsuccessFunction == 'function') {
            iNsuccessFunction();
            iNsuccessFunction = false;
          }
      }

      M_DATABASE.getRealtimeDataFromFirestoreDb (
            'users',
            user2,
            {
              'functionOnOther' : () => {

              },
              
              'functionOnChangeFromServer' : (dataFromDb) => {
                functWhenGet (dataFromDb);
              
              },
              
              'functionOnAdd' : (dataFromDb) => {
                functWhenGet (dataFromDb);
              }
            }
      );

  }

  function activeContactChangeInChatBlock (user2Phone){
      var myUid       = firebase.auth().currentUser.uid;
    // var contactsRef = firebase.database().ref('contacts/' + myUid + '/' + user2Phone);

      var functWhenGet = function function_name(argument) {
        var contactBlock    = contactData.val();
          if(contactBlock != null && typeof contactBlock == 'object') {
            var chatName        = contactBlock.name;
            var userPhone       = contactBlock.phone;
            var user2id         = contactBlock.uid;
            if( typeof chatName != 'string' || chatName.length > 0) return false;
          var chatId = M_CATEGORY.view.getChatIdByUid(user2id);
            M_CATEGORY.safeUpdateChatBlock(
                {
                    'uuid'      : user2id,
                    'chatId'    : chatId,
                    'chatName'  : chatName,
                    'userPhone' : userPhone
                },1//CHANGE IT
            );
        }
      }
      // get contact by phone
      M_DATABASE.getRealtimeDataFromFirestoreDb (
            'users' , myUid  + '/contacts'  ,
            {
              'whereEquilTo' : {
                'phone' : user2Phone
              },
              'functionOnOther' : () => {

              },
              
              'functionOnChangeFromServer' : (dataFromDb) => {
                functWhenGet (dataFromDb);
              
              },
              
              'functionOnAdd' : (dataFromDb) => {
                functWhenGet (dataFromDb);
              }
            }
      );

      // contactsRef.on('value', function(contactData) {
          
      // });
  }


//@<CONTROLLER MY ONLINE STATUS

  CONST['myOnlineStatusSpy']    = 'connectTimeoutId-spyMyOnlineStatus';
  CONST['myOnlineStatusState']  = 'connectMyOnlineStatusState';

  function controller_devise_run () {
    console.log('controller_devise_run run USER.getMyId()',USER.getMyId() );
    if ( USER.getMyId() ) {

      devise_onDisconectController();
      // set mousemove event for control my online status
      $( "html" ).off('mousemove');
      $( "html" ).mousemove( function( event ) {
        onEvent_devise_MousemoveController();
      });
    }
  } _.controller_devise_run = controller_devise_run;
  

  function devise_setStateIOnline () {
    let myOnlineState = devise_getMyOnlineState();
    if(myOnlineState != 1) {
      devise_setStateOnline();
    }
  }
    
    function devise_setStateOffline () {
        // set online status
        let path      = devise_getPathToDeviseTable();
        if(path === false) return false;
        let ref       = FIREBASE.database().ref(path);
        let onffineState   = devise_getObjectForWriteToDbBySetState(0);
        ref.update(onffineState);
    }
      
      
    function devise_getMyOnlineState () {
        /*
            @discr
              get online(@return 1)/onffine(@return 0)
            @inputs
            @return
              @type enumint 
              1 - online
              0 - offline
       */
      return parseInt(M_APP.get(CONST['myOnlineStatusState']))||0;
    }

    function devise_setMyOnlineState (iNstate) {
        /*
            @discr
              set online(@return 1)/onffine(@return 0)
            @inputs
              iNstate -> int
                @type enumint 
                  1 - online
                  0 - offline
            @return
       */
      M_APP.save(CONST['myOnlineStatusState'], iNstate);
    }

    function devise_setStateOnline (iNsuccessFunction) {
        // set online status
        let path      = devise_getPathToDeviseTable();
        if(path === false) return false;
        let ref       = FIREBASE.database().ref(path);
        var onlineState   = devise_getObjectForWriteToDbBySetState(1);
        ref.update(onlineState).then(function(dataSnapshot) {
          if(typeof iNsuccessFunction == 'function') iNsuccessFunction();
        });
    }
      function devise_getObjectForWriteToDbBySetState (iNval) {
        /*
            @discr
            @inputs
              iNvalue
       */
        const path          = devise_getPathToDeviseTable();
        if(path === false) return false;
        const onlineState   = iNval;
              // set online/offline state
              devise_setMyOnlineState(onlineState);
        const objectForAdd  = { 'online' : onlineState };
              // get user agent
              objectForAdd['uagent']  = ROUTING.getUserAgent();
              // get devise name
              objectForAdd['name']    = ROUTING.getDeviseName();
              objectForAdd['time'] = FIREBASE.database.ServerValue.TIMESTAMP;

              // if ( onlineState < 1) {
              //   //is offline flag

              // } else {
              //   //is online flag
              //   objectForAdd['timeout'] = FIREBASE.database.ServerValue.TIMESTAMP;
              // }

        var isDesktop =  ROUTING.isDesktop(); //#if desktop
        if( ROUTING.isDesktop() ) {
          // is desctop
          objectForAdd['type'] = 2;
        } else {
          // is browser
          objectForAdd['type'] = 1;
        }
        return objectForAdd;
      }

    function devise_getPathToDeviseTable () {
        let uid = USER.getMyId();
        let token     = USER.getMyToken();
        if(!uid || !token) return false;
        let path = "devises/" + uid + '/' + token;
        return path;
    }

    function devise_removeNoteFromDatabase () {
        /*
          @discr
            deleted note from firebase datebase for deleted from firestore by cloud functions
        */
        let path      = devise_getPathToDeviseTable();
        console.log('devise_removeNoteFromDatabase path',path);
        if(path === false) return false;
        FIREBASE.database().ref(path).remove().then(function() {
          console.log("devise_removeNoteFromDatabase Remove succeeded.")
        })
        .catch(function(error) {
          console.log("devise_removeNoteFromDatabase Remove failed: " + error.message)
        });;

    }
    // did global function
    M_APP.globalFunctions_create('devise_removeNoteFromDatabase',devise_removeNoteFromDatabase);
    _['devise_removeNoteFromDatabase'] = devise_removeNoteFromDatabase;

    function devise_onDisconectController () {
        let path      = devise_getPathToDeviseTable();
        if(path === false) return false;
        let ref           = FIREBASE.database().ref(path);
        var onlineState   = devise_getObjectForWriteToDbBySetState(1);
        var offlineState  = devise_getObjectForWriteToDbBySetState(0);
        ref.off();
        console.log('devise_onDisconectController path',path);
        // update online state then begin spy for disconect 
        devise_setStateOnline (
          () => {
            ref.on(
              'value',
              (iNdata) => {
                var value = iNdata.val();
                console.log('devise_onDisconectController value, iNdata',iNdata);
                console.log('devise_onDisconectController value, path',value, path);
                //if deleted this -> we signout from this account
                if(value === null) {
                  console.log('devise_onDisconectController NULL value, path',value, path);
                  // return;

                  USER.signOut(
                    () => {
                      // we've signed out successfull -> we open page for sign in
                      M_APP.getGlobalVar('engine').passToApp({'app':'page','page':'fullWindow','data':'id=sign&uid=@system'});
                      // SWEETALERT.swal(
                      //   '',
                      //   '?',
                      //   'question'
                      // );

                    },
                    () => {
                      // error
                      // SWEETALERT.swal();
                      
                    }
                  );

                  return;
                }
                // if i am not in online and my othere devise change my state
                if(value.online != 1 && devise_getMyOnlineState() == 1) {
                  // devise_setStateOnline ();
                  ref.update(onlineState);
                }
                ref.onDisconnect().set(offlineState);
              }
            );
          }
        )


        
    }
  //
  //

  function onEvent_devise_MousemoveController () {
    // set my status online safe (with check it already isset) DISABLE
    // devise_setStateIOnline();

    // clear previous timeout id
    clearTimeout(getMyStatusTimeoutId());
    // save time out and passed there function
    let timeOutId = setTimeout(
      () => {
        devise_setStateOffline();
      },
      300000 // 5 m (300 sc) 300000 ms
    );
    // sace timeout id
    setMyStatusTimeoutId(timeOutId);
  }
    function getMyStatusTimeoutId () {
      return M_APP.get(CONST['myOnlineStatusSpy']);
    }
    function setMyStatusTimeoutId (iNtimeOutId) {
      M_APP.save(CONST['myOnlineStatusSpy'],iNtimeOutId);
    }

//@>CONTROLLER MY ONLINE STATUS

  return _;

});
define ( 
  'c_app-base',[
    'm_app-base' , 'v_app-base', 'm_app', 'm_view', 'm_user', 'm_category'
  ] , 
  function (MODEL, VIEW,  M_APP , M_VIEW, USER, M_CATEGORY ) {

  const _ = {}; _['name'] = 'base';
  const CONST = {};
  // init pages const
  const pages = {}; _['pages'] = pages;
    //< page menu

        //< page index
          var thisPageName      = 'index';
          pages[thisPageName]   = {'attr':{},'menus':{},'functions':{}};
            pages[thisPageName]['attr'] = {
              'id2' : '2',
              'id3' : '3',
            };
            pages[thisPageName]['menus'] = {
              'attr' : {
                'id1' : 'id2',
                'id3' : 'id4'
              }
            };
            pages[thisPageName]['functions'] = {
              'isPage'  : function () { 
                let i =  ( M_APP.view.d_checkPageInListApp({app:'base','page':'index'}) > 0 ) ? true : false;
                console.log('isPage index i',i); 
                return i;
              },
              'onCreate': function (iNojbectData,iNojbectApp) {
                console.log('page index onCreate -iNojbectData,iNojbectApp',iNojbectData,iNojbectApp)

                // show loader
                M_VIEW.view.showLoader('#menusBlock','forMenuListKey', 'indexCodeOfLoader' ); 

                // get chat list
                if ( USER.getMyId() ) {
                  MODEL.getAllMyChats();
                }
              },
              'onView'  : function (iNojbectData,iNojbectApp) { 
                console.log('onView index iNojbectData,iNojbectApp',iNojbectData,iNojbectApp);


                // close loader from first html page
                M_VIEW.view.closeLoader(); 

                if(iNojbectData['back']) {
                  // add header with back btn for this list app - if we from page 'one'

                  // hide all menus 
                  M_CATEGORY.view.chat_offSelectEffects();

                } else {
                  // clear user menus if we come from 'one' page by click btn
                  // $('.usersBlockContainerInMenusBlock .app[app-name="base"] .view[view-name="index"] .scrolBlockForChat').html('');
                  
                  // view loader
                  // M_VIEW.view.showLoader('#menusBlock','forMenuListKey', 'indexCodeOfLoader' ); 
                }

                if(iNojbectData['filter']) {
                  // if clicked side buttons - setGlobalSetFilterForGetChats
                  M_APP.view.sideButtons_addSelectedEffectsByFilter(iNojbectData['filter']);

                  // set global filter for sort
                  M_CATEGORY.view.chat_setGlobalFilter(iNojbectData['filter']);

                  //create service chat list and move position to top
                  MODEL.chat_openChatWithCreateIfNotExist(iNojbectData);
                }

                // sort all chats
                M_CATEGORY.view.startEffSortChats();

                // add standart header for this list app
                MODEL.addStandartHeaderForListView();

                // hide user of menus (we open in page 'one')
                M_CATEGORY.view.chat_hideUserMenus();

                // hide all app in list
                M_APP.view.d_hideApps('all','list');

                // show this app in list
                M_APP.view.d_showApps('base','list');
                

                return true;
              },
              'onHide'  : function () { 
                  console.log('onHide index');
                  return true;
               },
              'onAppear'  : function () {
                  console.log('onAppear index');
              },
              'onDisappear'  : function () {
                  console.log('onDisappear index');
              },
              // 'setPage' : function () {console.log('app private','setPage'); return true;},
              'onCreate' : function (d,d1) { 
                M_APP.view.d_createPageInListApp({app:'base','page':'index','content': '<div class="scrolBlockForChat" style="" id="MixItUp81681F"></div>'}); 
              },
            };
          //>page index



          //< page one
            var thisPageName = 'one';
            pages[thisPageName]  = {'attr':{},'menus':{},'functions':{}};
              pages[thisPageName]['attr'] = {
                // 'id2' : '2',
                // 'id3' : '3',
              };
              pages[thisPageName]['menus'] = {
                'attr' : {
                  // 'id1' : 'id2',
                  // 'id3' : 'id4'
                }
              };
              pages[thisPageName]['functions'] = {
                'isPage'  : function () { 
                  let i =  ( M_APP.view.d_checkPageInListApp({app:'base','page':'index'}) > 0 ) ? true : false; 
                  console.log('isPage one i',i); 
                  return i;
                },
                'onView'  : function (d,d1) { 
                    console.log('onView one d,d1',d,d1);
                  // hide all app in list
                  M_APP.view.d_hideApps('all','list');

                  // show this app in list
                  M_APP.view.d_showApps('base','list');

                  // create chat
                  MODEL.request_getUserMenuByLogin(d['uid']);
                  return true;
                },
                'onAppear'  : function () {
                    console.log('onAppear one');
                    M_VIEW.view.closeLoader(); 
                    M_VIEW.view.showLoader('#menusBlock','forMenuListKey', 'indexCodeOfLoader'); 
                },
                'onDisappear'  : function () {
                    console.log('onDisappear one');
                },
                'onHide'  : function () { 
                  console.log('onHide one');

                  

                  return true;
                },
                // 'setPage' : function () {    return true;},
                'onCreate' : function (d,d1) { 
                  M_APP.view.d_createPageInListApp({app:'base','page':'index','content': '<div class="scrolBlockForChat" style="" id="MixItUp81681F"></div>'}); 
                },
              };
          //>page one



    //> page full window

  const options = {
    
  };
  // function overided getTemplate
  /* 
  function getTemplate (iNdata) {
     iNdata['other'] = VIEW.getAppContent();
   }
   _['getTemplate'] = getTemplate; 
   */

  // function overided onInit
  function onInit (iNstring,iNobject) {
    console.log('onInit - iNstring,iNobject',iNstring,iNobject);
    M_CATEGORY.view.initSort();
    //ddd
    MODEL.controller_devise_run();
    // get chat list
    if ( USER.getMyId() ) {
      MODEL.getAllMyChats();
    }
  }
  _['onInit'] = onInit;

  // function overided onCreate
  function onCreate (iNstring,iNobject) {
    // init global filter for sort
    M_CATEGORY.view.chat_initGlobalFilter();


    // create app block in list
    M_APP.view.d_createListApp({app:'base','other':VIEW.getAppContent()} ); 

    // init search input autocomplete
    MODEL.initForAutocompleteForSearch();

  }
  _['onCreate'] = onCreate;

  // function overided isApp
  function isApp (iNstring,iNobject) {
    
    return (M_APP.view.d_checkListApp({app:'base'}) > 0) ? true : false;
  }
  _['isApp'] = isApp;


  // function overided onInit
  // function onInit (iNstring,iNobject) {
    
  //   //

  // }
  // _['onInit'] = onInit;

    // function onIn
    function onIn (iNstring,iNobject) {
      
    }
    _['onIn'] = onIn;

      //@overide
      function onAppear (iNstring,iNobject) {


      }
      _['onAppear'] = onAppear;

      //@overide
      function onDisappear (iNstring,iNobject) {

      }
      _['onDisappear'] = onDisappear;

    //@overide
    function onOut (iNstring,iNobject) {

    }
    _['onOut'] = onOut;

  //@overide
  function onDeinit (iNstring,iNobject) {

  }
  _['onDeinit'] = onDeinit;


  function onHide () {
    return true;
  }
  _['onHide'] = onHide;



  return _;
});
define('v_app-page',['v_view'],function(v_view){
	const _ = {};
	const templates = {};
	//< template for modal window
		    templates['fullWindow'] = `
				<div class="appModalFullWindow background" {{#if attr}}{{attr}}{{/if}}>
					{{#if defaultHeaderBlock}}
					    <div class="headerForAppFullWindow background">
							{{#if defaultCloseButton}}
					    		<div class="closeButtonInHeaderForAppFullWindow"></div>
					    	{{/if}}
						</div>
					{{/if}}
				    <div class="contentForAppFullWindow background">
				    	{{content}}
				    </div>
				</div>
			`;
			templates['header-miniPage'] = `
				<div class="appPageCloseButton" title="[[appPageCloseTitle]]"></div>
		        <div class="appPageIconDataBlock">
		            <img class="appPageIcon" src="{{icon}}">
		            <div class="appPageDataBlock">
		               <div class="appPageName">{{title}}</div>
		               <div class="appPageDiscr">{{text}}</div>
		            </div>
		        </div>
         	`;

	//@< work with mini page
		function getMiniPageHeader (iNdata) {
			/*
				@discr
					get content by template for header mini page
				@inputs
					@required
						iNdata -> object
							@required
								title 	=> string
								text 	=> string
							@optional
								icon 	=> string
			*/
			var temp = Template7.compile(templates['header-miniPage']);
			return temp(iNdata);
		}
		_['getMiniPageHeader'] = getMiniPageHeader;
	//@> work with mini page
	//----------------------//
	//@< work with modal window
		function addFullWindowByTemplate (iNdata) {
			/*
				@discr
					add content by template to chief @container
				@inputs
					@required
						iNdata -> object
							@required
								content
							@optional
								defaultHeader => bool
								defaultCloseButton => bool
			*/
			// del other pages
			$('.appModalFullWindow.background').remove();
			// get content by template
			var temp = Template7.compile(templates['fullWindow']), selector = 'body #container';
			// add data to view
			v_view.d_addDataToViewEl(selector,temp(iNdata));
		}
		_['addFullWindowByTemplate'] = addFullWindowByTemplate;

		

		function showFullWindow () {
			/*
				@discr
					hide full window element
				@inputs
					@required
			*/
			$('.appModalFullWindow').show();
			
		}
		_['showFullWindow'] = showFullWindow;

		function hideFullWindow () {
			/*
				@discr
					hide full window element
				@inputs
					@required
			*/
			$('.appModalFullWindow').hide();
			
		}
		_['hideFullWindow'] = hideFullWindow;

		function clearFullWindow () {
			/*
				@discr
					remove full window dom element
				@inputs
					@required
			*/
			$('.appModalFullWindow').remove();
		}
		_['clearFullWindow'] = clearFullWindow;
	//@> work with modal window



	return _;
});
define( 'm_app-page',['jquery','dictionary','m_view','v_app-page','m_app','m_user','mediaStreamRecorder', 'url'] , function ($,DICTIONARY, M_VIEW,VIEW,M_APP,M_USER,MEDIA, URL) {

  // init result const
  const _ = {};

 





  function openPage (iNuid,iNid) {
    /*
      @discr
        open page by iNuid and iNid
      @inputs
        iNuid -> string
        iNid  -> string
      @return
      @algoritm
        1 - get page object from server
        2 - safe add js and css
        3 - view page fullwindow
    */
  }

  function getPage (iNdata,iNfunction) {
    /*
      @example
        getPage ({'uid':'@system','id':'sign'}, function (_) { console.log('_',_)})
      @discr
        get page by iNuid and iNid from server
      @inputs
        iNuid -> string
        iNid  -> string
      @return
      @algoritm
        1 - get page object from server 
    */
    $.get (
      URL.db.api.page.get, 
      iNdata,
      function (iNcontent) {
        iNfunction(iNcontent);
      },
      'json'
    );
  };
    function processingData (iNdata) {
      /*
        @example
          add scrips and styles vire
        @discr
          get page by iNuid and iNid from server
        @inputs
          iNuid -> string
          iNid  -> string
        @return
        @algoritm
          1 - get page object from server 
      */
      var c = 'pageId' + iNdata['id'] + ' headerFromPage';
      if(typeof iNdata == 'object') {
        var obj = iNdata['header'];
        if ( typeof obj['css']  == 'object' && obj['css'].length > 0 ) {
          // add css
          for ( var i in obj['css'] ) {
            M_APP.view.d_loadCSS (obj['css'][i],c);
          }
        }
        if ( typeof obj['js']   == 'object' && obj['js'].length > 0 ) {
          // add js
          for ( var i in obj['js'] ) {
            M_APP.view.d_loadJS (obj['js'][i],c);
          }
        }
      }
    }; 

    function addPageToFullWindow (iNdata) {
        getPage ( 
          iNdata,
          function (iNresult){ 
            // translate content
            var content = DICTIONARY.withLanguageObject(iNresult['content']);
            //add content
            VIEW.addFullWindowByTemplate( { 'content' : content } );
            //add headers
            processingData(iNresult);
            //add events default pages
            addActionForEvents(iNdata['id']);
            //hide loader
            M_VIEW.view.closeLoader(); 
          }
        );
    } _.addPageToFullWindow = addPageToFullWindow;



    function addMiniPageToAppView (iNdata) {
        getPage ( 
          iNdata,
          function (iNresult){ 
            //add content head
            var head = iNresult['head'];
            if(typeof head == 'object')
              var objForAddHeader = {
                'title' : DICTIONARY.withLanguageObject(head['title']),
                'text'  : DICTIONARY.withLanguageObject(head['text']),
                'icon'  : DICTIONARY.withLanguageObject(head['icon'])
              }
            M_APP.view.safeViewAppHeaderWithContent (
              {
                app       : 'page',
                page      : 'miniPage',
                content   : VIEW.getMiniPageHeader(objForAddHeader)
              },
              'change'
            );

            //@< add content body 
            M_APP.view.d_createChiefApp(
              {
                app       : 'page'
              }
            );

            // translate content
            var content = DICTIONARY.withLanguageObject(iNresult['content']);

            M_APP.view.d_createPageInChiefApp(
              {
                app       : 'page',
                page      : 'miniPage',
                content   : content
              }
            );
            //@> add content body 

            //add headers
            processingData(iNresult);

            //add events default pages
            //hide loader
            M_VIEW.view.closeLoader(); 
          }
        );
    } _.addMiniPageToAppView = addMiniPageToAppView;

    function clearMiniPage () {
      deleteHeaders();
      M_APP.view.d_removeAppHeader({'app':'page'});
      M_APP.view.d_removeApps('page');
    }

  function deleteHeaders () {
    /*
      @example
      @discr
        get page by iNuid and iNid from server
      @inputs
        @required
      @return
      @algoritm
        1 - clear page
    */
    $('.headerFromPage').remove();
  }
  
  function clearFullWindow () {
    deleteHeaders();
    $('.appModalFullWindow').remove();
  } _.clearFullWindow = clearFullWindow;

  
  // _['init'] = function () {
  //   M_APP.setGlobalApp(this);
  //   return this;
  // }

  // ever
    function addActionForEvents (iNid) {
      if(iNid == 'sign')
        addActionsForEventsPageSign();
    }

      function addActionsForEventsPageSign () {
        $('.appPageCloseButton').click(function(){
          M_APP.getGlobalVar('engine').passToApp({'app':'base', 'page':'index', 'data': '' }); // 'user':'',
        });
      }

      function addActionsForEventsPageSign () {
        $('.page-formSignIn').submit(function(e){
          e.preventDefault();
          return M_USER.sendForm('.page-formSignIn');
        });
        $('.page-formSmsCode').submit(function(e){
          e.preventDefault();
          return M_USER.checkSmsCode(this);
        });
        $('.page-formSignUp').submit(function(e){
          e.preventDefault();
          return M_USER.signUpByUserAndPswd(this);
        });
        $('.page-reSendSms').click(function(){
          return M_USER.reSendSms()
        });
      }
  // ever


  return _;

});
define( 'c_app-page',['m_app-page','v_app-page',] , function ( MODEL, VIEW ) {

  // init result const
  const _ = {};
  const name = 'page';
  _['name'] = name;  


  
  var thisPageName;

  // init pages const
  const pages = {}; _['pages'] = pages;
    //< page fullWindow
        pages['fullWindow']  = {'attr':{},'menus':{},'functions':{}};
          pages['fullWindow']['attr'] = {
            'id2' : '2',
            'id3' : '3',
          };
          pages['fullWindow']['menus'] = {
            'attr' : {
              'id1' : 'id2',
              'id3' : 'id4'
            }
          };
          pages['fullWindow']['functions'] = {
            'isPage'  : function () {return true;},
            'onOut'  : function () { return true;},
            'onView'  : function (inputData,inputApp) {
              MODEL.addPageToFullWindow({'id':inputData['id'],'uid':inputData['uid']});
              // VIEW.addFullWindowByTemplate({'content':'Hellow World!!!'}); 
              return true;
            },
            'onHide'  : function () {  return true;},
            // 'setPage' : function () { return true;},
            'onCreate' : function () {  return true;},
            'onDisappear' : function () {return true;},
          };
    //> page fullWindow

    //< page miniPage
        thisPageName = 'miniPage';
        pages[thisPageName]  = {'attr':{},'menus':{},'functions':{}};
          pages[thisPageName]['attr'] = {};
          pages[thisPageName]['menus'] = {};
          pages[thisPageName]['functions'] = {
            'onInit' : () => {

                if( !M_APP.getAppFromStoryLog('base') ) {
                      // if app base not open yet -> we load
                    M_APP.getGlobalVar('engine').passToApp( {'app':'base','page':'index'} );
                }

            },
            'isPage'  : function () {
              return true;
            },
            'onOut'  : function () {
              return true;
            },
            'onView'  : function (iNdata, iNobject) {
              /*
                getPage -> checkData
                create app view with page 
                create header view with page
              */
              MODEL.addMiniPageToAppView({'id':iNdata['id'],'uid':iNdata['uid']});
              return true;
            },
            'onHide'  : function () {
              return true;
            },
            'onCreate' : function () {

              return true;
            },
            'onDisappear' : function () { return true;},
          };
    //> page miniPage
  

  const options = {
    'attr'  : {
      'attr' : {
        'id2' : '2',
        'id3' : '3',
      }
    },
    // options for list app menus
    'menus': {
      'attr' : {
        'id2' : '2',
        'id3' : '3',
      }
    }
  };
  _['options'] = options;


  // function setApp
  // function setApp (iNstring,iNobject) {

  // }
  // _['setApp'] = setApp;

  //@overide
  function onHide (iNstring,iNobject) {
    MODEL.clearFullWindow();

  }
  _['onHide'] = onHide;


    //@overide
  function onView (iNstring,iNobject) {

  }
  _['onView'] = onView;


  // function onCreate
  function onCreate (iNstring,iNobject) {

  }
  _['onCreate'] = onCreate;

  // function isApp
  function isApp (iNstring,iNobject) {
    return true;
  }
  _['isApp'] = isApp;


  // function onInit
  function onInit (iNstring,iNobject) {

  }
  _['onInit'] = onInit;

    // function onIn
    function onIn (iNstring,iNobject) {
    }
    _['onIn'] = onIn;

      // function onAppear
      function onAppear (iNstring,iNobject) {

      }
      _['onAppear'] = onAppear;

      // function onDisappear
      function onDisappear (iNstring,iNobject) {
      }
      _['onDisappear'] = onDisappear;

    // function onOut
    function onOut (iNstring,iNobject) {
    }
    _['onOut'] = onOut;

  // function onDeinit
  function onDeinit (iNstring,iNobject) {

  }
  _['onDeinit'] = onDeinit;


  return  _;

});
define('m_engine',['jquery','m_routing','v_view','m_app','c_app-chat','c_app-base','c_app-page','m_user'], function ($,ROUTING,V_VIEW,M_APP,APP_CHAT,APP_BASE,APP_PAGE, USER) {


	function _startUrl () {
		ROUTING.startUrl(this);
	}
	var THIS = this;
	var setInitEvents = () => {
		$('body').on( "click", ".connect_href", function () {
					console.log(".connect_href .appHref click 1 ");
			if ( $(this).hasClass('appHref') == true ) {
				var app 	= $(this).attr('app-name'),
					page 	= $(this).attr('page-name'),
					data 	= $(this).attr('data');
					console.log(".connect_href .appHref click 2 ");
		        	M_APP.getGlobalVar('engine').passToApp({'app': app ,'page': page ,'data': data });
			} 
		});

		$('body').on( "click", ".connect_system_href", function (event)  {
			var thisDom = event.currentTarget;
			var code_href = $(thisDom).attr('code_href');
			switch (code_href) {
				case "signOut":
					systemHrefSignOut();
				break;

				case "signIn":
					systemHrefSignIn();
				break;

				case "toHome":
					systemHrefToHome();
				break;
			}
		});
	}
		function systemHrefSignIn () {
			let user = USER.getMyLogin();
			
          	M_APP.getGlobalVar('engine').passToApp ( 
				{ 
					'app'	: 'page', 
					'page'	: 'fullWindow', 
					'user'	: user, 
					'data'	: 'id=sign&uid=@system' 
				} 
			);
		}

		function systemHrefSignOut () {
			// sign out if we in main domain
			// if ( !ROUTING.getUserDomain () ) {
				USER.signOut(
					() => {
						M_APP.getGlobalVar('engine').passToApp ( 
							{ 
								'app'	: 'page', 
								'page'	: 'fullWindow', 
								'user'	: 'anonym', 
								'data'	: 'id=sign&uid=@system' 
							} 
						);
					}
				);
			// }
		}

		function systemHrefToHome () {
			var user = USER.getMyLogin(), obj;
			if ( !ROUTING.getUserDomain () ) {
				// if main domain
				obj = {'app':'base', 'page':'index', 'user': user, 'data': '' } ;
			} else {
				// if subdomain
				obj = {'app':'base', 'page':'index', 'data': '' } ;

			}

			M_APP.getGlobalVar('engine').passToApp(obj);
		}

	var init = () => {
		setInitEvents();
	}

	/*?<<< APP PATCH */
		function _toBackApp () {
			if( window['connectAppPath'].length > 1 && window['connectAppPathNumber'] > 0) {
				window['connectAppPathNumber']--;
				var thisObject = window['connectAppPath'][window['connectAppPathNumber']];

				ROUTING.prepareUrl(thisObject);
				ROUTING.startUrl(this,'toBackApp');

	    		return true;
	    	}
	    	return false;
		} 

	    function _toUpApp () {
	    	if( window['connectAppPath'].length > (window['connectAppPathNumber'] + 1) && window['connectAppPathNumber'] > -1) {
				window['connectAppPathNumber']++;
				var thisObject = window['connectAppPath'][window['connectAppPathNumber']];

				ROUTING.prepareUrl(thisObject);
				ROUTING.startUrl(this,'toUpApp');

	    		return true;
	    	}
	    	return false;
	    } 
	/*?>>> APP PATCH */


	/*?<<< APP */
		function _passToApp (iNdata, iNthis) {
			/*
				@inputs
				@required
					iNdata -> object
						@required
							app
							page
						@optional
							data
							user
			*/
			// if we are in subdomain and subdomain == user we delete it
			if ( 
				ROUTING.isBrowser() && (
					( typeof iNdata['user'] != 'undefined' && ROUTING.getUserDomain () == iNdata['user']) || 
					( typeof iNdata['user'] == 'string' && iNdata['user'] == 'anonym'  && ROUTING.getUserDomain ()) 
				)
			) {
				console.log('_passToApp isBrowser del user');
	        	// delete user
	        	delete iNdata['user'];
			}

			console.log('_passToApp iNdata',iNdata);
			let thisObject = this;
			if (typeof iNthis != 'undefined') thisObject = iNthis;
			ROUTING.prepareUrl(iNdata);
        	ROUTING.startUrl(thisObject);
		}
		function _openApp ( iNdata, iNstring,iNfunction) {
			/*
				@disc
					open app
						check funcitons optional
						check apps
						check pages
						
				@input
					@input
						@required
							iNdata
								@required
									app
									page
								@optional
									extra
									content
									other
						@optional
							iNtype

				@deps
					function : M_APP
			*/
			// M_APP.openChiefApp (iNdata,iNapp,iNfunction); 
			// get module name by app name
			var app, page, objForOpenApp = iNdata, appName = objForOpenApp['app'], pageName = objForOpenApp['page'];
			app = getAppByName(appName);
			console.log('_openApp objForOpenApp',objForOpenApp);
			console.log('_openApp app',app);
			console.log('_openApp iNdata',iNdata);
			console.log('_openApp iNstring',iNstring);
			M_APP.openChiefApp (iNdata,app,iNstring,iNfunction);
		}

		function _closeApp (iName,iNpage) {
			/*
				@disc
				@deps
					function : getAppByName
			*/

			//get module name by app name
			var app = getAppByName(iName);
			app.onDisappear();
			app.onClose();
		}

		var APP_PAGE_INSTANCE;
		
		function getAppByName(iName){
			/*
				@disc
				@ipputs
					iName -> string
				@return
					+: object
					-: false -> bool 
			*/
			switch (iName) {
				case "chat":
					return APP_CHAT;
				break;

				case "onepay":
					return APP_ONEPAY;
				break;

				case "market":
					return APP_MARKET;
				break;

				case "page":
					return APP_PAGE;
				break;

				case "base":
					return APP_BASE;
				break;

				default:
					return false;
				break;

			}
		}

		function getAppBySafe () {

		}
			function getGlobalAppRef () {

			}
	/*?>>> APP */

	return {
		//aps
		openApp  		: _openApp,
		closeApp  		: _closeApp,
		passToApp  		: _passToApp,
		// routing
		startUrl		: _startUrl,
		prepareUrl 		: ROUTING.prepareUrl,

		toUpApp 		: _toUpApp,
		toBackApp 		: _toBackApp,
		init 			: init,



	}
});
/*
	@schema
		time
		localStorage 
*/;
define('m_synchronize',['jquery','m_user','m_app','m_firebase'],function( $, USER, M_APP, FIREBASE ) {
	//'m_moment','m_user','m_app' ++ MOMENT,USER,M_APP
	const _ = {}; // 'view':VIEW
	// const MESSAGING = FIREBASE.messaging();
	const CONST 	= {};
		CONST['flagUserSignIn'] 	= '@connectFlagForSync_UserSignIn';
		CONST['flagReloadPage'] 	= '@connectFlagForSync_reload';


	const DOMAIN 	= "https://ramman.net";




	var lastCopyLocalStorage = '';
	function listenerForRunInSubdomain (event) {
		if (event.origin != DOMAIN) {
		  return;
		}
		var inputObj = event.data;
		if(typeof inputObj != 'object') return false;
		// restart interval
		startIntervalForSubDomain(event);

		console.log('listenerForRunInSubdomain inputObj',inputObj);
		if (inputObj['command'] == 'mainDomainSignedOut' ) {
			// our main domain signed outed -> we open sign in page
			M_APP.getGlobalVar('engine').passToApp ( 
				{ 
					'app'	: 'page', 
					'page'	: 'fullWindow', 
					'user'	: 'anonym', 
					'data'	: 'id=sign&uid=@system' 
				} 
			);

		} else if ( inputObj['command'] == 'getLocalStorage' ) {
		  /* DISABLE 

		  let lStorage = getLocalStorage();
		  // save last copy
		  setLastSentLocalStorage(lStorage);
		  // send message to DOMAIN
		  event.source.postMessage( {'command':'saveLocalStorage','content':lStorage} , event.origin);
		  // start interval spy for changing funciton

		  */
		} else if  (inputObj['command'] == 'saveLocalStorage' && inputObj['content']) {

		  // save change in local storage
		  writeLocalStorage(inputObj['content']);
	  	  setLastSentLocalStorage(inputObj['content']);


	      //of other reload functions
	  	  clearInterval(window.connectTimeoutIdSunchronizelistenerForRunInSubdomain);
	  	  if ( USER.getMyId() != USER.getMyIdFromObj(inputObj['content']) ) {
	  	  	 // create new function
	  	  	 var funcForSync = () => {
	  	  	 	 window.connectTimeoutIdSunchronizelistenerForRunInSubdomain = setTimeout (
		  			() => { 
			  	  		if ( USER.getMyId() != USER.getMyIdFromObj(inputObj['content']) ) {
						  	location.reload(true) 
					    }
				  	},
		  			500
				  );
	  	  	 }
	  	  	 // if our subdomain user signIn we signOut and then add new user 
	  	  	 if ( USER.getMyId() ) {
	  	  	 	FIREBASE.auth().signOut().then( 
					() =>  {
					// invoke success function
						funcForSync();
					}, (error) => {
						console.warn('listenerForRunInSubdomain $error',error);
					}
				);
	  	  	 } else {
				// invoke success function
	  	  	 	funcForSync();
	  	  	 }


	  		 
	  	  }
		}
	}








	//
	//
	//
		function synchronizeFile_getSubDomain () {
			return CONST['subdomainForSynchronizeFile'];
		}

		function synchronizeFile_setSubDomain (subDomain) {
			CONST['subdomainForSynchronizeFile'] = subDomain;
		}

		function synchronizeFile_listener (event) {

			var subDomain = synchronizeFile_getSubDomain();

			if (event.origin != subDomain) {
			return;
			}
			var inputObj = event.data;
			if(typeof inputObj != 'object') return false;


			console.log ('synchronizeFile_listener inputObj',inputObj);
			if ( inputObj['command'] == 'signOut' ) {
				console.log ('synchronizeFile_listener signOut');
				FIREBASE.auth().signOut().then( 
					() =>  {
						// clear local storage
						M_APP.clear();
						// for reload main domain
						M_APP.saveLocalStorage ( CONST['flagReloadPage'], true );
						// send to sub domain command that main domain signed out
						synchronizeFile_sendDataToSubDomain({'command':'mainDomainSignedOut'});
						// funcOnSuccess();
					}, (error) => {
						console.warn('synchronizeFile_listener $error',error);
					}
				);
			} else if (inputObj['command'] == 'getLocalStorage') {
				//
				let lStorage = M_APP.getStringOfLocalStorage();
				// save last copy
				setLastSentLocalStorage(lStorage);
				// send message to subdomain
				event.source.postMessage({'command':'saveLocalStorage','content':lStorage}, event.origin);

			} else if  (inputObj['command'] == 'saveLocalStorage' && inputObj['content']) {

				var funcOnSuccess = (iNadditionaFunction) => {
					// save change in local storage
					setLastSentLocalStorage(inputObj['content']);
					writeLocalStorage(inputObj['content'],false);
					if(typeof iNadditionaFunction == 'function') iNadditionaFunction();
				}
				//check flags
					//flag
					var inputObjectOfStringContent = JSON.parse(inputObj['content']);
					if( typeof inputObjectOfStringContent[ CONST['flagUserSignIn'] ] != 'undefined' ) {
						//if user signIned in subdomain -> we add reload flag
							// del flag
							delete inputObjectOfStringContent[ CONST['flagUserSignIn'] ];
							// save for add to local storage later
							inputObj['content'] =  JSON.stringify(inputObjectOfStringContent);
							if ( USER.getMyId() ) {
					  	  	 	FIREBASE.auth().signOut().then( 
									() =>  {
										// invoke success function with post add reload flag for main domain NOT in synchronize file
										funcOnSuccess(
											() => {
												M_APP.saveLocalStorage ( CONST['flagReloadPage'], true );
											}
										);
									}, (error) => {
										console.warn('synchronizeFile_listener $error',error);
									}
								);
					  	  	} else {
								// invoke success function with post add reload flag for main domain NOT in synchronize file
					  	  	 	funcOnSuccess(
									() => {
										M_APP.saveLocalStorage ( CONST['flagReloadPage'], true );
									}
								);
					  	  	}

					} else {
						// if usual data
						funcOnSuccess();
					}
			}
		}

		function synchronizeFile_sendDataToSubDomain (iNdata) {
			let subdomain = synchronizeFile_getSubDomain();
			parent.postMessage( iNdata, subdomain );
		}

		function synchronizeFile_startInterval () {
			/*
				@discr
					send to parent window localstorage when we change
				@inputs
			*/
		    clearInterval ( synchronizeFile_getIntervalId() );
			let intervalId = setInterval (
			  () => {
			    // spy for changing local storage -> for send to subDomain
			    let lStorage    = getLastSentLocalStorage();
			    let realStorage = M_APP.getStringOfLocalStorage();
			    if ( lStorage != realStorage ) {
			      //save last localstorage
			      setLastSentLocalStorage(realStorage);
			      //send to subdomain our local storage
			      synchronizeFile_sendDataToSubDomain ( { 'command': 'saveLocalStorage', 'content': realStorage } );
			    }
			  }
			  ,
			  250
			);
			synchronizeFile_setIntervalId(intervalId);
		}

		function synchronizeFile_getIntervalId () {
		    return CONST['intervalIdForSynchronizeFile']||false;
		}

		function synchronizeFile_setIntervalId (iNdata) {
	        CONST['intervalIdForSynchronizeFile'] = iNdata;
	    }

	    function synchronizeFile_initListener () {
	       if (window.addEventListener) {
	        window.addEventListener("message", synchronizeFile_listener);
	      } else {
	        // IE8
	        window.attachEvent("onmessage", synchronizeFile_listener);
	      }
	    }

		function synchronizeFile_run (iNsubdomain) {
			// set subdomain
			synchronizeFile_setSubDomain(iNsubdomain);

	    	//when this frame ready
	    	synchronizeFile_startInterval();


			// init listener
			synchronizeFile_initListener();

	    }
	    _['synchronizeFile_run'] = synchronizeFile_run;
	//
	//
	//


	function attachForEventOnMessage (iNlistenerForRunInSubdomain) {
		if ( window.addEventListener ) 
			window.addEventListener("message", iNlistenerForRunInSubdomain);
		else // IE8
			window.attachEvent("onmessage", iNlistenerForRunInSubdomain);
		
	}

	function attachMessageOnEvent () {
		attachForEventOnMessage(listenerForRunInSubdomain);
	}



	function getLastSentLocalStorage () {
		return lastCopyLocalStorage||'';
	}
	function setLastSentLocalStorage (iNstring) {
		return lastCopyLocalStorage = iNstring;
	}

	function writeLocalStorage(data, iNclear) {
		// defaul we enabe clear
		if(typeof iNclear != 'boolean') iNclear = true;
		// clear local storage -> creating new storage what get from  origin domain ramman.net
		if( iNclear ) {
			// clear local storage for full update
			M_APP.clearLocalStorage();
		}

		// get sage object
		if(typeof data == 'string')
			var o = JSON.parse(data);
		else
			var o = data;

		// creating new localstorage
		for (var property in o) {
		  if (o.hasOwnProperty(property)) {
		      localStorage.setItem(property, o[property]);
		  }
		}


	}
	function isEquilWithLocalStorage (data) {
		var o;
		if(typeof data == 'string')
		    o = JSON.parse(data);
		  else
		    o = data;
		  for (var property in o) {
		      if (o.hasOwnProperty(property)) {
		          if( localStorage.getItem(property) != o[property] ) {
		            return false;
		          }
		      }
		  }
		  return true;
	}
	function sendMessageToFrame (iNobject) {
		$('#frameSynchronize').get(0).contentWindow.postMessage(iNobject, "https://ramman.net");
	}
	_['sendMessageToFrame'] = sendMessageToFrame;
	// function setOnEventLoadFrameFunc (iNfunction) {
	// 	$('#frameSynchronize').on('load',iNfunction);
	// }


	function getLocalStorageFromFrame () {
		var objForSendToFrame = { 'command' : 'getLocalStorage'};
		sendMessageToFrame( objForSendToFrame );
	}

	function runForSubDomain () {
		// attach events
		attachMessageOnEvent ();
		// get local storage for start interval function at him when fram loaded
		// setOnEventLoadFrameFunc (
		// 	() => {
		// 		getLocalStorageFromFrame ();
		// 	}
		// );
		// start interval
		startIntervalForSubDomain();
	}
	_['runForSubDomain'] = runForSubDomain;

	function runForMainDomain () {
		// if we have flag () in our local storage we reload

		// star interval func for main domain
		clearInterval(CONST['intervalIdForMainDomain']);
	    CONST['intervalIdForMainDomain'] = setInterval (
	      () => {
	      	// need flag name
			let flagForReloadName = CONST['flagReloadPage'];

			// if we have this flag in our local storage -> we have to reload our page
			if ( M_APP.getFromLocalStorageByKey(flagForReloadName) ) {
				//del flag from local storage
				M_APP.del(flagForReloadName) 
				//reload
				location.reload(true);
			}
	      },
	      500
        );
	}
	_['runForMainDomain'] = runForMainDomain;

	function subDomain_synchronizeLocalStorage () {
		var tempStorage = M_APP.getTempStorage();
        if( typeof tempStorage == 'object' && Object.keys(tempStorage).length > 0 ) {
          //send
          // setLastSentLocalStorage(realStorage);
          sendMessageToFrame( { 'command':'saveLocalStorage', 'content': JSON.stringify(tempStorage) });

          // clear temp storage
          M_APP.clearTempStorage();
        }
	}
	_['subDomain_synchronizeLocalStorage'] = subDomain_synchronizeLocalStorage;

	function subDomain_sendCommandForSignOut () {
		/*
			@discr
				Send to synchronize file signOut command
		*/
		console.log('subDomain_sendCommandForSignOut start');
		sendMessageToFrame ( { 'command':'signOut' } );
	}
	_['subDomain_sendCommandForSignOut'] = subDomain_sendCommandForSignOut;

	function startIntervalForSubDomain () {
		// attach listenerForRunInSubdomain to on message

		subDomain_clearIntervalFunction();

	    CONST['intervalIdForSubdomain'] = setInterval (
	      () => {
	        // spy for changing local storage -> for send to subDomain
	        // var lStorage    = getLastSentLocalStorage();
	        subDomain_synchronizeLocalStorage();
	      }
	    ,
	    500
	    );
	}

	function subDomain_clearIntervalFunction () {
		clearInterval(CONST['intervalIdForSubdomain']);
		// body...
	}
	_['subDomain_clearIntervalFunction'] = subDomain_clearIntervalFunction;

	return _;
});
// monitor js crash service - https://sentry.io/

require2.config({
        // baseUrl: 'https://ramman.net/files/', //',
        waitSeconds: 59,



        // packages: [{
        //     name: 'moment',
        //     // This location is relative to baseUrl. Choose bower_components
        //     // or node_modules, depending on how moment was installed.
        //     location: 'res/js/moment',
        //     main: 'moment'
        // }],
        paths: {
            'firebase'             : 'res/js/firebase/firebase', //['https://www.gstatic.com/firebasejs/4.6.0/firebase'             ], // , 'res/js/firebase/firebase' https://www.gstatic.com/firebasejs/4.2.0/firebase
            'firestore'            : 'res/js/firebase/firestore', //['https://www.gstatic.com/firebasejs/4.6.0/firebase-firestore' ], // , 'res/js/firebase/firestore' https://www.gstatic.com/firebasejs/4.2.0/firestore
            'template7'            : 'res/js/template7/template7',
            //algolia service
            'algolia'              : "res/js/algolia/algoliasearch.min",//["https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min"],

            // "yametrika"            : 'res/js/analytics/yandex/metrika',//["//mc.yandex.ru/metrika/watch","res/js/analytics/yandex/metrika"],
            // A BEAUTIFUL, RESPONSIVE, CUSTOMIZABLE, ACCESSIBLE (WAI-ARIA) REPLACEMENT FOR JAVASCRIPT'S POPUP BOXES
            "sweetalert2"          : "res/js/sweetalert2/sweetalert2",
            // A high-performance, dependency-free library for animated filtering, sorting, insertion, removal and more
            "mixitup"              : 'res/js/mixitup/mixitup.min',
            // JS error monitor 
            // 'Raven'                : "https://cdn.ravenjs.com/3.20.1/raven.min.js";
            
            //@< jquery
                //sourse library
                'jquery'               : 'res/js/jquery/jquery',
                // for algolia autocomplete
                "jquery.autocomplete"  : "res/js/algolia/autocomplete.jquery.min",//"https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min",

                //timer block
                'jquery.countdown'     : 'res/js/jquery/countdown/jquery.countdown.min',
                'jquery.plugin'        : 'res/js/jquery/countdown/jquery.plugin.min',

                //text effects
                'jquery.appear'        : 'res/js/jquery/jquery.appear',
                "jquery.textillate"    : "res/js/jquery/jquery.textillate",
                "jquery.lettering"     : "res/js/jquery/jquery.lettering",
            //@> jquery
            'lazyload'             : 'res/js/lazyload/lazyload',
            // 'rx'                   : 'res/js/rxjs/rx.min',
            // Parse, validate, manipulate, and display dates and times in JavaScript.
            'moment'               : 'res/js/moment/moment',
            // A platform detection library
            'platform'             : 'res/js/platform/platform',
            // A audio player
            // 'Howl'              : 'res/js/players/audio/howler/howler.min',

            // A progresbar library
            'progressbar'         : 'res/js/progressbar/progressbar.min',



            // Audio and Video recorder
            'mediaStreamRecorder'  : 'res/js/recorder/mediaStreamRecorder/MediaStreamRecorder',
            'WebAudioRecorder'     : 'res/js/recorder/webAudioRecorder/lib/WebAudioRecorder',
            // 'WebAudioRecorder'     : 'res/js/recorder/webAudioRecorder/lib/WebAudioRecorder',
            'Recorder'             : 'res/js/recorder/OggOpusRecorder/dist/recorder.min',

            // 'MediaRecorderWrapper' : 'res/js/recorder/mediaStreamRecorder/MediaRecorderWrapper',

            /*<? views */
                'v_view'           : 'mvc/view/view',
                'v_app'            : 'mvc/view/app',
                'v_category'       : 'mvc/view/category',

                'v_call'           : 'mvc/view/call',
                'v_message'        : 'mvc/view/message',
                'v_contact'        : 'mvc/view/contact',
                'v_push'           : 'https://ramman.net/files/mvc/view/push',


            /*>! views */


            //@< APPS
                // app base
                    'v_app-base'       : 'mvc/view/app-base',
                    'm_app-base'       : 'mvc/model/app-base',
                    'c_app-base'       : 'mvc/controller/app-base',

                // app page
                    'v_app-page'       : 'mvc/view/app-page',
                    'm_app-page'       : 'mvc/model/app-page',
                    'c_app-page'       : 'mvc/controller/app-page',

                // app chat
                    'v_app-chat'       : 'mvc/view/app-chat',
                    'm_app-chat'       : 'mvc/model/app-chat',
                    'c_app-chat'       : 'mvc/controller/app-chat',
            //@> APPS


             /*<? models */
                'm_view'           : 'mvc/model/view',
                'm_app'            : 'mvc/model/app',

                'm_engine'         : 'mvc/model/engine',
                'm_category'       : 'mvc/model/category',
                'm_firebase'       : 'mvc/model/firebase', // https://ramman.net/res/
                'm_user'           : 'mvc/model/user',
                'm_routing'        : 'mvc/model/routing',
                'm_moment'         : 'mvc/model/moment',
                'dictionary'       : 'mvc/model/dictionary',
                'log'              : 'mvc/model/log',

                'm_call'           : 'mvc/model/call',
                'm_message'        : 'mvc/model/message',
                'm_contact'        : 'mvc/model/contact',
                'm_push'           : 'https://ramman.net/files/mvc/model/push',
                'm_synchronize'    : 'mvc/model/synchronize',
                'm_record'         : 'mvc/model/record',
                'm_storage'        : 'mvc/model/storage',
                'm_database'       : 'mvc/model/database',

                'm_progressbar'    : 'mvc/model/progressbar', // deps 'progressbar'

                //url db
                'url'              : 'mvc/model/url',


            /*>! models */
        },
        shim: {
            /* <? jquery modules */

                // for algolia autocomplete
                'jquery.autocomplete': {
                    deps: ['jquery'],
                    exports: 'jQuery.fn.autocomplete'
                },
                'jquery.countdown': {
                    deps: ['jquery','jquery.plugin'],
                    exports: 'jQuery.fn.countdown'
                },
                'jquery.plugin': {
                    deps: ['jquery'],
                    exports: 'JQClass'
                },
                'jquery.lettering': {
                    deps: ['jquery'],
                    exports: 'jQuery.fn.lettering'
                },
                'jquery.textillate': {
                    deps: ['jquery'],
                    exports: 'jQuery.fn.textillate'
                },
                'jquery.appear' : {
                    deps: ['jquery'],
                    exports: 'jQuery.fn.appear'
                },
            /* >! jquery modules */

            /* <? onesignal modules for push */
                'moment': {
                    exports: 'moment',
                },
            /* >! onesignal modules for push */

            /* <? progressbar modules */
                // 'progressbar': {
                //     exports: 'progressbar',
                // },
            /* >! progressbar modules */
            


            /* <? mediaStreamRecorder modules for push */
                'mediaStreamRecorder': {
                    // deps: 'MediaRecorderWrapper',
                    exports: 'mediaStreamRecorder'
                },

                'WebAudioRecorder': {
                    // deps: 'MediaRecorderWrapper',
                    exports: 'WebAudioRecorder'
                },
                // 'Recorder': {
                //     exports: 'Recorder'
                // },
            /* >! mediaStreamRecorder modules for push */

            /* <? mixitup modules*/
                'mixitup': {
                    exports: 'Mixitup',
                },
            /* >! mixitup modules */

            /* <? google modules*/
                'firebase': {
                    exports: 'firebase',
                },
                'firestore': {
                    deps: ['firebase'],
                    exports: 'firebase.firestore'
                },

            /* >! google modules */

            /* <? framework7.io modules*/
                'template7': {
                    exports: 'Template7',
                }
            /* >! framework7.io modules*/
        },
        map: {
          '*': {
            'css': 'require-css/css' // or whatever the path to require-css is
          }
        }
    });


require2 (
    ['jquery','dictionary','m_engine','m_routing','m_app','m_synchronize','m_user', 'm_push'], 
    function( $, DICTIONARY, ENGINE, ROUTING, M_APP, SYNCHRONIZE, USER , PUSH) {

    //start js crash log for google analytics && yandex metrika
    ROUTING.errorJsHandlerForGoogleAnalyticsAndYandexMetric();



    // do Jquery global
    window['$'] = $;

    console.log('window.isSynchronizeFile',window.isSynchronizeFile)
    if ( window.isSynchronizeFile ) {
        console.log('window.isSynchronizeFile is true');
      // set global routing for use in m_app
      M_APP.setGlobalVar('m_routing',ROUTING)


      ROUTING.setBrowser(); //#if browser

      
      SYNCHRONIZE.synchronizeFile_run('https://sharepay.ramman.net');
      
      M_APP.setGlobalVar('engine',ENGINE);

      return;
    } else {
        console.log('window.isSynchronizeFile is false');
        $(document).ready( function() {
                setTimeout( () => {
                // set global routing for use in m_app
                M_APP.setGlobalVar('m_routing',ROUTING)

                // set browser || desktop
                    // ROUTING.setBrowser(); //#if browser
                    ROUTING.setDesktop(); //#if desktop
                    ROUTING.setDeviseName('Apple Mac');
                    
                // PUSH.getPermission ( PUSH.getToken( ()=>console.log('PUSH.getToken') ) );

                // start synchronize func for use common localstorage, common user at sub and main domain
                if( ROUTING.isBrowser() ) {
                    if( ROUTING.getUserDomain() ) {
                        
                        // set global m_synchronize for 
                        M_APP.setGlobalVar('m_synchronize',SYNCHRONIZE);

                        // if it is subdomain && it is browser -> we run syncronize for use common local storage
                        SYNCHRONIZE.runForSubDomain();
                    } else {
                        // if it is maindomain && it is browser -> we run syncronize for use same user at one time
                        SYNCHRONIZE.runForMainDomain();
                    }
                }

                ENGINE.init();
                DICTIONARY.autoChange(function () {
                    if( ROUTING.isBrowser() ) {
                        if( ROUTING.getUrlLength() > 0 ) {
                            // if we are in main domain
                            if ( ROUTING.getUser() == 'sign' ) {
                                // if ramman.net/sign -> reload to 
                                ENGINE.passToApp({'app':'page', 'user': userLogin, 'page':'fullWindow', 'data':'id=sign&uid=@system'});
                            } else {
                                ENGINE.startUrl();
                            }

                        } else {
                            // if we are open only domain (without path)
                            var userDomain  = ROUTING.getUserDomain();
                            var userLogin   = USER.getMyLogin()||'anonym';
                            var user        = userDomain||userLogin;
                            var data        = [];
                            if( userDomain ) {
                                // if we are in subdomain
                                if ( userDomain )   data.push ('uid='+userDomain);
                                                    data.push ('login='+userLogin);

                                var dataString = data.join('&');
                                ENGINE.passToApp({'app':'base','page':'one','user':userDomain, 'data': dataString});
                            } else {
                                if ( userLogin && userLogin == 'anonym' ) {
                                    // if ramman.net/sign
                                    ENGINE.passToApp({'app':'page', 'user':'anonym', 'page':'fullWindow', 'data':'id=sign&uid=@system'});
                                } else {

                                    ENGINE.passToApp({'app':'base', 'user': userLogin, 'page':'index', 'data':''});
                                }
                            }
                        }
                        
                    } else if( ROUTING.isDesktop() ) {
                        var user = USER.getMyLogin()||'anonym';
                        if( user != 'anonym' ) {
                            ENGINE.passToApp({'app':'base','page':'index', 'user':user,'data':''});
                        }
                        else{
                            ENGINE.passToApp({'app':'page','page':'fullWindow','data':'id=sign&uid=@system'});
                        }

                    }
                });

                M_APP.setGlobalVar('engine',ENGINE);
            },3000)
        });
    }    
});




define("main2_", function(){});

